{"version":3,"sources":["oojs-ui-windows.js"],"names":["OO","ui","ActionWidget","config","$","extend","framed","parent","call","this","mixin","PendingElement","action","modes","width","height","$element","addClass","inheritClass","ButtonWidget","mixinClass","prototype","hasMode","mode","indexOf","getAction","getModes","slice","ActionSet","EventEmitter","list","categories","actions","flags","categorized","special","others","organized","changing","changed","static","specialFlags","onActionChange","emit","isSpecial","flag","get","filters","i","len","category","index","match","matches","organize","Array","isArray","length","push","apply","undefined","visible","isVisible","disabled","isDisabled","splice","lastIndexOf","getSpecial","getOthers","setMode","toggle","setAbilities","item","setDisabled","forEach","filter","callback","add","connect","click","remove","disconnect","clear","removed","iLen","j","jLen","constructor","hasFlag","Error","message","isPlainObject","jQuery","String","recoverable","warning","initClass","isRecoverable","isWarning","getMessage","clone","text","contents","getMessageText","Process","step","context","steps","next","execute","proceed","deferred","result","Deferred","reject","promise","setTimeout","resolve","isFunction","then","createStep","first","unshift","WindowInstance","deferreds","opening","opened","closing","closed","WindowManager","factory","modal","windows","compatOpened","preparingToOpen","preparingToClose","currentWindow","globalEvents","$returnFocusTo","$ariaHidden","onWindowResizeTimeout","onWindowResizeHandler","onWindowResize","bind","afterWindowResizeHandler","afterWindowResize","toggleClass","Element","sizes","small","medium","large","larger","full","defaultSize","clearTimeout","updateWindowSize","isOpening","win","lifecycle","state","isClosing","isOpened","hasWindow","name","getSetupDelay","getReadyDelay","getHoldDelay","getTeardownDelay","getWindow","Window","lookup","create","addWindows","getCurrentWindow","openWindow","data","compatOpening","manager","method","warnDeprecation","arguments","err","when","done","toggleGlobalEvents","toggleAriaIsolation","document","activeElement","setup","notify","ready","closeWindow","error","compatClosing","always","hold","teardown","focus","append","setManager","removeWindows","names","cleanupWindow","promises","cleanup","detach","clearWindows","Object","keys","isFullscreen","getSize","setDimensions","getSizeProperties","on","scrollWidth","bodyMargin","$body","getElementDocument","body","stackDepth","getElementWindow","orientationchange resize","window","innerWidth","documentElement","clientWidth","parseFloat","css","overflow","margin-right","off","isolate","children","not","parentsUntil","last","attr","removeAttr","destroy","size","$frame","$overlay","$content","$focusTrapBefore","prop","$focusTrapAfter","$focusTraps","onMouseDown","e","target","isInitialized","getManager","viewport","getDimensions","rect","right","left","withoutSizeTransitions","oldTransition","getContentHeight","bodyHeight","bodyStyleObj","style","frameStyleObj","oldHeight","oldPosition","position","getBodyHeight","outerHeight","innerHeight","$head","$foot","scrollHeight","getDir","getSetupProcess","getReadyProcess","getHoldProcess","getTeardownProcess","initialize","setSize","updateSize","dim","styleObj","oldWidth","minWidth","maxWidth","minHeight","maxHeight","$document","onFocusTrapFocused","event","backwards","is","element","findFocusable","open","close","focusTrapHandler","$focus","find","getDocument","blur","removeClass","Dialog","attachedActions","currentAction","onDialogKeyDownHandler","onDialogKeyDown","change","title","escapable","which","Keys","ESCAPE","executeAction","preventDefault","stopPropagation","ENTER","ctrlKey","metaKey","onActionClick","isPending","onActionsChange","detachActions","attachActions","getActions","getActionProcess","setLabel","setTitle","getActionWidgets","LabelWidget","getElementId","setPendingElement","widgets","pushPending","popPending","MessageDialog","verticalActionLayout","label","deferMsg","resize","onResize","dialog","fitActions","toggleVerticalActionLayout","value","$actions","getFlags","oldOverflow","$scrollable","container","reconsiderScrollbars","PanelLayout","scrollable","classes","padded","expanded","other","safe","toggleFramed","primary","previous","$label","outerWidth","ProcessDialog","fitOnOpen","onDismissErrorButtonClick","hideErrors","onRetryButtonClick","$navigation","$location","$safeActions","$primaryActions","$otherActions","dismissButton","msg","retryButton","$errors","$errorsTitle","isMobile","icon","fitLabel","process","fail","errors","showErrors","safeWidth","primaryWidth","biggerWidth","labelWidth","navigationWidth","leftWidth","rightWidth","Math","max","paddingLeft","paddingRight","$item","items","abilities","$errorItems","clearFlags","setFlags","after","scrollTop","getWindowManager","windowManager","alert","options","confirm","prompt","instance","textInput","TextInputWidget","textField","FieldLayout","align","getValue"],"mappings":"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","file":"oojs-ui-windows.min.js","sourcesContent":["/*!\n * OOjs UI v0.22.2\n * https://www.mediawiki.org/wiki/OOjs_UI\n *\n * Copyright 2011–2017 OOjs UI Team and other contributors.\n * Released under the MIT license\n * http://oojs.mit-license.org\n *\n * Date: 2017-06-28T19:51:59Z\n */\n( function ( OO ) {\n\n'use strict';\n\n/**\n * An ActionWidget is a {@link OO.ui.ButtonWidget button widget} that executes an action.\n * Action widgets are used with OO.ui.ActionSet, which manages the behavior and availability\n * of the actions.\n *\n * Both actions and action sets are primarily used with {@link OO.ui.Dialog Dialogs}.\n * Please see the [OOjs UI documentation on MediaWiki] [1] for more information\n * and examples.\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Process_Dialogs#Action_sets\n *\n * @class\n * @extends OO.ui.ButtonWidget\n * @mixins OO.ui.mixin.PendingElement\n *\n * @constructor\n * @param {Object} [config] Configuration options\n * @cfg {string} [action] Symbolic name of the action (e.g., ‘continue’ or ‘cancel’).\n * @cfg {string[]} [modes] Symbolic names of the modes (e.g., ‘edit’ or ‘read’) in which the action\n *  should be made available. See the action set's {@link OO.ui.ActionSet#setMode setMode} method\n *  for more information about setting modes.\n * @cfg {boolean} [framed=false] Render the action button with a frame\n */\nOO.ui.ActionWidget = function OoUiActionWidget( config ) {\n\t// Configuration initialization\n\tconfig = $.extend( { framed: false }, config );\n\n\t// Parent constructor\n\tOO.ui.ActionWidget.parent.call( this, config );\n\n\t// Mixin constructors\n\tOO.ui.mixin.PendingElement.call( this, config );\n\n\t// Properties\n\tthis.action = config.action || '';\n\tthis.modes = config.modes || [];\n\tthis.width = 0;\n\tthis.height = 0;\n\n\t// Initialization\n\tthis.$element.addClass( 'oo-ui-actionWidget' );\n};\n\n/* Setup */\n\nOO.inheritClass( OO.ui.ActionWidget, OO.ui.ButtonWidget );\nOO.mixinClass( OO.ui.ActionWidget, OO.ui.mixin.PendingElement );\n\n/* Methods */\n\n/**\n * Check if the action is configured to be available in the specified `mode`.\n *\n * @param {string} mode Name of mode\n * @return {boolean} The action is configured with the mode\n */\nOO.ui.ActionWidget.prototype.hasMode = function ( mode ) {\n\treturn this.modes.indexOf( mode ) !== -1;\n};\n\n/**\n * Get the symbolic name of the action (e.g., ‘continue’ or ‘cancel’).\n *\n * @return {string}\n */\nOO.ui.ActionWidget.prototype.getAction = function () {\n\treturn this.action;\n};\n\n/**\n * Get the symbolic name of the mode or modes for which the action is configured to be available.\n *\n * The current mode is set with the action set's {@link OO.ui.ActionSet#setMode setMode} method.\n * Only actions that are configured to be avaiable in the current mode will be visible. All other actions\n * are hidden.\n *\n * @return {string[]}\n */\nOO.ui.ActionWidget.prototype.getModes = function () {\n\treturn this.modes.slice();\n};\n\n/* eslint-disable no-unused-vars */\n/**\n * ActionSets manage the behavior of the {@link OO.ui.ActionWidget action widgets} that comprise them.\n * Actions can be made available for specific contexts (modes) and circumstances\n * (abilities). Action sets are primarily used with {@link OO.ui.Dialog Dialogs}.\n *\n * ActionSets contain two types of actions:\n *\n * - Special: Special actions are the first visible actions with special flags, such as 'safe' and 'primary', the default special flags. Additional special flags can be configured in subclasses with the static #specialFlags property.\n * - Other: Other actions include all non-special visible actions.\n *\n * Please see the [OOjs UI documentation on MediaWiki][1] for more information.\n *\n *     @example\n *     // Example: An action set used in a process dialog\n *     function MyProcessDialog( config ) {\n *         MyProcessDialog.parent.call( this, config );\n *     }\n *     OO.inheritClass( MyProcessDialog, OO.ui.ProcessDialog );\n *     MyProcessDialog.static.title = 'An action set in a process dialog';\n *     MyProcessDialog.static.name = 'myProcessDialog';\n *     // An action set that uses modes ('edit' and 'help' mode, in this example).\n *     MyProcessDialog.static.actions = [\n *         { action: 'continue', modes: 'edit', label: 'Continue', flags: [ 'primary', 'constructive' ] },\n *         { action: 'help', modes: 'edit', label: 'Help' },\n *         { modes: 'edit', label: 'Cancel', flags: 'safe' },\n *         { action: 'back', modes: 'help', label: 'Back', flags: 'safe' }\n *     ];\n *\n *     MyProcessDialog.prototype.initialize = function () {\n *         MyProcessDialog.parent.prototype.initialize.apply( this, arguments );\n *         this.panel1 = new OO.ui.PanelLayout( { padded: true, expanded: false } );\n *         this.panel1.$element.append( '<p>This dialog uses an action set (continue, help, cancel, back) configured with modes. This is edit mode. Click \\'help\\' to see help mode.</p>' );\n *         this.panel2 = new OO.ui.PanelLayout( { padded: true, expanded: false } );\n *         this.panel2.$element.append( '<p>This is help mode. Only the \\'back\\' action widget is configured to be visible here. Click \\'back\\' to return to \\'edit\\' mode.</p>' );\n *         this.stackLayout = new OO.ui.StackLayout( {\n *             items: [ this.panel1, this.panel2 ]\n *         } );\n *         this.$body.append( this.stackLayout.$element );\n *     };\n *     MyProcessDialog.prototype.getSetupProcess = function ( data ) {\n *         return MyProcessDialog.parent.prototype.getSetupProcess.call( this, data )\n *             .next( function () {\n *                 this.actions.setMode( 'edit' );\n *             }, this );\n *     };\n *     MyProcessDialog.prototype.getActionProcess = function ( action ) {\n *         if ( action === 'help' ) {\n *             this.actions.setMode( 'help' );\n *             this.stackLayout.setItem( this.panel2 );\n *         } else if ( action === 'back' ) {\n *             this.actions.setMode( 'edit' );\n *             this.stackLayout.setItem( this.panel1 );\n *         } else if ( action === 'continue' ) {\n *             var dialog = this;\n *             return new OO.ui.Process( function () {\n *                 dialog.close();\n *             } );\n *         }\n *         return MyProcessDialog.parent.prototype.getActionProcess.call( this, action );\n *     };\n *     MyProcessDialog.prototype.getBodyHeight = function () {\n *         return this.panel1.$element.outerHeight( true );\n *     };\n *     var windowManager = new OO.ui.WindowManager();\n *     $( 'body' ).append( windowManager.$element );\n *     var dialog = new MyProcessDialog( {\n *         size: 'medium'\n *     } );\n *     windowManager.addWindows( [ dialog ] );\n *     windowManager.openWindow( dialog );\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Process_Dialogs#Action_sets\n *\n * @abstract\n * @class\n * @mixins OO.EventEmitter\n *\n * @constructor\n * @param {Object} [config] Configuration options\n */\nOO.ui.ActionSet = function OoUiActionSet( config ) {\n\t// Configuration initialization\n\tconfig = config || {};\n\n\t// Mixin constructors\n\tOO.EventEmitter.call( this );\n\n\t// Properties\n\tthis.list = [];\n\tthis.categories = {\n\t\tactions: 'getAction',\n\t\tflags: 'getFlags',\n\t\tmodes: 'getModes'\n\t};\n\tthis.categorized = {};\n\tthis.special = {};\n\tthis.others = [];\n\tthis.organized = false;\n\tthis.changing = false;\n\tthis.changed = false;\n};\n/* eslint-enable no-unused-vars */\n\n/* Setup */\n\nOO.mixinClass( OO.ui.ActionSet, OO.EventEmitter );\n\n/* Static Properties */\n\n/**\n * Symbolic name of the flags used to identify special actions. Special actions are displayed in the\n *  header of a {@link OO.ui.ProcessDialog process dialog}.\n *  See the [OOjs UI documentation on MediaWiki][2] for more information and examples.\n *\n *  [2]:https://www.mediawiki.org/wiki/OOjs_UI/Windows/Process_Dialogs\n *\n * @abstract\n * @static\n * @inheritable\n * @property {string}\n */\nOO.ui.ActionSet.static.specialFlags = [ 'safe', 'primary' ];\n\n/* Events */\n\n/**\n * @event click\n *\n * A 'click' event is emitted when an action is clicked.\n *\n * @param {OO.ui.ActionWidget} action Action that was clicked\n */\n\n/**\n * @event add\n *\n * An 'add' event is emitted when actions are {@link #method-add added} to the action set.\n *\n * @param {OO.ui.ActionWidget[]} added Actions added\n */\n\n/**\n * @event remove\n *\n * A 'remove' event is emitted when actions are {@link #method-remove removed}\n *  or {@link #clear cleared}.\n *\n * @param {OO.ui.ActionWidget[]} added Actions removed\n */\n\n/**\n * @event change\n *\n * A 'change' event is emitted when actions are {@link #method-add added}, {@link #clear cleared},\n * or {@link #method-remove removed} from the action set or when the {@link #setMode mode} is changed.\n *\n */\n\n/* Methods */\n\n/**\n * Handle action change events.\n *\n * @private\n * @fires change\n */\nOO.ui.ActionSet.prototype.onActionChange = function () {\n\tthis.organized = false;\n\tif ( this.changing ) {\n\t\tthis.changed = true;\n\t} else {\n\t\tthis.emit( 'change' );\n\t}\n};\n\n/**\n * Check if an action is one of the special actions.\n *\n * @param {OO.ui.ActionWidget} action Action to check\n * @return {boolean} Action is special\n */\nOO.ui.ActionSet.prototype.isSpecial = function ( action ) {\n\tvar flag;\n\n\tfor ( flag in this.special ) {\n\t\tif ( action === this.special[ flag ] ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\n/**\n * Get action widgets based on the specified filter: ‘actions’, ‘flags’, ‘modes’, ‘visible’,\n *  or ‘disabled’.\n *\n * @param {Object} [filters] Filters to use, omit to get all actions\n * @param {string|string[]} [filters.actions] Actions that action widgets must have\n * @param {string|string[]} [filters.flags] Flags that action widgets must have (e.g., 'safe')\n * @param {string|string[]} [filters.modes] Modes that action widgets must have\n * @param {boolean} [filters.visible] Action widgets must be visible\n * @param {boolean} [filters.disabled] Action widgets must be disabled\n * @return {OO.ui.ActionWidget[]} Action widgets matching all criteria\n */\nOO.ui.ActionSet.prototype.get = function ( filters ) {\n\tvar i, len, list, category, actions, index, match, matches;\n\n\tif ( filters ) {\n\t\tthis.organize();\n\n\t\t// Collect category candidates\n\t\tmatches = [];\n\t\tfor ( category in this.categorized ) {\n\t\t\tlist = filters[ category ];\n\t\t\tif ( list ) {\n\t\t\t\tif ( !Array.isArray( list ) ) {\n\t\t\t\t\tlist = [ list ];\n\t\t\t\t}\n\t\t\t\tfor ( i = 0, len = list.length; i < len; i++ ) {\n\t\t\t\t\tactions = this.categorized[ category ][ list[ i ] ];\n\t\t\t\t\tif ( Array.isArray( actions ) ) {\n\t\t\t\t\t\tmatches.push.apply( matches, actions );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Remove by boolean filters\n\t\tfor ( i = 0, len = matches.length; i < len; i++ ) {\n\t\t\tmatch = matches[ i ];\n\t\t\tif (\n\t\t\t\t( filters.visible !== undefined && match.isVisible() !== filters.visible ) ||\n\t\t\t\t( filters.disabled !== undefined && match.isDisabled() !== filters.disabled )\n\t\t\t) {\n\t\t\t\tmatches.splice( i, 1 );\n\t\t\t\tlen--;\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\t// Remove duplicates\n\t\tfor ( i = 0, len = matches.length; i < len; i++ ) {\n\t\t\tmatch = matches[ i ];\n\t\t\tindex = matches.lastIndexOf( match );\n\t\t\twhile ( index !== i ) {\n\t\t\t\tmatches.splice( index, 1 );\n\t\t\t\tlen--;\n\t\t\t\tindex = matches.lastIndexOf( match );\n\t\t\t}\n\t\t}\n\t\treturn matches;\n\t}\n\treturn this.list.slice();\n};\n\n/**\n * Get 'special' actions.\n *\n * Special actions are the first visible action widgets with special flags, such as 'safe' and 'primary'.\n * Special flags can be configured in subclasses by changing the static #specialFlags property.\n *\n * @return {OO.ui.ActionWidget[]|null} 'Special' action widgets.\n */\nOO.ui.ActionSet.prototype.getSpecial = function () {\n\tthis.organize();\n\treturn $.extend( {}, this.special );\n};\n\n/**\n * Get 'other' actions.\n *\n * Other actions include all non-special visible action widgets.\n *\n * @return {OO.ui.ActionWidget[]} 'Other' action widgets\n */\nOO.ui.ActionSet.prototype.getOthers = function () {\n\tthis.organize();\n\treturn this.others.slice();\n};\n\n/**\n * Set the mode  (e.g., ‘edit’ or ‘view’). Only {@link OO.ui.ActionWidget#modes actions} configured\n * to be available in the specified mode will be made visible. All other actions will be hidden.\n *\n * @param {string} mode The mode. Only actions configured to be available in the specified\n *  mode will be made visible.\n * @chainable\n * @fires toggle\n * @fires change\n */\nOO.ui.ActionSet.prototype.setMode = function ( mode ) {\n\tvar i, len, action;\n\n\tthis.changing = true;\n\tfor ( i = 0, len = this.list.length; i < len; i++ ) {\n\t\taction = this.list[ i ];\n\t\taction.toggle( action.hasMode( mode ) );\n\t}\n\n\tthis.organized = false;\n\tthis.changing = false;\n\tthis.emit( 'change' );\n\n\treturn this;\n};\n\n/**\n * Set the abilities of the specified actions.\n *\n * Action widgets that are configured with the specified actions will be enabled\n * or disabled based on the boolean values specified in the `actions`\n * parameter.\n *\n * @param {Object.<string,boolean>} actions A list keyed by action name with boolean\n *  values that indicate whether or not the action should be enabled.\n * @chainable\n */\nOO.ui.ActionSet.prototype.setAbilities = function ( actions ) {\n\tvar i, len, action, item;\n\n\tfor ( i = 0, len = this.list.length; i < len; i++ ) {\n\t\titem = this.list[ i ];\n\t\taction = item.getAction();\n\t\tif ( actions[ action ] !== undefined ) {\n\t\t\titem.setDisabled( !actions[ action ] );\n\t\t}\n\t}\n\n\treturn this;\n};\n\n/**\n * Executes a function once per action.\n *\n * When making changes to multiple actions, use this method instead of iterating over the actions\n * manually to defer emitting a #change event until after all actions have been changed.\n *\n * @param {Object|null} filter Filters to use to determine which actions to iterate over; see #get\n * @param {Function} callback Callback to run for each action; callback is invoked with three\n *   arguments: the action, the action's index, the list of actions being iterated over\n * @chainable\n */\nOO.ui.ActionSet.prototype.forEach = function ( filter, callback ) {\n\tthis.changed = false;\n\tthis.changing = true;\n\tthis.get( filter ).forEach( callback );\n\tthis.changing = false;\n\tif ( this.changed ) {\n\t\tthis.emit( 'change' );\n\t}\n\n\treturn this;\n};\n\n/**\n * Add action widgets to the action set.\n *\n * @param {OO.ui.ActionWidget[]} actions Action widgets to add\n * @chainable\n * @fires add\n * @fires change\n */\nOO.ui.ActionSet.prototype.add = function ( actions ) {\n\tvar i, len, action;\n\n\tthis.changing = true;\n\tfor ( i = 0, len = actions.length; i < len; i++ ) {\n\t\taction = actions[ i ];\n\t\taction.connect( this, {\n\t\t\tclick: [ 'emit', 'click', action ],\n\t\t\ttoggle: [ 'onActionChange' ]\n\t\t} );\n\t\tthis.list.push( action );\n\t}\n\tthis.organized = false;\n\tthis.emit( 'add', actions );\n\tthis.changing = false;\n\tthis.emit( 'change' );\n\n\treturn this;\n};\n\n/**\n * Remove action widgets from the set.\n *\n * To remove all actions, you may wish to use the #clear method instead.\n *\n * @param {OO.ui.ActionWidget[]} actions Action widgets to remove\n * @chainable\n * @fires remove\n * @fires change\n */\nOO.ui.ActionSet.prototype.remove = function ( actions ) {\n\tvar i, len, index, action;\n\n\tthis.changing = true;\n\tfor ( i = 0, len = actions.length; i < len; i++ ) {\n\t\taction = actions[ i ];\n\t\tindex = this.list.indexOf( action );\n\t\tif ( index !== -1 ) {\n\t\t\taction.disconnect( this );\n\t\t\tthis.list.splice( index, 1 );\n\t\t}\n\t}\n\tthis.organized = false;\n\tthis.emit( 'remove', actions );\n\tthis.changing = false;\n\tthis.emit( 'change' );\n\n\treturn this;\n};\n\n/**\n * Remove all action widets from the set.\n *\n * To remove only specified actions, use the {@link #method-remove remove} method instead.\n *\n * @chainable\n * @fires remove\n * @fires change\n */\nOO.ui.ActionSet.prototype.clear = function () {\n\tvar i, len, action,\n\t\tremoved = this.list.slice();\n\n\tthis.changing = true;\n\tfor ( i = 0, len = this.list.length; i < len; i++ ) {\n\t\taction = this.list[ i ];\n\t\taction.disconnect( this );\n\t}\n\n\tthis.list = [];\n\n\tthis.organized = false;\n\tthis.emit( 'remove', removed );\n\tthis.changing = false;\n\tthis.emit( 'change' );\n\n\treturn this;\n};\n\n/**\n * Organize actions.\n *\n * This is called whenever organized information is requested. It will only reorganize the actions\n * if something has changed since the last time it ran.\n *\n * @private\n * @chainable\n */\nOO.ui.ActionSet.prototype.organize = function () {\n\tvar i, iLen, j, jLen, flag, action, category, list, item, special,\n\t\tspecialFlags = this.constructor.static.specialFlags;\n\n\tif ( !this.organized ) {\n\t\tthis.categorized = {};\n\t\tthis.special = {};\n\t\tthis.others = [];\n\t\tfor ( i = 0, iLen = this.list.length; i < iLen; i++ ) {\n\t\t\taction = this.list[ i ];\n\t\t\tif ( action.isVisible() ) {\n\t\t\t\t// Populate categories\n\t\t\t\tfor ( category in this.categories ) {\n\t\t\t\t\tif ( !this.categorized[ category ] ) {\n\t\t\t\t\t\tthis.categorized[ category ] = {};\n\t\t\t\t\t}\n\t\t\t\t\tlist = action[ this.categories[ category ] ]();\n\t\t\t\t\tif ( !Array.isArray( list ) ) {\n\t\t\t\t\t\tlist = [ list ];\n\t\t\t\t\t}\n\t\t\t\t\tfor ( j = 0, jLen = list.length; j < jLen; j++ ) {\n\t\t\t\t\t\titem = list[ j ];\n\t\t\t\t\t\tif ( !this.categorized[ category ][ item ] ) {\n\t\t\t\t\t\t\tthis.categorized[ category ][ item ] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.categorized[ category ][ item ].push( action );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Populate special/others\n\t\t\t\tspecial = false;\n\t\t\t\tfor ( j = 0, jLen = specialFlags.length; j < jLen; j++ ) {\n\t\t\t\t\tflag = specialFlags[ j ];\n\t\t\t\t\tif ( !this.special[ flag ] && action.hasFlag( flag ) ) {\n\t\t\t\t\t\tthis.special[ flag ] = action;\n\t\t\t\t\t\tspecial = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ( !special ) {\n\t\t\t\t\tthis.others.push( action );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.organized = true;\n\t}\n\n\treturn this;\n};\n\n/**\n * Errors contain a required message (either a string or jQuery selection) that is used to describe what went wrong\n * in a {@link OO.ui.Process process}. The error's #recoverable and #warning configurations are used to customize the\n * appearance and functionality of the error interface.\n *\n * The basic error interface contains a formatted error message as well as two buttons: 'Dismiss' and 'Try again' (i.e., the error\n * is 'recoverable' by default). If the error is not recoverable, the 'Try again' button will not be rendered and the widget\n * that initiated the failed process will be disabled.\n *\n * If the error is a warning, the error interface will include a 'Dismiss' and a 'Continue' button, which will try the\n * process again.\n *\n * For an example of error interfaces, please see the [OOjs UI documentation on MediaWiki][1].\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Process_Dialogs#Processes_and_errors\n *\n * @class\n *\n * @constructor\n * @param {string|jQuery} message Description of error\n * @param {Object} [config] Configuration options\n * @cfg {boolean} [recoverable=true] Error is recoverable.\n *  By default, errors are recoverable, and users can try the process again.\n * @cfg {boolean} [warning=false] Error is a warning.\n *  If the error is a warning, the error interface will include a\n *  'Dismiss' and a 'Continue' button. It is the responsibility of the developer to ensure that the warning\n *  is not triggered a second time if the user chooses to continue.\n */\nOO.ui.Error = function OoUiError( message, config ) {\n\t// Allow passing positional parameters inside the config object\n\tif ( OO.isPlainObject( message ) && config === undefined ) {\n\t\tconfig = message;\n\t\tmessage = config.message;\n\t}\n\n\t// Configuration initialization\n\tconfig = config || {};\n\n\t// Properties\n\tthis.message = message instanceof jQuery ? message : String( message );\n\tthis.recoverable = config.recoverable === undefined || !!config.recoverable;\n\tthis.warning = !!config.warning;\n};\n\n/* Setup */\n\nOO.initClass( OO.ui.Error );\n\n/* Methods */\n\n/**\n * Check if the error is recoverable.\n *\n * If the error is recoverable, users are able to try the process again.\n *\n * @return {boolean} Error is recoverable\n */\nOO.ui.Error.prototype.isRecoverable = function () {\n\treturn this.recoverable;\n};\n\n/**\n * Check if the error is a warning.\n *\n * If the error is a warning, the error interface will include a 'Dismiss' and a 'Continue' button.\n *\n * @return {boolean} Error is warning\n */\nOO.ui.Error.prototype.isWarning = function () {\n\treturn this.warning;\n};\n\n/**\n * Get error message as DOM nodes.\n *\n * @return {jQuery} Error message in DOM nodes\n */\nOO.ui.Error.prototype.getMessage = function () {\n\treturn this.message instanceof jQuery ?\n\t\tthis.message.clone() :\n\t\t$( '<div>' ).text( this.message ).contents();\n};\n\n/**\n * Get the error message text.\n *\n * @return {string} Error message\n */\nOO.ui.Error.prototype.getMessageText = function () {\n\treturn this.message instanceof jQuery ? this.message.text() : this.message;\n};\n\n/**\n * A Process is a list of steps that are called in sequence. The step can be a number, a jQuery promise,\n * or a function:\n *\n * - **number**: the process will wait for the specified number of milliseconds before proceeding.\n * - **promise**: the process will continue to the next step when the promise is successfully resolved\n *  or stop if the promise is rejected.\n * - **function**: the process will execute the function. The process will stop if the function returns\n *  either a boolean `false` or a promise that is rejected; if the function returns a number, the process\n *  will wait for that number of milliseconds before proceeding.\n *\n * If the process fails, an {@link OO.ui.Error error} is generated. Depending on how the error is\n * configured, users can dismiss the error and try the process again, or not. If a process is stopped,\n * its remaining steps will not be performed.\n *\n * @class\n *\n * @constructor\n * @param {number|jQuery.Promise|Function} step Number of miliseconds to wait before proceeding, promise\n *  that must be resolved before proceeding, or a function to execute. See #createStep for more information. see #createStep for more information\n * @param {Object} [context=null] Execution context of the function. The context is ignored if the step is\n *  a number or promise.\n */\nOO.ui.Process = function ( step, context ) {\n\t// Properties\n\tthis.steps = [];\n\n\t// Initialization\n\tif ( step !== undefined ) {\n\t\tthis.next( step, context );\n\t}\n};\n\n/* Setup */\n\nOO.initClass( OO.ui.Process );\n\n/* Methods */\n\n/**\n * Start the process.\n *\n * @return {jQuery.Promise} Promise that is resolved when all steps have successfully completed.\n *  If any of the steps return a promise that is rejected or a boolean false, this promise is rejected\n *  and any remaining steps are not performed.\n */\nOO.ui.Process.prototype.execute = function () {\n\tvar i, len, promise;\n\n\t/**\n\t * Continue execution.\n\t *\n\t * @ignore\n\t * @param {Array} step A function and the context it should be called in\n\t * @return {Function} Function that continues the process\n\t */\n\tfunction proceed( step ) {\n\t\treturn function () {\n\t\t\t// Execute step in the correct context\n\t\t\tvar deferred,\n\t\t\t\tresult = step.callback.call( step.context );\n\n\t\t\tif ( result === false ) {\n\t\t\t\t// Use rejected promise for boolean false results\n\t\t\t\treturn $.Deferred().reject( [] ).promise();\n\t\t\t}\n\t\t\tif ( typeof result === 'number' ) {\n\t\t\t\tif ( result < 0 ) {\n\t\t\t\t\tthrow new Error( 'Cannot go back in time: flux capacitor is out of service' );\n\t\t\t\t}\n\t\t\t\t// Use a delayed promise for numbers, expecting them to be in milliseconds\n\t\t\t\tdeferred = $.Deferred();\n\t\t\t\tsetTimeout( deferred.resolve, result );\n\t\t\t\treturn deferred.promise();\n\t\t\t}\n\t\t\tif ( result instanceof OO.ui.Error ) {\n\t\t\t\t// Use rejected promise for error\n\t\t\t\treturn $.Deferred().reject( [ result ] ).promise();\n\t\t\t}\n\t\t\tif ( Array.isArray( result ) && result.length && result[ 0 ] instanceof OO.ui.Error ) {\n\t\t\t\t// Use rejected promise for list of errors\n\t\t\t\treturn $.Deferred().reject( result ).promise();\n\t\t\t}\n\t\t\t// Duck-type the object to see if it can produce a promise\n\t\t\tif ( result && $.isFunction( result.promise ) ) {\n\t\t\t\t// Use a promise generated from the result\n\t\t\t\treturn result.promise();\n\t\t\t}\n\t\t\t// Use resolved promise for other results\n\t\t\treturn $.Deferred().resolve().promise();\n\t\t};\n\t}\n\n\tif ( this.steps.length ) {\n\t\t// Generate a chain reaction of promises\n\t\tpromise = proceed( this.steps[ 0 ] )();\n\t\tfor ( i = 1, len = this.steps.length; i < len; i++ ) {\n\t\t\tpromise = promise.then( proceed( this.steps[ i ] ) );\n\t\t}\n\t} else {\n\t\tpromise = $.Deferred().resolve().promise();\n\t}\n\n\treturn promise;\n};\n\n/**\n * Create a process step.\n *\n * @private\n * @param {number|jQuery.Promise|Function} step\n *\n * - Number of milliseconds to wait before proceeding\n * - Promise that must be resolved before proceeding\n * - Function to execute\n *   - If the function returns a boolean false the process will stop\n *   - If the function returns a promise, the process will continue to the next\n *     step when the promise is resolved or stop if the promise is rejected\n *   - If the function returns a number, the process will wait for that number of\n *     milliseconds before proceeding\n * @param {Object} [context=null] Execution context of the function. The context is\n *  ignored if the step is a number or promise.\n * @return {Object} Step object, with `callback` and `context` properties\n */\nOO.ui.Process.prototype.createStep = function ( step, context ) {\n\tif ( typeof step === 'number' || $.isFunction( step.promise ) ) {\n\t\treturn {\n\t\t\tcallback: function () {\n\t\t\t\treturn step;\n\t\t\t},\n\t\t\tcontext: null\n\t\t};\n\t}\n\tif ( $.isFunction( step ) ) {\n\t\treturn {\n\t\t\tcallback: step,\n\t\t\tcontext: context\n\t\t};\n\t}\n\tthrow new Error( 'Cannot create process step: number, promise or function expected' );\n};\n\n/**\n * Add step to the beginning of the process.\n *\n * @inheritdoc #createStep\n * @return {OO.ui.Process} this\n * @chainable\n */\nOO.ui.Process.prototype.first = function ( step, context ) {\n\tthis.steps.unshift( this.createStep( step, context ) );\n\treturn this;\n};\n\n/**\n * Add step to the end of the process.\n *\n * @inheritdoc #createStep\n * @return {OO.ui.Process} this\n * @chainable\n */\nOO.ui.Process.prototype.next = function ( step, context ) {\n\tthis.steps.push( this.createStep( step, context ) );\n\treturn this;\n};\n\n/**\n * A window instance represents the life cycle for one single opening of a window\n * until its closing.\n *\n * While OO.ui.WindowManager will reuse OO.ui.Window objects, each time a window is\n * opened, a new lifecycle starts.\n *\n * For more information, please see the [OOjs UI documentation on MediaWiki] [1].\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows\n *\n * @class\n *\n * @constructor\n */\nOO.ui.WindowInstance = function OOuiWindowInstance() {\n\tvar deferreds = {\n\t\topening: $.Deferred(),\n\t\topened: $.Deferred(),\n\t\tclosing: $.Deferred(),\n\t\tclosed: $.Deferred()\n\t};\n\n\t/**\n\t * @private\n\t * @property {Object}\n\t */\n\tthis.deferreds = deferreds;\n\n\t// Set these up as chained promises so that rejecting of\n\t// an earlier stage automatically rejects the subsequent\n\t// would-be stages as well.\n\n\t/**\n\t * @property {jQuery.Promise}\n\t */\n\tthis.opening = deferreds.opening.promise();\n\t/**\n\t * @property {jQuery.Promise}\n\t */\n\tthis.opened = this.opening.then( function () {\n\t\treturn deferreds.opened;\n\t} );\n\t/**\n\t * @property {jQuery.Promise}\n\t */\n\tthis.closing = this.opened.then( function () {\n\t\treturn deferreds.closing;\n\t} );\n\t/**\n\t * @property {jQuery.Promise}\n\t */\n\tthis.closed = this.closing.then( function () {\n\t\treturn deferreds.closed;\n\t} );\n};\n\n/* Setup */\n\nOO.initClass( OO.ui.WindowInstance );\n\n/**\n * Window managers are used to open and close {@link OO.ui.Window windows} and control their presentation.\n * Managed windows are mutually exclusive. If a new window is opened while a current window is opening\n * or is opened, the current window will be closed and any ongoing {@link OO.ui.Process process} will be cancelled. Windows\n * themselves are persistent and—rather than being torn down when closed—can be repopulated with the\n * pertinent data and reused.\n *\n * Over the lifecycle of a window, the window manager makes available three promises: `opening`,\n * `opened`, and `closing`, which represent the primary stages of the cycle:\n *\n * **Opening**: the opening stage begins when the window manager’s #openWindow or a window’s\n * {@link OO.ui.Window#open open} method is used, and the window manager begins to open the window.\n *\n * - an `opening` event is emitted with an `opening` promise\n * - the #getSetupDelay method is called and the returned value is used to time a pause in execution before the\n *   window’s {@link OO.ui.Window#method-setup setup} method is called which executes OO.ui.Window#getSetupProcess.\n * - a `setup` progress notification is emitted from the `opening` promise\n * - the #getReadyDelay method is called the returned value is used to time a pause in execution before the\n *   window’s {@link OO.ui.Window#method-ready ready} method is called which executes OO.ui.Window#getReadyProcess.\n * - a `ready` progress notification is emitted from the `opening` promise\n * - the `opening` promise is resolved with an `opened` promise\n *\n * **Opened**: the window is now open.\n *\n * **Closing**: the closing stage begins when the window manager's #closeWindow or the\n * window's {@link OO.ui.Window#close close} methods is used, and the window manager begins\n * to close the window.\n *\n * - the `opened` promise is resolved with `closing` promise and a `closing` event is emitted\n * - the #getHoldDelay method is called and the returned value is used to time a pause in execution before\n *   the window's {@link OO.ui.Window#getHoldProcess getHoldProces} method is called on the\n *   window and its result executed\n * - a `hold` progress notification is emitted from the `closing` promise\n * - the #getTeardownDelay() method is called and the returned value is used to time a pause in execution before\n *   the window's {@link OO.ui.Window#getTeardownProcess getTeardownProcess} method is called on the\n *   window and its result executed\n * - a `teardown` progress notification is emitted from the `closing` promise\n * - the `closing` promise is resolved. The window is now closed\n *\n * See the [OOjs UI documentation on MediaWiki][1] for more information.\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Window_managers\n *\n * @class\n * @extends OO.ui.Element\n * @mixins OO.EventEmitter\n *\n * @constructor\n * @param {Object} [config] Configuration options\n * @cfg {OO.Factory} [factory] Window factory to use for automatic instantiation\n *  Note that window classes that are instantiated with a factory must have\n *  a {@link OO.ui.Dialog#static-name static name} property that specifies a symbolic name.\n * @cfg {boolean} [modal=true] Prevent interaction outside the dialog\n */\nOO.ui.WindowManager = function OoUiWindowManager( config ) {\n\t// Configuration initialization\n\tconfig = config || {};\n\n\t// Parent constructor\n\tOO.ui.WindowManager.parent.call( this, config );\n\n\t// Mixin constructors\n\tOO.EventEmitter.call( this );\n\n\t// Properties\n\tthis.factory = config.factory;\n\tthis.modal = config.modal === undefined || !!config.modal;\n\tthis.windows = {};\n\t// Deprecated placeholder promise given to compatOpening in openWindow()\n\t// that is resolved in closeWindow().\n\tthis.compatOpened = null;\n\tthis.preparingToOpen = null;\n\tthis.preparingToClose = null;\n\tthis.currentWindow = null;\n\tthis.globalEvents = false;\n\tthis.$returnFocusTo = null;\n\tthis.$ariaHidden = null;\n\tthis.onWindowResizeTimeout = null;\n\tthis.onWindowResizeHandler = this.onWindowResize.bind( this );\n\tthis.afterWindowResizeHandler = this.afterWindowResize.bind( this );\n\n\t// Initialization\n\tthis.$element\n\t\t.addClass( 'oo-ui-windowManager' )\n\t\t.toggleClass( 'oo-ui-windowManager-modal', this.modal );\n};\n\n/* Setup */\n\nOO.inheritClass( OO.ui.WindowManager, OO.ui.Element );\nOO.mixinClass( OO.ui.WindowManager, OO.EventEmitter );\n\n/* Events */\n\n/**\n * An 'opening' event is emitted when the window begins to be opened.\n *\n * @event opening\n * @param {OO.ui.Window} win Window that's being opened\n * @param {jQuery.Promise} opened A promise resolved with a value when the window is opened successfully.\n *  This promise also emits `setup` and `ready` notifications. When this promise is resolved, the first\n *  argument of the value is an 'closed' promise, the second argument is the opening data.\n * @param {Object} data Window opening data\n */\n\n/**\n * A 'closing' event is emitted when the window begins to be closed.\n *\n * @event closing\n * @param {OO.ui.Window} win Window that's being closed\n * @param {jQuery.Promise} closed A promise resolved with a value when the window is closed successfully.\n *  This promise also emits `hold` and `teardown` notifications. When this promise is resolved, the first\n *  argument of its value is the closing data.\n * @param {Object} data Window closing data\n */\n\n/**\n * A 'resize' event is emitted when a window is resized.\n *\n * @event resize\n * @param {OO.ui.Window} win Window that was resized\n */\n\n/* Static Properties */\n\n/**\n * Map of the symbolic name of each window size and its CSS properties.\n *\n * @static\n * @inheritable\n * @property {Object}\n */\nOO.ui.WindowManager.static.sizes = {\n\tsmall: {\n\t\twidth: 300\n\t},\n\tmedium: {\n\t\twidth: 500\n\t},\n\tlarge: {\n\t\twidth: 700\n\t},\n\tlarger: {\n\t\twidth: 900\n\t},\n\tfull: {\n\t\t// These can be non-numeric because they are never used in calculations\n\t\twidth: '100%',\n\t\theight: '100%'\n\t}\n};\n\n/**\n * Symbolic name of the default window size.\n *\n * The default size is used if the window's requested size is not recognized.\n *\n * @static\n * @inheritable\n * @property {string}\n */\nOO.ui.WindowManager.static.defaultSize = 'medium';\n\n/* Methods */\n\n/**\n * Handle window resize events.\n *\n * @private\n * @param {jQuery.Event} e Window resize event\n */\nOO.ui.WindowManager.prototype.onWindowResize = function () {\n\tclearTimeout( this.onWindowResizeTimeout );\n\tthis.onWindowResizeTimeout = setTimeout( this.afterWindowResizeHandler, 200 );\n};\n\n/**\n * Handle window resize events.\n *\n * @private\n * @param {jQuery.Event} e Window resize event\n */\nOO.ui.WindowManager.prototype.afterWindowResize = function () {\n\tif ( this.currentWindow ) {\n\t\tthis.updateWindowSize( this.currentWindow );\n\t}\n};\n\n/**\n * Check if window is opening.\n *\n * @param {OO.ui.Window} win Window to check\n * @return {boolean} Window is opening\n */\nOO.ui.WindowManager.prototype.isOpening = function ( win ) {\n\treturn win === this.currentWindow && !!this.lifecycle &&\n\t\tthis.lifecycle.opened.state() === 'pending';\n};\n\n/**\n * Check if window is closing.\n *\n * @param {OO.ui.Window} win Window to check\n * @return {boolean} Window is closing\n */\nOO.ui.WindowManager.prototype.isClosing = function ( win ) {\n\treturn win === this.currentWindow && !!this.lifecycle &&\n\t\tthis.lifecycle.closing.state() === 'resolved' &&\n\t\tthis.lifecycle.closed.state() === 'pending';\n};\n\n/**\n * Check if window is opened.\n *\n * @param {OO.ui.Window} win Window to check\n * @return {boolean} Window is opened\n */\nOO.ui.WindowManager.prototype.isOpened = function ( win ) {\n\treturn win === this.currentWindow && !!this.lifecycle &&\n\t\tthis.lifecycle.opened.state() === 'resolved' &&\n\t\tthis.lifecycle.closing.state() === 'pending';\n};\n\n/**\n * Check if a window is being managed.\n *\n * @param {OO.ui.Window} win Window to check\n * @return {boolean} Window is being managed\n */\nOO.ui.WindowManager.prototype.hasWindow = function ( win ) {\n\tvar name;\n\n\tfor ( name in this.windows ) {\n\t\tif ( this.windows[ name ] === win ) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\n/**\n * Get the number of milliseconds to wait after opening begins before executing the ‘setup’ process.\n *\n * @param {OO.ui.Window} win Window being opened\n * @param {Object} [data] Window opening data\n * @return {number} Milliseconds to wait\n */\nOO.ui.WindowManager.prototype.getSetupDelay = function () {\n\treturn 0;\n};\n\n/**\n * Get the number of milliseconds to wait after setup has finished before executing the ‘ready’ process.\n *\n * @param {OO.ui.Window} win Window being opened\n * @param {Object} [data] Window opening data\n * @return {number} Milliseconds to wait\n */\nOO.ui.WindowManager.prototype.getReadyDelay = function () {\n\treturn 0;\n};\n\n/**\n * Get the number of milliseconds to wait after closing has begun before executing the 'hold' process.\n *\n * @param {OO.ui.Window} win Window being closed\n * @param {Object} [data] Window closing data\n * @return {number} Milliseconds to wait\n */\nOO.ui.WindowManager.prototype.getHoldDelay = function () {\n\treturn 0;\n};\n\n/**\n * Get the number of milliseconds to wait after the ‘hold’ process has finished before\n * executing the ‘teardown’ process.\n *\n * @param {OO.ui.Window} win Window being closed\n * @param {Object} [data] Window closing data\n * @return {number} Milliseconds to wait\n */\nOO.ui.WindowManager.prototype.getTeardownDelay = function () {\n\treturn this.modal ? 250 : 0;\n};\n\n/**\n * Get a window by its symbolic name.\n *\n * If the window is not yet instantiated and its symbolic name is recognized by a factory, it will be\n * instantiated and added to the window manager automatically. Please see the [OOjs UI documentation on MediaWiki][3]\n * for more information about using factories.\n * [3]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Window_managers\n *\n * @param {string} name Symbolic name of the window\n * @return {jQuery.Promise} Promise resolved with matching window, or rejected with an OO.ui.Error\n * @throws {Error} An error is thrown if the symbolic name is not recognized by the factory.\n * @throws {Error} An error is thrown if the named window is not recognized as a managed window.\n */\nOO.ui.WindowManager.prototype.getWindow = function ( name ) {\n\tvar deferred = $.Deferred(),\n\t\twin = this.windows[ name ];\n\n\tif ( !( win instanceof OO.ui.Window ) ) {\n\t\tif ( this.factory ) {\n\t\t\tif ( !this.factory.lookup( name ) ) {\n\t\t\t\tdeferred.reject( new OO.ui.Error(\n\t\t\t\t\t'Cannot auto-instantiate window: symbolic name is unrecognized by the factory'\n\t\t\t\t) );\n\t\t\t} else {\n\t\t\t\twin = this.factory.create( name );\n\t\t\t\tthis.addWindows( [ win ] );\n\t\t\t\tdeferred.resolve( win );\n\t\t\t}\n\t\t} else {\n\t\t\tdeferred.reject( new OO.ui.Error(\n\t\t\t\t'Cannot get unmanaged window: symbolic name unrecognized as a managed window'\n\t\t\t) );\n\t\t}\n\t} else {\n\t\tdeferred.resolve( win );\n\t}\n\n\treturn deferred.promise();\n};\n\n/**\n * Get current window.\n *\n * @return {OO.ui.Window|null} Currently opening/opened/closing window\n */\nOO.ui.WindowManager.prototype.getCurrentWindow = function () {\n\treturn this.currentWindow;\n};\n\n/**\n * Open a window.\n *\n * @param {OO.ui.Window|string} win Window object or symbolic name of window to open\n * @param {Object} [data] Window opening data\n * @param {jQuery|null} [data.$returnFocusTo] Element to which the window will return focus when closed.\n *  Defaults the current activeElement. If set to null, focus isn't changed on close.\n * @return {OO.ui.WindowInstance|jQuery.Promise} A lifecycle object representing this particular\n *  opening of the window. For backwards-compatibility, then object is also a Thenable that is resolved\n *  when the window is done opening, with nested promise for when closing starts. This behaviour\n *  is deprecated and is not compatible with jQuery 3 (T163510).\n * @fires opening\n */\nOO.ui.WindowManager.prototype.openWindow = function ( win, data, lifecycle, compatOpening ) {\n\tvar manager = this;\n\tdata = data || {};\n\n\t// Internal parameter 'lifecycle' allows this method to always return\n\t// a lifecycle even if the window still needs to be created\n\t// asynchronously when 'win' is a string.\n\tlifecycle = lifecycle || new OO.ui.WindowInstance();\n\tcompatOpening = compatOpening || $.Deferred();\n\n\t// Turn lifecycle into a Thenable for backwards-compatibility with\n\t// the deprecated nested-promise behaviour (T163510).\n\t[ 'state', 'always', 'catch', 'pipe', 'then', 'promise', 'progress', 'done', 'fail' ]\n\t\t.forEach( function ( method ) {\n\t\t\tlifecycle[ method ] = function () {\n\t\t\t\tOO.ui.warnDeprecation(\n\t\t\t\t\t'Using the return value of openWindow as a promise is deprecated. ' +\n\t\t\t\t\t'Use .openWindow( ... ).opening.' + method + '( ... ) instead.'\n\t\t\t\t);\n\t\t\t\treturn compatOpening[ method ].apply( this, arguments );\n\t\t\t};\n\t\t} );\n\n\t// Argument handling\n\tif ( typeof win === 'string' ) {\n\t\tthis.getWindow( win ).then(\n\t\t\tfunction ( win ) {\n\t\t\t\tmanager.openWindow( win, data, lifecycle, compatOpening );\n\t\t\t},\n\t\t\tfunction ( err ) {\n\t\t\t\tlifecycle.deferreds.opening.reject( err );\n\t\t\t}\n\t\t);\n\t\treturn lifecycle;\n\t}\n\n\t// Error handling\n\tif ( !this.hasWindow( win ) ) {\n\t\tcompatOpening.reject( new OO.ui.Error(\n\t\t\t'Cannot open window: window is not attached to manager'\n\t\t) );\n\t\tlifecycle.deferreds.opening.reject( new OO.ui.Error(\n\t\t\t'Cannot open window: window is not attached to manager'\n\t\t) );\n\t\treturn lifecycle;\n\t}\n\tif ( this.preparingToOpen || ( this.lifecycle && this.lifecycle.closing.state() !== 'resolved' ) ) {\n\t\tcompatOpening.reject( new OO.ui.Error(\n\t\t\t'Cannot open window: another window is opening or open'\n\t\t) );\n\t\tlifecycle.deferreds.opening.reject( new OO.ui.Error(\n\t\t\t'Cannot open window: another window is opening or open'\n\t\t) );\n\t\treturn lifecycle;\n\t}\n\n\t// If a window is currently closing, wait for it to complete\n\tthis.preparingToOpen = $.when( this.lifecycle && this.lifecycle.closed );\n\t// Ensure handlers get called after preparingToOpen is set\n\tthis.preparingToOpen.done( function () {\n\t\tif ( manager.modal ) {\n\t\t\tmanager.toggleGlobalEvents( true );\n\t\t\tmanager.toggleAriaIsolation( true );\n\t\t}\n\t\tmanager.$returnFocusTo = data.$returnFocusTo !== undefined ? data.$returnFocusTo : $( document.activeElement );\n\t\tmanager.currentWindow = win;\n\t\tmanager.lifecycle = lifecycle;\n\t\tmanager.preparingToOpen = null;\n\t\tmanager.emit( 'opening', win, compatOpening, data );\n\t\tlifecycle.deferreds.opening.resolve( data );\n\t\tsetTimeout( function () {\n\t\t\tmanager.compatOpened = $.Deferred();\n\t\t\twin.setup( data ).then( function () {\n\t\t\t\tmanager.updateWindowSize( win );\n\t\t\t\tcompatOpening.notify( { state: 'setup' } );\n\t\t\t\tsetTimeout( function () {\n\t\t\t\t\twin.ready( data ).then( function () {\n\t\t\t\t\t\tcompatOpening.notify( { state: 'ready' } );\n\t\t\t\t\t\tlifecycle.deferreds.opened.resolve( data );\n\t\t\t\t\t\tcompatOpening.resolve( manager.compatOpened.promise(), data );\n\t\t\t\t\t}, function () {\n\t\t\t\t\t\tlifecycle.deferreds.opened.reject();\n\t\t\t\t\t\tcompatOpening.reject();\n\t\t\t\t\t\tmanager.closeWindow( win );\n\t\t\t\t\t} );\n\t\t\t\t}, manager.getReadyDelay() );\n\t\t\t}, function () {\n\t\t\t\tlifecycle.deferreds.opened.reject();\n\t\t\t\tcompatOpening.reject();\n\t\t\t\tmanager.closeWindow( win );\n\t\t\t} );\n\t\t}, manager.getSetupDelay() );\n\t} );\n\n\treturn lifecycle;\n};\n\n/**\n * Close a window.\n *\n * @param {OO.ui.Window|string} win Window object or symbolic name of window to close\n * @param {Object} [data] Window closing data\n * @return {OO.ui.WindowInstance|jQuery.Promise} A lifecycle object representing this particular\n *  opening of the window. For backwards-compatibility, the object is also a Thenable that is resolved\n *  when the window is done closing (T163510).\n * @fires closing\n */\nOO.ui.WindowManager.prototype.closeWindow = function ( win, data ) {\n\tvar error,\n\t\tmanager = this,\n\t\tcompatClosing = $.Deferred(),\n\t\tlifecycle = this.lifecycle,\n\t\tcompatOpened;\n\n\t// Argument handling\n\tif ( typeof win === 'string' ) {\n\t\twin = this.windows[ win ];\n\t} else if ( !this.hasWindow( win ) ) {\n\t\twin = null;\n\t}\n\n\t// Error handling\n\tif ( !lifecycle ) {\n\t\terror = 'Cannot close window: no window is currently open';\n\t} else if ( !win ) {\n\t\terror = 'Cannot close window: window is not attached to manager';\n\t} else if ( win !== this.currentWindow ) {\n\t\terror = 'Cannot close window: window already closed with different data';\n\t} else if ( this.preparingToClose || lifecycle.closing.state() === 'resolved' ) {\n\t\terror = 'Cannot close window: window already closing with different data';\n\t}\n\n\tif ( error ) {\n\t\t// This function was called for the wrong window and we don't want to mess with the current\n\t\t// window's state.\n\t\tlifecycle = new OO.ui.WindowInstance();\n\t\t// Pretend the window has been opened, so that we can pretend to fail to close it.\n\t\tlifecycle.deferreds.opening.resolve( {} );\n\t\tlifecycle.deferreds.opened.resolve( {} );\n\t}\n\n\t// Turn lifecycle into a Thenable for backwards-compatibility with\n\t// the deprecated nested-promise behaviour (T163510).\n\t[ 'state', 'always', 'catch', 'pipe', 'then', 'promise', 'progress', 'done', 'fail' ]\n\t\t.forEach( function ( method ) {\n\t\t\tlifecycle[ method ] = function () {\n\t\t\t\tOO.ui.warnDeprecation(\n\t\t\t\t\t'Using the return value of closeWindow as a promise is deprecated. ' +\n\t\t\t\t\t'Use .closeWindow( ... ).closed.' + method + '( ... ) instead.'\n\t\t\t\t);\n\t\t\t\treturn compatClosing[ method ].apply( this, arguments );\n\t\t\t};\n\t\t} );\n\n\tif ( error ) {\n\t\tcompatClosing.reject( new OO.ui.Error( error ) );\n\t\tlifecycle.deferreds.closing.reject( new OO.ui.Error( error ) );\n\t\treturn lifecycle;\n\t}\n\n\t// If the window is currently opening, close it when it's done\n\tthis.preparingToClose = $.when( this.lifecycle.opened );\n\t// Ensure handlers get called after preparingToClose is set\n\tthis.preparingToClose.always( function () {\n\t\tmanager.preparingToClose = null;\n\t\tmanager.emit( 'closing', win, compatClosing, data );\n\t\tlifecycle.deferreds.closing.resolve( data );\n\t\tcompatOpened = manager.compatOpened;\n\t\tmanager.compatOpened = null;\n\t\tcompatOpened.resolve( compatClosing.promise(), data );\n\t\tsetTimeout( function () {\n\t\t\twin.hold( data ).then( function () {\n\t\t\t\tcompatClosing.notify( { state: 'hold' } );\n\t\t\t\tsetTimeout( function () {\n\t\t\t\t\twin.teardown( data ).then( function () {\n\t\t\t\t\t\tcompatClosing.notify( { state: 'teardown' } );\n\t\t\t\t\t\tif ( manager.modal ) {\n\t\t\t\t\t\t\tmanager.toggleGlobalEvents( false );\n\t\t\t\t\t\t\tmanager.toggleAriaIsolation( false );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( manager.$returnFocusTo && manager.$returnFocusTo.length ) {\n\t\t\t\t\t\t\tmanager.$returnFocusTo[ 0 ].focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmanager.currentWindow = null;\n\t\t\t\t\t\tmanager.lifecycle = null;\n\t\t\t\t\t\tlifecycle.deferreds.closed.resolve( data );\n\t\t\t\t\t\tcompatClosing.resolve( data );\n\t\t\t\t\t} );\n\t\t\t\t}, manager.getTeardownDelay() );\n\t\t\t} );\n\t\t}, manager.getHoldDelay() );\n\t} );\n\n\treturn lifecycle;\n};\n\n/**\n * Add windows to the window manager.\n *\n * Windows can be added by reference, symbolic name, or explicitly defined symbolic names.\n * See the [OOjs ui documentation on MediaWiki] [2] for examples.\n * [2]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Window_managers\n *\n * This function can be called in two manners:\n *\n * 1. `.addWindows( [ windowA, windowB, ... ] )` (where `windowA`, `windowB` are OO.ui.Window objects)\n *\n *    This syntax registers windows under the symbolic names defined in their `.static.name`\n *    properties. For example, if `windowA.constructor.static.name` is `'nameA'`, calling\n *    `.openWindow( 'nameA' )` afterwards will open the window `windowA`. This syntax requires the\n *    static name to be set, otherwise an exception will be thrown.\n *\n *    This is the recommended way, as it allows for an easier switch to using a window factory.\n *\n * 2. `.addWindows( { nameA: windowA, nameB: windowB, ... } )`\n *\n *    This syntax registers windows under the explicitly given symbolic names. In this example,\n *    calling `.openWindow( 'nameA' )` afterwards will open the window `windowA`, regardless of what\n *    its `.static.name` is set to. The static name is not required to be set.\n *\n *    This should only be used if you need to override the default symbolic names.\n *\n * Example:\n *\n *     var windowManager = new OO.ui.WindowManager();\n *     $( 'body' ).append( windowManager.$element );\n *\n *     // Add a window under the default name: see OO.ui.MessageDialog.static.name\n *     windowManager.addWindows( [ new OO.ui.MessageDialog() ] );\n *     // Add a window under an explicit name\n *     windowManager.addWindows( { myMessageDialog: new OO.ui.MessageDialog() } );\n *\n *     // Open window by default name\n *     windowManager.openWindow( 'message' );\n *     // Open window by explicitly given name\n *     windowManager.openWindow( 'myMessageDialog' );\n *\n *\n * @param {Object.<string,OO.ui.Window>|OO.ui.Window[]} windows An array of window objects specified\n *  by reference, symbolic name, or explicitly defined symbolic names.\n * @throws {Error} An error is thrown if a window is added by symbolic name, but has neither an\n *  explicit nor a statically configured symbolic name.\n */\nOO.ui.WindowManager.prototype.addWindows = function ( windows ) {\n\tvar i, len, win, name, list;\n\n\tif ( Array.isArray( windows ) ) {\n\t\t// Convert to map of windows by looking up symbolic names from static configuration\n\t\tlist = {};\n\t\tfor ( i = 0, len = windows.length; i < len; i++ ) {\n\t\t\tname = windows[ i ].constructor.static.name;\n\t\t\tif ( !name ) {\n\t\t\t\tthrow new Error( 'Windows must have a `name` static property defined.' );\n\t\t\t}\n\t\t\tlist[ name ] = windows[ i ];\n\t\t}\n\t} else if ( OO.isPlainObject( windows ) ) {\n\t\tlist = windows;\n\t}\n\n\t// Add windows\n\tfor ( name in list ) {\n\t\twin = list[ name ];\n\t\tthis.windows[ name ] = win.toggle( false );\n\t\tthis.$element.append( win.$element );\n\t\twin.setManager( this );\n\t}\n};\n\n/**\n * Remove the specified windows from the windows manager.\n *\n * Windows will be closed before they are removed. If you wish to remove all windows, you may wish to use\n * the #clearWindows method instead. If you no longer need the window manager and want to ensure that it no\n * longer listens to events, use the #destroy method.\n *\n * @param {string[]} names Symbolic names of windows to remove\n * @return {jQuery.Promise} Promise resolved when window is closed and removed\n * @throws {Error} An error is thrown if the named windows are not managed by the window manager.\n */\nOO.ui.WindowManager.prototype.removeWindows = function ( names ) {\n\tvar i, len, win, name, cleanupWindow,\n\t\tmanager = this,\n\t\tpromises = [],\n\t\tcleanup = function ( name, win ) {\n\t\t\tdelete manager.windows[ name ];\n\t\t\twin.$element.detach();\n\t\t};\n\n\tfor ( i = 0, len = names.length; i < len; i++ ) {\n\t\tname = names[ i ];\n\t\twin = this.windows[ name ];\n\t\tif ( !win ) {\n\t\t\tthrow new Error( 'Cannot remove window' );\n\t\t}\n\t\tcleanupWindow = cleanup.bind( null, name, win );\n\t\tpromises.push( this.closeWindow( name ).closed.then( cleanupWindow, cleanupWindow ) );\n\t}\n\n\treturn $.when.apply( $, promises );\n};\n\n/**\n * Remove all windows from the window manager.\n *\n * Windows will be closed before they are removed. Note that the window manager, though not in use, will still\n * listen to events. If the window manager will not be used again, you may wish to use the #destroy method instead.\n * To remove just a subset of windows, use the #removeWindows method.\n *\n * @return {jQuery.Promise} Promise resolved when all windows are closed and removed\n */\nOO.ui.WindowManager.prototype.clearWindows = function () {\n\treturn this.removeWindows( Object.keys( this.windows ) );\n};\n\n/**\n * Set dialog size. In general, this method should not be called directly.\n *\n * Fullscreen mode will be used if the dialog is too wide to fit in the screen.\n *\n * @param {OO.ui.Window} win Window to update, should be the current window\n * @chainable\n */\nOO.ui.WindowManager.prototype.updateWindowSize = function ( win ) {\n\tvar isFullscreen;\n\n\t// Bypass for non-current, and thus invisible, windows\n\tif ( win !== this.currentWindow ) {\n\t\treturn;\n\t}\n\n\tisFullscreen = win.getSize() === 'full';\n\n\tthis.$element.toggleClass( 'oo-ui-windowManager-fullscreen', isFullscreen );\n\tthis.$element.toggleClass( 'oo-ui-windowManager-floating', !isFullscreen );\n\twin.setDimensions( win.getSizeProperties() );\n\n\tthis.emit( 'resize', win );\n\n\treturn this;\n};\n\n/**\n * Bind or unbind global events for scrolling.\n *\n * @private\n * @param {boolean} [on] Bind global events\n * @chainable\n */\nOO.ui.WindowManager.prototype.toggleGlobalEvents = function ( on ) {\n\tvar scrollWidth, bodyMargin,\n\t\t$body = $( this.getElementDocument().body ),\n\t\t// We could have multiple window managers open so only modify\n\t\t// the body css at the bottom of the stack\n\t\tstackDepth = $body.data( 'windowManagerGlobalEvents' ) || 0;\n\n\ton = on === undefined ? !!this.globalEvents : !!on;\n\n\tif ( on ) {\n\t\tif ( !this.globalEvents ) {\n\t\t\t$( this.getElementWindow() ).on( {\n\t\t\t\t// Start listening for top-level window dimension changes\n\t\t\t\t'orientationchange resize': this.onWindowResizeHandler\n\t\t\t} );\n\t\t\tif ( stackDepth === 0 ) {\n\t\t\t\tscrollWidth = window.innerWidth - document.documentElement.clientWidth;\n\t\t\t\tbodyMargin = parseFloat( $body.css( 'margin-right' ) ) || 0;\n\t\t\t\t$body.css( {\n\t\t\t\t\toverflow: 'hidden',\n\t\t\t\t\t'margin-right': bodyMargin + scrollWidth\n\t\t\t\t} );\n\t\t\t}\n\t\t\tstackDepth++;\n\t\t\tthis.globalEvents = true;\n\t\t}\n\t} else if ( this.globalEvents ) {\n\t\t$( this.getElementWindow() ).off( {\n\t\t\t// Stop listening for top-level window dimension changes\n\t\t\t'orientationchange resize': this.onWindowResizeHandler\n\t\t} );\n\t\tstackDepth--;\n\t\tif ( stackDepth === 0 ) {\n\t\t\t$body.css( {\n\t\t\t\toverflow: '',\n\t\t\t\t'margin-right': ''\n\t\t\t} );\n\t\t}\n\t\tthis.globalEvents = false;\n\t}\n\t$body.data( 'windowManagerGlobalEvents', stackDepth );\n\n\treturn this;\n};\n\n/**\n * Toggle screen reader visibility of content other than the window manager.\n *\n * @private\n * @param {boolean} [isolate] Make only the window manager visible to screen readers\n * @chainable\n */\nOO.ui.WindowManager.prototype.toggleAriaIsolation = function ( isolate ) {\n\tisolate = isolate === undefined ? !this.$ariaHidden : !!isolate;\n\n\tif ( isolate ) {\n\t\tif ( !this.$ariaHidden ) {\n\t\t\t// Hide everything other than the window manager from screen readers\n\t\t\tthis.$ariaHidden = $( 'body' )\n\t\t\t\t.children()\n\t\t\t\t.not( this.$element.parentsUntil( 'body' ).last() )\n\t\t\t\t.attr( 'aria-hidden', '' );\n\t\t}\n\t} else if ( this.$ariaHidden ) {\n\t\t// Restore screen reader visibility\n\t\tthis.$ariaHidden.removeAttr( 'aria-hidden' );\n\t\tthis.$ariaHidden = null;\n\t}\n\n\treturn this;\n};\n\n/**\n * Destroy the window manager.\n *\n * Destroying the window manager ensures that it will no longer listen to events. If you would like to\n * continue using the window manager, but wish to remove all windows from it, use the #clearWindows method\n * instead.\n */\nOO.ui.WindowManager.prototype.destroy = function () {\n\tthis.toggleGlobalEvents( false );\n\tthis.toggleAriaIsolation( false );\n\tthis.clearWindows();\n\tthis.$element.remove();\n};\n\n/**\n * A window is a container for elements that are in a child frame. They are used with\n * a window manager (OO.ui.WindowManager), which is used to open and close the window and control\n * its presentation. The size of a window is specified using a symbolic name (e.g., ‘small’, ‘medium’,\n * ‘large’), which is interpreted by the window manager. If the requested size is not recognized,\n * the window manager will choose a sensible fallback.\n *\n * The lifecycle of a window has three primary stages (opening, opened, and closing) in which\n * different processes are executed:\n *\n * **opening**: The opening stage begins when the window manager's {@link OO.ui.WindowManager#openWindow\n * openWindow} or the window's {@link #open open} methods are used, and the window manager begins to open\n * the window.\n *\n * - {@link #getSetupProcess} method is called and its result executed\n * - {@link #getReadyProcess} method is called and its result executed\n *\n * **opened**: The window is now open\n *\n * **closing**: The closing stage begins when the window manager's\n * {@link OO.ui.WindowManager#closeWindow closeWindow}\n * or the window's {@link #close} methods are used, and the window manager begins to close the window.\n *\n * - {@link #getHoldProcess} method is called and its result executed\n * - {@link #getTeardownProcess} method is called and its result executed. The window is now closed\n *\n * Each of the window's processes (setup, ready, hold, and teardown) can be extended in subclasses\n * by overriding the window's #getSetupProcess, #getReadyProcess, #getHoldProcess and #getTeardownProcess\n * methods. Note that each {@link OO.ui.Process process} is executed in series, so asynchronous\n * processing can complete. Always assume window processes are executed asynchronously.\n *\n * For more information, please see the [OOjs UI documentation on MediaWiki] [1].\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows\n *\n * @abstract\n * @class\n * @extends OO.ui.Element\n * @mixins OO.EventEmitter\n *\n * @constructor\n * @param {Object} [config] Configuration options\n * @cfg {string} [size] Symbolic name of the dialog size: `small`, `medium`, `large`, `larger` or\n *  `full`.  If omitted, the value of the {@link #static-size static size} property will be used.\n */\nOO.ui.Window = function OoUiWindow( config ) {\n\t// Configuration initialization\n\tconfig = config || {};\n\n\t// Parent constructor\n\tOO.ui.Window.parent.call( this, config );\n\n\t// Mixin constructors\n\tOO.EventEmitter.call( this );\n\n\t// Properties\n\tthis.manager = null;\n\tthis.size = config.size || this.constructor.static.size;\n\tthis.$frame = $( '<div>' );\n\t/**\n\t * Overlay element to use for the `$overlay` configuration option of widgets that support it.\n\t * Things put inside of it are overlaid on top of the window and are not bound to its dimensions.\n\t * See <https://www.mediawiki.org/wiki/OOjs_UI/Concepts#Overlays>.\n\t *\n\t *     MyDialog.prototype.initialize = function () {\n\t *       ...\n\t *       var popupButton = new OO.ui.PopupButtonWidget( {\n\t *         $overlay: this.$overlay,\n\t *         label: 'Popup button',\n\t *         popup: {\n\t *           $content: $( '<p>Popup contents.</p><p>Popup contents.</p><p>Popup contents.</p>' ),\n\t *           padded: true\n\t *         }\n\t *       } );\n\t *       ...\n\t *     };\n\t *\n\t * @property {jQuery}\n\t */\n\tthis.$overlay = $( '<div>' );\n\tthis.$content = $( '<div>' );\n\n\tthis.$focusTrapBefore = $( '<div>' ).prop( 'tabIndex', 0 );\n\tthis.$focusTrapAfter = $( '<div>' ).prop( 'tabIndex', 0 );\n\tthis.$focusTraps = this.$focusTrapBefore.add( this.$focusTrapAfter );\n\n\t// Initialization\n\tthis.$overlay.addClass( 'oo-ui-window-overlay' );\n\tthis.$content\n\t\t.addClass( 'oo-ui-window-content' )\n\t\t.attr( 'tabindex', 0 );\n\tthis.$frame\n\t\t.addClass( 'oo-ui-window-frame' )\n\t\t.append( this.$focusTrapBefore, this.$content, this.$focusTrapAfter );\n\n\tthis.$element\n\t\t.addClass( 'oo-ui-window' )\n\t\t.append( this.$frame, this.$overlay );\n\n\t// Initially hidden - using #toggle may cause errors if subclasses override toggle with methods\n\t// that reference properties not initialized at that time of parent class construction\n\t// TODO: Find a better way to handle post-constructor setup\n\tthis.visible = false;\n\tthis.$element.addClass( 'oo-ui-element-hidden' );\n};\n\n/* Setup */\n\nOO.inheritClass( OO.ui.Window, OO.ui.Element );\nOO.mixinClass( OO.ui.Window, OO.EventEmitter );\n\n/* Static Properties */\n\n/**\n * Symbolic name of the window size: `small`, `medium`, `large`, `larger` or `full`.\n *\n * The static size is used if no #size is configured during construction.\n *\n * @static\n * @inheritable\n * @property {string}\n */\nOO.ui.Window.static.size = 'medium';\n\n/* Methods */\n\n/**\n * Handle mouse down events.\n *\n * @private\n * @param {jQuery.Event} e Mouse down event\n */\nOO.ui.Window.prototype.onMouseDown = function ( e ) {\n\t// Prevent clicking on the click-block from stealing focus\n\tif ( e.target === this.$element[ 0 ] ) {\n\t\treturn false;\n\t}\n};\n\n/**\n * Check if the window has been initialized.\n *\n * Initialization occurs when a window is added to a manager.\n *\n * @return {boolean} Window has been initialized\n */\nOO.ui.Window.prototype.isInitialized = function () {\n\treturn !!this.manager;\n};\n\n/**\n * Check if the window is visible.\n *\n * @return {boolean} Window is visible\n */\nOO.ui.Window.prototype.isVisible = function () {\n\treturn this.visible;\n};\n\n/**\n * Check if the window is opening.\n *\n * This method is a wrapper around the window manager's {@link OO.ui.WindowManager#isOpening isOpening}\n * method.\n *\n * @return {boolean} Window is opening\n */\nOO.ui.Window.prototype.isOpening = function () {\n\treturn this.manager.isOpening( this );\n};\n\n/**\n * Check if the window is closing.\n *\n * This method is a wrapper around the window manager's {@link OO.ui.WindowManager#isClosing isClosing} method.\n *\n * @return {boolean} Window is closing\n */\nOO.ui.Window.prototype.isClosing = function () {\n\treturn this.manager.isClosing( this );\n};\n\n/**\n * Check if the window is opened.\n *\n * This method is a wrapper around the window manager's {@link OO.ui.WindowManager#isOpened isOpened} method.\n *\n * @return {boolean} Window is opened\n */\nOO.ui.Window.prototype.isOpened = function () {\n\treturn this.manager.isOpened( this );\n};\n\n/**\n * Get the window manager.\n *\n * All windows must be attached to a window manager, which is used to open\n * and close the window and control its presentation.\n *\n * @return {OO.ui.WindowManager} Manager of window\n */\nOO.ui.Window.prototype.getManager = function () {\n\treturn this.manager;\n};\n\n/**\n * Get the symbolic name of the window size (e.g., `small` or `medium`).\n *\n * @return {string} Symbolic name of the size: `small`, `medium`, `large`, `larger`, `full`\n */\nOO.ui.Window.prototype.getSize = function () {\n\tvar viewport = OO.ui.Element.static.getDimensions( this.getElementWindow() ),\n\t\tsizes = this.manager.constructor.static.sizes,\n\t\tsize = this.size;\n\n\tif ( !sizes[ size ] ) {\n\t\tsize = this.manager.constructor.static.defaultSize;\n\t}\n\tif ( size !== 'full' && viewport.rect.right - viewport.rect.left < sizes[ size ].width ) {\n\t\tsize = 'full';\n\t}\n\n\treturn size;\n};\n\n/**\n * Get the size properties associated with the current window size\n *\n * @return {Object} Size properties\n */\nOO.ui.Window.prototype.getSizeProperties = function () {\n\treturn this.manager.constructor.static.sizes[ this.getSize() ];\n};\n\n/**\n * Disable transitions on window's frame for the duration of the callback function, then enable them\n * back.\n *\n * @private\n * @param {Function} callback Function to call while transitions are disabled\n */\nOO.ui.Window.prototype.withoutSizeTransitions = function ( callback ) {\n\t// Temporarily resize the frame so getBodyHeight() can use scrollHeight measurements.\n\t// Disable transitions first, otherwise we'll get values from when the window was animating.\n\t// We need to build the transition CSS properties using these specific properties since\n\t// Firefox doesn't return anything useful when asked just for 'transition'.\n\tvar oldTransition = this.$frame.css( 'transition-property' ) + ' ' +\n\t\tthis.$frame.css( 'transition-duration' ) + ' ' +\n\t\tthis.$frame.css( 'transition-timing-function' ) + ' ' +\n\t\tthis.$frame.css( 'transition-delay' );\n\n\tthis.$frame.css( 'transition', 'none' );\n\tcallback();\n\n\t// Force reflow to make sure the style changes done inside callback\n\t// really are not transitioned\n\tthis.$frame.height();\n\tthis.$frame.css( 'transition', oldTransition );\n};\n\n/**\n * Get the height of the full window contents (i.e., the window head, body and foot together).\n *\n * What consistitutes the head, body, and foot varies depending on the window type.\n * A {@link OO.ui.MessageDialog message dialog} displays a title and message in its body,\n * and any actions in the foot. A {@link OO.ui.ProcessDialog process dialog} displays a title\n * and special actions in the head, and dialog content in the body.\n *\n * To get just the height of the dialog body, use the #getBodyHeight method.\n *\n * @return {number} The height of the window contents (the dialog head, body and foot) in pixels\n */\nOO.ui.Window.prototype.getContentHeight = function () {\n\tvar bodyHeight,\n\t\twin = this,\n\t\tbodyStyleObj = this.$body[ 0 ].style,\n\t\tframeStyleObj = this.$frame[ 0 ].style;\n\n\t// Temporarily resize the frame so getBodyHeight() can use scrollHeight measurements.\n\t// Disable transitions first, otherwise we'll get values from when the window was animating.\n\tthis.withoutSizeTransitions( function () {\n\t\tvar oldHeight = frameStyleObj.height,\n\t\t\toldPosition = bodyStyleObj.position;\n\t\tframeStyleObj.height = '1px';\n\t\t// Force body to resize to new width\n\t\tbodyStyleObj.position = 'relative';\n\t\tbodyHeight = win.getBodyHeight();\n\t\tframeStyleObj.height = oldHeight;\n\t\tbodyStyleObj.position = oldPosition;\n\t} );\n\n\treturn (\n\t\t// Add buffer for border\n\t\t( this.$frame.outerHeight() - this.$frame.innerHeight() ) +\n\t\t// Use combined heights of children\n\t\t( this.$head.outerHeight( true ) + bodyHeight + this.$foot.outerHeight( true ) )\n\t);\n};\n\n/**\n * Get the height of the window body.\n *\n * To get the height of the full window contents (the window body, head, and foot together),\n * use #getContentHeight.\n *\n * When this function is called, the window will temporarily have been resized\n * to height=1px, so .scrollHeight measurements can be taken accurately.\n *\n * @return {number} Height of the window body in pixels\n */\nOO.ui.Window.prototype.getBodyHeight = function () {\n\treturn this.$body[ 0 ].scrollHeight;\n};\n\n/**\n * Get the directionality of the frame (right-to-left or left-to-right).\n *\n * @return {string} Directionality: `'ltr'` or `'rtl'`\n */\nOO.ui.Window.prototype.getDir = function () {\n\treturn OO.ui.Element.static.getDir( this.$content ) || 'ltr';\n};\n\n/**\n * Get the 'setup' process.\n *\n * The setup process is used to set up a window for use in a particular context,\n * based on the `data` argument. This method is called during the opening phase of the window’s\n * lifecycle.\n *\n * Override this method to add additional steps to the ‘setup’ process the parent method provides\n * using the {@link OO.ui.Process#first first} and {@link OO.ui.Process#next next} methods\n * of OO.ui.Process.\n *\n * To add window content that persists between openings, you may wish to use the #initialize method\n * instead.\n *\n * @param {Object} [data] Window opening data\n * @return {OO.ui.Process} Setup process\n */\nOO.ui.Window.prototype.getSetupProcess = function () {\n\treturn new OO.ui.Process();\n};\n\n/**\n * Get the ‘ready’ process.\n *\n * The ready process is used to ready a window for use in a particular\n * context, based on the `data` argument. This method is called during the opening phase of\n * the window’s lifecycle, after the window has been {@link #getSetupProcess setup}.\n *\n * Override this method to add additional steps to the ‘ready’ process the parent method\n * provides using the {@link OO.ui.Process#first first} and {@link OO.ui.Process#next next}\n * methods of OO.ui.Process.\n *\n * @param {Object} [data] Window opening data\n * @return {OO.ui.Process} Ready process\n */\nOO.ui.Window.prototype.getReadyProcess = function () {\n\treturn new OO.ui.Process();\n};\n\n/**\n * Get the 'hold' process.\n *\n * The hold process is used to keep a window from being used in a particular context,\n * based on the `data` argument. This method is called during the closing phase of the window’s\n * lifecycle.\n *\n * Override this method to add additional steps to the 'hold' process the parent method provides\n * using the {@link OO.ui.Process#first first} and {@link OO.ui.Process#next next} methods\n * of OO.ui.Process.\n *\n * @param {Object} [data] Window closing data\n * @return {OO.ui.Process} Hold process\n */\nOO.ui.Window.prototype.getHoldProcess = function () {\n\treturn new OO.ui.Process();\n};\n\n/**\n * Get the ‘teardown’ process.\n *\n * The teardown process is used to teardown a window after use. During teardown,\n * user interactions within the window are conveyed and the window is closed, based on the `data`\n * argument. This method is called during the closing phase of the window’s lifecycle.\n *\n * Override this method to add additional steps to the ‘teardown’ process the parent method provides\n * using the {@link OO.ui.Process#first first} and {@link OO.ui.Process#next next} methods\n * of OO.ui.Process.\n *\n * @param {Object} [data] Window closing data\n * @return {OO.ui.Process} Teardown process\n */\nOO.ui.Window.prototype.getTeardownProcess = function () {\n\treturn new OO.ui.Process();\n};\n\n/**\n * Set the window manager.\n *\n * This will cause the window to initialize. Calling it more than once will cause an error.\n *\n * @param {OO.ui.WindowManager} manager Manager for this window\n * @throws {Error} An error is thrown if the method is called more than once\n * @chainable\n */\nOO.ui.Window.prototype.setManager = function ( manager ) {\n\tif ( this.manager ) {\n\t\tthrow new Error( 'Cannot set window manager, window already has a manager' );\n\t}\n\n\tthis.manager = manager;\n\tthis.initialize();\n\n\treturn this;\n};\n\n/**\n * Set the window size by symbolic name (e.g., 'small' or 'medium')\n *\n * @param {string} size Symbolic name of size: `small`, `medium`, `large`, `larger` or\n *  `full`\n * @chainable\n */\nOO.ui.Window.prototype.setSize = function ( size ) {\n\tthis.size = size;\n\tthis.updateSize();\n\treturn this;\n};\n\n/**\n * Update the window size.\n *\n * @throws {Error} An error is thrown if the window is not attached to a window manager\n * @chainable\n */\nOO.ui.Window.prototype.updateSize = function () {\n\tif ( !this.manager ) {\n\t\tthrow new Error( 'Cannot update window size, must be attached to a manager' );\n\t}\n\n\tthis.manager.updateWindowSize( this );\n\n\treturn this;\n};\n\n/**\n * Set window dimensions. This method is called by the {@link OO.ui.WindowManager window manager}\n * when the window is opening. In general, setDimensions should not be called directly.\n *\n * To set the size of the window, use the #setSize method.\n *\n * @param {Object} dim CSS dimension properties\n * @param {string|number} [dim.width] Width\n * @param {string|number} [dim.minWidth] Minimum width\n * @param {string|number} [dim.maxWidth] Maximum width\n * @param {string|number} [dim.height] Height, omit to set based on height of contents\n * @param {string|number} [dim.minHeight] Minimum height\n * @param {string|number} [dim.maxHeight] Maximum height\n * @chainable\n */\nOO.ui.Window.prototype.setDimensions = function ( dim ) {\n\tvar height,\n\t\twin = this,\n\t\tstyleObj = this.$frame[ 0 ].style;\n\n\t// Calculate the height we need to set using the correct width\n\tif ( dim.height === undefined ) {\n\t\tthis.withoutSizeTransitions( function () {\n\t\t\tvar oldWidth = styleObj.width;\n\t\t\twin.$frame.css( 'width', dim.width || '' );\n\t\t\theight = win.getContentHeight();\n\t\t\tstyleObj.width = oldWidth;\n\t\t} );\n\t} else {\n\t\theight = dim.height;\n\t}\n\n\tthis.$frame.css( {\n\t\twidth: dim.width || '',\n\t\tminWidth: dim.minWidth || '',\n\t\tmaxWidth: dim.maxWidth || '',\n\t\theight: height || '',\n\t\tminHeight: dim.minHeight || '',\n\t\tmaxHeight: dim.maxHeight || ''\n\t} );\n\n\treturn this;\n};\n\n/**\n * Initialize window contents.\n *\n * Before the window is opened for the first time, #initialize is called so that content that\n * persists between openings can be added to the window.\n *\n * To set up a window with new content each time the window opens, use #getSetupProcess.\n *\n * @throws {Error} An error is thrown if the window is not attached to a window manager\n * @chainable\n */\nOO.ui.Window.prototype.initialize = function () {\n\tif ( !this.manager ) {\n\t\tthrow new Error( 'Cannot initialize window, must be attached to a manager' );\n\t}\n\n\t// Properties\n\tthis.$head = $( '<div>' );\n\tthis.$body = $( '<div>' );\n\tthis.$foot = $( '<div>' );\n\tthis.$document = $( this.getElementDocument() );\n\n\t// Events\n\tthis.$element.on( 'mousedown', this.onMouseDown.bind( this ) );\n\n\t// Initialization\n\tthis.$head.addClass( 'oo-ui-window-head' );\n\tthis.$body.addClass( 'oo-ui-window-body' );\n\tthis.$foot.addClass( 'oo-ui-window-foot' );\n\tthis.$content.append( this.$head, this.$body, this.$foot );\n\n\treturn this;\n};\n\n/**\n * Called when someone tries to focus the hidden element at the end of the dialog.\n * Sends focus back to the start of the dialog.\n *\n * @param {jQuery.Event} event Focus event\n */\nOO.ui.Window.prototype.onFocusTrapFocused = function ( event ) {\n\tvar backwards = this.$focusTrapBefore.is( event.target ),\n\t\telement = OO.ui.findFocusable( this.$content, backwards );\n\tif ( element ) {\n\t\t// There's a focusable element inside the content, at the front or\n\t\t// back depending on which focus trap we hit; select it.\n\t\telement.focus();\n\t} else {\n\t\t// There's nothing focusable inside the content. As a fallback,\n\t\t// this.$content is focusable, and focusing it will keep our focus\n\t\t// properly trapped. It's not a *meaningful* focus, since it's just\n\t\t// the content-div for the Window, but it's better than letting focus\n\t\t// escape into the page.\n\t\tthis.$content.focus();\n\t}\n};\n\n/**\n * Open the window.\n *\n * This method is a wrapper around a call to the window manager’s {@link OO.ui.WindowManager#openWindow openWindow}\n * method, which returns a promise resolved when the window is done opening.\n *\n * To customize the window each time it opens, use #getSetupProcess or #getReadyProcess.\n *\n * @param {Object} [data] Window opening data\n * @return {jQuery.Promise} Promise resolved with a value when the window is opened, or rejected\n *  if the window fails to open. When the promise is resolved successfully, the first argument of the\n *  value is a new promise, which is resolved when the window begins closing.\n * @throws {Error} An error is thrown if the window is not attached to a window manager\n */\nOO.ui.Window.prototype.open = function ( data ) {\n\tif ( !this.manager ) {\n\t\tthrow new Error( 'Cannot open window, must be attached to a manager' );\n\t}\n\n\treturn this.manager.openWindow( this, data );\n};\n\n/**\n * Close the window.\n *\n * This method is a wrapper around a call to the window\n * manager’s {@link OO.ui.WindowManager#closeWindow closeWindow} method,\n * which returns a closing promise resolved when the window is done closing.\n *\n * The window's #getHoldProcess and #getTeardownProcess methods are called during the closing\n * phase of the window’s lifecycle and can be used to specify closing behavior each time\n * the window closes.\n *\n * @param {Object} [data] Window closing data\n * @return {jQuery.Promise} Promise resolved when window is closed\n * @throws {Error} An error is thrown if the window is not attached to a window manager\n */\nOO.ui.Window.prototype.close = function ( data ) {\n\tif ( !this.manager ) {\n\t\tthrow new Error( 'Cannot close window, must be attached to a manager' );\n\t}\n\n\treturn this.manager.closeWindow( this, data );\n};\n\n/**\n * Setup window.\n *\n * This is called by OO.ui.WindowManager during window opening, and should not be called directly\n * by other systems.\n *\n * @param {Object} [data] Window opening data\n * @return {jQuery.Promise} Promise resolved when window is setup\n */\nOO.ui.Window.prototype.setup = function ( data ) {\n\tvar win = this;\n\n\tthis.toggle( true );\n\n\tthis.focusTrapHandler = OO.ui.bind( this.onFocusTrapFocused, this );\n\tthis.$focusTraps.on( 'focus', this.focusTrapHandler );\n\n\treturn this.getSetupProcess( data ).execute().then( function () {\n\t\t// Force redraw by asking the browser to measure the elements' widths\n\t\twin.$element.addClass( 'oo-ui-window-active oo-ui-window-setup' ).width();\n\t\twin.$content.addClass( 'oo-ui-window-content-setup' ).width();\n\t} );\n};\n\n/**\n * Ready window.\n *\n * This is called by OO.ui.WindowManager during window opening, and should not be called directly\n * by other systems.\n *\n * @param {Object} [data] Window opening data\n * @return {jQuery.Promise} Promise resolved when window is ready\n */\nOO.ui.Window.prototype.ready = function ( data ) {\n\tvar win = this;\n\n\tthis.$content.focus();\n\treturn this.getReadyProcess( data ).execute().then( function () {\n\t\t// Force redraw by asking the browser to measure the elements' widths\n\t\twin.$element.addClass( 'oo-ui-window-ready' ).width();\n\t\twin.$content.addClass( 'oo-ui-window-content-ready' ).width();\n\t} );\n};\n\n/**\n * Hold window.\n *\n * This is called by OO.ui.WindowManager during window closing, and should not be called directly\n * by other systems.\n *\n * @param {Object} [data] Window closing data\n * @return {jQuery.Promise} Promise resolved when window is held\n */\nOO.ui.Window.prototype.hold = function ( data ) {\n\tvar win = this;\n\n\treturn this.getHoldProcess( data ).execute().then( function () {\n\t\t// Get the focused element within the window's content\n\t\tvar $focus = win.$content.find( OO.ui.Element.static.getDocument( win.$content ).activeElement );\n\n\t\t// Blur the focused element\n\t\tif ( $focus.length ) {\n\t\t\t$focus[ 0 ].blur();\n\t\t}\n\n\t\t// Force redraw by asking the browser to measure the elements' widths\n\t\twin.$element.removeClass( 'oo-ui-window-ready' ).width();\n\t\twin.$content.removeClass( 'oo-ui-window-content-ready' ).width();\n\t} );\n};\n\n/**\n * Teardown window.\n *\n * This is called by OO.ui.WindowManager during window closing, and should not be called directly\n * by other systems.\n *\n * @param {Object} [data] Window closing data\n * @return {jQuery.Promise} Promise resolved when window is torn down\n */\nOO.ui.Window.prototype.teardown = function ( data ) {\n\tvar win = this;\n\n\treturn this.getTeardownProcess( data ).execute().then( function () {\n\t\t// Force redraw by asking the browser to measure the elements' widths\n\t\twin.$element.removeClass( 'oo-ui-window-active oo-ui-window-setup' ).width();\n\t\twin.$content.removeClass( 'oo-ui-window-content-setup' ).width();\n\t\twin.$focusTraps.off( 'focus', win.focusTrapHandler );\n\t\twin.toggle( false );\n\t} );\n};\n\n/**\n * The Dialog class serves as the base class for the other types of dialogs.\n * Unless extended to include controls, the rendered dialog box is a simple window\n * that users can close by hitting the ‘Esc’ key. Dialog windows are used with OO.ui.WindowManager,\n * which opens, closes, and controls the presentation of the window. See the\n * [OOjs UI documentation on MediaWiki] [1] for more information.\n *\n *     @example\n *     // A simple dialog window.\n *     function MyDialog( config ) {\n *         MyDialog.parent.call( this, config );\n *     }\n *     OO.inheritClass( MyDialog, OO.ui.Dialog );\n *     MyDialog.static.name = 'myDialog';\n *     MyDialog.prototype.initialize = function () {\n *         MyDialog.parent.prototype.initialize.call( this );\n *         this.content = new OO.ui.PanelLayout( { padded: true, expanded: false } );\n *         this.content.$element.append( '<p>A simple dialog window. Press \\'Esc\\' to close.</p>' );\n *         this.$body.append( this.content.$element );\n *     };\n *     MyDialog.prototype.getBodyHeight = function () {\n *         return this.content.$element.outerHeight( true );\n *     };\n *     var myDialog = new MyDialog( {\n *         size: 'medium'\n *     } );\n *     // Create and append a window manager, which opens and closes the window.\n *     var windowManager = new OO.ui.WindowManager();\n *     $( 'body' ).append( windowManager.$element );\n *     windowManager.addWindows( [ myDialog ] );\n *     // Open the window!\n *     windowManager.openWindow( myDialog );\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Dialogs\n *\n * @abstract\n * @class\n * @extends OO.ui.Window\n * @mixins OO.ui.mixin.PendingElement\n *\n * @constructor\n * @param {Object} [config] Configuration options\n */\nOO.ui.Dialog = function OoUiDialog( config ) {\n\t// Parent constructor\n\tOO.ui.Dialog.parent.call( this, config );\n\n\t// Mixin constructors\n\tOO.ui.mixin.PendingElement.call( this );\n\n\t// Properties\n\tthis.actions = new OO.ui.ActionSet();\n\tthis.attachedActions = [];\n\tthis.currentAction = null;\n\tthis.onDialogKeyDownHandler = this.onDialogKeyDown.bind( this );\n\n\t// Events\n\tthis.actions.connect( this, {\n\t\tclick: 'onActionClick',\n\t\tchange: 'onActionsChange'\n\t} );\n\n\t// Initialization\n\tthis.$element\n\t\t.addClass( 'oo-ui-dialog' )\n\t\t.attr( 'role', 'dialog' );\n};\n\n/* Setup */\n\nOO.inheritClass( OO.ui.Dialog, OO.ui.Window );\nOO.mixinClass( OO.ui.Dialog, OO.ui.mixin.PendingElement );\n\n/* Static Properties */\n\n/**\n * Symbolic name of dialog.\n *\n * The dialog class must have a symbolic name in order to be registered with OO.Factory.\n * Please see the [OOjs UI documentation on MediaWiki] [3] for more information.\n *\n * [3]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Window_managers\n *\n * @abstract\n * @static\n * @inheritable\n * @property {string}\n */\nOO.ui.Dialog.static.name = '';\n\n/**\n * The dialog title.\n *\n * The title can be specified as a plaintext string, a {@link OO.ui.mixin.LabelElement Label} node, or a function\n * that will produce a Label node or string. The title can also be specified with data passed to the\n * constructor (see #getSetupProcess). In this case, the static value will be overridden.\n *\n * @abstract\n * @static\n * @inheritable\n * @property {jQuery|string|Function}\n */\nOO.ui.Dialog.static.title = '';\n\n/**\n * An array of configured {@link OO.ui.ActionWidget action widgets}.\n *\n * Actions can also be specified with data passed to the constructor (see #getSetupProcess). In this case, the static\n * value will be overridden.\n *\n * [2]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Process_Dialogs#Action_sets\n *\n * @static\n * @inheritable\n * @property {Object[]}\n */\nOO.ui.Dialog.static.actions = [];\n\n/**\n * Close the dialog when the 'Esc' key is pressed.\n *\n * @static\n * @abstract\n * @inheritable\n * @property {boolean}\n */\nOO.ui.Dialog.static.escapable = true;\n\n/* Methods */\n\n/**\n * Handle frame document key down events.\n *\n * @private\n * @param {jQuery.Event} e Key down event\n */\nOO.ui.Dialog.prototype.onDialogKeyDown = function ( e ) {\n\tvar actions;\n\tif ( e.which === OO.ui.Keys.ESCAPE && this.constructor.static.escapable ) {\n\t\tthis.executeAction( '' );\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t} else if ( e.which === OO.ui.Keys.ENTER && ( e.ctrlKey || e.metaKey ) ) {\n\t\tactions = this.actions.get( { flags: 'primary', visible: true, disabled: false } );\n\t\tif ( actions.length > 0 ) {\n\t\t\tthis.executeAction( actions[ 0 ].getAction() );\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t}\n};\n\n/**\n * Handle action click events.\n *\n * @private\n * @param {OO.ui.ActionWidget} action Action that was clicked\n */\nOO.ui.Dialog.prototype.onActionClick = function ( action ) {\n\tif ( !this.isPending() ) {\n\t\tthis.executeAction( action.getAction() );\n\t}\n};\n\n/**\n * Handle actions change event.\n *\n * @private\n */\nOO.ui.Dialog.prototype.onActionsChange = function () {\n\tthis.detachActions();\n\tif ( !this.isClosing() ) {\n\t\tthis.attachActions();\n\t}\n};\n\n/**\n * Get the set of actions used by the dialog.\n *\n * @return {OO.ui.ActionSet}\n */\nOO.ui.Dialog.prototype.getActions = function () {\n\treturn this.actions;\n};\n\n/**\n * Get a process for taking action.\n *\n * When you override this method, you can create a new OO.ui.Process and return it, or add additional\n * accept steps to the process the parent method provides using the {@link OO.ui.Process#first 'first'}\n * and {@link OO.ui.Process#next 'next'} methods of OO.ui.Process.\n *\n * @param {string} [action] Symbolic name of action\n * @return {OO.ui.Process} Action process\n */\nOO.ui.Dialog.prototype.getActionProcess = function ( action ) {\n\treturn new OO.ui.Process()\n\t\t.next( function () {\n\t\t\tif ( !action ) {\n\t\t\t\t// An empty action always closes the dialog without data, which should always be\n\t\t\t\t// safe and make no changes\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}, this );\n};\n\n/**\n * @inheritdoc\n *\n * @param {Object} [data] Dialog opening data\n * @param {jQuery|string|Function|null} [data.title] Dialog title, omit to use\n *  the {@link #static-title static title}\n * @param {Object[]} [data.actions] List of configuration options for each\n *   {@link OO.ui.ActionWidget action widget}, omit to use {@link #static-actions static actions}.\n */\nOO.ui.Dialog.prototype.getSetupProcess = function ( data ) {\n\tdata = data || {};\n\n\t// Parent method\n\treturn OO.ui.Dialog.parent.prototype.getSetupProcess.call( this, data )\n\t\t.next( function () {\n\t\t\tvar config = this.constructor.static,\n\t\t\t\tactions = data.actions !== undefined ? data.actions : config.actions,\n\t\t\t\ttitle = data.title !== undefined ? data.title : config.title;\n\n\t\t\tthis.title.setLabel( title ).setTitle( title );\n\t\t\tthis.actions.add( this.getActionWidgets( actions ) );\n\n\t\t\tthis.$element.on( 'keydown', this.onDialogKeyDownHandler );\n\t\t}, this );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.Dialog.prototype.getTeardownProcess = function ( data ) {\n\t// Parent method\n\treturn OO.ui.Dialog.parent.prototype.getTeardownProcess.call( this, data )\n\t\t.first( function () {\n\t\t\tthis.$element.off( 'keydown', this.onDialogKeyDownHandler );\n\n\t\t\tthis.actions.clear();\n\t\t\tthis.currentAction = null;\n\t\t}, this );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.Dialog.prototype.initialize = function () {\n\t// Parent method\n\tOO.ui.Dialog.parent.prototype.initialize.call( this );\n\n\t// Properties\n\tthis.title = new OO.ui.LabelWidget();\n\n\t// Initialization\n\tthis.$content.addClass( 'oo-ui-dialog-content' );\n\tthis.$element.attr( 'aria-labelledby', this.title.getElementId() );\n\tthis.setPendingElement( this.$head );\n};\n\n/**\n * Get action widgets from a list of configs\n *\n * @param {Object[]} actions Action widget configs\n * @return {OO.ui.ActionWidget[]} Action widgets\n */\nOO.ui.Dialog.prototype.getActionWidgets = function ( actions ) {\n\tvar i, len, widgets = [];\n\tfor ( i = 0, len = actions.length; i < len; i++ ) {\n\t\twidgets.push(\n\t\t\tnew OO.ui.ActionWidget( actions[ i ] )\n\t\t);\n\t}\n\treturn widgets;\n};\n\n/**\n * Attach action actions.\n *\n * @protected\n */\nOO.ui.Dialog.prototype.attachActions = function () {\n\t// Remember the list of potentially attached actions\n\tthis.attachedActions = this.actions.get();\n};\n\n/**\n * Detach action actions.\n *\n * @protected\n * @chainable\n */\nOO.ui.Dialog.prototype.detachActions = function () {\n\tvar i, len;\n\n\t// Detach all actions that may have been previously attached\n\tfor ( i = 0, len = this.attachedActions.length; i < len; i++ ) {\n\t\tthis.attachedActions[ i ].$element.detach();\n\t}\n\tthis.attachedActions = [];\n};\n\n/**\n * Execute an action.\n *\n * @param {string} action Symbolic name of action to execute\n * @return {jQuery.Promise} Promise resolved when action completes, rejected if it fails\n */\nOO.ui.Dialog.prototype.executeAction = function ( action ) {\n\tthis.pushPending();\n\tthis.currentAction = action;\n\treturn this.getActionProcess( action ).execute()\n\t\t.always( this.popPending.bind( this ) );\n};\n\n/**\n * MessageDialogs display a confirmation or alert message. By default, the rendered dialog box\n * consists of a header that contains the dialog title, a body with the message, and a footer that\n * contains any {@link OO.ui.ActionWidget action widgets}. The MessageDialog class is the only type\n * of {@link OO.ui.Dialog dialog} that is usually instantiated directly.\n *\n * There are two basic types of message dialogs, confirmation and alert:\n *\n * - **confirmation**: the dialog title describes what a progressive action will do and the message provides\n *  more details about the consequences.\n * - **alert**: the dialog title describes which event occurred and the message provides more information\n *  about why the event occurred.\n *\n * The MessageDialog class specifies two actions: ‘accept’, the primary\n * action (e.g., ‘ok’) and ‘reject,’ the safe action (e.g., ‘cancel’). Both will close the window,\n * passing along the selected action.\n *\n * For more information and examples, please see the [OOjs UI documentation on MediaWiki][1].\n *\n *     @example\n *     // Example: Creating and opening a message dialog window.\n *     var messageDialog = new OO.ui.MessageDialog();\n *\n *     // Create and append a window manager.\n *     var windowManager = new OO.ui.WindowManager();\n *     $( 'body' ).append( windowManager.$element );\n *     windowManager.addWindows( [ messageDialog ] );\n *     // Open the window.\n *     windowManager.openWindow( messageDialog, {\n *         title: 'Basic message dialog',\n *         message: 'This is the message'\n *     } );\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Message_Dialogs\n *\n * @class\n * @extends OO.ui.Dialog\n *\n * @constructor\n * @param {Object} [config] Configuration options\n */\nOO.ui.MessageDialog = function OoUiMessageDialog( config ) {\n\t// Parent constructor\n\tOO.ui.MessageDialog.parent.call( this, config );\n\n\t// Properties\n\tthis.verticalActionLayout = null;\n\n\t// Initialization\n\tthis.$element.addClass( 'oo-ui-messageDialog' );\n};\n\n/* Setup */\n\nOO.inheritClass( OO.ui.MessageDialog, OO.ui.Dialog );\n\n/* Static Properties */\n\n/**\n * @static\n * @inheritdoc\n */\nOO.ui.MessageDialog.static.name = 'message';\n\n/**\n * @static\n * @inheritdoc\n */\nOO.ui.MessageDialog.static.size = 'small';\n\n/**\n * Dialog title.\n *\n * The title of a confirmation dialog describes what a progressive action will do. The\n * title of an alert dialog describes which event occurred.\n *\n * @static\n * @inheritable\n * @property {jQuery|string|Function|null}\n */\nOO.ui.MessageDialog.static.title = null;\n\n/**\n * The message displayed in the dialog body.\n *\n * A confirmation message describes the consequences of a progressive action. An alert\n * message describes why an event occurred.\n *\n * @static\n * @inheritable\n * @property {jQuery|string|Function|null}\n */\nOO.ui.MessageDialog.static.message = null;\n\n/**\n * @static\n * @inheritdoc\n */\nOO.ui.MessageDialog.static.actions = [\n\t// Note that OO.ui.alert() and OO.ui.confirm() rely on these.\n\t{ action: 'accept', label: OO.ui.deferMsg( 'ooui-dialog-message-accept' ), flags: 'primary' },\n\t{ action: 'reject', label: OO.ui.deferMsg( 'ooui-dialog-message-reject' ), flags: 'safe' }\n];\n\n/* Methods */\n\n/**\n * @inheritdoc\n */\nOO.ui.MessageDialog.prototype.setManager = function ( manager ) {\n\tOO.ui.MessageDialog.parent.prototype.setManager.call( this, manager );\n\n\t// Events\n\tthis.manager.connect( this, {\n\t\tresize: 'onResize'\n\t} );\n\n\treturn this;\n};\n\n/**\n * Handle window resized events.\n *\n * @private\n */\nOO.ui.MessageDialog.prototype.onResize = function () {\n\tvar dialog = this;\n\tdialog.fitActions();\n\t// Wait for CSS transition to finish and do it again :(\n\tsetTimeout( function () {\n\t\tdialog.fitActions();\n\t}, 300 );\n};\n\n/**\n * Toggle action layout between vertical and horizontal.\n *\n * @private\n * @param {boolean} [value] Layout actions vertically, omit to toggle\n * @chainable\n */\nOO.ui.MessageDialog.prototype.toggleVerticalActionLayout = function ( value ) {\n\tvalue = value === undefined ? !this.verticalActionLayout : !!value;\n\n\tif ( value !== this.verticalActionLayout ) {\n\t\tthis.verticalActionLayout = value;\n\t\tthis.$actions\n\t\t\t.toggleClass( 'oo-ui-messageDialog-actions-vertical', value )\n\t\t\t.toggleClass( 'oo-ui-messageDialog-actions-horizontal', !value );\n\t}\n\n\treturn this;\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.MessageDialog.prototype.getActionProcess = function ( action ) {\n\tif ( action ) {\n\t\treturn new OO.ui.Process( function () {\n\t\t\tthis.close( { action: action } );\n\t\t}, this );\n\t}\n\treturn OO.ui.MessageDialog.parent.prototype.getActionProcess.call( this, action );\n};\n\n/**\n * @inheritdoc\n *\n * @param {Object} [data] Dialog opening data\n * @param {jQuery|string|Function|null} [data.title] Description of the action being confirmed\n * @param {jQuery|string|Function|null} [data.message] Description of the action's consequence\n * @param {string} [data.size] Symbolic name of the dialog size, see OO.ui.Window\n * @param {Object[]} [data.actions] List of OO.ui.ActionOptionWidget configuration options for each\n *   action item\n */\nOO.ui.MessageDialog.prototype.getSetupProcess = function ( data ) {\n\tdata = data || {};\n\n\t// Parent method\n\treturn OO.ui.MessageDialog.parent.prototype.getSetupProcess.call( this, data )\n\t\t.next( function () {\n\t\t\tthis.title.setLabel(\n\t\t\t\tdata.title !== undefined ? data.title : this.constructor.static.title\n\t\t\t);\n\t\t\tthis.message.setLabel(\n\t\t\t\tdata.message !== undefined ? data.message : this.constructor.static.message\n\t\t\t);\n\t\t\tthis.size = data.size !== undefined ? data.size : this.constructor.static.size;\n\t\t}, this );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.MessageDialog.prototype.getReadyProcess = function ( data ) {\n\tdata = data || {};\n\n\t// Parent method\n\treturn OO.ui.MessageDialog.parent.prototype.getReadyProcess.call( this, data )\n\t\t.next( function () {\n\t\t\t// Focus the primary action button\n\t\t\tvar actions = this.actions.get();\n\t\t\tactions = actions.filter( function ( action ) {\n\t\t\t\treturn action.getFlags().indexOf( 'primary' ) > -1;\n\t\t\t} );\n\t\t\tif ( actions.length > 0 ) {\n\t\t\t\tactions[ 0 ].focus();\n\t\t\t}\n\t\t}, this );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.MessageDialog.prototype.getBodyHeight = function () {\n\tvar bodyHeight, oldOverflow,\n\t\t$scrollable = this.container.$element;\n\n\toldOverflow = $scrollable[ 0 ].style.overflow;\n\t$scrollable[ 0 ].style.overflow = 'hidden';\n\n\tOO.ui.Element.static.reconsiderScrollbars( $scrollable[ 0 ] );\n\n\tbodyHeight = this.text.$element.outerHeight( true );\n\t$scrollable[ 0 ].style.overflow = oldOverflow;\n\n\treturn bodyHeight;\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.MessageDialog.prototype.setDimensions = function ( dim ) {\n\tvar $scrollable = this.container.$element;\n\tOO.ui.MessageDialog.parent.prototype.setDimensions.call( this, dim );\n\n\t// Twiddle the overflow property, otherwise an unnecessary scrollbar will be produced.\n\t// Need to do it after transition completes (250ms), add 50ms just in case.\n\tsetTimeout( function () {\n\t\tvar oldOverflow = $scrollable[ 0 ].style.overflow,\n\t\t\tactiveElement = document.activeElement;\n\n\t\t$scrollable[ 0 ].style.overflow = 'hidden';\n\n\t\tOO.ui.Element.static.reconsiderScrollbars( $scrollable[ 0 ] );\n\n\t\t// Check reconsiderScrollbars didn't destroy our focus, as we\n\t\t// are doing this after the ready process.\n\t\tif ( activeElement && activeElement !== document.activeElement && activeElement.focus ) {\n\t\t\tactiveElement.focus();\n\t\t}\n\n\t\t$scrollable[ 0 ].style.overflow = oldOverflow;\n\t}, 300 );\n\n\treturn this;\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.MessageDialog.prototype.initialize = function () {\n\t// Parent method\n\tOO.ui.MessageDialog.parent.prototype.initialize.call( this );\n\n\t// Properties\n\tthis.$actions = $( '<div>' );\n\tthis.container = new OO.ui.PanelLayout( {\n\t\tscrollable: true, classes: [ 'oo-ui-messageDialog-container' ]\n\t} );\n\tthis.text = new OO.ui.PanelLayout( {\n\t\tpadded: true, expanded: false, classes: [ 'oo-ui-messageDialog-text' ]\n\t} );\n\tthis.message = new OO.ui.LabelWidget( {\n\t\tclasses: [ 'oo-ui-messageDialog-message' ]\n\t} );\n\n\t// Initialization\n\tthis.title.$element.addClass( 'oo-ui-messageDialog-title' );\n\tthis.$content.addClass( 'oo-ui-messageDialog-content' );\n\tthis.container.$element.append( this.text.$element );\n\tthis.text.$element.append( this.title.$element, this.message.$element );\n\tthis.$body.append( this.container.$element );\n\tthis.$actions.addClass( 'oo-ui-messageDialog-actions' );\n\tthis.$foot.append( this.$actions );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.MessageDialog.prototype.attachActions = function () {\n\tvar i, len, other, special, others;\n\n\t// Parent method\n\tOO.ui.MessageDialog.parent.prototype.attachActions.call( this );\n\n\tspecial = this.actions.getSpecial();\n\tothers = this.actions.getOthers();\n\n\tif ( special.safe ) {\n\t\tthis.$actions.append( special.safe.$element );\n\t\tspecial.safe.toggleFramed( false );\n\t}\n\tif ( others.length ) {\n\t\tfor ( i = 0, len = others.length; i < len; i++ ) {\n\t\t\tother = others[ i ];\n\t\t\tthis.$actions.append( other.$element );\n\t\t\tother.toggleFramed( false );\n\t\t}\n\t}\n\tif ( special.primary ) {\n\t\tthis.$actions.append( special.primary.$element );\n\t\tspecial.primary.toggleFramed( false );\n\t}\n\n\tif ( !this.isOpening() ) {\n\t\t// If the dialog is currently opening, this will be called automatically soon.\n\t\t// This also calls #fitActions.\n\t\tthis.updateSize();\n\t}\n};\n\n/**\n * Fit action actions into columns or rows.\n *\n * Columns will be used if all labels can fit without overflow, otherwise rows will be used.\n *\n * @private\n */\nOO.ui.MessageDialog.prototype.fitActions = function () {\n\tvar i, len, action,\n\t\tprevious = this.verticalActionLayout,\n\t\tactions = this.actions.get();\n\n\t// Detect clipping\n\tthis.toggleVerticalActionLayout( false );\n\tfor ( i = 0, len = actions.length; i < len; i++ ) {\n\t\taction = actions[ i ];\n\t\tif ( action.$element.innerWidth() < action.$label.outerWidth( true ) ) {\n\t\t\tthis.toggleVerticalActionLayout( true );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Move the body out of the way of the foot\n\tthis.$body.css( 'bottom', this.$foot.outerHeight( true ) );\n\n\tif ( this.verticalActionLayout !== previous ) {\n\t\t// We changed the layout, window height might need to be updated.\n\t\tthis.updateSize();\n\t}\n};\n\n/**\n * ProcessDialog windows encapsulate a {@link OO.ui.Process process} and all of the code necessary\n * to complete it. If the process terminates with an error, a customizable {@link OO.ui.Error error\n * interface} alerts users to the trouble, permitting the user to dismiss the error and try again when\n * relevant. The ProcessDialog class is always extended and customized with the actions and content\n * required for each process.\n *\n * The process dialog box consists of a header that visually represents the ‘working’ state of long\n * processes with an animation. The header contains the dialog title as well as\n * two {@link OO.ui.ActionWidget action widgets}:  a ‘safe’ action on the left (e.g., ‘Cancel’) and\n * a ‘primary’ action on the right (e.g., ‘Done’).\n *\n * Like other windows, the process dialog is managed by a {@link OO.ui.WindowManager window manager}.\n * Please see the [OOjs UI documentation on MediaWiki][1] for more information and examples.\n *\n *     @example\n *     // Example: Creating and opening a process dialog window.\n *     function MyProcessDialog( config ) {\n *         MyProcessDialog.parent.call( this, config );\n *     }\n *     OO.inheritClass( MyProcessDialog, OO.ui.ProcessDialog );\n *\n *     MyProcessDialog.static.name = 'myProcessDialog';\n *     MyProcessDialog.static.title = 'Process dialog';\n *     MyProcessDialog.static.actions = [\n *         { action: 'save', label: 'Done', flags: 'primary' },\n *         { label: 'Cancel', flags: 'safe' }\n *     ];\n *\n *     MyProcessDialog.prototype.initialize = function () {\n *         MyProcessDialog.parent.prototype.initialize.apply( this, arguments );\n *         this.content = new OO.ui.PanelLayout( { padded: true, expanded: false } );\n *         this.content.$element.append( '<p>This is a process dialog window. The header contains the title and two buttons: \\'Cancel\\' (a safe action) on the left and \\'Done\\' (a primary action)  on the right.</p>' );\n *         this.$body.append( this.content.$element );\n *     };\n *     MyProcessDialog.prototype.getActionProcess = function ( action ) {\n *         var dialog = this;\n *         if ( action ) {\n *             return new OO.ui.Process( function () {\n *                 dialog.close( { action: action } );\n *             } );\n *         }\n *         return MyProcessDialog.parent.prototype.getActionProcess.call( this, action );\n *     };\n *\n *     var windowManager = new OO.ui.WindowManager();\n *     $( 'body' ).append( windowManager.$element );\n *\n *     var dialog = new MyProcessDialog();\n *     windowManager.addWindows( [ dialog ] );\n *     windowManager.openWindow( dialog );\n *\n * [1]: https://www.mediawiki.org/wiki/OOjs_UI/Windows/Process_Dialogs\n *\n * @abstract\n * @class\n * @extends OO.ui.Dialog\n *\n * @constructor\n * @param {Object} [config] Configuration options\n */\nOO.ui.ProcessDialog = function OoUiProcessDialog( config ) {\n\t// Parent constructor\n\tOO.ui.ProcessDialog.parent.call( this, config );\n\n\t// Properties\n\tthis.fitOnOpen = false;\n\n\t// Initialization\n\tthis.$element.addClass( 'oo-ui-processDialog' );\n};\n\n/* Setup */\n\nOO.inheritClass( OO.ui.ProcessDialog, OO.ui.Dialog );\n\n/* Methods */\n\n/**\n * Handle dismiss button click events.\n *\n * Hides errors.\n *\n * @private\n */\nOO.ui.ProcessDialog.prototype.onDismissErrorButtonClick = function () {\n\tthis.hideErrors();\n};\n\n/**\n * Handle retry button click events.\n *\n * Hides errors and then tries again.\n *\n * @private\n */\nOO.ui.ProcessDialog.prototype.onRetryButtonClick = function () {\n\tthis.hideErrors();\n\tthis.executeAction( this.currentAction );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.ProcessDialog.prototype.initialize = function () {\n\t// Parent method\n\tOO.ui.ProcessDialog.parent.prototype.initialize.call( this );\n\n\t// Properties\n\tthis.$navigation = $( '<div>' );\n\tthis.$location = $( '<div>' );\n\tthis.$safeActions = $( '<div>' );\n\tthis.$primaryActions = $( '<div>' );\n\tthis.$otherActions = $( '<div>' );\n\tthis.dismissButton = new OO.ui.ButtonWidget( {\n\t\tlabel: OO.ui.msg( 'ooui-dialog-process-dismiss' )\n\t} );\n\tthis.retryButton = new OO.ui.ButtonWidget();\n\tthis.$errors = $( '<div>' );\n\tthis.$errorsTitle = $( '<div>' );\n\n\t// Events\n\tthis.dismissButton.connect( this, { click: 'onDismissErrorButtonClick' } );\n\tthis.retryButton.connect( this, { click: 'onRetryButtonClick' } );\n\n\t// Initialization\n\tthis.title.$element.addClass( 'oo-ui-processDialog-title' );\n\tthis.$location\n\t\t.append( this.title.$element )\n\t\t.addClass( 'oo-ui-processDialog-location' );\n\tthis.$safeActions.addClass( 'oo-ui-processDialog-actions-safe' );\n\tthis.$primaryActions.addClass( 'oo-ui-processDialog-actions-primary' );\n\tthis.$otherActions.addClass( 'oo-ui-processDialog-actions-other' );\n\tthis.$errorsTitle\n\t\t.addClass( 'oo-ui-processDialog-errors-title' )\n\t\t.text( OO.ui.msg( 'ooui-dialog-process-error' ) );\n\tthis.$errors\n\t\t.addClass( 'oo-ui-processDialog-errors oo-ui-element-hidden' )\n\t\t.append( this.$errorsTitle, this.dismissButton.$element, this.retryButton.$element );\n\tthis.$content\n\t\t.addClass( 'oo-ui-processDialog-content' )\n\t\t.append( this.$errors );\n\tthis.$navigation\n\t\t.addClass( 'oo-ui-processDialog-navigation' )\n\t\t// Note: Order of appends below is important. These are in the order\n\t\t// we want tab to go through them. Display-order is handled entirely\n\t\t// by CSS absolute-positioning. As such, primary actions like \"done\"\n\t\t// should go first.\n\t\t.append( this.$primaryActions, this.$location, this.$safeActions );\n\tthis.$head.append( this.$navigation );\n\tthis.$foot.append( this.$otherActions );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.ProcessDialog.prototype.getActionWidgets = function ( actions ) {\n\tvar i, len, config,\n\t\tisMobile = OO.ui.isMobile(),\n\t\twidgets = [];\n\n\tfor ( i = 0, len = actions.length; i < len; i++ ) {\n\t\tconfig = $.extend( { framed: !OO.ui.isMobile() }, actions[ i ] );\n\t\tif ( isMobile &&\n\t\t\t( config.flags === 'back' || ( Array.isArray( config.flags ) && config.flags.indexOf( 'back' ) !== -1 ) )\n\t\t) {\n\t\t\t$.extend( config, {\n\t\t\t\ticon: 'previous',\n\t\t\t\tlabel: ''\n\t\t\t} );\n\t\t}\n\t\twidgets.push(\n\t\t\tnew OO.ui.ActionWidget( config )\n\t\t);\n\t}\n\treturn widgets;\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.ProcessDialog.prototype.attachActions = function () {\n\tvar i, len, other, special, others;\n\n\t// Parent method\n\tOO.ui.ProcessDialog.parent.prototype.attachActions.call( this );\n\n\tspecial = this.actions.getSpecial();\n\tothers = this.actions.getOthers();\n\tif ( special.primary ) {\n\t\tthis.$primaryActions.append( special.primary.$element );\n\t}\n\tfor ( i = 0, len = others.length; i < len; i++ ) {\n\t\tother = others[ i ];\n\t\tthis.$otherActions.append( other.$element );\n\t}\n\tif ( special.safe ) {\n\t\tthis.$safeActions.append( special.safe.$element );\n\t}\n\n\tthis.fitLabel();\n\tthis.$body.css( 'bottom', this.$foot.outerHeight( true ) );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.ProcessDialog.prototype.executeAction = function ( action ) {\n\tvar process = this;\n\treturn OO.ui.ProcessDialog.parent.prototype.executeAction.call( this, action )\n\t\t.fail( function ( errors ) {\n\t\t\tprocess.showErrors( errors || [] );\n\t\t} );\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.ProcessDialog.prototype.setDimensions = function () {\n\t// Parent method\n\tOO.ui.ProcessDialog.parent.prototype.setDimensions.apply( this, arguments );\n\n\tthis.fitLabel();\n};\n\n/**\n * Fit label between actions.\n *\n * @private\n * @chainable\n */\nOO.ui.ProcessDialog.prototype.fitLabel = function () {\n\tvar safeWidth, primaryWidth, biggerWidth, labelWidth, navigationWidth, leftWidth, rightWidth,\n\t\tsize = this.getSizeProperties();\n\n\tif ( typeof size.width !== 'number' ) {\n\t\tif ( this.isOpened() ) {\n\t\t\tnavigationWidth = this.$head.width() - 20;\n\t\t} else if ( this.isOpening() ) {\n\t\t\tif ( !this.fitOnOpen ) {\n\t\t\t\t// Size is relative and the dialog isn't open yet, so wait.\n\t\t\t\t// FIXME: This should ideally be handled by setup somehow.\n\t\t\t\tthis.manager.lifecycle.opened.done( this.fitLabel.bind( this ) );\n\t\t\t\tthis.fitOnOpen = true;\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\tnavigationWidth = size.width - 20;\n\t}\n\n\tsafeWidth = this.$safeActions.is( ':visible' ) ? this.$safeActions.width() : 0;\n\tprimaryWidth = this.$primaryActions.is( ':visible' ) ? this.$primaryActions.width() : 0;\n\tbiggerWidth = Math.max( safeWidth, primaryWidth );\n\n\tlabelWidth = this.title.$element.width();\n\n\tif ( 2 * biggerWidth + labelWidth < navigationWidth ) {\n\t\t// We have enough space to center the label\n\t\tleftWidth = rightWidth = biggerWidth;\n\t} else {\n\t\t// Let's hope we at least have enough space not to overlap, because we can't wrap the label…\n\t\tif ( this.getDir() === 'ltr' ) {\n\t\t\tleftWidth = safeWidth;\n\t\t\trightWidth = primaryWidth;\n\t\t} else {\n\t\t\tleftWidth = primaryWidth;\n\t\t\trightWidth = safeWidth;\n\t\t}\n\t}\n\n\tthis.$location.css( { paddingLeft: leftWidth, paddingRight: rightWidth } );\n\n\treturn this;\n};\n\n/**\n * Handle errors that occurred during accept or reject processes.\n *\n * @private\n * @param {OO.ui.Error[]|OO.ui.Error} errors Errors to be handled\n */\nOO.ui.ProcessDialog.prototype.showErrors = function ( errors ) {\n\tvar i, len, $item, actions,\n\t\titems = [],\n\t\tabilities = {},\n\t\trecoverable = true,\n\t\twarning = false;\n\n\tif ( errors instanceof OO.ui.Error ) {\n\t\terrors = [ errors ];\n\t}\n\n\tfor ( i = 0, len = errors.length; i < len; i++ ) {\n\t\tif ( !errors[ i ].isRecoverable() ) {\n\t\t\trecoverable = false;\n\t\t}\n\t\tif ( errors[ i ].isWarning() ) {\n\t\t\twarning = true;\n\t\t}\n\t\t$item = $( '<div>' )\n\t\t\t.addClass( 'oo-ui-processDialog-error' )\n\t\t\t.append( errors[ i ].getMessage() );\n\t\titems.push( $item[ 0 ] );\n\t}\n\tthis.$errorItems = $( items );\n\tif ( recoverable ) {\n\t\tabilities[ this.currentAction ] = true;\n\t\t// Copy the flags from the first matching action\n\t\tactions = this.actions.get( { actions: this.currentAction } );\n\t\tif ( actions.length ) {\n\t\t\tthis.retryButton.clearFlags().setFlags( actions[ 0 ].getFlags() );\n\t\t}\n\t} else {\n\t\tabilities[ this.currentAction ] = false;\n\t\tthis.actions.setAbilities( abilities );\n\t}\n\tif ( warning ) {\n\t\tthis.retryButton.setLabel( OO.ui.msg( 'ooui-dialog-process-continue' ) );\n\t} else {\n\t\tthis.retryButton.setLabel( OO.ui.msg( 'ooui-dialog-process-retry' ) );\n\t}\n\tthis.retryButton.toggle( recoverable );\n\tthis.$errorsTitle.after( this.$errorItems );\n\tthis.$errors.removeClass( 'oo-ui-element-hidden' ).scrollTop( 0 );\n};\n\n/**\n * Hide errors.\n *\n * @private\n */\nOO.ui.ProcessDialog.prototype.hideErrors = function () {\n\tthis.$errors.addClass( 'oo-ui-element-hidden' );\n\tif ( this.$errorItems ) {\n\t\tthis.$errorItems.remove();\n\t\tthis.$errorItems = null;\n\t}\n};\n\n/**\n * @inheritdoc\n */\nOO.ui.ProcessDialog.prototype.getTeardownProcess = function ( data ) {\n\t// Parent method\n\treturn OO.ui.ProcessDialog.parent.prototype.getTeardownProcess.call( this, data )\n\t\t.first( function () {\n\t\t\t// Make sure to hide errors\n\t\t\tthis.hideErrors();\n\t\t\tthis.fitOnOpen = false;\n\t\t}, this );\n};\n\n/**\n * @class OO.ui\n */\n\n/**\n * Lazy-initialize and return a global OO.ui.WindowManager instance, used by OO.ui.alert and\n * OO.ui.confirm.\n *\n * @private\n * @return {OO.ui.WindowManager}\n */\nOO.ui.getWindowManager = function () {\n\tif ( !OO.ui.windowManager ) {\n\t\tOO.ui.windowManager = new OO.ui.WindowManager();\n\t\t$( 'body' ).append( OO.ui.windowManager.$element );\n\t\tOO.ui.windowManager.addWindows( [ new OO.ui.MessageDialog() ] );\n\t}\n\treturn OO.ui.windowManager;\n};\n\n/**\n * Display a quick modal alert dialog, using a OO.ui.MessageDialog. While the dialog is open, the\n * rest of the page will be dimmed out and the user won't be able to interact with it. The dialog\n * has only one action button, labelled \"OK\", clicking it will simply close the dialog.\n *\n * A window manager is created automatically when this function is called for the first time.\n *\n *     @example\n *     OO.ui.alert( 'Something happened!' ).done( function () {\n *         console.log( 'User closed the dialog.' );\n *     } );\n *\n *     OO.ui.alert( 'Something larger happened!', { size: 'large' } );\n *\n * @param {jQuery|string} text Message text to display\n * @param {Object} [options] Additional options, see OO.ui.MessageDialog#getSetupProcess\n * @return {jQuery.Promise} Promise resolved when the user closes the dialog\n */\nOO.ui.alert = function ( text, options ) {\n\treturn OO.ui.getWindowManager().openWindow( 'message', $.extend( {\n\t\tmessage: text,\n\t\tactions: [ OO.ui.MessageDialog.static.actions[ 0 ] ]\n\t}, options ) ).closed.then( function () {\n\t\treturn undefined;\n\t} );\n};\n\n/**\n * Display a quick modal confirmation dialog, using a OO.ui.MessageDialog. While the dialog is open,\n * the rest of the page will be dimmed out and the user won't be able to interact with it. The\n * dialog has two action buttons, one to confirm an operation (labelled \"OK\") and one to cancel it\n * (labelled \"Cancel\").\n *\n * A window manager is created automatically when this function is called for the first time.\n *\n *     @example\n *     OO.ui.confirm( 'Are you sure?' ).done( function ( confirmed ) {\n *         if ( confirmed ) {\n *             console.log( 'User clicked \"OK\"!' );\n *         } else {\n *             console.log( 'User clicked \"Cancel\" or closed the dialog.' );\n *         }\n *     } );\n *\n * @param {jQuery|string} text Message text to display\n * @param {Object} [options] Additional options, see OO.ui.MessageDialog#getSetupProcess\n * @return {jQuery.Promise} Promise resolved when the user closes the dialog. If the user chose to\n *  confirm, the promise will resolve to boolean `true`; otherwise, it will resolve to boolean\n *  `false`.\n */\nOO.ui.confirm = function ( text, options ) {\n\treturn OO.ui.getWindowManager().openWindow( 'message', $.extend( {\n\t\tmessage: text\n\t}, options ) ).closed.then( function ( data ) {\n\t\treturn !!( data && data.action === 'accept' );\n\t} );\n};\n\n/**\n * Display a quick modal prompt dialog, using a OO.ui.MessageDialog. While the dialog is open,\n * the rest of the page will be dimmed out and the user won't be able to interact with it. The\n * dialog has a text input widget and two action buttons, one to confirm an operation (labelled \"OK\")\n * and one to cancel it (labelled \"Cancel\").\n *\n * A window manager is created automatically when this function is called for the first time.\n *\n *     @example\n *     OO.ui.prompt( 'Choose a line to go to', { textInput: { placeholder: 'Line number' } } ).done( function ( result ) {\n *         if ( result !== null ) {\n *             console.log( 'User typed \"' + result + '\" then clicked \"OK\".' );\n *         } else {\n *             console.log( 'User clicked \"Cancel\" or closed the dialog.' );\n *         }\n *     } );\n *\n * @param {jQuery|string} text Message text to display\n * @param {Object} [options] Additional options, see OO.ui.MessageDialog#getSetupProcess\n * @param {Object} [options.textInput] Additional options for text input widget, see OO.ui.TextInputWidget\n * @return {jQuery.Promise} Promise resolved when the user closes the dialog. If the user chose to\n *  confirm, the promise will resolve with the value of the text input widget; otherwise, it will\n *  resolve to `null`.\n */\nOO.ui.prompt = function ( text, options ) {\n\tvar instance,\n\t\tmanager = OO.ui.getWindowManager(),\n\t\ttextInput = new OO.ui.TextInputWidget( ( options && options.textInput ) || {} ),\n\t\ttextField = new OO.ui.FieldLayout( textInput, {\n\t\t\talign: 'top',\n\t\t\tlabel: text\n\t\t} );\n\n\tinstance = manager.openWindow( 'message', $.extend( {\n\t\tmessage: textField.$element\n\t}, options ) );\n\n\t// TODO: This is a little hacky, and could be done by extending MessageDialog instead.\n\tinstance.opened.then( function () {\n\t\ttextInput.on( 'enter', function () {\n\t\t\tmanager.getCurrentWindow().close( { action: 'accept' } );\n\t\t} );\n\t\ttextInput.focus();\n\t} );\n\n\treturn instance.closed.then( function ( data ) {\n\t\treturn data && data.action === 'accept' ? textInput.getValue() : null;\n\t} );\n};\n\n}( OO ) );\n\n//# sourceMappingURL=oojs-ui-windows.js.map"]}