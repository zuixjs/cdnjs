!function(f){var h,b,v=f(window),n={},g=[],m=[],y=null,d="_open",_="_close",k=[],w=null,r=/(iPad|iPhone|iPod)/.test(navigator.userAgent),z=/(android)/i.test(navigator.userAgent),x={_init:function(t){var e=f(t),o=e.data("popupoptions");m[t.id]=!1,g[t.id]=0,e.data("popup-initialized")||(e.attr("data-popup-initialized","true"),x._initonce(t)),o.autoopen&&setTimeout(function(){x.show(t,0)},0)},_initonce:function(o){var t,e,i,n=f(o),a=f("body"),p=n.data("popupoptions");(y=parseInt(a.css("margin-right"),10),w=void 0!==document.body.style.webkitTransition||void 0!==document.body.style.MozTransition||void 0!==document.body.style.msTransition||void 0!==document.body.style.OTransition||void 0!==document.body.style.transition,p.scrolllock)&&(void 0===h&&(i=(e=f('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body")).children(),h=i.innerWidth()-i.height(99).innerWidth(),e.remove()));if(n.attr("id")||n.attr("id","j-popup-"+parseInt(1e8*Math.random(),10)),n.addClass("popup_content"),p.background&&!f("#"+o.id+"_background").length){a.append('<div id="'+o.id+'_background" class="popup_background"></div>');var s=f("#"+o.id+"_background");s.css({opacity:0,visibility:"hidden",backgroundColor:p.color,position:"fixed",top:0,right:0,bottom:0,left:0}),p.setzindex&&!p.autozindex&&s.css("z-index","100000"),p.transition&&s.css("transition",p.transition)}a.append(o),n.wrap('<div id="'+o.id+'_wrapper" class="popup_wrapper" />'),(t=f("#"+o.id+"_wrapper")).css({opacity:0,visibility:"hidden",position:"absolute"}),r&&((s=f("#"+o.id+"_background")).css("cursor","pointer"),f(p.pagecontainer).css("cursor","pointer")),"overlay"!=p.type||p.absolute||(t.css("overflow","auto"),t[0].style.WebkitOverflowScrolling="touch"),n.css({opacity:0,visibility:"hidden","pointer-events":"auto",display:"inline-block"}),p.setzindex&&!p.autozindex&&t.css("z-index","100001"),p.outline||n.css("outline","none"),p.transition&&(n.css("transition",p.transition),t.css("transition",p.transition)),n.attr("aria-hidden",!0),"overlay"==p.type&&(n.css({textAlign:"left",position:"relative",verticalAlign:"middle"}),t.css({position:"fixed",width:"100%",height:"100%",top:0,left:0,textAlign:"center"}),t.append('<div class="popup_align" />'),f(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})),n.attr("role","dialog");var l=p.openelement?p.openelement:"."+o.id+d;f(l).each(function(t,e){f(e).attr("data-popup-ordinal",t),e.id||f(e).attr("id","open_"+parseInt(1e8*Math.random(),10))}),n.attr("aria-labelledby")||n.attr("aria-label")||n.attr("aria-labelledby",f(l).attr("id")),"hover"==p.action?(p.keepfocus=!1,f(l).on("mouseenter",function(){x.show(o,f(this).data("popup-ordinal"))}),f(l).on("mouseleave",function(){x.hide(o)})):f(document).on("click.jqp",l,function(t){t.preventDefault();var e=f(this).data("popup-ordinal");setTimeout(function(){x.show(o,e)},0)}),p.closebutton&&x.addclosebutton(o),p.detach?n.detach():n.hide()},show:function(t,e){var o=f(t);if(!o.data("popup-visible")){o.data("popup-initialized")||x._init(t),o.attr("data-popup-initialized","true");var i=f("body"),n=o.data("popupoptions"),a=f("#"+t.id+"_wrapper"),p=f("#"+t.id+"_background"),s=!1;if(T(t,e,n.beforeopen),m[t.id]=e,setTimeout(function(){k.push(t.id)},0),n.autozindex){for(var l=document.getElementsByTagName("*"),d=l.length,r=0,c=0;c<d;c++){var u=f(l[c]).css("z-index");"auto"!==u&&r<(u=parseInt(u,10))&&(r=u)}g[t.id]=r,n.background&&0<=g[t.id]&&f("#"+t.id+"_background").css({zIndex:g[t.id]+1}),0<=g[t.id]&&a.css({zIndex:g[t.id]+2})}n.detach&&a.prepend(t),o.show(),n.background||(a.css({"pointer-events":"none"}),!z||n.absolute||n.scrolllock||C(t)||(s=!0)),b=setTimeout(function(){a.css({visibility:"visible",opacity:1}),f("html").addClass("popup_visible").addClass("popup_visible_"+t.id),a.addClass("popup_wrapper_visible")},20),(n.scrolllock||s)&&(i.css("overflow","hidden"),i.height()>v.height()&&i.css("margin-right",y+h)),o.css({visibility:"visible",opacity:1}),n.background&&(p.css({visibility:"visible",opacity:n.opacity}),setTimeout(function(){p.css({opacity:n.opacity})},0)),o.data("popup-visible",!0),x.reposition(t,e),o.data("focusedelementbeforepopup",document.activeElement),o.attr("tabindex",-1),setTimeout(function(){"closebutton"===n.focuselement?f("#"+t.id+" ."+t.id+_+":first").focus():n.focuselement?f(n.focuselement).focus():(!0===n.focuselement||n.keepfocus)&&o.focus()},n.focusdelay),n.keepfocus&&f(n.pagecontainer).attr("aria-hidden",!0),o.attr("aria-hidden",!1),T(t,e,n.onopen),w?a.one("transitionend",function(){T(t,e,n.opentransitionend)}):T(t,e,n.opentransitionend),"tooltip"==n.type&&f(window).on("resize."+t.id,function(){x.reposition(t,e)})}},hide:function(t,e){var o=f.inArray(t.id,k);if(-1!==o){b&&clearTimeout(b);var i=f("body"),n=f(t),a=n.data("popupoptions"),p=f("#"+t.id+"_wrapper"),s=f("#"+t.id+"_background");n.data("popup-visible",!1),1===k.length?f("html").removeClass("popup_visible").removeClass("popup_visible_"+t.id):f("html").hasClass("popup_visible_"+t.id)&&f("html").removeClass("popup_visible_"+t.id),k.splice(o,1),p.hasClass("popup_wrapper_visible")&&p.removeClass("popup_wrapper_visible"),a.keepfocus&&!e&&setTimeout(function(){f(n.data("focusedelementbeforepopup")).is(":visible")&&n.data("focusedelementbeforepopup").focus()},0),p.css({visibility:"hidden",opacity:0}),n.css({visibility:"hidden",opacity:0}),a.background&&s.css({visibility:"hidden",opacity:0}),f(a.pagecontainer).attr("aria-hidden",!1),n.attr("aria-hidden",!0),T(t,m[t.id],a.onclose),w&&"0s"!==n.css("transition-duration")?n.one("transitionend",function(){n.data("popup-visible")||(a.detach?n.detach():n.hide()),a.scrolllock&&setTimeout(function(){f.grep(k,function(t){return f("#"+t).data("popupoptions").scrolllock}).length||i.css({overflow:"visible","margin-right":y})},10),T(t,m[t.id],a.closetransitionend)}):(a.detach?n.detach():n.hide(),a.scrolllock&&setTimeout(function(){f.grep(k,function(t){return f("#"+t).data("popupoptions").scrolllock}).length||i.css({overflow:"visible","margin-right":y})},10),T(t,m[t.id],a.closetransitionend)),"tooltip"==a.type&&f(window).off("resize."+t.id)}},toggle:function(t,e){f(t).data("popup-visible")?x.hide(t):setTimeout(function(){x.show(t,e)},0)},reposition:function(t,e){var o=f(t),i=o.data("popupoptions"),n=f("#"+t.id+"_wrapper");if(e=e||0,"tooltip"==i.type){var a;n.css({position:"absolute"});var p=(a=i.tooltipanchor?f(i.tooltipanchor):i.openelement?f(i.openelement).filter('[data-popup-ordinal="'+e+'"]'):f("."+t.id+d+'[data-popup-ordinal="'+e+'"]')).offset()||{left:0,top:0};"right"==i.horizontal?n.css("left",p.left+a.outerWidth()+i.offsetleft):"leftedge"==i.horizontal?n.css("left",p.left+i.offsetleft):"left"==i.horizontal?n.css("right",v.width()-p.left-i.offsetleft):"rightedge"==i.horizontal?n.css("right",v.width()-p.left-a.outerWidth()-i.offsetleft):n.css("left",p.left+a.outerWidth()/2-o.outerWidth()/2-parseFloat(o.css("marginLeft"))+i.offsetleft),"bottom"==i.vertical?n.css("top",p.top+a.outerHeight()+i.offsettop):"bottomedge"==i.vertical?n.css("top",p.top+a.outerHeight()-o.outerHeight()+i.offsettop):"top"==i.vertical?n.css("bottom",v.height()-p.top-i.offsettop):"topedge"==i.vertical?n.css("bottom",v.height()-p.top-o.outerHeight()-i.offsettop):n.css("top",p.top+a.outerHeight()/2-o.outerHeight()/2-parseFloat(o.css("marginTop"))+i.offsettop)}else"overlay"==i.type&&(i.horizontal?n.css("text-align",i.horizontal):n.css("text-align","center"),i.vertical?o.css("vertical-align",i.vertical):o.css("vertical-align","middle"),i.absolute&&n.css({position:"absolute",top:window.scrollY}))},addclosebutton:function(t){var e;e=f(t).data("popupoptions").closebuttonmarkup?f(n.closebuttonmarkup).addClass(t.id+"_close"):'<button class="popup_close '+t.id+'_close" title="Close" aria-label="Close"><span aria-hidden="true">Ã—</span></button>',f(t).data("popup-initialized")&&f(t).append(e)}},T=function(t,e,o){var i,n,a=f(t).data("popupoptions");void 0!==a&&(i=a.openelement?a.openelement:"."+t.id+d,n=f(i+'[data-popup-ordinal="'+e+'"]'),"function"==typeof o&&o.call(f(t),t,n))},C=function(t){var e=t.getBoundingClientRect();return 0<=e.top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)};f(document).on("keydown",function(t){if(k.length){var e=k[k.length-1],o=document.getElementById(e);f(o).data("popupoptions").escape&&27==t.keyCode&&x.hide(o)}}),f(document).on("click",function(t){if(k.length){var e=k[k.length-1],o=document.getElementById(e),i=f(o).data("popupoptions").closeelement?f(o).data("popupoptions").closeelement:"."+o.id+_;f(t.target).closest(i).length&&(t.preventDefault(),x.hide(o)),f(o).data("popupoptions")&&f(o).data("popupoptions").blur&&!f(t.target).closest(f(o).data("popupoptions").blurignore).length&&!f(t.target).closest("#"+e).length&&2!==t.which&&f(t.target).is(":visible")&&(f(o).data("popupoptions").background?(x.hide(o),t.preventDefault()):x.hide(o,!0))}}),f(document).on("keydown",function(t){if(k.length&&9==t.which){var e=k[k.length-1],o=document.getElementById(e);if(!f(o).data("popupoptions").keepfocus)return;var i=f(o).find("*").filter("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]").filter(":visible"),n=f(":focus"),a=i.length,p=i.index(n);0===a?(f(o).focus(),t.preventDefault()):t.shiftKey?0===p&&(i.get(a-1).focus(),t.preventDefault()):p==a-1&&(i.get(0).focus(),t.preventDefault())}}),f.fn.popup=function(i){return this.each(function(){var t=f(this),e=f.extend(!0,{},f.fn.popup.defaults);if(i&&"tooltip"===i.type&&(e.background=!1),"object"==typeof i){var o=f.extend({},e,t.data("popupoptions"),i);t.data("popupoptions",o),n=t.data("popupoptions"),x._init(this)}else"string"==typeof i?(t.data("popupoptions")||(t.data("popupoptions",e),n=t.data("popupoptions")),x[i].call(this,this)):(t.data("popupoptions")||(t.data("popupoptions",e),n=t.data("popupoptions")),x._init(this))})},f.fn.popup.destroyall=function(){for(var t=0;t<k.length;t++)f("#"+k[t]).popup("hide");f(".popup_wrapper").remove(),f(".popup_background").remove(),f(document).off("click.jqp")},f.fn.popup.defaults={type:"overlay",absolute:!1,autoopen:!1,background:!0,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:!0,blur:!0,blurignore:null,setzindex:!0,autozindex:!1,scrolllock:!1,closebutton:!1,closebuttonmarkup:null,keepfocus:!0,focuselement:null,focusdelay:50,outline:!1,pagecontainer:null,detach:!1,openelement:null,closeelement:null,transition:null,tooltipanchor:null,beforeopen:null,onclose:null,onopen:null,opentransitionend:null,closetransitionend:null}}(jQuery);