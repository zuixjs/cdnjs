(function(a,b){a.widget("ui.rangeSliderHandle",a.ui.rangeSliderDraggable,{currentMove:null,margin:0,parentElement:null,options:{isLeft:true,bounds:{min:0,max:100},range:false,value:0,step:false},_value:0,_left:0,_create:function(){a.ui.rangeSliderDraggable.prototype._create.apply(this);this.element.css("position","absolute").css("top",0).addClass("ui-rangeSlider-handle").toggleClass("ui-rangeSlider-leftHandle",this.options.isLeft).toggleClass("ui-rangeSlider-rightHandle",!this.options.isLeft);this.element.append("<div class='ui-rangeSlider-handle-inner' />");this._value=this._constraintValue(this.options.value)},destroy:function(){this.element.empty();a.ui.rangeSliderDraggable.prototype.destroy.apply(this)},_setOption:function(c,d){if(c==="isLeft"&&(d===true||d===false)&&d!==this.options.isLeft){this.options.isLeft=d;this.element.toggleClass("ui-rangeSlider-leftHandle",this.options.isLeft).toggleClass("ui-rangeSlider-rightHandle",!this.options.isLeft);this._position(this._value);this.element.trigger("switch",this.options.isLeft)}else{if(c==="step"&&this._checkStep(d)){this.options.step=d;this.update()}else{if(c==="bounds"){this.options.bounds=d;this.update()}else{if(c==="range"&&this._checkRange(d)){this.options.range=d;this.update()}}}}a.ui.rangeSliderDraggable.prototype._setOption.apply(this,[c,d])},_checkRange:function(c){return c===false||(!this._isValidValue(c.min)&&!this._isValidValue(c.max))},_isValidValue:function(c){return typeof c!=="undefined"&&c!==false&&parseFloat(c)!==c},_checkStep:function(c){return(c===false||parseFloat(c)===c)},_initElement:function(){a.ui.rangeSliderDraggable.prototype._initElement.apply(this);if(this.cache.parent.width===0||this.cache.parent.width===null){setTimeout(a.proxy(this._initElementIfNotDestroyed,this),500)}else{this._position(this._value);this._triggerMouseEvent("initialize")}},_bounds:function(){return this.options.bounds},_cache:function(){a.ui.rangeSliderDraggable.prototype._cache.apply(this);this._cacheParent()},_cacheParent:function(){var c=this.element.parent();this.cache.parent={element:c,offset:c.offset(),padding:{left:this._parsePixels(c,"paddingLeft")},width:c.width()}},_position:function(c){var d=this._getPositionForValue(c);this._applyPosition(d)},_constraintPosition:function(c){var d=this._getValueForPosition(c);return this._getPositionForValue(d)},_applyPosition:function(c){a.ui.rangeSliderDraggable.prototype._applyPosition.apply(this,[c]);this._left=c;this._setValue(this._getValueForPosition(c));this._triggerMouseEvent("moving")},_prepareEventData:function(){var c=a.ui.rangeSliderDraggable.prototype._prepareEventData.apply(this);c.value=this._value;return c},_setValue:function(c){if(c!==this._value){this._value=c}},_constraintValue:function(e){e=Math.min(e,this._bounds().max);e=Math.max(e,this._bounds().min);e=this._round(e);if(this.options.range!==false){var d=this.options.range.min||false,c=this.options.range.max||false;if(d!==false){e=Math.max(e,this._round(d))}if(c!==false){e=Math.min(e,this._round(c))}e=Math.min(e,this._bounds().max);e=Math.max(e,this._bounds().min)}return e},_round:function(c){if(this.options.step!==false&&this.options.step>0){return Math.round(c/this.options.step)*this.options.step}return c},_getPositionForValue:function(f){if(!this.cache||!this.cache.parent||this.cache.parent.offset===null){return 0}f=this._constraintValue(f);var d=(f-this.options.bounds.min)/(this.options.bounds.max-this.options.bounds.min),e=this.cache.parent.width,g=this.cache.parent.offset.left,c=this.options.isLeft?0:this.cache.width.outer;return d*e+g-c},_getValueForPosition:function(c){var d=this._getRawValueForPositionAndBounds(c,this.options.bounds.min,this.options.bounds.max);return this._constraintValue(d)},_getRawValueForPositionAndBounds:function(d,e,c){d+=this.options.isLeft?0:this.cache.width.outer;var h=this.cache.parent.offset===null?0:this.cache.parent.offset.left,g=this.cache.parent.width,f=g>0?(d-h)/g:0;return f*(c-e)+e},value:function(c){if(typeof c!=="undefined"){this._cache();c=this._constraintValue(c);this._position(c)}return this._value},update:function(){this._cache();var d=this._constraintValue(this._value),c=this._getPositionForValue(d);if(d!==this._value){this._triggerMouseEvent("updating");this._position(d);this._triggerMouseEvent("update")}else{if(c!==this.cache.offset.left){this._triggerMouseEvent("updating");this._position(d);this._triggerMouseEvent("update")}}},position:function(c){if(typeof c!=="undefined"){this._cache();c=this._constraintPosition(c);this._applyPosition(c)}return this._left},add:function(d,c){return d+c},substract:function(d,c){return d-c},stepsBetween:function(d,c){if(this.options.step===false){return c-d}return(c-d)/this.options.step},multiplyStep:function(d,c){return d*c},moveRight:function(d){var c;if(this.options.step===false){c=this._left;this.position(this._left+d);return this._left-c}c=this._value;this.value(this.add(c,this.multiplyStep(this.options.step,d)));return this.stepsBetween(c,this._value)},moveLeft:function(c){return -this.moveRight(-c)},stepRatio:function(){if(this.options.step===false){return 1}else{var c=(this.options.bounds.max-this.options.bounds.min)/this.options.step;return this.cache.parent.width/c}}})}(jQuery));