!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).parser=e()}}(function(){return function e(t,r,n){function i(a,f){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!f&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[a]={exports:{}};t[a][0].call(d.exports,function(e){var r=t[a][1][e];return i(r||e)},d,d.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){function n(e){for(var t=f(e,c),r="",n=0;n<t.length;n++)r+=t[n][1];return r}function i(e,t){if(t){var r=e.split(":"),n="/"===e.charAt(0)?"/":"";2===r.length&&(e=n+r[1])}return e}function o(e,t){return e=e?!t||isNaN(e)?""+e:-1!==e.indexOf(".")?Number.parseFloat(e):Number.parseInt(e,10):""}function a(e,t,r,n,a,l){if(e=e||e.trim(),!t&&e.length>3){var u=f(e,v),d={},g=d;n&&u.length&&(g=d[n]={});for(var s=0;s<u.length;s++)g[r+i(u[s][1],a)]=o(u[s][3],l);return d}}var f=e("./util").getAllMatches,l=function(e,t,r){this.tagname=e,this.parent=t,this.child=[],this.val=r,this.addChild=function(e){this.child.push(e)}},u=new RegExp("<(\\/?[\\w:\\-._]+)([^>]*)>(<!\\[CDATA\\[(.*?)(\\]\\]>))*([^<]+)?","g"),d={attrPrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreNonTextNodeAttr:!0,ignoreTextNodeAttr:!0,ignoreNameSpace:!1,ignoreRootElement:!1,textNodeConversion:!0,textAttrConversion:!1,arrayMode:!1},g=function(e){e||(e={});for(var t=["attrPrefix","attrNodeName","ignoreNonTextNodeAttr","ignoreTextNodeAttr","ignoreNameSpace","ignoreRootElement","textNodeName","textNodeConversion","textAttrConversion","arrayMode"],r=0;r<t.length;r++)void 0===e[t[r]]&&(e[t[r]]=d[t[r]]);return e},s=function(e,t){t=g(t);for(var r=f(e,u),d=new l("!xml"),s=d,c=0;c<r.length;c++){var v,h=i(r[c][1],t.ignoreNameSpace),x=c+1<r.length?i(r[c+1][1],t.ignoreNameSpace):void 0,p=r[c][2],N=void 0===r[c][4]?r[c][6]:n(r[c][0]);if(0!==h.indexOf("/")){var m="/"===p.charAt(p.length-1),A=new l(h,s);if(m)v=a(p,t.ignoreTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion),A.val=v||"",s.addChild(A);else if("/"+h===x)v=a(p,t.ignoreTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion),N=o(N,t.textNodeConversion),v?(v[t.textNodeName]=N,A.val=v):A.val=void 0!==N&&null!=N?N:"",s.addChild(A),c++;else{if(v=a(p,t.ignoreNonTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion))for(var w in v)v.hasOwnProperty(w)&&A.addChild(new l(w,A,v[w]));s.addChild(A),s=A}}else s=s.parent}return d},c=new RegExp("<!\\[CDATA\\[(.*?)(\\]\\]>)","g"),v=new RegExp("(\\S+)\\s*=\\s*(['\"])(.*?)\\2","g"),h=function(e,t){var r={};if(void 0!==e.val&&null!=e.val||""===e.val)return e.val;for(var n=0;n<e.child.length;n++){var i=e.child[n].tagname,o=h(e.child[n],t);if(void 0!==r[i]){if(!Array.isArray(r[i])){var a=r[i];r[i]=[],r[i].push(a)}r[i].push(o)}else r[i]=t?[o]:o}return r};r.parse=function(e,t){return h(s(e,t),g(t).arrayMode)},r.getTraversalObj=s,r.convertToJson=h,r.validate=e("./validator").validate},{"./util":2,"./validator":3}],2:[function(e,t,r){var n=function(e,t){var r=t.exec(e);return null!==r&&void 0!==r};r.doesMatch=n,r.doesNotMatch=function(e,t){return!n(e,t)},r.getAllMatches=function(e,t){for(var r=[],n=t.exec(e);n;){for(var i=[],o=0;o<n.length;o++)i.push(n[o]);r.push(i),n=t.exec(e)}return r}},{}],3:[function(e,t,r){function n(e){return!f.doesMatch(e,u)&&!f.doesNotMatch(e,d)}function o(e){var t=f.getAllMatches(e,g);for(i=0;i<t.length;i++){if(t[i][1].trim().length>0&&t[i][1].trim().length<4)return!1;if(0!==t[i][1].trim().length){var r=f.getAllMatches(t[i][1],s),n=[];for(j=0;j<r.length;j++){if(n.hasOwnProperty(r[j][1]))return!1;n[r[j][1]]=1}}}return!0}function a(e,t){if(e.length===t)return!0;if(0===e[t][0].indexOf("</"))return t;if(e[t][0].indexOf("/>")===e[t][0].length-2)return!1===n(e[t][0].substring(1))?-1:a(e,t+1);if(e.length>t+1){if(0===e[t+1][0].indexOf("</"))return!1===n(e[t][1])?-1:e[t][1]===e[t+1][1]?a(e,t+2):-1;var r=a(e,t+1);if(-1!==r&&0===e[r][0].indexOf("</"))return!1===n(e[t][1])?-1:e[t][1]===e[r][1]?a(e,r+1):-1}return-1}var f=e("./util"),l=new RegExp("<\\/?([\\w:\\-_.]+)\\s*/?>","g");r.validate=function(e){if(e=e.replace(/\n/g,""),e=e.replace(/(<!\[CDATA\[.*?\]\]>)/g,""),e=e.replace(/(<!--.*?(?:-->))/g,""),!0!==o(e))return!1;if(e=e.replace(/(\s+(?:[\w:\-]+)\s*=\s*(['\"]).*?\2)/g,""),(e=e.replace(/(^\s*<\?xml\s*\?>)/g,"")).indexOf("<![CDATA[")>0||e.indexOf("\x3c!--")>0)return!1;var t=f.getAllMatches(e,l);return 0!==t.length&&!0===a(t,0)};var u=new RegExp("^[Xx][Mm][Ll]"),d=new RegExp("^([a-zA-Z]|_)[\\w.\\-_:]*"),g=new RegExp("<[\\w:\\-_.]+(.*?)/?>","g"),s=new RegExp("\\s+([\\w:-]+)\\s*=\\s*(['\"])(.*?)\\2","g")},{"./util":2}]},{},[1])(1)});