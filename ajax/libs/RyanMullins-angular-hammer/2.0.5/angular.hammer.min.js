// Copyright (c) 2014 Ryan S Mullins <ryan@ryanmullins.org>
// Licensed under the MIT Software License
!function(n,e,t){"use strict";function a(n){return{restrict:"A",link:function(a,r,h){var p=r.data("hammer"),c=e.fromJson(h.hmOptions),m=e.fromJson(h.hmCustom);p||(p=new t.Manager(r[0],c),r.data("hammer",p)),e.forEach(m,function(e){var t,r,h;e.directions&&(e.directions=o(e.directions)),h=p.get(e.event),h?h.set(e):i(p,e),e.recognizeWith&&h.recognizeWith(e.recognizeWith),e.requireFailure&&h.requireFailure(e.requireFailure),t=n(e.val),r=function(n){var i=a.$root.$$phase,o=function(){t(a,{$event:n})};a[e.val]?a[e.val](n):"$apply"===i||"$digest"===i?o():a.$apply(o)},p.on(e.event,r),a.$on("$destroy",function(){p.off(e.event,r)})})}}}function i(n,e){var a;e&&e.type&&e.event&&("pan"===e.type&&(a=new t.Pan(e)),"pinch"===e.type&&(a=new t.Pinch(e)),"press"===e.type&&(a=new t.Press(e)),"rotate"===e.type&&(a=new t.Rotate(e)),"swipe"===e.type&&(a=new t.Swipe(e)),"tap"===e.type&&(a=new t.Tap(e))),n&&a&&n.add(a)}function o(n){var a=0;return e.forEach(n.split("|"),function(n){t.hasOwnProperty(n)&&(a|=t[n])}),a}var r=["hmPan:pan","hmPanstart:panstart","hmPanmove:panmove","hmPanend:panend","hmPancancel:pancancel","hmPanleft:panleft","hmPanright:panright","hmPanup:panup","hmPandown:pandown","hmPinch:pinch","hmPinchstart:pinchstart","hmPinchmove:pinchmove","hmPinchend:pinchend","hmPinchcancel:pinchcancel","hmPinchin:pinchin","hmPinchout:pinchout","hmPress:press","hmRotate:rotate","hmRotatestart:rotatestart","hmRotatemove:rotatemove","hmRotateend:rotateend","hmRotatecancel:rotatecancel","hmSwipe:swipe","hmSwipeleft:swipeleft","hmSwiperight:swiperight","hmSwipeup:swipeup","hmSwipedown:swipedown","hmTap:tap","hmDoubletap:doubletap"];e.module("hmTouchEvents",[]).directive("hmCustom",["$parse",a]),e.forEach(r,function(n){var a=n.split(":"),i=a[0],o=a[1];e.module("hmTouchEvents").directive(i,["$parse","$window",function(n,a){return{restrict:"A",link:function(r,h,p){var c=p[i],m=n(c),s=function(n){var e=r.$root.$$phase,t=function(){m(r,{$event:n})};r[c]?r[c](n):"$apply"===e||"$digest"===e?t():r.$apply(t)},u=e.fromJson(p.hmOptions),d=h.data("hammer");return t&&a.addEventListener?(d||(d=new t(h[0],u),h.data("hammer",d)),d.on(o,s),void r.$on("$destroy",function(){d.off(o,s)})):("hmTap"===i&&h.bind("click",s),void("hmDoubleTap"===i&&h.bind("dblclick",s)))}}}])})}(window,window.angular,window.Hammer);