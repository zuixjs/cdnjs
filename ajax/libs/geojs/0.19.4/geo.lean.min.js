!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(function(){try{return require("hammerjs")}catch(t){}}(),function(){try{return require("d3")}catch(t){}}(),function(){try{return require("vtk")}catch(t){}}()):"function"==typeof define&&define.amd?define(["hammerjs","d3","vtk"],e):"object"==typeof exports?exports.geo=e(function(){try{return require("hammerjs")}catch(t){}}(),function(){try{return require("d3")}catch(t){}}(),function(){try{return require("vtk")}catch(t){}}()):t.geo=e(t.Hammer,t.d3,t.vtk)}("undefined"!=typeof self?self:this,function(t,e,n){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="dist/built",n(n.s=135)}([function(t,e,n){"use strict";t.exports=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";var i=n(2),r={dom:{}},o={},a={},s={},u={},l={},c={},h={},d={},f={registerFileReader:function(t,e){c[t]=e},createFileReader:function(t,e){return c.hasOwnProperty(t)?c[t](e):null},registerRenderer:function(t,e){s[t]=e},createRenderer:function(t,e,n,i){if(s.hasOwnProperty(t)){var r=s[t]({layer:e,canvas:n,options:i});return r._init(),r}return null},checkRenderer:function(t,e){if(null===t)return t;if(s.hasOwnProperty(t)){var n=s[t];if(!n.supported||n.supported())return n.apiname||t;if(!n.fallback||e)return!1;var i=f.checkRenderer(n.fallback(),!0);return!1!==i&&console.warn(t+" renderer is unavailable, using "+i+" renderer instead"),i}return!1},rendererForFeatures:function(t){var e,n,i,r,o,a,s=["webgl","canvas","svg","vtkjs",null];for(n=0;n<s.length;n+=1)if(e=s[n],!1!==f.checkRenderer(e,!0)){if(!t)return e;if(u[e]){for(a=!0,r=0;r<t.length;r+=1){if(o=null,(i=t[r]).indexOf(".")>=0&&(o=i,i=i.substr(0,i.indexOf("."))),void 0===u[e][i]){a=!1;break}if(o&&l[e][i]&&!l[e][i][o]){a=!1;break}}if(a)return e}}return console.warn('There is no renderer available for the feature list "'+(t||[]).join(", ")+'".'),!1},registerFeature:function(t,e,n,i){t in u||(u[t]={},l[t]={});var r=u[t][e];return r&&console.warn("The "+t+"."+e+" feature is already registered"),u[t][e]=n,l[t][e]=i,r},createFeature:function(t,e,n,r){var o=n.api(),a={layer:e,renderer:n};if(o in u&&t in u[o]){void 0!==r&&i.extend(!0,a,r);var s=u[o][t](a);return void 0===e.gcs&&(e.gcs=function(){return e.map().gcs()}),s}return null},registerLayerAdjustment:function(t,e,n){t in h||(h[t]={});var i=h[t][e];return i&&console.warn("The "+t+"."+e+" layer adjustment is already registered"),h[t][e]=n,i},adjustLayerForRenderer:function(t,e){var n=e.rendererName();n&&h&&h[n]&&h[n][t]&&h[n][t].apply(e)},registerLayer:function(t,e,n){o[t]=e,a[t]=n},createLayer:function(t,e,n){var r={map:e},s=null;return t in o?(n.renderer||n.features||!a||(r.features=a[t]),void 0!==n&&i.extend(!0,r,n),(s=o[t](r)).layerName=t,s._init(),s):null},registerWidget:function(t,e,n){t in r||(r[t]={});var i=r[t][e];return i&&console.warn("The "+t+"."+e+" widget is already registered"),r[t][e]=n,i},createWidget:function(t,e,n){var o={layer:e};if(t in r.dom)return void 0!==n&&i.extend(!0,o,n),r.dom[t](o);throw new Error("Cannot create unknown widget "+t)},registerAnnotation:function(t,e,n){var i=d[t];return i&&console.warn("The "+t+" annotation is already registered"),d[t]={func:e,features:n||{}},i},createAnnotation:function(t,e){if(d[t])return d[t].func(e);console.warn("The "+t+" annotation is not registered")},listAnnotations:function(){return Object.keys(d)},featuresForAnnotations:function(t){var e=[];return(Array.isArray(t)?t:Object.keys(t)).forEach(function(n){d[n]&&Object.keys(d[n].features).forEach(function(r){Array.isArray(t)||!0===t[n]||!Array.isArray(d[n].features[r])?e.push(r):t[n].forEach(function(t){i.inArray(t,d[n].features[r])>=0&&e.push(r)})})}),e},rendererForAnnotations:function(t){return f.rendererForFeatures(f.featuresForAnnotations(t))}};f.registries={annotations:d,features:u,featureCapabilities:l,fileReaders:c,layers:o,renderers:s,widgets:r},t.exports=f},function(t,e,n){var i;
/*!
 * jQuery JavaScript Library v3.4.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-04-10T19:48Z
 */
/*!
 * jQuery JavaScript Library v3.4.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2019-04-10T19:48Z
 */
!function(e,n){"use strict";"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,function(n,r){"use strict";var o=[],a=n.document,s=Object.getPrototypeOf,u=o.slice,l=o.concat,c=o.push,h=o.indexOf,d={},f=d.toString,p=d.hasOwnProperty,m=p.toString,g=m.call(Object),v={},y=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},x=function(t){return null!=t&&t===t.window},b={type:!0,src:!0,nonce:!0,noModule:!0};function _(t,e,n){var i,r,o=(n=n||a).createElement("script");if(o.text=t,e)for(i in b)(r=e[i]||e.getAttribute&&e.getAttribute(i))&&o.setAttribute(i,r);n.head.appendChild(o).parentNode.removeChild(o)}function w(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?d[f.call(t)]||"object":typeof t}var M=function(t,e){return new M.fn.init(t,e)},A=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function T(t){var e=!!t&&"length"in t&&t.length,n=w(t);return!y(t)&&!x(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}M.fn=M.prototype={jquery:"3.4.0",constructor:M,length:0,toArray:function(){return u.call(this)},get:function(t){return null==t?u.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=M.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return M.each(this,t)},map:function(t){return this.pushStack(M.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(u.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:c,sort:o.sort,splice:o.splice},M.extend=M.fn.extend=function(){var t,e,n,i,r,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||y(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(t=arguments[s]))for(e in t)i=t[e],"__proto__"!==e&&a!==i&&(l&&i&&(M.isPlainObject(i)||(r=Array.isArray(i)))?(n=a[e],o=r&&!Array.isArray(n)?[]:r||M.isPlainObject(n)?n:{},r=!1,a[e]=M.extend(l,o,i)):void 0!==i&&(a[e]=i));return a},M.extend({expando:"jQuery"+("3.4.0"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==f.call(t))&&(!(e=s(t))||"function"==typeof(n=p.call(e,"constructor")&&e.constructor)&&m.call(n)===g)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e){_(t,{nonce:e&&e.nonce})},each:function(t,e){var n,i=0;if(T(t))for(n=t.length;i<n&&!1!==e.call(t[i],i,t[i]);i++);else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},trim:function(t){return null==t?"":(t+"").replace(A,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?M.merge(n,"string"==typeof t?[t]:t):c.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:h.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,r=t.length;i<n;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,n){for(var i=[],r=0,o=t.length,a=!n;r<o;r++)!e(t[r],r)!==a&&i.push(t[r]);return i},map:function(t,e,n){var i,r,o=0,a=[];if(T(t))for(i=t.length;o<i;o++)null!=(r=e(t[o],o,n))&&a.push(r);else for(o in t)null!=(r=e(t[o],o,n))&&a.push(r);return l.apply([],a)},guid:1,support:v}),"function"==typeof Symbol&&(M.fn[Symbol.iterator]=o[Symbol.iterator]),M.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){d["[object "+e+"]"]=e.toLowerCase()});var C=
/*!
 * Sizzle CSS Selector Engine v2.3.4
 * https://sizzlejs.com/
 *
 * Copyright JS Foundation and other contributors
 * Released under the MIT license
 * https://js.foundation/
 *
 * Date: 2019-04-08
 */
function(t){var e,n,i,r,o,a,s,u,l,c,h,d,f,p,m,g,v,y,x,b="sizzle"+1*new Date,_=t.document,w=0,M=0,A=ut(),T=ut(),C=ut(),E=ut(),O=function(t,e){return t===e&&(h=!0),0},S={}.hasOwnProperty,P=[],k=P.pop,R=P.push,j=P.push,L=P.slice,D=function(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1},I="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",N="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",z="\\["+F+"*("+N+")(?:"+F+"*([*^$|!~]?=)"+F+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+F+"*\\]",B=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+z+")*)|.*)\\)|)",U=new RegExp(F+"+","g"),G=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),V=new RegExp("^"+F+"*,"+F+"*"),q=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),H=new RegExp(F+"|>"),W=new RegExp(B),X=new RegExp("^"+N+"$"),Q={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N+"|[*])"),ATTR:new RegExp("^"+z),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+I+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},K=/HTML$/i,Z=/^(?:input|select|textarea|button)$/i,Y=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\([\\da-f]{1,6}"+F+"?|("+F+")|.)","ig"),nt=function(t,e,n){var i="0x"+e-65536;return i!=i||n?e:i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},ot=function(){d()},at=bt(function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{j.apply(P=L.call(_.childNodes),_.childNodes),P[_.childNodes.length].nodeType}catch(t){j={apply:P.length?function(t,e){R.apply(t,L.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}function st(t,e,i,r){var o,s,l,c,h,p,v,y=e&&e.ownerDocument,w=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return i;if(!r&&((e?e.ownerDocument||e:_)!==f&&d(e),e=e||f,m)){if(11!==w&&(h=J.exec(t)))if(o=h[1]){if(9===w){if(!(l=e.getElementById(o)))return i;if(l.id===o)return i.push(l),i}else if(y&&(l=y.getElementById(o))&&x(e,l)&&l.id===o)return i.push(l),i}else{if(h[2])return j.apply(i,e.getElementsByTagName(t)),i;if((o=h[3])&&n.getElementsByClassName&&e.getElementsByClassName)return j.apply(i,e.getElementsByClassName(o)),i}if(n.qsa&&!E[t+" "]&&(!g||!g.test(t))&&(1!==w||"object"!==e.nodeName.toLowerCase())){if(v=t,y=e,1===w&&H.test(t)){for((c=e.getAttribute("id"))?c=c.replace(it,rt):e.setAttribute("id",c=b),s=(p=a(t)).length;s--;)p[s]="#"+c+" "+xt(p[s]);v=p.join(","),y=tt.test(t)&&vt(e.parentNode)||e}try{return j.apply(i,y.querySelectorAll(v)),i}catch(e){E(t,!0)}finally{c===b&&e.removeAttribute("id")}}}return u(t.replace(G,"$1"),e,i,r)}function ut(){var t=[];return function e(n,r){return t.push(n+" ")>i.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function lt(t){return t[b]=!0,t}function ct(t){var e=f.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var n=t.split("|"),r=n.length;r--;)i.attrHandle[n[r]]=e}function dt(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ft(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function mt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&at(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return lt(function(e){return e=+e,lt(function(n,i){for(var r,o=t([],n.length,e),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))})})}function vt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=st.support={},o=st.isXML=function(t){var e=t.namespaceURI,n=(t.ownerDocument||t).documentElement;return!K.test(e||n&&n.nodeName||"HTML")},d=st.setDocument=function(t){var e,r,a=t?t.ownerDocument||t:_;return a!==f&&9===a.nodeType&&a.documentElement?(p=(f=a).documentElement,m=!o(f),_!==f&&(r=f.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",ot,!1):r.attachEvent&&r.attachEvent("onunload",ot)),n.attributes=ct(function(t){return t.className="i",!t.getAttribute("className")}),n.getElementsByTagName=ct(function(t){return t.appendChild(f.createComment("")),!t.getElementsByTagName("*").length}),n.getElementsByClassName=$.test(f.getElementsByClassName),n.getById=ct(function(t){return p.appendChild(t).id=b,!f.getElementsByName||!f.getElementsByName(b).length}),n.getById?(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n=e.getElementById(t);return n?[n]:[]}}):(i.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},i.find.ID=function(t,e){if(void 0!==e.getElementById&&m){var n,i,r,o=e.getElementById(t);if(o){if((n=o.getAttributeNode("id"))&&n.value===t)return[o];for(r=e.getElementsByName(t),i=0;o=r[i++];)if((n=o.getAttributeNode("id"))&&n.value===t)return[o]}return[]}}),i.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],r=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},i.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&m)return e.getElementsByClassName(t)},v=[],g=[],(n.qsa=$.test(f.querySelectorAll))&&(ct(function(t){p.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&g.push("[*^$]="+F+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||g.push("\\["+F+"*(?:value|"+I+")"),t.querySelectorAll("[id~="+b+"-]").length||g.push("~="),t.querySelectorAll(":checked").length||g.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||g.push(".#.+[+~]")}),ct(function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=f.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&g.push("name"+F+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&g.push(":enabled",":disabled"),p.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&g.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),g.push(",.*:")})),(n.matchesSelector=$.test(y=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ct(function(t){n.disconnectedMatch=y.call(t,"*"),y.call(t,"[s!='']:x"),v.push("!=",B)}),g=g.length&&new RegExp(g.join("|")),v=v.length&&new RegExp(v.join("|")),e=$.test(p.compareDocumentPosition),x=e||$.test(p.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},O=e?function(t,e){if(t===e)return h=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===i?t===f||t.ownerDocument===_&&x(_,t)?-1:e===f||e.ownerDocument===_&&x(_,e)?1:c?D(c,t)-D(c,e):0:4&i?-1:1)}:function(t,e){if(t===e)return h=!0,0;var n,i=0,r=t.parentNode,o=e.parentNode,a=[t],s=[e];if(!r||!o)return t===f?-1:e===f?1:r?-1:o?1:c?D(c,t)-D(c,e):0;if(r===o)return dt(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[i]===s[i];)i++;return i?dt(a[i],s[i]):a[i]===_?-1:s[i]===_?1:0},f):f},st.matches=function(t,e){return st(t,null,null,e)},st.matchesSelector=function(t,e){if((t.ownerDocument||t)!==f&&d(t),n.matchesSelector&&m&&!E[e+" "]&&(!v||!v.test(e))&&(!g||!g.test(e)))try{var i=y.call(t,e);if(i||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){E(e,!0)}return st(e,f,null,[t]).length>0},st.contains=function(t,e){return(t.ownerDocument||t)!==f&&d(t),x(t,e)},st.attr=function(t,e){(t.ownerDocument||t)!==f&&d(t);var r=i.attrHandle[e.toLowerCase()],o=r&&S.call(i.attrHandle,e.toLowerCase())?r(t,e,!m):void 0;return void 0!==o?o:n.attributes||!m?t.getAttribute(e):(o=t.getAttributeNode(e))&&o.specified?o.value:null},st.escape=function(t){return(t+"").replace(it,rt)},st.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},st.uniqueSort=function(t){var e,i=[],r=0,o=0;if(h=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(O),h){for(;e=t[o++];)e===t[o]&&(r=i.push(o));for(;r--;)t.splice(i[r],1)}return c=null,t},r=st.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=r(e);return n},(i=st.selectors={cacheLength:50,createPseudo:lt,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||st.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&st.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Q.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&W.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=A[t+" "];return e||(e=new RegExp("(^|"+F+")"+t+"("+F+"|$)"))&&A(t,function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(i){var r=st.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(U," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,i,r){var o="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,n,u){var l,c,h,d,f,p,m=o!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),y=!u&&!s,x=!1;if(g){if(o){for(;m;){for(d=e;d=d[m];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;p=m="only"===t&&!p&&"nextSibling"}return!0}if(p=[a?g.firstChild:g.lastChild],a&&y){for(x=(f=(l=(c=(h=(d=g)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&l[1])&&l[2],d=f&&g.childNodes[f];d=++f&&d&&d[m]||(x=f=0)||p.pop();)if(1===d.nodeType&&++x&&d===e){c[t]=[w,f,x];break}}else if(y&&(x=f=(l=(c=(h=(d=e)[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]||[])[0]===w&&l[1]),!1===x)for(;(d=++f&&d&&d[m]||(x=f=0)||p.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++x||(y&&((c=(h=d[b]||(d[b]={}))[d.uniqueID]||(h[d.uniqueID]={}))[t]=[w,x]),d!==e)););return(x-=r)===i||x%i==0&&x/i>=0}}},PSEUDO:function(t,e){var n,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||st.error("unsupported pseudo: "+t);return r[b]?r(e):r.length>1?(n=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?lt(function(t,n){for(var i,o=r(t,e),a=o.length;a--;)t[i=D(t,o[a])]=!(n[i]=o[a])}):function(t){return r(t,0,n)}):r}},pseudos:{not:lt(function(t){var e=[],n=[],i=s(t.replace(G,"$1"));return i[b]?lt(function(t,e,n,r){for(var o,a=i(t,null,r,[]),s=t.length;s--;)(o=a[s])&&(t[s]=!(e[s]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}}),has:lt(function(t){return function(e){return st(t,e).length>0}}),contains:lt(function(t){return t=t.replace(et,nt),function(e){return(e.textContent||r(e)).indexOf(t)>-1}}),lang:lt(function(t){return X.test(t||"")||st.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=m?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===p},focus:function(t){return t===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:mt(!1),disabled:mt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos.empty(t)},header:function(t){return Y.test(t.nodeName)},input:function(t){return Z.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt(function(){return[0]}),last:gt(function(t,e){return[e-1]}),eq:gt(function(t,e,n){return[n<0?n+e:n]}),even:gt(function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t}),odd:gt(function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t}),lt:gt(function(t,e,n){for(var i=n<0?n+e:n>e?e:n;--i>=0;)t.push(i);return t}),gt:gt(function(t,e,n){for(var i=n<0?n+e:n;++i<e;)t.push(i);return t})}}).pseudos.nth=i.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=ft(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=pt(e);function yt(){}function xt(t){for(var e=0,n=t.length,i="";e<n;e++)i+=t[e].value;return i}function bt(t,e,n){var i=e.dir,r=e.next,o=r||i,a=n&&"parentNode"===o,s=M++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||a)return t(e,n,r);return!1}:function(e,n,u){var l,c,h,d=[w,s];if(u){for(;e=e[i];)if((1===e.nodeType||a)&&t(e,n,u))return!0}else for(;e=e[i];)if(1===e.nodeType||a)if(c=(h=e[b]||(e[b]={}))[e.uniqueID]||(h[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((l=c[o])&&l[0]===w&&l[1]===s)return d[2]=l[2];if(c[o]=d,d[2]=t(e,n,u))return!0}return!1}}function _t(t){return t.length>1?function(e,n,i){for(var r=t.length;r--;)if(!t[r](e,n,i))return!1;return!0}:t[0]}function wt(t,e,n,i,r){for(var o,a=[],s=0,u=t.length,l=null!=e;s<u;s++)(o=t[s])&&(n&&!n(o,i,r)||(a.push(o),l&&e.push(s)));return a}function Mt(t,e,n,i,r,o){return i&&!i[b]&&(i=Mt(i)),r&&!r[b]&&(r=Mt(r,o)),lt(function(o,a,s,u){var l,c,h,d=[],f=[],p=a.length,m=o||function(t,e,n){for(var i=0,r=e.length;i<r;i++)st(t,e[i],n);return n}(e||"*",s.nodeType?[s]:s,[]),g=!t||!o&&e?m:wt(m,d,t,s,u),v=n?r||(o?t:p||i)?[]:a:g;if(n&&n(g,v,s,u),i)for(l=wt(v,f),i(l,[],s,u),c=l.length;c--;)(h=l[c])&&(v[f[c]]=!(g[f[c]]=h));if(o){if(r||t){if(r){for(l=[],c=v.length;c--;)(h=v[c])&&l.push(g[c]=h);r(null,v=[],l,u)}for(c=v.length;c--;)(h=v[c])&&(l=r?D(o,h):d[c])>-1&&(o[l]=!(a[l]=h))}}else v=wt(v===a?v.splice(p,v.length):v),r?r(null,a,v,u):j.apply(a,v)})}function At(t){for(var e,n,r,o=t.length,a=i.relative[t[0].type],s=a||i.relative[" "],u=a?1:0,c=bt(function(t){return t===e},s,!0),h=bt(function(t){return D(e,t)>-1},s,!0),d=[function(t,n,i){var r=!a&&(i||n!==l)||((e=n).nodeType?c(t,n,i):h(t,n,i));return e=null,r}];u<o;u++)if(n=i.relative[t[u].type])d=[bt(_t(d),n)];else{if((n=i.filter[t[u].type].apply(null,t[u].matches))[b]){for(r=++u;r<o&&!i.relative[t[r].type];r++);return Mt(u>1&&_t(d),u>1&&xt(t.slice(0,u-1).concat({value:" "===t[u-2].type?"*":""})).replace(G,"$1"),n,u<r&&At(t.slice(u,r)),r<o&&At(t=t.slice(r)),r<o&&xt(t))}d.push(n)}return _t(d)}return yt.prototype=i.filters=i.pseudos,i.setFilters=new yt,a=st.tokenize=function(t,e){var n,r,o,a,s,u,l,c=T[t+" "];if(c)return e?0:c.slice(0);for(s=t,u=[],l=i.preFilter;s;){for(a in n&&!(r=V.exec(s))||(r&&(s=s.slice(r[0].length)||s),u.push(o=[])),n=!1,(r=q.exec(s))&&(n=r.shift(),o.push({value:n,type:r[0].replace(G," ")}),s=s.slice(n.length)),i.filter)!(r=Q[a].exec(s))||l[a]&&!(r=l[a](r))||(n=r.shift(),o.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?st.error(t):T(t,u).slice(0)},s=st.compile=function(t,e){var n,r=[],o=[],s=C[t+" "];if(!s){for(e||(e=a(t)),n=e.length;n--;)(s=At(e[n]))[b]?r.push(s):o.push(s);(s=C(t,function(t,e){var n=e.length>0,r=t.length>0,o=function(o,a,s,u,c){var h,p,g,v=0,y="0",x=o&&[],b=[],_=l,M=o||r&&i.find.TAG("*",c),A=w+=null==_?1:Math.random()||.1,T=M.length;for(c&&(l=a===f||a||c);y!==T&&null!=(h=M[y]);y++){if(r&&h){for(p=0,a||h.ownerDocument===f||(d(h),s=!m);g=t[p++];)if(g(h,a||f,s)){u.push(h);break}c&&(w=A)}n&&((h=!g&&h)&&v--,o&&x.push(h))}if(v+=y,n&&y!==v){for(p=0;g=e[p++];)g(x,b,a,s);if(o){if(v>0)for(;y--;)x[y]||b[y]||(b[y]=k.call(u));b=wt(b)}j.apply(u,b),c&&!o&&b.length>0&&v+e.length>1&&st.uniqueSort(u)}return c&&(w=A,l=_),x};return n?lt(o):o}(o,r))).selector=t}return s},u=st.select=function(t,e,n,r){var o,u,l,c,h,d="function"==typeof t&&t,f=!r&&a(t=d.selector||t);if(n=n||[],1===f.length){if((u=f[0]=f[0].slice(0)).length>2&&"ID"===(l=u[0]).type&&9===e.nodeType&&m&&i.relative[u[1].type]){if(!(e=(i.find.ID(l.matches[0].replace(et,nt),e)||[])[0]))return n;d&&(e=e.parentNode),t=t.slice(u.shift().value.length)}for(o=Q.needsContext.test(t)?0:u.length;o--&&(l=u[o],!i.relative[c=l.type]);)if((h=i.find[c])&&(r=h(l.matches[0].replace(et,nt),tt.test(u[0].type)&&vt(e.parentNode)||e))){if(u.splice(o,1),!(t=r.length&&xt(u)))return j.apply(n,r),n;break}}return(d||s(t,f))(r,e,!m,n,!e||tt.test(t)&&vt(e.parentNode)||e),n},n.sortStable=b.split("").sort(O).join("")===b,n.detectDuplicates=!!h,d(),n.sortDetached=ct(function(t){return 1&t.compareDocumentPosition(f.createElement("fieldset"))}),ct(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||ht("type|href|height|width",function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),n.attributes&&ct(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||ht("value",function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue}),ct(function(t){return null==t.getAttribute("disabled")})||ht(I,function(t,e,n){var i;if(!n)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),st}(n);M.find=C,M.expr=C.selectors,M.expr[":"]=M.expr.pseudos,M.uniqueSort=M.unique=C.uniqueSort,M.text=C.getText,M.isXMLDoc=C.isXML,M.contains=C.contains,M.escapeSelector=C.escape;var E=function(t,e,n){for(var i=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&M(t).is(n))break;i.push(t)}return i},O=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},S=M.expr.match.needsContext;function P(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var k=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function R(t,e,n){return y(e)?M.grep(t,function(t,i){return!!e.call(t,i,t)!==n}):e.nodeType?M.grep(t,function(t){return t===e!==n}):"string"!=typeof e?M.grep(t,function(t){return h.call(e,t)>-1!==n}):M.filter(e,t,n)}M.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?M.find.matchesSelector(i,t)?[i]:[]:M.find.matches(t,M.grep(e,function(t){return 1===t.nodeType}))},M.fn.extend({find:function(t){var e,n,i=this.length,r=this;if("string"!=typeof t)return this.pushStack(M(t).filter(function(){for(e=0;e<i;e++)if(M.contains(r[e],this))return!0}));for(n=this.pushStack([]),e=0;e<i;e++)M.find(t,r[e],n);return i>1?M.uniqueSort(n):n},filter:function(t){return this.pushStack(R(this,t||[],!1))},not:function(t){return this.pushStack(R(this,t||[],!0))},is:function(t){return!!R(this,"string"==typeof t&&S.test(t)?M(t):t||[],!1).length}});var j,L=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(M.fn.init=function(t,e,n){var i,r;if(!t)return this;if(n=n||j,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:L.exec(t))||!i[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof M?e[0]:e,M.merge(this,M.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:a,!0)),k.test(i[1])&&M.isPlainObject(e))for(i in e)y(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(r=a.getElementById(i[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y(t)?void 0!==n.ready?n.ready(t):t(M):M.makeArray(t,this)}).prototype=M.fn,j=M(a);var D=/^(?:parents|prev(?:Until|All))/,I={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}M.fn.extend({has:function(t){var e=M(t,this),n=e.length;return this.filter(function(){for(var t=0;t<n;t++)if(M.contains(this,e[t]))return!0})},closest:function(t,e){var n,i=0,r=this.length,o=[],a="string"!=typeof t&&M(t);if(!S.test(t))for(;i<r;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&M.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?M.uniqueSort(o):o)},index:function(t){return t?"string"==typeof t?h.call(M(t),this[0]):h.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(M.uniqueSort(M.merge(this.get(),M(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),M.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return E(t,"parentNode")},parentsUntil:function(t,e,n){return E(t,"parentNode",n)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return E(t,"nextSibling")},prevAll:function(t){return E(t,"previousSibling")},nextUntil:function(t,e,n){return E(t,"nextSibling",n)},prevUntil:function(t,e,n){return E(t,"previousSibling",n)},siblings:function(t){return O((t.parentNode||{}).firstChild,t)},children:function(t){return O(t.firstChild)},contents:function(t){return void 0!==t.contentDocument?t.contentDocument:(P(t,"template")&&(t=t.content||t),M.merge([],t.childNodes))}},function(t,e){M.fn[t]=function(n,i){var r=M.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=M.filter(i,r)),this.length>1&&(I[t]||M.uniqueSort(r),D.test(t)&&r.reverse()),this.pushStack(r)}});var N=/[^\x20\t\r\n\f]+/g;function z(t){return t}function B(t){throw t}function U(t,e,n,i){var r;try{t&&y(r=t.promise)?r.call(t).done(e).fail(n):t&&y(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(i))}catch(t){n.apply(void 0,[t])}}M.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return M.each(t.match(N)||[],function(t,n){e[n]=!0}),e}(t):M.extend({},t);var e,n,i,r,o=[],a=[],s=-1,u=function(){for(r=r||t.once,i=e=!0;a.length;s=-1)for(n=a.shift();++s<o.length;)!1===o[s].apply(n[0],n[1])&&t.stopOnFalse&&(s=o.length,n=!1);t.memory||(n=!1),e=!1,r&&(o=n?[]:"")},l={add:function(){return o&&(n&&!e&&(s=o.length-1,a.push(n)),function e(n){M.each(n,function(n,i){y(i)?t.unique&&l.has(i)||o.push(i):i&&i.length&&"string"!==w(i)&&e(i)})}(arguments),n&&!e&&u()),this},remove:function(){return M.each(arguments,function(t,e){for(var n;(n=M.inArray(e,o,n))>-1;)o.splice(n,1),n<=s&&s--}),this},has:function(t){return t?M.inArray(t,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return r=a=[],o=n="",this},disabled:function(){return!o},lock:function(){return r=a=[],n||e||(o=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],a.push(n),e||u()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},M.extend({Deferred:function(t){var e=[["notify","progress",M.Callbacks("memory"),M.Callbacks("memory"),2],["resolve","done",M.Callbacks("once memory"),M.Callbacks("once memory"),0,"resolved"],["reject","fail",M.Callbacks("once memory"),M.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return M.Deferred(function(n){M.each(e,function(e,i){var r=y(t[i[4]])&&t[i[4]];o[i[1]](function(){var t=r&&r.apply(this,arguments);t&&y(t.promise)?t.promise().progress(n.notify).done(n.resolve).fail(n.reject):n[i[0]+"With"](this,r?[t]:arguments)})}),t=null}).promise()},then:function(t,i,r){var o=0;function a(t,e,i,r){return function(){var s=this,u=arguments,l=function(){var n,l;if(!(t<o)){if((n=i.apply(s,u))===e.promise())throw new TypeError("Thenable self-resolution");l=n&&("object"==typeof n||"function"==typeof n)&&n.then,y(l)?r?l.call(n,a(o,e,z,r),a(o,e,B,r)):(o++,l.call(n,a(o,e,z,r),a(o,e,B,r),a(o,e,z,e.notifyWith))):(i!==z&&(s=void 0,u=[n]),(r||e.resolveWith)(s,u))}},c=r?l:function(){try{l()}catch(n){M.Deferred.exceptionHook&&M.Deferred.exceptionHook(n,c.stackTrace),t+1>=o&&(i!==B&&(s=void 0,u=[n]),e.rejectWith(s,u))}};t?c():(M.Deferred.getStackHook&&(c.stackTrace=M.Deferred.getStackHook()),n.setTimeout(c))}}return M.Deferred(function(n){e[0][3].add(a(0,n,y(r)?r:z,n.notifyWith)),e[1][3].add(a(0,n,y(t)?t:z)),e[2][3].add(a(0,n,y(i)?i:B))}).promise()},promise:function(t){return null!=t?M.extend(t,r):r}},o={};return M.each(e,function(t,n){var a=n[2],s=n[5];r[n[1]]=a.add,s&&a.add(function(){i=s},e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),a.add(n[3].fire),o[n[0]]=function(){return o[n[0]+"With"](this===o?void 0:this,arguments),this},o[n[0]+"With"]=a.fireWith}),r.promise(o),t&&t.call(o,o),o},when:function(t){var e=arguments.length,n=e,i=Array(n),r=u.call(arguments),o=M.Deferred(),a=function(t){return function(n){i[t]=this,r[t]=arguments.length>1?u.call(arguments):n,--e||o.resolveWith(i,r)}};if(e<=1&&(U(t,o.done(a(n)).resolve,o.reject,!e),"pending"===o.state()||y(r[n]&&r[n].then)))return o.then();for(;n--;)U(r[n],a(n),o.reject);return o.promise()}});var G=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;M.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&G.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},M.readyException=function(t){n.setTimeout(function(){throw t})};var V=M.Deferred();function q(){a.removeEventListener("DOMContentLoaded",q),n.removeEventListener("load",q),M.ready()}M.fn.ready=function(t){return V.then(t).catch(function(t){M.readyException(t)}),this},M.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--M.readyWait:M.isReady)||(M.isReady=!0,!0!==t&&--M.readyWait>0||V.resolveWith(a,[M]))}}),M.ready.then=V.then,"complete"===a.readyState||"loading"!==a.readyState&&!a.documentElement.doScroll?n.setTimeout(M.ready):(a.addEventListener("DOMContentLoaded",q),n.addEventListener("load",q));var H=function(t,e,n,i,r,o,a){var s=0,u=t.length,l=null==n;if("object"===w(n))for(s in r=!0,n)H(t,e,s,n[s],!0,o,a);else if(void 0!==i&&(r=!0,y(i)||(a=!0),l&&(a?(e.call(t,i),e=null):(l=e,e=function(t,e,n){return l.call(M(t),n)})),e))for(;s<u;s++)e(t[s],n,a?i:i.call(t[s],s,e(t[s],n)));return r?t:l?e.call(t):u?e(t[0],n):o},W=/^-ms-/,X=/-([a-z])/g;function Q(t,e){return e.toUpperCase()}function K(t){return t.replace(W,"ms-").replace(X,Q)}var Z=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function Y(){this.expando=M.expando+Y.uid++}Y.uid=1,Y.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Z(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var i,r=this.cache(t);if("string"==typeof e)r[K(e)]=n;else for(i in e)r[K(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][K(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i=t[this.expando];if(void 0!==i){if(void 0!==e){n=(e=Array.isArray(e)?e.map(K):(e=K(e))in i?[e]:e.match(N)||[]).length;for(;n--;)delete i[e[n]]}(void 0===e||M.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!M.isEmptyObject(e)}};var $=new Y,J=new Y,tt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,et=/[A-Z]/g;function nt(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(et,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(i))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:tt.test(t)?JSON.parse(t):t)}(n)}catch(t){}J.set(t,e,n)}else n=void 0;return n}M.extend({hasData:function(t){return J.hasData(t)||$.hasData(t)},data:function(t,e,n){return J.access(t,e,n)},removeData:function(t,e){J.remove(t,e)},_data:function(t,e,n){return $.access(t,e,n)},_removeData:function(t,e){$.remove(t,e)}}),M.fn.extend({data:function(t,e){var n,i,r,o=this[0],a=o&&o.attributes;if(void 0===t){if(this.length&&(r=J.get(o),1===o.nodeType&&!$.get(o,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(i=a[n].name).indexOf("data-")&&(i=K(i.slice(5)),nt(o,i,r[i]));$.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each(function(){J.set(this,t)}):H(this,function(e){var n;if(o&&void 0===e)return void 0!==(n=J.get(o,t))?n:void 0!==(n=nt(o,t))?n:void 0;this.each(function(){J.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){J.remove(this,t)})}}),M.extend({queue:function(t,e,n){var i;if(t)return e=(e||"fx")+"queue",i=$.get(t,e),n&&(!i||Array.isArray(n)?i=$.access(t,e,M.makeArray(n)):i.push(n)),i||[]},dequeue:function(t,e){e=e||"fx";var n=M.queue(t,e),i=n.length,r=n.shift(),o=M._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===e&&n.unshift("inprogress"),delete o.stop,r.call(t,function(){M.dequeue(t,e)},o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return $.get(t,n)||$.access(t,n,{empty:M.Callbacks("once memory").add(function(){$.remove(t,[e+"queue",n])})})}}),M.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?M.queue(this[0],t):void 0===e?this:this.each(function(){var n=M.queue(this,t,e);M._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&M.dequeue(this,t)})},dequeue:function(t){return this.each(function(){M.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,r=M.Deferred(),o=this,a=this.length,s=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=$.get(o[a],t+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),r.promise(e)}});var it=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rt=new RegExp("^(?:([+-])=|)("+it+")([a-z%]*)$","i"),ot=["Top","Right","Bottom","Left"],at=a.documentElement,st=function(t){return M.contains(t.ownerDocument,t)},ut={composed:!0};at.attachShadow&&(st=function(t){return M.contains(t.ownerDocument,t)||t.getRootNode(ut)===t.ownerDocument});var lt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&st(t)&&"none"===M.css(t,"display")},ct=function(t,e,n,i){var r,o,a={};for(o in e)a[o]=t.style[o],t.style[o]=e[o];for(o in r=n.apply(t,i||[]),e)t.style[o]=a[o];return r};function ht(t,e,n,i){var r,o,a=20,s=i?function(){return i.cur()}:function(){return M.css(t,e,"")},u=s(),l=n&&n[3]||(M.cssNumber[e]?"":"px"),c=t.nodeType&&(M.cssNumber[e]||"px"!==l&&+u)&&rt.exec(M.css(t,e));if(c&&c[3]!==l){for(u/=2,l=l||c[3],c=+u||1;a--;)M.style(t,e,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,M.style(t,e,c+l),n=n||[]}return n&&(c=+c||+u||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],i&&(i.unit=l,i.start=c,i.end=r)),r}var dt={};function ft(t){var e,n=t.ownerDocument,i=t.nodeName,r=dt[i];return r||(e=n.body.appendChild(n.createElement(i)),r=M.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),dt[i]=r,r)}function pt(t,e){for(var n,i,r=[],o=0,a=t.length;o<a;o++)(i=t[o]).style&&(n=i.style.display,e?("none"===n&&(r[o]=$.get(i,"display")||null,r[o]||(i.style.display="")),""===i.style.display&&lt(i)&&(r[o]=ft(i))):"none"!==n&&(r[o]="none",$.set(i,"display",n)));for(o=0;o<a;o++)null!=r[o]&&(t[o].style.display=r[o]);return t}M.fn.extend({show:function(){return pt(this,!0)},hide:function(){return pt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){lt(this)?M(this).show():M(this).hide()})}});var mt=/^(?:checkbox|radio)$/i,gt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,vt=/^$|^module$|\/(?:java|ecma)script/i,yt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function xt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&P(t,e)?M.merge([t],n):n}function bt(t,e){for(var n=0,i=t.length;n<i;n++)$.set(t[n],"globalEval",!e||$.get(e[n],"globalEval"))}yt.optgroup=yt.option,yt.tbody=yt.tfoot=yt.colgroup=yt.caption=yt.thead,yt.th=yt.td;var _t,wt,Mt=/<|&#?\w+;/;function At(t,e,n,i,r){for(var o,a,s,u,l,c,h=e.createDocumentFragment(),d=[],f=0,p=t.length;f<p;f++)if((o=t[f])||0===o)if("object"===w(o))M.merge(d,o.nodeType?[o]:o);else if(Mt.test(o)){for(a=a||h.appendChild(e.createElement("div")),s=(gt.exec(o)||["",""])[1].toLowerCase(),u=yt[s]||yt._default,a.innerHTML=u[1]+M.htmlPrefilter(o)+u[2],c=u[0];c--;)a=a.lastChild;M.merge(d,a.childNodes),(a=h.firstChild).textContent=""}else d.push(e.createTextNode(o));for(h.textContent="",f=0;o=d[f++];)if(i&&M.inArray(o,i)>-1)r&&r.push(o);else if(l=st(o),a=xt(h.appendChild(o),"script"),l&&bt(a),n)for(c=0;o=a[c++];)vt.test(o.type||"")&&n.push(o);return h}_t=a.createDocumentFragment().appendChild(a.createElement("div")),(wt=a.createElement("input")).setAttribute("type","radio"),wt.setAttribute("checked","checked"),wt.setAttribute("name","t"),_t.appendChild(wt),v.checkClone=_t.cloneNode(!0).cloneNode(!0).lastChild.checked,_t.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!_t.cloneNode(!0).lastChild.defaultValue;var Tt=/^key/,Ct=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Et=/^([^.]*)(?:\.(.+)|)/;function Ot(){return!0}function St(){return!1}function Pt(t,e){return t===function(){try{return a.activeElement}catch(t){}}()==("focus"===e)}function kt(t,e,n,i,r,o){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(i=i||n,n=void 0),e)kt(t,s,n,i,e[s],o);return t}if(null==i&&null==r?(r=n,i=n=void 0):null==r&&("string"==typeof n?(r=i,i=void 0):(r=i,i=n,n=void 0)),!1===r)r=St;else if(!r)return t;return 1===o&&(a=r,(r=function(t){return M().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=M.guid++)),t.each(function(){M.event.add(this,e,r,i,n)})}function Rt(t,e,n){n?($.set(t,e,!1),M.event.add(t,e,{namespace:!1,handler:function(t){var i,r,o=$.get(this,e);if(1&t.isTrigger&&this[e]){if(o)(M.event.special[e]||{}).delegateType&&t.stopPropagation();else if(o=u.call(arguments),$.set(this,e,o),i=n(this,e),this[e](),o!==(r=$.get(this,e))||i?$.set(this,e,!1):r=void 0,o!==r)return t.stopImmediatePropagation(),t.preventDefault(),r}else o&&($.set(this,e,M.event.trigger(M.extend(o.shift(),M.Event.prototype),o,this)),t.stopImmediatePropagation())}})):M.event.add(t,e,Ot)}M.event={global:{},add:function(t,e,n,i,r){var o,a,s,u,l,c,h,d,f,p,m,g=$.get(t);if(g)for(n.handler&&(n=(o=n).handler,r=o.selector),r&&M.find.matchesSelector(at,r),n.guid||(n.guid=M.guid++),(u=g.events)||(u=g.events={}),(a=g.handle)||(a=g.handle=function(e){return void 0!==M&&M.event.triggered!==e.type?M.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(N)||[""]).length;l--;)f=m=(s=Et.exec(e[l])||[])[1],p=(s[2]||"").split(".").sort(),f&&(h=M.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,h=M.event.special[f]||{},c=M.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&M.expr.match.needsContext.test(r),namespace:p.join(".")},o),(d=u[f])||((d=u[f]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,i,p,a)||t.addEventListener&&t.addEventListener(f,a)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),M.event.global[f]=!0)},remove:function(t,e,n,i,r){var o,a,s,u,l,c,h,d,f,p,m,g=$.hasData(t)&&$.get(t);if(g&&(u=g.events)){for(l=(e=(e||"").match(N)||[""]).length;l--;)if(f=m=(s=Et.exec(e[l])||[])[1],p=(s[2]||"").split(".").sort(),f){for(h=M.event.special[f]||{},d=u[f=(i?h.delegateType:h.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=d.length;o--;)c=d[o],!r&&m!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(d.splice(o,1),c.selector&&d.delegateCount--,h.remove&&h.remove.call(t,c));a&&!d.length&&(h.teardown&&!1!==h.teardown.call(t,p,g.handle)||M.removeEvent(t,f,g.handle),delete u[f])}else for(f in u)M.event.remove(t,f+e[l],n,i,!0);M.isEmptyObject(u)&&$.remove(t,"handle events")}},dispatch:function(t){var e,n,i,r,o,a,s=M.event.fix(t),u=new Array(arguments.length),l=($.get(this,"events")||{})[s.type]||[],c=M.event.special[s.type]||{};for(u[0]=s,e=1;e<arguments.length;e++)u[e]=arguments[e];if(s.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,s)){for(a=M.event.handlers.call(this,s,l),e=0;(r=a[e++])&&!s.isPropagationStopped();)for(s.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!1!==o.namespace&&!s.rnamespace.test(o.namespace)||(s.handleObj=o,s.data=o.data,void 0!==(i=((M.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,u))&&!1===(s.result=i)&&(s.preventDefault(),s.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,s),s.result}},handlers:function(t,e){var n,i,r,o,a,s=[],u=e.delegateCount,l=t.target;if(u&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[r=(i=e[n]).selector+" "]&&(a[r]=i.needsContext?M(r,this).index(l)>-1:M.find(r,this,null,[l]).length),a[r]&&o.push(i);o.length&&s.push({elem:l,handlers:o})}return l=this,u<e.length&&s.push({elem:l,handlers:e.slice(u)}),s},addProp:function(t,e){Object.defineProperty(M.Event.prototype,t,{enumerable:!0,configurable:!0,get:y(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[M.expando]?t:new M.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return mt.test(e.type)&&e.click&&P(e,"input")&&void 0===$.get(e,"click")&&Rt(e,"click",Ot),!1},trigger:function(t){var e=this||t;return mt.test(e.type)&&e.click&&P(e,"input")&&void 0===$.get(e,"click")&&Rt(e,"click"),!0},_default:function(t){var e=t.target;return mt.test(e.type)&&e.click&&P(e,"input")&&$.get(e,"click")||P(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},M.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},M.Event=function(t,e){if(!(this instanceof M.Event))return new M.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Ot:St,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&M.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[M.expando]=!0},M.Event.prototype={constructor:M.Event,isDefaultPrevented:St,isPropagationStopped:St,isImmediatePropagationStopped:St,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Ot,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Ot,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Ot,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},M.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&Tt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&Ct.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},M.event.addProp),M.each({focus:"focusin",blur:"focusout"},function(t,e){M.event.special[t]={setup:function(){return Rt(this,t,Pt),!1},trigger:function(){return Rt(this,t),!0},delegateType:e}}),M.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){M.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=t.relatedTarget,r=t.handleObj;return i&&(i===this||M.contains(this,i))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}}),M.fn.extend({on:function(t,e,n,i){return kt(this,t,e,n,i)},one:function(t,e,n,i){return kt(this,t,e,n,i,1)},off:function(t,e,n){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,M(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=St),this.each(function(){M.event.remove(this,t,n,e)})}});var jt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Lt=/<script|<style|<link/i,Dt=/checked\s*(?:[^=]|=\s*.checked.)/i,It=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ft(t,e){return P(t,"table")&&P(11!==e.nodeType?e:e.firstChild,"tr")&&M(t).children("tbody")[0]||t}function Nt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function zt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Bt(t,e){var n,i,r,o,a,s,u,l;if(1===e.nodeType){if($.hasData(t)&&(o=$.access(t),a=$.set(e,o),l=o.events))for(r in delete a.handle,a.events={},l)for(n=0,i=l[r].length;n<i;n++)M.event.add(e,r,l[r][n]);J.hasData(t)&&(s=J.access(t),u=M.extend({},s),J.set(e,u))}}function Ut(t,e,n,i){e=l.apply([],e);var r,o,a,s,u,c,h=0,d=t.length,f=d-1,p=e[0],m=y(p);if(m||d>1&&"string"==typeof p&&!v.checkClone&&Dt.test(p))return t.each(function(r){var o=t.eq(r);m&&(e[0]=p.call(this,r,o.html())),Ut(o,e,n,i)});if(d&&(o=(r=At(e,t[0].ownerDocument,!1,t,i)).firstChild,1===r.childNodes.length&&(r=o),o||i)){for(s=(a=M.map(xt(r,"script"),Nt)).length;h<d;h++)u=r,h!==f&&(u=M.clone(u,!0,!0),s&&M.merge(a,xt(u,"script"))),n.call(t[h],u,h);if(s)for(c=a[a.length-1].ownerDocument,M.map(a,zt),h=0;h<s;h++)u=a[h],vt.test(u.type||"")&&!$.access(u,"globalEval")&&M.contains(c,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?M._evalUrl&&!u.noModule&&M._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")}):_(u.textContent.replace(It,""),u,c))}return t}function Gt(t,e,n){for(var i,r=e?M.filter(e,t):t,o=0;null!=(i=r[o]);o++)n||1!==i.nodeType||M.cleanData(xt(i)),i.parentNode&&(n&&st(i)&&bt(xt(i,"script")),i.parentNode.removeChild(i));return t}M.extend({htmlPrefilter:function(t){return t.replace(jt,"<$1></$2>")},clone:function(t,e,n){var i,r,o,a,s,u,l,c=t.cloneNode(!0),h=st(t);if(!(v.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||M.isXMLDoc(t)))for(a=xt(c),i=0,r=(o=xt(t)).length;i<r;i++)s=o[i],u=a[i],void 0,"input"===(l=u.nodeName.toLowerCase())&&mt.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(e)if(n)for(o=o||xt(t),a=a||xt(c),i=0,r=o.length;i<r;i++)Bt(o[i],a[i]);else Bt(t,c);return(a=xt(c,"script")).length>0&&bt(a,!h&&xt(t,"script")),c},cleanData:function(t){for(var e,n,i,r=M.event.special,o=0;void 0!==(n=t[o]);o++)if(Z(n)){if(e=n[$.expando]){if(e.events)for(i in e.events)r[i]?M.event.remove(n,i):M.removeEvent(n,i,e.handle);n[$.expando]=void 0}n[J.expando]&&(n[J.expando]=void 0)}}}),M.fn.extend({detach:function(t){return Gt(this,t,!0)},remove:function(t){return Gt(this,t)},text:function(t){return H(this,function(t){return void 0===t?M.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)})},null,t,arguments.length)},append:function(){return Ut(this,arguments,function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ft(this,t).appendChild(t)})},prepend:function(){return Ut(this,arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Ft(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return Ut(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Ut(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(M.cleanData(xt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map(function(){return M.clone(this,t,e)})},html:function(t){return H(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Lt.test(t)&&!yt[(gt.exec(t)||["",""])[1].toLowerCase()]){t=M.htmlPrefilter(t);try{for(;n<i;n++)1===(e=this[n]||{}).nodeType&&(M.cleanData(xt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=[];return Ut(this,arguments,function(e){var n=this.parentNode;M.inArray(this,t)<0&&(M.cleanData(xt(this)),n&&n.replaceChild(e,this))},t)}}),M.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){M.fn[t]=function(t){for(var n,i=[],r=M(t),o=r.length-1,a=0;a<=o;a++)n=a===o?this:this.clone(!0),M(r[a])[e](n),c.apply(i,n.get());return this.pushStack(i)}});var Vt=new RegExp("^("+it+")(?!px)[a-z%]+$","i"),qt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},Ht=new RegExp(ot.join("|"),"i");function Wt(t,e,n){var i,r,o,a,s=t.style;return(n=n||qt(t))&&(""!==(a=n.getPropertyValue(e)||n[e])||st(t)||(a=M.style(t,e)),!v.pixelBoxStyles()&&Vt.test(a)&&Ht.test(e)&&(i=s.width,r=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=r,s.maxWidth=o)),void 0!==a?a+"":a}function Xt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",at.appendChild(l).appendChild(c);var t=n.getComputedStyle(c);i="1%"!==t.top,u=12===e(t.marginLeft),c.style.right="60%",s=36===e(t.right),r=36===e(t.width),c.style.position="absolute",o=12===e(c.offsetWidth/3),at.removeChild(l),c=null}}function e(t){return Math.round(parseFloat(t))}var i,r,o,s,u,l=a.createElement("div"),c=a.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===c.style.backgroundClip,M.extend(v,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),u},scrollboxSize:function(){return t(),o}}))}();var Qt=["Webkit","Moz","ms"],Kt=a.createElement("div").style,Zt={};function Yt(t){var e=M.cssProps[t]||Zt[t];return e||(t in Kt?t:Zt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Qt.length;n--;)if((t=Qt[n]+e)in Kt)return t}(t)||t)}var $t=/^(none|table(?!-c[ea]).+)/,Jt=/^--/,te={position:"absolute",visibility:"hidden",display:"block"},ee={letterSpacing:"0",fontWeight:"400"};function ne(t,e,n){var i=rt.exec(e);return i?Math.max(0,i[2]-(n||0))+(i[3]||"px"):e}function ie(t,e,n,i,r,o){var a="width"===e?1:0,s=0,u=0;if(n===(i?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=M.css(t,n+ot[a],!0,r)),i?("content"===n&&(u-=M.css(t,"padding"+ot[a],!0,r)),"margin"!==n&&(u-=M.css(t,"border"+ot[a]+"Width",!0,r))):(u+=M.css(t,"padding"+ot[a],!0,r),"padding"!==n?u+=M.css(t,"border"+ot[a]+"Width",!0,r):s+=M.css(t,"border"+ot[a]+"Width",!0,r));return!i&&o>=0&&(u+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-u-s-.5))||0),u}function re(t,e,n){var i=qt(t),r=(!v.boxSizingReliable()||n)&&"border-box"===M.css(t,"boxSizing",!1,i),o=r,a=Wt(t,e,i),s="offset"+e[0].toUpperCase()+e.slice(1);if(Vt.test(a)){if(!n)return a;a="auto"}return(!v.boxSizingReliable()&&r||"auto"===a||!parseFloat(a)&&"inline"===M.css(t,"display",!1,i))&&t.getClientRects().length&&(r="border-box"===M.css(t,"boxSizing",!1,i),(o=s in t)&&(a=t[s])),(a=parseFloat(a)||0)+ie(t,e,n||(r?"border":"content"),o,i,a)+"px"}function oe(t,e,n,i,r){return new oe.prototype.init(t,e,n,i,r)}M.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Wt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,s=K(e),u=Jt.test(e),l=t.style;if(u||(e=Yt(s)),a=M.cssHooks[e]||M.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(t,!1,i))?r:l[e];"string"===(o=typeof n)&&(r=rt.exec(n))&&r[1]&&(n=ht(t,e,r),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=r&&r[3]||(M.cssNumber[s]?"":"px")),v.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,i))||(u?l.setProperty(e,n):l[e]=n))}},css:function(t,e,n,i){var r,o,a,s=K(e);return Jt.test(e)||(e=Yt(s)),(a=M.cssHooks[e]||M.cssHooks[s])&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=Wt(t,e,i)),"normal"===r&&e in ee&&(r=ee[e]),""===n||n?(o=parseFloat(r),!0===n||isFinite(o)?o||0:r):r}}),M.each(["height","width"],function(t,e){M.cssHooks[e]={get:function(t,n,i){if(n)return!$t.test(M.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?re(t,e,i):ct(t,te,function(){return re(t,e,i)})},set:function(t,n,i){var r,o=qt(t),a=!v.scrollboxSize()&&"absolute"===o.position,s=(a||i)&&"border-box"===M.css(t,"boxSizing",!1,o),u=i?ie(t,e,i,s,o):0;return s&&a&&(u-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(o[e])-ie(t,e,"border",!1,o)-.5)),u&&(r=rt.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=M.css(t,e)),ne(0,n,u)}}}),M.cssHooks.marginLeft=Xt(v.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Wt(t,"marginLeft"))||t.getBoundingClientRect().left-ct(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"}),M.each({margin:"",padding:"",border:"Width"},function(t,e){M.cssHooks[t+e]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];i<4;i++)r[t+ot[i]+e]=o[i]||o[i-2]||o[0];return r}},"margin"!==t&&(M.cssHooks[t+e].set=ne)}),M.fn.extend({css:function(t,e){return H(this,function(t,e,n){var i,r,o={},a=0;if(Array.isArray(e)){for(i=qt(t),r=e.length;a<r;a++)o[e[a]]=M.css(t,e[a],!1,i);return o}return void 0!==n?M.style(t,e,n):M.css(t,e)},t,e,arguments.length>1)}}),M.Tween=oe,oe.prototype={constructor:oe,init:function(t,e,n,i,r,o){this.elem=t,this.prop=n,this.easing=r||M.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(M.cssNumber[n]?"":"px")},cur:function(){var t=oe.propHooks[this.prop];return t&&t.get?t.get(this):oe.propHooks._default.get(this)},run:function(t){var e,n=oe.propHooks[this.prop];return this.options.duration?this.pos=e=M.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):oe.propHooks._default.set(this),this}},oe.prototype.init.prototype=oe.prototype,oe.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=M.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){M.fx.step[t.prop]?M.fx.step[t.prop](t):1!==t.elem.nodeType||!M.cssHooks[t.prop]&&null==t.elem.style[Yt(t.prop)]?t.elem[t.prop]=t.now:M.style(t.elem,t.prop,t.now+t.unit)}}},oe.propHooks.scrollTop=oe.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},M.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},M.fx=oe.prototype.init,M.fx.step={};var ae,se,ue=/^(?:toggle|show|hide)$/,le=/queueHooks$/;function ce(){se&&(!1===a.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(ce):n.setTimeout(ce,M.fx.interval),M.fx.tick())}function he(){return n.setTimeout(function(){ae=void 0}),ae=Date.now()}function de(t,e){var n,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)r["margin"+(n=ot[i])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function fe(t,e,n){for(var i,r=(pe.tweeners[e]||[]).concat(pe.tweeners["*"]),o=0,a=r.length;o<a;o++)if(i=r[o].call(n,e,t))return i}function pe(t,e,n){var i,r,o=0,a=pe.prefilters.length,s=M.Deferred().always(function(){delete u.elem}),u=function(){if(r)return!1;for(var e=ae||he(),n=Math.max(0,l.startTime+l.duration-e),i=1-(n/l.duration||0),o=0,a=l.tweens.length;o<a;o++)l.tweens[o].run(i);return s.notifyWith(t,[l,i,n]),i<1&&a?n:(a||s.notifyWith(t,[l,1,0]),s.resolveWith(t,[l]),!1)},l=s.promise({elem:t,props:M.extend({},e),opts:M.extend(!0,{specialEasing:{},easing:M.easing._default},n),originalProperties:e,originalOptions:n,startTime:ae||he(),duration:n.duration,tweens:[],createTween:function(e,n){var i=M.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var n=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;n<i;n++)l.tweens[n].run(1);return e?(s.notifyWith(t,[l,1,0]),s.resolveWith(t,[l,e])):s.rejectWith(t,[l,e]),this}}),c=l.props;for(!function(t,e){var n,i,r,o,a;for(n in t)if(r=e[i=K(n)],o=t[n],Array.isArray(o)&&(r=o[1],o=t[n]=o[0]),n!==i&&(t[i]=o,delete t[n]),(a=M.cssHooks[i])&&"expand"in a)for(n in o=a.expand(o),delete t[i],o)n in t||(t[n]=o[n],e[n]=r);else e[i]=r}(c,l.opts.specialEasing);o<a;o++)if(i=pe.prefilters[o].call(l,t,c,l.opts))return y(i.stop)&&(M._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return M.map(c,fe,l),y(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),M.fx.timer(M.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l}M.Animation=M.extend(pe,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return ht(n.elem,t,rt.exec(e),n),n}]},tweener:function(t,e){y(t)?(e=t,t=["*"]):t=t.match(N);for(var n,i=0,r=t.length;i<r;i++)n=t[i],pe.tweeners[n]=pe.tweeners[n]||[],pe.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var i,r,o,a,s,u,l,c,h="width"in e||"height"in e,d=this,f={},p=t.style,m=t.nodeType&&lt(t),g=$.get(t,"fxshow");for(i in n.queue||(null==(a=M._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,M.queue(t,"fx").length||a.empty.fire()})})),e)if(r=e[i],ue.test(r)){if(delete e[i],o=o||"toggle"===r,r===(m?"hide":"show")){if("show"!==r||!g||void 0===g[i])continue;m=!0}f[i]=g&&g[i]||M.style(t,i)}if((u=!M.isEmptyObject(e))||!M.isEmptyObject(f))for(i in h&&1===t.nodeType&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],null==(l=g&&g.display)&&(l=$.get(t,"display")),"none"===(c=M.css(t,"display"))&&(l?c=l:(pt([t],!0),l=t.style.display||l,c=M.css(t,"display"),pt([t]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===M.css(t,"float")&&(u||(d.done(function(){p.display=l}),null==l&&(c=p.display,l="none"===c?"":c)),p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=!1,f)u||(g?"hidden"in g&&(m=g.hidden):g=$.access(t,"fxshow",{display:l}),o&&(g.hidden=!m),m&&pt([t],!0),d.done(function(){for(i in m||pt([t]),$.remove(t,"fxshow"),f)M.style(t,i,f[i])})),u=fe(m?g[i]:0,i,d),i in g||(g[i]=u.start,m&&(u.end=u.start,u.start=0))}],prefilter:function(t,e){e?pe.prefilters.unshift(t):pe.prefilters.push(t)}}),M.speed=function(t,e,n){var i=t&&"object"==typeof t?M.extend({},t):{complete:n||!n&&e||y(t)&&t,duration:t,easing:n&&e||e&&!y(e)&&e};return M.fx.off?i.duration=0:"number"!=typeof i.duration&&(i.duration in M.fx.speeds?i.duration=M.fx.speeds[i.duration]:i.duration=M.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){y(i.old)&&i.old.call(this),i.queue&&M.dequeue(this,i.queue)},i},M.fn.extend({fadeTo:function(t,e,n,i){return this.filter(lt).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var r=M.isEmptyObject(t),o=M.speed(e,n,i),a=function(){var e=pe(this,M.extend({},t),o);(r||$.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each(function(){var e=!0,r=null!=t&&t+"queueHooks",o=M.timers,a=$.get(this);if(r)a[r]&&a[r].stop&&i(a[r]);else for(r in a)a[r]&&a[r].stop&&le.test(r)&&i(a[r]);for(r=o.length;r--;)o[r].elem!==this||null!=t&&o[r].queue!==t||(o[r].anim.stop(n),e=!1,o.splice(r,1));!e&&n||M.dequeue(this,t)})},finish:function(t){return!1!==t&&(t=t||"fx"),this.each(function(){var e,n=$.get(this),i=n[t+"queue"],r=n[t+"queueHooks"],o=M.timers,a=i?i.length:0;for(n.finish=!0,M.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<a;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),M.each(["toggle","show","hide"],function(t,e){var n=M.fn[e];M.fn[e]=function(t,i,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(de(e,!0),t,i,r)}}),M.each({slideDown:de("show"),slideUp:de("hide"),slideToggle:de("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){M.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),M.timers=[],M.fx.tick=function(){var t,e=0,n=M.timers;for(ae=Date.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||M.fx.stop(),ae=void 0},M.fx.timer=function(t){M.timers.push(t),M.fx.start()},M.fx.interval=13,M.fx.start=function(){se||(se=!0,ce())},M.fx.stop=function(){se=null},M.fx.speeds={slow:600,fast:200,_default:400},M.fn.delay=function(t,e){return t=M.fx&&M.fx.speeds[t]||t,e=e||"fx",this.queue(e,function(e,i){var r=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(r)}})},function(){var t=a.createElement("input"),e=a.createElement("select").appendChild(a.createElement("option"));t.type="checkbox",v.checkOn=""!==t.value,v.optSelected=e.selected,(t=a.createElement("input")).value="t",t.type="radio",v.radioValue="t"===t.value}();var me,ge=M.expr.attrHandle;M.fn.extend({attr:function(t,e){return H(this,M.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){M.removeAttr(this,t)})}}),M.extend({attr:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return void 0===t.getAttribute?M.prop(t,e,n):(1===o&&M.isXMLDoc(t)||(r=M.attrHooks[e.toLowerCase()]||(M.expr.match.bool.test(e)?me:void 0)),void 0!==n?null===n?void M.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(i=r.get(t,e))?i:null==(i=M.find.attr(t,e))?void 0:i)},attrHooks:{type:{set:function(t,e){if(!v.radioValue&&"radio"===e&&P(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,i=0,r=e&&e.match(N);if(r&&1===t.nodeType)for(;n=r[i++];)t.removeAttribute(n)}}),me={set:function(t,e,n){return!1===e?M.removeAttr(t,n):t.setAttribute(n,n),n}},M.each(M.expr.match.bool.source.match(/\w+/g),function(t,e){var n=ge[e]||M.find.attr;ge[e]=function(t,e,i){var r,o,a=e.toLowerCase();return i||(o=ge[a],ge[a]=r,r=null!=n(t,e,i)?a:null,ge[a]=o),r}});var ve=/^(?:input|select|textarea|button)$/i,ye=/^(?:a|area)$/i;function xe(t){return(t.match(N)||[]).join(" ")}function be(t){return t.getAttribute&&t.getAttribute("class")||""}function _e(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(N)||[]}M.fn.extend({prop:function(t,e){return H(this,M.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[M.propFix[t]||t]})}}),M.extend({prop:function(t,e,n){var i,r,o=t.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&M.isXMLDoc(t)||(e=M.propFix[e]||e,r=M.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:t[e]=n:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=M.find.attr(t,"tabindex");return e?parseInt(e,10):ve.test(t.nodeName)||ye.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(M.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),M.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){M.propFix[this.toLowerCase()]=this}),M.fn.extend({addClass:function(t){var e,n,i,r,o,a,s,u=0;if(y(t))return this.each(function(e){M(this).addClass(t.call(this,e,be(this)))});if((e=_e(t)).length)for(;n=this[u++];)if(r=be(n),i=1===n.nodeType&&" "+xe(r)+" "){for(a=0;o=e[a++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");r!==(s=xe(i))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,i,r,o,a,s,u=0;if(y(t))return this.each(function(e){M(this).removeClass(t.call(this,e,be(this)))});if(!arguments.length)return this.attr("class","");if((e=_e(t)).length)for(;n=this[u++];)if(r=be(n),i=1===n.nodeType&&" "+xe(r)+" "){for(a=0;o=e[a++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");r!==(s=xe(i))&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t,i="string"===n||Array.isArray(t);return"boolean"==typeof e&&i?e?this.addClass(t):this.removeClass(t):y(t)?this.each(function(n){M(this).toggleClass(t.call(this,n,be(this),e),e)}):this.each(function(){var e,r,o,a;if(i)for(r=0,o=M(this),a=_e(t);e=a[r++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else void 0!==t&&"boolean"!==n||((e=be(this))&&$.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":$.get(this,"__className__")||""))})},hasClass:function(t){var e,n,i=0;for(e=" "+t+" ";n=this[i++];)if(1===n.nodeType&&(" "+xe(be(n))+" ").indexOf(e)>-1)return!0;return!1}});var we=/\r/g;M.fn.extend({val:function(t){var e,n,i,r=this[0];return arguments.length?(i=y(t),this.each(function(n){var r;1===this.nodeType&&(null==(r=i?t.call(this,n,M(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=M.map(r,function(t){return null==t?"":t+""})),(e=M.valHooks[this.type]||M.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))})):r?(e=M.valHooks[r.type]||M.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(we,""):null==n?"":n:void 0}}),M.extend({valHooks:{option:{get:function(t){var e=M.find.attr(t,"value");return null!=e?e:xe(M.text(t))}},select:{get:function(t){var e,n,i,r=t.options,o=t.selectedIndex,a="select-one"===t.type,s=a?null:[],u=a?o+1:r.length;for(i=o<0?u:a?o:0;i<u;i++)if(((n=r[i]).selected||i===o)&&!n.disabled&&(!n.parentNode.disabled||!P(n.parentNode,"optgroup"))){if(e=M(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,i,r=t.options,o=M.makeArray(e),a=r.length;a--;)((i=r[a]).selected=M.inArray(M.valHooks.option.get(i),o)>-1)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),M.each(["radio","checkbox"],function(){M.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=M.inArray(M(t).val(),e)>-1}},v.checkOn||(M.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),v.focusin="onfocusin"in n;var Me=/^(?:focusinfocus|focusoutblur)$/,Ae=function(t){t.stopPropagation()};M.extend(M.event,{trigger:function(t,e,i,r){var o,s,u,l,c,h,d,f,m=[i||a],g=p.call(t,"type")?t.type:t,v=p.call(t,"namespace")?t.namespace.split("."):[];if(s=f=u=i=i||a,3!==i.nodeType&&8!==i.nodeType&&!Me.test(g+M.event.triggered)&&(g.indexOf(".")>-1&&(g=(v=g.split(".")).shift(),v.sort()),c=g.indexOf(":")<0&&"on"+g,(t=t[M.expando]?t:new M.Event(g,"object"==typeof t&&t)).isTrigger=r?2:3,t.namespace=v.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:M.makeArray(e,[t]),d=M.event.special[g]||{},r||!d.trigger||!1!==d.trigger.apply(i,e))){if(!r&&!d.noBubble&&!x(i)){for(l=d.delegateType||g,Me.test(l+g)||(s=s.parentNode);s;s=s.parentNode)m.push(s),u=s;u===(i.ownerDocument||a)&&m.push(u.defaultView||u.parentWindow||n)}for(o=0;(s=m[o++])&&!t.isPropagationStopped();)f=s,t.type=o>1?l:d.bindType||g,(h=($.get(s,"events")||{})[t.type]&&$.get(s,"handle"))&&h.apply(s,e),(h=c&&s[c])&&h.apply&&Z(s)&&(t.result=h.apply(s,e),!1===t.result&&t.preventDefault());return t.type=g,r||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(m.pop(),e)||!Z(i)||c&&y(i[g])&&!x(i)&&((u=i[c])&&(i[c]=null),M.event.triggered=g,t.isPropagationStopped()&&f.addEventListener(g,Ae),i[g](),t.isPropagationStopped()&&f.removeEventListener(g,Ae),M.event.triggered=void 0,u&&(i[c]=u)),t.result}},simulate:function(t,e,n){var i=M.extend(new M.Event,n,{type:t,isSimulated:!0});M.event.trigger(i,null,e)}}),M.fn.extend({trigger:function(t,e){return this.each(function(){M.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];if(n)return M.event.trigger(t,e,n,!0)}}),v.focusin||M.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){M.event.simulate(e,t.target,M.event.fix(t))};M.event.special[e]={setup:function(){var i=this.ownerDocument||this,r=$.access(i,e);r||i.addEventListener(t,n,!0),$.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=$.access(i,e)-1;r?$.access(i,e,r):(i.removeEventListener(t,n,!0),$.remove(i,e))}}});var Te=n.location,Ce=Date.now(),Ee=/\?/;M.parseXML=function(t){var e;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){e=void 0}return e&&!e.getElementsByTagName("parsererror").length||M.error("Invalid XML: "+t),e};var Oe=/\[\]$/,Se=/\r?\n/g,Pe=/^(?:submit|button|image|reset|file)$/i,ke=/^(?:input|select|textarea|keygen)/i;function Re(t,e,n,i){var r;if(Array.isArray(e))M.each(e,function(e,r){n||Oe.test(t)?i(t,r):Re(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,i)});else if(n||"object"!==w(e))i(t,e);else for(r in e)Re(t+"["+r+"]",e[r],n,i)}M.param=function(t,e){var n,i=[],r=function(t,e){var n=y(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!M.isPlainObject(t))M.each(t,function(){r(this.name,this.value)});else for(n in t)Re(n,t[n],e,r);return i.join("&")},M.fn.extend({serialize:function(){return M.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=M.prop(this,"elements");return t?M.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!M(this).is(":disabled")&&ke.test(this.nodeName)&&!Pe.test(t)&&(this.checked||!mt.test(t))}).map(function(t,e){var n=M(this).val();return null==n?null:Array.isArray(n)?M.map(n,function(t){return{name:e.name,value:t.replace(Se,"\r\n")}}):{name:e.name,value:n.replace(Se,"\r\n")}}).get()}});var je=/%20/g,Le=/#.*$/,De=/([?&])_=[^&]*/,Ie=/^(.*?):[ \t]*([^\r\n]*)$/gm,Fe=/^(?:GET|HEAD)$/,Ne=/^\/\//,ze={},Be={},Ue="*/".concat("*"),Ge=a.createElement("a");function Ve(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,r=0,o=e.toLowerCase().match(N)||[];if(y(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function qe(t,e,n,i){var r={},o=t===Be;function a(s){var u;return r[s]=!0,M.each(t[s]||[],function(t,s){var l=s(e,n,i);return"string"!=typeof l||o||r[l]?o?!(u=l):void 0:(e.dataTypes.unshift(l),a(l),!1)}),u}return a(e.dataTypes[0])||!r["*"]&&a("*")}function He(t,e){var n,i,r=M.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:i||(i={}))[n]=e[n]);return i&&M.extend(!0,t,i),t}Ge.href=Te.href,M.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Te.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Te.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ue,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":M.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?He(He(t,M.ajaxSettings),e):He(M.ajaxSettings,t)},ajaxPrefilter:Ve(ze),ajaxTransport:Ve(Be),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,r,o,s,u,l,c,h,d,f,p=M.ajaxSetup({},e),m=p.context||p,g=p.context&&(m.nodeType||m.jquery)?M(m):M.event,v=M.Deferred(),y=M.Callbacks("once memory"),x=p.statusCode||{},b={},_={},w="canceled",A={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Ie.exec(o);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return c?o:null},setRequestHeader:function(t,e){return null==c&&(t=_[t.toLowerCase()]=_[t.toLowerCase()]||t,b[t]=e),this},overrideMimeType:function(t){return null==c&&(p.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)A.always(t[A.status]);else for(e in t)x[e]=[x[e],t[e]];return this},abort:function(t){var e=t||w;return i&&i.abort(e),T(0,e),this}};if(v.promise(A),p.url=((t||p.url||Te.href)+"").replace(Ne,Te.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(N)||[""],null==p.crossDomain){l=a.createElement("a");try{l.href=p.url,l.href=l.href,p.crossDomain=Ge.protocol+"//"+Ge.host!=l.protocol+"//"+l.host}catch(t){p.crossDomain=!0}}if(p.data&&p.processData&&"string"!=typeof p.data&&(p.data=M.param(p.data,p.traditional)),qe(ze,p,e,A),c)return A;for(d in(h=M.event&&p.global)&&0==M.active++&&M.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Fe.test(p.type),r=p.url.replace(Le,""),p.hasContent?p.data&&p.processData&&0===(p.contentType||"").indexOf("application/x-www-form-urlencoded")&&(p.data=p.data.replace(je,"+")):(f=p.url.slice(r.length),p.data&&(p.processData||"string"==typeof p.data)&&(r+=(Ee.test(r)?"&":"?")+p.data,delete p.data),!1===p.cache&&(r=r.replace(De,"$1"),f=(Ee.test(r)?"&":"?")+"_="+Ce+++f),p.url=r+f),p.ifModified&&(M.lastModified[r]&&A.setRequestHeader("If-Modified-Since",M.lastModified[r]),M.etag[r]&&A.setRequestHeader("If-None-Match",M.etag[r])),(p.data&&p.hasContent&&!1!==p.contentType||e.contentType)&&A.setRequestHeader("Content-Type",p.contentType),A.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Ue+"; q=0.01":""):p.accepts["*"]),p.headers)A.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(!1===p.beforeSend.call(m,A,p)||c))return A.abort();if(w="abort",y.add(p.complete),A.done(p.success),A.fail(p.error),i=qe(Be,p,e,A)){if(A.readyState=1,h&&g.trigger("ajaxSend",[A,p]),c)return A;p.async&&p.timeout>0&&(u=n.setTimeout(function(){A.abort("timeout")},p.timeout));try{c=!1,i.send(b,T)}catch(t){if(c)throw t;T(-1,t)}}else T(-1,"No Transport");function T(t,e,a,s){var l,d,f,b,_,w=e;c||(c=!0,u&&n.clearTimeout(u),i=void 0,o=s||"",A.readyState=t>0?4:0,l=t>=200&&t<300||304===t,a&&(b=function(t,e,n){for(var i,r,o,a,s=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in s)if(s[r]&&s[r].test(i)){u.unshift(r);break}if(u[0]in n)o=u[0];else{for(r in n){if(!u[0]||t.converters[r+" "+u[0]]){o=r;break}a||(a=r)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(p,A,a)),b=function(t,e,n,i){var r,o,a,s,u,l={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)l[a.toLowerCase()]=t.converters[a];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(r in l)if((s=r.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[r]:!0!==l[r]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(t){return{state:"parsererror",error:a?t:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}(p,b,A,l),l?(p.ifModified&&((_=A.getResponseHeader("Last-Modified"))&&(M.lastModified[r]=_),(_=A.getResponseHeader("etag"))&&(M.etag[r]=_)),204===t||"HEAD"===p.type?w="nocontent":304===t?w="notmodified":(w=b.state,d=b.data,l=!(f=b.error))):(f=w,!t&&w||(w="error",t<0&&(t=0))),A.status=t,A.statusText=(e||w)+"",l?v.resolveWith(m,[d,w,A]):v.rejectWith(m,[A,w,f]),A.statusCode(x),x=void 0,h&&g.trigger(l?"ajaxSuccess":"ajaxError",[A,p,l?d:f]),y.fireWith(m,[A,w]),h&&(g.trigger("ajaxComplete",[A,p]),--M.active||M.event.trigger("ajaxStop")))}return A},getJSON:function(t,e,n){return M.get(t,e,n,"json")},getScript:function(t,e){return M.get(t,void 0,e,"script")}}),M.each(["get","post"],function(t,e){M[e]=function(t,n,i,r){return y(n)&&(r=r||i,i=n,n=void 0),M.ajax(M.extend({url:t,type:e,dataType:r,data:n,success:i},M.isPlainObject(t)&&t))}}),M._evalUrl=function(t,e){return M.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){M.globalEval(t,e)}})},M.fn.extend({wrapAll:function(t){var e;return this[0]&&(y(t)&&(t=t.call(this[0])),e=M(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this},wrapInner:function(t){return y(t)?this.each(function(e){M(this).wrapInner(t.call(this,e))}):this.each(function(){var e=M(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=y(t);return this.each(function(n){M(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){M(this).replaceWith(this.childNodes)}),this}}),M.expr.pseudos.hidden=function(t){return!M.expr.pseudos.visible(t)},M.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},M.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var We={0:200,1223:204},Xe=M.ajaxSettings.xhr();v.cors=!!Xe&&"withCredentials"in Xe,v.ajax=Xe=!!Xe,M.ajaxTransport(function(t){var e,i;if(v.cors||Xe&&!t.crossDomain)return{send:function(r,o){var a,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(a in t.xhrFields)s[a]=t.xhrFields[a];for(a in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)s.setRequestHeader(a,r[a]);e=function(t){return function(){e&&(e=i=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?o(0,"error"):o(s.status,s.statusText):o(We[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=e(),i=s.onerror=s.ontimeout=e("error"),void 0!==s.onabort?s.onabort=i:s.onreadystatechange=function(){4===s.readyState&&n.setTimeout(function(){e&&i()})},e=e("abort");try{s.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}}),M.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)}),M.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return M.globalEval(t),t}}}),M.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),M.ajaxTransport("script",function(t){var e,n;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=M("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&r("error"===t.type?404:200,t.type)}),a.head.appendChild(e[0])},abort:function(){n&&n()}}});var Qe,Ke=[],Ze=/(=)\?(?=&|$)|\?\?/;M.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ke.pop()||M.expando+"_"+Ce++;return this[t]=!0,t}}),M.ajaxPrefilter("json jsonp",function(t,e,i){var r,o,a,s=!1!==t.jsonp&&(Ze.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ze.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=y(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Ze,"$1"+r):!1!==t.jsonp&&(t.url+=(Ee.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return a||M.error(r+" was not called"),a[0]},t.dataTypes[0]="json",o=n[r],n[r]=function(){a=arguments},i.always(function(){void 0===o?M(n).removeProp(r):n[r]=o,t[r]&&(t.jsonpCallback=e.jsonpCallback,Ke.push(r)),a&&y(o)&&o(a[0]),a=o=void 0}),"script"}),v.createHTMLDocument=((Qe=a.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Qe.childNodes.length),M.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(v.createHTMLDocument?((i=(e=a.implementation.createHTMLDocument("")).createElement("base")).href=a.location.href,e.head.appendChild(i)):e=a),r=k.exec(t),o=!n&&[],r?[e.createElement(r[1])]:(r=At([t],e,o),o&&o.length&&M(o).remove(),M.merge([],r.childNodes)));var i,r,o},M.fn.load=function(t,e,n){var i,r,o,a=this,s=t.indexOf(" ");return s>-1&&(i=xe(t.slice(s)),t=t.slice(0,s)),y(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&M.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done(function(t){o=arguments,a.html(i?M("<div>").append(M.parseHTML(t)).find(i):t)}).always(n&&function(t,e){a.each(function(){n.apply(this,o||[t.responseText,e,t])})}),this},M.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){M.fn[e]=function(t){return this.on(e,t)}}),M.expr.pseudos.animated=function(t){return M.grep(M.timers,function(e){return t===e.elem}).length},M.offset={setOffset:function(t,e,n){var i,r,o,a,s,u,l=M.css(t,"position"),c=M(t),h={};"static"===l&&(t.style.position="relative"),s=c.offset(),o=M.css(t,"top"),u=M.css(t,"left"),("absolute"===l||"fixed"===l)&&(o+u).indexOf("auto")>-1?(a=(i=c.position()).top,r=i.left):(a=parseFloat(o)||0,r=parseFloat(u)||0),y(e)&&(e=e.call(t,n,M.extend({},s))),null!=e.top&&(h.top=e.top-s.top+a),null!=e.left&&(h.left=e.left-s.left+r),"using"in e?e.using.call(t,h):c.css(h)}},M.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){M.offset.setOffset(this,t,e)});var e,n,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),n=i.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,i=this[0],r={top:0,left:0};if("fixed"===M.css(i,"position"))e=i.getBoundingClientRect();else{for(e=this.offset(),n=i.ownerDocument,t=i.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===M.css(t,"position");)t=t.parentNode;t&&t!==i&&1===t.nodeType&&((r=M(t).offset()).top+=M.css(t,"borderTopWidth",!0),r.left+=M.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-M.css(i,"marginTop",!0),left:e.left-r.left-M.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&"static"===M.css(t,"position");)t=t.offsetParent;return t||at})}}),M.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;M.fn[t]=function(i){return H(this,function(t,i,r){var o;if(x(t)?o=t:9===t.nodeType&&(o=t.defaultView),void 0===r)return o?o[e]:t[i];o?o.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r},t,i,arguments.length)}}),M.each(["top","left"],function(t,e){M.cssHooks[e]=Xt(v.pixelPosition,function(t,n){if(n)return n=Wt(t,e),Vt.test(n)?M(t).position()[e]+"px":n})}),M.each({Height:"height",Width:"width"},function(t,e){M.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){M.fn[i]=function(r,o){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===o?"margin":"border");return H(this,function(e,n,r){var o;return x(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===r?M.css(e,n,s):M.style(e,n,r,s)},e,a?r:void 0,a)}})}),M.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){M.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),M.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),M.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}}),M.proxy=function(t,e){var n,i,r;if("string"==typeof e&&(n=t[e],e=t,t=n),y(t))return i=u.call(arguments,2),(r=function(){return t.apply(e||this,i.concat(u.call(arguments)))}).guid=t.guid=t.guid||M.guid++,r},M.holdReady=function(t){t?M.readyWait++:M.ready(!0)},M.isArray=Array.isArray,M.parseJSON=JSON.parse,M.nodeName=P,M.isFunction=y,M.isWindow=x,M.camelCase=K,M.type=w,M.now=Date.now,M.isNumeric=function(t){var e=M.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},void 0===(i=function(){return M}.apply(e,[]))||(t.exports=i);var Ye=n.jQuery,$e=n.$;return M.noConflict=function(t){return n.$===M&&(n.$=$e),t&&n.jQuery===M&&(n.jQuery=Ye),M},r||(n.jQuery=n.$=M),M})},function(t,e,n){"use strict";n.d(e,"e",function(){return i}),n.d(e,"f",function(){return r}),n.d(e,"h",function(){return o}),n.d(e,"g",function(){return a}),n.d(e,"l",function(){return s}),n.d(e,"d",function(){return u}),n.d(e,"m",function(){return l}),n.d(e,"j",function(){return c}),n.d(e,"k",function(){return h}),n.d(e,"b",function(){return d}),n.d(e,"a",function(){return f}),n.d(e,"i",function(){return p}),n.d(e,"c",function(){return m}),n.d(e,"o",function(){return g}),n.d(e,"n",function(){return v});var i=1,r=2,o=4,a=5,s=484813681109536e-20,u=Math.PI/2,l=.16666666666666666,c=.04722222222222222,h=.022156084656084655,d=1e-10,f=.017453292519943295,p=57.29577951308232,m=Math.PI/4,g=2*Math.PI,v=3.14159265359},function(t,e,n){"use strict";t.exports=Object.assign(n(111),n(229),n(231),n(232),{DistanceGrid:n(115),ClusterGroup:n(116)})},function(t,e,n){"use strict";var i=n(3),r=n(21);e.a=function(t){return Math.abs(t)<=i.n?t:t-Object(r.a)(t)*i.o}},function(t,e,n){"use strict";var i={layerAdd:"geo_layerAdd",layerRemove:"geo_layerRemove",zoom:"geo_zoom",rotate:"geo_rotate",pan:"geo_pan",resize:"geo_resize",draw:"geo_draw",drawEnd:"geo_drawEnd",mousemove:"geo_mousemove",mouseclick:"geo_mouseclick",brush:"geo_brush",brushend:"geo_brushend",brushstart:"geo_brushstart",select:"geo_select",zoomselect:"geo_zoomselect",unzoomselect:"geo_unzoomselect",actiondown:"geo_actiondown",actionmove:"geo_actionmove",actionup:"geo_actionup",actionselection:"geo_actionselection",actionwheel:"geo_actionwheel",keyaction:"geo_keyaction",transitionstart:"geo_transitionstart",transitionend:"geo_transitionend",transitioncancel:"geo_transitioncancel",parallelprojection:"geo_parallelprojection",feature:{mousemove:"geo_feature_mousemove",mouseover:"geo_feature_mouseover",mouseover_order:"geo_feature_mouseover_order",mouseout:"geo_feature_mouseout",mouseon:"geo_feature_mouseon",mouseoff:"geo_feature_mouseoff",mouseclick:"geo_feature_mouseclick",mouseclick_order:"geo_feature_mouseclick_order",brushend:"geo_feature_brushend",brush:"geo_feature_brush"},pixelmap:{prepared:"geo_pixelmap_prepared"},screenshot:{ready:"geo_screenshot_ready"},camera:{}};i.camera.view="geo_camera_view",i.camera.projection="geo_camera_projection",i.camera.viewport="geo_camera_viewport",i.annotation={},i.annotation.add="geo_annotation_add",i.annotation.add_before="geo_annotation_add_before",i.annotation.update="geo_annotation_update",i.annotation.coordinates="geo_annotation_coordinates",i.annotation.select_edit_handle="geo_annotation_select_edit_handle",i.annotation.edit_action="geo_annotation_edit_action",i.annotation.remove="geo_annotation_remove",i.annotation.state="geo_annotation_state",i.annotation.mode="geo_annotation_mode",t.exports=i},function(t,e,n){"use strict";var i=n(59),r=n(36),o=n(23),a=n(4);i=i.__esModule?i.default:i;var s=n(258);s.keys().forEach(function(t){i.Proj.projections.add(s(t))});var u={},l=new RegExp("^(.* |)\\+axis=e(n|s)u(| .*)$"),c=function t(e){if(!(this instanceof t))return(e=e||{}).source in u||(Object.size(u)>=10&&(u={}),u[e.source]={}),e.target in u[e.source]||(Object.size(u[e.source])>=10&&(u[e.source]={}),u[e.source][e.target]=new t(e)),u[e.source][e.target];var n,s,l,c,h,d,f,p=this,m={s11:0,s12:4,s13:8,xoff:12,s21:1,s22:5,s23:9,yoff:13,s31:2,s32:6,s33:10,zoff:14};function g(t){if(!/(^|\s)\+(s[1-3][1-3]|[xyz]off)=\S/.exec(t))return{proj:t};var e,n,i=a.mat4AsArray(),r=[];return t.split(/(\s+)/).forEach(function(t){var e=/^\+(s[1-3][1-3]|[xyz]off)=(.*)$/.exec(t);e?i[m[e[1]]]=parseFloat(e[2]):r.push(t)}),n={proj:r.join(" "),orig:t},(e=o.invert(a.mat4AsArray(),i))?(n.matrix=i,n.inverse=e):console.warn("Affine transform is not invertable and will not be used: "+t),n}function v(){var t=g(p.source()),e=g(p.target()),r=t.proj,o=e.proj;c=t.matrix,h=t.inverse,d=e.matrix,f=e.inverse,n=new i(r,o)}this.source=function(t){return void 0===t?s||"EPSG:4326":(s=t,v(),p)},this.target=function(t){return void 0===t?l||"EPSG:3857":(l=t,v(),p)},this._forward=function(t){if(c){var e=r.transformMat4(a.vec3AsArray(),[t.x,t.y,t.z||0],h);t={x:e[0],y:e[1],z:e[2]}}var i=n.forward(t);if(i.z=t.z||0,d){var o=r.transformMat4(a.vec3AsArray(),[i.x,i.y,i.z],d);i={x:o[0],y:o[1],z:o[2]}}return i},this._inverse=function(t){if(d){var e=r.transformMat4(a.vec3AsArray(),[t.x,t.y,t.z||0],f);t={x:e[0],y:e[1],z:e[2]}}var i=n.inverse(t);if(i.z=t.z||0,c){var o=r.transformMat4(a.vec3AsArray(),[i.x,i.y,i.z],c);i={x:o[0],y:o[1],z:o[2]}}return i},this.forward=function(t){return Array.isArray(t)?t.map(p._forward):p._forward(t)},this.inverse=function(t){return Array.isArray(t)?t.map(p._inverse):p._inverse(t)},e=e||{};try{this.source(e.source)}catch(t){console.error("Can't use transform source: "+e.source),this.source("EPSG:4326")}try{this.target(e.target)}catch(t){console.error("Can't use transform target: "+e.target),this.target("EPSG:3857")}return this};c.defs=i.defs,c.lookup=function(t){var e,r,o=n(2),a=o.Deferred();return i.defs.hasOwnProperty(t)?a.resolve(i.defs[t]):2!==(r=t.split(":")).length||"EPSG"!==r[0].toUpperCase()?a.reject("Invalid projection code").promise():(e=r[1],o.ajax({url:"https://epsg.io/?q="+e+"&format=json"}).done(function(e){var n=(e.results||[])[0];return n&&n.proj4?(i.defs(t,n.proj4),o.when(i.defs[t])):a.reject(e).promise()}))},c.transformCoordinates=function(t,e,n,i){if(t===e)return n;if(Array.isArray(n)&&n.length>=3&&3===i&&!a.isObject(n[0]))return c.transformCoordinatesFlatArray3(t,e,n);var r,o=c({source:t,target:e});return a.isObject(n)&&"x"in n&&"y"in n?(r=o.forward({x:+n.x,y:+n.y,z:+n.z||0}),"z"in n?r:{x:r.x,y:r.y}):Array.isArray(n)&&1===n.length&&a.isObject(n[0])&&"x"in n[0]&&"y"in n[0]?(r=o.forward({x:+n[0].x,y:+n[0].y,z:+n[0].z||0}),"z"in n[0]?[r]:[{x:r.x,y:r.y}]):c.transformCoordinatesArray(o,n,i)},c.transformCoordinatesArray=function(t,e,n){var i,r,o,s,u,l,c,h,d,f={};function p(){if(Array.isArray(e[0]))if(2===e[0].length)s=function(t){return+e[t][0]},u=function(t){return+e[t][1]},c=function(t,e,n){h[t]=[e,n]};else{if(3!==e[0].length)throw new Error("Invalid coordinates. Requires two or three components per array");s=function(t){return+e[t][0]},u=function(t){return+e[t][1]},l=function(t){return+e[t][2]},c=function(t,e,n,i){h[t]=[e,n,i]}}else if(2===e.length)o=2,s=function(t){return+e[t*o]},u=function(t){return+e[t*o+1]},c=function(t,e,n){h[t]=e,h[t+1]=n};else if(3===e.length)o=3,s=function(t){return+e[t*o]},u=function(t){return+e[t*o+1]},l=function(t){return+e[t*o+2]},c=function(t,e,n,i){h[t]=e,h[t+1]=n,h[t+2]=i};else{if(!n)throw new Error("Invalid coordinates");if(2!==n&&3!==n)throw new Error("Number of components should be two or three");o=n,s=function(t){return+e[t]},u=function(t){return+e[t+1]},2===n?c=function(t,e,n){h[t]=e,h[t+1]=n}:(l=function(t){return+e[t+2]},c=function(t,e,n,i){h[t]=e,h[t+1]=n,h[t+2]=i})}}if(l=function(){return 0},!Array.isArray(e))throw new Error("Coordinates are not valid");if((h=[]).length=e.length,r=e.length,!e.length)return h;for(Array.isArray(e[0])||a.isObject(e[0])?(o=1,Array.isArray(e[0])?p():a.isObject(e[0])&&function(){if(!(e[0]&&"x"in e[0]&&"y"in e[0]))throw new Error("Invalid coordinates");s=function(t){return+e[t].x},u=function(t){return+e[t].y},"z"in e[0]?(l=function(t){return+e[t].z},c=function(t,e,n,r){h[i]={x:e,y:n,z:r}}):c=function(t,e,n){h[t]={x:e,y:n}}}()):p(),i=0;i<r;i+=o)f.x=s(i),f.y=u(i),f.z=l(i),d=t.forward(f),c(i,d.x,d.y,d.z);return h},c.transformCoordinatesFlatArray3=function(t,e,n){var r,o=t.match(l),a=e.match(l);if(o&&a&&o[1]===a[1]&&o[3]===a[3]){for(r=n.length-3+1;r>=0;r-=3)n[r]*=-1;return n}var s,u=i.Proj(t),c=i.Proj(e),h={};for(r=n.length-3;r>=0;r-=3)h.x=+n[r],h.y=+n[r+1],h.z=+(n[r+2]||0),s=i.transform(u,c,h),n[r]=s.x,n[r+1]=s.y,n[r+2]=void 0===s.z?h.z:s.z;return n},c.affineForward=function(t,e){var n,i=t.origin,r=t.scale||{x:1,y:1,z:1};for(n=0;n<e.length;n+=1)e[n].x=(e[n].x-i.x)*r.x,e[n].y=(e[n].y-i.y)*r.y,e[n].z=((e[n].z||0)-(i.z||0))*r.z;return e},c.affineInverse=function(t,e){var n,i=t.origin,r=t.scale||{x:1,y:1,z:1};for(n=0;n<e.length;n+=1)e[n].x=e[n].x/r.x+i.x,e[n].y=e[n].y/r.y+i.y,e[n].z=(e[n].z||0)/r.z+(i.z||0);return e},c.sphericalDistance=function(t,e,n,r,o){if(r=r||"EPSG:4326",o=o||i.WGS84,(n=n||r)!==r){var a=c.transformCoordinates(n,r,[t,e]);t=a[0],e=a[1]}var s=t.y*Math.PI/180,u=e.y*Math.PI/180,l=(e.x-t.x)*Math.PI/180,h=Math.sin(s),d=Math.cos(s),f=Math.sin(u),p=Math.cos(u),m=Math.atan2(Math.pow(Math.pow(p*Math.sin(l),2)+Math.pow(d*f-h*p*Math.cos(l),2),.5),h*f+d*p*Math.cos(l));return o.a*m},c.vincentyDistance=function(t,e,n,r,o,a){if(r=r||"EPSG:4326",o=o||i.WGS84,a=a||100,(n=n||r)!==r){var s=c.transformCoordinates(n,r,[t,e]);t=s[0],e=s[1]}var u,l,h,d,f,p,m,g,v,y,x=o.a,b=o.b||o.a*(1-(o.f||1/o.rf)),_=o.f||(o.rf?1/o.rf:1-b/x),w=t.y*Math.PI/180,M=e.y*Math.PI/180,A=((e.x-t.x)%360+360)%360*Math.PI/180,T=Math.atan((1-_)*Math.tan(w)),C=Math.atan((1-_)*Math.tan(M)),E=Math.sin(T),O=Math.cos(T),S=Math.sin(C),P=Math.cos(C),k=A,R=A+2*Math.PI;if(w===M&&!A)return{distance:0,alpha1:0,alpha2:0};for(y=a;y>0&&Math.abs(k-R)>1e-12;y-=1)u=Math.pow(Math.pow(P*Math.sin(k),2)+Math.pow(O*S-E*P*Math.cos(k),2),.5),l=E*S+O*P*Math.cos(k),h=Math.atan2(u,l),d=O*P*Math.sin(k)/u,R=k,k=A+(1-(m=_/16*(f=1-Math.pow(d,2))*(4+_*(4-3*f))))*_*d*(h+m*u*((p=l-(f?2*E*S/f:0))+m*l*(2*Math.pow(p,2)-1)));return y?{distance:b*(1+(g=f*(x*x-b*b)/(b*b))/16384*(4096+g*(g*(320-175*g)-768)))*(h-(v=g/1024*(256+g*(g*(74-47*g)-128)))*u*(p+v/4*(l*(2*Math.pow(p,2)-1)-v/6*p*(4*u*u-3)*(4*Math.pow(p,2)-3)))),alpha1:Math.atan2(P*Math.sin(k),O*S-E*P*Math.cos(k)),alpha2:Math.atan2(O*Math.sin(k),-E*P+O*S*Math.cos(k))}:void 0},c.proj4=i,t.exports=c},function(t,e,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=n(2),o=n(0),a=n(14),s=n(9),u=n(6),l=function t(e){if(!(this instanceof t))return new t(e);a.call(this);var i=n(4);e=e||{};var o,l=this,c=this._exit,h=this.geoOn,d=this.geoOff,f=void 0===e.selectionAPI?"auto":e.selectionAPI,p={},m=void 0===e.layer?null:e.layer,g=e.gcs,v=void 0===e.visible||e.visible,y=void 0===e.bin?null:e.bin,x=void 0===e.renderer||m&&e.renderer===m.renderer()?null:e.renderer,b=s(),_=s(),w=s(),M=[],A=[];return this._subfeatureStyles={},Object.defineProperty(this,"ready",{get:function(){return o}}),this._bindMouseHandlers=function(){l.selectionAPI()&&(l._unbindMouseHandlers(),l.geoOn(u.mousemove,l._handleMousemove),l.geoOn(u.mouseclick,l._handleMouseclick),l.geoOn(u.brushend,l._handleBrushend),l.geoOn(u.brush,l._handleBrush))},this._unbindMouseHandlers=function(){l.geoOff(u.mousemove,l._handleMousemove),l.geoOff(u.mouseclick,l._handleMouseclick),l.geoOff(u.brushend,l._handleBrushend),l.geoOff(u.brush,l._handleBrush)},this.pointSearch=function(t){return{index:[],found:[]}},this.boxSearch=function(t,e,n){return[]},this._handleMousemove=function(){var e,n=l.layer().map().interactor().mouse(),i=l.data(),r=l.pointSearch(n.geo),o=[],a=[],s=-1,c=-1;(A.length||r.index.length)&&(e=r.extra||{},r.index.length>1&&l.geoTrigger(u.feature.mouseover_order,{feature:l,mouse:n,previous:A,over:r}),A.length&&(s=A[A.length-1]),o=r.index.filter(function(t){return A.indexOf(t)<0}),a=A.filter(function(t){return r.index.indexOf(t)<0}),t.eventID+=1,o.forEach(function(r,a){l.geoTrigger(u.feature.mouseover,{data:i[r],index:r,extra:e[r],mouse:n,eventID:t.eventID,top:a===o.length-1},!0)}),t.eventID+=1,a.forEach(function(e,r){l.geoTrigger(u.feature.mouseout,{data:i[e],index:e,mouse:n,eventID:t.eventID,top:r===a.length-1},!0)}),t.eventID+=1,r.index.forEach(function(o,a){l.geoTrigger(u.feature.mousemove,{data:i[o],index:o,extra:e[o],mouse:n,eventID:t.eventID,top:a===r.index.length-1},!0)}),(A=r.index).length&&(c=A[A.length-1]),s!==c&&(-1!==s&&l.geoTrigger(u.feature.mouseoff,{data:i[s],index:s,mouse:n},!0),-1!==c&&l.geoTrigger(u.feature.mouseon,{data:i[c],index:c,extra:e[c],mouse:n},!0)))},this._clearSelectedFeatures=function(){return A=[],l},this._handleMouseclick=function(e){var n=l.layer().map().interactor().mouse(),i=l.data(),r=l.pointSearch(n.geo),o=r.extra||{};r.index.length>1&&l.geoTrigger(u.feature.mouseclick_order,{feature:l,mouse:n,over:r}),n.buttonsDown=e.buttonsDown,t.eventID+=1,r.index.forEach(function(e,a){l.geoTrigger(u.feature.mouseclick,{data:i[e],index:e,extra:o[e],mouse:n,eventID:t.eventID,top:a===r.index.length-1},!0)})},this._handleBrush=function(e){var n=l.boxSearch(e.gcs.lowerLeft,e.gcs.upperRight),i=l.data();t.eventID+=1,n.forEach(function(n,r){l.geoTrigger(u.feature.brush,{data:i[n],index:n,mouse:e.mouse,brush:e,eventID:t.eventID,top:r===r.length-1},!0)})},this._handleBrushend=function(e){var n=l.boxSearch(e.gcs.lowerLeft,e.gcs.upperRight),i=l.data();t.eventID+=1,n.forEach(function(n,r){l.geoTrigger(u.feature.brushend,{data:i[n],index:n,mouse:e.mouse,brush:e,eventID:t.eventID,top:r===r.length-1},!0)})},this.style=function(t,e){return void 0===t?p:"string"==typeof t&&void 0===e?p[t]:void 0===e?(p=r.extend({},p,t),l.modified(),l):(p[t]=e,l.modified(),l)},this.style.get=function(t){if(void 0===t){var e,n={};for(e in p)p.hasOwnProperty(e)&&(n[e]=l.style.get(e));return n}return t.toLowerCase().match(/color$/)?i.isFunction(p[t])?function(){return i.convertColor(p[t].apply(l,arguments))}:i.ensureFunction(i.convertColor(p[t])):i.ensureFunction(p[t])},this.updateStyleFromArray=function(t,e,n){if("string"!=typeof t)r.each(t,function(t,e){l.updateStyleFromArray(t,e)});else{var i;if(t.toLowerCase().match(/color$/)&&(i={r:0,g:0,b:0}),!Array.isArray(e))return l;l._subfeatureStyles[t]?e.length&&Array.isArray(e[0])?l.style(t,function(t,n,r,o){var a=(e[o]||[])[n];return void 0!==a?a:i}):l.style(t,function(t,n,r,o){var a=e[o];return void 0!==a?a:i}):l.style(t,function(t,n){var r=e[n];return void 0!==r?r:i})}return n&&l.visible()&&l.draw(),l},this.layer=function(){return m},this.renderer=function(){return x||m&&m.renderer()},this.gcs=function(t){return void 0===t?void 0!==g&&null!==g||!m?g:m.map().ingcs():(g=t,l.modified(),l)},this.featureGcsToDisplay=function(t){var e=m.map();return t=e.gcsToWorld(t,l.gcs()),t=e.worldToDisplay(t),l.renderer().baseToLocal&&(t=l.renderer().baseToLocal(t)),t},this.visible=function(t,e){if(void 0===t)return!(!e&&m&&m.visible&&!m.visible())&&v;if(v!==t||e){v=t,l.modified(),m&&m.visible&&!m.visible()&&(t=!1),t?l._bindMouseHandlers():l._unbindMouseHandlers();for(var n=0;n<M.length;n+=1)M[n].visible(v,e)}return l},this.dependentFeatures=function(t){return void 0===t?M.slice():(M=t.slice(),l)},this.bin=function(t,e){if(void 0===t){if(null===y&&!e){var n=l.parent(),r=n?n.children().indexOf(l):-1;return r>=0?r:0}return y}return y=i.isNonNullFinite(t)?parseInt(t,10):null,l.modified(),l},this.dataTime=function(t){return void 0===t?b:(b=t,l.modified(),l)},this.buildTime=function(t){return void 0===t?_:(_=t,l.modified(),l)},this.updateTime=function(t){return void 0===t?w:(w=t,l.modified(),l)},this.data=function(t){return void 0===t?l.style("data")||[]:(l.style("data",t),l.dataTime().modified(),l.modified(),l)},this.selectionAPI=function(t,e){return void 0===t?!(!e&&m&&m.selectionAPI&&!m.selectionAPI())&&(e||"auto"!==f?f:!!l.geoIsOn(Object.values(u.feature))):("auto"!==t&&(t=!!t),(t!==f||e)&&(f=t,l._unbindMouseHandlers(),l._bindMouseHandlers()),l)},this.mouseOverOrderHighestIndex=function(t){t.over.index.sort();var e=t.feature.data();t.over.index.forEach(function(n,i){t.over.found[i]=e[n]})},this._init=function(t){if(!m)throw new Error("Feature requires a valid layer");p=r.extend({},{opacity:1},void 0===t.style?{}:t.style),l._bindMouseHandlers(),o=!0},this._build=function(){},this._update=function(){},this.geoOn=function(t,e){var n="auto"===l.selectionAPI(void 0,!0),i=n&&l.selectionAPI(),r=h.apply(l,arguments);return n&&!i&&l.selectionAPI()&&l._bindMouseHandlers(),r},this.geoOff=function(t,e){var n="auto"===l.selectionAPI(void 0,!0),i=n&&l.selectionAPI(),r=d.apply(l,arguments);return n&&i&&!l.selectionAPI()&&l._unbindMouseHandlers(),r},this._exit=function(){l._unbindMouseHandlers(),A=[],p={},c(),o=!1},this._init(e),this};l.eventID=0,l.create=function(t,e){if(!(t instanceof n(25)))return console.warn("Invalid layer"),null;if("object"!==(void 0===e?"undefined":i(e)))return console.warn("Invalid spec"),null;var r=e.type,o=t.createFeature(r,e);return o?(e.data=e.data||[],o.style(e)):(console.warn('Could not create feature type "'+r+'"'),null)},o(l,a),t.exports=l},function(t,e,n){"use strict";var i=0;t.exports=function t(){if(!(this instanceof t))return new t;var e=this,n=0;return this.modified=function(){return n=i+=1,e},this.timestamp=function(){return n},this.getMTime=this.timestamp,this}},function(t,e,n){"use strict";var i=n(0),r=n(1).registerRenderer,o=n(13),a=function t(e){var i=t.d3,r=n(15),a=n(4),s=n(6),u=n(121);if(!(this instanceof t))return new t(e);o.call(this,e);var l=this._exit;r.call(this,e),e=e||{};var c=this,h=null,d={},f=null,p=null,m=1,g={dx:0,dy:0,rx:0,ry:0,rotation:0},v={},y={},x=null,b=null;function _(t){return t?x.select(".group-"+t):x.select(".group-"+c._svgid())}function w(){var t=c.layer().map(),e=t.size().width,n=t.size().height;if(!e||!n)throw new Error("Map layer has size 0");c._setWidthHeight(e,n),p=Math.pow(e*e+n*n,.5),f={upperLeft:t.displayToGcs({x:0,y:0},null),lowerRight:t.displayToGcs({x:e,y:n},null),center:t.displayToGcs({x:e/2,y:n/2},null)}}return this._convertColor=function(t,e){return t=a.ensureFunction(t),e=e||function(){return!0},function(){var n="none";return e.apply(c,arguments)&&(n=t.apply(c,arguments)).hasOwnProperty("r")&&n.hasOwnProperty("g")&&n.hasOwnProperty("b")&&(n=i.rgb(255*n.r,255*n.g,255*n.b)),n}},this._convertScale=function(t){return t=a.ensureFunction(t),function(){return t.apply(c,arguments)/m}},this._setTransform=function(){if(f||w(),h){var t,e,n,i,r,o,a=c.layer().map(),s=a.gcsToDisplay(f.upperLeft,null),u=a.gcsToDisplay(f.lowerRight,null),l=a.gcsToDisplay(f.center,null),d=_();n=Math.sqrt(Math.pow(u.y-s.y,2)+Math.pow(u.x-s.x,2))/p,i=a.rotation(),r=-c.width()/2,o=-c.height()/2,t=n*r+l.x,e=n*o+l.y,i||(t=Math.round(t),e=Math.round(e));var v="matrix("+[n,0,0,n,t,e].join()+")";i&&(v+=" rotate("+[180*i/Math.PI,-r,-o].join()+")"),d.attr("transform",v),m=n,g.dx=t,g.dy=e,g.rx=r,g.ry=o,g.rotation=i}},this.baseToLocal=function(t){if(t={x:(t.x-g.dx)/m,y:(t.y-g.dy)/m},g.rotation){var e=Math.sin(-g.rotation),n=Math.cos(-g.rotation),i=t.x+g.rx,r=t.y+g.ry;t={x:i*n-r*e-g.rx,y:i*e+r*n-g.ry}}return t},this.localToBase=function(t){if(g.rotation){var e=Math.sin(g.rotation),n=Math.cos(g.rotation),i=t.x+g.rx,r=t.y+g.ry;t={x:i*n-r*e-g.rx,y:i*e+r*n-g.ry}}return t={x:t.x*m+g.dx,y:t.y*m+g.dy}},this._init=function(t){if(!c.canvas()){var e;t.widget=t.widget||!1,(x="d3Parent"in t?i.select(t.d3Parent).append("svg"):i.select(c.layer().node().get(0)).append("svg")).attr("display","block");var n=(b=x.append("defs")).append("filter").attr("id","geo-highlight").attr("x","-100%").attr("y","-100%").attr("width","300%").attr("height","300%");n.append("feMorphology").attr("operator","dilate").attr("radius",2).attr("in","SourceAlpha").attr("result","dilateOut"),n.append("feGaussianBlur").attr("stdDeviation",5).attr("in","dilateOut").attr("result","blurOut"),n.append("feColorMatrix").attr("type","matrix").attr("values","-1 0 0 0 1  0 -1 0 0 1  0 0 -1 0 1  0 0 0 1 0").attr("in","blurOut").attr("result","invertOut"),n.append("feBlend").attr("in","SourceGraphic").attr("in2","invertOut").attr("mode","normal"),t.widget||(e=t.canvas||x.append("g")),(n=b.append("filter").attr("id","geo-blur").attr("x","-100%").attr("y","-100%").attr("width","300%").attr("height","300%")).append("feGaussianBlur").attr("stdDeviation",20).attr("in","SourceGraphic"),h=c.layer().sticky(),x.attr("class",c._svgid()),x.attr("width",c.layer().node().width()),x.attr("height",c.layer().node().height()),t.widget?c.canvas(x):(e.attr("class","group-"+c._svgid()),c.canvas(e))}return c._setTransform(),c},this.api=function(){return t.apiname},this.scaleFactor=function(){return m},this._resize=function(t,e,n,i){return f||w(),x.attr("width",n),x.attr("height",i),c._setTransform(),c._setWidthHeight(n,i),c.layer().geoTrigger(u,{scale:m},!0),c},this._exit=function(){d={},c.canvas().remove(),x.remove(),x=void 0,b.remove(),b=void 0,v={},y={},l()},this._definitions=function(){return b},this._drawFeatures=function(t){return d[t.id]={data:t.data,index:t.dataIndex,style:t.style,visible:t.visible,attributes:t.attributes,classes:t.classes,append:t.append,onlyRenderNew:t.onlyRenderNew,sortByZ:t.sortByZ,parentId:t.parentId},c.__render(t.id,t.parentId)},this.__render=function(t,e){var n;if(void 0===t){for(n in d)d.hasOwnProperty(n)&&c.__render(n);return c}return e?c._renderFeature(t,e):(v[t]=!0,c.layer().map().scheduleAnimationFrame(c._renderFrame)),c},this._renderFrame=function(){var t;for(t in y)c.select(t).remove(),b.selectAll("."+t).remove();y={};var e=v;for(t in v={},e)e.hasOwnProperty(t)&&c._renderFeature(t)},this._renderFeature=function(t,e){if(!d[t])return c;var n,i,r=d[t].data,o=d[t].index,a=d[t].style,s=d[t].visible,u=d[t].attributes,l=d[t].classes,h=d[t].append,f=c.select(t,e).data(r,o);return n=f.enter().append(h),f.exit().remove(),function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&t.attr(n,e[n])}(i=d[t].onlyRenderNew?n:f,u),i.attr("class",l.concat([t]).join(" ")),function(t,e){var n,i,r;function o(){return e.fill.apply(c,arguments)?null:"none"}function a(){return e.stroke.apply(c,arguments)?null:"none"}for(n in e)e.hasOwnProperty(n)&&(r=null,i=null,"strokeColor"===n?(i="stroke",r=c._convertColor(e[n],e.stroke)):"stroke"===n&&e[n]&&!e.hasOwnProperty("strokeColor")?(i="stroke",r=a):"strokeWidth"===n?(i="stroke-width",r=c._convertScale(e[n])):"strokeOpacity"===n?(i="stroke-opacity",r=e[n]):"fillColor"===n?(i="fill",r=c._convertColor(e[n],e.fill)):"fill"!==n||e.hasOwnProperty("fillColor")?"fillOpacity"===n?(i="fill-opacity",r=e[n]):"lineCap"===n?(i="stroke-linecap",r=e[n]):"lineJoin"===n?(i="stroke-linejoin",r=e[n]):"miterLimit"===n&&(i="stroke-miterlimit",r=e[n]):(i="fill",r=o),i&&t.style(i,r))}(i,a),s&&i.style("visibility",s()?"visible":"hidden"),n.size()&&d[t].sortByZ&&f.sort(function(t,e){return(t.zIndex||0)-(e.zIndex||0)}),c},this.select=function(t,e){return _(e).selectAll("."+t)},this._removeFeature=function(t){return y[t]=!0,c.layer().map().scheduleAnimationFrame(c._renderFrame),delete d[t],v[t]&&delete v[t],c},this.draw=function(){},this.layer().geoOn(s.pan,c._setTransform),this.layer().geoOn(s.rotate,c._setTransform),this.layer().geoOn(s.zoom,function(){c._setTransform(),c.__render(),c.layer().geoTrigger(u,{scale:m},!0)}),this.layer().geoOn(s.resize,function(t){c._resize(t.x,t.y,t.width,t.height)}),this._init(e),this};a.apiname="svg",i(a,o),r("svg",a),r("d3",a),a.supported=function(){delete a.d3;try{a.d3=n(285)}catch(t){}return void 0!==a.d3},a.fallback=function(){return null},a.supported(),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(9),o=function t(){if(!(this instanceof t))return new t;var e=n(4),i=this,o={},a=[],s=0;return this.onIdle=function(t){return s?a.push(t):t(),i},Object.defineProperty(this,"idle",{get:function(){return!s},configurable:!0}),this.addPromise=function(t){function e(){(s-=1)||a.splice(0,a.length).forEach(function(t){t()})}return s+=1,t.always?t.always(e):t.then(e,e),i},this.geoOn=function(t,n){return Array.isArray(t)?(t.forEach(function(t){i.geoOn(t,n)}),i):e.isFunction(n)?(o.hasOwnProperty(t)||(o[t]=[]),o[t].push(n),i):(console.warn("Handler for "+t+" is not a function",n,i),i)},this.geoIsOn=function(t,e){return Array.isArray(t)?t.some(function(t){return i.geoIsOn(t,e)}):(o[t]||[]).some(function(t){return t===e||void 0===e})},this.geoTrigger=function(t,e){return Array.isArray(t)?(t.forEach(function(t){i.geoTrigger(t,e)}),i):((e=e||{}).event=t,o.hasOwnProperty(t)&&o[t].forEach(function(n){try{n.call(i,e)}catch(e){console.warn("Event handler for "+t+" threw an error",e)}}),i)},this.geoOff=function(t,e){if(void 0===t&&(o={},a=[],s=0),Array.isArray(t))return t.forEach(function(t){i.geoOff(t,e)}),i;if(e){if(Array.isArray(e))return e.forEach(function(e){i.geoOff(t,e)}),i}else o[t]=[];return o.hasOwnProperty(t)&&(o[t]=o[t].filter(function(t){return t!==e})),i},this._exit=function(){i.geoOff()},r.call(this),this.modified(),this};i(o,r),t.exports=o},function(t,e,n){(function(e){t.exports=e.vgl=n(234)}).call(e,n(233))},function(t,e,n){"use strict";var i=n(0),r=n(11),o=function t(e){if(!(this instanceof t))return new t(e);r.call(this);var n=this,i=0,o=0,a=void 0===(e=e||{}).layer?null:e.layer,s=void 0===e.canvas?null:e.canvas,u=!1;return this.layer=function(){return a},this.canvas=function(t){return void 0===t?s:(s=t,n.modified(),n)},this.map=function(){return a?a.map():null},this.initialized=function(t){return void 0===t?u:(u=t,n)},this.api=function(){throw new Error("Should be implemented by derived classes")},this.width=function(){return i},this.height=function(){return o},this._setWidthHeight=function(t,e){return i=t,o=e,n},this._init=function(){return n},this._resize=function(t,e,i,r){return n._setWidthHeight(i,r),n},this._render=function(){return n},this};i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(0),r=n(11),o=function t(e){if(!(this instanceof t))return new t;r.call(this,e);var n=this,i=null,o=[],a=this._exit,s=this.geoTrigger,u=this.addPromise,l=this.onIdle;return this.addPromise=function(t){return i?i.addPromise(t):u(t),n},this.onIdle=function(t){return i?i.onIdle(t):l(t),n},this.parent=function(t){return void 0===t?i:(i=t,n)},this.addChild=function(t){return Array.isArray(t)?(t.forEach(n.addChild),n):(t.parent(n),o.push(t),n)},this.removeChild=function(t){return Array.isArray(t)?(t.forEach(n.removeChild),n):(o=o.filter(function(e){return e!==t}),n)},this.children=function(){return o.slice()},this.draw=function(t){return n.children().forEach(function(e){e.draw(t)}),n},this.geoTrigger=function(t,e,r){var a;return a=(e=e||{}).geo||{},e.geo=a,a.stopPropagation?n:!r&&i&&a._triggeredBy!==i?(a._triggeredBy=n,i.geoTrigger(t,e),n):(s.call(n,t,e),a.stopPropagation?n:(o.forEach(function(i){i.geoTrigger&&(a._triggeredBy=n,i.geoTrigger(t,e))}),n))},this._exit=function(){o=[],i=null,a()},this};i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(0),r=n(14),o=function t(e){var i=n(11),o=n(52);if(!(this instanceof i))return new t(e);r.call(this);var a="svg-"+o(),s=this._exit,u=this,l=this.draw;return this._svgid=function(){return a},this.select=function(){return u.renderer().select(u._svgid())},this.draw=function(){return u.ready&&(u._update(),l()),u},this._exit=function(){u.renderer()._removeFeature(u._svgid()),s()},this};i(o,r),t.exports=o},function(t,e,n){"use strict";e.a=function(t,e,n){var i=t*e;return n/Math.sqrt(1-i*i)}},function(t,e,n){"use strict";e.a=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(8),a=function t(e){var r=n(7),a=n(4);if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var s,u,l=this,c=this._init,h=0,d=[],f=[];return this.featureType="quad",this._objectListStart=function(t){i.each(t,function(t,e){e.used=!1})},this._objectListGet=function(t,e){for(var n=0;n<t.length;n+=1)if(t[n].entry===e)return t[n].used=!0,t[n].value},this._objectListAdd=function(t,e,n){t.push({entry:e,value:n,used:!0})},this._objectListEnd=function(t){for(var e=t.length-1;e>=0;e-=1)t[e].used||t.splice(e,1)},this.pointSearch=function(t){var e,n,o=[],s=[],c={},h=[{},{},{},{}],d=[{},{},{},{}],f=[0,1,2,0],p=[1,2,3,1],m=l.data(),g=l.layer().map();return t=r.transformCoordinates(g.ingcs(),g.gcs(),t),u||l._generateQuads(),i.each([u.clrQuads,u.imgQuads,u.vidQuads],function(i,r){r.forEach(function(i,r){for(e=0;e<f.length;e+=1)h[e].x=i.pos[3*f[e]],h[e].y=i.pos[3*f[e]+1],h[e].z=i.pos[3*f[e]+2],d[e].x=i.pos[3*p[e]],d[e].y=i.pos[3*p[e]+1],d[e].z=i.pos[3*p[e]+2];(a.pointInPolygon(t,h)||a.pointInPolygon(t,d))&&(s.push(i.idx),o.push(m[i.idx]),!(n=a.pointTo2DTriangleBasis(t,h[0],h[1],h[2]))||n.x+n.y>1?(n=a.pointTo2DTriangleBasis(t,d[2],d[1],d[0]))&&(n.x=1-n.x):n.y=1-n.y,n&&(c[i.idx]={basis:n}))})}),{index:s,found:o,extra:c}},this.position=function(t){return void 0===t?l.style("position"):(l.style("position",a.ensureFunction(t)),l.dataTime().modified(),l.modified(),l)},this._positionToQuad=function(t,e,n,o){var a=t.call(l,n,o);if(a.ll&&a.ur||a.ul&&a.lr){var s=l.gcs(),u=l.layer().map().gcs(),c={};return i.each(["ll","lr","ul","ur"],function(t,i){void 0!==a[i]&&(c[i]={},void 0===a[i].x?c[i]=[a[i][0],a[i][1],a[i][2]]:c[i]=[a[i].x,a[i].y,a[i].z],void 0===c[i][2]&&(c[i][2]=e.call(l,n,o)),s!==u&&!1!==s&&(c[i]=r.transformCoordinates(s,u,c[i])))}),c.ll=c.ll||[c.ul[0],c.lr[1],(c.ul[2]+c.lr[2])/2],c.lr=c.lr||[c.ur[0],c.ll[1],(c.ur[2]+c.ll[2])/2],c.ur=c.ur||[c.lr[0],c.ul[1],(c.lr[2]+c.ul[2])/2],c.ul=c.ul||[c.ll[0],c.ur[1],(c.ll[2]+c.ur[2])/2],c}},this._checkQuadUpdate=function(t,e){},this._generateQuads=function(){var t,e,n=l.position(),r=l.style.get("image"),o=l.style.get("video"),c=l.style.get("delayRenderWhenSeeking"),p=l.style.get("color"),m=l.style.get("depth"),g=l.style.get("opacity"),v=l.style.get("drawOnAsyncResourceLoaded"),y=l.style.get("previewColor"),x=l.style.get("previewImage"),b=l.data(),_=[],w=[],M=[],A=[0,0,0];return l._objectListStart(d),l._objectListStart(f),i.each(b,function(u,b){if(b._cachedQuad)return e=b._cachedQuad.diag2,(void 0===t||b._cachedQuad.diag2&&b._cachedQuad.diag2<t)&&(A=b._cachedQuad.ll,t=b._cachedQuad.diag2),b._cachedQuad.clrquad&&_.push(b._cachedQuad.clrquad),b._cachedQuad.imgquad&&(b._cachedQuad.imageEntry&&l._objectListGet(d,b._cachedQuad.imageEntry),w.push(b._cachedQuad.imgquad)),void(b._cachedQuad.vidquad&&(b._cachedQuad.videoEntry&&l._objectListGet(f,b._cachedQuad.videoEntry),M.push(b._cachedQuad.vidquad)));var T,C,E,O,S,P,k,R,j,L,D,I,F={};if(k=l._positionToQuad(n,m,b,u),L=g.call(l,b,u),void 0!==k&&L&&!(L<0)){if(e=Math.pow(k.ll[0]-k.ur[0],2)+Math.pow(k.ll[1]-k.ur[1],2)+Math.pow(k.ll[2]-k.ur[0],2)+Math.pow(k.lr[0]-k.ur[0],2)+Math.pow(k.lr[1]-k.ur[1],2)+Math.pow(k.lr[2]-k.ur[0],2),F.diag2=e,F.ll=k.ll,(void 0===t||e&&e<t)&&(A=k.ll,t=e),k=[k.ll[0],k.ll[1],k.ll[2],k.lr[0],k.lr[1],k.lr[2],k.ul[0],k.ul[1],k.ul[2],k.ur[0],k.ur[1],k.ur[2]],T={idx:u,pos:k,opacity:L,zOffset:b.zOffset},b.reference&&(T.reference=b.reference),b.crop&&(T.crop=b.crop),j=(R=r.call(l,b,u))?null:o.call(l,b,u),R){if(F.imageEntry=R,void 0===(C=l._objectListGet(d,R))&&(R instanceof Image||R instanceof HTMLCanvasElement?C=R:(C=new Image).src=R,l._objectListAdd(d,R,C)),a.isReadyImage(C)||C instanceof HTMLCanvasElement)T.image=C;else if(D=void 0,(I=x.call(l,b,u))&&a.isReadyImage(I)?T.image=I:(D=y.call(l,b,u),T.color=a.convertColor(D),T.color&&void 0!==T.color.r&&void 0!==T.color.g&&void 0!==T.color.b?(_.push(T),F.clrquad=T):D=void 0),v.call(l,b,u))P=a.isReadyImage(C,!0)?null:i.Deferred(),O=C.onload,C.onload=function(){if(void 0!==D&&(i.inArray(T,_)>=0&&_.splice(i.inArray(T,_),1),delete F.clrquad),T.image=C,l.dataTime().modified(),l.modified(),l._update(),l.layer().draw(),P&&P.resolve(),O)return O.apply(l,arguments)},S=C.onerror,C.onerror=function(){if(P&&P.reject(),S)return S.apply(l,arguments)},P&&l.layer().addPromise(P.promise());else if(void 0===D&&!T.image)return;w.push(T),F.imgquad=T}else if(j){if(F.videoEntry=j,void 0===(E=l._objectListGet(f,j))&&(j instanceof HTMLVideoElement?E=j:(E=document.createElement("video")).src=j,l._objectListAdd(f,j,E),i(E).off(".geojsvideo").on("seeking.geojsvideo canplay.geojsvideo pause.geojsvideo playing.geojsvideo",function(t){l._checkQuadUpdate(T,t)})),T.delayRenderWhenSeeking=c.call(l,b,u),void 0===T.delayRenderWhenSeeking&&(T.delayRenderWhenSeeking=!0),a.isReadyVideo(E))T.video=E;else if(D=y.call(l,b,u),T.color=a.convertColor(D),T.color&&void 0!==T.color.r&&void 0!==T.color.g&&void 0!==T.color.b?(_.push(T),F.clrquad=T):D=void 0,v.call(l,b,u))P=a.isReadyVideo(E,!0)?null:i.Deferred(),O=E.onloadeddata,E.onloadeddata=function(){if(void 0!==D&&(i.inArray(T,_)>=0&&_.splice(i.inArray(T,_),1),delete F.clrquad),T.video=E,l.dataTime().modified(),l.modified(),l._update(),l.layer().draw(),P&&P.resolve(),O)return O.apply(l,arguments)},S=E.onerror,E.onerror=function(){if(P&&P.reject(),S)return S.apply(l,arguments)},P&&l.layer().addPromise(P.promise());else if(void 0===D&&!T.video)return;M.push(T),F.vidquad=T}else{if(T.color=a.convertColor(p.call(l,b,u)),!T.color||void 0===T.color.r||void 0===T.color.g||void 0===T.color.b)return;_.push(T),F.clrquad=T}F.clrquad&&(h+=1,F.clrquad.quadId=h),F.imgquad&&(h+=1,F.imgquad.quadId=h),F.vidquad&&(h+=1,F.vidquad.quadId=h),!1!==s&&(b._cachedQuad=F)}}),l._objectListEnd(d),l._objectListEnd(f),u={clrQuads:_,imgQuads:w,vidQuads:M,origin:A}},this.cacheUpdate=function(t){return void 0===t||null===t?i.each(l.data(),function(t,e){e._cachedQuad&&delete e._cachedQuad}):(isFinite(t)&&(t=l.data()[t]),t._cachedQuad&&delete t._cachedQuad),l.modified(),l},this.video=function(t){var e,n;return isFinite(t)&&(t=l.data()[t]),t._cachedQuad?e=(t._cachedQuad.vidquad||{}).video:(u||l._generateQuads(),(n=l.data().indexOf(t))>=0&&(e=l._objectListGet(f,l.style.get("video")(t,n)))),e instanceof HTMLVideoElement?e:null},this._init=function(t){t=t||{},c.call(l,t),s=!1!==t.cacheQuads;var e=i.extend({},{color:{r:1,g:1,b:1},opacity:1,depth:0,drawOnAsyncResourceLoaded:!0,previewColor:null,previewImage:null,image:function(t){return t.image},video:function(t){return t.video},position:function(t){return t}},void 0===t.style?{}:t.style);void 0!==t.position&&(e.position=a.ensureFunction(t.position)),l.style(e),l.dataTime().modified()},l};a.create=function(t,e){return(e=e||{}).type="quad",o.create(t,e)},a.capabilities={color:"quad.color",image:"quad.image",imageCrop:"quad.imageCrop",imageFixedScale:"quad.imageFixedScale",imageFull:"quad.imageFull",canvas:"quad.canvas",video:"quad.video"},r(a,o),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(14),o=function t(e){if(!(this instanceof n(11)))return new t(e);r.call(this);var i=this,o=this.draw,a={};return this._renderOnCanvas=function(){},this._delayRender=function(){return!1},this._canvasProperty=function(t,e,n){return t&&e?(a[e]!==n&&(a[e]=n,t[e]=n),i):(a={},i)},this.draw=function(){return i.ready&&(i._update(),i.renderer()._render(),o()),i},this};i(o,r),t.exports=o},function(t,e,n){"use strict";t.exports=function t(e){if(!(this instanceof n(11)))return new t(e);var i=this,r=this.draw;if(this.draw=function(){return i.ready&&(i._update({mayDelay:!0}),i.renderer()._render(),r()),i},this.bin){var o=this.bin;this.bin=function(t,e){if(void 0===t&&!e&&null===o(void 0,!0)){var n=i.layer&&i.layer(),r=n&&n.map&&n.map(),a=(r&&r.listSceneObjects()||[]).indexOf(i);if(a>=0)return a}return o.apply(i,arguments)}}return this}},function(t,e,n){"use strict";e.a=function(t){return t<0?-1:1}},function(t,e,n){"use strict";var i=n(3),r=n(21);e.a=function(t){return Math.abs(t)<i.d?t:t-Object(r.a)(t)*Math.PI}},function(t,e,n){t.exports={create:n(201),clone:n(202),copy:n(203),identity:n(110),transpose:n(204),invert:n(205),adjoint:n(206),determinant:n(207),multiply:n(208),translate:n(209),scale:n(210),rotate:n(211),rotateX:n(212),rotateY:n(213),rotateZ:n(214),fromRotation:n(215),fromRotationTranslation:n(216),fromScaling:n(217),fromTranslation:n(218),fromXRotation:n(219),fromYRotation:n(220),fromZRotation:n(221),fromQuat:n(222),frustum:n(223),perspective:n(224),perspectiveFromFieldOfView:n(225),ortho:n(226),lookAt:n(227),str:n(228)}},function(t,e,n){"use strict";var i=n(0),r=n(8),o=n(9),a=n(7),s=n(4),u=function t(e){if(!(this instanceof t))return new t(e);var i=n(2);e=e||{},r.call(this,e);var u,l=this,c=this._init,h=o();return this.featureType="line",this._subfeatureStyles={lineCap:!0,lineJoin:!0,strokeColor:!0,strokeOffset:!0,strokeOpacity:!0,strokeWidth:!0},this.line=function(t){return void 0===t?l.style("line"):(l.style("line",t),l.dataTime().modified(),l.modified(),l)},this.position=function(t){return void 0===t?l.style("position"):(l.style("position",t),l.dataTime().modified(),l.modified(),l)},this._updatePointSearchInfo=function(){if(h.timestamp()>=l.dataTime().timestamp()&&h.timestamp()>=l.timestamp())return u;h.modified(),u=[];var t=l.data(),e=l.line(),n=l.style.get("strokeWidth"),i=l.position(),r=l.style.get("closed"),o=l.gcs(),s=l.layer().map().gcs();return t.forEach(function(t,l){var c,h,d,f=r(t,l),p=[];e(t,l).forEach(function(e,r){var u=i(e,r,t,l);o!==s&&(u=a.transformCoordinates(o,s,u));var m=Math.ceil(n(e,r,t,l)/2)+2,g=m*m;c&&p.push({u:u,v:c,r2:h>g?h:g}),c=u,h=g,!d&&f&&(d={p:u,r2:g})}),f&&d&&(c.x!==d.p.x||c.y!==d.p.y)&&p.push({u:c,v:d.p,r2:h>d.r2?h:d.r2}),u.push(p)}),u},this.pointSearch=function(t){var e=l.data(),n=[],i=[];if(!e||!e.length||!l.layer())return{found:i,index:n};l._updatePointSearchInfo();var r,o,c,h=l.layer().map(),d=h.unitsPerPixel(h.zoom()),f=d*d,p=a.transformCoordinates(h.ingcs(),h.gcs(),t);for(r=0;r<u.length;r+=1)for(c=u[r],o=0;o<c.length;o+=1)if(s.distance2dToLineSquared(p,c[o].u,c[o].v)<=c[o].r2*f){i.push(e[r]),n.push(r);break}return{found:i,index:n}},this.boxSearch=function(t,e,n){var i=l.position(),r=[],o=l.line();if((n=n||{}).partial=n.partial||!1,n.partial)throw new Error("Unimplemented query method.");return l.data().forEach(function(n,a){var s=!0;o(n,a).forEach(function(r,o){if(s){var u=i(r,o,n,a);u.x>=t.x&&u.x<=e.x&&u.y>=t.y&&u.y<=e.y||(s=!1)}}),s&&r.push(a)}),r},this.rdpSimplifyData=function(t,e,n,i){t=t||l.data(),n=n||l.style.get("position"),i=i||l.style.get("line");var r=l.layer().map(),o=r.gcs(),u=l.gcs(),c=l.style.get("closed");return void 0===e&&(e=.5*r.unitsPerPixel(r.zoom())),t=t.map(function(t,r){var l=i(t,r),h=a.transformCoordinates(u,o,l.map(function(e,i){return n(e,i,t,r)})),d=s.rdpLineSimplify(h,e,c(t,r),[]);for(var f in(d.length<2||2===d.length&&s.distance2dSquared(d[0],d[1])<e*e)&&(d=[]),d=a.transformCoordinates(o,u,d),t)!t.hasOwnProperty(f)||Array.isArray(t)&&f>=0&&f<t.length||(d[f]=t[f]);return d}),l.style("position",function(t){return t}),l.style("line",function(t){return t}),l.data(t),l},this._init=function(t){t=t||{},c.call(l,t);var e=i.extend({},{strokeWidth:1,strokeColor:{r:1,g:.8431372549,b:0},strokeStyle:"solid",strokeOpacity:1,antialiasing:2,closed:!1,line:function(t){return t},position:function(t){return t}},void 0===t.style?{}:t.style);return void 0!==t.line&&(e.line=t.line),void 0!==t.position&&(e.position=t.position),l.style(e),l.dataTime().modified(),l},this._init(e),this};u.create=function(t,e){return(e=e||{}).type="line",r.create(t,e)},u.capabilities={feature:"line",basic:"line.basic",multicolor:"line.multicolor"},i(u,r),t.exports=u},function(t,e,n){"use strict";var i,r=n(0),o=n(14),a=n(8),s=n(1).checkRenderer,u=n(1).rendererForFeatures,l=n(1).rendererForAnnotations,c=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var i,r=n(2),a=n(9),c=n(13),h=n(1).createRenderer,d=n(1).adjustLayerForRenderer,f=n(6),p=this,m=this._exit,g=void 0===e.id?t.newLayerId():e.id,v=void 0===e.name?"":e.name,y=void 0===e.map?null:e.map,x=null,b=void 0===e.canvas?null:e.canvas,_=e.renderer instanceof c?e.renderer:null,w=!1,M=void 0!==e.renderer?e.renderer instanceof c?e.renderer.api():e.renderer:e.annotations?l(e.annotations):u(e.features),A=void 0===e.autoshareRenderer||e.autoshareRenderer,T=a(),C=a(),E=void 0===e.sticky||e.sticky,O=void 0===e.active||e.active,S=void 0===e.opacity?1:e.opacity,P=e.attribution||null,k=void 0===e.visible||e.visible,R=void 0===e.selectionAPI||e.selectionAPI;if(M=s(M),!y)throw new Error("Layers must be initialized on a map.");function j(){return(p.parent()||p.map()).children().filter(function(e){return e instanceof t})}if(this.rendererName=function(){return M},this.autoshareRenderer=function(){return A},this.zIndex=function(t,e){return void 0===t?i:(e||j().reverse().forEach(function(e){e!==p&&e.zIndex()===t&&e.zIndex(t+1)}),t!==i&&(i=t,x.css("z-index",i),p.geoTrigger(f.layerRemove,{layer:p})),p)},this.moveUp=function(t){var e,n,i,r,o=null;for(void 0===t&&(t=1),r=1,t<0&&(r=-1,t=-t),e=j().sort(function(t,e){return r*(t.zIndex()-e.zIndex())}),n=0;n<e.length;n+=1)if(null===o)e[n]===p&&(o=n);else{if(!(n-o<=t))break;i=p.zIndex(),p.zIndex(e[n].zIndex(),!0),e[n].zIndex(i,!0)}return p},this.moveDown=function(t){return void 0===t&&(t=1),p.moveUp(-t)},this.moveToTop=function(){return p.moveUp(j().length-1)},this.moveToBottom=function(){return p.moveDown(j().length-1)},this.sticky=function(){return E},this.active=function(t){return void 0===t?O:(O!==t&&(O=t,x.toggleClass("active",O)),p)},this.node=function(){return x},this.id=function(e){return void 0===e?g:(g=null===e?t.newLayerId():e,p.modified(),p)},this.name=function(t){return void 0===t?v:(v=t,x.attr("id",v),p.modified(),p)},this.map=function(){return y},this.renderer=function(){return _},this._renderer=function(t){return void 0===t?_:(_=t,p)},this.canvas=function(){return b},this._canvas=function(t){return void 0===t?b:(b=t,p)},this.dataTime=function(){return T},this.updateTime=function(){return C},this.initialized=function(t){return void 0!==t?(w=t,p):w},this.toLocal=function(t){return t},this.fromLocal=function(t){return t},this.attribution=function(t){return void 0!==t?(P=t,p.map().updateAttribution(),p):P},this.visible=function(t){return void 0===t?k:(k!==t&&(k=t,x.toggleClass("hidden",!k),p.modified()),p)},this.selectionAPI=function(t){return void 0===t?R:(R!==t&&(R=t),p)},this._init=function(t){if(w)return p;y.node().append(x);var n=r.extend({},e);return delete n.map,_?p._canvas(_.canvas()):null===M?(p._renderer(null),p._canvas(x)):b?p._renderer(h(M,p,b,n)):(p._renderer(h(M,p,void 0,n)),p._canvas(_.canvas())),x.toggleClass("active",p.active()),w=!0,t||(p.geoOn(f.resize,function(t){p._update({event:t})}),p.geoOn(f.pan,function(t){p._update({event:t})}),p.geoOn(f.rotate,function(t){p._update({event:t})}),p.geoOn(f.zoom,function(t){p._update({event:t})})),p},this._exit=function(){p.geoOff(),_&&_._exit(),x.off(),x.remove(),e={},p._canvas(null),p._renderer(null),m()},this._update=function(){return p},this.width=function(){return p.map().size().width},this.height=function(){return p.map().size().height},this.opacity=function(t){return void 0!==t?(S=t,x.css("opacity",S),p):S},(x=r(document.createElement("div"))).addClass("geojs-layer"),x.attr("renderer",M),v&&x.attr("id",v),p.opacity(S),p.visible(k),void 0===e.zIndex){var L=-1;j().forEach(function(t){void 0!==t.zIndex()&&(L=Math.max(L,t.zIndex()))}),e.zIndex=L+1}return p.zIndex(e.zIndex),d("all",p),p};c.newLayerId=(i=1,function(){var t=i;return i+=1,t}),c.create=function(t,e){if((e=e||{}).type=e.type||"feature",e.renderer=void 0===e.renderer?"webgl":e.renderer,e.renderer=s(e.renderer),!e.renderer)return console.warn("Invalid renderer"),null;var n=t.createLayer(e.type,e);return n?(e.features&&e.features.forEach(function(t){t.data=t.data||e.data,t.feature=a.create(n,t)}),n):(console.warn("Unable to create a layer"),null)},r(c,o),t.exports=c},function(t,e,n){"use strict";var i=n(0),r=n(8),o=function t(e){if(!(this instanceof t))return new t(e);e=e||{},r.call(this,e);var i=n(2),o=n(9),a=n(116),s=n(6),u=n(4),l=n(264),c=this,h=this._init,d=null,f=o(),p=this.data,m=0,g=e.clustering,v=null,y=[],x=null,b=!1;return this.featureType="point",this.clustering=function(t){return void 0===t?g:(g&&!t?(v=null,g=!1,p(y)):t&&g!==t&&(g=t,c._clusterData()),c)},this._clusterData=function(){if(g){var t=!0===g?{radius:10}:g,e=c.position(),n=c.layer().map(),r=n.gcsToDisplay(n.center(void 0,null),null),o=n.displayToGcs(r,c.gcs()),s=n.displayToGcs({x:r.x+t.radius,y:r.y},c.gcs()),l=Math.pow(Math.pow(s.y-o.y,2)+Math.pow(s.x-o.x,2),.5),h=n.zoom(),d=l*Math.pow(2,h);t=i.extend({},t,{radius:d}),v=new a(t),y.forEach(function(t,n){var i=u.normalizeCoordinates(e(t,n));i.index=n,v.addPoint(i)}),x=null,c._handleZoom(n.zoom())}},this._handleZoom=function(t){var e=Math.floor(t);if(g&&e!==x){x=e;var n=v.points(e).map(function(t){return y[t.index]});v.clusters(e).forEach(function(t){t.__cluster=!0,t.__data=[],t.obj.each(function(e){t.__data.push(y[e.index])}),n.push(t)}),b=!0,c.data(n)}},this.position=function(t){if(void 0===t)return c.style("position");var e=u.isFunction(t);return c.style("position",function(n,i){return null!==n&&void 0!==n&&n.__cluster?n:e?t(n,i):t}),c.dataTime().modified(),c.modified(),c},this._updateRangeTree=function(){if(!(f.timestamp()>=c.dataTime().timestamp())){var t,e,n=c.style.get("radius"),i=c.style.get("stroke"),r=c.style.get("strokeWidth");e=c.position(),m=0,t=c.data().map(function(t,o){var a=e(t,o);return m=Math.max(m,n(t,o)+(i(t,o)?r(t,o):0)),[a.x,a.y]}),d=new l(t),f.modified()}},this.pointSearch=function(t){var e,n,i,r,o,a,s=[],u=[],l=c.gcs(),h=c.style.get("stroke"),f=c.style.get("strokeWidth"),p=c.style.get("radius");return(i=c.data())&&i.length?(c._updateRangeTree(),r=c.layer().map(),o=r.gcsToDisplay(t),a=[r.displayToGcs({x:o.x-m,y:o.y-m},l),r.displayToGcs({x:o.x+m,y:o.y-m},l),r.displayToGcs({x:o.x-m,y:o.y+m},l),r.displayToGcs({x:o.x+m,y:o.y+m},l)],e={x:Math.min(a[0].x,a[1].x,a[2].x,a[3].x),y:Math.min(a[0].y,a[1].y,a[2].y,a[3].y)},n={x:Math.max(a[0].x,a[1].x,a[2].x,a[3].x),y:Math.max(a[0].y,a[1].y,a[2].y,a[3].y)},d.range(e.x,e.y,n.x,n.y).forEach(function(t){var e,n,a,d,m=i[t],g=c.position()(m,t);a=p(i[t],t),(a+=h(i[t],t)?f(i[t],t):0)&&(d=a*a,(e=(g=r.gcsToDisplay(g,l)).x-o.x)*e+(n=g.y-o.y)*n<=d&&(s.push(m),u.push(t)))}),{found:s,index:u}):{found:[],index:[]}},this.boxSearch=function(t,e){var n=c.position(),i=[];return c.data().forEach(function(r,o){var a=n(r,o);a.x>=t.x&&a.x<=e.x&&a.y>=t.y&&a.y<=e.y&&i.push(o)}),i},this.data=function(t){return void 0===t?p():(b||(y=t),g&&!b?c._clusterData():p(t),b=!1,c)},this._init=function(t){t=t||{},h.call(c,t);var e=i.extend({},{radius:5,stroke:!0,strokeColor:{r:.851,g:.604,b:0},strokeWidth:1.25,strokeOpacity:1,fillColor:{r:1,g:.839,b:.439},fill:!0,fillOpacity:.8,position:function(t){return t}},void 0===t.style?{}:t.style);return void 0!==t.position&&(e.position=t.position),c.style(e),e.position&&c.position(e.position),c.dataTime().modified(),c.geoOn(s.zoom,function(t){c._handleZoom(t.zoomLevel)}),c},c};o.create=function(t,e){return(e=e||{}).type="point",r.create(t,e)},o.capabilities={feature:"point",stroke:"line.stroke"},i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(0),r=n(8),o=function t(e){if(!(this instanceof t))return new t(e);e=e||{},r.call(this,e);var i=n(2),o=this,a=this._init;return this.featureType="text",this.position=function(t){return void 0===t?o.style("position"):(t!==o.style("position")&&(o.style("position",t),o.dataTime().modified(),o.modified()),o)},this.text=function(t){return void 0===t?o.style("text"):(t!==o.style("text")&&(o.style("text",t),o.dataTime().modified(),o.modified()),o)},this._init=function(t){t=t||{},a.call(o,t);var e=i.extend({},{font:"bold 16px sans-serif",textAlign:"center",textBaseline:"middle",color:{r:0,g:0,b:0},rotation:0,rotateWithMap:!1,textScaled:!1,position:function(t){return t},text:function(t){return t.text}},void 0===t.style?{}:t.style);void 0!==t.position&&(e.position=t.position),void 0!==t.text&&(e.text=t.text),o.style(e),e.position&&o.position(e.position),e.text&&o.text(e.text),o.dataTime().modified()},this._init(e),o};o.usedStyles=["visible","font","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","textAlign","textBaseline","color","textOpacity","rotation","rotateWithMap","textScaled","offset","shadowColor","shadowOffset","shadowBlur","shadowRotate","textStrokeColor","textStrokeWidth"],o.create=function(t,e){return(e=e||{}).type="text",r.create(t,e)},o.capabilities={feature:"text"},i(o,r),t.exports=o},function(t,e,n){"use strict";e.a=function(t,e){if(t[e])return t[e];var n,r=Object.keys(t),o=e.toLowerCase().replace(i,""),a=-1;for(;++a<r.length;)if(n=r[a],n.toLowerCase().replace(i,"")===o)return t[n]};var i=/[\s_\-\/\(\)]/g},function(t,e,n){"use strict";var i=n(3);e.a=function(t,e,n){var r=t*n,o=.5*t;return r=Math.pow((1-r)/(1+r),o),Math.tan(.5*(i.d-e))/r}},function(t,e,n){"use strict";var i=n(3);e.a=function(t,e){for(var n,r,o=.5*t,a=i.d-2*Math.atan(e),s=0;s<=15;s++)if(n=t*Math.sin(a),a+=r=i.d-2*Math.atan(e*Math.pow((1-n)/(1+n),o))-a,Math.abs(r)<=1e-10)return a;return-9999}},function(t,e,n){"use strict";e.a=function(t,e,n,i,r){return t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-i*Math.sin(6*r)}},function(t,e,n){"use strict";e.a=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))}},function(t,e,n){"use strict";e.a=function(t){return.375*t*(1+.25*t*(1+.46875*t))}},function(t,e,n){"use strict";e.a=function(t){return.05859375*t*t*(1+.75*t)}},function(t,e,n){"use strict";e.a=function(t){return t*t*t*(35/3072)}},function(t,e,n){t.exports={EPSILON:n(98),create:n(99),clone:n(168),angle:n(169),fromValues:n(100),copy:n(170),set:n(171),equals:n(172),exactEquals:n(173),add:n(174),subtract:n(103),sub:n(175),multiply:n(104),mul:n(176),divide:n(105),div:n(177),min:n(178),max:n(179),floor:n(180),ceil:n(181),round:n(182),scale:n(183),scaleAndAdd:n(184),distance:n(106),dist:n(185),squaredDistance:n(107),sqrDist:n(186),length:n(108),len:n(187),squaredLength:n(109),sqrLen:n(188),negate:n(189),inverse:n(190),normalize:n(101),dot:n(102),cross:n(191),lerp:n(192),random:n(193),transformMat4:n(194),transformMat3:n(195),transformQuat:n(196),rotateX:n(197),rotateY:n(198),rotateZ:n(199),forEach:n(200)}},function(t,e,n){"use strict";var i=n(0),r=n(25),o=n(6),a=n(1),s=function t(e){if(!(this instanceof t))return new t(e);r.call(this,e);var n=this,i=[],s=this._init,u=this._exit,l=this._update,c=this.visible,h=this.selectionAPI,d=this.draw;return this.createFeature=function(t,e){var i=a.createFeature(t,n,n.renderer(),e);return i?n.addFeature(i):console.warn("Layer renderer ("+n.rendererName()+') does not support feature type "'+t+'"'),i},this.addFeature=function(t){return n.removeFeature(t),n.addChild(t),i.push(t),n.dataTime().modified(),n.modified(),n},this.removeFeature=function(t){var e;return(e=i.indexOf(t))>=0&&(i.splice(e,1),n.removeChild(t),n.dataTime().modified(),n.modified()),n},this.deleteFeature=function(t){return t&&(i.indexOf(t)>=0&&t._exit(),n.removeFeature(t)),n},this.features=function(t){if(void 0===t)return i.slice();var e,r=i.slice();for(e=0;e<r.length;e+=1)t.indexOf(r[e])<0&&i.indexOf(r[e])>=0&&n.deleteFeature(r[e]);for(e=0;e<t.length;e+=1)n.addFeature(t[e]);return n},this.gcsFeatures=function(t){var e,i;return void 0===t?(this.features().forEach(function(t){void 0===e?e=t.gcs():t.gcs()!==e&&(i=!0)}),i?void 0:e):(n.features().forEach(function(e){e.gcs()!==t&&e.gcs(t)}),n)},this._init=function(){return n.initialized()?n:(s.call(n,!0),n.geoOn(o.resize,function(t){n.renderer()?(n.renderer()._resize(t.x,t.y,t.width,t.height),n._update({event:t}),n.renderer()._render()):n._update({event:t})}),n.geoOn(o.pan,function(t){n._update({event:t}),n.renderer()&&n.renderer()._render()}),n.geoOn(o.rotate,function(t){n._update({event:t}),n.renderer()&&n.renderer()._render()}),n.geoOn(o.zoom,function(t){n._update({event:t}),n.renderer()&&n.renderer()._render()}),n)},this._update=function(t){var e;if(!i.length)return n;if(l.call(n,t),n.dataTime().timestamp()>n.updateTime().timestamp())for(e=0;e<i.length;e+=1)i[e].renderer(n.renderer());for(e=0;e<i.length;e+=1)i[e]._update();return n.updateTime().modified(),n},this._exit=function(){n.clear(),u()},this.draw=function(){return n.visible()&&(d(),n.renderer()&&n.renderer()._render()),n},this.visible=function(t){if(void 0===t)return c();if(n.visible()!==t){c(t);var e,r=i.slice();for(e=0;e<r.length;e+=1)r[e].visible(r[e].visible(void 0,!0),!0);t&&n.draw()}return n},this.selectionAPI=function(t){if(void 0===t)return h();if(n.selectionAPI()!==t){h(t);var e,r=i.slice();for(e=0;e<r.length;e+=1)r[e].selectionAPI(r[e].selectionAPI(void 0,!0),!0)}return n},this.clear=function(){for(;i.length;)n.deleteFeature(i[0]);return n},n};i(s,r),a.registerLayer("feature",s),t.exports=s},function(t,e,n){"use strict";var i=n(57),r=n(0),o=n(1).registerWidget,a=function t(e){if(!(this instanceof t))return new t(e);i.call(this,e);var r=n(10),o=this,a=this._exit,s=null;return this._init=function(){var t;return e.hasOwnProperty("parent")&&(e.parent.addChild(o),t=e.parent.canvas()),o._createCanvas(t),o.canvas().addEventListener("mousedown",function(t){t.stopPropagation()}),o.reposition(),o},this._exit=function(){s&&s._exit(),a()},this._createCanvas=function(t){var e={layer:o.layer(),widget:!0};t&&(e.d3Parent=t),(s=r(e))._resize=function(){},o.canvas(s.canvas()[0][0])},this};r(a,i),o("dom","svg",a),t.exports=a},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",i=t[3];if(!i)return n;if(e&&"function"==typeof btoa){var r=(a=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),o=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[n].concat(o).concat([r]).join("\n")}var a;return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(i[o]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&i[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){var i,r,o={},a=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=i.apply(this,arguments)),r}),s=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),u=null,l=0,c=[],h=n(138);function d(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=o[i.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](i.parts[a]);for(;a<i.parts.length;a++)r.parts.push(y(i.parts[a],e))}else{var s=[];for(a=0;a<i.parts.length;a++)s.push(y(i.parts[a],e));o[i.id]={id:i.id,refs:1,parts:s}}}}function f(t,e){for(var n=[],i={},r=0;r<t.length;r++){var o=t[r],a=e.base?o[0]+e.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};i[a]?i[a].parts.push(s):n.push(i[a]={id:a,parts:[s]})}return n}function p(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=c[c.length-1];if("top"===t.insertAt)i?i.nextSibling?n.insertBefore(e,i.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),c.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=s(t.insertAt.before,n);n.insertBefore(e,r)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function g(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return n.nc}();i&&(t.attrs.nonce=i)}return v(e,t.attrs),p(t,e),e}function v(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function y(t,e){var n,i,r,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var a=l++;n=u||(u=g(e)),i=_.bind(null,n,a,!1),r=_.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),p(t,e),e}(e),i=function(t,e,n){var i=n.css,r=n.sourceMap,o=void 0===e.convertToAbsoluteUrls&&r;(e.convertToAbsoluteUrls||o)&&(i=h(i));r&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([i],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),r=function(){m(n),n.href&&URL.revokeObjectURL(n.href)}):(n=g(e),i=function(t,e){var n=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){m(n)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=f(t,e);return d(n,e),function(t){for(var i=[],r=0;r<n.length;r++){var a=n[r];(s=o[a.id]).refs--,i.push(s)}t&&d(f(t,e),e);for(r=0;r<i.length;r++){var s;if(0===(s=i[r]).refs){for(var u=0;u<s.parts.length;u++)s.parts[u]();delete o[s.id]}}}};var x,b=(x=[],function(t,e){return x[t]=e,x.filter(Boolean).join("\n")});function _(t,e,n,i){var r=n?"":i.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var o=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}},function(t,e,n){"use strict";t.exports={momentum:"geo_action_momentum",pan:"geo_action_pan",rotate:"geo_action_rotate",select:"geo_action_select",unzoomselect:"geo_action_unzoomselect",zoom:"geo_action_zoom",zoomrotate:"geo_action_zoom_rotate",zoomselect:"geo_action_zoomselect",annotation_line:"geo_annotation_line",annotation_polygon:"geo_annotation_polygon",annotation_rectangle:"geo_annotation_rectangle",annotation_edit_handle:"geo_annotation_edit_handle"}},function(t,e,n){"use strict";var i=n(140),r=n(146),o=n(147),a=n(148),s=n(150),u=n(151),l=n(28);function c(t,e){if(!(this instanceof c))return new c(t);e=e||function(t){if(t)throw t};var n=Object(i.a)(t);if("object"==typeof n){var o=c.projections.get(n.projName);if(o){if(n.datumCode&&"none"!==n.datumCode){var h=Object(l.a)(s.a,n.datumCode);h&&(n.datum_params=h.towgs84?h.towgs84.split(","):null,n.ellps=h.ellipse,n.datumName=h.datumName?h.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84";var d=Object(a.b)(n.a,n.b,n.rf,n.ellps,n.sphere),f=Object(a.a)(d.a,d.b,d.rf,n.R_A),p=n.datum||Object(u.a)(n.datumCode,n.datum_params,d.a,d.b,f.es,f.ep2);Object(r.a)(this,n),Object(r.a)(this,o),this.a=d.a,this.b=d.b,this.rf=d.rf,this.sphere=d.sphere,this.es=f.es,this.e=f.e,this.ep2=f.ep2,this.datum=p,this.init(),e(null,this)}else e(t)}else e(t)}c.projections=o.a,c.projections.start(),e.a=c},function(t,e,n){"use strict";e.a=function(t,e,n,i){return n*=e,e*=e,i[0]*t-n*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=c,e.forward=h,e.inverse=d,n.d(e,"names",function(){return f});var i=n(45),r=n(71),o=n(160),a=n(162),s=n(163),u=n(164),l=n(5);function c(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var t=this.es/(1+Math.sqrt(1-this.es)),e=t/(2-t),n=e;this.cgb[0]=e*(2+e*(-2/3+e*(e*(116/45+e*(26/45+e*(-2854/675)))-2))),this.cbg[0]=e*(e*(2/3+e*(4/3+e*(-82/45+e*(32/45+e*(4642/4725)))))-2),n*=e,this.cgb[1]=n*(7/3+e*(e*(-227/45+e*(2704/315+e*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+e*(-16/15+e*(-13/9+e*(904/315+e*(-1522/945))))),n*=e,this.cgb[2]=n*(56/15+e*(-136/35+e*(-1262/105+e*(73814/2835)))),this.cbg[2]=n*(-26/15+e*(34/21+e*(1.6+e*(-12686/2835)))),n*=e,this.cgb[3]=n*(4279/630+e*(-332/35+e*(-399572/14175))),this.cbg[3]=n*(1237/630+e*(e*(-24832/14175)-2.4)),n*=e,this.cgb[4]=n*(4174/315+e*(-144838/6237)),this.cbg[4]=n*(-734/315+e*(109598/31185)),n*=e,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(e,2),this.Qn=this.k0/(1+e)*(1+n*(.25+n*(1/64+n/256))),this.utg[0]=e*(e*(2/3+e*(-37/96+e*(1/360+e*(81/512+e*(-96199/604800)))))-.5),this.gtu[0]=e*(.5+e*(-2/3+e*(5/16+e*(41/180+e*(-127/288+e*(7891/37800)))))),this.utg[1]=n*(-1/48+e*(-1/15+e*(437/1440+e*(-46/105+e*(1118711/3870720))))),this.gtu[1]=n*(13/48+e*(e*(557/1440+e*(281/630+e*(-1983433/1935360)))-.6)),n*=e,this.utg[2]=n*(-17/480+e*(37/840+e*(209/4480+e*(-5569/90720)))),this.gtu[2]=n*(61/240+e*(-103/140+e*(15061/26880+e*(167603/181440)))),n*=e,this.utg[3]=n*(-4397/161280+e*(11/504+e*(830251/7257600))),this.gtu[3]=n*(49561/161280+e*(-179/168+e*(6601661/7257600))),n*=e,this.utg[4]=n*(-4583/161280+e*(108847/3991680)),this.gtu[4]=n*(34729/80640+e*(-3418889/1995840)),n*=e,this.utg[5]=-.03233083094085698*n,this.gtu[5]=.6650675310896665*n;var i=Object(a.a)(this.cbg,this.lat0);this.Zb=-this.Qn*(i+Object(s.a)(this.gtu,2*i))}function h(t){var e=Object(l.a)(t.x-this.long0),n=t.y;n=Object(a.a)(this.cbg,n);var i=Math.sin(n),s=Math.cos(n),c=Math.sin(e),h=Math.cos(e);n=Math.atan2(i,h*s),e=Math.atan2(c*s,Object(r.a)(i,s*h)),e=Object(o.a)(Math.tan(e));var d,f,p=Object(u.a)(this.gtu,2*n,2*e);return n+=p[0],e+=p[1],Math.abs(e)<=2.623395162778?(d=this.a*(this.Qn*e)+this.x0,f=this.a*(this.Qn*n+this.Zb)+this.y0):(d=1/0,f=1/0),t.x=d,t.y=f,t}function d(t){var e,n,o=(t.x-this.x0)*(1/this.a),s=(t.y-this.y0)*(1/this.a);if(s=(s-this.Zb)/this.Qn,o/=this.Qn,Math.abs(o)<=2.623395162778){var c=Object(u.a)(this.utg,2*s,2*o);s+=c[0],o+=c[1],o=Math.atan(Object(i.a)(o));var h=Math.sin(s),d=Math.cos(s),f=Math.sin(o),p=Math.cos(o);s=Math.atan2(h*p,Object(r.a)(f,p*d)),o=Math.atan2(f,p*d),e=Object(l.a)(o+this.long0),n=Object(a.a)(this.cgb,s)}else e=1/0,n=1/0;return t.x=e,t.y=n,t}var f=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"];e.default={init:c,forward:h,inverse:d,names:f}},function(t,e,n){"use strict";e.a=function(t){var e=Math.exp(t);return e=(e-1/e)/2}},function(t,e,n){"use strict";e.a=function(t,e,n){var i=e*n;return t/Math.sqrt(1-i*i)}},function(t,e,n){"use strict";e.a=function(t,e,n,i,r){var o,a;o=t/e;for(var s=0;s<15;s++)if(o+=a=(t-(e*o-n*Math.sin(2*o)+i*Math.sin(4*o)-r*Math.sin(6*o)))/(e-2*n*Math.cos(2*o)+4*i*Math.cos(4*o)-6*r*Math.cos(6*o)),Math.abs(a)<=1e-10)return o;return NaN}},function(t,e,n){"use strict";e.a=function(t,e){var n;return t>1e-7?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e}},function(t,e,n){"use strict";var i,r=n(0),o=n(1).registerRenderer,a=n(13),s=function t(e){if(!(this instanceof t))return new t(e);e=e||{},a.call(this,e);var i,r=n(2),o=n(12),s=n(23),u=n(4),l=n(6),c=this,h=null,d=null,f=!1,p=this._init,m=this._exit;return this.contextRenderer=function(){return h},this.api=function(){return t.apiname},this._init=function(){if(c.initialized())return c;p.call(c);var t=e.canvas||r(document.createElement("canvas"));if(t.addClass("webgl-canvas"),r(c.layer().node().get(0)).append(t),window.overrideContextAttributes){var n=t.get(0),i=n.getContext;n.getContext=function(t,e){if(e=e||{},window.overrideContextAttributes)for(var r in window.overrideContextAttributes)window.overrideContextAttributes.hasOwnProperty(r)&&(e[r]=window.overrideContextAttributes[r]);return i.call(n,t,e)}}(d=o.viewer(t.get(0),e.options)).init(),(h=d.renderWindow().activeRenderer()).setResetScene(!1),d.renderWindow().renderers().length>0&&h.setLayer(d.renderWindow().renderers().length),c.canvas(t);var a=c.layer().map().size();return c._resize(0,0,a.width,a.height),c},this._resize=function(t,e,n,i){var r=d.renderWindow();return t===r.windowPosition[0]&&e===r.windowPosition[1]&&n===c.width()&&i===c.height()||(c._setWidthHeight(n,i),c.canvas().attr("width",n),c.canvas().attr("height",i),r.positionAndResize(t,e,n,i),f=!0,c._render()),c},this._render=function(){return c.layer().map().scheduleAnimationFrame(c._renderFrame,!0),c},this._renderFrame=function(){d&&(f&&(f=!1,c._updateRendererCamera()),d.render())},this._glContext=function(){return d&&d.renderWindow()?d.renderWindow().context():o.GL},this._exit=function(){if(c.layer().map().scheduleAnimationFrame(c._renderFrame,"remove"),c.canvas().remove(),d){var t=new o.renderState;t.m_renderer=d,t.m_context=c._glContext(),d.exit(t),c._glContext()!==o.GL&&c._glContext().getExtension("WEBGL_lose_context")&&c._glContext().getExtension("WEBGL_lose_context").loseContext&&c._glContext().getExtension("WEBGL_lose_context").loseContext()}o.clearCachedShaders(o.GL),d=null,m()},this._updateRendererCamera=function(){var t=d.renderWindow(),e=c.layer().map(),n=e.camera(),r=e.rotation()||0,o=n.view,a=n.projectionMatrix;if(a[15])a=s.copy(u.mat4AsArray(),a),a=s.scale(a,a,[1,1,-.5]),a=s.translate(a,a,[0,0,n.clipbounds.far]);else{var l=n.clipbounds.near,h=n.clipbounds.far;a=s.copy(u.mat4AsArray(),a),a=s.scale(a,a,[1/l,1/l,-1/h])}var f=Math.PI/2,p=r%f,m=Math.min(Math.abs(p),Math.abs(p-f))<1e-5;t.renderers().forEach(function(t){var r=t.camera();if(!u.compareArrays(o,r.viewMatrix())||!u.compareArrays(a,r.projectionMatrix())||i!==e.zoom()){i=e.zoom(),r.setViewMatrix(o,!0),r.setProjectionMatrix(a);var s=n.viewport;a[1]||a[2]||a[3]||a[4]||a[6]||a[7]||a[8]||a[9]||a[11]||1!==a[15]||!m||s.left&&s.left%1||s.top&&s.top%1||parseFloat(i.toFixed(6))!==parseFloat(i.toFixed(0))?r.viewAlignment=function(){return null}:r.viewAlignment=function(){var t={roundx:2/s.width,roundy:2/s.height};return t.dx=s.width%2?.5*t.roundx:0,t.dy=s.height%2?.5*t.roundy:0,t}}})},c.layer().geoOn(l.pan,function(t){f=!0}),c.layer().geoOn(l.parallelprojection,function(t){var e=c.contextRenderer(),n=c.layer();if(t.geo&&t.geo._triggeredBy!==n){if(!e||!e.camera())return void console.log("Parallel projection event triggered on unconnected VGL renderer.");e.camera().setEnableParallelProjection(t.parallelProjection),f=!0}}),this};s.apiname="webgl",r(s,a),o("webgl",s),o("vgl",s),s.supported=function(){if(void 0===i){var t,e;try{(e=(t=document.createElement("canvas")).getContext("webgl")||t.getContext("experimental-webgl")).getSupportedExtensions().indexOf("WEBGL_debug_renderer_info")>=0&&(s._unmaskedRenderer=e.getParameter(e.getExtension("WEBGL_debug_renderer_info").UNMASKED_RENDERER_WEBGL)),i=!0}catch(t){console.warn("No webGL support"),i=!1}t=void 0,e=void 0,void 0}return i},s.fallback=function(){return null},t.exports=s},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(8),a=n(7),s=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var r,s=n(4),u=this,l=this._init,c=this._exit,h=this.data,d=this.draw,f=this.modified,p=this.style,m=[];function g(t,e,n){return t=t||u.data(),e=e||u.style.get("position"),n=n||u.style.get("polygon"),t.map(function(t,i){var r=n(t,i);if(r){var o,a,s,l,c,h;for(s=r.outer||(Array.isArray(r)?r:[]),o=new Array(s.length),l=0;l<s.length;l+=1)o[l]=e.call(u,s[l],l,t,i),c=o[l].x||o[l][0]||0,h=o[l].y||o[l][1]||0,l?(c<a.min.x&&(a.min.x=c),h<a.min.y&&(a.min.y=h),c>a.max.x&&(a.max.x=c),h>a.max.y&&(a.max.y=h)):a={min:{x:c,y:h},max:{x:c,y:h}};return{outer:o,inner:(r.inner||[]).map(function(n){s=n||[];var r=new Array(s.length);for(l=0;l<s.length;l+=1)r[l]=e.call(u,s[l],l,t,i);return r}),range:a}}})}function v(t){return s.isFunction(t)?function(e){return t(e[0],e[1],e[2],e[3])}:t}return this.featureType="polygon",this._subfeatureStyles={fillColor:!0,fillOpacity:!0,lineCap:!0,lineJoin:!0,strokeColor:!0,strokeOffset:!0,strokeOpacity:!0,strokeWidth:!0},this.data=function(t){var e=h(t);return void 0!==t&&(m=g(),u._checkForStroke()),e},this.polygonCoordinates=function(){return m},this.polygon=function(t){return void 0===t?u.style("polygon"):(u.style("polygon",t),u.dataTime().modified(),u.modified(),m=g(),u)},this.position=function(t){return void 0===t?u.style("position"):(u.style("position",t),u.dataTime().modified(),u.modified(),m=g(),u)},this.pointSearch=function(t){var e=[],n=[],i={},o=u.data(),l=u.layer().map(),c=a.transformCoordinates(l.ingcs(),u.gcs(),t);(m.forEach(function(t,r){s.pointInPolygon(c,t.outer,t.inner,t.range)&&(n.push(r),i[r]=!0,e.push(o[r]))}),r)&&r.pointSearch(t).found.forEach(function(t){t.length&&4===t[0].length&&!i[t[0][3]]&&(n.push(t[0][3]),i[t[0][3]]=!0,e.push(o[t[0][3]]))});return{index:n,found:e}},this.style=function(t,e){var n=p.apply(u,arguments);return void 0===t||"string"==typeof t&&void 0===e||u._checkForStroke(),n},this.style.get=p.get,this._getLoopData=function(t,e,n){var i,r=[];for(i=0;i<n.length;i+=1)r.push([n[i],i,t,e]);return r},this._checkForStroke=function(){if(!1!==p("stroke")){if(u.layer()){r||(r=u.layer().createFeature("line",{selectionAPI:!1,gcs:u.gcs(),visible:u.visible(void 0,!0)}),u.dependentFeatures([r]));var t,e=u.style();if(s.isFunction(e.stroke)||!e.stroke){var n=u.style.get("stroke"),i=u.style.get("strokeOpacity");t=function(t){return n(t[2],t[3])?i(t[0],t[1],t[2],t[3]):0}}else t=v(e.strokeOpacity);r.style({antialiasing:v(e.antialiasing),closed:!0,lineCap:v(e.lineCap),lineJoin:v(e.lineJoin),miterLimit:v(e.miterLimit),strokeWidth:v(e.strokeWidth),strokeStyle:v(e.strokeStyle),strokeColor:v(e.strokeColor),strokeOffset:v(e.strokeOffset),strokeOpacity:t});var o=u.data(),a=u.style("position");if(o!==r._lastData||a!==r._lastPosVal){var l,c,h,d=[],f=u.style.get("position"),m=u.style.get("polygon");for(l=0;l<o.length;l+=1)(c=m(o[l],l))&&(h=c.outer||(Array.isArray(c)?c:[])).length>=2&&(d.push(u._getLoopData(o[l],l,h)),c.inner&&c.inner.forEach(function(t){t.length>=2&&d.push(u._getLoopData(o[l],l,t))}));r.position(function(t,e,n,i){return f(t[0],t[1],t[2],t[3])}),r.data(d),r._lastData=o,r._lastPosVal=a}}}else r&&u.layer()&&(u.layer().deleteFeature(r),r=null,u.dependentFeatures([]))},this.draw=function(){var t=d();return r&&r.draw(),t},this.modified=function(){var t=f();return r&&r.modified(),t},this.rdpSimplifyData=function(t,e,n,i){var r=u.layer().map(),o=r.gcs(),l=u.gcs(),c=g(t,n,i);return void 0===e&&(e=.5*r.unitsPerPixel(r.zoom())),c=c.map(function(t){return{outer:a.transformCoordinates(l,o,t.outer),inner:t.inner.map(function(t){return a.transformCoordinates(l,o,t)})}}),t=t.map(function(t,n){var i=c[n],r={};for(var u in t)!t.hasOwnProperty(u)||Array.isArray(t)&&u>=0&&u<t.length||(r[u]=t[u]);if(i&&i.outer.length>=3)if(r.inner=i.inner.filter(function(t){return t.length>=3}),r.outer=s.rdpLineSimplify(i.outer,e,!0,r.inner),r.outer.length>=3){var h=r.inner.slice();r.inner.map(function(t,n){h[n]=r.outer;var i=s.rdpLineSimplify(t,e,!0,h);return h[n]=i,i}).filter(function(t){return t.length>=3}),r.outer=a.transformCoordinates(o,l,r.outer),r.inner=r.inner.map(function(t){return a.transformCoordinates(o,l,t)})}else r.outer=r.inner=[];else r.outer=[];return r}),u.style("position",function(t){return t}),u.style("polygon",function(t){return t}),u.data(t),u},this.mouseOverOrderClosestBorder=function(t){var e=t.feature.data(),n=t.feature.layer().map(),i=a.transformCoordinates(n.ingcs(),t.feature.gcs(),t.mouse.geo),r=t.feature.polygonCoordinates(),o={};t.over.index.forEach(function(t,e){var n,a=r[t];a.outer.forEach(function(t,e){var r=a.outer[(e+1)%a.outer.length],o=s.distance2dToLineSquared(i,t,r);(void 0===n||o<n)&&(n=o)}),a.inner.forEach(function(t){t.forEach(function(e,r){var o=t[(r+1)%t.length],a=s.distance2dToLineSquared(i,e,o);(void 0===n||a<n)&&(n=a)})}),o[t]=n}),t.over.index.sort(function(t,e){return o[t]-o[e]}).reverse(),t.over.index.forEach(function(n,i){t.over.found[i]=e[n]})},this._exit=function(){r&&u.layer()&&(u.layer().deleteFeature(r),r=null,u.dependentFeatures([])),c()},this._init=function(t){t=t||{},l.call(u,t);var e=i.extend({},{fill:!0,fillColor:{r:0,g:.5,b:.5},fillOpacity:1,stroke:!1,strokeWidth:1,strokeStyle:"solid",strokeColor:{r:0,g:1,b:1},strokeOpacity:1,polygon:function(t){return t},position:function(t){return t}},void 0===t.style?{}:t.style);void 0!==t.polygon&&(e.polygon=t.polygon),void 0!==t.position&&(e.position=t.position),u.style(e),u._checkForStroke()},this};s.create=function(t,e){return(e=e||{}).type="polygon",o.create(t,e)},s.capabilities={feature:"polygon"},r(s,o),t.exports=s},function(t,e,n){"use strict";var i=n(0),r=n(11),o=n(4),a=n(117),s=function t(e){if(!(this instanceof t))return new t(e);r.call(this);var i,s,u,l,c,h,d,f,p,m,g=n(2),v=n(6),y=n(41),x=n(4).throttle,b=n(4).debounce,_=n(4).actionMatch,w=n(18),M=this,A=null,T=!1,C=!1,E=function(){};function O(t){var e=t.x,n=t.y;return Math.sqrt(e*e+n*n)}function S(){h={boundDocumentHandlers:h.boundDocumentHandlers}}function P(t,e){e=e<=0?30:e;var n=function(){var t,e,n,r;if(!i.spring.enabled)return{x:0,y:0};var o=M.map().maxBounds(void 0,null),a=M.map().gcsToDisplay({x:o.left,y:o.top},null),s=M.map().gcsToDisplay({x:o.right,y:o.bottom},null),u=i.spring.springConstant,l=M.map().node().width(),c=M.map().node().height();return t=u*Math.max(0,a.x),e=u*Math.max(0,l-s.x),n=u*Math.max(0,a.y)/2,r=u*Math.max(0,c-s.y)/2,{x:t-e,y:n-r}}(),r=O(t),o=t.x/r,a=t.y/r;return r*=Math.exp(-i.momentum.drag*e),O(n)*e+r<i.momentum.minSpeed?null:(r>0?(o*=r,a*=r):(o=0,a=0),{x:o-n.x*e,y:a-n.y*e})}return i=g.extend(!0,{},{throttle:30,discreteZoom:!1,actions:[{action:y.pan,input:"left",modifiers:{shift:!1,ctrl:!1},owner:"geo.mapInteractor",name:"button pan"},{action:y.zoom,input:"right",modifiers:{shift:!1,ctrl:!1},owner:"geo.mapInteractor",name:"button zoom"},{action:y.zoom,input:"wheel",modifiers:{shift:!1,ctrl:!1},owner:"geo.mapInteractor",name:"wheel zoom"},{action:y.rotate,input:"left",modifiers:{shift:!1,ctrl:!0},owner:"geo.mapInteractor",name:"button rotate"},{action:y.rotate,input:"wheel",modifiers:{shift:!1,ctrl:!0},owner:"geo.mapInteractor",name:"wheel rotate"},{action:y.select,input:"left",modifiers:{shift:!0,ctrl:!0},selectionRectangle:v.select,owner:"geo.mapInteractor",name:"drag select"},{action:y.zoomselect,input:"left",modifiers:{shift:!0,ctrl:!1},selectionRectangle:v.zoomselect,owner:"geo.mapInteractor",name:"drag zoom"},{action:y.unzoomselect,input:"right",modifiers:{shift:!0,ctrl:!1},selectionRectangle:v.unzoomselect,owner:"geo.mapInteractor",name:"drag unzoom"},{action:y.pan,input:"pan",owner:"geo.mapInteractor",name:"touch pan"},{action:y.zoomrotate,input:"rotate",owner:"geo.mapInteractor",name:"touch zoom and rotate"}],click:{enabled:!0,buttons:{left:!0,right:!0,middle:!0},duration:0,cancelOnMove:!0},keyboard:{actions:{"zoom.in":["plus","shift+plus","shift+ctrl+plus","=","shift+=","shift+ctrl+="],"zoom.out":["-","shift+-","shift+ctrl+-","_","shift+_","shift+ctrl+_"],"zoom.0":["1"],"zoom.3":["2"],"zoom.6":["3"],"zoom.9":["4"],"zoom.12":["5"],"zoom.15":["6"],"zoom.18":["7"],"pan.left":["left","shift+left","shift+ctrl+left"],"pan.right":["right","shift+right","shift+ctrl+right"],"pan.up":["up","shift+up","shift+ctrl+up"],"pan.down":["down","shift+down","shift+ctrl+down"],"rotate.ccw":["<","shift+<","shift+ctrl+<",".","shift+.","shift+ctrl+."],"rotate.cw":[">","shift+>","shift+ctrl+>",",","shift+,","shift+ctrl+,"],"rotate.0":["0"]},meta:{0:{shift:!1,ctrl:!1},1:{shift:!0,ctrl:!0},2:{shift:!0,ctrl:!1}},focusHighlight:!0},alwaysTouch:!1,wheelScaleX:1,wheelScaleY:1,zoomScale:1,rotateWheelScale:6*Math.PI/180,zoomrotateMinimumRotation:5*Math.PI/180,zoomrotateReverseRotation:4*Math.PI/180,zoomrotateMinimumZoom:.05,zoomrotateMinimumPan:5,touchPanDelay:50,momentum:{enabled:!0,maxSpeed:2.5,minSpeed:.01,stopTime:250,drag:.01,actions:[y.pan,y.zoom]},spring:{enabled:!1,springConstant:5e-5},zoomAnimation:{enabled:!0,duration:500,ease:function(t){return(2-t)*t}}},e||{}),e&&e.actions&&(i.actions=g.extend(!0,[],e.actions)),e&&e.momentum&&e.momentum.actions&&(i.momentum.actions=g.extend(!0,[],e.momentum.actions)),e&&e.keyboard&&void 0!==e.keyboard.actions&&(i.keyboard.actions=g.extend(!0,{},e.keyboard.actions)),s={page:{x:0,y:0},map:{x:0,y:0},geo:{x:0,y:0},mapgcs:{x:0,y:0},buttons:{left:!1,right:!1,middle:!1},modifiers:{alt:!1,ctrl:!1,shift:!1,meta:!1},time:new Date,deltaTime:1,velocity:{x:0,y:0}},h={},d={},this._handleKeys=function(t,e,n){n&&!0===n.simulated&&(e=n);var r,o,a=i.keyboard.meta||{0:{}},s=M.map(),u=s.size(),l=t,c="",h={};for(r in a)a.hasOwnProperty(r)&&(void 0!==a[r].shift&&e.shiftKey!==!!a[r].shift||void 0!==a[r].ctrl&&e.ctrlKey!==!!a[r].ctrl||void 0!==a[r].alt&&e.altKey!==!!a[r].alt||void 0!==a[r].meta&&e.metaKey!==!!a[r].meta||(o=r));if(void 0!==o){switch(e.stopPropagation(),e.preventDefault(),t.indexOf(".")>=0&&(l=t.substr(0,t.indexOf(".")),c=t.substr(t.indexOf(".")+1)),l){case"zoom":switch(c){case"in":h.zoomDelta=[.05,.25,1][o];break;case"out":h.zoomDelta=-[.05,.25,1][o];break;default:isNaN(parseFloat(c))||(h.zoom=parseFloat(c))}break;case"pan":switch(c){case"down":h.panY=-Math.max(1,[0,.05,.5][o]*u.height);break;case"left":h.panX=Math.max(1,[0,.05,.5][o]*u.width);break;case"right":h.panX=-Math.max(1,[0,.05,.5][o]*u.width);break;case"up":h.panY=Math.max(1,[0,.05,.5][o]*u.height)}break;case"rotate":switch(c){case"ccw":h.rotationDelta=[1,5,90][o]*Math.PI/180;break;case"cw":h.rotationDelta=-[1,5,90][o]*Math.PI/180;break;default:isNaN(parseFloat(c))||(h.rotation=parseFloat(c))}}s.geoTrigger(v.keyaction,{move:h,action:t,factor:o,event:e}),h.cancel||(void 0!==h.zoom?s.zoom(h.zoom):h.zoomDelta&&s.zoom(s.zoom()+h.zoomDelta),void 0!==h.rotation?s.rotation(h.rotation):h.rotationDelta&&s.rotation(s.rotation()+h.rotationDelta),(h.panX||h.panY)&&s.pan({x:h.panX||0,y:h.panY||0}))}},this.hasTouchSupport=function(){return"ontouchstart"in window||window.Modernizr&&window.Modernizr.touch||(navigator.msMaxTouchPoints||navigator.maxTouchPoints)>1},this._handleTouch=function(t){var e=!1;if("mouse"===t.pointerType&&c.touchSupport&&(e=!0),"hammer.input"===t.type){if("pan"!==c.lastEventType||1===t.pointers.length)return;e=!0,c.lastEventType=null}var n=/^(.*)(start|end|move|tap)$/.exec(t.type);if(n&&3===n.length||(e=!0),e)h.boundDocumentHandlers&&c.lastEvent&&M._handleMouseUpDocument(c.lastEvent);else{t.which=n[1];var r=(new Date).valueOf();"pan"===t.which&&"pan"!==c.lastEventType&&r-c.lastTime<i.touchPanDelay||(c.lastTime=r,c.lastEventType=t.which,c.lastEvent=t,void 0===t.pageX&&void 0!==t.center&&void 0!==t.center.x&&(t.pageX=t.center.x,t.pageY=t.center.y),"start"===n[2]&&(M._handleMouseDown(t),M._setClickMaybe(!1),h.boundDocumentHandlers&&g(document).on("mousemove.geojs",M._handleMouseUpDocument)),"start"!==n[2]&&"move"!==n[2]||(h.boundDocumentHandlers?M._handleMouseMoveDocument(t):M._handleMouseMove(t)),"end"!==n[2]&&"cancel"!==n[2]||(h.boundDocumentHandlers?M._handleMouseUpDocument(t):M._handleMouseUp(t),c.lastEvent=null),"tap"!==n[2]||h.boundDocumentHandlers||(t.which=1,c.lastEventType=null,M._handleMouseDown(t),M._handleMouseUp(t),c.lastEventType=n[2]))}},this.retriggerMouseMove=function(){M.map().geoTrigger(v.mousemove,M.mouse())},this._connectEvents=function(){if(!i.map)return M;M._disconnectEvents(),f=g(i.map.node()),M._handleMouseWheel=function(){var t={};function e(e){var n,r;T||(t!==d&&(d=t={kind:"wheel",scroll:{x:0,y:0}}),e.preventDefault(),e.deltaFactor=1,1===e.originalEvent.deltaMode?e.deltaFactor=40:2===e.originalEvent.deltaMode&&(e.deltaFactor=g(window).height()),n=e.originalEvent.deltaX||0,r=e.originalEvent.deltaY||0,n=n*i.wheelScaleX*e.deltaFactor/120,r=r*i.wheelScaleY*e.deltaFactor/120,t.scroll.x+=n,t.scroll.y+=r)}function n(e){var n,r,o;if(t===d){if(M._getMouseModifiers(e),o=_({wheel:!0},s.modifiers,i.actions),r=(o||{}).action){var a=M.map().transitionCancel("wheel."+r);switch((a|=M.cancel(y.momentum,!0))&&(s.geo=M.map().displayToGcs(s.map),s.mapgcs=M.map().displayToGcs(s.map,null)),r){case y.pan:M.map().pan({x:d.scroll.x,y:d.scroll.y},void 0,"limited");break;case y.zoom:n=-d.scroll.y,E(n,s);break;case y.rotate:M.map().rotation(M.map().rotation()+d.scroll.y*i.rotateWheelScale,s)}M.map().geoTrigger(v.actionwheel,{state:M.state(),mouse:M.mouse(),event:e})}d={}}}return i.throttle>0?x(i.throttle,!1,n,e):function(t){e(t),n(t)}}(),E=function(){var t,e,n,r=0,o=400;function a(o,a){var s,u=M.map();t=g.extend(!0,{},a),r+=o,void 0===n&&(e=n=u.zoom()),n+=o,u&&Math.abs(r)>=1&&i.discreteZoom&&!i.zoomAnimation.enabled&&(s=Math.round(r+u.zoom()),r=r+u.zoom()-s,u.zoom(s,t))}function s(){var o,a=M.map();a&&(i.zoomAnimation.enabled?(o=n,i.discreteZoom&&(o=Math.round(o))===e&&n!==e&&(o=e+(n>e?1:-1)),a.transitionCancel("debounced_zoom."+y.zoom),a.transition({zoom:o,zoomOrigin:t,duration:i.zoomAnimation.duration,ease:i.zoomAnimation.ease,done:function(t){t=t||{};var e=new RegExp("\\."+y.zoom+"$");t.next||t.cancel&&!((""+t.source).search(e)<0)||(n=void 0),i.discreteZoom&&t.cancel&&t.transition&&t.transition.end&&(""+t.source).search(e)<0&&a.zoom(t.transition.end.zoom,t.transition.end.zoomOrigin)}})):(o=r+a.zoom(),i.discreteZoom&&(o=Math.round(o)),a.zoom(o,t))),r=0}!0!==i.discreteZoom&&i.discreteZoom>0&&(o=i.discreteZoom);return(!0===i.discreteZoom||i.discreteZoom>0)&&!i.zoomAnimation.enabled?b(o,!1,s,a):function(t,e){(t||void 0!==n)&&(a(t,e),s())}}(),o.adjustActions(i.actions);var t={};if(["right","pan","rotate"].forEach(function(e){t[e]=i.actions.some(function(t){return t.input[e]})}),f.on("wheel.geojs",M._handleMouseWheel),f.on("mousemove.geojs",M._handleMouseMove),f.on("mousedown.geojs",M._handleMouseDown),f.on("mouseup.geojs",M._handleMouseUp),f.on("dragstart",function(){return!1}),t.right&&f.on("contextmenu.geojs",function(){return!1}),i.keyboard&&i.keyboard.actions){u=a(f[0]);var e=[];for(var r in i.keyboard.actions)i.keyboard.actions.hasOwnProperty(r)&&(u.bind(i.keyboard.actions[r],function(t){return function(e,n){M._handleKeys(t,e,n)}}(r)),e=e.concat(i.keyboard.actions[r]));l=e}if(f.toggleClass("highlight-focus",!!(l&&l.length&&i.keyboard.focusHighlight)),(M.hasTouchSupport()||i.alwaysTouch)&&(t.pan||t.rotate)){var h;try{h=n(266)}catch(t){}if(void 0!==h){var p=[],m=["hammer.input"];t.rotate&&(p.push([h.Rotate,{enable:!0}]),m=m.concat(["rotatestart","rotateend","rotatemove"])),t.pan&&(p.push([h.Pan,{direction:h.DIRECTION_ALL}]),m=m.concat(["panstart","panend","panmove"])),p.push([h.Tap,{event:"doubletap",taps:2}]),p.push([h.Tap,{event:"singletap"},void 0,["doubletap"]]),m=m.concat(["singletap"]);var w={recognizers:p,preventDefault:!0};(c={manager:new h.Manager(f[0],w),touchSupport:M.hasTouchSupport(),lastTime:0}).manager.get("doubletap").recognizeWith("singletap"),m.forEach(function(t){c.manager.on(t,M._handleTouch)})}}return M},this._disconnectEvents=function(){return l&&(u&&u.unbind(l),l=null,u=null),c&&(c.manager.destroy(),c=null),f&&(f.off(".geojs"),f=null),M._handleMouseWheel=function(){},E=function(){},M},this.map=function(t){return void 0!==t?(i.map=t,M._connectEvents(),M):i.map},this.options=function(t){return void 0===t?g.extend({},i):(g.extend(i,t),M._connectEvents(),M)},this._getMousePosition=function(t){var e,n,i=f.offset();e=(n=(new Date).valueOf())-s.time,s.time=n,s.deltaTime=e,s.velocity={x:(t.pageX-s.page.x)/e,y:(t.pageY-s.page.y)/e},s.page={x:t.pageX,y:t.pageY},s.map={x:t.pageX-i.left,y:t.pageY-i.top};try{s.geo=M.map().displayToGcs(s.map),s.mapgcs=M.map().displayToGcs(s.map,null)}catch(t){s.geo=s.mapgcs=null}},this._getMouseButton=function(t){for(var e in s.buttons)s.buttons.hasOwnProperty(e)&&(s.buttons[e]=!1);if(void 0!==t.buttons)s.buttons.left=!!(1&t.buttons),s.buttons.right=!!(2&t.buttons),s.buttons.middle=!!(4&t.buttons);else if("mouseup"!==t.type)switch(t.which){case 1:s.buttons.left=!0;break;case 2:s.buttons.middle=!0;break;case 3:s.buttons.right=!0}!t.which||t.which>=1&&t.which<=3||(s.buttons[t.which]=!0)},this._getMouseModifiers=function(t){s.modifiers.alt=t.altKey,s.modifiers.ctrl=t.ctrlKey,s.modifiers.meta=t.metaKey,s.modifiers.shift=t.shiftKey},this._getSelection=function(){var t=h.origin,e=M.mouse(),n=M.map(),i={},r={};return i.upperLeft={x:Math.min(t.map.x,e.map.x),y:Math.min(t.map.y,e.map.y)},i.lowerRight={x:Math.max(t.map.x,e.map.x),y:Math.max(t.map.y,e.map.y)},i.upperRight={x:i.lowerRight.x,y:i.upperLeft.y},i.lowerLeft={x:i.upperLeft.x,y:i.lowerRight.y},r.upperLeft=n.displayToGcs(i.upperLeft,null),r.lowerRight=n.displayToGcs(i.lowerRight,null),r.upperRight=n.displayToGcs(i.upperRight,null),r.lowerLeft=n.displayToGcs(i.lowerLeft,null),p.data([{ul:r.upperLeft,ur:r.upperRight,ll:r.lowerLeft,lr:r.lowerRight}]),p.draw(),{display:i,gcs:r,mouse:e,origin:g.extend({},h.origin)}},this.cancel=function(t,e){var n;return(n=t?h.action===t:!!h.action)&&(e||(d={}),S()),n},this._setClickMaybe=function(t){C=t,m&&(window.clearTimeout(m),m=null)},this._handleMouseDown=function(t){var e,n;if(!(T||c&&"tap"===c.lastEventType&&(new Date).valueOf()-c.lastTime<1e3)){M._getMousePosition(t),M._getMouseButton(t),M._getMouseModifiers(t),!i.click.enabled||s.buttons.left&&!i.click.buttons.left||s.buttons.right&&!i.click.buttons.right||s.buttons.middle&&!i.click.buttons.middle||(M._setClickMaybe({x:s.page.x,y:s.page.y,buttons:g.extend({},s.buttons)}),i.click.duration>0&&(m=window.setTimeout(function(){C=!1,m=null},i.click.duration))),e=((n=_(s.buttons,s.modifiers,i.actions))||{}).action;var r=M.map();r.transitionCancel("_handleMouseDown"+(e?"."+e:"")),M.cancel(y.momentum),s.velocity={x:0,y:0},e&&(d={kind:"move"},h={action:e,actionRecord:n,origin:g.extend(!0,{},s),initialZoom:r.zoom(),initialRotation:r.rotation(),initialEventRotation:t.rotation,delta:{x:0,y:0}},n.selectionRectangle&&(A&&(A.clear(),r.deleteLayer(A),A=null),A=r.createLayer("feature",{features:[w.capabilities.color]}),(p=A.createFeature("quad",{gcs:r.gcs()})).style({opacity:.25,color:{r:.3,g:.3,b:.3}}),r.geoTrigger(v.brushstart,M._getSelection())),r.geoTrigger(v.actiondown,{state:M.state(),mouse:M.mouse(),event:t}),i.throttle>0?g(document).on("mousemove.geojs",x(i.throttle,M._handleMouseMoveDocument)):g(document).on("mousemove.geojs",M._handleMouseMoveDocument),g(document).on("mouseup.geojs",M._handleMouseUpDocument),h.boundDocumentHandlers=!0)}},this._handleMouseMove=function(t){T||h.boundDocumentHandlers||(i.click.cancelOnMove&&C&&M._setClickMaybe(!1),M._getMousePosition(t),M._getMouseButton(t),M._getMouseModifiers(t),C||M.map().geoTrigger(v.mousemove,M.mouse()))},this._handleZoomrotate=function(t){var e=Math.log2(t.scale);if(!h.zoomrotateAllowZoom&&e&&Math.abs(e)>=Math.log2(1+i.zoomrotateMinimumZoom)&&(i.zoomrotateMinimumZoom&&(h.initialZoom-=e),h.zoomrotateAllowZoom=!0),h.zoomrotateAllowZoom&&e){var n=h.initialZoom+e;M.map().zoom(n,h.origin)}var r=(t.rotation-h.initialEventRotation)*Math.PI/180;if(!h.zoomrotateAllowRotation&&r&&Math.abs(r)>=i.zoomrotateMinimumRotation&&(i.zoomrotateMinimumRotation&&(h.initialEventRotation=t.rotation,r=0),h.zoomrotateAllowRotation=!0),h.zoomrotateAllowRotation){var a=h.initialRotation+r;(r=o.wrapAngle(a-M.map().rotation()))&&(r*(h.lastRotationDelta||0)>=0||Math.abs(r)>=i.zoomrotateReverseRotation)&&(M.map().rotation(a,h.origin),h.lastRotationDelta=r)}var s=h.origin.page;if(h.initialEventGeo){var u=f.offset();(s=M.map().gcsToDisplay(h.initialEventGeo)).x+=u.left,s.y+=u.top}var l=t.pageX-s.x,c=t.pageY-s.y,d=l*l+c*c;!h.zoomrotateAllowPan&&d&&d>=i.zoomrotateMinimumPan*i.zoomrotateMinimumPan&&(i.zoomrotateMinimumPan?(l=c=0,h.initialEventGeo=M.mouse().geo):h.initialEventGeo=h.origin.geo,h.zoomrotateAllowPan=!0),h.zoomrotateAllowPan&&(l||c)&&M.map().pan({x:l,y:c})},this._handleMouseMoveDocument=function(t){var e,n,r;if(M.map()&&!T&&"move"===d.kind&&(M._getMousePosition(t),M._getMouseButton(t),M._getMouseModifiers(t),!i.click.cancelOnMove||void 0!==C.x&&s.page.x===C.x&&s.page.y===C.y||M._setClickMaybe(!1),!C))if(h.action){if(e=s.map.x-h.origin.map.x-h.delta.x,n=s.map.y-h.origin.map.y-h.delta.y,h.delta.x+=e,h.delta.y+=n,h.action===y.pan)M.map().pan({x:e,y:n},void 0,"limited");else if(h.action===y.zoom)E(-n*i.zoomScale/120,h);else if(h.action===y.rotate){var o,a;void 0===h.origin.rotation&&(o=h.origin.map.x-M.map().size().width/2,a=h.origin.map.y-M.map().size().height/2,h.origin.rotation=M.map().rotation()-Math.atan2(a,o)),o=s.map.x-M.map().size().width/2,a=s.map.y-M.map().size().height/2,M.map().rotation(h.origin.rotation+Math.atan2(a,o))}else h.action===y.zoomrotate?M._handleZoomrotate(t):h.actionRecord.selectionRectangle&&(r=M._getSelection(),M.map().geoTrigger(v.brush,r));M.map().geoTrigger(v.actionmove,{state:M.state(),mouse:M.mouse(),event:t}),t.preventDefault()}else console.log("WARNING: Invalid state in mapInteractor.")},this._zoomFromSelection=function(t,e,n){if((t===y.zoomselect||t===y.unzoomselect)&&e.x!==n.x&&e.y!==n.y){var i,r,o=M.map(),a=o.size(),s={x:Math.abs((n.x-e.x)/a.width),y:Math.abs((n.y-e.y)/a.height)};if(t===y.zoomselect?(r=o.displayToGcs({x:(e.x+n.x)/2,y:(e.y+n.y)/2},null),i=o.zoom()-Math.log2(Math.max(s.x,s.y))):(i=o.zoom()+Math.log2(Math.max(s.x,s.y)),r=o.center(void 0,null)),o.discreteZoom()&&(i=Math.floor(i)),o.zoom(i),t===y.zoomselect)o.center(r,null);else{var u=o.gcsToDisplay(r,null);o.pan({x:(e.x+n.x)/2-u.x,y:(e.y+n.y)/2-u.y})}}},this._handleMouseUpDocument=function(t){var e,n;if(!T&&(d={},M._setClickMaybe(!1),M._getMouseButton(t),M._getMouseModifiers(t),g(document).off(".geojs"),h.boundDocumentHandlers=!1,s.buttons.right&&t.preventDefault(),h.actionRecord&&h.actionRecord.selectionRectangle&&(M._getMousePosition(t),e=M._getSelection(),A.clear(),M.map().deleteLayer(A),A=null,p=null,M.map().geoTrigger(v.brushend,e),!0!==h.actionRecord.selectionRectangle&&M.map().geoTrigger(h.actionRecord.selectionRectangle,e),M._zoomFromSelection(h.action,e.display.lowerLeft,e.display.upperRight),M.map().geoTrigger(v.actionselection,{state:M.state(),mouse:M.mouse(),event:t,lowerLeft:e.display.lowerLeft,upperRight:e.display.upperRight})),M.map().geoTrigger(v.actionup,{state:M.state(),mouse:M.mouse(),event:t}),n=h.action,S(),i.momentum.enabled&&g.inArray(n,i.momentum.actions)>=0)){var r=(new Date).valueOf(),o=r-s.time+s.deltaTime;r-s.time<i.momentum.stopTime?(s.velocity.x*=s.deltaTime/o,s.velocity.y*=s.deltaTime/o,s.deltaTime=o):s.velocity.x=s.velocity.y=0,M.springBack(!0,n)}},this._handleMouseUp=function(t){T||(M._getMouseButton(t),C&&M._handleMouseClick(t))},this._handleMouseClick=function(t){h.actionRecord&&h.actionRecord.selectionRectangle&&(A.clear(),M.map().deleteLayer(A),A=null,p=null,h.action=h.actionRecord=null),M._getMouseButton(t),M._getMouseModifiers(t),M.cancel(y.pan),g(document).off(".geojs"),h.boundDocumentHandlers=!1;var e=M.mouse();e.buttonsDown=C.buttons,M._setClickMaybe(!1),M.map().geoTrigger(v.mouseclick,e)},this._handleMouseWheel=function(){},this.springBack=function(t,e){h.action!==y.momentum&&(t||(s.velocity={x:0,y:0}),h.origAction=e,h.action=y.momentum,h.origin=M.mouse(),h.momentum=M.mouse(),h.start=new Date,h.handler=function(){var t,e,n,r;if(h.action===y.momentum&&M.map()&&!M.map().transition())if(r=Math.min(h.momentum.deltaTime,30),n=h.start.valueOf(),h.start=new Date,t=P(h.momentum.velocity,h.start-n)){switch((e=O(t))>i.momentum.maxSpeed&&(e=i.momentum.maxSpeed/e,t.x=t.x*e,t.y=t.y*e),isFinite(t.x)&&isFinite(t.y)||(t.x=0,t.y=0),h.momentum.velocity.x=t.x,h.momentum.velocity.y=t.y,h.origAction){case y.zoom:var o=h.momentum.velocity.y*r;E(-o*i.zoomScale/120,h);break;default:M.map().pan({x:h.momentum.velocity.x*r,y:h.momentum.velocity.y*r},void 0,"limited")}h.handler&&M.map().scheduleAnimationFrame(h.handler)}else S()},h.handler&&M.map().scheduleAnimationFrame(h.handler))},this.destroy=function(){M._disconnectEvents(),M.map()&&g(M.map().node()).removeClass("highlight-focus"),M.map(null)},this.mouse=function(){return g.extend(!0,{},s)},this.keyboard=function(t){return void 0===t?g.extend(!0,{},i.keyboard||{}):M.options({keyboard:t})},this.state=function(){return g.extend(!0,{},h)},this.pause=function(t){return void 0===t?T:(T=!!t,M)},this.addAction=function(t,e){t&&t.action&&t.input&&(o.addAction(i.actions,t,e),i.map&&i.actions.some(function(t){return t.input.right})&&(f.off("contextmenu.geojs"),f.on("contextmenu.geojs",function(){return!1})))},this.hasAction=function(t,e,n){return o.hasAction(i.actions,t,e,n)},this.removeAction=function(t,e,n){var r=o.removeAction(i.actions,t,e,n);return i.map&&!i.actions.some(function(t){return t.input.right})&&f.off("contextmenu.geojs"),r},this.simulateEvent=function(t,e){var n,i,r,o,a;if(!M.map())return M;if("keyboard"===t&&u){var s={shiftKey:e.shift||e.shiftKey||!1,ctrlKey:e.ctrl||e.ctrlKey||!1,altKey:e.alt||e.altKey||!1,metaKey:e.meta||e.metaKey||!1,toString:function(){return e.keys},stopPropagation:function(){},preventDefault:function(){},simulated:!0};u.trigger(s)}else i=e.page||{},e.map&&(r=f.offset(),i.x=e.map.x+r.left,i.y=e.map.y+r.top),"left"===e.button?(o=1,a=1):"right"===e.button?(o=3,a=2):"middle"===e.button&&(o=2,a=4),e.modifiers=e.modifiers||[],e.wheelDelta=e.wheelDelta||{},n=g.Event(t,{pageX:i.x,pageY:i.y,which:o,buttons:a,altKey:e.modifiers.indexOf("alt")>=0,ctrlKey:e.modifiers.indexOf("ctrl")>=0,metaKey:e.modifiers.indexOf("meta")>=0,shiftKey:e.modifiers.indexOf("shift")>=0,center:e.center,rotation:e.touch?e.rotation||0:e.rotation,scale:e.touch?e.scale||1:e.scale,pointers:e.pointers,pointerType:e.pointerType,originalEvent:{deltaX:e.wheelDelta.x,deltaY:e.wheelDelta.y,deltaMode:e.wheelMode,preventDefault:function(){},stopPropagation:function(){},stopImmediatePropagation:function(){}}}),e.touch&&c?M._handleTouch(n):f.trigger(n),t.indexOf(".geojs")>=0&&g(document).trigger(n)},this._connectEvents(),this};i(s,r),t.exports=s},function(t,e,n){"use strict";var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";t.exports=function(){var t,e=[];for(e.length=8,t=0;t<8;t+=1)e[t]=i.charAt(Math.floor(Math.random()*i.length));return e.join("")}},function(t,e,n){"use strict";var i=n(0),r=n(8),o=function t(e){if(!(this instanceof t))return new t(e);var i=n(2),o=n(4);e=e||{},r.call(this,e);var a=this,s=this._init,u={};return this.featureType="mesh",this.mesh=function(t,e){if(void 0===t)return u;if("string"==typeof t&&void 0===e)return u[t];if(void 0===e){var n=i.extend({},{gridWidth:function(){return t.gridHeight?Math.floor(a.data().length/t.gridHeight):Math.floor(Math.sqrt(a.data().length))},gridHeight:function(){return t.gridWidth?Math.floor(a.data().length/t.gridWidth):Math.floor(Math.sqrt(a.data().length))}},u,t);u=n}else u[t]=e;return a.modified(),a},this.mesh.get=function(t){if(void 0===t){var e,n={};for(e in u)u.hasOwnProperty(e)&&(n[e]=a.mesh.get(e));return n}return o.ensureFunction(u[t])},this.position=function(t){return void 0===t?a.style("position"):(a.style("position",t),a.dataTime().modified(),a.modified(),a)},this._createMesh=function(t){t=t||{};var e,n,i,r,o,s,u,l,c,h,d,f,p,m,g,v=a.data(),y=a.position(),x=a.mesh.get("elements")(v),b=a.mesh.get("elementPacking")(v),_=a.mesh.get("gridWidth")(v),w=a.mesh.get("gridHeight")(v),M=a.mesh.get("wrapLongitude")(v),A=a.mesh.get("x0")(v),T=a.mesh.get("y0")(v),C=a.mesh.get("dx")(v),E=a.mesh.get("dy")(v),O=_,S={shape:"square",elements:[]};if(x){var P=x.length&&Array.isArray(x[0]);if("square"===b||"triangle"!==b&&(!P&&!(x.length%4)&&x.length%3||P&&4===x[0].length))if(S.shape="square",P)for(e=0;e<x.length;e+=1)S.elements.push(x[e][0]),S.elements.push(x[e][1]),S.elements.push(x[e][3]),S.elements.push(x[e][2]),S.elements.push(x[e][3]),S.elements.push(x[e][1]);else for(e=0;e<x.length-3;e+=4)S.elements.push(x[e]),S.elements.push(x[e+1]),S.elements.push(x[e+3]),S.elements.push(x[e+2]),S.elements.push(x[e+3]),S.elements.push(x[e+1]);else if(S.shape="triangle",P)for(e=0;e<x.length;e+=1)S.elements.push(x[e][0]),S.elements.push(x[e][1]),S.elements.push(x[e][2]);else S.elements=x.slice(0,x.length-x.length%3);s=v.length,l=!0}else{if(_*w>v.length&&(w=Math.floor(v.length/_)),l=null===A||void 0===A||null===T||void 0===T||!C||!E,M=!(void 0!==M&&!M),!l&&M&&(A<-180||A>180||A+C*(_-1)<-180||A+C*(_-1)>180)&&C>-180&&C<180&&C*(_-1)<360.0001){for(f=[],e=0;e<_;e+=1){for(m=A+e*C;m<-180;)m+=360;for(;m>180;)m-=360;e&&Math.abs(m-f[f.length-1])>180&&(m>f[f.length-1]?(f.push(m-360),f.push(f[f.length-2]+360)):(f.push(m+360),f.push(f[f.length-2]-360)),p=e),f.push(m)}if(_+=2,Math.abs(Math.abs(O*C)-360)<.01){for(_+=1,m=A+O*C;m<-180;)m+=360;for(;m>180;)m-=360;f.push(m)}}if(s=_*w,void 0!==p)for(S.index=new Array(s),e=0;e<s;e+=1)g=e-(i=Math.floor(e/_))*_,(g+=g>p?-2:0)>=O&&(g-=O),g+=i*O,S.index[e]=g;for(i=o=0;i<w-1;i+=1,o+=1)for(e=0;e<_-1;e+=1,o+=1)e!==p&&(S.elements.push(o),S.elements.push(o+1),S.elements.push(o+_),S.elements.push(o+_+1),S.elements.push(o+_),S.elements.push(o+1))}if(S.verticesPerElement="triangle"===S.shape?3:6,t.used){for(e=0;e<s&&(o=S.index?S.index[e]:e,t.used(v[o],o));e+=1);if(e!==s){u=e;var k=new Array(s),R=S.verticesPerElement;for(i=0;i<u;i+=1)k[i]=i;if(k[u]=-1,!S.index)for(S.index=new Array(v.length),i=0;i<v.length;i+=1)S.index[i]=i;for(e=u+1;e<s;e+=1)o=S.index[e],t.used(v[o],o)?(k[e]=u,S.index[u]=S.index[e],u+=1):k[e]=-1;for(S.index.splice(u),e=r=0;e<S.elements.length;e+=R){for(i=0;i<R&&!(k[S.elements[e+i]]<0);i+=1)S.elements[r+i]=k[S.elements[e+i]];i===R&&(r+=R)}S.elements.splice(r),s=u}}for(h in S.pos=new Array(3*s),t)"used"!==h&&t.hasOwnProperty(h)&&(S[h]=new Array(s));for(e=n=0;e<s;e+=1,n+=3)for(h in c=v[o=S.index?S.index[e]:e],l?(d=y(c,o),S.pos[n]=d.x,S.pos[n+1]=d.y,S.pos[n+2]=d.z||0):(S.pos[n]=void 0===p?A+C*(o%_):f[e%_],S.pos[n+1]=T+E*Math.floor(o/_),S.pos[n+2]=0,d={x:S.pos[n],y:S.pos[n+1],z:S.pos[n+2]}),t)"used"!==h&&t.hasOwnProperty(h)&&(S[h][e]=t[h](c,o,d));return S.numVertices=s,S.numElements=S.elements.length/S.verticesPerElement,S},this._init=function(t){s.call(a,t),t=t||{};var e=i.extend({},{position:function(t){return t}},t.style||{});a.mesh(t.mesh||{}),a.style(e)},this};i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(2);t.exports=function t(e){if(!(this instanceof t))return new t(e);this._index=e.index,this._size=e.size,this._overlap=e.overlap||{x:0,y:0},this._wrap=e.wrap||{x:1,y:1},this._url=e.url,this._fetched=!1,this._queue=e.queue||null,Object.defineProperty(this,"index",{get:function(){return this._index}}),Object.defineProperty(this,"size",{get:function(){return this._size}}),Object.defineProperty(this,"overlap",{get:function(){return this._overlap}}),this.fetch=function(){return this._fetched||i.get(this._url).done(function(){this._fetched=!0}.bind(this)).promise(this),this},this.fetched=function(){return this._fetched},this.then=function(t,e){return this.fetched()||!this._queue||!this._queue.add||this.state&&"pending"!==this.state()?this.fetch():this._queue.add(this,this.fetch),this.done&&this.fail?this.done(t).fail(e):this.then(t,e),this},this.catch=function(t){return this.then(void 0,t),this},this.toString=function(){return[this._index.level||0,this._index.y,this._index.x].join("_")},this.bounds=function(t,e){var n,i;return{left:n=this.size.x*(this.index.x-t.x)-this.overlap.x-e.x,right:n+this.size.x+2*this.overlap.x,bottom:(i=this.size.y*(this.index.y-t.y)-this.overlap.y-e.y)+this.size.y+2*this.overlap.y,top:i}},Object.defineProperty(this,"bottom",{get:function(){return this.size.y*(this.index.y+1)+this.overlap.y}}),Object.defineProperty(this,"top",{get:function(){return this.size.y*this.index.y-this.overlap.y}}),Object.defineProperty(this,"left",{get:function(){return this.size.x*this.index.x-this.overlap.x}}),Object.defineProperty(this,"right",{get:function(){return this.size.x*(this.index.x+1)+this.overlap.x}}),this.fadeIn=function(t){return i.noop(t),this}}},function(t,e,n){"use strict";var i=n(0),r=n(53),o=n(1),a=n(4),s={17:[{l0:1,h0:2,l1:0,h1:2}],18:[{l0:0,h0:1,l1:2,h1:1}],20:[{l0:2,h0:0,l1:1,h1:0}],22:[{l0:2,h0:0,l1:2,h1:1}],21:[{l0:1,h0:2,l1:1,h1:0}],19:[{l0:0,h0:1,l1:0,h1:2}],1:[{l0:2,h0:3,l1:1,h1:3}],2:[{l0:0,h0:2,l1:3,h1:2}],4:[{l0:3,h0:1,l1:0,h1:1}],8:[{l0:1,h0:0,l1:2,h1:0}],14:[{l0:3,h0:1,l1:3,h1:2}],13:[{l0:2,h0:3,l1:2,h1:0}],11:[{l0:1,h0:0,l1:1,h1:3}],7:[{l0:0,h0:2,l1:0,h1:1}],3:[{l0:0,h0:2,l1:1,h1:3}],10:[{l0:1,h0:0,l1:3,h1:2}],12:[{l0:3,h0:1,l1:2,h1:0}],5:[{l0:2,h0:3,l1:0,h1:1}],6:[{l0:0,h0:2,l1:0,h1:1},{l0:3,h0:1,l1:3,h1:2}],9:[{l0:1,h0:0,l1:1,h1:3},{l0:2,h0:3,l1:2,h1:0}]},u=function t(e){if(!(this instanceof t))return new t(e);var i=n(2),u=n(7),l=n(6),c=n(27);e=e||{},r.call(this,e);var h,d,f,p,m,g=this,v=this.draw,y=this._exit,x=this._init,b=this.modified,_=this._update;return this.featureType="isoline",this.contour=g.mesh,this.isoline=g.mesh,this._createIsolines=function(){var t,e=g.style.get("value"),n=void 0!==g.style("used")?g.style.get("used"):function(t,n){return a.isNonNullFinite(e(t,n))},i=!1,r=[],o=g._createMesh({used:n,value:e});return(t=g._getValueList(o)).length?(t.forEach(function(t){var e=g._isolinesForValue(o,t);e.length&&(r=r.concat(e),i=i||!!t.label)}),{lines:r,mesh:o,values:t,hasLabels:i}):{}},this._getValueList=function(t){var e,n,i,r,o,s,u,l=g.isoline,c=l.get("values")(t),h=l.get("spacing")(t),d=l.get("count")(t),f=l.get("autofit")(t),p=l.get("levels")(t);if(!t.numVertices||!t.numElements)return[];if(e=a.getMinMaxValues(t.value,l.get("min")(t),l.get("max")(t),!0),t.minValue=e.min,t.maxValue=e.max,(n=t.maxValue-t.minValue)<=0)return[];if(Array.isArray(c))c=(c=c.map(function(t,e){return{value:void 0!==t.value?t.value:t,position:e,level:t.level}})).filter(function(e){return e.value>=t.minValue&&e.value<=t.maxValue});else if(h||f)for(h||(i=n/(2*d/3),o=Math.floor(Math.log10(i)),s=Math.max(0,-o),h=(i=(i/=r=Math.pow(10,o))>=5?5:i>=2?2:1)*r),c=[],u=Math.ceil(t.minValue/h);u<=Math.floor(t.maxValue/h);u+=1)c.push({value:u*h,position:u,fixedDigits:s});else for(c=Array(d),u=0;u<d;u+=1)c[u]={value:t.minValue+n*(u+1)/(d+1),position:u+1};return p.length&&c.forEach(function(t,e){if(void 0===t.level){t.level=0;for(var n=0,i=p[0];n<p.length&&!(t.position%i);i*=p[n+=1])t.level=n+1}if(l.get("label")(t,t.position)){var r=l.get("labelText")(t,t.position);void 0===r&&(r=void 0!==t.fixedDigits?""+parseFloat(t.value.toFixed(t.fixedDigits)):""+t.value),r&&(t.label=r)}}),c},this._addSegment=function(t,e,n){var i,r,o,a,s,u,l=[e,n],c=t.length;for(t.push(l),r=0;r<2;r+=1){for(i=c-1;i>=0;i-=1){if(a=(o=t[i])[0],s=o[o.length-1],n[0]===a[0]&&n[1]===a[1])u=l.concat(o.slice(1));else{if(e[0]!==s[0]||e[1]!==s[1])continue;u=o.concat(l.slice(1))}t.splice(c,1),t[i]=l=u,c=i,e=l[0],n=l[l.length-1];break}if(i<0)break}return t},this._chainVertex=function(t,e,n){var i=n[0],r=n[1],o=3*i,a=3*r,s=(e.value-t.value[i])/(t.value[r]-t.value[i]),u=1-s;return{x:t.pos[o]*u+t.pos[a]*s,y:t.pos[o+1]*u+t.pos[a+1]*s,z:t.pos[o+2]*u+t.pos[a+2]*s}},this._isolinesForValue=function(t,e){var n,i,r,o=e.value,a=Array(t.value.length),u=[];for(n=a.length-1;n>=0;n-=1)a[n]=t.value[n]<=o?0:1;var l=t.verticesPerElement,c="square"===t.shape,h=t.elements,d=h.length;for(i=0;i<d;i+=l){if(c){if(0===(r=8*a[h[i]]+4*a[h[i+1]]+2*a[h[i+2]]+a[h[i+3]])||15===r)continue}else if(16===(r=16+4*a[h[i]]+2*a[h[i+1]]+a[h[i+2]])||23===r)continue;s[r].forEach(function(t){u=g._addSegment(u,[h[i+t.l0],h[i+t.h0]],[h[i+t.l1],h[i+t.h1]])})}return u.map(function(n){var i=[];return n.forEach(function(n){var r=g._chainVertex(t,e,n);i.length&&r.x===i[i.length-1].x&&r.y===i[i.length-1].y||i.push(r)}),i.closed=i[0].x===i[i.length-1].x&&i[0].y===i[i.length-1].y,i.value=e.value,i.level=e.level,i.position=e.position,i.label=e.label,i}).filter(function(t){return t.length>1})},this.modified=function(){var t=b();return f&&f.modified(),m&&m.modified(),t},this.labelPositions=function(){if(g.dataTime().timestamp()>=g.buildTime().timestamp()&&g._build(),d=null,!m)return g;if(!(h&&h.hasLabels&&h.lines&&h.lines.length))return m.data([]),g;var t=g.isoline,e=t.get("labelSpacing"),n=t.get("labelOffset"),i=t.get("labelViewport")(h.mesh),r=g.gcs(),o=g.layer().map(),s=o.gcs(),l=o.rotation(),c=o.size(),f=[],p=0;return h.lines.forEach(function(t,h){if(t.label){var d,m,g,v,y,x,b,_,w,M,A,T=e(t.value,t.value.position),C=n(t.value,t.value.position)||0,E=o.gcsToDisplay(t,r),O=0;if(!(T<=0||isNaN(T))&&(p=Math.max(T,p),C=C+.5-Math.floor(C+.5),d=E.map(function(e,n){if(!t.closed&&n+1===E.length)return 0;var i=Math.sqrt(a.distance2dSquared(e,E[n+1<E.length?n+1:0]));return O+=i,i}),m=Math.floor(O/T)))for(A=u.transformCoordinates(r,s,t),v=(g=O/m)*C,y=0,x=0;x<E.length;x+=1){for(;y+d[x]>=v;)b=x+1===E.length?0:x+1,w=1-(_=(v-y)/d[x]),v+=g,i>0&&((M={x:E[x].x*w+E[b].x*_,y:E[x].y*w+E[b].y*_}).x<-i||M.x>c.width+i||M.y<-i||M.y>c.height+i)||f.push({x:A[x].x*w+A[b].x*_,y:A[x].y*w+A[b].y*_,z:A[x].z*w+A[b].z*_,line:t,rotation:Math.atan2(E[x].y-E[b].y,E[x].x-E[b].x)-l});y+=d[x]}}}),m.gcs(s),m.data(f),m.style("renderThreshold",2*p),d={zoom:o.zoom(),center:o.center(),rotation:l,size:c,labelViewport:i,maxSpacing:p,labelAutoUpdate:t.get("labelAutoUpdate")(h.mesh)},g},this.lastLabelPositions=function(){return i.extend({},d)},this._updateLabelPositions=function(){var t=d;if(!t||!t.labelAutoUpdate)return g;var e=g.layer().map(),n=e.zoom(),i=e.size(),r=!!(Math.abs(n-t.zoom)>=2);if(!r&&t.labelViewport>0){var o=Math.sqrt(a.distance2dSquared(e.gcsToDisplay(e.center()),e.gcsToDisplay(t.center)))*Math.pow(2,t.zoom-n),s=t.labelViewport/2-2*t.maxSpacing-Math.max(i.width-t.size.width,i.height-t.size.height,0);r=r||o>=s}return r&&g.labelPositions().draw(),g},this._build=function(){if((h=g._createIsolines())&&h.lines&&h.lines.length){f||(f=g.layer().createFeature("line",{selectionAPI:!1,gcs:g.gcs(),visible:g.visible(void 0,!0),style:{closed:function(t){return t.closed}}}),g.dependentFeatures([f]));var t=g.style();if(f.data(h.lines).style({antialiasing:t.antialiasing,lineCap:t.lineCap,lineJoin:t.lineJoin,miterLimit:t.miterLimit,strokeWidth:t.strokeWidth,strokeStyle:t.strokeStyle,strokeColor:t.strokeColor,strokeOffset:t.strokeOffset,strokeOpacity:t.strokeOpacity}),h.hasLabels){if(!m){if(!(o.registries.features[g.layer().rendererName()]||{}).text){var e=o.rendererForFeatures(["text"]);p=o.createLayer("feature",g.layer().map(),{renderer:e}),g.layer().addChild(p),g.layer().node().append(p.node())}m=(p||g.layer()).createFeature("text",{selectionAPI:!1,gcs:g.gcs(),visible:g.visible(void 0,!0),style:{text:function(t){return t.line.label}}}).geoOn(l.pan,g._updateLabelPositions)}c.usedStyles.forEach(function(e){"visible"!==e&&m.style(e,t[e])}),g.dependentFeatures([f,m])}}else f&&f.data([]);return g.buildTime().modified(),g.labelPositions(),g},this._update=function(){return _.call(g),(g.dataTime().timestamp()>=g.buildTime().timestamp()||g.updateTime().timestamp()<=g.timestamp())&&g._build(),g.updateTime().modified(),g},this.draw=function(){var t=v();return f&&f.draw(),m&&m.draw(),t},this._exit=function(){m&&((p||g.layer())&&(p||g.layer()).deleteFeature(m),p&&g.layer()&&g.layer().removeChild(p)),f&&g.layer()&&g.layer().deleteFeature(f),m=null,p=null,f=null,g.dependentFeatures([]),y()},this._init=function(e){e=e||{},x.call(g,e);var n=i.extend({},{opacity:1,value:function(t,e){return g.position()(t,e).z},rotateWithMap:!0,rotation:t.rotationFunction(),strokeWidth:function(t,e,n,i){return n.level+.5},strokeColor:{r:0,g:0,b:0},textStrokeColor:{r:1,g:1,b:1,a:.75},textStrokeWidth:2,fontSize:"12px"},void 0===e.style?{}:e.style);g.style(n),g.isoline(i.extend({},{count:15,autofit:!0,levels:[5,5],label:function(t){return t.level>=1},labelSpacing:200,labelViewport:1e4,labelAutoUpdate:!0},e.mesh||{},e.contour||{},e.isoline||{})),(e.mesh||e.contour||e.isoline)&&g.dataTime().modified()},this};u.rotationFunction=function(t,e){var n={higher:function(t){return t.rotation},lower:function(t){return t.rotation+Math.PI},map:function(t){var e=t.rotation,n=a.wrapAngle(e,!0);return(n>Math.PI/2||n<-Math.PI/2)&&(e+=Math.PI),e},screen:function(t){var n=t.rotation,i=a.wrapAngle(n+e.rotation(),!0);return(i>Math.PI/2||i<-Math.PI/2)&&(n+=Math.PI),n}};return n[t]||n.higher},i(u,r),t.exports=u},function(t,e,n){"use strict";var i=n(0),r=n(37);function o(t,e){return(t%e+e)%e}function a(t){var e,n=new RegExp(/\$?\{[xX]\}/),i=new RegExp(/\$?\{[yY]\}/),r=new RegExp(/\$?\{[zZ]\}/),a=new RegExp(/\$?\{(s|S|[sS]:[^{}]+|[^-{}]-[^-{}]|([^,{}]+,)+[^,{}]+)\}/),s=t.replace(a,"{s}").replace(n,"{x}").replace(i,"{y}").replace(r,"{z}"),u=t.match(a);if(u)if(u[2])e=u[1].split(",");else if(":"===u[1][1])e=u[1].substr(2).split("");else if("-"===u[1][1]){e=[];for(var l=u[1].charCodeAt(0),c=u[1].charCodeAt(2),h=Math.min(l,c);h<=Math.max(l,c);h+=1)e.push(String.fromCharCode(h))}return function(t,n,i,r){return s.replace("{s}",function(t,e,n,i){return i[o(t+e+n,i.length)]}(t,n,i,e||r)).replace("{x}",t).replace("{y}",n).replace("{z}",i)}}var s=function t(e){if(!(this instanceof t))return new t(e);r.call(this,e);var i=n(2),s=n(6),u=n(7),l=n(129),c=n(123),h=n(1).adjustLayerForRenderer,d=n(54);if((e=i.extend(!0,{},this.constructor.defaults,e||{})).cacheSize||(e.cacheSize=e.keepLower?600:200),"string"===i.type(e.subdomains)&&(e.subdomains=e.subdomains.split("")),e.baseUrl){var f=e.baseUrl;f&&"/"!==f.charAt(f.length-1)&&(f+="/"),e.url=f+"{z}/{x}/{y}."+(e.imageFormat||"png")}e.originalUrl=e.url,"string"===i.type(e.url)&&(e.url=a(e.url));var p,m=this._init,g=this._exit,v=this.visible,y=[],x=[],b=this;this._options=i.extend(!0,{},e),this.attribution(e.attribution),this._activeTiles={},this._tileTree={},this._cache=l({size:e.cacheSize}),this._queue=c({size:6,track:e.cacheSize,needed:function(t){return t===b.cache.get(t.toString(),!0)}});var _={};return Object.defineProperty(this,"options",{get:function(){return i.extend({},b._options)}}),Object.defineProperty(this,"cache",{get:function(){return b._cache}}),Object.defineProperty(this,"activeTiles",{get:function(){return i.extend({},b._activeTiles)}}),this.tilesAtZoom=function(t){if(b._options.tilesAtZoom)return b._options.tilesAtZoom.call(b,t);var e=Math.pow(2,t);return{x:e,y:e}},this.tilesMaxBounds=function(t){return b._options.tilesMaxBounds?b._options.tilesMaxBounds.call(b,t):null},this.tileCropFromBounds=function(t){if(b._options.tilesMaxBounds){var e=t.index.level,n=b._tileBounds(t);return void 0===x[e]&&(x[e]=b.tilesMaxBounds(e)||null),x[e]&&(n.right>x[e].x||n.bottom>x[e].y)?{x:Math.max(0,Math.min(x[e].x,n.right)-n.left),y:Math.max(0,Math.min(x[e].y,n.bottom)-n.top)}:void 0}},this.isValid=function(t){return b._options.minLevel<=t.level&&t.level<=b._options.maxLevel&&(!!(b._options.wrapX||0<=t.x&&t.x<=b.tilesAtZoom(t.level).x-1)&&!!(b._options.wrapY||0<=t.y&&t.y<=b.tilesAtZoom(t.level).y-1))},this._origin=function(t){var e,n=b.toLevel(b.toLocal(b.map().origin()),t),i=b._options;return{index:e={x:Math.floor(n.x/i.tileWidth),y:Math.floor(n.y/i.tileHeight)},offset:{x:n.x-i.tileWidth*e.x,y:n.y-i.tileHeight*e.y}}},this._tileBounds=function(t){var e=b._origin(t.index.level);return t.bounds(e.index,e.offset)},this.tileAtPoint=function(t,e){var n=b._origin(e),i=b.map();t=b.displayToLevel(i.gcsToDisplay(t,null),e),isNaN(t.x)&&(t.x=0),isNaN(t.y)&&(t.y=0);var r=b._tileOffset(e);return r&&(t.x+=r.x,t.y+=r.y),{x:Math.floor(n.index.x+(n.offset.x+t.x)/b._options.tileWidth),y:Math.floor(n.index.y+(n.offset.y+t.y)/b._options.tileHeight)}},this.gcsTileBounds=function(t,e){var n=t.index?t:d({index:t,size:{x:b._options.tileWidth,y:b._options.tileHeight},url:""}),i=b._tileOffset(n.index.level),r=n.bounds({x:0,y:0},i),o=b.map(),a=o.unitsPerPixel(n.index.level),s=[{x:r.left*a,y:b._topDown()*r.top*a},{x:r.right*a,y:b._topDown()*r.bottom*a}];return(e=null===e?o.gcs():void 0===e?o.ingcs():e)!==o.gcs()&&(s=u.transformCoordinates(o.gcs(),e,s)),{left:s[0].x,top:s[0].y,right:s[1].x,bottom:s[1].y}},this._getTile=function(t,e){var n=e||t;return d({index:t,size:{x:b._options.tileWidth,y:b._options.tileHeight},queue:b._queue,url:b._options.url.call(b,n.x,n.y,n.level||0,b._options.subdomains)})},this._getTileCached=function(t,e,n){var i=b.cache.get(b._tileHash(t));return null===i&&(i=b._getTile(t,e),b.cache.add(i,b.remove,n)),i},this._tileHash=function(t){return[t.level||0,t.y,t.x].join("_")},this._getTileRange=function(t,e){var n=[b.tileAtPoint({x:e.left,y:e.top},t),b.tileAtPoint({x:e.right,y:e.top},t),b.tileAtPoint({x:e.left,y:e.bottom},t),b.tileAtPoint({x:e.right,y:e.bottom},t)];return{start:{x:Math.min(n[0].x,n[1].x,n[2].x,n[3].x),y:Math.min(n[0].y,n[1].y,n[2].y,n[3].y)},end:{x:Math.max(n[0].x,n[1].x,n[2].x,n[3].x),y:Math.max(n[0].y,n[1].y,n[2].y,n[3].y)}}},this._getTiles=function(t,e,n,r){var a,s,u,l,c,h,d,f,p,m,g,v=[],x=!1,_=b._options.keepLower?b._options.minLevel:t;for(t<_&&(t=_),g=_;g<=t&&(c=(d=b._getTileRange(g,e)).start,h=d.end,l=b.tilesAtZoom(g),b._options.wrapX||(c.x=Math.min(Math.max(c.x,0),l.x-1),h.x=Math.min(Math.max(h.x,0),l.x-1),g===_&&b._options.keepLower&&(c.x=0,h.x=l.x-1)),b._options.wrapY||(c.y=Math.min(Math.max(c.y,0),l.y-1),h.y=Math.min(Math.max(h.y,0),l.y-1),g===_&&b._options.keepLower&&(c.y=0,h.y=l.y-1)),!(b._options.gcs&&b._options.gcs!==b.map().gcs()&&g!==_&&(h.x+1-c.x)*(h.y+1-c.y)>b.map().size().width*b.map().size().height/b._options.tileWidth/b._options.tileHeight*16));g+=1)for(a=c.x;a<=h.x;a+=1)for(s=c.y;s<=h.y;s+=1)u={level:g,x:a,y:s},f={level:g,x:a,y:s},b._options.wrapX&&(f.x=o(f.x,l.x)),b._options.wrapY&&(f.y=o(f.y,l.y)),b.isValid(f)&&(r&&v.length<y.length&&(m=y[v.length],x=x||u.level!==m.level||u.x!==m.x||u.y!==m.y),v.push({index:u,source:f}));if(r){if(!x&&v.length===y.length)return;y.splice(0,y.length),i.each(v,function(t,e){y.push(e.index)})}if(n){p={x:(c.x+h.x)/2,y:(c.y+h.y)/2,level:t,bottomLevel:t};for(var w=Math.max(h.x-c.x,h.y-c.y)+1;w>=1;w/=2)p.bottomLevel-=1;v.sort(b._loadMetric(p)),b._queue&&b._queue.batch(!0)}for(b.cache.size<v.length&&(console.log("Increasing cache size to "+v.length),b.cache.size=v.length),a=0;a<v.length;a+=1)v[a]=b._getTileCached(v[a].index,v[a].source,!0);return b.cache.purge(b.remove),v},this.gcs=function(t){if(void 0===t)return b._options.gcs||b.map().gcs();var e=b.gcs();return null===t?delete b._options.gcs:b._options.gcs=t,b.gcs()!==e&&(b.clear(),b.gcsFeatures(b.gcs()),b.modified(),b._update()),b},this.prefetch=function(t,e){var n;return n=b._getTiles(t,e,!0),i.when.apply(i,n.map(function(t){return t.fetch()}))},this._loadMetric=function(t){return function(e,n){var i,r,o,a,s;return e=e.index||e,n=n.index||n,e.level!==n.level?t.bottomLevel&&e.level>=t.bottomLevel!=n.level>=t.bottomLevel?e.level>=t.bottomLevel?-1:1:e.level-n.level:(s=Math.pow(2,e.level-t.level),o=(t.x+.5)*s-.5,a=(t.y+.5)*s-.5,(i=e.x-o)*i+(r=e.y-a)*r-((i=n.x-o)*i+(r=n.y-a)*r))}},this.fromLevel=function(t,e){var n=Math.pow(2,-e);return{x:t.x*n,y:t.y*n}},this.toLevel=function(t,e){var n=Math.pow(2,e);return{x:t.x*n,y:t.y*n}},this.drawTile=function(t){var e=t.toString();b._activeTiles.hasOwnProperty(e)?b._moveToTop(t):b._drawTile(t),b._activeTiles[e]=t},this._drawTile=function(t){if(null!==b.renderer())throw new Error("This draw method is not valid on renderer managed layers.");var e,n=t.index.level,r=i(b._getSubLayer(n)),o=b._tileBounds(t),a=b._options.animationDuration,s=i('<div class="geo-tile-container"/>').attr("tile-reference",t.toString());s.append(t.image),s.css({left:o.left-parseInt(r.attr("offsetx")||0,10)+"px",top:o.top-parseInt(r.attr("offsety")||0,10)+"px"}),(e=b.tileCropFromBounds(t))&&s.addClass("crop").css({width:e.x+"px",height:e.y+"px"}),a>0&&t.fadeIn(a),r.append(s),t.catch(function(){console.warn("Could not load tile at "+t.toString()),b._remove(t)})},this.remove=function(t){var e=t.toString(),n=b._activeTiles[e];return n instanceof d&&b._remove(n),delete b._activeTiles[e],n},this._remove=function(t){t.image&&(t.image.parentElement?i(t.image.parentElement).remove():console.log("No parent element to remove "+t.toString(),t),i(t.image).remove())},this._moveToTop=function(t){i.noop(t)},this._getViewBounds=function(){var t=b.map(),e=t.zoom(),n=b._options.tileRounding(e),i=Math.pow(2,e-n),r=t.size(),o=b.displayToLevel({x:0,y:0}),a=b.displayToLevel({x:r.width,y:0}),s=b.displayToLevel({x:0,y:r.height}),u=b.displayToLevel({x:r.width,y:r.height});return{level:n,scale:i,left:Math.min(o.x,a.x,s.x,u.x),right:Math.max(o.x,a.x,s.x,u.x),top:Math.min(o.y,a.y,s.y,u.y),bottom:Math.max(o.y,a.y,s.y,u.y)}},this._purge=function(t,e,n){var i,r;if(b._updating)return b;for(r in n||(n=b._getViewBounds()),b._activeTiles)i=b._activeTiles[r],b._canPurge(i,n,t,e)&&b.remove(i);return b},this.clear=function(){var t,e=[];for(t in b._activeTiles)e.push(b.remove(t));return b._tileTree={},y=[],e},this.reset=function(){return b.clear(),b._cache.clear(),b},this.toLocal=function(t,e){var n=b.map(),i=n.unitsPerPixel(void 0===e?n.zoom():e);return{x:t.x/i,y:b._topDown()*t.y/i}},this.fromLocal=function(t,e){var n=b.map(),i=n.unitsPerPixel(void 0===e?n.zoom():e);return{x:t.x*i,y:b._topDown()*t.y*i}},this._topDown=function(){return b._options.topDown?1:-1},this._getSubLayer=function(t){if(b.canvas()){var e=b.canvas().find("div[data-tile-layer="+t.toFixed()+"]").get(0);return e||(e=i('<div class=geo-tile-layer data-tile-layer="'+t.toFixed()+'"/>').get(0),b.canvas().append(e)),e}},this._updateSubLayers=function(t,e){var n=b.canvas(),r=parseInt(n.attr("lastlevel"),10),o=parseInt(n.attr("lastoffsetx")||0,10),a=parseInt(n.attr("lastoffsety")||0,10);if(r===t&&Math.abs(o-e.left)<65536&&Math.abs(a-e.top)<65536)return{x:o,y:a};var s=b.map(),u=b._tileOffset(t),l=parseInt((e.left+e.right-s.size().width)/2+u.x,10),c=parseInt((e.top+e.bottom-s.size().height)/2+u.y,10);return n.find(".geo-tile-layer").each(function(e,n){var r=i(n),o=parseInt(r.data("tileLayer"),10);r.css("transform","scale("+Math.pow(2,t-o)+")");var a=parseInt(l/Math.pow(2,t-o),10),s=parseInt(c/Math.pow(2,t-o),10),u=a-parseInt(r.attr("offsetx")||0,10),h=s-parseInt(r.attr("offsety")||0,10);r.attr({offsetx:a,offsety:s}),r.find(".geo-tile-container").each(function(t,e){i(e).css({left:parseInt(i(e).css("left"),10)-u+"px",top:parseInt(i(e).css("top"),10)-h+"px"})})}),n.attr({lastoffsetx:l,lastoffsety:c,lastlevel:t}),{x:l,y:c}},this._update=function(t){if(t&&t.event&&(t.event.event===s.zoom||t.event.event===s.rotate))return b;if(!b.visible())return b;var e,n=b.map(),r=n.bounds(void 0,null),o=n.zoom(),a=b._options.tileRounding(o);if(b._updateSubLayers){var u=b._getViewBounds(),l=b._updateSubLayers(a,u)||{x:0,y:0},c=b._tileOffset(a);if(null===b.renderer()){var h=Math.pow(2,o-a),d=n.rotation(),f=-c.x+-(u.left+u.right)/2+l.x,m=-c.y+-(u.bottom+u.top)/2+l.y,g=f+n.size().width/2,v=m+n.size().height/2;b.canvas().css({"transform-origin":-f+"px "+-m+"px"});var y="translate("+g+"px,"+v+"px)scale("+h+")";d&&(y+="rotate("+180*d/Math.PI+"deg)"),b.canvas().css("transform",y)}b.canvas().attr({scale:Math.pow(2,o-a),dx:-c.x+-(u.left+u.right)/2,dy:-c.y+-(u.bottom+u.top)/2,offsetx:l.x,offsety:l.y,rotation:n.rotation()})}return void 0===(e=b._getTiles(a,r,!0,!0))?b:(b._tileTree={},e.forEach(function(t){t.fetched()?(b.drawTile(t),b._setTileTree(t)):t._queued?(b._queue?b._queue.get(t):-1)>=0&&b._queue.add(t):(t.then(function(){if(!p&&t===b.cache.get(t.toString())){var e=n.zoom(),i=b._options.tileRounding(e),r=b._getViewBounds();b._canPurge(t,r,i)?b.remove(t):(b.drawTile(t),b._setTileTree(t))}}),b.addPromise(t),t._queued=!0)}),i.when.apply(i,e).done(function(){var t=b.map().zoom(),e=b._options.tileRounding(t);b._purge(e,!0)}),b)},this._setTileTree=function(t){if(!b._options.keepLower){var e=t.index;b._tileTree[e.level]=b._tileTree[e.level]||{},b._tileTree[e.level][e.x]=b._tileTree[e.level][e.x]||{},b._tileTree[e.level][e.x][e.y]=t}},this._getTileTree=function(t){return((b._tileTree[t.level]||{})[t.x]||{})[t.y]||null},this._isCovered=function(t){var e=t.index.level,n=t.index.x,i=t.index.y,r=[];return(r=b._getTileTree({level:e-1,x:Math.floor(n/2),y:Math.floor(i/2)}))?[r]:(r=[b._getTileTree({level:e+1,x:2*n,y:2*i}),b._getTileTree({level:e+1,x:2*n+1,y:2*i}),b._getTileTree({level:e+1,x:2*n,y:2*i+1}),b._getTileTree({level:e+1,x:2*n+1,y:2*i+1})]).every(function(t){return null!==t})?r:null},this._outOfBounds=function(t,e){var n=b._tileOffset(t.index.level),i=1;return t.index.level!==e.level&&(i=Math.pow(2,(e.level||0)-(t.index.level||0))),(t.bottom-n.y)*i<e.top||(t.left-n.x)*i>e.right||(t.top-n.y)*i>e.bottom||(t.right-n.x)*i<e.left},this._canPurge=function(t,e,n,i){if(b._options.keepLower){if((n=n||0)<t.index.level&&t.index.level!==b._options.minLevel)return!0;if(t.index.level===b._options.minLevel&&!b._options.wrapX&&!b._options.wrapY)return!1}else if((i||b._isCovered(t))&&n!==t.index.level)return!0;return!!e&&b._outOfBounds(t,e)},this.displayToLevel=function(t,e){var n,i=b.map(),r=i.zoom(),o=b._options.tileRounding(r),a=i.unitsPerPixel(void 0===e?o:e);if(void 0===t){var s=i.size();t={x:s.width/2,y:s.height/2}}try{n=i.displayToGcs(t,b._options.gcs||null)}catch(t){n={x:0,y:0}}return{x:n.x/a,y:b._topDown()*n.y/a}},this.url=function(t){return void 0===t?b._options.originalUrl:t===b._options.originalUrl?b:(b._options.originalUrl=t,"string"===i.type(t)&&(t=a(t)),b._options.url=t,b.reset(),b.map().draw(),b)},this.subdomains=function(t){return void 0===t?b._options.subdomains:(t&&("string"===i.type(t)&&(t=t.indexOf(",")>=0?t.split(","):t.split("")),b._options.subdomains=t,b.reset(),b.map().draw()),b)},this._tileOffset=function(t){return void 0===_[t]&&(_[t]=b._options.tileOffset(t)),_[t]},this.visible=function(t){return void 0===t?v():(b.visible()!==t&&(v(t),t&&b._update()),b)},this._init=function(){var t;if(m.apply(b,arguments),null===b.renderer())for(t=0;t<=b._options.maxLevel;t+=1)b._getSubLayer(t);return b},this._exit=function(){return b.reset(),g.apply(b,arguments),p=!0,b},h("tile",this),this};s.defaults={minLevel:0,maxLevel:18,tileOverlap:{x:0,y:0},tileWidth:256,tileHeight:256,wrapX:!0,wrapY:!1,url:null,subdomains:"abc",tileOffset:function(t){return{x:0,y:0}},tilesMaxBounds:null,topDown:!1,keepLower:!0,tileRounding:Math.round,attribution:"",animationDuration:0},i(s,r),t.exports=s},function(t,e,n){"use strict";var i=n(0),r=n(14),o=n(2),a=function t(e){if(!(this instanceof t))return new t(e);e=e||{},r.call(this,e);var i=n(6),a=this,s=this._exit,u=e.layer,l=null,c=void 0===e.position?{left:0,top:0}:e.position;if(!(void 0===e.parent||e.parent instanceof t))throw new Error("Parent must be of type geo.gui.widget");e.parent&&a.parent(e.parent),this._init=function(){return a.modified(),a},this._exit=function(){if(a.children().forEach(function(t){a.removeChild(t),t._exit()}),a.layer().geoOff(i.pan,a.repositionEvent),a.parentCanvas().removeChild&&a.canvas())try{a.parentCanvas().removeChild(a.canvas())}catch(t){}s()},this.layer=function(){return u||a.parent()&&a.parent().layer()},this._createCanvas=function(){throw new Error("Must be defined in derived classes")},this.canvas=function(t){return void 0===t?l:(l=t,a)},this._appendCanvasToParent=function(){a.parentCanvas().appendChild(a.canvas())},this.parentCanvas=function(){return a.parent()?a.parent().canvas():a.layer().canvas()},this.position=function(t,e){if(void 0!==t){a.layer().geoOff(i.pan,a.repositionEvent);var n={};for(var r in c)c.hasOwnProperty(r)&&(n[r]=null);return(c=t).hasOwnProperty("x")&&c.hasOwnProperty("y")&&a.layer().geoOn(i.pan,a.repositionEvent),a.reposition(o.extend(n,a.position())),a}if(c.hasOwnProperty("x")&&c.hasOwnProperty("y")&&!e){var s=a.layer().map().gcsToDisplay(c);return{left:s.x,top:s.y,right:null,bottom:null}}return c},this.reposition=function(t){if(t=t||a.position(),a.canvas()&&a.canvas().style)for(var e in a.canvas().style.position="absolute",t)t.hasOwnProperty(e)&&(/^\s*(-|\+)?(\d+(\.\d*)?|\d*\.\d+)([eE](-|\+)?\d+)?\s*$/.test(t[e])?a.canvas().style[e]=parseFloat(parseFloat(t[e]).toFixed(3))+"px":a.canvas().style[e]=t[e]);return a},this.repositionEvent=function(){return a.reposition()},this.isInViewport=function(){var t=a.position(),e=a.layer();return t.left>=0&&t.top>=0&&t.left<=e.width()&&t.top<=e.height()},c.hasOwnProperty("x")&&c.hasOwnProperty("y")&&this.layer().geoOn(i.pan,a.repositionEvent)};i(a,r),t.exports=a},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(6),a=n(41),s=n(7),u=n(4),l=n(1).registerAnnotation,c=n(24),h=n(26),d=n(50),f=n(27),p=0,m={create:"create",done:"done",highlight:"highlight",edit:"edit"},g="annotationAction",v={fill:!0,fillColor:function(t){return t.selected?{r:0,g:1,b:1}:{r:.3,g:.3,b:.3}},fillOpacity:function(t){return t.selected?.5:.25},radius:function(t){return"edge"===t.type||"rotate"===t.type?8:10},scaled:!1,stroke:!0,strokeColor:{r:0,g:0,b:1},strokeOpacity:1,strokeWidth:function(t){return"edge"===t.type||"rotate"===t.type?2:3},rotateHandleOffset:24,rotateHandleRotation:-Math.PI/4,resizeHandleOffset:48,resizeHandleRotation:-Math.PI/4,handles:{vertex:!0,edge:!0,center:!0,rotate:!0,resize:!0}},y=function t(e,n){if(!(this instanceof t))return new t(e,n);var r=this,l=i.extend({},{showLabel:!0},n||{}),c=l.annotationId;delete l.annotationId,void 0===c||l.layer&&l.layer.annotationById(c)?(p+=1,void 0!==c&&console.warn("Annotation id "+c+" is in use; using "+p+" instead."),c=p):c>p&&(p=c);var h=l.name||e.charAt(0).toUpperCase()+e.substr(1)+" "+c,d=l.label||null,y=l.description||void 0,x=e,b=l.layer,_=l.state||m.done;delete l.state,delete l.layer,delete l.name,delete l.label,delete l.description,this._exit=function(){},this.id=function(){return c},this.name=function(t){return void 0===t?h:(null!==t&&(""+t).trim()&&(t=(""+t).trim())!==h&&(h=t,r.modified()),r)},this.label=function(t,e){return void 0===t?null!==d||e?d:h:(t!==d&&(d=t,r.modified()),r)},this._labelPosition=function(){return u.centerFromPerimeter(r._coordinates())},this._rotateHandlePosition=function(t,e){var n,i,o,a=r.layer().map(),s=r._coordinates(),l=u.centerFromPerimeter(r._coordinates()),c=l?a.gcsToDisplay(l,null):void 0,h=0;if(l){for(t=t||0,e=e||0,n=0;n<s.length;n+=1)i=a.gcsToDisplay(s[n],null),h=Math.max(h,Math.pow(i.x-c.x,2)+Math.pow(i.y-c.y,2));return o=Math.sqrt(h)+t,i=a.displayToGcs({x:c.x+o*Math.cos(e),y:c.y-o*Math.sin(e)},null)}},this.labelRecord=function(){var t=r.options("showLabel");if(t){var e=r.state();if(!(!0===t&&e===m.create||!0!==t&&t.indexOf(e)<0)){var n=r.labelStyle(),i={text:r.label(),position:r._labelPosition()};if(i.position)return n&&(i.style=n),i}}},this.description=function(t){return void 0===t?y:(t!==y&&(y=t,r.modified()),r)},this.layer=function(t){return void 0===t?b:(b=t,r)},this.state=function(t){return void 0===t?_:(_!==t&&(_=t,r.layer()&&r.layer().geoTrigger(o.annotation.state,{annotation:r})),r)},this.actions=function(t){switch(t||(t=r.state()),t){case m.edit:return[{action:a.annotation_edit_handle,name:"annotation edit",owner:g,input:"left"},{action:a.annotation_edit_handle,name:"annotation edit",owner:g,input:"pan"}];default:return[]}},this.processAction=function(){},this.processEditAction=function(t){if(t&&r._editHandle&&r._editHandle.handle)switch(r._editHandle.handle.type){case"vertex":return r._processEditActionVertex(t);case"edge":return r._processEditActionEdge(t);case"center":return r._processEditActionCenter(t);case"rotate":return r._processEditActionRotate(t);case"resize":return r._processEditActionResize(t)}},this.selectEditHandle=function(t,e){e&&r._editHandle&&r._editHandle.handle&&r._editHandle.handle.selected&&(r._editHandle.handle.selected=!1),t.selected=e;var n=(r._editHandle||{}).amountRotated||0;return r._editHandle={handle:t,startCoordinates:r._coordinates().slice(),center:u.centerFromPerimeter(r._coordinates()),rotatePosition:r._rotateHandlePosition(t.style.rotateHandleOffset,t.style.rotateHandleRotation+n),startAmountRotated:n,amountRotated:n,resizePosition:r._rotateHandlePosition(t.style.resizeHandleOffset,t.style.resizeHandleRotation)},r.layer()&&r.layer().geoTrigger(o.annotation.select_edit_handle,{annotation:r,handle:r._editHandle,enable:e}),r},this.options=function(t,e){if(void 0===t)return l;if("string"==typeof t&&void 0===e)return l[t];var n;if(void 0===e?(n=void 0!==t[r._coordinateOption],l=i.extend(!0,l,t),["style","createStyle","editStyle","editHandleStyle","labelStyle","highlightStyle"].forEach(function(e){void 0!==t[e]&&i.extend(l[e],t[e])})):(n=t===r._coordinateOption,l[t]=e),l.coordinates){var a=l.coordinates;delete l.coordinates,r._coordinates(a)}if(void 0!==l.name){var s=l.name;delete l.name,r.name(s)}if(void 0!==l.label){var u=l.label;delete l.label,r.label(u)}if(void 0!==l.description){var c=l.description;delete l.description,r.description(c)}return r.modified(),n&&r.layer()&&r.layer().geoTrigger(o.annotation.coordinates,{annotation:r}),r},this.style=function(t,e,n){return n=n||"style",void 0===t?l[n]:"string"==typeof t&&void 0===e?(l[n]||{})[t]:(void 0===l[n]&&(l[n]={}),void 0===e?l[n]=i.extend(!0,l[n],t):l[n][t]=e,r.modified(),r)},["createStyle","editStyle","editHandleStyle","labelStyle","highlightStyle"].forEach(function(t){r[t]=function(e,n){return r.style(e,n,t)}}),this.styleForState=function(t){return(t=t||r.state())===m.edit||t===m.highlight?i.extend({},l.style,l[t+"Style"]):t===m.create?i.extend({},l.style,l.editStyle,l[t+"Style"]):l[t+"Style"]||l.style||{}},this.type=function(){return x},this.features=function(){return[]},this.mouseClick=function(t){},this.mouseClickEdit=function(t){},this.mouseMove=function(t){},this._coordinates=function(t){return[]},this._coordinateOption="vertices",this.coordinates=function(t){var e=r._coordinates()||[];if(r.layer()){var n=r.layer().map();(t=null===t?n.gcs():void 0===t?n.ingcs():t)!==n.gcs()&&(e=s.transformCoordinates(n.gcs(),t,e))}return e},this.modified=function(){return r.layer()&&r.layer().modified(),r},this.draw=function(){return r.layer()&&(r.layer()._update(),r.layer().draw()),r},this._geojsonStyles=function(){return["closed","fill","fillColor","fillOpacity","lineCap","lineJoin","radius","stroke","strokeColor","strokeOffset","strokeOpacity","strokeWidth"]},this._geojsonCoordinates=function(t){return[]},this._geojsonGeometryType=function(){return""},this.geojson=function(t,e){var n,i,o,a=r._geojsonCoordinates(t),s=r._geojsonGeometryType(),l=r._geojsonStyles(),c=r.options("style")||{},h=r.labelStyle()||{};if(a&&a.length&&s){var p={type:"Feature",geometry:{type:s,coordinates:a},properties:{annotationType:x,name:r.name(),annotationId:r.id()}};for(d&&(p.properties.label=d),y&&(p.properties.description=y),!1===r.options("showLabel")&&(p.properties.showLabel=r.options("showLabel")),n=0;n<l.length;n+=1)i=l[n],void 0!==(o=u.ensureFunction(c[i])())&&(i.toLowerCase().match(/color$/)&&(o=u.convertColorToHex(o,"needed")),p.properties[i]=o);for(n=0;n<f.usedStyles.length;n+=1)i=f.usedStyles[n],void 0!==(o=u.ensureFunction(h[i])())&&(i.toLowerCase().match(/color$/)&&(o=u.convertColorToHex(o,"needed")),p.properties["label"+i.charAt(0).toUpperCase()+i.slice(1)]=o);if(e){var m=r.layer().map();t=null===t?m.gcs():void 0===t?m.ingcs():t,p.crs={type:"name",properties:{type:"proj4",name:t}}}return p}},this._addEditHandles=function(t,e,n,o){var a,s=i.extend({},v,r.editHandleStyle()),l=u.ensureFunction(s.handles)()||{},c=r._editHandle&&r._editHandle.handle&&r._editHandle.handle.selected?r._editHandle.handle:void 0;n=i.extend({},n),Object.keys(l).forEach(function(t){!1===l[t]&&(n[t]=!1)}),t[3]||(t[3]={point:[]}),a=t[3].point,e.forEach(function(t,r){!1!==n.vertex&&a.push(i.extend({},t,{type:"vertex",index:r,style:s,editHandle:!0})),!1===n.edge||r===e.length-1||t.x===e[r+1].x&&t.y===e[r+1].y||a.push(i.extend({x:(t.x+e[r+1].x)/2,y:(t.y+e[r+1].y)/2},{type:"edge",index:r,style:s,editHandle:!0})),!1===n.edge||o||r!==e.length-1||t.x===e[0].x&&t.y===e[0].y||a.push(i.extend({x:(t.x+e[0].x)/2,y:(t.y+e[0].y)/2},{type:"edge",index:r,style:s,editHandle:!0}))}),!1!==n.center&&a.push(i.extend({},u.centerFromPerimeter(r._coordinates()),{type:"center",style:s,editHandle:!0})),!1!==n.rotate&&(a.push(i.extend(r._rotateHandlePosition(s.rotateHandleOffset,s.rotateHandleRotation+(c&&"rotate"===c.type?r._editHandle.amountRotated:0)),{type:"rotate",style:s,editHandle:!0})),!r._editHandle||c&&"rotate"===c.type||(r._editHandle.amountRotated=0)),!1!==n.resize&&a.push(i.extend(r._rotateHandlePosition(s.resizeHandleOffset,s.resizeHandleRotation),{type:"resize",style:s,editHandle:!0})),c&&a.forEach(function(t){t.type===c.type&&t.index===c.index&&(t.selected=!0)})},this._processEditActionCenter=function(t){var e=r._editHandle.startCoordinates,n=t.mouse.mapgcs.x-t.state.origin.mapgcs.x,i=t.mouse.mapgcs.y-t.state.origin.mapgcs.y,o=r._coordinates(),a=e.map(function(t){return{x:t.x+n,y:t.y+i}});return(a[0].x!==o[0].x||a[0].y!==o[0].y)&&(r._coordinates(a),!0)},this._processEditActionRotate=function(t){var e=r._editHandle,n=e.startCoordinates,i=t.mouse.mapgcs.x-t.state.origin.mapgcs.x,o=t.mouse.mapgcs.y-t.state.origin.mapgcs.y,a=Math.atan2(e.rotatePosition.y-e.center.y,e.rotatePosition.x-e.center.x),s=Math.atan2(e.rotatePosition.y+o-e.center.y,e.rotatePosition.x+i-e.center.x)-a,u=r._coordinates(),l=n.map(function(t){var n=t.x-e.center.x,i=t.y-e.center.y;return{x:n*Math.cos(s)-i*Math.sin(s)+e.center.x,y:n*Math.sin(s)+i*Math.cos(s)+e.center.y}});return(l[0].x!==u[0].x||l[0].y!==u[0].y)&&(r._coordinates(l),e.amountRotated=e.startAmountRotated+s,!0)},this._processEditActionResize=function(t){var e=r._editHandle,n=e.startCoordinates,i=t.mouse.mapgcs.x-t.state.origin.mapgcs.x,o=t.mouse.mapgcs.y-t.state.origin.mapgcs.y,a=r.layer().map(),s=a.gcsToDisplay(e.center,null),u=a.gcsToDisplay(e.resizePosition,null),l=a.gcsToDisplay({x:e.resizePosition.x+i,y:e.resizePosition.y+o},null),c=Math.pow(Math.pow(u.y-s.y,2)+Math.pow(u.x-s.x,2),.5)-e.handle.style.resizeHandleOffset,h=Math.pow(Math.pow(l.y-s.y,2)+Math.pow(l.x-s.x,2),.5)-e.handle.style.resizeHandleOffset,d=r._coordinates();if(h&&c){var f=h/c,p=n.map(function(t){return{x:(t.x-e.center.x)*f+e.center.x,y:(t.y-e.center.y)*f+e.center.y}});if(p[0].x!==d[0].x||p[0].y!==d[0].y)return r._coordinates(p),!0}return!1},this._processEditActionEdge=function(t){var e=r._editHandle,n=e.handle.index,i=r._coordinates();return i.splice(n+1,0,{x:e.handle.x,y:e.handle.y}),e.handle.type="vertex",e.handle.index+=1,e.startCoordinates=i.slice(),r.modified(),!0},this._processEditActionVertex=function(t,e){var n,i,a=r._editHandle,s=a.handle.index,u=a.startCoordinates,l=r._coordinates(),c=l.length,h=l[s],d=t.mouse.mapgcs.x-t.state.origin.mapgcs.x,f=t.mouse.mapgcs.y-t.state.origin.mapgcs.y,p=r.layer(),m=p.options("adjacentPointProximity");return l[s]={x:u[s].x+d,y:u[s].y+f},p.displayDistance(l[s],null,u[s],null)<=m||(p.displayDistance(l[s],null,l[(s+1)%l.length],null)<=m?n=(s+1)%l.length:p.displayDistance(l[s],null,l[(s+l.length-1)%l.length],null)<=m&&(n=(s+l.length-1)%l.length)),i=0===n&&s===l.length-1||n===l.length-1&&0===s,!1===e&&i&&(n=void 0),void 0!==n&&l.length>(e||r.options("style").closed?3:2)&&(l[s]={x:l[n].x,y:l[n].y},t.event===o.actionup&&(e&&i&&(r.options("style").closed=!0),l.splice(s,1))),(l.length!==c||l[s].x!==h.x||l[s].y!==h.y)&&(r._coordinates(l),!0)}};function x(t,e,n,i,r){switch(n||(n=t.state()),n){case m.create:return[{action:a["annotation_"+i],name:i+" create",owner:g,input:"left",modifiers:{shift:!1,ctrl:!1}},{action:a["annotation_"+i],name:i+" create",owner:g,input:"pan"}];default:return e.apply(t,r)}}function b(t,e,n){var i=t.layer();if(t.state()===m.create&&i&&e.state.action===a["annotation_"+n]){var r=i.options("continuousPointProximity"),o=i.options("continuousPointColinearity");if(r||0===r){var s=t.options("vertices");if(!s.length)return s.push(e.mouse.mapgcs),s.push(e.mouse.mapgcs),!0;var u=i.displayDistance(s[s.length-2],null,e.mouse.map,"display");if(u&&u>r){if(s.length>=(t._lastClickVertexCount||1)+3){var l=i.displayDistance(s[s.length-3],null,s[s.length-2],null),c=u,h=i.displayDistance(s[s.length-3],null,e.mouse.map,"display");if(l&&h)(h*h-l*l-c*c)/(2*l*c)>Math.cos(o)&&s.pop()}return s[s.length-1]=e.mouse.mapgcs,s.push(e.mouse.mapgcs),!0}}}}var _=function t(e){if(!(this instanceof t))return new t(e);(e=i.extend(!0,{},{style:{fill:!0,fillColor:{r:0,g:1,b:0},fillOpacity:.25,polygon:function(t){return t.polygon},stroke:!0,strokeColor:{r:0,g:0,b:0},strokeOpacity:1,strokeWidth:3,uniformPolygon:!0},highlightStyle:{fillColor:{r:0,g:1,b:1},fillOpacity:.5,strokeWidth:5},createStyle:{fillColor:{r:.3,g:.3,b:.3},fillOpacity:.25,strokeColor:{r:0,g:0,b:1}}},e||{})).corners=e.corners||e.coordinates||[],delete e.coordinates,y.call(this,"rectangle",e);var n=this,r=this.actions,s=this.processEditAction;this.actions=function(t){switch(t||(t=n.state()),t){case m.create:return[{action:a.annotation_rectangle,name:"rectangle create",owner:g,input:"left",modifiers:{shift:!1,ctrl:!1},selectionRectangle:!0}];default:return r.apply(n,arguments)}},this.processAction=function(t){var e=n.layer();if(n.state()===m.create&&e&&t.event===o.actionselection&&t.state.action===a.annotation_rectangle){var i=e.map(),r=[i.displayToGcs({x:t.lowerLeft.x,y:t.lowerLeft.y},null),i.displayToGcs({x:t.lowerLeft.x,y:t.upperRight.y},null),i.displayToGcs({x:t.upperRight.x,y:t.upperRight.y},null),i.displayToGcs({x:t.upperRight.x,y:t.lowerLeft.y},null)];return e.displayDistance(r[0],null,r[1],null)*e.displayDistance(r[0],null,r[3],null)<.01?"remove":(n.options("corners",r),n.state(m.done),"done")}},this.features=function(){var t,e=n.options(),i=n.state();switch(i){case m.create:t=[],e.corners&&e.corners.length>=4&&(t=[{polygon:{polygon:e.corners,style:n.styleForState(i)}}]);break;default:t=[{polygon:{polygon:e.corners,style:n.styleForState(i)}}],i===m.edit&&n._addEditHandles(t,e.corners)}return t},this._coordinates=function(t){return t&&t.length>=4&&n.options("corners",t.slice(0,4)),n.options("corners")},this._coordinateOption="corners",this._geojsonCoordinates=function(t){var e=n.coordinates(t);if(e&&n.state()!==m.create&&!(e.length<4)){for(var i=[],r=0;r<4;r+=1)i.push([e[r].x,e[r].y]);return i.push([e[0].x,e[0].y]),[i]}},this._geojsonGeometryType=function(){return"Polygon"},this._geojsonStyles=function(){return["fill","fillColor","fillOpacity","lineCap","lineJoin","stroke","strokeColor","strokeOffset","strokeOpacity","strokeWidth"]},this._setCornersFromMouse=function(t,e){var r=n.layer().map(),o=r.gcsToDisplay({x:t[0].x,y:t[0].y},null),a=r.gcsToDisplay(e.mapgcs,null),s={x:a.x,y:o.y},u={x:o.x,y:a.y};t[2]=i.extend({},e.mapgcs),t[1]=r.displayToGcs(s,null),t[3]=r.displayToGcs(u,null)},this.mouseMove=function(t){if(n.state()===m.create){var e=n.options("corners");return e.length?(n._setCornersFromMouse(e,t),!0):void 0}},this.mouseClick=function(t){var e=n.layer();if(n.state()===m.create&&e&&(t.buttonsDown.left||t.buttonsDown.right)){var r=n.options("corners");if(!t.buttonsDown.right||r.length)return t.handled=!0,r.length?(n._setCornersFromMouse(r,t),e.displayDistance(r[0],null,r[1],null)*e.displayDistance(r[0],null,r[3],null)<.01?"remove":(n.state(m.done),"done")):t.buttonsDown.left?(r.push(i.extend({},t.mapgcs)),r.push(i.extend({},t.mapgcs)),r.push(i.extend({},t.mapgcs)),r.push(i.extend({},t.mapgcs)),!0):void 0}},this.processEditAction=function(t){var e,i,r,o,a,u=n._editHandle.startCoordinates,l={x:t.mouse.mapgcs.x-t.state.origin.mapgcs.x,y:t.mouse.mapgcs.y-t.state.origin.mapgcs.y},c=n._editHandle.handle.type,h=n._editHandle.handle.index,d=[Math.atan2(u[1].y-u[0].y,u[1].x-u[0].x),Math.atan2(u[2].y-u[1].y,u[2].x-u[1].x),Math.atan2(u[3].y-u[2].y,u[3].x-u[2].x),Math.atan2(u[0].y-u[3].y,u[0].x-u[3].x)];switch(d[0]||d[1]||d[2]||d[3]||(d[1]=Math.PI/2,d[2]=Math.PI,d[3]=-Math.PI/2),d[0]||d[2]||(d[0]=d[1]-Math.PI/2,d[2]=d[1]+Math.PI/2),d[1]||d[3]||(d[1]=d[2]-Math.PI/2,d[3]=d[2]+Math.PI/2),c){case"vertex":return e=u.map(function(t){return{x:t.x,y:t.y}}),o=d[(h+1)%4],i={x:(l.x*Math.cos(o)+l.y*Math.sin(o))*Math.cos(o),y:(l.y*Math.sin(o)+l.x*Math.cos(o))*Math.sin(o)},a=d[h],r={x:(l.x*Math.cos(a)+l.y*Math.sin(a))*Math.cos(a),y:(l.y*Math.sin(a)+l.x*Math.cos(a))*Math.sin(a)},e[h].x+=l.x,e[h].y+=l.y,e[(h+1)%4].x+=i.x,e[(h+1)%4].y+=i.y,e[(h+3)%4].x+=r.x,e[(h+3)%4].y+=r.y,n.options("corners",e),!0;case"edge":return e=u.map(function(t){return{x:t.x,y:t.y}}),o=d[(h+1)%4],l={x:(l.x*Math.cos(o)+l.y*Math.sin(o))*Math.cos(o),y:(l.y*Math.sin(o)+l.x*Math.cos(o))*Math.sin(o)},e[h].x+=l.x,e[h].y+=l.y,e[(h+1)%4].x+=l.x,e[(h+1)%4].y+=l.y,n.options("corners",e),!0}return s.apply(n,arguments)}};r(_,y);var w={};w[d.capabilities.feature]=!0,l("rectangle",_,w);var M=function t(e){if(!(this instanceof t))return new t(e);(e=i.extend(!0,{},{style:{fill:!0,fillColor:{r:0,g:1,b:0},fillOpacity:.25,polygon:function(t){return t.polygon},stroke:!0,strokeColor:{r:0,g:0,b:0},strokeOpacity:1,strokeWidth:3,uniformPolygon:!0},highlightStyle:{fillColor:{r:0,g:1,b:1},fillOpacity:.5,strokeWidth:5},createStyle:{closed:!1,fillColor:{r:.3,g:.3,b:.3},fillOpacity:.25,line:function(t){return Array.apply(null,Array(n.options("vertices").length)).map(function(){return t})},position:function(t,e){return n.options("vertices")[e]},stroke:!1,strokeColor:{r:0,g:0,b:1}}},e||{})).vertices=e.vertices||e.coordinates||[],delete e.coordinates,y.call(this,"polygon",e);var n=this,r=this.actions;this.features=function(){var t,e=n.options(),i=n.state(),r=n.styleForState(i);switch(i){case m.create:t=[],e.vertices&&e.vertices.length>=3&&(t[1]={polygon:{polygon:e.vertices,style:r}}),e.vertices&&e.vertices.length>=2&&(t[2]={line:{line:e.vertices,style:r}});break;default:t=[{polygon:{polygon:e.vertices,style:r}}],i===m.edit&&n._addEditHandles(t,e.vertices)}return t},this._coordinates=function(t){return t&&n.options("vertices",t),n.options("vertices")},this.mouseMove=function(t){if(n.state()===m.create){var e=n.options("vertices");return e.length?(e[e.length-1]=t.mapgcs,!0):void 0}},this.mouseClick=function(t){var e=n.layer();if(n.state()===m.create&&e){var i,r=!!t.buttonsDown.right;if(t.buttonsDown.left||t.buttonsDown.right){var o=n.options("vertices");if(!t.buttonsDown.right||o.length)return t.handled=!0,t.buttonsDown.left&&(o.length?o.length>=2&&e.displayDistance(o[o.length-2],null,t.map,"display")<=e.options("adjacentPointProximity")?(i=!0,n._lastClick&&t.time-n._lastClick<e.options("dblClickTime")&&(r=!0)):o.length>=2&&e.displayDistance(o[0],null,t.map,"display")<=e.options("finalPointProximity")?r=!0:o[o.length-1]=t.mapgcs:o.push(t.mapgcs),r||i||o.push(t.mapgcs),n._lastClick=t.time,n._lastClickVertexCount=o.length),r?o.length<4?"remove":(o.pop(),n.state(m.done),"done"):!i}}},this.actions=function(t){return x(n,r,t,"polygon",arguments)},this.processAction=function(t){return b(n,t,"polygon")},this._geojsonCoordinates=function(t){var e=n.coordinates(t);if(e&&!(e.length<3)&&n.state()!==m.create){for(var i=[],r=0;r<e.length;r+=1)i.push([e[r].x,e[r].y]);return i.push([e[0].x,e[0].y]),[i]}},this._geojsonGeometryType=function(){return"Polygon"},this._geojsonStyles=function(){return["fill","fillColor","fillOpacity","lineCap","lineJoin","stroke","strokeColor","strokeOffset","strokeOpacity","strokeWidth"]}};r(M,y);var A={};A[d.capabilities.feature]=!0,A[c.capabilities.basic]=[m.create],l("polygon",M,A);var T=function t(e){if(!(this instanceof t))return new t(e);(e=i.extend(!0,{},{style:{line:function(t){return Array.apply(null,Array(n.options("vertices").length)).map(function(){return t})},position:function(t,e){return n.options("vertices")[e]},strokeColor:{r:0,g:0,b:0},strokeOpacity:1,strokeWidth:3,closed:!1,lineCap:"butt",lineJoin:"miter"},highlightStyle:{strokeWidth:5},createStyle:{line:function(t){return Array.apply(null,Array(n.options("vertices").length)).map(function(){return t})},position:function(t,e){return n.options("vertices")[e]},strokeColor:{r:0,g:0,b:1},strokeOpacity:1,strokeWidth:3,closed:!1,lineCap:"butt",lineJoin:"miter"}},e||{})).vertices=e.vertices||e.coordinates||[],delete e.coordinates,y.call(this,"line",e);var n=this,r=this.actions,o=this.processEditAction;this.features=function(){var t,e=n.options(),i=n.state();switch(i){case m.create:t=[{line:{line:e.vertices,style:n.styleForState(i)}}];break;default:t=[{line:{line:e.vertices,style:n.styleForState(i)}}],i===m.edit&&n._addEditHandles(t,e.vertices,void 0,!n.style("closed"))}return t},this._coordinates=function(t){return t&&n.options("vertices",t),n.options("vertices")},this.mouseMove=function(t){if(n.state()===m.create){var e=n.options("vertices");return e.length?(e[e.length-1]=t.mapgcs,!0):void 0}},this.mouseClick=function(t){var e=n.layer();if(n.state()===m.create&&e){var i,r=!!t.buttonsDown.right;if(t.buttonsDown.left||t.buttonsDown.right){var o=n.options("vertices");if(!t.buttonsDown.right||o.length)return t.handled=!0,t.buttonsDown.left&&(o.length?o.length>=2&&e.displayDistance(o[o.length-2],null,t.map,"display")<=e.options("adjacentPointProximity")?(i=!0,n._lastClick&&t.time-n._lastClick<e.options("dblClickTime")&&(r=!0)):o.length>=2&&e.displayDistance(o[0],null,t.map,"display")<=e.options("finalPointProximity")?r="close":o[o.length-1]=t.mapgcs:o.push(t.mapgcs),r||i||o.push(t.mapgcs),n._lastClick=t.time,n._lastClickVertexCount=o.length),r?o.length<3?"remove":(o.pop(),n.options("style").closed="close"===r,n.state(m.done),"done"):!i}}},this.actions=function(t){return x(n,r,t,"line",arguments)},this.processAction=function(t){return b(n,t,"line")},this._geojsonCoordinates=function(t){var e=n.coordinates(t);if(e&&!(e.length<2)&&n.state()!==m.create){for(var i=[],r=0;r<e.length;r+=1)i.push([e[r].x,e[r].y]);return i}},this._geojsonGeometryType=function(){return"LineString"},this._geojsonStyles=function(){return["closed","lineCap","lineJoin","strokeColor","strokeOffset","strokeOpacity","strokeWidth"]},this.processEditAction=function(t){switch(n._editHandle.handle.type){case"vertex":return n._processEditActionVertex(t,!0)}return o.apply(n,arguments)},this.mouseClickEdit=function(t){var e,i=n.layer(),r=n._editHandle;if(n.state()===m.edit&&i&&t.buttonsDown.left&&r&&r.handle.selected&&"edge"===r.handle.type&&n.options("style").closed&&(t.handled=!0,n._lastClick&&t.time-n._lastClick<i.options("dblClickTime")&&(e=!0),n._lastClick=t.time,e)){var o=r.handle.index,a=n._coordinates(),s=a.slice(o+1).concat(a.slice(0,o+1));return n._coordinates(s),n.options("style").closed=!1,r.handle.index=void 0,!0}}};r(T,y);var C={};C[c.capabilities.basic]=[m.create],l("line",T,C);var E=function t(e){if(!(this instanceof t))return new t(e);(e=i.extend(!0,{},{style:{fill:!0,fillColor:{r:0,g:1,b:0},fillOpacity:.25,radius:10,scaled:!1,stroke:!0,strokeColor:{r:0,g:0,b:0},strokeOpacity:1,strokeWidth:3},createStyle:{fillColor:{r:.3,g:.3,b:.3},fillOpacity:.25,strokeColor:{r:0,g:0,b:1}},highlightStyle:{fillColor:{r:0,g:1,b:1},fillOpacity:.5,strokeWidth:5}},e||{})).position=e.position||(e.coordinates?e.coordinates[0]:void 0),delete e.coordinates,y.call(this,"point",e);var n=this;this.features=function(){var t,e,r,o=n.options(),a=n.state();switch(a){case m.create:t=[];break;default:e=n.styleForState(a),(o.style.scaled||0===o.style.scaled)&&(!0===o.style.scaled&&(o.style.scaled=n.layer().map().zoom()),e=i.extend({},e,{radius:function(){var t=o.style.radius,e=n.layer().map().zoom();return u.isFunction(t)&&(t=t.apply(n,arguments)),t*=Math.pow(2,e-o.style.scaled),t}}),r=!0),t=[{point:{x:o.position.x,y:o.position.y,style:e,scaleOnZoom:r}}],a===m.edit&&n._addEditHandles(t,[o.position],{edge:!1,center:!1,resize:!1,rotate:!1})}return t},this._coordinates=function(t){return t&&t.length>=1&&n.options("position",t[0]),n.state()===m.create?[]:[n.options("position")]},this._coordinateOption="position",this.mouseClick=function(t){if(n.state()===m.create&&t.buttonsDown.left)return t.handled=!0,n.options("position",t.mapgcs),n.state(m.done),"done"},this._geojsonStyles=function(){return["fill","fillColor","fillOpacity","radius","scaled","stroke","strokeColor","strokeOpacity","strokeWidth"]},this._geojsonCoordinates=function(t){var e=n.coordinates(t);if(e&&n.state()!==m.create&&!(e.length<1)&&void 0!==e[0])return[e[0].x,e[0].y]},this._geojsonGeometryType=function(){return"Point"}};r(E,y);var O={};O[h.capabilities.feature]=!0,l("point",E,O),t.exports={state:m,actionOwner:g,annotation:y,lineAnnotation:T,pointAnnotation:E,polygonAnnotation:M,rectangleAnnotation:_,_editHandleFeatureLevel:3,defaultEditHandleStyle:v}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(139),r=n(42),o=n(156),a=n(66),s=n(60),u=n(65),l=n(67),c=n(157),h=n(159);i.a.defaultDatum="WGS84",i.a.Proj=r.a,i.a.WGS84=new i.a.Proj("WGS84"),i.a.Point=o.a,i.a.toPoint=a.a,i.a.defs=s.a,i.a.transform=u.a,i.a.mgrs=l.a,i.a.version=c.a,Object(h.a)(i.a),e.default=i.a},function(t,e,n){"use strict";var i=n(141),r=n(61),o=n(62);function a(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"==typeof n?"+"===n.charAt(0)?a[t]=Object(r.a)(arguments[1]):a[t]=Object(o.a)(arguments[1]):a[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?a.apply(e,t):a(t)});if("string"==typeof t){if(t in a)return a[t]}else"EPSG"in t?a["EPSG:"+t.EPSG]=t:"ESRI"in t?a["ESRI:"+t.ESRI]=t:"IAU2000"in t?a["IAU2000:"+t.IAU2000]=t:console.log(t);return}}Object(i.a)(a),e.a=a},function(t,e,n){"use strict";var i=n(3),r=n(142),o=n(143),a=n(28);e.a=function(t){var e,n,s,u={},l=t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).reduce(function(t,e){var n=e.split("=");return n.push(!0),t[n[0].toLowerCase()]=n[1],t},{}),c={proj:"projName",datum:"datumCode",rf:function(t){u.rf=parseFloat(t)},lat_0:function(t){u.lat0=t*i.a},lat_1:function(t){u.lat1=t*i.a},lat_2:function(t){u.lat2=t*i.a},lat_ts:function(t){u.lat_ts=t*i.a},lon_0:function(t){u.long0=t*i.a},lon_1:function(t){u.long1=t*i.a},lon_2:function(t){u.long2=t*i.a},alpha:function(t){u.alpha=parseFloat(t)*i.a},lonc:function(t){u.longc=t*i.a},x_0:function(t){u.x0=parseFloat(t)},y_0:function(t){u.y0=parseFloat(t)},k_0:function(t){u.k0=parseFloat(t)},k:function(t){u.k0=parseFloat(t)},a:function(t){u.a=parseFloat(t)},b:function(t){u.b=parseFloat(t)},r_a:function(){u.R_A=!0},zone:function(t){u.zone=parseInt(t,10)},south:function(){u.utmSouth=!0},towgs84:function(t){u.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){u.to_meter=parseFloat(t)},units:function(t){u.units=t;var e=Object(a.a)(o.a,t);e&&(u.to_meter=e.to_meter)},from_greenwich:function(t){u.from_greenwich=t*i.a},pm:function(t){var e=Object(a.a)(r.a,t);u.from_greenwich=(e||parseFloat(t))*i.a},nadgrids:function(t){"@null"===t?u.datumCode="none":u.nadgrids=t},axis:function(t){3===t.length&&-1!=="ewnsud".indexOf(t.substr(0,1))&&-1!=="ewnsud".indexOf(t.substr(1,1))&&-1!=="ewnsud".indexOf(t.substr(2,1))&&(u.axis=t)}};for(e in l)n=l[e],e in c?"function"==typeof(s=c[e])?s(n):u[s]=n:u[e]=n;return"string"==typeof u.datumCode&&"WGS84"!==u.datumCode&&(u.datumCode=u.datumCode.toLowerCase()),u}},function(t,e,n){"use strict";var i=n(144),r=n(145),o=.017453292519943295;function a(t){return t*o}e.a=function(t){var e=Object(i.a)(t),n=e.shift(),o=e.shift();e.unshift(["name",o]),e.unshift(["type",n]);var s={};return Object(r.a)(e,s),function(t){"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):"object"==typeof t.PROJECTION?t.projName=Object.keys(t.PROJECTION)[0]:t.projName=t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&("GEOGCS"===t.type?t.DATUM&&t.DATUM.SPHEROID&&(t.to_meter=t.UNIT.convert*t.DATUM.SPHEROID.a):t.to_meter=t.UNIT.convert));var e=t.GEOGCS;function n(e){return e*(t.to_meter||1)}"GEOGCS"===t.type&&(e=t),e&&(e.DATUM?t.datumCode=e.DATUM.name.toLowerCase():t.datumCode=e.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==t.datumCode&&"new_zealand_1949"!==t.datumCode||(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),e.DATUM&&e.DATUM.SPHEROID&&(t.ellps=e.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=e.DATUM.SPHEROID.a,t.rf=parseFloat(e.DATUM.SPHEROID.rf,10)),e.DATUM&&e.DATUM.TOWGS84&&(t.datum_params=e.DATUM.TOWGS84),~t.datumCode.indexOf("osgb_1936")&&(t.datumCode="osgb36"),~t.datumCode.indexOf("osni_1952")&&(t.datumCode="osni52"),(~t.datumCode.indexOf("tm65")||~t.datumCode.indexOf("geodetic_datum_of_1965"))&&(t.datumCode="ire65"),"ch1903+"===t.datumCode&&(t.datumCode="ch1903"),~t.datumCode.indexOf("israel")&&(t.datumCode="isr93")),t.b&&!isFinite(t.b)&&(t.b=t.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",a],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",a],["x0","false_easting",n],["y0","false_northing",n],["long0","central_meridian",a],["lat0","latitude_of_origin",a],["lat0","standard_parallel_1",a],["lat1","standard_parallel_1",a],["lat2","standard_parallel_2",a],["azimuth","Azimuth"],["alpha","azimuth",a],["srsCode","name"]].forEach(function(e){return n=t,r=(i=e)[0],o=i[1],void(!(r in n)&&o in n&&(n[r]=n[o],3===i.length&&(n[r]=i[2](n[r]))));var n,i,r,o}),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.projName&&"Lambert_Azimuthal_Equal_Area"!==t.projName||(t.long0=t.longc),t.lat_ts||!t.lat1||"Stereographic_South_Pole"!==t.projName&&"Polar Stereographic (variant B)"!==t.projName||(t.lat0=a(t.lat1>0?90:-90),t.lat_ts=t.lat1)}(s),s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=u,e.forward=l,e.inverse=c,n.d(e,"names",function(){return h});var i=n(16),r=n(5),o=n(29),a=n(30),s=n(3);function u(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Object(i.a)(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function l(t){var e,n,i=t.x,a=t.y;if(a*s.i>90&&a*s.i<-90&&i*s.i>180&&i*s.i<-180)return null;if(Math.abs(Math.abs(a)-s.d)<=s.b)return null;if(this.sphere)e=this.x0+this.a*this.k0*Object(r.a)(i-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(s.c+.5*a));else{var u=Math.sin(a),l=Object(o.a)(this.e,a,u);e=this.x0+this.a*this.k0*Object(r.a)(i-this.long0),n=this.y0-this.a*this.k0*Math.log(l)}return t.x=e,t.y=n,t}function c(t){var e,n,i=t.x-this.x0,o=t.y-this.y0;if(this.sphere)n=s.d-2*Math.atan(Math.exp(-o/(this.a*this.k0)));else{var u=Math.exp(-o/(this.a*this.k0));if(-9999===(n=Object(a.a)(this.e,u)))return null}return e=Object(r.a)(this.long0+i/(this.a*this.k0)),t.x=e,t.y=n,t}var h=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"];e.default={init:u,forward:l,inverse:c,names:h}},function(t,e,n){"use strict";function i(){}function r(t){return t}Object.defineProperty(e,"__esModule",{value:!0}),e.init=i,n.d(e,"forward",function(){return r}),n.d(e,"inverse",function(){return r}),n.d(e,"names",function(){return o});var o=["longlat","identity"];e.default={init:i,forward:r,inverse:r,names:o}},function(t,e,n){"use strict";e.a=function t(e,n,l){var c;Array.isArray(l)&&(l=Object(s.a)(l));Object(u.a)(l);e.datum&&n.datum&&function(t,e){return(t.datum.datum_type===i.e||t.datum.datum_type===i.f)&&"WGS84"!==e.datumCode||(e.datum.datum_type===i.e||e.datum.datum_type===i.f)&&"WGS84"!==t.datumCode}(e,n)&&(c=new a.a("WGS84"),l=t(e,c,l),e=c);"enu"!==e.axis&&(l=Object(o.a)(e,!1,l));"longlat"===e.projName?l={x:l.x*i.a,y:l.y*i.a}:(e.to_meter&&(l={x:l.x*e.to_meter,y:l.y*e.to_meter}),l=e.inverse(l));e.from_greenwich&&(l.x+=e.from_greenwich);l=Object(r.a)(e.datum,n.datum,l);n.from_greenwich&&(l={x:l.x-n.from_greenwich,y:l.y});"longlat"===n.projName?l={x:l.x*i.i,y:l.y*i.i}:(l=n.forward(l),n.to_meter&&(l={x:l.x/n.to_meter,y:l.y/n.to_meter}));if("enu"!==n.axis)return Object(o.a)(n,!0,l);return l};var i=n(3),r=n(152),o=n(154),a=n(42),s=n(66),u=n(155)},function(t,e,n){"use strict";e.a=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}},function(t,e,n){"use strict";e.b=h,e.c=d;var i=6,r="AJSAJS",o="AFAFAF",a=65,s=73,u=79,l=86,c=90;function h(t,e){return e=e||5,function(t,e){var n="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+(_=t.easting,w=t.northing,M=t.zoneNumber,A=g(M),T=Math.floor(_/1e5),C=Math.floor(w/1e5)%20,h=T,d=C,f=A,p=f-1,m=r.charCodeAt(p),v=o.charCodeAt(p),y=m+h-1,x=v+d,b=!1,y>c&&(y=y-c+a-1,b=!0),(y===s||m<s&&y>s||(y>s||m<s)&&b)&&y++,(y===u||m<u&&y>u||(y>u||m<u)&&b)&&++y===s&&y++,y>c&&(y=y-c+a-1),x>l?(x=x-l+a-1,b=!0):b=!1,(x===s||v<s&&x>s||(x>s||v<s)&&b)&&x++,(x===u||v<u&&x>u||(x>u||v<u)&&b)&&++x===s&&x++,x>l&&(x=x-l+a-1),String.fromCharCode(y)+String.fromCharCode(x))+n.substr(n.length-5,e)+i.substr(i.length-5,e);var h,d,f,p,m,v,y,x,b;var _,w,M,A,T,C}(function(t){var e,n,i,r,o,a,s,u=t.lat,l=t.lon,c=6378137,h=f(u),d=f(l);s=Math.floor((l+180)/6)+1,180===l&&(s=60);u>=56&&u<64&&l>=3&&l<12&&(s=32);u>=72&&u<84&&(l>=0&&l<9?s=31:l>=9&&l<21?s=33:l>=21&&l<33?s=35:l>=33&&l<42&&(s=37));a=f(6*(s-1)-180+3),.006739496752268451,e=c/Math.sqrt(1-.00669438*Math.sin(h)*Math.sin(h)),n=Math.tan(h)*Math.tan(h),i=.006739496752268451*Math.cos(h)*Math.cos(h),r=Math.cos(h)*(d-a),o=c*(.9983242984503243*h-.002514607064228144*Math.sin(2*h)+2639046602129982e-21*Math.sin(4*h)-3.418046101696858e-9*Math.sin(6*h));var p=.9996*e*(r+(1-n+i)*r*r*r/6+(5-18*n+n*n+72*i-.39089081163157013)*r*r*r*r*r/120)+5e5,m=.9996*(o+e*Math.tan(h)*(r*r/2+(5-n+9*i+4*i*i)*r*r*r*r/24+(61-58*n+n*n+600*i-2.2240339282485886)*r*r*r*r*r*r/720));u<0&&(m+=1e7);return{northing:Math.round(m),easting:Math.round(p),zoneNumber:s,zoneLetter:function(t){var e="Z";84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C");return e}(u)}}({lat:t[1],lon:t[0]}),e)}function d(t){var e=m(v(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}function f(t){return t*(Math.PI/180)}function p(t){return t/Math.PI*180}function m(t){var e=t.northing,n=t.easting,i=t.zoneLetter,r=t.zoneNumber;if(r<0||r>60)return null;var o,a,s,u,l,c,h,d,f=6378137,g=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),v=n-5e5,y=e;i<"N"&&(y-=1e7),c=6*(r-1)-180+3,d=(h=y/.9996/6367449.145945056)+(3*g/2-27*g*g*g/32)*Math.sin(2*h)+(21*g*g/16-55*g*g*g*g/32)*Math.sin(4*h)+151*g*g*g/96*Math.sin(6*h),o=f/Math.sqrt(1-.00669438*Math.sin(d)*Math.sin(d)),a=Math.tan(d)*Math.tan(d),s=.006739496752268451*Math.cos(d)*Math.cos(d),u=.99330562*f/Math.pow(1-.00669438*Math.sin(d)*Math.sin(d),1.5),l=v/(.9996*o);var x=d-o*Math.tan(d)/u*(l*l/2-(5+3*a+10*s-4*s*s-.06065547077041606)*l*l*l*l/24+(61+90*a+298*s+45*a*a-1.6983531815716497-3*s*s)*l*l*l*l*l*l/720);x=p(x);var b,_=(l-(1+2*a+s)*l*l*l/6+(5-2*s+28*a-3*s*s+.05391597401814761+24*a*a)*l*l*l*l*l/120)/Math.cos(d);if(_=c+p(_),t.accuracy){var w=m({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});b={top:w.lat,right:w.lon,bottom:x,left:_}}else b={lat:x,lon:_};return b}function g(t){var e=t%i;return 0===e&&(e=i),e}function v(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,i=null,h="",d=0;!/[A-Z]/.test(e=t.charAt(d));){if(d>=2)throw"MGRSPoint bad conversion from: "+t;h+=e,d++}var f=parseInt(h,10);if(0===d||d+3>n)throw"MGRSPoint bad conversion from: "+t;var p=t.charAt(d++);if(p<="A"||"B"===p||"Y"===p||p>="Z"||"I"===p||"O"===p)throw"MGRSPoint zone letter "+p+" not handled: "+t;i=t.substring(d,d+=2);for(var m=g(f),v=function(t,e){var n=r.charCodeAt(e-1),i=1e5,o=!1;for(;n!==t.charCodeAt(0);){if(++n===s&&n++,n===u&&n++,n>c){if(o)throw"Bad character: "+t;n=a,o=!0}i+=1e5}return i}(i.charAt(0),m),x=function(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;var n=o.charCodeAt(e-1),i=0,r=!1;for(;n!==t.charCodeAt(0);){if(++n===s&&n++,n===u&&n++,n>l){if(r)throw"Bad character: "+t;n=a,r=!0}i+=1e5}return i}(i.charAt(1),m);x<y(p);)x+=2e6;var b=n-d;if(b%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var _,w,M,A=b/2,T=0,C=0;return A>0&&(_=1e5/Math.pow(10,A),w=t.substring(d,d+A),T=parseFloat(w)*_,M=t.substring(d+A),C=parseFloat(M)*_),{easting:T+v,northing:C+x,zoneLetter:p,zoneNumber:f,accuracy:_}}function y(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}e.a={forward:h,inverse:function(t){var e=m(v(t.toUpperCase()));if(e.lat&&e.lon)return[e.lon,e.lat,e.lon,e.lat];return[e.left,e.bottom,e.right,e.top]},toPoint:d}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=l,e.forward=c,e.inverse=h,n.d(e,"names",function(){return d});var i=n(69),r=n(43),o=n(70),a=n(5),s=n(3),u=n(21);function l(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=Object(i.a)(this.es),this.ml0=Object(r.a)(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function c(t){var e,n,i,o=t.x,u=t.y,l=Object(a.a)(o-this.long0),c=Math.sin(u),h=Math.cos(u);if(this.es){var d=h*l,f=Math.pow(d,2),p=this.ep2*Math.pow(h,2),m=Math.pow(p,2),g=Math.abs(h)>s.b?Math.tan(u):0,v=Math.pow(g,2),y=Math.pow(v,2);e=1-this.es*Math.pow(c,2),d/=Math.sqrt(e);var x=Object(r.a)(u,c,h,this.en);n=this.a*(this.k0*d*(1+f/6*(1-v+p+f/20*(5-18*v+y+14*p-58*v*p+f/42*(61+179*y-y*v-479*v)))))+this.x0,i=this.a*(this.k0*(x-this.ml0+c*l*d/2*(1+f/12*(5-v+9*p+4*m+f/30*(61+y-58*v+270*p-330*v*p+f/56*(1385+543*y-y*v-3111*v))))))+this.y0}else{var b=h*Math.sin(l);if(Math.abs(Math.abs(b)-1)<s.b)return 93;if(n=.5*this.a*this.k0*Math.log((1+b)/(1-b))+this.x0,i=h*Math.cos(l)/Math.sqrt(1-Math.pow(b,2)),(b=Math.abs(i))>=1){if(b-1>s.b)return 93;i=0}else i=Math.acos(i);u<0&&(i=-i),i=this.a*this.k0*(i-this.lat0)+this.y0}return t.x=n,t.y=i,t}function h(t){var e,n,i,r,l=(t.x-this.x0)*(1/this.a),c=(t.y-this.y0)*(1/this.a);if(this.es)if(e=this.ml0+c/this.k0,n=Object(o.a)(e,this.es,this.en),Math.abs(n)<s.d){var h=Math.sin(n),d=Math.cos(n),f=Math.abs(d)>s.b?Math.tan(n):0,p=this.ep2*Math.pow(d,2),m=Math.pow(p,2),g=Math.pow(f,2),v=Math.pow(g,2);e=1-this.es*Math.pow(h,2);var y=l*Math.sqrt(e)/this.k0,x=Math.pow(y,2);i=n-(e*=f)*x/(1-this.es)*.5*(1-x/12*(5+3*g-9*p*g+p-4*m-x/30*(61+90*g-252*p*g+45*v+46*p-x/56*(1385+3633*g+4095*v+1574*v*g)))),r=Object(a.a)(this.long0+y*(1-x/6*(1+2*g+p-x/20*(5+28*g+24*v+8*p*g+6*p-x/42*(61+662*g+1320*v+720*v*g))))/d)}else i=s.d*Object(u.a)(c),r=0;else{var b=Math.exp(l/this.k0),_=.5*(b-1/b),w=this.lat0+c/this.k0,M=Math.cos(w);e=Math.sqrt((1-Math.pow(M,2))/(1+Math.pow(_,2))),i=Math.asin(e),c<0&&(i=-i),r=0===_&&0===M?0:Object(a.a)(Math.atan2(_,M)+this.long0)}return t.x=r,t.y=i,t}var d=["Transverse_Mercator","Transverse Mercator","tmerc"];e.default={init:l,forward:c,inverse:h,names:d}},function(t,e,n){"use strict";var i=.01068115234375;e.a=function(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*i))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*i)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e}},function(t,e,n){"use strict";var i=n(43),r=n(3);e.a=function(t,e,n){for(var o=1/(1-e),a=t,s=20;s;--s){var u=Math.sin(a),l=1-e*u*u;if(a-=l=(Object(i.a)(a,u,Math.cos(a),n)-t)*(l*Math.sqrt(l))*o,Math.abs(l)<r.b)return a}return a}},function(t,e,n){"use strict";e.a=function(t,e){t=Math.abs(t),e=Math.abs(e);var n=Math.max(t,e),i=Math.min(t,e)/(n||1);return n*Math.sqrt(1+Math.pow(i,2))}},function(t,e,n){"use strict";e.a=function(t){var e=Math.exp(t);return e=(e+1/e)/2}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"dependsOn",function(){return a}),e.init=s,n.d(e,"names",function(){return u});var i=n(165),r=n(44),o=n(3),a="etmerc";function s(){var t=Object(i.a)(this.zone,this.long0);if(void 0===t)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(t)-183)*o.a,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,r.default.init.apply(this),this.forward=r.default.forward,this.inverse=r.default.inverse}var u=["Universal Transverse Mercator System","utm"];e.default={init:s,names:u,dependsOn:a}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=o,e.forward=a,e.inverse=s,n.d(e,"names",function(){return u});var i=n(75),r=n(5);function o(){i.default.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function a(t){var e,n,o,a;return t.x=Object(r.a)(t.x-this.long0),i.default.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),o=Math.cos(t.x),a=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*o),t.x=a*n*Math.sin(t.x),t.y=a*(this.cosc0*e-this.sinc0*n*o),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t}function s(t){var e,n,o,a,s;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,s=Math.sqrt(t.x*t.x+t.y*t.y)){var u=2*Math.atan2(s,this.R2);e=Math.sin(u),n=Math.cos(u),a=Math.asin(n*this.sinc0+t.y*e*this.cosc0/s),o=Math.atan2(t.x*e,s*this.cosc0*n-t.y*this.sinc0*e)}else a=this.phic0,o=0;return t.x=o,t.y=a,i.default.inverse.apply(this,[t]),t.x=Object(r.a)(t.x+this.long0),t}var u=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"];e.default={init:o,forward:a,inverse:s,names:u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=a,e.forward=s,e.inverse=u,n.d(e,"names",function(){return l});var i=n(166),r=n(3),o=20;function a(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+r.c)/(Math.pow(Math.tan(.5*this.lat0+r.c),this.C)*Object(i.a)(this.e*t,this.ratexp))}function s(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+r.c),this.C)*Object(i.a)(this.e*Math.sin(n),this.ratexp))-r.d,t.x=this.C*e,t}function u(t){for(var e=t.x/this.C,n=t.y,a=Math.pow(Math.tan(.5*n+r.c)/this.K,1/this.C),s=o;s>0&&(n=2*Math.atan(a*Object(i.a)(this.e*Math.sin(t.y),-.5*this.e))-r.d,!(Math.abs(n-t.y)<1e-14));--s)t.y=n;return s?(t.x=e,t.y=n,t):null}var l=["gauss"];e.default={init:a,forward:s,inverse:u,names:l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ssfn_=l,e.init=c,e.forward=h,e.inverse=d,n.d(e,"names",function(){return f});var i=n(3),r=n(21),o=n(16),a=n(29),s=n(30),u=n(5);function l(t,e,n){return e*=n,Math.tan(.5*(i.d+t))*Math.pow((1-e)/(1+e),.5*n)}function c(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=i.b&&(this.k0=.5*(1+Object(r.a)(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=i.b&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=i.b&&(this.k0=.5*this.cons*Object(o.a)(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Object(a.a)(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Object(o.a)(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-i.d,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function h(t){var e,n,r,o,s,l,c=t.x,h=t.y,d=Math.sin(h),f=Math.cos(h),p=Object(u.a)(c-this.long0);return Math.abs(Math.abs(c-this.long0)-Math.PI)<=i.b&&Math.abs(h+this.lat0)<=i.b?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*d+this.coslat0*f*Math.cos(p)),t.x=this.a*e*f*Math.sin(p)+this.x0,t.y=this.a*e*(this.coslat0*d-this.sinlat0*f*Math.cos(p))+this.y0,t):(n=2*Math.atan(this.ssfn_(h,d,this.e))-i.d,o=Math.cos(n),r=Math.sin(n),Math.abs(this.coslat0)<=i.b?(s=Object(a.a)(this.e,h*this.con,this.con*d),l=2*this.a*this.k0*s/this.cons,t.x=this.x0+l*Math.sin(c-this.long0),t.y=this.y0-this.con*l*Math.cos(c-this.long0),t):(Math.abs(this.sinlat0)<i.b?(e=2*this.a*this.k0/(1+o*Math.cos(p)),t.y=e*r):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*o*Math.cos(p))),t.y=e*(this.cosX0*r-this.sinX0*o*Math.cos(p))+this.y0),t.x=e*o*Math.sin(p)+this.x0,t))}function d(t){var e,n,r,o,a;t.x-=this.x0,t.y-=this.y0;var l=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var c=2*Math.atan(l/(2*this.a*this.k0));return e=this.long0,n=this.lat0,l<=i.b?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(c)*this.sinlat0+t.y*Math.sin(c)*this.coslat0/l),e=Math.abs(this.coslat0)<i.b?this.lat0>0?Object(u.a)(this.long0+Math.atan2(t.x,-1*t.y)):Object(u.a)(this.long0+Math.atan2(t.x,t.y)):Object(u.a)(this.long0+Math.atan2(t.x*Math.sin(c),l*this.coslat0*Math.cos(c)-t.y*this.sinlat0*Math.sin(c))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=i.b){if(l<=i.b)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,r=l*this.cons/(2*this.a*this.k0),n=this.con*Object(s.a)(this.e,r),e=this.con*Object(u.a)(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else o=2*Math.atan(l*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,l<=i.b?a=this.X0:(a=Math.asin(Math.cos(o)*this.sinX0+t.y*Math.sin(o)*this.cosX0/l),e=Object(u.a)(this.long0+Math.atan2(t.x*Math.sin(o),l*this.cosX0*Math.cos(o)-t.y*this.sinX0*Math.sin(o)))),n=-1*Object(s.a)(this.e,Math.tan(.5*(i.d+a)));return t.x=e,t.y=n,t}var f=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"];e.default={init:c,forward:h,inverse:d,names:f,ssfn_:l}},function(t,e,n){"use strict";function i(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,i=1/this.rf,r=2*i-Math.pow(i,2),o=this.e=Math.sqrt(r);this.R=this.k0*n*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+t/2)),u=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*s+this.alpha*o/2*u}function r(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+n)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),a=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(o))),s=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,t.x=this.R*a+this.x0,t}function o(t){for(var e=t.x-this.x0,n=t.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),a=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),s=this.lambda0+a/this.alpha,u=0,l=o,c=-1e3,h=0;Math.abs(l-c)>1e-7;){if(++h>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),c=l,l=2*Math.atan(Math.exp(u))-Math.PI/2}return t.x=s,t.y=l,t}Object.defineProperty(e,"__esModule",{value:!0}),e.init=i,e.forward=r,e.inverse=o,n.d(e,"names",function(){return a});var a=["somerc"];e.default={init:i,forward:r,inverse:o,names:a}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=s,e.forward=u,e.inverse=l,n.d(e,"names",function(){return c});var i=n(29),r=n(5),o=n(30),a=n(3);function s(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),n=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var o,a,s=Object(i.a)(this.e,this.lat0,t),u=this.bl/e*Math.sqrt((1-this.es)/(1-n*n));if(u*u<1&&(u=1),isNaN(this.longc)){var l=Object(i.a)(this.e,this.lat1,Math.sin(this.lat1)),c=Object(i.a)(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(u+Math.sqrt(u*u-1))*Math.pow(s,this.bl):this.el=(u-Math.sqrt(u*u-1))*Math.pow(s,this.bl);var h=Math.pow(l,this.bl),d=Math.pow(c,this.bl);a=.5*((o=this.el/h)-1/o);var f=(this.el*this.el-d*h)/(this.el*this.el+d*h),p=(d-h)/(d+h),m=Object(r.a)(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(f*Math.tan(.5*this.bl*m)/p)/this.bl,this.long0=Object(r.a)(this.long0);var g=Object(r.a)(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*g)/a),this.alpha=Math.asin(u*Math.sin(this.gamma0))}else o=this.lat0>=0?u+Math.sqrt(u*u-1):u-Math.sqrt(u*u-1),this.el=o*Math.pow(s,this.bl),a=.5*(o-1/o),this.gamma0=Math.asin(Math.sin(this.alpha)/u),this.long0=this.longc-Math.asin(a*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(u*u-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(u*u-1),Math.cos(this.alpha))}function u(t){var e,n,o,s=t.x,u=t.y,l=Object(r.a)(s-this.long0);if(Math.abs(Math.abs(u)-a.d)<=a.b)o=u>0?-1:1,n=this.al/this.bl*Math.log(Math.tan(a.c+o*this.gamma0*.5)),e=-1*o*a.d*this.al/this.bl;else{var c=Object(i.a)(this.e,u,Math.sin(u)),h=this.el/Math.pow(c,this.bl),d=.5*(h-1/h),f=.5*(h+1/h),p=Math.sin(this.bl*l),m=(d*Math.sin(this.gamma0)-p*Math.cos(this.gamma0))/f;n=Math.abs(Math.abs(m)-1)<=a.b?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-m)/(1+m))/this.bl,e=Math.abs(Math.cos(this.bl*l))<=a.b?this.al*this.bl*l:this.al*Math.atan2(d*Math.cos(this.gamma0)+p*Math.sin(this.gamma0),Math.cos(this.bl*l))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+n):(e-=this.uc,t.x=this.x0+n*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-n*Math.sin(this.alpha)),t}function l(t){var e,n;this.no_rot?(n=t.y-this.y0,e=t.x-this.x0):(n=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var i=Math.exp(-1*this.bl*n/this.al),s=.5*(i-1/i),u=.5*(i+1/i),l=Math.sin(this.bl*e/this.al),c=(l*Math.cos(this.gamma0)+s*Math.sin(this.gamma0))/u,h=Math.pow(this.el/Math.sqrt((1+c)/(1-c)),1/this.bl);return Math.abs(c-1)<a.b?(t.x=this.long0,t.y=a.d):Math.abs(c+1)<a.b?(t.x=this.long0,t.y=-1*a.d):(t.y=Object(o.a)(this.e,h),t.x=Object(r.a)(this.long0-Math.atan2(s*Math.cos(this.gamma0)-l*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t}var c=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"];e.default={init:s,forward:u,inverse:l,names:c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=l,e.forward=c,e.inverse=h,n.d(e,"names",function(){return d});var i=n(16),r=n(29),o=n(21),a=n(5),s=n(30),u=n(3);function l(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<u.b)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),o=Object(i.a)(this.e,e,n),a=Object(r.a)(this.e,this.lat1,e),s=Math.sin(this.lat2),l=Math.cos(this.lat2),c=Object(i.a)(this.e,s,l),h=Object(r.a)(this.e,this.lat2,s),d=Object(r.a)(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>u.b?this.ns=Math.log(o/c)/Math.log(a/h):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=o/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(d,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function c(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=u.b&&(n=Object(o.a)(n)*(u.d-2*u.b));var i,s,l=Math.abs(Math.abs(n)-u.d);if(l>u.b)i=Object(r.a)(this.e,n,Math.sin(n)),s=this.a*this.f0*Math.pow(i,this.ns);else{if((l=n*this.ns)<=0)return null;s=0}var c=this.ns*Object(a.a)(e-this.long0);return t.x=this.k0*(s*Math.sin(c))+this.x0,t.y=this.k0*(this.rh-s*Math.cos(c))+this.y0,t}function h(t){var e,n,i,r,o,l=(t.x-this.x0)/this.k0,c=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(l*l+c*c),n=1):(e=-Math.sqrt(l*l+c*c),n=-1);var h=0;if(0!==e&&(h=Math.atan2(n*l,n*c)),0!==e||this.ns>0){if(n=1/this.ns,i=Math.pow(e/(this.a*this.f0),n),-9999===(r=Object(s.a)(this.e,i)))return null}else r=-u.d;return o=Object(a.a)(h/this.ns+this.long0),t.x=o,t.y=r,t}var d=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"];e.default={init:l,forward:c,inverse:h,names:d}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=r,e.forward=o,e.inverse=a,n.d(e,"names",function(){return s});var i=n(5);function r(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function o(t){var e,n,r,o,a,s,u,l=t.x,c=t.y,h=Object(i.a)(l-this.long0);return e=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/e)-this.s45),r=-h*this.alfa,o=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),a=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(o)),s=this.n*a,u=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(o/2+this.s45),this.n),t.y=u*Math.cos(s)/1,t.x=u*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t}function a(t){var e,n,i,r,o,a,s,u=t.x;t.x=t.y,t.y=u,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x)/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),n=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e,s=0;var l=0;do{t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(s=1),a=t.y,l+=1}while(0===s&&l<15);return l>=15?null:t}var s=["Krovak","krovak"];e.default={init:r,forward:o,inverse:a,names:s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=f,e.forward=p,e.inverse=m,n.d(e,"names",function(){return g});var i=n(31),r=n(32),o=n(33),a=n(34),s=n(35),u=n(46),l=n(5),c=n(22),h=n(47),d=n(3);function f(){this.sphere||(this.e0=Object(r.a)(this.es),this.e1=Object(o.a)(this.es),this.e2=Object(a.a)(this.es),this.e3=Object(s.a)(this.es),this.ml0=this.a*Object(i.a)(this.e0,this.e1,this.e2,this.e3,this.lat0))}function p(t){var e,n,r=t.x,o=t.y;if(r=Object(l.a)(r-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(o)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(o),Math.cos(r))-this.lat0);else{var a=Math.sin(o),s=Math.cos(o),c=Object(u.a)(this.a,this.e,a),h=Math.tan(o)*Math.tan(o),d=r*Math.cos(o),f=d*d,p=this.es*s*s/(1-this.es);e=c*d*(1-f*h*(1/6-(8-h+8*p)*f/120)),n=this.a*Object(i.a)(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+c*a/s*f*(.5+(5-h+6*p)*f/24)}return t.x=e+this.x0,t.y=n+this.y0,t}function m(t){t.x-=this.x0,t.y-=this.y0;var e,n,i=t.x/this.a,r=t.y/this.a;if(this.sphere){var o=r+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(i)),n=Math.atan2(Math.tan(i),Math.cos(o))}else{var a=this.ml0/this.a+r,s=Object(h.a)(a,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(s)-d.d)<=d.b)return t.x=this.long0,t.y=d.d,r<0&&(t.y*=-1),t;var f=Object(u.a)(this.a,this.e,Math.sin(s)),p=f*f*f/this.a/this.a*(1-this.es),m=Math.pow(Math.tan(s),2),g=i*this.a/f,v=g*g;e=s-f*Math.tan(s)/p*g*g*(.5-(1+3*m)*g*g/24),n=g*(1-v*(m/3+(1+3*m)*m*v/15))/Math.cos(s)}return t.x=Object(l.a)(n+this.long0),t.y=Object(c.a)(e),t}var g=["Cassini","Cassini_Soldner","cass"];e.default={init:f,forward:p,inverse:m,names:g}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"S_POLE",function(){return a}),n.d(e,"N_POLE",function(){return s}),n.d(e,"EQUIT",function(){return u}),n.d(e,"OBLIQ",function(){return l}),e.init=c,e.forward=h,e.inverse=d,n.d(e,"names",function(){return x});var i=n(3),r=n(48),o=n(5),a=1,s=2,u=3,l=4;function c(){var t,e=Math.abs(this.lat0);if(Math.abs(e-i.d)<i.b?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<i.b?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Object(r.a)(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(t){var e,n=[];return n[0]=t*f,e=t*t,n[0]+=e*p,n[1]=e*g,e*=t,n[0]+=e*m,n[1]+=e*v,n[2]=e*y,n}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Object(r.a)(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function h(t){var e,n,a,s,u,l,c,h,d,f,p=t.x,m=t.y;if(p=Object(o.a)(p-this.long0),this.sphere){if(u=Math.sin(m),f=Math.cos(m),a=Math.cos(p),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+f*a:1+this.sinph0*u+this.cosph0*f*a)<=i.b)return null;e=(n=Math.sqrt(2/n))*f*Math.sin(p),n*=this.mode===this.EQUIT?u:this.cosph0*u-this.sinph0*f*a}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(a=-a),Math.abs(m+this.phi0)<i.b)return null;n=i.c-.5*m,e=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(p),n*=a}}else{switch(c=0,h=0,d=0,a=Math.cos(p),s=Math.sin(p),u=Math.sin(m),l=Object(r.a)(this.e,u),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(c=l/this.qp,h=Math.sqrt(1-c*c)),this.mode){case this.OBLIQ:d=1+this.sinb1*c+this.cosb1*h*a;break;case this.EQUIT:d=1+h*a;break;case this.N_POLE:d=i.d+m,l=this.qp-l;break;case this.S_POLE:d=m-i.d,l=this.qp+l}if(Math.abs(d)<i.b)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:d=Math.sqrt(2/d),n=this.mode===this.OBLIQ?this.ymf*d*(this.cosb1*c-this.sinb1*h*a):(d=Math.sqrt(2/(1+h*a)))*c*this.ymf,e=this.xmf*d*h*s;break;case this.N_POLE:case this.S_POLE:l>=0?(e=(d=Math.sqrt(l))*s,n=a*(this.mode===this.S_POLE?d:-d)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t}function d(t){t.x-=this.x0,t.y-=this.y0;var e,n,r,a,s,u,l,c,h,d,f=t.x/this.a,p=t.y/this.a;if(this.sphere){var m,g=0,v=0;if((n=.5*(m=Math.sqrt(f*f+p*p)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(v=Math.sin(n),g=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(m)<=i.b?0:Math.asin(p*v/m),f*=v,p=g*m;break;case this.OBLIQ:n=Math.abs(m)<=i.b?this.phi0:Math.asin(g*this.sinph0+p*v*this.cosph0/m),f*=v*this.cosph0,p=(g-Math.sin(n)*this.sinph0)*m;break;case this.N_POLE:p=-p,n=i.d-n;break;case this.S_POLE:n-=i.d}e=0!==p||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(f,p):0}else{if(l=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(f/=this.dd,p*=this.dd,(u=Math.sqrt(f*f+p*p))<i.b)return t.x=0,t.y=this.phi0,t;a=2*Math.asin(.5*u/this.rq),r=Math.cos(a),f*=a=Math.sin(a),this.mode===this.OBLIQ?(l=r*this.sinb1+p*a*this.cosb1/u,s=this.qp*l,p=u*this.cosb1*r-p*this.sinb1*a):(l=p*a/u,s=this.qp*l,p=u*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(p=-p),!(s=f*f+p*p))return t.x=0,t.y=this.phi0,t;l=1-s/this.qp,this.mode===this.S_POLE&&(l=-l)}e=Math.atan2(f,p),c=Math.asin(l),h=this.apa,d=c+c,n=c+h[0]*Math.sin(d)+h[1]*Math.sin(d+d)+h[2]*Math.sin(d+d+d)}return t.x=Object(o.a)(this.long0+e),t.y=n,t}var f=.3333333333333333,p=.17222222222222222,m=.10257936507936508,g=.06388888888888888,v=.0664021164021164,y=.016415012942191543;var x=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"];e.default={init:c,forward:h,inverse:d,names:x,S_POLE:a,N_POLE:s,EQUIT:u,OBLIQ:l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=u,e.forward=l,e.inverse=c,e.phi1z=h,n.d(e,"names",function(){return d});var i=n(16),r=n(48),o=n(5),a=n(17),s=n(3);function u(){Math.abs(this.lat1+this.lat2)<s.b||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Object(i.a)(this.e3,this.sin_po,this.cos_po),this.qs1=Object(r.a)(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Object(i.a)(this.e3,this.sin_po,this.cos_po),this.qs2=Object(r.a)(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Object(r.a)(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>s.b?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function l(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var i=Object(r.a)(this.e3,this.sin_phi,this.cos_phi),a=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,s=this.ns0*Object(o.a)(e-this.long0),u=a*Math.sin(s)+this.x0,l=this.rh-a*Math.cos(s)+this.y0;return t.x=u,t.y=l,t}function c(t){var e,n,i,r,a,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),i=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),i=-1),r=0,0!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,this.sphere?s=Math.asin((this.c-i*i)/(2*this.ns0)):(n=(this.c-i*i)/this.ns0,s=this.phi1z(this.e3,n)),a=Object(o.a)(r/this.ns0+this.long0),t.x=a,t.y=s,t}function h(t,e){var n,i,r,o,u,l=Object(a.a)(.5*e);if(t<s.b)return l;for(var c=t*t,h=1;h<=25;h++)if(n=Math.sin(l),i=Math.cos(l),l+=u=.5*(o=1-(r=t*n)*r)*o/i*(e/(1-c)-n/o+.5/t*Math.log((1-r)/(1+r))),Math.abs(u)<=1e-7)return l;return null}var d=["Albers_Conic_Equal_Area","Albers","aea"];e.default={init:u,forward:l,inverse:c,names:d,phi1z:h}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=a,e.forward=s,e.inverse=u,n.d(e,"names",function(){return l});var i=n(5),r=n(17),o=n(3);function a(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function s(t){var e,n,r,a,s,u,l,c=t.x,h=t.y;return r=Object(i.a)(c-this.long0),e=Math.sin(h),n=Math.cos(h),a=Math.cos(r),1,(s=this.sin_p14*e+this.cos_p14*n*a)>0||Math.abs(s)<=o.b?(u=this.x0+1*this.a*n*Math.sin(r)/s,l=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*a)/s):(u=this.x0+this.infinity_dist*n*Math.sin(r),l=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*a)),t.x=u,t.y=l,t}function u(t){var e,n,o,a,s,u;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(a=Math.atan2(e,this.rc),n=Math.sin(a),o=Math.cos(a),u=Object(r.a)(o*this.sin_p14+t.y*n*this.cos_p14/e),s=Math.atan2(t.x*n,e*this.cos_p14*o-t.y*this.sin_p14*n),s=Object(i.a)(this.long0+s)):(u=this.phic0,s=0),t.x=s,t.y=u,t}var l=["gnom"];e.default={init:a,forward:s,inverse:u,names:l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=s,e.forward=u,e.inverse=l,n.d(e,"names",function(){return c});var i=n(5),r=n(48),o=n(16),a=n(167);function s(){this.sphere||(this.k0=Object(o.a)(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function u(t){var e,n,o=t.x,a=t.y,s=Object(i.a)(o-this.long0);if(this.sphere)e=this.x0+this.a*s*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(a)/Math.cos(this.lat_ts);else{var u=Object(r.a)(this.e,Math.sin(a));e=this.x0+this.a*this.k0*s,n=this.y0+this.a*u*.5/this.k0}return t.x=e,t.y=n,t}function l(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=Object(i.a)(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=Object(a.a)(this.e,2*t.y*this.k0/this.a),e=Object(i.a)(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t}var c=["cea"];e.default={init:s,forward:u,inverse:l,names:c}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=o,e.forward=a,e.inverse=s,n.d(e,"names",function(){return u});var i=n(5),r=n(22);function o(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function a(t){var e=t.x,n=t.y,o=Object(i.a)(e-this.long0),a=Object(r.a)(n-this.lat0);return t.x=this.x0+this.a*o*this.rc,t.y=this.y0+this.a*a,t}function s(t){var e=t.x,n=t.y;return t.x=Object(i.a)(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=Object(r.a)(this.lat0+(n-this.y0)/this.a),t}var u=["Equirectangular","Equidistant_Cylindrical","eqc"];e.default={init:o,forward:a,inverse:s,names:u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=f,e.forward=p,e.inverse=m,n.d(e,"names",function(){return g});var i=n(32),r=n(33),o=n(34),a=n(35),s=n(5),u=n(22),l=n(31),c=n(3),h=n(46),d=20;function f(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Object(i.a)(this.es),this.e1=Object(r.a)(this.es),this.e2=Object(o.a)(this.es),this.e3=Object(a.a)(this.es),this.ml0=this.a*Object(l.a)(this.e0,this.e1,this.e2,this.e3,this.lat0)}function p(t){var e,n,i,r=t.x,o=t.y,a=Object(s.a)(r-this.long0);if(i=a*Math.sin(o),this.sphere)Math.abs(o)<=c.b?(e=this.a*a,n=-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(o),n=this.a*(Object(u.a)(o-this.lat0)+(1-Math.cos(i))/Math.tan(o)));else if(Math.abs(o)<=c.b)e=this.a*a,n=-1*this.ml0;else{var d=Object(h.a)(this.a,this.e,Math.sin(o))/Math.tan(o);e=d*Math.sin(i),n=this.a*Object(l.a)(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+d*(1-Math.cos(i))}return t.x=e+this.x0,t.y=n+this.y0,t}function m(t){var e,n,i,r,o,a,u,h,f;if(i=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=c.b)e=Object(s.a)(i/this.a+this.long0),n=0;else{var p;for(a=this.lat0+r/this.a,u=i*i/this.a/this.a+a*a,h=a,o=d;o;--o)if(h+=f=-1*(a*(h*(p=Math.tan(h))+1)-h-.5*(h*h+u)*p)/((h-a)/p-1),Math.abs(f)<=c.b){n=h;break}e=Object(s.a)(this.long0+Math.asin(i*Math.tan(h)/this.a)/Math.sin(n))}else if(Math.abs(r+this.ml0)<=c.b)n=0,e=Object(s.a)(this.long0+i/this.a);else{var m,g,v,y,x;for(a=(this.ml0+r)/this.a,u=i*i/this.a/this.a+a*a,h=a,o=d;o;--o)if(x=this.e*Math.sin(h),m=Math.sqrt(1-x*x)*Math.tan(h),g=this.a*Object(l.a)(this.e0,this.e1,this.e2,this.e3,h),v=this.e0-2*this.e1*Math.cos(2*h)+4*this.e2*Math.cos(4*h)-6*this.e3*Math.cos(6*h),h-=f=(a*(m*(y=g/this.a)+1)-y-.5*m*(y*y+u))/(this.es*Math.sin(2*h)*(y*y+u-2*a*y)/(4*m)+(a-y)*(m*v-2/Math.sin(2*h))-v),Math.abs(f)<=c.b){n=h;break}m=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=Object(s.a)(this.long0+Math.asin(i*m/this.a)/Math.sin(n))}return t.x=e,t.y=n,t}var g=["Polyconic","poly"];e.default={init:f,forward:p,inverse:m,names:g}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"iterations",function(){return r}),e.init=o,e.forward=a,e.inverse=s,n.d(e,"names",function(){return u});var i=n(3),r=1;function o(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function a(t){var e,n=t.x,r=t.y-this.lat0,o=n-this.long0,a=r/i.l*1e-5,s=o,u=1,l=0;for(e=1;e<=10;e++)u*=a,l+=this.A[e]*u;var c,h=l,d=s,f=1,p=0,m=0,g=0;for(e=1;e<=6;e++)c=p*h+f*d,f=f*h-p*d,p=c,m=m+this.B_re[e]*f-this.B_im[e]*p,g=g+this.B_im[e]*f+this.B_re[e]*p;return t.x=g*this.a+this.x0,t.y=m*this.a+this.y0,t}function s(t){var e,n,r=t.x,o=t.y,a=r-this.x0,s=(o-this.y0)/this.a,u=a/this.a,l=1,c=0,h=0,d=0;for(e=1;e<=6;e++)n=c*s+l*u,l=l*s-c*u,c=n,h=h+this.C_re[e]*l-this.C_im[e]*c,d=d+this.C_im[e]*l+this.C_re[e]*c;for(var f=0;f<this.iterations;f++){var p,m=h,g=d,v=s,y=u;for(e=2;e<=6;e++)p=g*h+m*d,m=m*h-g*d,g=p,v+=(e-1)*(this.B_re[e]*m-this.B_im[e]*g),y+=(e-1)*(this.B_im[e]*m+this.B_re[e]*g);m=1,g=0;var x=this.B_re[1],b=this.B_im[1];for(e=2;e<=6;e++)p=g*h+m*d,m=m*h-g*d,g=p,x+=e*(this.B_re[e]*m-this.B_im[e]*g),b+=e*(this.B_im[e]*m+this.B_re[e]*g);var _=x*x+b*b;h=(v*x+y*b)/_,d=(y*x-v*b)/_}var w=h,M=d,A=1,T=0;for(e=1;e<=9;e++)A*=w,T+=this.D[e]*A;var C=this.lat0+T*i.l*1e5,E=this.long0+M;return t.x=E,t.y=C,t}var u=["New_Zealand_Map_Grid","nzmg"];e.default={init:o,forward:a,inverse:s,names:u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=r,e.forward=o,e.inverse=a,n.d(e,"names",function(){return s});var i=n(5);function r(){}function o(t){var e=t.x,n=t.y,r=Object(i.a)(e-this.long0),o=this.x0+this.a*r,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=o,t.y=a,t}function a(t){t.x-=this.x0,t.y-=this.y0;var e=Object(i.a)(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t}var s=["Miller_Cylindrical","mill"];e.default={init:r,forward:o,inverse:a,names:s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=h,e.forward=d,e.inverse=f,n.d(e,"names",function(){return p});var i=n(5),r=n(22),o=n(69),a=n(43),s=n(70),u=n(3),l=n(17),c=20;function h(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=Object(o.a)(this.es)}function d(t){var e,n,r=t.x,o=t.y;if(r=Object(i.a)(r-this.long0),this.sphere){if(this.m)for(var s=this.n*Math.sin(o),l=c;l;--l){var h=(this.m*o+Math.sin(o)-s)/(this.m+Math.cos(o));if(o-=h,Math.abs(h)<u.b)break}else o=1!==this.n?Math.asin(this.n*Math.sin(o)):o;e=this.a*this.C_x*r*(this.m+Math.cos(o)),n=this.a*this.C_y*o}else{var d=Math.sin(o),f=Math.cos(o);n=this.a*Object(a.a)(o,d,f,this.en),e=this.a*r*f/Math.sqrt(1-this.es*d*d)}return t.x=e,t.y=n,t}function f(t){var e,n,o,a;return t.x-=this.x0,o=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,o/=this.C_x*(this.m+Math.cos(e)),this.m?e=Object(l.a)((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=Object(l.a)(Math.sin(e)/this.n)),o=Object(i.a)(o+this.long0),e=Object(r.a)(e)):(e=Object(s.a)(t.y/this.a,this.es,this.en),(a=Math.abs(e))<u.d?(a=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(e)),o=Object(i.a)(n)):a-u.b<u.d&&(o=this.long0)),t.x=o,t.y=e,t}var p=["Sinusoidal","sinu"];e.default={init:h,forward:d,inverse:f,names:p}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=o,e.forward=a,e.inverse=s,n.d(e,"names",function(){return u});var i=n(5),r=n(3);function o(){}function a(t){for(var e=t.x,n=t.y,o=Object(i.a)(e-this.long0),a=n,s=Math.PI*Math.sin(n);;){var u=-(a+Math.sin(a)-s)/(1+Math.cos(a));if(a+=u,Math.abs(u)<r.b)break}a/=2,Math.PI/2-Math.abs(n)<r.b&&(o=0);var l=.900316316158*this.a*o*Math.cos(a)+this.x0,c=1.4142135623731*this.a*Math.sin(a)+this.y0;return t.x=l,t.y=c,t}function s(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),e=Math.asin(n);var r=Object(i.a)(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,Math.abs(n)>1&&(n=1);var o=Math.asin(n);return t.x=r,t.y=o,t}var u=["Mollweide","moll"];e.default={init:o,forward:a,inverse:s,names:u}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=f,e.forward=p,e.inverse=m,n.d(e,"names",function(){return g});var i=n(32),r=n(33),o=n(34),a=n(35),s=n(16),u=n(31),l=n(5),c=n(22),h=n(47),d=n(3);function f(){Math.abs(this.lat1+this.lat2)<d.b||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Object(i.a)(this.es),this.e1=Object(r.a)(this.es),this.e2=Object(o.a)(this.es),this.e3=Object(a.a)(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Object(s.a)(this.e,this.sinphi,this.cosphi),this.ml1=Object(u.a)(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<d.b?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Object(s.a)(this.e,this.sinphi,this.cosphi),this.ml2=Object(u.a)(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Object(u.a)(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function p(t){var e,n=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var r=Object(u.a)(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-r)}var o=this.ns*Object(l.a)(n-this.long0),a=this.x0+e*Math.sin(o),s=this.y0+this.rh-e*Math.cos(o);return t.x=a,t.y=s,t}function m(t){var e,n,i,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns>=0?(n=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var o=0;if(0!==n&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return r=Object(l.a)(this.long0+o/this.ns),i=Object(c.a)(this.g-n/this.a),t.x=r,t.y=i,t;var a=this.g-n/this.a;return i=Object(h.a)(a,this.e0,this.e1,this.e2,this.e3),r=Object(l.a)(this.long0+o/this.ns),t.x=r,t.y=i,t}var g=["Equidistant_Conic","eqdc"];e.default={init:f,forward:p,inverse:m,names:g}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=a,e.forward=s,e.inverse=u,n.d(e,"names",function(){return l});var i=n(5),r=n(3),o=n(17);function a(){this.R=this.a}function s(t){var e,n,a=t.x,s=t.y,u=Object(i.a)(a-this.long0);Math.abs(s)<=r.b&&(e=this.x0+this.R*u,n=this.y0);var l=Object(o.a)(2*Math.abs(s/Math.PI));(Math.abs(u)<=r.b||Math.abs(Math.abs(s)-r.d)<=r.b)&&(e=this.x0,n=s>=0?this.y0+Math.PI*this.R*Math.tan(.5*l):this.y0+Math.PI*this.R*-Math.tan(.5*l));var c=.5*Math.abs(Math.PI/u-u/Math.PI),h=c*c,d=Math.sin(l),f=Math.cos(l),p=f/(d+f-1),m=p*p,g=p*(2/d-1),v=g*g,y=Math.PI*this.R*(c*(p-v)+Math.sqrt(h*(p-v)*(p-v)-(v+h)*(m-v)))/(v+h);u<0&&(y=-y),e=this.x0+y;var x=h+p;return y=Math.PI*this.R*(g*x-c*Math.sqrt((v+h)*(h+1)-x*x))/(v+h),n=s>=0?this.y0+y:this.y0-y,t.x=e,t.y=n,t}function u(t){var e,n,o,a,s,u,l,c,h,d,f,p;return t.x-=this.x0,t.y-=this.y0,f=Math.PI*this.R,s=(o=t.x/f)*o+(a=t.y/f)*a,f=3*(a*a/(c=-2*(u=-Math.abs(a)*(1+s))+1+2*a*a+s*s)+(2*(l=u-2*a*a+o*o)*l*l/c/c/c-9*u*l/c/c)/27)/(h=(u-l*l/3/c)/c)/(d=2*Math.sqrt(-h/3)),Math.abs(f)>1&&(f=f>=0?1:-1),p=Math.acos(f)/3,n=t.y>=0?(-d*Math.cos(p+Math.PI/3)-l/3/c)*Math.PI:-(-d*Math.cos(p+Math.PI/3)-l/3/c)*Math.PI,e=Math.abs(o)<r.b?this.long0:Object(i.a)(this.long0+Math.PI*(s-1+Math.sqrt(1+2*(o*o-a*a)+s*s))/2/o),t.x=e,t.y=n,t}var l=["Van_der_Grinten_I","VanDerGrinten","vandg"];e.default={init:a,forward:s,inverse:u,names:l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=f,e.forward=p,e.inverse=m,n.d(e,"names",function(){return g});var i=n(5),r=n(3),o=n(31),a=n(32),s=n(33),u=n(34),l=n(35),c=n(46),h=n(17),d=n(47);function f(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function p(t){var e,n,h,d,f,p,m,g,v,y,x,b,_,w,M,A,T,C,E,O,S,P,k=t.x,R=t.y,j=Math.sin(t.y),L=Math.cos(t.y),D=Object(i.a)(k-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=r.b?(t.x=this.x0+this.a*(r.d-R)*Math.sin(D),t.y=this.y0-this.a*(r.d-R)*Math.cos(D),t):Math.abs(this.sin_p12+1)<=r.b?(t.x=this.x0+this.a*(r.d+R)*Math.sin(D),t.y=this.y0+this.a*(r.d+R)*Math.cos(D),t):(C=this.sin_p12*j+this.cos_p12*L*Math.cos(D),T=(A=Math.acos(C))/Math.sin(A),t.x=this.x0+this.a*T*L*Math.sin(D),t.y=this.y0+this.a*T*(this.cos_p12*j-this.sin_p12*L*Math.cos(D)),t):(e=Object(a.a)(this.es),n=Object(s.a)(this.es),h=Object(u.a)(this.es),d=Object(l.a)(this.es),Math.abs(this.sin_p12-1)<=r.b?(f=this.a*Object(o.a)(e,n,h,d,r.d),p=this.a*Object(o.a)(e,n,h,d,R),t.x=this.x0+(f-p)*Math.sin(D),t.y=this.y0-(f-p)*Math.cos(D),t):Math.abs(this.sin_p12+1)<=r.b?(f=this.a*Object(o.a)(e,n,h,d,r.d),p=this.a*Object(o.a)(e,n,h,d,R),t.x=this.x0+(f+p)*Math.sin(D),t.y=this.y0+(f+p)*Math.cos(D),t):(m=j/L,g=Object(c.a)(this.a,this.e,this.sin_p12),v=Object(c.a)(this.a,this.e,j),y=Math.atan((1-this.es)*m+this.es*g*this.sin_p12/(v*L)),E=0===(x=Math.atan2(Math.sin(D),this.cos_p12*Math.tan(y)-this.sin_p12*Math.cos(D)))?Math.asin(this.cos_p12*Math.sin(y)-this.sin_p12*Math.cos(y)):Math.abs(Math.abs(x)-Math.PI)<=r.b?-Math.asin(this.cos_p12*Math.sin(y)-this.sin_p12*Math.cos(y)):Math.asin(Math.sin(D)*Math.cos(y)/Math.sin(x)),b=this.e*this.sin_p12/Math.sqrt(1-this.es),A=g*E*(1-(O=E*E)*(M=(_=this.e*this.cos_p12*Math.cos(x)/Math.sqrt(1-this.es))*_)*(1-M)/6+(S=O*E)/8*(w=b*_)*(1-2*M)+(P=S*E)/120*(M*(4-7*M)-3*b*b*(1-7*M))-P*E/48*w),t.x=this.x0+A*Math.sin(x),t.y=this.y0+A*Math.cos(x),t))}function m(t){var e,n,f,p,m,g,v,y,x,b,_,w,M,A,T,C,E,O,S,P,k,R,j;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*r.d*this.a)return;return n=e/this.a,f=Math.sin(n),p=Math.cos(n),m=this.long0,Math.abs(e)<=r.b?g=this.lat0:(g=Object(h.a)(p*this.sin_p12+t.y*f*this.cos_p12/e),v=Math.abs(this.lat0)-r.d,m=Math.abs(v)<=r.b?this.lat0>=0?Object(i.a)(this.long0+Math.atan2(t.x,-t.y)):Object(i.a)(this.long0-Math.atan2(-t.x,t.y)):Object(i.a)(this.long0+Math.atan2(t.x*f,e*this.cos_p12*p-t.y*this.sin_p12*f))),t.x=m,t.y=g,t}return y=Object(a.a)(this.es),x=Object(s.a)(this.es),b=Object(u.a)(this.es),_=Object(l.a)(this.es),Math.abs(this.sin_p12-1)<=r.b?(M=(w=this.a*Object(o.a)(y,x,b,_,r.d))-(e=Math.sqrt(t.x*t.x+t.y*t.y)),g=Object(d.a)(M/this.a,y,x,b,_),m=Object(i.a)(this.long0+Math.atan2(t.x,-1*t.y)),t.x=m,t.y=g,t):Math.abs(this.sin_p12+1)<=r.b?(w=this.a*Object(o.a)(y,x,b,_,r.d),M=(e=Math.sqrt(t.x*t.x+t.y*t.y))-w,g=Object(d.a)(M/this.a,y,x,b,_),m=Object(i.a)(this.long0+Math.atan2(t.x,t.y)),t.x=m,t.y=g,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),C=Math.atan2(t.x,t.y),A=Object(c.a)(this.a,this.e,this.sin_p12),E=Math.cos(C),S=-(O=this.e*this.cos_p12*E)*O/(1-this.es),P=3*this.es*(1-S)*this.sin_p12*this.cos_p12*E/(1-this.es),j=1-S*(R=(k=e/A)-S*(1+S)*Math.pow(k,3)/6-P*(1+3*S)*Math.pow(k,4)/24)*R/2-k*R*R*R/6,T=Math.asin(this.sin_p12*Math.cos(R)+this.cos_p12*Math.sin(R)*E),m=Object(i.a)(this.long0+Math.asin(Math.sin(C)*Math.sin(R)/Math.cos(T))),g=Math.atan((1-this.es*j*this.sin_p12/Math.sin(T))*Math.tan(T)/(1-this.es)),t.x=m,t.y=g,t)}var g=["Azimuthal_Equidistant","aeqd"];e.default={init:f,forward:p,inverse:m,names:g}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=a,e.forward=s,e.inverse=u,n.d(e,"names",function(){return l});var i=n(5),r=n(17),o=n(3);function a(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function s(t){var e,n,r,a,s,u,l,c=t.x,h=t.y;return r=Object(i.a)(c-this.long0),e=Math.sin(h),n=Math.cos(h),a=Math.cos(r),1,((s=this.sin_p14*e+this.cos_p14*n*a)>0||Math.abs(s)<=o.b)&&(u=1*this.a*n*Math.sin(r),l=this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*a)),t.x=u,t.y=l,t}function u(t){var e,n,a,s,u,l,c;return t.x-=this.x0,t.y-=this.y0,e=Math.sqrt(t.x*t.x+t.y*t.y),n=Object(r.a)(e/this.a),a=Math.sin(n),s=Math.cos(n),l=this.long0,Math.abs(e)<=o.b?(c=this.lat0,t.x=l,t.y=c,t):(c=Object(r.a)(s*this.sin_p14+t.y*a*this.cos_p14/e),u=Math.abs(this.lat0)-o.d,Math.abs(u)<=o.b?(l=this.lat0>=0?Object(i.a)(this.long0+Math.atan2(t.x,-t.y)):Object(i.a)(this.long0-Math.atan2(-t.x,t.y)),t.x=l,t.y=c,t):(l=Object(i.a)(this.long0+Math.atan2(t.x*a,e*this.cos_p14*s-t.y*this.sin_p14*a)),t.x=l,t.y=c,t))}var l=["ortho"];e.default={init:a,forward:s,inverse:u,names:l}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=a,e.forward=s,e.inverse=u,n.d(e,"names",function(){return h});var i=n(3),r={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},o={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function a(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=i.d-i.c/2?this.face=r.TOP:this.lat0<=-(i.d-i.c/2)?this.face=r.BOTTOM:Math.abs(this.long0)<=i.c?this.face=r.FRONT:Math.abs(this.long0)<=i.d+i.c?this.face=this.long0>0?r.RIGHT:r.LEFT:this.face=r.BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)}function s(t){var e,n,a,s,u,h,d={x:0,y:0},f={value:0};if(t.x-=this.long0,e=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(t.y)):t.y,n=t.x,this.face===r.TOP)s=i.d-e,n>=i.c&&n<=i.d+i.c?(f.value=o.AREA_0,a=n-i.d):n>i.d+i.c||n<=-(i.d+i.c)?(f.value=o.AREA_1,a=n>0?n-i.n:n+i.n):n>-(i.d+i.c)&&n<=-i.c?(f.value=o.AREA_2,a=n+i.d):(f.value=o.AREA_3,a=n);else if(this.face===r.BOTTOM)s=i.d+e,n>=i.c&&n<=i.d+i.c?(f.value=o.AREA_0,a=-n+i.d):n<i.c&&n>=-i.c?(f.value=o.AREA_1,a=-n):n<-i.c&&n>=-(i.d+i.c)?(f.value=o.AREA_2,a=-n-i.d):(f.value=o.AREA_3,a=n>0?-n+i.n:-n-i.n);else{var p,m,g,v,y,x;this.face===r.RIGHT?n=c(n,+i.d):this.face===r.BACK?n=c(n,+i.n):this.face===r.LEFT&&(n=c(n,-i.d)),v=Math.sin(e),y=Math.cos(e),x=Math.sin(n),p=y*Math.cos(n),m=y*x,g=v,this.face===r.FRONT?a=l(s=Math.acos(p),g,m,f):this.face===r.RIGHT?a=l(s=Math.acos(m),g,-p,f):this.face===r.BACK?a=l(s=Math.acos(-p),g,-m,f):this.face===r.LEFT?a=l(s=Math.acos(-m),g,p,f):(s=a=0,f.value=o.AREA_0)}return h=Math.atan(12/i.n*(a+Math.acos(Math.sin(a)*Math.cos(i.c))-i.d)),u=Math.sqrt((1-Math.cos(s))/(Math.cos(h)*Math.cos(h))/(1-Math.cos(Math.atan(1/Math.cos(a))))),f.value===o.AREA_1?h+=i.d:f.value===o.AREA_2?h+=i.n:f.value===o.AREA_3&&(h+=1.5*i.n),d.x=u*Math.cos(h),d.y=u*Math.sin(h),d.x=d.x*this.a+this.x0,d.y=d.y*this.a+this.y0,t.x=d.x,t.y=d.y,t}function u(t){var e,n,a,s,u,l,h,d,f,p,m,g,v={lam:0,phi:0},y={value:0};if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,n=Math.atan(Math.sqrt(t.x*t.x+t.y*t.y)),e=Math.atan2(t.y,t.x),t.x>=0&&t.x>=Math.abs(t.y)?y.value=o.AREA_0:t.y>=0&&t.y>=Math.abs(t.x)?(y.value=o.AREA_1,e-=i.d):t.x<0&&-t.x>=Math.abs(t.y)?(y.value=o.AREA_2,e=e<0?e+i.n:e-i.n):(y.value=o.AREA_3,e+=i.d),f=i.n/12*Math.tan(e),u=Math.sin(f)/(Math.cos(f)-1/Math.sqrt(2)),l=Math.atan(u),(h=1-(a=Math.cos(e))*a*(s=Math.tan(n))*s*(1-Math.cos(Math.atan(1/Math.cos(l)))))<-1?h=-1:h>1&&(h=1),this.face===r.TOP)d=Math.acos(h),v.phi=i.d-d,y.value===o.AREA_0?v.lam=l+i.d:y.value===o.AREA_1?v.lam=l<0?l+i.n:l-i.n:y.value===o.AREA_2?v.lam=l-i.d:v.lam=l;else if(this.face===r.BOTTOM)d=Math.acos(h),v.phi=d-i.d,y.value===o.AREA_0?v.lam=-l+i.d:y.value===o.AREA_1?v.lam=-l:y.value===o.AREA_2?v.lam=-l-i.d:v.lam=l<0?-l-i.n:-l+i.n;else{var x,b,_;f=(x=h)*x,b=(f+=(_=f>=1?0:Math.sqrt(1-f)*Math.sin(l))*_)>=1?0:Math.sqrt(1-f),y.value===o.AREA_1?(f=b,b=-_,_=f):y.value===o.AREA_2?(b=-b,_=-_):y.value===o.AREA_3&&(f=b,b=_,_=-f),this.face===r.RIGHT?(f=x,x=-b,b=f):this.face===r.BACK?(x=-x,b=-b):this.face===r.LEFT&&(f=x,x=b,b=-f),v.phi=Math.acos(-_)-i.d,v.lam=Math.atan2(b,x),this.face===r.RIGHT?v.lam=c(v.lam,-i.d):this.face===r.BACK?v.lam=c(v.lam,-i.n):this.face===r.LEFT&&(v.lam=c(v.lam,+i.d))}0!==this.es&&(p=v.phi<0?1:0,m=Math.tan(v.phi),g=this.b/Math.sqrt(m*m+this.one_minus_f_squared),v.phi=Math.atan(Math.sqrt(this.a*this.a-g*g)/(this.one_minus_f*g)),p&&(v.phi=-v.phi));return v.lam+=this.long0,t.x=v.lam,t.y=v.phi,t}function l(t,e,n,r){var a;return t<i.b?(r.value=o.AREA_0,a=0):(a=Math.atan2(e,n),Math.abs(a)<=i.c?r.value=o.AREA_0:a>i.c&&a<=i.d+i.c?(r.value=o.AREA_1,a-=i.d):a>i.d+i.c||a<=-(i.d+i.c)?(r.value=o.AREA_2,a=a>=0?a-i.n:a+i.n):(r.value=o.AREA_3,a+=i.d)),a}function c(t,e){var n=t+e;return n<-i.n?n+=i.o:n>+i.n&&(n-=i.o),n}var h=["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"];e.default={init:a,forward:s,inverse:u,names:h}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=p,e.forward=m,e.inverse=g,n.d(e,"names",function(){return v});var i=n(3),r=n(5),o=[[1,2.2199e-17,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],a=[[-5.20417e-18,.0124,1.21431e-18,-8.45284e-11],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],s=.8487,u=1.3523,l=i.i/5,c=1/l,h=18,d=function(t,e){return t[0]+e*(t[1]+e*(t[2]+e*t[3]))},f=function(t,e){return t[1]+e*(2*t[2]+3*e*t[3])};function p(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"}function m(t){var e=Object(r.a)(t.x-this.long0),n=Math.abs(t.y),f=Math.floor(n*l);f<0?f=0:f>=h&&(f=h-1),n=i.i*(n-c*f);var p={x:d(o[f],n)*e,y:d(a[f],n)};return t.y<0&&(p.y=-p.y),p.x=p.x*this.a*s+this.x0,p.y=p.y*this.a*u+this.y0,p}function g(t){var e={x:(t.x-this.x0)/(this.a*s),y:Math.abs(t.y-this.y0)/(this.a*u)};if(e.y>=1)e.x/=o[h][0],e.y=t.y<0?-i.d:i.d;else{var n=Math.floor(e.y*h);for(n<0?n=0:n>=h&&(n=h-1);;)if(a[n][0]>e.y)--n;else{if(!(a[n+1][0]<=e.y))break;++n}var l=a[n],c=5*(e.y-l[0])/(a[n+1][0]-l[0]);c=function(t,e,n,i){for(var r=e;i;--i){var o=t(r);if(r-=o,Math.abs(o)<n)break}return r}(function(t){return(d(l,t)-e.y)/f(l,t)},c,i.b,100),e.x/=d(o[n],c),e.y=(5*n+c)*i.a,t.y<0&&(e.y=-e.y)}return e.x=Object(r.a)(e.x+this.long0),e}var v=["Robinson","robin"];e.default={init:p,forward:m,inverse:g,names:v}},function(t,e){t.exports=1e-6},function(t,e){t.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},function(t,e){t.exports=function(t,e,n){var i=new Float32Array(3);return i[0]=t,i[1]=e,i[2]=n,i}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o);return t}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(n*n+i*i+r*r)}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2];return n*n+i*i+r*r}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],i=t[2];return Math.sqrt(e*e+n*n+i*i)}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}},function(t,e){t.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e,n){"use strict";var i,r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(2),s=n(59),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l='<svg xmlns="http://www.w3.org/2000/svg"><foreignObject width="100%" height="100%"></foreignObject></svg>',c={},h=200,d=15;function f(){var t;for(t=0;t<arguments.length;t+=1)if(isFinite(arguments[t]))return arguments[t]}var p={pointInPolygon:function(t,e,n,i){var r,o,a=!1,s=e.length;if(!(i&&i.min&&i.max&&(t.x<i.min.x||t.y<i.min.y||t.x>i.max.x||t.y>i.max.y))){if(s<3)return!1;for(r=0,o=s-1;r<s;o=r,r+=1)e[r].y>t.y!=e[o].y>t.y&&t.x<(e[o].x-e[r].x)*(t.y-e[r].y)/(e[o].y-e[r].y)+e[r].x&&(a=!a);return n&&a&&n.forEach(function(e){a=a&&!p.pointInPolygon(t,e)}),a}},pointTo2DTriangleBasis:function(t,e,n,i){var r=n.x-e.x,o=i.x-e.x,a=n.y-e.y,s=i.y-e.y,u=t.x-e.x,l=t.y-e.y,c=r*s-o*a;if(c)return{x:(u*s-l*o)/c,y:(u*-a+l*r)/c}},isReadyImage:function(t,e){return!!(t instanceof Image&&t.complete&&t.src&&(t.naturalWidth&&t.naturalHeight||e))},isReadyVideo:function(t,e){return!!(t instanceof HTMLVideoElement&&t.src&&void 0!==t.HAVE_CURRENT_DATA&&(t.videoWidth&&t.videoHeight&&t.readyState>=t.HAVE_CURRENT_DATA||e&&t.error))},isFunction:function(t){return"function"==typeof t},ensureFunction:function(t){return p.isFunction(t)?t:function(){return t}},isNonNullFinite:function(t){return isFinite(t)&&null!==t&&!1!==t&&""!==t},randomString:function(t){var e,n,i;for(t=t||8,e="",n=0;n<t;n+=1)i=Math.floor(Math.random()*u.length),e+=u.substring(i,i+1);return e},normalizeCoordinates:function(t){return t=t||{},Array.isArray(t)?{x:t[0],y:t[1],z:t[2]||0}:{x:f(t.x,t.longitude,t.lng,t.lon,0),y:f(t.y,t.latitude,t.lat,0),z:f(t.z,t.elevation,t.elev,t.height,0)}},range:function(t,e,n){n=n||1;for(var i=[],r=t;r<=e;r+=n)i.push(r);return i},compareArrays:function(t,e){return t.length===e.length&&t.every(function(t,n){return t===e[n]})},vec3AsArray:function(){return[0,0,0]},mat3AsArray:function(){return[1,0,0,0,1,0,0,0,1]},mat4AsArray:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},getGeomBuffer:function(t,e,n,i,r){i=void 0===i?.2:i,r=void 0===r?.1:r;var o=t.sourceByName(e),a=o.data(),s=Math.floor((i+1)*n);if((a=o.data())instanceof Float32Array&&(a.length===n||a.length>=n&&a.length<=s))return a;var u=n;return a instanceof Float32Array&&a.length&&n&&r>0&&(u=Math.floor((r+1)*n)),a=new Float32Array(u),o.setData(a),a},adjustActions:function(t){var e,n;for(n=0;n<t.length;n+=1){if(e=t[n],"string"===a.type(e.input)){var i={};i[e.input]=!0,e.input=i}if(e.modifiers||(e.modifiers={}),"string"===a.type(e.modifiers)){var r={};r[e.modifiers]=!0,e.modifiers=r}}},addAction:function(t,e,n){n?t.push(e):t.unshift(e),p.adjustActions(t)},hasAction:function(t,e,n,i){e&&e.action&&(n=e.name,i=e.owner,e=e.action);for(var r=0;r<t.length;r+=1)if(!(e&&t[r].action!==e||n&&t[r].name!==n||i&&t[r].owner!==i))return t[r];return null},removeAction:function(t,e,n,i){var r,o=0;do{(r=p.hasAction(t,e,n,i))&&(t.splice(a.inArray(r,t),1),o+=1)}while(r);return o},actionMatch:function(t,e,n){var i;if(n.some(function(n){for(var r in n.input)if(n.input.hasOwnProperty(r)&&(!1===n.input[r]&&t[r]||n.input[r]&&!t[r]))return!1;for(var o in n.modifiers)if(n.modifiers.hasOwnProperty(o)&&(!1===n.modifiers[o]&&e[o]||n.modifiers[o]&&!e[o]))return!1;return i=n,!0}))return i},pixelCoordinateParams:function(t,e,n,i,r){var o,s,u;t&&(o=(t=a(t)).innerWidth(),s=t.innerHeight()),i=i||e,r=r||n,u=i!==e||r!==n;var l=Math.min(0,Math.floor(Math.log(Math.min((o||i)/i,(s||r)/r))/Math.log(2))),c=Math.ceil(Math.log(Math.max(e/i,n/r))/Math.log(2));return{map:{node:t,ingcs:"+proj=longlat +axis=esu",gcs:"+proj=longlat +axis=enu",maxBounds:{left:0,top:0,right:e,bottom:n},unitsPerPixel:Math.pow(2,c),center:{x:e/2,y:n/2},min:l,max:c,zoom:l,clampBoundsX:!0,clampBoundsY:!0,clampZoom:!0},layer:{maxLevel:c,wrapX:!1,wrapY:!1,tileOffset:function(){return{x:0,y:0}},attribution:"",tileWidth:i,tileHeight:r,tileRounding:Math.ceil,tilesAtZoom:u?function(t){var o=Math.pow(2,c-t);return{x:Math.ceil(e/i/o),y:Math.ceil(n/r/o)}}:void 0,tilesMaxBounds:u?function(t){var i=Math.pow(2,c-t);return{x:Math.floor(e/i),y:Math.floor(n/i)}}:void 0}}},centerFromPerimeter:function(t){var e,n,i,r,o,a;if(t&&t.length){if(1===t.length)return{x:t[0].x,y:t[0].y};for(e={x:0,y:0},o=0,n=t[t.length-1],a=0;a<t.length;a+=1)i=n,n=t[a],r=Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)),e.x+=(n.x+i.x)*r,e.y+=(n.y+i.y)*r,o+=2*r;return e.x/=o,e.y/=o,o?e:{x:n.x,y:n.y}}},distance2dSquared:function(t,e){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i},distance2dToLineSquared:function(t,e,n){var i=n.x-e.x,r=n.y-e.y,o=i*i+r*r,a=0;return o&&(a=((t.x-e.x)*i+(t.y-e.y)*r)/o,a=Math.max(0,Math.min(1,a))),p.distance2dSquared(t,{x:e.x+a*i,y:e.y+a*r})},triangleTwiceSignedArea2d:function(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)},crossedLineSegments2d:function(t,e,n,i){return!(t.x>n.x&&t.x>i.x&&e.x>n.x&&e.x>i.x||t.x<n.x&&t.x<i.x&&e.x<n.x&&e.x<i.x||t.y>n.y&&t.y>i.y&&e.y>n.y&&e.y>i.y||t.y<n.y&&t.y<i.y&&e.y<n.y&&e.y<i.y)&&(!(t.x===n.x&&t.y===n.y||t.x===i.x&&t.y===i.y||e.x===n.x&&e.y===n.y||e.x===i.x&&e.y===i.y)&&!(p.triangleTwiceSignedArea2d(t,e,n)*p.triangleTwiceSignedArea2d(t,e,i)>0||p.triangleTwiceSignedArea2d(n,i,t)*p.triangleTwiceSignedArea2d(n,i,e)>0))},segmentCrossesLineList2d:function(t,e,n){return n.some(function(n){return n.some(function(i,r){if(r)return p.crossedLineSegments2d(t,e,n[r-1],i)})})},rdpLineSimplify:function(t,e,n,i){if(t.length<=2||e<0)return t;var r,o,a,s=-1,u=e*e;if(n){for(r=1;r<t.length;r+=1)(o=p.distance2dSquared(t[0],t[r]))>s&&(s=o,a=r);return 4*s<=u?t.slice(a,a+1):(t=t.slice(a).concat(t.slice(0,a+1)),(t=p.rdpLineSimplify(t,e,!1,i)).splice(t.length-1),t)}for(r=1;r<t.length-1;r+=1)(o=p.distance2dToLineSquared(t[r],t[0],t[t.length-1]))>s&&(s=o,a=r);if(s<=u&&(!i||!p.segmentCrossesLineList2d(t[0],t[t.length-1],i)))return[t[0],t[t.length-1]];var l=t.slice(0,a+1),c=t.slice(a),h=p.rdpLineSimplify(l,e,!1,i?i.concat([c]):null),d=p.rdpLineSimplify(c,e,!1,i?i.concat([l]):null);return h.slice(0,h.length-1).concat(d)},getMinMaxValues:function(t,e,n,i){if(t.length&&(i||!a.isNumeric(e)||!a.isNumeric(n))){var r,o,s=t[0],u=t[0];for(o=t.length-1;o>0;o-=1)(r=t[o])<s&&(s=r),r>u&&(u=r);(!a.isNumeric(e)||i&&s>e)&&(e=s),(!a.isNumeric(n)||i&&u<n)&&(n=u)}return{min:e,max:n}},wrapAngle:function(t){return(t%=2*Math.PI)<-Math.PI?t+=2*Math.PI:t>=Math.PI&&(t-=2*Math.PI),t},escapeUnicodeHTML:function(t){return t.replace(/./g,function(t){var e=t.charCodeAt();return e<127?t:"&#"+e.toString(10)+";"})},dereferenceElements:function(t){var e=[];return a("img,image",t).each(function(){var t=a(this),n=t.is("image")?"href":"src";if(t.attr(n)){var i=new Image;("http"===t.attr(n).substr(0,4)||t[0].crossOrigin)&&(i.crossOrigin=t[0].crossOrigin||"anonymous");var r=a.Deferred();i.onload=function(){var e=document.createElement("canvas");e.width=i.naturalWidth,e.height=i.naturalHeight,e.getContext("2d").drawImage(i,0,0),t.attr(n,e.toDataURL("image/png")),"data:image"!==t.attr(n).substr(0,10)&&t.remove(),r.resolve()},i.onerror=function(){t.remove(),r.resolve()},i.src=t.attr(n),e.push(r)}}),e},dereferenceCssUrlsRegex:/url\(["']?(http[^)"']+|[^:)"']+)["']?\)/g,dereferenceCssUrls:function(t,e,n,i,r){var o=[],s=[];if(t=(t=t.replace(/\/\*[^\0]*?\*\//g,"")).replace(/\r/g,"\n").replace(/\s+\n/g,"\n").replace(/\n\s+/g,"\n").replace(/\n\n+/g,"\n"),r){var u=/(^[^?#]*)\/[^?#/]*([?#]|$)/g.exec(r);r=u&&u[1]?u[1]+"/":null}t.replace(p.dereferenceCssUrlsRegex,function(t,e){var n=o.length,i=a.Deferred(),u=new XMLHttpRequest;return o.push(i),s.push(""),/^[^/:][^:]*(\/|$)/g.exec(e)&&r&&(e=r+e),u.open("GET",e,!0),u.responseType="arraybuffer",u.onload=function(){if(200===this.status){var t,e=new Uint8Array(this.response),r=new Array(e.length);for(t=0;t<e.length;t+=1)r[t]=String.fromCharCode(e[t]);r=r.join(""),s[n]="url(data:"+u.getResponseHeader("content-type")+";base64,"+btoa(r)+")"}i.resolve()},u.onerror=i.resolve,u.send(),t}),a.when.apply(a,o).then(function(){var r=0;t=t.replace(p.dereferenceCssUrlsRegex,function(t,e){return s[(r+=1)-1]}),void 0===i?e.text(t):e.style[i]=t,n.resolve()})},htmlToImageSupported:function(){if(void 0===r){var t=a.Deferred(),e=a(l);e.attr({width:"10px",height:"10px","text-rendering":"optimizeLegibility"}),a("foreignObject",e).append("<div/>");var n=new Image;return n.onload=n.onerror=function(){var e=document.createElement("canvas");e.width=10,e.height=10,e.getContext("2d").drawImage(n,0,0);try{e.toDataURL(),r=!0}catch(t){console.warn("This browser does not support converting HTML to an image via SVG foreignObject.  Some functionality will be limited.",t),r=!1}t.resolve(r)},n.src="data:image/svg+xml;base64,"+btoa(p.escapeUnicodeHTML((new XMLSerializer).serializeToString(e[0]))),t}return r},htmlToImage:function(t,e){var n,i=a.Deferred(),r=[p.htmlToImageSupported()],o=a(t);for(t=a(t).clone();e&&e>0;)(o=o.parent()).is("div")&&((n=a("<div>").attr({class:o.attr("class"),id:o.attr("id")}).css({width:"100%",height:"100%",background:"none",margin:0})).append(t),t=n),e-=1;a("canvas",t).remove(),a("*",t).addBack().each(function(){for(var t=this.style,e=0;e<t.length;e+=1){var n=this.style[e];if(this.style[n].match(p.dereferenceCssUrlsRegex)){var i=a.Deferred();p.dereferenceCssUrls(this.style[n],this,i,n),r.push(i)}}}),(n=a('<div xmlns="http://www.w3.org/1999/xhtml">')).css({width:o.width()+"px",height:o.height()+"px"}),n.append(a("<head>"));var s=a("<body>");return n.append(s),s.css({width:o.width()+"px",height:o.height()+"px",background:"none",margin:0}),s.append(t),r=r.concat(p.dereferenceElements(t)),a('style,link[rel="stylesheet"]').each(function(){var t=a('<style type="text/css">'),e=a.Deferred();if(a(this).is("style")){var i=a(this).text();p.dereferenceCssUrls(i,t,e)}else{var o=a(this).attr("href");a.get(o).done(function(n){p.dereferenceCssUrls(n,t,e,void 0,o)}).fail(function(n,i,r){console.warn("Failed to dereference "+o,i,r),t.remove(),e.resolve()})}r.push(e),a("head",n).append(t)}),a.when.apply(a,r).then(function(){var t=a(l);t.attr({width:o.width()+"px",height:o.height()+"px","text-rendering":"optimizeLegibility"}),a("foreignObject",t).append(n);var e=new Image;p.htmlToImageSupported()?(e.onload=function(){i.resolve(e)},e.onerror=function(){console.warn("Failed to render html to image"),i.reject()},e.src="data:image/svg+xml;base64,"+btoa(p.escapeUnicodeHTML((new XMLSerializer).serializeToString(t[0])))):i.resolve(e)}),i},timeReport:function(t){return a.each(c,function(t,e){e.count?(e.stddev=Math.sqrt(Math.abs((e.sum2-e.sum*e.sum/e.count)/e.count)),e.average=e.sum/e.count):(e.stddev=0,e.average=0)}),t?c[t]:c},timeFunctionStart:function(t,e){c[t]&&!e||(c[t]={count:0,sum:0,sum2:0,max:0,recent:[]}),c[t].start=window.performance.now()},timeFunctionStop:function(t){if(c[t]&&c[t].start){var e=window.performance.now()-c[t].start;c[t].start=null,c[t].sum+=e,c[t].sum2+=e*e,c[t].count+=1,c[t].max=Math.max(c[t].max,e),c[t].recent.push(e),c[t].recent.length>h&&c[t].recent.splice(0,c[t].recent.length-h)}},timeRequestAnimationFrame:function(t,e,n,r){c.requestAnimationFrame&&!e||(c.requestAnimationFrame={count:0,sum:0,sum2:0,max:0,above_threshold:0,recent:[],recentsub:[]}),n&&(d=n),r&&(h=r),t&&i?(window.requestAnimationFrame=i,i=null):t||i||(i=window.requestAnimationFrame,window.requestAnimationFrame=function(t){return i.call(window,function(e){var n,i=c.requestAnimationFrame;i.timestamp!==e&&(i.nowDelta=window.performance.now()-e,Math.abs(i.nowDelta)<1e3&&(i.nowDelta=0),i.timestamp=e,i.subcalls=i.subcalls||0,i.start={sum:i.sum,sum2:i.sum2,count:i.count,max:i.max,above_threshold:i.above_threshold},i.recent.push([0]),i.recentsub.push([]),i.recent.length>h&&(i.recent.splice(0,i.recent.length-h),i.recentsub.splice(0,i.recentsub.length-h))),i.subcalls+=1,t.apply(this,arguments);var r=window.performance.now()-e;r-=i.nowDelta,i.sum=i.start.sum+r,i.sum2=i.start.sum2+r*r,i.count=i.start.count+1,i.max=Math.max(i.max,r),i.above_threshold=i.start.above_threshold+(r>=d?1:0),i.recent[i.recent.length-1]=r,(n=i.recentsub[i.recent.length-1]).push({total_duration:r,duration:r-(n.length?n[n.length-1].total_duration:0),callback:t.name||t})})})},isObject:function(t){var e=void 0===t?"undefined":o(t);return null!==t&&void 0!==t&&("object"===e||"function"===e)},radiusEarth:(s=s.__esModule?s.default:s).WGS84.a};t.exports=p},function(t,e,n){t.exports={create:n(235),clone:n(236),fromValues:n(237),copy:n(238),set:n(239),add:n(240),subtract:n(241),multiply:n(242),divide:n(243),min:n(244),max:n(245),scale:n(113),scaleAndAdd:n(246),distance:n(247),squaredDistance:n(248),length:n(249),squaredLength:n(250),negate:n(251),inverse:n(252),normalize:n(114),dot:n(253),lerp:n(254),random:n(255),transformMat4:n(256),transformQuat:n(257)}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n*n+i*i+r*r+o*o;a>0&&(a=1/Math.sqrt(a),t[0]=n*a,t[1]=i*a,t[2]=r*a,t[3]=o*a);return t}},function(t,e,n){"use strict";var i=n(2),r={};r.Util={stamp:function(t){return t._leaflet_id=t._leaflet_id||++r.Util.lastId,t._leaflet_id},lastId:0};var o=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}};o.prototype={addObject:function(t,e){var n=this._getCoord(e.x),i=this._getCoord(e.y),o=this._grid,a=o[i]=o[i]||{},s=a[n]=a[n]||[],u=r.Util.stamp(t);e.obj=t,this._objectPoint[u]=e,s.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var n,i,o=this._getCoord(e.x),a=this._getCoord(e.y),s=this._grid,u=s[a]=s[a]||{},l=u[o]=u[o]||[];for(delete this._objectPoint[r.Util.stamp(t)],n=0,i=l.length;n<i;n++)if(l[n]===t)return l.splice(n,1),1===i&&delete u[o],!0},eachObject:function(t,e){var n,i,r,o,a,s,u=this._grid;for(n in u)for(i in a=u[n])for(r=0,o=(s=a[i]).length;r<o;r++)t.call(e,s[r])&&(r--,o--)},getNearObject:function(t){var e,n,i,o,a,s,u,l,c=this._getCoord(t.x),h=this._getCoord(t.y),d=this._objectPoint,f=this._sqCellSize,p=null;for(e=h-1;e<=h+1;e++)if(o=this._grid[e])for(n=c-1;n<=c+1;n++)if(a=o[n])for(i=0,s=a.length;i<s;i++)u=a[i],(l=this._sqDist(d[r.Util.stamp(u)],t))<f&&(f=l,p=u);return p},contents:function(){return i.map(this._objectPoint,function(t){return t})},_getCoord:function(t){return Math.floor(t/this._cellSize)},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}},t.exports=o},function(t,e,n){"use strict";var i=n(2);function r(t,e,n){this._group=t,this._zoom=e,this._points=[],this._clusters=[],this._count=0,this._parent=null,this._coord=null;var i=this;(n||[]).forEach(function(t){i._add(t)})}function o(t){var e,o,a=n(115);for(this._opts=i.extend({maxZoom:18,radius:5},t),this._clusters={},this._points={},e=this._opts.maxZoom;e>=0;e-=1)o=this._opts.radius*Math.pow(2,-e),this._clusters[e]=new a(o),this._points[e]=new a(o);this._topClusterLevel=new r(this,-1)}r.prototype._add=function(t){var e=1;t instanceof r?(this._clusters.push(t),e=t._count):this._points.push(t),t._parent=this,this._increment(e)},r.prototype._increment=function(t){this._coord=null,this._count+=t,this._parent&&this._parent._increment(t)},r.prototype.count=function(){return this._count},r.prototype.each=function(t){var e;for(e=0;e<this._points.length;e+=1)t.call(this,this._points[e],this._zoom);for(e=0;e<this._clusters.length;e+=1)this._clusters[e].each.call(this._clusters[e],t)},r.prototype.coords=function(){var t,e={x:0,y:0};if(this._coord)return this._coord;for(t=0;t<this._points.length;t+=1)e.x+=this._points[t].x,e.y+=this._points[t].y;for(t=0;t<this._clusters.length;t+=1)e.x+=this._clusters[t].coords().x*this._clusters[t].count(),e.y+=this._clusters[t].coords().y*this._clusters[t].count();return{x:e.x/this.count(),y:e.y/this.count()}},o.prototype.addPoint=function(t){var e,n,o,a,s,u;for(e=this._opts.maxZoom;e>=0;e-=1){if(n=this._clusters[e].getNearObject(t))return void n._add(t);if(n=this._points[e].getNearObject(t)){if(o=n._parent)for(u=o._points.length-1;u>=0;u-=1)if(o._points[u]===n){o._points.splice(u,1),o._increment(-1);break}for(o||i.noop(),a=new r(this,e,[n,t]),this._clusters[e].addObject(a,a.coords()),s=a,u=e-1;u>o._zoom;u-=1)s=new r(this,u,[s]),this._clusters[u].addObject(s,s.coords());for(o._add(s),u=e;u>=0&&this._points[u].removeObject(n,n);u-=1);return}this._points[e].addObject(t,t)}this._topClusterLevel._add(t)},o.prototype.points=function(t){return t=Math.min(Math.max(Math.floor(t),0),this._opts.maxZoom-1),this._points[Math.floor(t)].contents()},o.prototype.clusters=function(t){return t=Math.min(Math.max(Math.floor(t),0),this._opts.maxZoom-1),this._clusters[Math.floor(t)].contents()},t.exports=o},function(t,e,n){var i;!function(r,o,a){if(r){for(var s,u={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},l={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},c={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},h={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},d=1;d<20;++d)u[111+d]="f"+d;for(d=0;d<=9;++d)u[d+96]=d.toString();y.prototype.bind=function(t,e,n){return t=t instanceof Array?t:[t],this._bindMultiple.call(this,t,e,n),this},y.prototype.unbind=function(t,e){return this.bind.call(this,t,function(){},e)},y.prototype.trigger=function(t,e){return this._directMap[t+":"+e]&&this._directMap[t+":"+e]({},t),this},y.prototype.reset=function(){return this._callbacks={},this._directMap={},this},y.prototype.stopCallback=function(t,e){if((" "+e.className+" ").indexOf(" mousetrap ")>-1)return!1;if(function t(e,n){return null!==e&&e!==o&&(e===n||t(e.parentNode,n))}(e,this.target))return!1;if("composedPath"in t&&"function"==typeof t.composedPath){var n=t.composedPath()[0];n!==t.target&&(e=n)}return"INPUT"==e.tagName||"SELECT"==e.tagName||"TEXTAREA"==e.tagName||e.isContentEditable},y.prototype.handleKey=function(){return this._handleKey.apply(this,arguments)},y.addKeycodes=function(t){for(var e in t)t.hasOwnProperty(e)&&(u[e]=t[e]);s=null},y.init=function(){var t=y(o);for(var e in t)"_"!==e.charAt(0)&&(y[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e))},y.init(),r.Mousetrap=y,void 0!==t&&t.exports&&(t.exports=y),void 0===(i=function(){return y}.call(e,n,e,t))||(t.exports=i)}function f(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}function p(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return u[t.which]?u[t.which]:l[t.which]?l[t.which]:String.fromCharCode(t.which).toLowerCase()}function m(t){return"shift"==t||"ctrl"==t||"alt"==t||"meta"==t}function g(t,e,n){return n||(n=function(){if(!s)for(var t in s={},u)t>95&&t<112||u.hasOwnProperty(t)&&(s[u[t]]=t);return s}()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}function v(t,e){var n,i,r,o=[];for(n=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t),r=0;r<n.length;++r)i=n[r],h[i]&&(i=h[i]),e&&"keypress"!=e&&c[i]&&(i=c[i],o.push("shift")),m(i)&&o.push(i);return{key:i,modifiers:o,action:e=g(i,o,e)}}function y(t){var e=this;if(t=t||o,!(e instanceof y))return new y(t);e.target=t,e._callbacks={},e._directMap={};var n,i={},r=!1,a=!1,s=!1;function u(t){t=t||{};var e,n=!1;for(e in i)t[e]?n=!0:i[e]=0;n||(s=!1)}function l(t,n,r,o,a,s){var u,l,c,h,d=[],f=r.type;if(!e._callbacks[t])return[];for("keyup"==f&&m(t)&&(n=[t]),u=0;u<e._callbacks[t].length;++u)if(l=e._callbacks[t][u],(o||!l.seq||i[l.seq]==l.level)&&f==l.action&&("keypress"==f&&!r.metaKey&&!r.ctrlKey||(c=n,h=l.modifiers,c.sort().join(",")===h.sort().join(",")))){var p=!o&&l.combo==a,g=o&&l.seq==o&&l.level==s;(p||g)&&e._callbacks[t].splice(u,1),d.push(l)}return d}function c(t,n,i,r){e.stopCallback(n,n.target||n.srcElement,i,r)||!1===t(n,i)&&(function(t){t.preventDefault?t.preventDefault():t.returnValue=!1}(n),function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}(n))}function h(t){"number"!=typeof t.which&&(t.which=t.keyCode);var n=p(t);n&&("keyup"!=t.type||r!==n?e.handleKey(n,function(t){var e=[];return t.shiftKey&&e.push("shift"),t.altKey&&e.push("alt"),t.ctrlKey&&e.push("ctrl"),t.metaKey&&e.push("meta"),e}(t),t):r=!1)}function d(t,e,o,a){function l(e){return function(){s=e,++i[t],clearTimeout(n),n=setTimeout(u,1e3)}}function h(e){c(o,e,t),"keyup"!==a&&(r=p(e)),setTimeout(u,10)}i[t]=0;for(var d=0;d<e.length;++d){var f=d+1===e.length?h:l(a||v(e[d+1]).action);g(e[d],f,a,t,d)}}function g(t,n,i,r,o){e._directMap[t+":"+i]=n;var a,s=(t=t.replace(/\s+/g," ")).split(" ");s.length>1?d(t,s,n,i):(a=v(t,i),e._callbacks[a.key]=e._callbacks[a.key]||[],l(a.key,a.modifiers,{type:a.action},r,t,o),e._callbacks[a.key][r?"unshift":"push"]({callback:n,modifiers:a.modifiers,action:a.action,seq:r,level:o,combo:t}))}e._handleKey=function(t,e,n){var i,r=l(t,e,n),o={},h=0,d=!1;for(i=0;i<r.length;++i)r[i].seq&&(h=Math.max(h,r[i].level));for(i=0;i<r.length;++i)if(r[i].seq){if(r[i].level!=h)continue;d=!0,o[r[i].seq]=1,c(r[i].callback,n,r[i].combo,r[i].seq)}else d||c(r[i].callback,n,r[i].combo);var f="keypress"==n.type&&a;n.type!=s||m(t)||f||u(o),a=d&&"keydown"==n.type},e._bindMultiple=function(t,e,n){for(var i=0;i<t.length;++i)g(t[i],e,n)},f(t,"keypress",h),f(t,"keydown",h),f(t,"keyup",h)}}("undefined"!=typeof window?window:null,"undefined"!=typeof window?document:null)},function(t,e,n){"use strict";var i=n(0),r=n(11),o=n(4),a=n(119),s=n(36),u=n(23),l=n(112),c=function t(e){if(!(this instanceof t))return new t(e);var i=n(6);return e=e||{},r.call(this,e),this._view=o.mat4AsArray(),this._proj=o.mat4AsArray(),this._projection=null,this._transform=o.mat4AsArray(),this._inverse=o.mat4AsArray(),this._bounds=null,this._display=null,this._world=null,this._viewport={width:1,height:1},this._createProj=function(){var t="perspective"===this._projection?u.frustum:u.ortho,e=this._clipbounds[this._projection];t(this._proj,e.left,e.right,e.bottom,e.top,e.near,e.far)},this._update=function(){this._bounds=null,this._display=null,this._world=null,this._transform=u.multiply(o.mat4AsArray(),this._proj,this._view),u.invert(this._inverse,this._transform),this.geoTrigger(i.camera.view,{camera:this})},Object.defineProperty(this,"view",{get:function(){return this._view},set:function(t){u.copy(this._view,t),this._update()},configurable:!0}),Object.defineProperty(this,"bounds",{get:function(){return null===this._bounds&&(this._bounds=this._getBounds()),this._bounds},set:function(t){this._setBounds(t),this._update()}}),Object.defineProperty(this,"clipbounds",{get:function(){return this._clipbounds[this._projection]},set:function(t){var e=this._clipbounds[this._projection];if((t={left:void 0===t.left?e.left:t.left,right:void 0===t.right?e.right:t.right,top:void 0===t.top?e.top:t.top,bottom:void 0===t.bottom?e.bottom:t.bottom,near:void 0===t.near?e.near:t.near,far:void 0===t.far?e.far:t.far}).left===t.right)throw new Error("Left and right values must be different");if(t.top===t.bottom)throw new Error("Top and bottom values must be different");if(t.near===t.far)throw new Error("Near and far values must be different");this._clipbounds[this._projection]=t,this._createProj(),this._update()}}),Object.defineProperty(this,"display",{get:function(){if(null===this._display){var t=this._clipbounds[this._projection],e=o.mat4AsArray();u.translate(e,e,[this.viewport.width/2,this.viewport.height/2,0]),u.scale(e,e,[this.viewport.width/(t.right-t.left),this.viewport.height/(t.bottom-t.top),1]),u.translate(e,e,[-(t.left+t.right)/2,-(t.top+t.bottom)/2,0]),u.multiply(e,e,this._transform),this._display=e}return this._display}}),Object.defineProperty(this,"world",{get:function(){return null===this._world&&(this._world=u.invert(o.mat4AsArray(),this.display)),this._world}}),Object.defineProperty(this,"projection",{get:function(){return this._projection},set:function(t){if(!this.constructor.projection[t])throw new Error("Unsupported projection type: "+t);t!==this._projection&&(this._projection=t,this._createProj(),this._update(),this.geoTrigger(i.camera.projection,{camera:this,projection:t}))}}),Object.defineProperty(this,"projectionMatrix",{get:function(){return this._proj}}),Object.defineProperty(this,"transform",{get:function(){return this._transform}}),Object.defineProperty(this,"inverse",{get:function(){return this._inverse}}),Object.defineProperty(this,"viewport",{get:function(){return{width:this._viewport.width,height:this._viewport.height,left:this._viewport.left,top:this._viewport.top}},set:function(t){if(!(t.width>0&&t.height>0))throw new Error("Invalid viewport dimensions");t.width===this._viewport.width&&t.height===this._viewport.height||(this._viewport.width&&this._viewport.height&&(this._scale([this._viewport.width/t.width,this._viewport.height/t.height,1]),this._translate([(t.width-this._viewport.width)/2,(t.height-this._viewport.height)/2,0])),this._viewport={width:t.width,height:t.height,left:t.left,top:t.top},this._update(),this.geoTrigger(i.camera.viewport,{camera:this,viewport:this.viewport}))}}),this._resetView=function(){return u.identity(this._view),this},this._translate=function(t){return u.translate(this._view,this._view,t),this},this._scale=function(t){return u.scale(this._view,this._view,t),this},this._worldToClip4=function(t){return l.transformMat4(t,t,this._transform)},this._clipToWorld4=function(t){return l.transformMat4(t,t,this._inverse)},this.applyProjection=function(t){var e;return"perspective"===this._projection?(e=1/(t[3]||1),t[0]=e*t[0],t[1]=e*t[1],t[2]=e*t[2],t[3]=e):t[3]=1,t},this.unapplyProjection=function(t){var e;return"perspective"===this._projection?(e=t[3]||1,t[0]=e*t[0],t[1]=e*t[1],t[2]=e*t[2],t[3]=e):t[3]=1,t},this.worldToDisplay4=function(t){return t=[t[0],t[1],t[2]||0,t[3]||1],(t=l.transformMat4(t,t,this.display))[3]&&1!==t[3]&&(t=[t[0]/t[3],t[1]/t[3],t[2]/t[3],1]),t},this.displayToWorld4=function(t){return t=[t[0],t[1],t[2]||0,t[3]||1],(t=l.transformMat4(t,t,this.world))[3]&&1!==t[3]&&(t=[t[0]/t[3],t[1]/t[3],t[2]/t[3],1]),t},this.worldToDisplay=function(t){var e=this._clipbounds[this._projection];return{x:(t=this.worldToDisplay4([t.x,t.y,-e.near]))[0],y:t[1]}},this.displayToWorld=function(t){return{x:(t=this.displayToWorld4([t.x,t.y,-1]))[0],y:t[1]}},this._getBounds=function(){var t,e,n,i,r={};return t=this.displayToWorld({x:0,y:0}),e=this.displayToWorld({x:this._viewport.width,y:0}),n=this.displayToWorld({x:0,y:this._viewport.height}),i=this.displayToWorld({x:this._viewport.width,y:this._viewport.height}),r.left=Math.min(t.x,e.x,n.x,i.x),r.bottom=Math.min(t.y,e.y,n.y,i.y),r.right=Math.max(t.x,e.x,n.x,i.x),r.top=Math.max(t.y,e.y,n.y,i.y),r},this._setBounds=function(t){var e={width:t.right-t.left,height:t.top-t.bottom},n={x:(t.left+t.right)/2,y:(t.bottom+t.top)/2};return this._viewFromCenterSizeRotation(n,e,0),this},this._viewFromCenterSizeRotation=function(t,e,n){var i,r,a,s=o.vec3AsArray(),u=o.vec3AsArray();return this._resetView(),(r=Math.abs(e.width))/(a=Math.abs(e.height))>=(i=this._viewport.width/this._viewport.height)?(a=r/i,u[0]=2/r,u[1]=2/a):(r=a*i,u[0]=2/r,u[1]=2/a),u[2]=1,this._scale(u),n&&this._rotate(n),s[0]=-t.x,s[1]=-t.y,s[2]=0,this._translate(s),this},this.viewFromCenterSizeRotation=function(t,e,n){return this._viewFromCenterSizeRotation(t,e,n),this._update(),this},this.pan=function(t){if(t.x||t.y||t.z)return this._translate([t.x,t.y,t.z||0]),this._update(),this},this.zoom=function(t){if(1!==t)return u.scale(this._view,this._view,[t,t,t]),this._update(),this},this._rotate=function(t,e,n){if(t){n=n||[0,0,-1],e?void 0!==e.x&&(e=[e.x||0,e.y||0,e.z||0]):e=[0,0,0];var i=[-e[0],-e[1],-e[2]];return u.translate(this._view,this._view,e),u.rotate(this._view,this._view,t,n),u.translate(this._view,this._view,i),this}},this.css=function(e){var n;switch((e||"").toLowerCase()){case"display":case"":n=this.display;break;case"world":n=this.world;break;default:throw new Error("Unknown transform "+e)}return t.css(n)},this.ppMatrix=function(t,e){var n=t;function i(t){var i=n[t],r=i.toExponential(e);return i>=0&&(r=" "+r),r}return e=e||2,[[i(0),i(4),i(8),i(12)].join(" "),[i(1),i(5),i(9),i(13)].join(" "),[i(2),i(6),i(10),i(14)].join(" "),[i(3),i(7),i(11),i(15)].join(" ")].join("\n")},this.toString=function(){return this.ppMatrix(this._transform)},this.debug=function(){return["bounds",JSON.stringify(this.bounds),"view:",this.ppMatrix(this._view),"projection:",this.ppMatrix(this._proj),"transform:",this.ppMatrix(this._transform)].join("\n")},this.valueOf=function(){return this._transform},this._clipbounds=this.constructor.clipbounds,this._resetView(),this.projection=e.projection||"parallel",e.viewport&&(this.viewport=e.viewport),this._update(),this};c.projection={perspective:!0,parallel:!0},c.clipbounds={perspective:{left:-1,right:1,top:1,bottom:-1,far:2e3,near:.01},parallel:{left:-1,right:1,top:1,bottom:-1,far:-1,near:1}},c.css=function(t){return"matrix3d("+t.map(function(t){return(t=(+t).toPrecision(15)).indexOf("e")>=0?t=(+t).toString():t.indexOf(".")>=0&&(t=t.replace(/(\.|)0+$/,"")),t}).join(",")+")"},c.vec3=s,c.mat3=a,c.vec4=l,c.mat4=u,i(c,r),t.exports=c},function(t,e,n){t.exports={adjoint:n(267),clone:n(268),copy:n(269),create:n(270),determinant:n(271),frob:n(272),fromMat2:n(273),fromMat4:n(274),fromQuat:n(275),identity:n(276),invert:n(277),multiply:n(278),normalFromMat4:n(279),rotate:n(280),scale:n(281),str:n(282),translate:n(283),transpose:n(284)}},function(t,e,n){"use strict";var i=n(0),r=n(8),o=function t(e){if(!(this instanceof t))return new t(e);e=e||{},r.call(this,e);var i=n(2),o=n(4).ensureFunction;delete e.layer,delete e.renderer;var a=n(10).d3,s=this,u=this._init,l=i.extend({},{colorRange:[{r:.07514311,g:.468049805,b:1},{r:.468487184,g:.588057293,b:1},{r:.656658579,g:.707001303,b:1},{r:.821573924,g:.837809045,b:1},{r:.943467973,g:.943498599,b:.943398095},{r:1,g:.788626485,b:.750707739},{r:1,g:.6289553,b:.568237474},{r:1,g:.472800903,b:.404551679},{r:.916482116,g:.236630659,b:.209939162}],scale:a.scale.quantize(),geoId:function(t){return t.properties.GEO_ID},scalarId:function(t){return t.id},scalarValue:function(t){return t.value}},e);return this.featureType="choropleth",this.scalar=function(t,e){var n,i;return void 0===t?s.choropleth.get("scalar")()||[]:(n=s.choropleth.get("scalarId"),i=s.choropleth.get("scalarValue"),l.scalar=t,l.scalarAggregator=e||a.mean,l.scalar._dictionary=t.reduce(function(t,e){var r,o;return r=n(e),o=i(e),t[r]=t[r]?t[r].push(o):[o],t},{}),s.dataTime().modified(),s)},this.choropleth=function(t,e){var n;return void 0===t?l:"string"==typeof t&&void 0===e?l[t]:(void 0===e?(n=i.extend({},l,t),l=n):l[t]=e,s.modified(),s)},this.choropleth.get=function(t){var e,n={};if(void 0===t){for(e in l)l.hasOwnProperty(e)&&(n[e]=s.choropleth.get(e));return n}return o(l[t])},this._featureToPolygons=function(t,e){var n=s.layer().createFeature("polygon",{});return"Polygon"===t.geometry.type?n.data([{type:"Polygon",coordinates:t.geometry.coordinates}]):"MultiPolygon"===t.geometry.type&&n.data(t.geometry.coordinates.map(function(t){return{type:"Polygon",coordinates:t}})),n.polygon(function(t){return{outer:t.coordinates[0],inner:t.coordinates[1]}}).position(function(t){return{x:t[0],y:t[1]}}).style({fillColor:e}),n},this._generateScale=function(t){var e=a.extent(s.scalar(),t||void 0);return s.choropleth().scale.domain(e).range(s.choropleth().colorRange),s},this.createChoropleth=function(){var t=s.choropleth,e=s.data(),n=s.scalar(),i=t.get("scalarValue"),r=t.get("geoId");return s._generateScale(i),e.map(function(e){var i=r(e),o=n._dictionary[i],a=t().scalarAggregator(o),u=s.choropleth().scale(a);return s._featureToPolygons(e,u)})},this._init=function(t){return u.call(s,t),l&&s.dataTime().modified(),s},this._init(e),this};i(o,r),t.exports=o},function(t,e,n){"use strict";t.exports="geo_svg_rescale"},function(t,e,n){"use strict";var i=n(0),r=n(53),o=function t(e){if(!(this instanceof t))return new t(e);var i=n(2),o=n(4);e=e||{},r.call(this,e);var a=this,s=this._init;return this._createContours=function(){var t,e,n,r,s,u=a.contour,l=a.style.get("value"),c=void 0!==a.style("used")?a.style.get("used"):function(t,e){return o.isNonNullFinite(l(t,e))},h=a._createMesh({used:c,opacity:a.style.get("opacity"),value:l});if(!h.numVertices||!h.numElements)return h;var d=u.get("stepped")(h),f=u.get("opacityRange")(h),p=u.get("rangeValues")(h);if(h.stepped=!(void 0!==d&&!d),h.colorMap=[],h.minColor=i.extend({a:u.get("minOpacity")(h)||0},o.convertColor(u.get("minColor")(h))),h.maxColor=i.extend({a:u.get("maxOpacity")(h)||0},o.convertColor(u.get("maxColor")(h))),u.get("colorRange")(h).forEach(function(t,e){h.colorMap.push(i.extend({a:f&&void 0!==f[e]?f[e]:1},o.convertColor(t)))}),t=o.getMinMaxValues(h.value,u.get("min")(h),u.get("max")(h)),h.minValue=t.min,h.maxValue=t.max,p&&p.length===h.colorMap.length+1||(p=null),p)for(s=1;s<p.length;s+=1)if(p[s-1]>p[s]){p=null;break}for(p&&(h.minValue=p[0],h.maxValue=p[p.length-1]),(n=h.maxValue-h.minValue)||(h.colorMap=h.colorMap.slice(0,1),n=1,p=null),h.rangeValues=p,h.factor=h.colorMap.length/n,r=0;r<h.numVertices;r+=1)if(e=h.value[r],p&&e>=h.minValue&&e<=h.maxValue){for(s=1;s<p.length;s+=1)if(e<=p[s]){h.value[r]=s-1+(e-p[s-1])/(p[s]-p[s-1]);break}}else h.value[r]=(e-h.minValue)*h.factor;return h},this.contour=a.mesh,this._init=function(t){s.call(a,t);var e=i.extend({},{opacity:1,value:function(t,e){return a.position()(t,e).z}},void 0===t.style?{}:t.style);a.style(e),a.contour(i.extend({},{minColor:"black",minOpacity:0,maxColor:"black",maxOpacity:0,colorRange:[{r:.07514311,g:.468049805,b:1},{r:.468487184,g:.588057293,b:1},{r:.656658579,g:.707001303,b:1},{r:.821573924,g:.837809045,b:1},{r:.943467973,g:.943498599,b:.943398095},{r:1,g:.788626485,b:.750707739},{r:1,g:.6289553,b:.568237474},{r:1,g:.472800903,b:.404551679},{r:.916482116,g:.236630659,b:.209939162}]},t.mesh||{},t.contour||{})),(t.mesh||t.contour)&&a.dataTime().modified()},this._init(e),this};i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(2);t.exports=function t(e){if(!(this instanceof t))return new t(e);e=e||{},this._size=e.size||6,this._track=e.track||600,this._needed=e.needed||null,this._batch=!1;var n=this,r=1;return Object.defineProperty(this,"size",{get:function(){return n._size},set:function(t){n._size=t,n.next_item()}}),Object.defineProperty(this,"length",{get:function(){return n._queue.length}}),Object.defineProperty(this,"processing",{get:function(){return n._processing}}),this.clear=function(){return n._queue=[],n._processing=0,n},this.add=function(t,e,r){if(t.__fetchQueue){var o=i.inArray(t,n._queue);if(o>=0)return n._queue.splice(o,1),n._addToQueue(t,r),t}var a=i.Deferred(),s=i.Deferred();return a.done(function(){i.when(e.call(t)).always(s.resolve)}).fail(s.resolve),t.__fetchQueue=a,n._addToQueue(t,r),i.when(a,s).always(function(){n._processing>0&&(n._processing-=1),n.next_item()}).promise(t),n.next_item(),t},this._addToQueue=function(t,e){if(t.__fetchQueue._batch=n._batch,e)n._queue.push(t);else if(this._batch){for(var i=0;i<n._queue.length&&n._queue[i].__fetchQueue._batch===n._batch;i+=1);n._queue.splice(i,0,t)}else n._queue.unshift(t)},this.get=function(t){return i.inArray(t,n._queue)},this.remove=function(t){var e=i.inArray(t,n._queue);return e>=0&&(n._queue.splice(e,1),!0)},this.batch=function(t){return void 0===t?n._batch:(t?(n._batch=r,r+=1):n._batch=!1,n)},this.next_item=function(){if(!n._innextitem){if(n._innextitem=!0,n._queue.length>n._track&&n._needed)for(var t=n._queue.length-1;t>=0;t-=1)if(!n._needed(n._queue[t])){var e=n._queue.splice(t,1)[0];n._processing+=1,e.__fetchQueue.reject(),delete e.__fetchQueue}for(;n._processing<n._size&&n._queue.length;){var i=n._queue.shift();i.__fetchQueue&&(n._processing+=1,!n._needed||n._needed(i)?i.__fetchQueue.resolve():i.__fetchQueue.reject(),delete i.__fetchQueue)}n._innextitem=!1}},this.clear(),this}},function(t,e,n){"use strict";var i=n(0),r=n(37),o=n(11),a=function t(e){if(!(this instanceof t))return new t(e);if(o.call(this),!((e=e||{}).layer instanceof r))throw new Error("fileReader must be given a feature layer");var n=e.layer;return this.layer=function(){return n},this.canRead=function(t){return!1},this.read=function(t,e,n){var i=new Promise(function(t,n){throw e&&e(!1),new Error("The default file reader always fails")});return this.addPromise(i),i},this._getString=function(t,e,n){(function(t,e){var n=new FileReader;return e&&(n.onprogress=e),n.onloadend=function(){t(n.error||n.result)},n})(e,n).readAsText(t)},this};i(a,o),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(8),o=function t(e){if(!(this instanceof t))return new t(e);e=e||{},r.call(this,e);var i=n(2),o=n(4),a=n(1),s=this,u=this.draw,l=this.style,c=null,h=null,d=function(t){return t.children},f=[],p=this._init,m=this._exit;return this.featureType="graph",this._init=function(t){p.call(s,t);var e=i.extend(!0,{},{nodes:{radius:5,fill:!0,fillColor:{r:1,g:0,b:0},strokeColor:{r:0,g:0,b:0}},links:{strokeColor:{r:0,g:0,b:0}},linkType:"path"},void 0===t.style?{}:t.style);return s.style(e),s.nodes(function(t){return t}),s},this._build=function(){s.children().forEach(function(t){t._build()})},this._update=function(){s.children().forEach(function(t){t._update()})},this._exit=function(){return s.data([]),f.forEach(function(t){t._exit(),s.removeChild(t)}),f=[],h._exit(),s.removeChild(h),m(),s},this.style=function(t,e){var n=l.call(s,t,e);return n!==s?n:(h.style(t.nodes),f.forEach(function(e){e.style(t.links)}),s)},this.style.get=l.get,this.links=function(t){return void 0===t?d:(d=o.ensureFunction(t),s)},this.nodes=function(t){return void 0===t?c:(c=t,s.modified(),s)},this.nodeFeature=function(){return h},this.linkFeatures=function(){return f},this.draw=function(){var t,e=s.layer(),n=s.data(),i=0;return t=s.style(),h.data(n),h.style(t.nodes),n.forEach(function(n){(n.children||[]).forEach(function(r){var o;i+=1,f.length<i&&(o=a.createFeature(t.linkType,e,e.renderer()).style(t.links),s.addChild(o),f.push(o)),f[i-1].data([n,r])})}),f.splice(i,f.length-i).forEach(function(t){t._exit(),s.removeChild(t)}),u(),s},h=a.createFeature("point",this.layer(),this.layer().renderer()),s.addChild(h),e.nodes&&this.nodes(e.nodes),this._init(e),this};i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(8),a=n(7),s=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var n,r,s,u,l,c,h,d=this,f=this._init;return this.featureType="heatmap",n=e.position||function(t){return t},r=e.intensity||function(t){return 1},s=void 0!==e.maxIntensity?e.maxIntensity:null,u=void 0!==e.minIntensity?e.minIntensity:null,c=void 0!==e.binned?e.binned:"auto",l=e.updateDelay?parseInt(e.updateDelay,10):1e3,this.maxIntensity=function(t){return void 0===t?s:(s=t,d.dataTime().modified(),d.modified(),d)},this.minIntensity=function(t){return void 0===t?u:(u=t,d.dataTime().modified(),d.modified(),d)},this.updateDelay=function(t){return void 0===t?l:(l=parseInt(t,10),d)},this.binned=function(t){return void 0===t?c:("true"===t?t=!0:"false"===t?t=!1:"auto"!==t&&!0!==t&&!1!==t&&((t=parseInt(t,10))<=0||isNaN(t))&&(t=!1),c=t,d.dataTime().modified(),d.modified(),d)},this.position=function(t){return void 0===t?n:(n=t,d.dataTime().modified(),d.modified(),d)},this.gcsPosition=function(){return d._update(),h},this.intensity=function(t){return void 0===t?r:(r=t,d.dataTime().modified(),d.modified(),d)},this._init=function(t){f.call(d,t);var e=i.extend({},{radius:10,blurRadius:10,gaussian:!0,color:{0:{r:0,g:0,b:0,a:0},.25:{r:0,g:0,b:1,a:.5},.5:{r:0,g:1,b:1,a:.6},.75:{r:1,g:1,b:0,a:.7},1:{r:1,g:0,b:0,a:.8}}},void 0===t.style?{}:t.style);d.style(e),n&&d.dataTime().modified()},this._build=function(){var t=d.data(),e=null,n=[],i=null===s||void 0===s,r=null===u||void 0===u;return t.forEach(function(t,o){n.push(d.position()(t,o)),(i||r)&&(e=d.intensity()(t,o),null!==s&&void 0!==s||(s=e),null!==u&&void 0!==u||(u=e),i&&e>s&&(s=e),r&&e<u&&(u=e))}),r&&i&&u===s&&(u-=1),h=a.transformCoordinates(d.gcs(),d.layer().map().gcs(),n),d.buildTime().modified(),d},this._init(e),this};r(s,o),t.exports=s},function(t,e,n){"use strict";var i=n(0),r=n(54),o=function t(e){if(!(this instanceof t))return new t(e);var i=n(2);return e.size=e.size||{x:256,y:256},this._image=null,this._cors=e.crossDomain||null===e.crossDomain?e.crossDomain:"anonymous",r.call(this,e),Object.defineProperty(this,"image",{get:function(){return this._image}}),this.fetch=function(){var t;return this._image||(this._image=new Image(this.size.x,this.size.y),this._cors&&this._url.indexOf(":")>=0&&this._url.indexOf("/")===this._url.indexOf(":")+1&&(this._image.crossOrigin=this._cors),t=i.Deferred(),this._image.onload=t.resolve,this._image.onerror=t.reject,this._image.src=this._url,t.done(function(){this._fetched=!0}.bind(this)).promise(this)),this},this.fadeIn=function(t){var e=this.fetch(),n=i.Deferred();return i(this._image).css("display","none"),e.done(function(){i(this._image).fadeIn(t,function(){n.resolve()})}.bind(this)),n.promise(this)},this};i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(0),r=n(1).registerLayer,o=n(25),a=function t(e){var i=n(1).createWidget;if(e.renderer="dom",e.sticky=!1,!(this instanceof t))return new t(e);o.call(this,e);var r=this,a=this._exit;this.createWidget=function(t,e){var n=i(t,r,e);return e&&"parent"in e||r.addChild(n),n._init(e),r.modified(),n},this.deleteWidget=function(t){return t._exit(),r.removeChild(t),r.modified(),r},this._exit=function(){r.children().forEach(function(t){r.deleteWidget(t)}),a()}};i(a,o),r("ui",a),t.exports=a},function(t,e,n){"use strict";t.exports=function t(e){return this instanceof t?(e=e||{},this._size=e.size||64,Object.defineProperty(this,"size",{get:function(){return this._size},set:function(t){for(;this._atime.length>t;)this.remove(this._atime[this._atime.length-1]);this._size=t}}),Object.defineProperty(this,"length",{get:function(){return this._atime.length}}),this._access=function(t){return this._atime.indexOf(t)},this.remove=function(t){var e="string"==typeof t?t:t.toString();return e in this._cache&&(this._atime.splice(this._access(e),1),delete this._cache[e],!0)},this.clear=function(){return this._cache={},this._atime=[],this},this.get=function(t,e){return(t="string"==typeof t?t:t.toString())in this._cache?(e||(this._atime.splice(this._access(t),1),this._atime.unshift(t)),this._cache[t]):null},this.add=function(t,e,n){this.remove(t);var i=t.toString();this._cache[i]=t,this._atime.unshift(i),n||this.purge(e)},this.purge=function(t){for(var e;this._atime.length>this.size;){e=this._atime.pop();var n=this._cache[e];t&&t(n),delete this._cache[e]}},this.clear(),this):new t(e)}},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(8),a=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var n=this,r=this._init;return this.featureType="path",this.position=function(t){return void 0===t?n.style("position"):(t!==n.style("position")&&(n.style("position",t),n.dataTime().modified(),n.modified()),n)},this._init=function(t){r.call(n,t);var e=i.extend({},{strokeWidth:1,strokeColor:{r:1,g:1,b:1},position:function(t){return t}},void 0===t.style?{}:t.style);return void 0!==t.position&&(e.position=t.position),n.style(e),e.position&&n.position(e.position),n.dataTime().modified(),n},this._init(e),this};r(a,o),t.exports=a},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(8),a=n(6),s=n(4),u=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var n,r,u,l=this,c=this._update,h=this._init,d=this._exit;return this.featureType="pixelmap",this.position=function(t){return void 0===t?l.style("position"):(t!==l.style("position")&&(l.style("position",t),l.dataTime().modified(),l.modified()),l)},this.url=function(t){return void 0===t?l.style("url"):(t!==l.style("url")&&(r=u=void 0,l.style("url",t),l.dataTime().modified(),l.modified()),l)},this.maxIndex=function(){if(u){if(void 0===u.maxIndex)for(var t in u.maxIndex=0,u.mappedColors)u.mappedColors.hasOwnProperty(t)&&(u.maxIndex=Math.max(u.maxIndex,t));return u.maxIndex}},this.color=function(t){return void 0===t?l.style("color"):(t!==l.style("color")&&(l.style("color",t),l.dataTime().modified(),l.modified()),l)},this.pointSearch=function(t){if(n&&u){var e=n.pointSearch(t);if(1===e.index.length&&e.extra&&e.extra[e.index[0]].basis){var i,r,o,a=e.extra[e.index[0]].basis;if(i=Math.floor(a.x*u.width),r=Math.floor(a.y*u.height),i>=0&&i<u.width&&r>=0&&r<u.height)return e={index:[o=u.indices[r*u.width+i]],found:[l.data()[o]]}}}return{index:[],found:[]}},this._build=function(){if(l.buildTime().modified(),r)u&&l._computePixelmap();else{var t=l.style.get("url")();if(s.isReadyImage(t))r=t,l._computePixelmap();else if(t){var e,n,o=i.Deferred();t instanceof Image?(r=t,e=t.onload,n=t.onerror):(r=new Image,t.indexOf(":")>=0&&t.indexOf("/")===t.indexOf(":")+1&&(r.crossOrigin=l.style.get("crossDomain")()||"anonymous")),r.onload=function(){e&&e.apply(l,arguments),l.style.get("url")()===t&&(u=void 0,l._computePixelmap()),o.resolve()},r.onerror=function(){n&&n.apply(l,arguments),o.reject()},o.promise(l),l.layer().addPromise(l),t instanceof Image||(r.src=t)}}return l},this._preparePixelmap=function(){var t,e,n;if(s.isReadyImage(r)){for((u={width:r.naturalWidth,height:r.naturalHeight,canvas:document.createElement("canvas")}).canvas.width=u.width,u.canvas.height=u.height,u.context=u.canvas.getContext("2d"),u.context.drawImage(r,0,0),u.imageData=u.context.getImageData(0,0,u.canvas.width,u.canvas.height),n=u.imageData.data,u.indices=new Array(n.length/4),u.area=n.length/4,u.mappedColors={},t=0;t<n.length;t+=4)e=n[t]+(n[t+1]<<8)+(n[t+2]<<16),u.indices[t/4]=e,u.mappedColors[e]||(u.mappedColors[e]={first:t/4}),u.mappedColors[e].last=t/4;return u}},this._computePixelmap=function(){var t,e,i,r,o,s,c,h,d,f,p=l.data()||[],m=l.style.get("color"),g=-1;if(!u){if(!l._preparePixelmap())return;f=!0}for(e in c=u.mappedColors,h=u.area,c)c.hasOwnProperty(e)&&(r=[255*((r=m(p[e],+e)||{}).r||0),255*(r.g||0),255*(r.b||0),void 0===r.a?255:255*r.a],c[e].update=!c[e].color||c[e].color[0]!==r[0]||c[e].color[1]!==r[1]||c[e].color[2]!==r[2]||c[e].color[3]!==r[3],c[e].update&&(c[e].color=r,h=Math.min(c[e].first,h),g=Math.max(c[e].last,g)));if(!(h>=g)){for(o=u.imageData.data,s=u.indices,t=h;t<=g;t+=1)(e=s[t])!==i&&(i=e,r=c[e].color,d=c[e].update),d&&(o[4*t]=r[0],o[4*t+1]=r[1],o[4*t+2]=r[2],o[4*t+3]=r[3]);u.context.putImageData(u.imageData,0,0,0,Math.floor(h/u.width),u.width,Math.ceil((g+1)/u.width)),n||(n=l.layer().createFeature("quad",{selectionAPI:!1,gcs:l.gcs(),visible:l.visible(void 0,!0)}),l.dependentFeatures([n]),n.style({image:u.canvas,position:l.style.get("position")}).data([{}]).draw()),f&&l.geoTrigger(a.pixelmap.prepared,{pixelmap:l})}},this._update=function(){return c.call(l),(l.buildTime().timestamp()<=l.dataTime().timestamp()||l.updateTime().timestamp()<l.timestamp())&&l._build(),l.updateTime().modified(),l},this._exit=function(){return n&&l.layer()&&(l.layer().deleteFeature(n),n=null,l.dependentFeatures([])),d(),l},this._init=function(t){t=t||{},h.call(l,t);var e=i.extend({},{color:function(t,e){return{r:(255&e)/255,g:(e>>8&255)/255,b:(e>>16&255)/255,a:1}},position:function(t){return t}},void 0===t.style?{}:t.style);return void 0!==t.position&&(e.position=t.position),void 0!==t.url&&(e.url=t.url),void 0!==t.color&&(e.color=t.color),l.style(e),l.dataTime().modified(),l},this};u.create=function(t,e){return(e=e||{}).type="pixelmap",o.create(t,e)},u.capabilities={feature:"pixelmap"},r(u,o),t.exports=u},function(t,e,n){"use strict";var i=n(0),r=n(8),o=function t(e){if(!(this instanceof t))return new t(e);var i=n(2);e=e||{},r.call(this,e);var o=this,a=this._init;this.featureType="vector",this.origin=function(t){return void 0===t?o.style("origin"):(o.style("origin",t),o.dataTime().modified(),o)},this.delta=function(t){return void 0===t?o.style("delta"):(o.style("delta",t),o.dataTime().modified(),o)},this._init=function(t){a.call(o,t);var e=i.extend({},{strokeColor:"black",strokeWidth:2,strokeOpacity:1,originStyle:"none",endStyle:"arrow",origin:{x:0,y:0,z:0},delta:function(t){return t},scale:null},void 0===t.style?{}:t.style);return void 0!==t.origin&&(e.origin=t.origin),o.style(e),o.dataTime().modified(),o}};i(o,r),t.exports=o},function(t,e,n){"use strict";var i=n(0),r=n(1).registerRenderer,o=n(13),a=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var i=n(23),r=n(6),a=t.vtkjs.Rendering.Misc.vtkGenericRenderWindow,s=this,u=this._init,l=a.newInstance({background:[0,0,0,0]});l.setContainer(s.layer().node().get(0)),l.getInteractor().unbindEvents(),l.resize();var c=l.getRenderer(),h=l.getRenderWindow();return this.contextRenderer=function(){return c},this.api=function(){return t.apiname},this._init=function(){if(s.initialized())return s;u.call(s);var t=s.layer().map(),e=t.size();return s._resize(0,0,e.width,e.height),t.camera().clipbounds={near:-t.unitsPerPixel(),far:t.unitsPerPixel()},s},this._resize=function(t,e,n,i){return s._setWidthHeight(n,i),l.resize(),s._render(),s},this._render=function(){return s.layer().map().scheduleAnimationFrame(s._renderFrame,!0),s},this._renderFrame=function(){var t,e=s.layer().features();for(t=0;t<e.length;t+=1)e[t].visible()&&e[t]._update();s._updateRendererCamera(),h.render()},this._exit=function(){},this._updateRendererCamera=function(){var t=s.layer().map().camera(),e=t.view,n=t.projectionMatrix,r=i.create();i.copy(r,e);var o=i.create();i.copy(o,n),s.contextRenderer().getActiveCamera().setViewMatrix(r),s.contextRenderer().getActiveCamera().setProjectionMatrix(o)},s.layer().geoOn(r.pan,function(t){s._render()}),s.layer().geoOn(r.parallelprojection,function(t){}),this};a.apiname="vtkjs",i(a,o),r("vtkjs",a),a.supported=function(){delete a.vtkjs;try{!(a.vtkjs=n(313)).Rendering&&window.vtk.Rendering&&(a.vtkjs=window.vtk)}catch(t){}return void 0!==a.vtkjs},a.fallback=function(){return null},a.supported(),t.exports=a},function(t,e,n){"use strict";var i=n(57),r=n(0),o=n(1).registerWidget,a=function t(e){if(!(this instanceof t))return new t(e);i.call(this,e);var n=this;return this._init=function(){return e.hasOwnProperty("parent")&&e.parent.addChild(n),n._createCanvas(),n._appendCanvasToParent(),n.canvas().addEventListener("mousedown",function(t){t.stopPropagation()}),n.reposition(),n},this._createCanvas=function(){n.canvas(document.createElement(e.el||"div"))},this};r(a,i),o("dom","dom",a),t.exports=a},function(t,e,n){"use strict";
/**
 * GeoJS
 * @copyright 2013-2018, Kitware, Inc.
 * @license Apache-2.0
 * @namespace geo
 */
/*
 * Bundled with the following libraries:
 *
 * vgl
 * @copyright 2014-2016, Kitware, Inc.
 * @license Apache-2.0
 *
 * Proj4js
 * @copyright 2014, Mike Adair, Richard Greenwood, Didier Richard, Stephen Irons, Olivier Terral and Calvin Metcalf
 * @license MIT
 *
 * gl-matrix
 * @copyright 2015, Brandon Jones, Colin MacKenzie IV
 * @license MIT
 *
 * JQuery
 * @copyright jQuery Foundation and other contributors
 * @license MIT
 *
 * earcut
 * @copyright 2016, Mapbox
 * @license ISC
 *
 * kdbush
 * @copyright 2017, Vladimir Agafonkin
 * @license ISC
 */var i=n(2);n(136),t.exports=i.extend({annotation:n(58),annotationLayer:n(265),camera:n(118),choroplethFeature:n(120),contourFeature:n(122),domRenderer:n(286),event:n(6),feature:n(8),featureLayer:n(37),fetchQueue:n(123),fileReader:n(124),geo_action:n(41),graphFeature:n(125),heatmapFeature:n(126),imageTile:n(127),isolineFeature:n(55),geojsonReader:n(287),layer:n(25),lineFeature:n(24),map:n(288),mapInteractor:n(51),meshFeature:n(53),object:n(11),osmLayer:n(289),pathFeature:n(130),pointFeature:n(26),polygonFeature:n(50),quadFeature:n(18),pixelmapFeature:n(131),renderer:n(13),sceneObject:n(14),textFeature:n(27),tile:n(54),tileCache:n(129),tileLayer:n(56),timestamp:n(9),transform:n(7),typedef:n(290),vectorFeature:n(132),inherit:n(0),version:n(291),sha:n(292),util:n(4),jQuery:i,canvas:n(293),svg:n(302),vtkjs:n(310),webgl:n(314),gui:n(340)},n(1)),window&&!window.$&&(window.$=i),window&&!window.jQuery&&(window.jQuery=i)},function(t,e,n){var i=n(137);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(40)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(39)(!1)).push([t.i,'.geojs-map {\n  position: relative;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.geojs-map .geo-attribution {\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  padding-right: 5px;\n  cursor: auto;\n  font: 11px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;\n  z-index: 1001;\n  background: rgba(255,255,255,0.7);\n  clear: both;\n  display: block;\n  pointer-events: auto;\n}\n.geojs-map .geo-attribution .geo-attribution-layer {\n  padding-left: 5px;\n}\n.geojs-map .canvas-canvas {\n  display: block;\n  -webkit-transform-origin: 0px 0px;\n  -moz-transform-origin: 0px 0px;\n  -o-transform-origin: 0px 0px;\n  -ms-transform-origin: 0px 0px;\n  transform-origin: 0px 0px;\n}\n.geojs-map .webgl-canvas {\n  display: block;\n}\n.geojs-map .geojs-layer {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n  pointer-events: none;\n}\n.geojs-map .geojs-layer.active:not(.hidden) > * {\n  pointer-events: auto;\n}\n.geojs-map .geojs-layer.hidden {\n  display: none;\n}\n.geojs-map .geojs-layer.hidden[renderer="webgl"] {\n  display: inherit;\n}\n.geojs-map .geo-tile-layer {\n  -webkit-transform-origin: 0px 0px;\n  -moz-transform-origin: 0px 0px;\n  -o-transform-origin: 0px 0px;\n  -ms-transform-origin: 0px 0px;\n  transform-origin: 0px 0px;\n  line-height: 0;\n  font-size: 0;\n}\n.geojs-map.annotation-input {\n  cursor: crosshair;\n}\n.geojs-map.highlight-focus:after {\n  content: "";\n  display: block;\n  position: absolute;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  left: 0px;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  border: 3px solid Highlight;\n  opacity: 1;\n  -ms-filter: none;\n  filter: none;\n  -webkit-transition: opacity 0s;\n  -moz-transition: opacity 0s;\n  -o-transition: opacity 0s;\n  -ms-transition: opacity 0s;\n  transition: opacity 0s;\n  visibility: hidden;\n}\n.geojs-map.highlight-focus:focus:after {\n  visibility: visible;\n  -webkit-transition: opacity 2.5s ease-in;\n  -moz-transition: opacity 2.5s ease-in;\n  -o-transition: opacity 2.5s ease-in;\n  -ms-transition: opacity 2.5s ease-in;\n  transition: opacity 2.5s ease-in;\n  opacity: 0;\n  -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n  filter: alpha(opacity=0);\n}\n.geo-tile-container {\n  position: absolute;\n}\n.geo-tile-container.crop {\n  overflow: hidden;\n}\n',""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,i=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var r,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},function(t,e,n){"use strict";var i=n(42),r=n(65),o=Object(i.a)("WGS84");function a(t,e,n){var i,o,a;return Array.isArray(n)?(i=Object(r.a)(t,e,n),3===n.length?[i.x,i.y,i.z]:[i.x,i.y]):(o=Object(r.a)(t,e,n),2===(a=Object.keys(n)).length?o:(a.forEach(function(t){"x"!==t&&"y"!==t&&(o[t]=n[t])}),o))}function s(t){return t instanceof i.a?t:t.oProj?t.oProj:Object(i.a)(t)}e.a=function(t,e,n){t=s(t);var i,r=!1;return void 0===e?(e=t,t=o,r=!0):(void 0!==e.x||Array.isArray(e))&&(n=e,e=t,t=o,r=!0),e=s(e),n?a(t,e,n):(i={forward:function(n){return a(t,e,n)},inverse:function(n){return a(e,t,n)}},r&&(i.oProj=e),i)}},function(t,e,n){"use strict";var i=n(60),r=n(62),o=n(61),a=n(28);var s=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var u=["3857","900913","3785","102113"];e.a=function(t){if(!function(t){return"string"==typeof t}(t))return t;if(function(t){return t in i.a}(t))return i.a[t];if(function(t){return s.some(function(e){return t.indexOf(e)>-1})}(t)){var e=Object(r.a)(t);if(function(t){var e=Object(a.a)(t,"authority");if(e){var n=Object(a.a)(e,"epsg");return n&&u.indexOf(n)>-1}}(e))return i.a["EPSG:3857"];var n=function(t){var e=Object(a.a)(t,"extension");if(e)return Object(a.a)(e,"proj4")}(e);return n?Object(o.a)(n):e}return function(t){return"+"===t[0]}(t)?Object(o.a)(t):void 0}},function(t,e,n){"use strict";e.a=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667}},function(t,e,n){"use strict";e.a={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}}},function(t,e,n){"use strict";e.a=function(t){return new l(t).output()};var i=1,r=/\s/,o=/[A-Za-z]/,a=/[A-Za-z84]/,s=/[,\]]/,u=/[\d\.E\-\+]/;function l(t){if("string"!=typeof t)throw new Error("not a string");this.text=t.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=i}l.prototype.readCharicter=function(){var t=this.text[this.place++];if(4!==this.state)for(;r.test(t);){if(this.place>=this.text.length)return;t=this.text[this.place++]}switch(this.state){case i:return this.neutral(t);case 2:return this.keyword(t);case 4:return this.quoted(t);case 5:return this.afterquote(t);case 3:return this.number(t);case-1:return}},l.prototype.afterquote=function(t){if('"'===t)return this.word+='"',void(this.state=4);if(s.test(t))return this.word=this.word.trim(),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in afterquote yet, index '+this.place)},l.prototype.afterItem=function(t){return","===t?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=i)):"]"===t?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=i,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},l.prototype.number=function(t){if(!u.test(t)){if(s.test(t))return this.word=parseFloat(this.word),void this.afterItem(t);throw new Error("havn't handled \""+t+'" in number yet, index '+this.place)}this.word+=t},l.prototype.quoted=function(t){'"'!==t?this.word+=t:this.state=5},l.prototype.keyword=function(t){if(a.test(t))this.word+=t;else{if("["===t){var e=[];return e.push(this.word),this.level++,null===this.root?this.root=e:this.currentObject.push(e),this.stack.push(this.currentObject),this.currentObject=e,void(this.state=i)}if(!s.test(t))throw new Error("havn't handled \""+t+'" in keyword yet, index '+this.place);this.afterItem(t)}},l.prototype.neutral=function(t){if(o.test(t))return this.word=t,void(this.state=2);if('"'===t)return this.word="",void(this.state=4);if(u.test(t))return this.word=t,void(this.state=3);if(!s.test(t))throw new Error("havn't handled \""+t+'" in neutral yet, index '+this.place);this.afterItem(t)},l.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)}},function(t,e,n){"use strict";function i(t,e,n){Array.isArray(e)&&(n.unshift(e),e=null);var i=e?{}:t,o=n.reduce(function(t,e){return r(e,t),t},i);e&&(t[e]=o)}function r(t,e){if(Array.isArray(t)){var n,o=t.shift();if("PARAMETER"===o&&(o=t.shift()),1===t.length)return Array.isArray(t[0])?(e[o]={},void r(t[0],e[o])):void(e[o]=t[0]);if(t.length)if("TOWGS84"!==o)switch(Array.isArray(o)||(e[o]={}),o){case"UNIT":case"PRIMEM":case"VERT_DATUM":return e[o]={name:t[0].toLowerCase(),convert:t[1]},void(3===t.length&&r(t[2],e[o]));case"SPHEROID":case"ELLIPSOID":return e[o]={name:t[0],a:t[1],rf:t[2]},void(4===t.length&&r(t[3],e[o]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return t[0]=["name",t[0]],void i(e,o,t);default:for(n=-1;++n<t.length;)if(!Array.isArray(t[n]))return r(t,e[o]);return i(e,o,t)}else e[o]=t;else e[o]=!0}else e[t]=!0}e.a=r},function(t,e,n){"use strict";e.a=function(t,e){var n,i;if(t=t||{},!e)return t;for(i in e)void 0!==(n=e[i])&&(t[i]=n);return t}},function(t,e,n){"use strict";var i=n(63),r=n(64),o=[i.default,r.default],a={},s=[];function u(t,e){var n=s.length;return t.names?(s[n]=t,t.names.forEach(function(t){a[t.toLowerCase()]=n}),this):(console.log(e),!0)}e.a={start:function(){o.forEach(u)},add:u,get:function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==a[e]&&s[a[e]]?s[a[e]]:void 0}}},function(t,e,n){"use strict";e.a=function(t,e,n,r){var o=t*t,a=e*e,s=(o-a)/o,u=0;r?(t*=1-s*(i.m+s*(i.j+s*i.k)),o=t*t,s=0):u=Math.sqrt(s);return{es:s,e:u,ep2:(o-a)/a}},e.b=function(t,e,n,a,s){if(!t){var u=Object(o.a)(r.b,a);u||(u=r.a),t=u.a,e=u.b,n=u.rf}n&&!e&&(e=(1-1/n)*t);(0===n||Math.abs(t-e)<i.b)&&(s=!0,e=t);return{a:t,b:e,rf:n,sphere:s}};var i=n(3),r=n(149),o=n(28)},function(t,e,n){"use strict";n.d(e,"b",function(){return i}),n.d(e,"a",function(){return r});var i={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},r=i.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};i.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var i={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}}},function(t,e,n){"use strict";var i=n(3);e.a=function(t,e,n,r,o,a){var s={};return s.datum_type=void 0===t||"none"===t?i.g:i.h,e&&(s.datum_params=e.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=i.e),s.datum_params.length>3&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=i.f,s.datum_params[3]*=i.l,s.datum_params[4]*=i.l,s.datum_params[5]*=i.l,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=n,s.b=r,s.es=o,s.ep2=a,s}},function(t,e,n){"use strict";var i=n(3),r=n(153);function o(t){return t===i.e||t===i.f}e.a=function(t,e,n){return Object(r.a)(t,e)?n:t.datum_type===i.g||e.datum_type===i.g?n:t.es!==e.es||t.a!==e.a||o(t.datum_type)||o(e.datum_type)?(n=Object(r.e)(n,t.es,t.a),o(t.datum_type)&&(n=Object(r.d)(n,t.datum_type,t.datum_params)),o(e.datum_type)&&(n=Object(r.b)(n,e.datum_type,e.datum_params)),Object(r.c)(n,e.es,e.a,e.b)):n}},function(t,e,n){"use strict";e.a=function(t,e){return t.datum_type===e.datum_type&&(!(t.a!==e.a||Math.abs(t.es-e.es)>5e-11)&&(t.datum_type===i.e?t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]:t.datum_type!==i.f||t.datum_params[0]===e.datum_params[0]&&t.datum_params[1]===e.datum_params[1]&&t.datum_params[2]===e.datum_params[2]&&t.datum_params[3]===e.datum_params[3]&&t.datum_params[4]===e.datum_params[4]&&t.datum_params[5]===e.datum_params[5]&&t.datum_params[6]===e.datum_params[6]))},e.e=function(t,e,n){var r,o,a,s,u=t.x,l=t.y,c=t.z?t.z:0;if(l<-i.d&&l>-1.001*i.d)l=-i.d;else if(l>i.d&&l<1.001*i.d)l=i.d;else{if(l<-i.d)return{x:-1/0,y:-1/0,z:t.z};if(l>i.d)return{x:1/0,y:1/0,z:t.z}}u>Math.PI&&(u-=2*Math.PI);return o=Math.sin(l),s=Math.cos(l),a=o*o,{x:((r=n/Math.sqrt(1-e*a))+c)*s*Math.cos(u),y:(r+c)*s*Math.sin(u),z:(r*(1-e)+c)*o}},e.c=function(t,e,n,r){var o,a,s,u,l,c,h,d,f,p,m,g,v,y,x,b,_=t.x,w=t.y,M=t.z?t.z:0;if(o=Math.sqrt(_*_+w*w),a=Math.sqrt(_*_+w*w+M*M),o/n<1e-12){if(y=0,a/n<1e-12)return x=i.d,b=-r,{x:t.x,y:t.y,z:t.z}}else y=Math.atan2(w,_);s=M/a,u=o/a,l=1/Math.sqrt(1-e*(2-e)*u*u),d=u*(1-e)*l,f=s*l,v=0;do{v++,h=n/Math.sqrt(1-e*f*f),c=e*h/(h+(b=o*d+M*f-h*(1-e*f*f))),l=1/Math.sqrt(1-c*(2-c)*u*u),g=(m=s*l)*d-(p=u*(1-c)*l)*f,d=p,f=m}while(g*g>1e-24&&v<30);return x=Math.atan(m/Math.abs(p)),{x:y,y:x,z:b}},e.d=function(t,e,n){if(e===i.e)return{x:t.x+n[0],y:t.y+n[1],z:t.z+n[2]};if(e===i.f){var r=n[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6];return{x:c*(t.x-l*t.y+u*t.z)+r,y:c*(l*t.x+t.y-s*t.z)+o,z:c*(-u*t.x+s*t.y+t.z)+a}}},e.b=function(t,e,n){if(e===i.e)return{x:t.x-n[0],y:t.y-n[1],z:t.z-n[2]};if(e===i.f){var r=n[0],o=n[1],a=n[2],s=n[3],u=n[4],l=n[5],c=n[6],h=(t.x-r)/c,d=(t.y-o)/c,f=(t.z-a)/c;return{x:h+l*d-u*f,y:-l*h+d+s*f,z:u*h-s*d+f}}};var i=n(3)},function(t,e,n){"use strict";e.a=function(t,e,n){var i,r,o,a=n.x,s=n.y,u=n.z||0,l={};for(o=0;o<3;o++)if(!e||2!==o||void 0!==n.z)switch(0===o?(i=a,r="x"):1===o?(i=s,r="y"):(i=u,r="z"),t.axis[o]){case"e":l[r]=i;break;case"w":l[r]=-i;break;case"n":l[r]=i;break;case"s":l[r]=-i;break;case"u":void 0!==n[r]&&(l.z=i);break;case"d":void 0!==n[r]&&(l.z=-i);break;default:return null}return l}},function(t,e,n){"use strict";function i(t){if("function"==typeof Number.isFinite){if(Number.isFinite(t))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof t||t!=t||!isFinite(t))throw new TypeError("coordinates must be finite numbers")}e.a=function(t){i(t.x),i(t.y)}},function(t,e,n){"use strict";var i=n(67);function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}r.fromMGRS=function(t){return new r(Object(i.c)(t))},r.prototype.toMGRS=function(t){return Object(i.b)([this.x,this.y],t)},e.a=r},function(t,e,n){"use strict";var i=n(158);n.n(i);n.o(i,"version")&&n.d(e,"a",function(){return i.version})},function(t,e){t.exports={_args:[["proj4@2.5.0","/home/travis/build/OpenGeoscience/geojs"]],_from:"proj4@2.5.0",_id:"proj4@2.5.0",_inBundle:!1,_integrity:"sha512-XZTRT7OPdLzgvtTqL8DG2cEj8lYdovztOwiwpwRSYayOty5Ipf3H68dh/fiL+HKDEyetmQSMhkkMGiJoyziz3w==",_location:"/proj4",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"proj4@2.5.0",name:"proj4",escapedName:"proj4",rawSpec:"2.5.0",saveSpec:null,fetchSpec:"2.5.0"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/proj4/-/proj4-2.5.0.tgz",_spec:"2.5.0",_where:"/home/travis/build/OpenGeoscience/geojs",author:"",bugs:{url:"https://github.com/proj4js/proj4js/issues"},contributors:[{name:"Mike Adair",email:"madair@dmsolutions.ca"},{name:"Richard Greenwood",email:"rich@greenwoodmap.com"},{name:"Calvin Metcalf",email:"calvin.metcalf@gmail.com"},{name:"Richard Marsden",url:"http://www.winwaed.com"},{name:"T. Mittan"},{name:"D. Steinwand"},{name:"S. Nelson"}],dependencies:{mgrs:"1.0.0","wkt-parser":"^1.2.0"},description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",devDependencies:{chai:"~4.1.2","curl-amd":"github:cujojs/curl",grunt:"^1.0.1","grunt-cli":"~1.2.0","grunt-contrib-connect":"~1.0.2","grunt-contrib-jshint":"~1.1.0","grunt-contrib-uglify":"~3.1.0","grunt-mocha-phantomjs":"~4.0.0","grunt-rollup":"^6.0.0",istanbul:"~0.4.5",mocha:"~4.0.0",rollup:"^0.50.0","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.0",tin:"~0.5.0"},directories:{test:"test",doc:"docs"},homepage:"https://github.com/proj4js/proj4js#readme",license:"MIT",main:"dist/proj4-src.js",module:"lib/index.js",name:"proj4",repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},scripts:{build:"grunt","build:tmerc":"grunt build:tmerc",test:"npm run build && istanbul test _mocha test/test.js"},version:"2.5.0"}},function(t,e,n){"use strict";var i=n(68),r=n(44),o=n(73),a=n(74),s=n(76),u=n(77),l=n(78),c=n(79),h=n(80),d=n(81),f=n(82),p=n(83),m=n(84),g=n(85),v=n(86),y=n(87),x=n(88),b=n(89),_=n(90),w=n(91),M=n(92),A=n(93),T=n(94),C=n(95),E=n(96),O=n(97);e.a=function(t){t.Proj.projections.add(i.default),t.Proj.projections.add(r.default),t.Proj.projections.add(o.default),t.Proj.projections.add(a.default),t.Proj.projections.add(s.default),t.Proj.projections.add(u.default),t.Proj.projections.add(l.default),t.Proj.projections.add(c.default),t.Proj.projections.add(h.default),t.Proj.projections.add(d.default),t.Proj.projections.add(f.default),t.Proj.projections.add(p.default),t.Proj.projections.add(m.default),t.Proj.projections.add(g.default),t.Proj.projections.add(v.default),t.Proj.projections.add(y.default),t.Proj.projections.add(x.default),t.Proj.projections.add(b.default),t.Proj.projections.add(_.default),t.Proj.projections.add(w.default),t.Proj.projections.add(M.default),t.Proj.projections.add(A.default),t.Proj.projections.add(T.default),t.Proj.projections.add(C.default),t.Proj.projections.add(E.default),t.Proj.projections.add(O.default)}},function(t,e,n){"use strict";var i=n(71),r=n(161);e.a=function(t){var e=Math.abs(t);return e=Object(r.a)(e*(1+e/(Object(i.a)(1,e)+1))),t<0?-e:e}},function(t,e,n){"use strict";e.a=function(t){var e=1+t,n=e-1;return 0===n?t:t*Math.log(e)/n}},function(t,e,n){"use strict";e.a=function(t,e){for(var n,i=2*Math.cos(2*e),r=t.length-1,o=t[r],a=0;--r>=0;)n=i*o-a+t[r],a=o,o=n;return e+n*Math.sin(2*e)}},function(t,e,n){"use strict";e.a=function(t,e){for(var n,i=2*Math.cos(e),r=t.length-1,o=t[r],a=0;--r>=0;)n=i*o-a+t[r],a=o,o=n;return Math.sin(e)*n}},function(t,e,n){"use strict";var i=n(45),r=n(72);e.a=function(t,e,n){for(var o,a,s=Math.sin(e),u=Math.cos(e),l=Object(i.a)(n),c=Object(r.a)(n),h=2*u*c,d=-2*s*l,f=t.length-1,p=t[f],m=0,g=0,v=0;--f>=0;)o=g,a=m,p=h*(g=p)-o-d*(m=v)+t[f],v=d*g-a+h*m;return[(h=s*c)*p-(d=u*l)*v,h*v+d*p]}},function(t,e,n){"use strict";var i=n(5);e.a=function(t,e){if(void 0===t){if((t=Math.floor(30*(Object(i.a)(e)+Math.PI)/Math.PI)+1)<0)return 0;if(t>60)return 60}return t}},function(t,e,n){"use strict";e.a=function(t,e){return Math.pow((1-t)/(1+t),e)}},function(t,e,n){"use strict";var i=n(3);e.a=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*i.d:i.d;for(var r,o,a,s,u=Math.asin(.5*e),l=0;l<30;l++)if(o=Math.sin(u),a=Math.cos(u),s=t*o,u+=r=Math.pow(1-s*s,2)/(2*a)*(e/(1-t*t)-o/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),Math.abs(r)<=1e-10)return u;return NaN}},function(t,e){t.exports=function(t){var e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(t,e,n){t.exports=function(t,e){var n=i(t[0],t[1],t[2]),a=i(e[0],e[1],e[2]);r(n,n),r(a,a);var s=o(n,a);return s>1?0:Math.acos(s)};var i=n(100),r=n(101),o=n(102)},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(t,e){t.exports=function(t,e,n,i){return t[0]=e,t[1]=n,t[2]=i,t}},function(t,e,n){t.exports=function(t,e){var n=t[0],r=t[1],o=t[2],a=e[0],s=e[1],u=e[2];return Math.abs(n-a)<=i*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-s)<=i*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(o-u)<=i*Math.max(1,Math.abs(o),Math.abs(u))};var i=n(98)},function(t,e){t.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}},function(t,e,n){t.exports=n(103)},function(t,e,n){t.exports=n(104)},function(t,e,n){t.exports=n(105)},function(t,e){t.exports=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}},function(t,e){t.exports=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t}},function(t,e,n){t.exports=n(106)},function(t,e,n){t.exports=n(107)},function(t,e,n){t.exports=n(108)},function(t,e,n){t.exports=n(109)},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}},function(t,e){t.exports=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=r*u-o*s,t[1]=o*a-i*u,t[2]=i*s-r*a,t}},function(t,e){t.exports=function(t,e,n,i){var r=e[0],o=e[1],a=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t}},function(t,e){t.exports=function(t,e){e=e||1;var n=2*Math.random()*Math.PI,i=2*Math.random()-1,r=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=i*e,t}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[3]*i+n[7]*r+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/a,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/a,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/a,t}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*i+s*o-u*r,h=l*r+u*i-a*o,d=l*o+a*r-s*i,f=-a*i-s*r-u*o;return t[0]=c*l+f*-a+h*-u-d*-s,t[1]=h*l+f*-s+d*-a-c*-u,t[2]=d*l+f*-u+c*-s-h*-a,t}},function(t,e){t.exports=function(t,e,n,i){var r=n[1],o=n[2],a=e[1]-r,s=e[2]-o,u=Math.sin(i),l=Math.cos(i);return t[0]=e[0],t[1]=r+a*l-s*u,t[2]=o+a*u+s*l,t}},function(t,e){t.exports=function(t,e,n,i){var r=n[0],o=n[2],a=e[0]-r,s=e[2]-o,u=Math.sin(i),l=Math.cos(i);return t[0]=r+s*u+a*l,t[1]=e[1],t[2]=o+s*l-a*u,t}},function(t,e){t.exports=function(t,e,n,i){var r=n[0],o=n[1],a=e[0]-r,s=e[1]-o,u=Math.sin(i),l=Math.cos(i);return t[0]=r+a*l-s*u,t[1]=o+a*u+s*l,t[2]=e[2],t}},function(t,e,n){t.exports=function(t,e,n,r,o,a){var s,u;e||(e=3);n||(n=0);u=r?Math.min(r*e+n,t.length):t.length;for(s=n;s<u;s+=e)i[0]=t[s],i[1]=t[s+1],i[2]=t[s+2],o(i,i,a),t[s]=i[0],t[s+1]=i[1],t[s+2]=i[2];return t};var i=n(99)()},function(t,e){t.exports=function(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t){var e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e){t.exports=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],v=e[15],y=n*s-i*a,x=n*u-r*a,b=n*l-o*a,_=i*u-r*s,w=i*l-o*s,M=r*l-o*u,A=c*m-h*p,T=c*g-d*p,C=c*v-f*p,E=h*g-d*m,O=h*v-f*m,S=d*v-f*g,P=y*S-x*O+b*E+_*C-w*T+M*A;if(!P)return null;return P=1/P,t[0]=(s*S-u*O+l*E)*P,t[1]=(r*O-i*S-o*E)*P,t[2]=(m*M-g*w+v*_)*P,t[3]=(d*w-h*M-f*_)*P,t[4]=(u*C-a*S-l*T)*P,t[5]=(n*S-r*C+o*T)*P,t[6]=(g*b-p*M-v*x)*P,t[7]=(c*M-d*b+f*x)*P,t[8]=(a*O-s*C+l*A)*P,t[9]=(i*C-n*O-o*A)*P,t[10]=(p*w-m*b+v*y)*P,t[11]=(h*b-c*w-f*y)*P,t[12]=(s*T-a*E-u*A)*P,t[13]=(n*E-i*T+r*A)*P,t[14]=(m*x-p*_-g*y)*P,t[15]=(c*_-h*x+d*y)*P,t}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],v=e[15];return t[0]=s*(d*v-f*g)-h*(u*v-l*g)+m*(u*f-l*d),t[1]=-(i*(d*v-f*g)-h*(r*v-o*g)+m*(r*f-o*d)),t[2]=i*(u*v-l*g)-s*(r*v-o*g)+m*(r*l-o*u),t[3]=-(i*(u*f-l*d)-s*(r*f-o*d)+h*(r*l-o*u)),t[4]=-(a*(d*v-f*g)-c*(u*v-l*g)+p*(u*f-l*d)),t[5]=n*(d*v-f*g)-c*(r*v-o*g)+p*(r*f-o*d),t[6]=-(n*(u*v-l*g)-a*(r*v-o*g)+p*(r*l-o*u)),t[7]=n*(u*f-l*d)-a*(r*f-o*d)+c*(r*l-o*u),t[8]=a*(h*v-f*m)-c*(s*v-l*m)+p*(s*f-l*h),t[9]=-(n*(h*v-f*m)-c*(i*v-o*m)+p*(i*f-o*h)),t[10]=n*(s*v-l*m)-a*(i*v-o*m)+p*(i*l-o*s),t[11]=-(n*(s*f-l*h)-a*(i*f-o*h)+c*(i*l-o*s)),t[12]=-(a*(h*g-d*m)-c*(s*g-u*m)+p*(s*d-u*h)),t[13]=n*(h*g-d*m)-c*(i*g-r*m)+p*(i*d-r*h),t[14]=-(n*(s*g-u*m)-a*(i*g-r*m)+p*(i*u-r*s)),t[15]=n*(s*d-u*h)-a*(i*d-r*h)+c*(i*u-r*s),t}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],m=t[14],g=t[15];return(e*a-n*o)*(h*g-d*m)-(e*s-i*o)*(c*g-d*p)+(e*u-r*o)*(c*m-h*p)+(n*s-i*a)*(l*g-d*f)-(n*u-r*a)*(l*m-h*f)+(i*u-r*s)*(l*p-c*f)}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],v=e[14],y=e[15],x=n[0],b=n[1],_=n[2],w=n[3];return t[0]=x*i+b*s+_*h+w*m,t[1]=x*r+b*u+_*d+w*g,t[2]=x*o+b*l+_*f+w*v,t[3]=x*a+b*c+_*p+w*y,x=n[4],b=n[5],_=n[6],w=n[7],t[4]=x*i+b*s+_*h+w*m,t[5]=x*r+b*u+_*d+w*g,t[6]=x*o+b*l+_*f+w*v,t[7]=x*a+b*c+_*p+w*y,x=n[8],b=n[9],_=n[10],w=n[11],t[8]=x*i+b*s+_*h+w*m,t[9]=x*r+b*u+_*d+w*g,t[10]=x*o+b*l+_*f+w*v,t[11]=x*a+b*c+_*p+w*y,x=n[12],b=n[13],_=n[14],w=n[15],t[12]=x*i+b*s+_*h+w*m,t[13]=x*r+b*u+_*d+w*g,t[14]=x*o+b*l+_*f+w*v,t[15]=x*a+b*c+_*p+w*y,t}},function(t,e){t.exports=function(t,e,n){var i,r,o,a,s,u,l,c,h,d,f,p,m=n[0],g=n[1],v=n[2];e===t?(t[12]=e[0]*m+e[4]*g+e[8]*v+e[12],t[13]=e[1]*m+e[5]*g+e[9]*v+e[13],t[14]=e[2]*m+e[6]*g+e[10]*v+e[14],t[15]=e[3]*m+e[7]*g+e[11]*v+e[15]):(i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=d,t[10]=f,t[11]=p,t[12]=i*m+s*g+h*v+e[12],t[13]=r*m+u*g+d*v+e[13],t[14]=o*m+l*g+f*v+e[14],t[15]=a*m+c*g+p*v+e[15]);return t}},function(t,e){t.exports=function(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},function(t,e){t.exports=function(t,e,n,i){var r,o,a,s,u,l,c,h,d,f,p,m,g,v,y,x,b,_,w,M,A,T,C,E,O=i[0],S=i[1],P=i[2],k=Math.sqrt(O*O+S*S+P*P);if(Math.abs(k)<1e-6)return null;O*=k=1/k,S*=k,P*=k,r=Math.sin(n),o=Math.cos(n),a=1-o,s=e[0],u=e[1],l=e[2],c=e[3],h=e[4],d=e[5],f=e[6],p=e[7],m=e[8],g=e[9],v=e[10],y=e[11],x=O*O*a+o,b=S*O*a+P*r,_=P*O*a-S*r,w=O*S*a-P*r,M=S*S*a+o,A=P*S*a+O*r,T=O*P*a+S*r,C=S*P*a-O*r,E=P*P*a+o,t[0]=s*x+h*b+m*_,t[1]=u*x+d*b+g*_,t[2]=l*x+f*b+v*_,t[3]=c*x+p*b+y*_,t[4]=s*w+h*M+m*A,t[5]=u*w+d*M+g*A,t[6]=l*w+f*M+v*A,t[7]=c*w+p*M+y*A,t[8]=s*T+h*C+m*E,t[9]=u*T+d*C+g*E,t[10]=l*T+f*C+v*E,t[11]=c*T+p*C+y*E,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t}},function(t,e){t.exports=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=o*r+l*i,t[5]=a*r+c*i,t[6]=s*r+h*i,t[7]=u*r+d*i,t[8]=l*r-o*i,t[9]=c*r-a*i,t[10]=h*r-s*i,t[11]=d*r-u*i,t}},function(t,e){t.exports=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*r-l*i,t[1]=a*r-c*i,t[2]=s*r-h*i,t[3]=u*r-d*i,t[8]=o*i+l*r,t[9]=a*i+c*r,t[10]=s*i+h*r,t[11]=u*i+d*r,t}},function(t,e){t.exports=function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],l=e[4],c=e[5],h=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=o*r+l*i,t[1]=a*r+c*i,t[2]=s*r+h*i,t[3]=u*r+d*i,t[4]=l*r-o*i,t[5]=c*r-a*i,t[6]=h*r-s*i,t[7]=d*r-u*i,t}},function(t,e){t.exports=function(t,e,n){var i,r,o,a=n[0],s=n[1],u=n[2],l=Math.sqrt(a*a+s*s+u*u);if(Math.abs(l)<1e-6)return null;return a*=l=1/l,s*=l,u*=l,i=Math.sin(e),r=Math.cos(e),o=1-r,t[0]=a*a*o+r,t[1]=s*a*o+u*i,t[2]=u*a*o-s*i,t[3]=0,t[4]=a*s*o-u*i,t[5]=s*s*o+r,t[6]=u*s*o+a*i,t[7]=0,t[8]=a*u*o+s*i,t[9]=s*u*o-a*i,t[10]=u*u*o+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=i+i,u=r+r,l=o+o,c=i*s,h=i*u,d=i*l,f=r*u,p=r*l,m=o*l,g=a*s,v=a*u,y=a*l;return t[0]=1-(f+m),t[1]=h+y,t[2]=d-v,t[3]=0,t[4]=h-y,t[5]=1-(c+m),t[6]=p+g,t[7]=0,t[8]=d+v,t[9]=p-g,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,u=r+r,l=n*a,c=i*a,h=i*s,d=r*a,f=r*s,p=r*u,m=o*a,g=o*s,v=o*u;return t[0]=1-h-p,t[1]=c+v,t[2]=d-g,t[3]=0,t[4]=c-v,t[5]=1-l-p,t[6]=f+m,t[7]=0,t[8]=d+g,t[9]=f-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},function(t,e){t.exports=function(t,e,n,i,r,o,a){var s=1/(n-e),u=1/(r-i),l=1/(o-a);return t[0]=2*o*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(r+i)*u,t[10]=(a+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*l,t[15]=0,t}},function(t,e){t.exports=function(t,e,n,i,r){var o=1/Math.tan(e/2),a=1/(i-r);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+i)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*i*a,t[15]=0,t}},function(t,e){t.exports=function(t,e,n,i){var r=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),a=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),u=2/(a+s),l=2/(r+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=-(a-s)*u*.5,t[9]=(r-o)*l*.5,t[10]=i/(n-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*n/(n-i),t[15]=0,t}},function(t,e){t.exports=function(t,e,n,i,r,o,a){var s=1/(e-n),u=1/(i-r),l=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(r+i)*u,t[14]=(a+o)*l,t[15]=1,t}},function(t,e,n){var i=n(110);t.exports=function(t,e,n,r){var o,a,s,u,l,c,h,d,f,p,m=e[0],g=e[1],v=e[2],y=r[0],x=r[1],b=r[2],_=n[0],w=n[1],M=n[2];if(Math.abs(m-_)<1e-6&&Math.abs(g-w)<1e-6&&Math.abs(v-M)<1e-6)return i(t);h=m-_,d=g-w,f=v-M,p=1/Math.sqrt(h*h+d*d+f*f),o=x*(f*=p)-b*(d*=p),a=b*(h*=p)-y*f,s=y*d-x*h,(p=Math.sqrt(o*o+a*a+s*s))?(o*=p=1/p,a*=p,s*=p):(o=0,a=0,s=0);u=d*s-f*a,l=f*o-h*s,c=h*a-d*o,(p=Math.sqrt(u*u+l*l+c*c))?(u*=p=1/p,l*=p,c*=p):(u=0,l=0,c=0);return t[0]=o,t[1]=u,t[2]=h,t[3]=0,t[4]=a,t[5]=l,t[6]=d,t[7]=0,t[8]=s,t[9]=c,t[10]=f,t[11]=0,t[12]=-(o*m+a*g+s*v),t[13]=-(u*m+l*g+c*v),t[14]=-(h*m+d*g+f*v),t[15]=1,t}},function(t,e){t.exports=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}},function(t,e,n){"use strict";var i=n(111),r=n(230),o={maxCount:1e3,count:0,memo:{}};function a(t,e){return o.count+=1,o.count>=o.maxCount&&(o.memo={},o.count=0),o.memo[t]=e,e}var s={convertColor:function(t){if(void 0===t||null===t||void 0!==t.r&&void 0!==t.g&&void 0!==t.b)return t;if(void 0!==o.memo[t])return o.memo[t];var e,n=t;if("string"==typeof t){var i=t.toLowerCase();if(r.hasOwnProperty(i))t={r:r[i][0]/255,g:r[i][1]/255,b:r[i][2]/255};else if("#"===t.charAt(0))4===t.length||5===t.length?(5===t.length&&(e=parseInt(t.slice(4),16)/15),t=4352*(3840&(t=parseInt(t.slice(1,4),16)))+272*(240&t)+17*(15&t)):7!==t.length&&9!==t.length||(9===t.length&&(e=parseInt(t.slice(7),16)/255),t=parseInt(t.slice(1,7),16));else if("transparent"===i)e=t=0;else if(i.indexOf("(")>=0)for(var u=0;u<s.cssColorConversions.length;u+=1){var l=s.cssColorConversions[u].regex.exec(i);if(l)return a(n,t=s.cssColorConversions[u].process(i,l))}}return isFinite(t)&&(t={r:((16711680&t)>>16)/255,g:((65280&t)>>8)/255,b:(255&t)/255}),void 0!==e&&t&&void 0!==t.r&&(t.a=e),a(n,t)},convertColorAndOpacity:function(t,e,n){return(t=s.convertColor(t))&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b||(t=s.convertColor(n||{r:0,g:0,b:0})),t&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b||(t={r:0,g:0,b:0}),t={r:isFinite(t.r)&&t.r>=0?t.r<=1?+t.r:1:0,g:isFinite(t.g)&&t.g>=0?t.g<=1?+t.g:1:0,b:isFinite(t.b)&&t.b>=0?t.b<=1?+t.b:1:0,a:i.isNonNullFinite(t.a)&&t.a>=0&&t.a<1?+t.a:1},i.isNonNullFinite(e)&&e<1&&(t.a=e<=0?0:t.a*e),t},convertColorToHex:function(t,e){var n,i=s.convertColor(t);return n=i.r||i.g||i.b?"#"+((1<<24)+(Math.round(255*i.r)<<16)+(Math.round(255*i.g)<<8)+Math.round(255*i.b)).toString(16).slice(1):"#000000",void 0!==i.a&&e&&(i.a<1||"needed"!==e)&&(n+=(256+Math.round(255*i.a)).toString(16).slice(1)),n},convertColorToRGBA:function(t){var e=s.convertColor(t);return e||(e={r:0,g:0,b:0}),(!i.isNonNullFinite(e.a)||e.a>1)&&(e.a=1),"rgba("+Math.round(255*e.r)+", "+Math.round(255*e.g)+", "+Math.round(255*e.b)+", "+ +(+e.a).toFixed(5)+")"},cssAngleUnitsBase:{deg:360,grad:400,rad:2*Math.PI,turn:1},cssNumberRegex:"[+-]?(?:\\d+\\.?\\d*|\\.\\d+)(?:[eE][+-]?\\d+)?"};s.cssColorConversions=[{name:"rgb",regex:new RegExp("^\\s*rgba?\\(\\s*("+s.cssNumberRegex+")\\s*(%?)\\s*,?\\s*("+s.cssNumberRegex+")\\s*(%?)\\s*,?\\s*("+s.cssNumberRegex+")\\s*(%?)\\s*([/,]?\\s*("+s.cssNumberRegex+")\\s*(%?)\\s*)?\\)\\s*$"),process:function(t,e){return t={r:Math.min(1,Math.max(0,+e[1]/(e[2]?100:255))),g:Math.min(1,Math.max(0,+e[3]/(e[4]?100:255))),b:Math.min(1,Math.max(0,+e[5]/(e[6]?100:255)))},e[7]&&(t.a=Math.min(1,Math.max(0,+e[8]/(e[9]?100:1)))),t}},{name:"hsl",regex:new RegExp("^\\s*hsla?\\(\\s*("+s.cssNumberRegex+")\\s*(deg|grad|rad|turn)?\\s*,?\\s*("+s.cssNumberRegex+")\\s*%\\s*,?\\s*("+s.cssNumberRegex+")\\s*%\\s*([/,]?\\s*("+s.cssNumberRegex+")\\s*(%?)\\s*)?\\)\\s*$"),process:function(t,e){var n=function(t,e,n){return 6*(n-=Math.floor(n))<1?t+(e-t)*n*6:6*n<3?e:6*n<4?t+(e-t)*(2/3-n)*6:t},i=+e[1]/(s.cssAngleUnitsBase[e[2]]||360),r=Math.min(1,Math.max(0,+e[3]/100)),o=Math.min(1,Math.max(0,+e[4]/100)),a=o<=.5?o*(r+1):o+r-o*r,u=2*o-a;return t={r:n(u,a,i+1/3),g:n(u,a,i),b:n(u,a,i-1/3)},e[5]&&(t.a=Math.min(1,Math.max(0,+e[6]/(e[7]?100:1)))),t}}],t.exports=s},function(t,e,n){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(t,e,n){"use strict";var i=function(t,e,n,i,r){var o,a=0;return"boolean"!=typeof e&&(r=i,i=n,n=e,e=void 0),"function"!=typeof i&&(r=i,i=function(){}),function(){var s=this,u=+new Date-a,l=arguments;function c(){a=+new Date,n.apply(s,l)}i.apply(s,l),r&&!o&&c(),o&&clearTimeout(o),void 0===r&&u>t?c():!0!==e&&(o=setTimeout(r?function(){o=void 0}:c,void 0===r?t-u:t))}};t.exports={throttle:i,debounce:function(t,e,n,r){return"boolean"!=typeof e&&(r=n,n=e,e=!1),i(t,!1,n,r=r||function(){},!!e)}}},function(t,e,n){"use strict";var i,r,o=n(2),a=n(12),s=n(49);t.exports={},t.exports.mockWebglRenderer=function(t){var e=n(12);if(void 0===t&&(t=!0),e._mocked)throw new Error("webgl renderer already mocked");var a={},u=function(t){a[t]=(a[t]||0)+1},l=function(t){return function(){u(t)}},c=0,h=function(t){return function(){return u(t),c+=1}},d={activeTexture:l("activeTexture"),attachShader:l("attachShader"),bindAttribLocation:l("bindAttribLocation"),bindBuffer:l("bindBuffer"),bindFramebuffer:l("bindFramebuffer"),bindTexture:l("bindTexture"),blendFuncSeparate:l("blendFuncSeparate"),bufferData:l("bufferData"),bufferSubData:l("bufferSubData"),checkFramebufferStatus:function(t){if(u("checkFramebufferStatus"),t===e.GL.FRAMEBUFFER)return e.GL.FRAMEBUFFER_COMPLETE},clear:l("clear"),clearColor:l("clearColor"),clearDepth:l("clearDepth"),compileShader:l("compileShader"),createBuffer:h("createBuffer"),createFramebuffer:l("createFramebuffer"),createProgram:h("createProgram"),createShader:h("createShader"),createTexture:h("createTexture"),deleteBuffer:l("deleteBuffer"),deleteProgram:l("deleteProgram"),deleteShader:l("deleteShader"),deleteTexture:l("deleteTexture"),detachShader:l("detachShader"),depthFunc:l("depthFunc"),disable:l("disable"),disableVertexAttribArray:l("disableVertexAttribArray"),drawArrays:l("drawArrays"),enable:l("enable"),enableVertexAttribArray:l("enableVertexAttribArray"),finish:l("finish"),getExtension:h("getExtension"),getParameter:function(t){if(u("getParameter"),t===e.GL.DEPTH_BITS)return 16},getProgramParameter:function(t,n){if(u("getProgramParameter"),n===e.GL.LINK_STATUS)return!0},getShaderInfoLog:function(){return u("getShaderInfoLog"),"log"},getShaderParameter:function(t,n){if(u("getShaderParameter"),n===e.GL.COMPILE_STATUS)return!0},getSupportedExtensions:function(){return u("getSupportedExtensions"),[]},getUniformLocation:h("getUniformLocation"),isEnabled:function(t){if(u("isEnabled"),t===e.GL.BLEND)return!0},linkProgram:l("linkProgram"),pixelStorei:l("pixelStorei"),shaderSource:l("shaderSource"),texImage2D:l("texImage2D"),texParameteri:l("texParameteri"),uniform1iv:l("uniform1iv"),uniform1fv:l("uniform1fv"),uniform2fv:l("uniform2fv"),uniform3fv:l("uniform3fv"),uniform4fv:l("uniform4fv"),uniformMatrix3fv:l("uniformMatrix3fv"),uniformMatrix4fv:l("uniformMatrix4fv"),useProgram:l("useProgram"),vertexAttribPointer:l("vertexAttribPointer"),vertexAttrib3fv:l("vertexAttrib3fv"),viewport:l("viewport")};i=e.renderWindow;e.renderWindow=function t(){e.renderWindow=i;var n,r=new e.renderWindow;return e.renderWindow=t,r._setup=function(){var t,i=r.renderers(),a=r.windowSize(),s=r.windowPosition();for(n=o.extend({},e.GL,d),t=0;t<i.length;t+=1)(i[t].width()>a[0]||0===i[t].width()||i[t].height()>a[1]||0===i[t].height())&&i[t].resize(s[0],s[1],a[0],a[1]);return!0},r.context=function(){return n},r},r=s.supported,s.supported=function(){return!!t},e._mocked=!0,e.mockCounts=function(){return a}},t.exports.restoreWebglRenderer=function(){a._mocked&&(a.renderWindow=i,s.supported=r,delete a._mocked,delete a.mockCounts)}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var i,r,o,a=n(23),s=n(112),u=n(36),l=n(2);r=this,o=function(){if(void 0===t)var t={};t.namespace=function(e){"use strict";var n,i=e.split("."),r=t;for("ogs"===i[0]&&(i=i.slice(1)),n=0;n<i.length;n+=1)void 0===r[i[n]]&&(r[i[n]]={}),r=r[i[n]];return r};var e=t.namespace("gl");window.vgl=e,e.inherit=function(t,e){"use strict";var n=inherit.func();n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},e.inherit.func=function(){"use strict";return function(){}},window.inherit=e.inherit,Object.size=function(t){"use strict";var e,n=0;for(e in t)t.hasOwnProperty(e)&&(n+=1);return n},Math.log2||(Math.log2=function(t){return Math.log(t)/Math.log(2)}),e.version="0.3.11",e.GL={ACTIVE_ATTRIBUTES:35721,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALPHA:6406,ALPHA_BITS:3413,ALWAYS:519,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATTACHED_SHADERS:35717,BACK:1029,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BROWSER_DEFAULT_WEBGL:37444,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,COMPILE_STATUS:35713,COMPRESSED_TEXTURE_FORMATS:34467,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_LOST_WEBGL:37442,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH_ATTACHMENT:36096,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DONT_CARE:4352,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,FASTEST:4353,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GREATER:516,GREEN_BITS:3411,HIGH_FLOAT:36338,HIGH_INT:36341,INCR:7682,INCR_WRAP:34055,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE_ALPHA:6410,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_RENDERBUFFER_SIZE:34024,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIRRORED_REPEAT:33648,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,RED_BITS:3410,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,REPEAT:10497,REPLACE:7681,RGB:6407,RGB565:36194,RGB5_A1:32855,RGBA:6408,RGBA4:32854,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_CLEAR_VALUE:2961,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,UNPACK_ALIGNMENT:3317,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VIEWPORT:2978,ZERO:0};var n=0;e.timestamp=function(){"use strict";if(!(this instanceof e.timestamp))return new e.timestamp;var t=0;this.modified=function(){t=n+=1},this.getMTime=function(){return t}},e.object=function(){"use strict";if(!(this instanceof e.object))return new e.object;var t=e.timestamp();return t.modified(),this.modified=function(){t.modified()},this.getMTime=function(){return t.getMTime()},this},e.event=function(){"use strict";return this instanceof e.event?(e.object.call(this),this):new e.event},inherit(e.event,e.object),e.event.keyPress="vgl.event.keyPress",e.event.mousePress="vgl.event.mousePress",e.event.mouseRelease="vgl.event.mouseRelease",e.event.contextMenu="vgl.event.contextMenu",e.event.configure="vgl.event.configure",e.event.enable="vgl.event.enable",e.event.mouseWheel="vgl.event.mouseWheel",e.event.keyRelease="vgl.event.keyRelease",e.event.middleButtonPress="vgl.event.middleButtonPress",e.event.startInteraction="vgl.event.startInteraction",e.event.enter="vgl.event.enter",e.event.rightButtonPress="vgl.event.rightButtonPress",e.event.middleButtonRelease="vgl.event.middleButtonRelease",e.event.char="vgl.event.char",e.event.disable="vgl.event.disable",e.event.endInteraction="vgl.event.endInteraction",e.event.mouseMove="vgl.event.mouseMove",e.event.mouseOut="vgl.event.mouseOut",e.event.expose="vgl.event.expose",e.event.timer="vgl.event.timer",e.event.leftButtonPress="vgl.event.leftButtonPress",e.event.leave="vgl.event.leave",e.event.rightButtonRelease="vgl.event.rightButtonRelease",e.event.leftButtonRelease="vgl.event.leftButtonRelease",e.event.click="vgl.event.click",e.event.dblClick="vgl.event.dblClick",e.boundingObject=function(){"use strict";if(!(this instanceof e.boundingObject))return new e.boundingObject;e.object.call(this);var t=[0,0,0,0,0,0],n=e.timestamp(),i=e.timestamp();return n.modified(),i.modified(),this.bounds=function(){return t},this.hasValidBounds=function(t){return t[0]!==Number.MAX_VALUE&&t[1]!==-Number.MAX_VALUE&&t[2]!==Number.MAX_VALUE&&t[3]!==-Number.MAX_VALUE&&t[4]!==Number.MAX_VALUE&&t[5]!==-Number.MAX_VALUE},this.setBounds=function(e,i,r,o,a,s){if(this.hasValidBounds([e,i,r,o,a,s]))return t[0]=e,t[1]=i,t[2]=r,t[3]=o,t[4]=a,t[5]=s,this.modified(),n.modified(),!0},this.resetBounds=function(){t[0]=Number.MAX_VALUE,t[1]=-Number.MAX_VALUE,t[2]=Number.MAX_VALUE,t[3]=-Number.MAX_VALUE,t[4]=Number.MAX_VALUE,t[5]=-Number.MAX_VALUE,this.modified()},this.computeBounds=function(){},this.computeBoundsTimestamp=function(){return n},this.boundsDirtyTimestamp=function(){return i},this.resetBounds(),this},e.boundingObject.ReferenceFrame={Relative:0,Absolute:1},inherit(e.boundingObject,e.object),e.node=function(){"use strict";if(!(this instanceof e.node))return new e.node;e.boundingObject.call(this);var t=null,n=null,i=!0,r=!1;return this.accept=function(t){t.visit(this)},this.material=function(){return n},this.setMaterial=function(t){return t!==n&&(n=t,this.modified(),!0)},this.visible=function(){return i},this.setVisible=function(t){return t!==i&&(i=t,this.modified(),!0)},this.parent=function(){return t},this.setParent=function(e){return e!==t&&(null!==t&&t.removeChild(this),t=e,this.modified(),!0)},this.overlay=function(){return r},this.setOverlay=function(t){return r!==t&&(r=t,this.modified(),!0)},this.ascend=function(t){t=t},this.traverse=function(t){t=t},this.boundsModified=function(){this.boundsDirtyTimestamp().modified(),null!==t&&t.boundsModified()},this},inherit(e.node,e.boundingObject),e.groupNode=function(){"use strict";if(!(this instanceof e.groupNode))return new e.groupNode;e.node.call(this);var t=[];return this.b_setVisible=this.setVisible,this.setVisible=function(e){var n;if(!0!==this.b_setVisible(e))return!1;for(n=0;n<t.length;n+=1)t[n].setVisible(e);return!0},this.addChild=function(n){return n instanceof e.node&&(-1===t.indexOf(n)&&(n.setParent(this),t.push(n),this.boundsDirtyTimestamp().modified(),!0))},this.removeChild=function(e){if(e.parent()===this){var n=t.indexOf(e);if(n>=0)return t.splice(n,1),e.setParent(null),this.boundsDirtyTimestamp().modified(),!0}},this.removeChildren=function(){for(;t.length;)this.removeChild(t[0]);this.modified()},this.children=function(){return t},this.hasChild=function(e){var n=0,i=!1;for(n=0;n<t.length;n+=1)if(t[n]===e){i=!0;break}return i},this.accept=function(t){t.visit(this)},this.traverse=function(t){switch(t.type()){case t.UpdateVisitor:this.traverseChildrenAndUpdateBounds(t);break;case t.CullVisitor:this.traverseChildren(t)}},this.traverseChildrenAndUpdateBounds=function(e){var n;if(this.parent()&&this.boundsDirtyTimestamp().getMTime()>this.computeBoundsTimestamp().getMTime()&&this.parent().boundsDirtyTimestamp().modified(),this.computeBounds(),e.mode()===e.TraverseAllChildren)for(n=0;n<t.length;n+=1)t[n].accept(e),this.updateBounds(t[n]);this.computeBoundsTimestamp().modified()},this.traverseChildren=function(e){var n;if(e.mode()===e.TraverseAllChildren)for(n=0;n<t.length;n+=1)t[n].accept(e)},this.computeBounds=function(){var e=0;if(!(this.computeBoundsTimestamp().getMTime()>this.boundsDirtyTimestamp().getMTime()))for(e=0;e<t.length;e+=1)this.updateBounds(t[e])},this.updateBounds=function(t){if(!t.overlay()){t.computeBounds();var e,n=this.bounds(),i=t.bounds(),r=0,o=0;for(e=0;e<3;e+=1)o=2*e+1,i[r=2*e]<n[r]&&(n[r]=i[r]),i[o]>n[o]&&(n[o]=i[o]);this.setBounds(n[0],n[1],n[2],n[3],n[4],n[5])}},this},inherit(e.groupNode,e.node),e.actor=function(){"use strict";if(!(this instanceof e.actor))return new e.actor;e.node.call(this);var t=this,n=a.create(),i=e.boundingObject.ReferenceFrame.Relative,r=null;return this.matrix=function(){return n},this.setMatrix=function(e){e!==n&&(n=e,t.modified())},this.referenceFrame=function(){return i},this.setReferenceFrame=function(e){return e!==i&&(i=e,t.modified(),!0)},this.mapper=function(){return r},this.setMapper=function(e){e!==r&&(r=e,t.boundsModified())},this.accept=function(t){t=t},this.ascend=function(t){t=t},this.computeLocalToWorldMatrix=function(t,e){t=t,e=e},this.computeWorldToLocalMatrix=function(t,e){t=t,e=e},this.computeBounds=function(){if(null!==r&&void 0!==r){var e,i,o,a,s=t.computeBoundsTimestamp();(t.boundsDirtyTimestamp().getMTime()>s.getMTime()||r.boundsDirtyTimestamp().getMTime()>s.getMTime())&&(r.computeBounds(),i=[(e=r.bounds())[0],e[2],e[4]],o=[e[1],e[3],e[5]],u.transformMat4(i,i,n),u.transformMat4(o,o,n),a=[i[0]>o[0]?o[0]:i[0],i[0]>o[0]?i[0]:o[0],i[1]>o[1]?o[1]:i[1],i[1]>o[1]?i[1]:o[1],i[2]>o[2]?o[2]:i[2],i[2]>o[2]?i[2]:o[2]],t.setBounds(a[0],a[1],a[2],a[3],a[4],a[5]),s.modified())}else t.resetBounds()},t},inherit(e.actor,e.node),e.freezeObject=function(t){"use strict";var e=Object.freeze?Object.freeze(t):void 0;return void 0===e?t:e},e.defaultValue=function(t,e){"use strict";return void 0!==t?t:e},e.defaultValue.EMPTY_OBJECT=e.freezeObject({}),e.graphicsObject=function(t){"use strict";if(t=t,!(this instanceof e.graphicsObject))return new e.graphicsObject;e.object.call(this);var n=this;return this._setup=function(t){return t=t,!1},this._cleanup=function(t){return t=t,!1},this.bind=function(t){return t=t,!1},this.undoBind=function(t){return t=t,!1},this.render=function(t){return t=t,!1},this.remove=function(t){n._cleanup(t)},n},inherit(e.graphicsObject,e.object),e.geojsonReader=function(){"use strict";return this instanceof e.geojsonReader?(this.readScalars=function(t,n,i,r){var o=null,a=null,s=null,u=null,l=null;"values"===this.m_scalarFormat&&4===t.length?(a=t[3],(o=n.sourceData(e.vertexAttributeKeys.Scalar))||(o=new e.sourceDataSf,this.m_scalarRange&&o.setScalarRange(this.m_scalarRange[0],this.m_scalarRange[1]),void 0!==i&&(o.data().length=i),n.addSource(o)),void 0===i?o.pushBack(a):o.insertAt(r,a)):"rgb"===this.m_scalarFormat&&6===t.length&&((o=n.sourceData(e.vertexAttributeKeys.Color))||(o=new e.sourceDataC3fv,void 0!==i&&(o.length=3*i),n.addSource(o)),s=t[3],u=t[4],l=t[5],void 0===i?o.pushBack([s,u,l]):o.insertAt(r,[s,u,l]))},this.readPoint=function(t){var n=new e.geometryData,i=new e.points,r=new e.sourceDataP3fv,o=new Uint16Array(1),a=null,s=null,u=null,l=null;for(n.addSource(r),l=0;l<1;l+=1)o[l]=l,a=t[0],s=t[1],u=0,t.length>2&&(u=t[2]),r.pushBack([a,s,u]),this.readScalars(t,n);return i.setIndices(o),n.addPrimitive(i),n.setName("aPoint"),n},this.readMultiPoint=function(t){var n,i=new e.geometryData,r=new e.points,o=new e.sourceDataP3fv,a=new Uint16Array(t.length),s=0,u=t.length,l=null,c=null,h=null;for(o.data().length=3*u,n=0;n<t.length;n+=1)a[n]=n,l=t[n][0],c=t[n][1],h=0,t[n].length>2&&(h=t[n][2]),o.insertAt(s,[l,c,h]),this.readScalars(t[n],i,u,s),s+=1;return r.setIndices(a),i.addPrimitive(r),i.addSource(o),i.setName("manyPoints"),i},this.readLineString=function(t){var n=new e.geometryData,i=new e.lineStrip,r=new e.sourceDataP3fv,o=[],a=null,s=null,u=null,l=null;for(i.setIndicesPerPrimitive(t.length),a=0;a<t.length;a+=1)o.push(a),s=t[a][0],u=t[a][1],l=0,t[a].length>2&&(l=t[a][2]),r.pushBack([s,u,l]),this.readScalars(t[a],n);return i.setIndices(o),n.addPrimitive(i),n.addSource(r),n.setName("aLineString"),n},this.readMultiLineString=function(t){var n=new e.geometryData,i=new e.sourceDataP3fv,r=0,o=2*t.length,a=null,s=null,u=null,l=null,c=null,h=null,d=null,f=null;for(i.data().length=3*o,s=0;s<t.length;s+=1){for(h=[],d=new e.lineStrip,f=t[s].length,d.setIndicesPerPrimitive(f),a=0;a<f;a+=1)h.push(r),u=t[s][a][0],l=t[s][a][1],c=0,t[s][a].length>2&&(c=t[s][a][2]),i.insertAt(r,[u,l,c]),this.readScalars(t[s][a],n,2*o,r),r+=1;d.setIndices(h),n.addPrimitive(d)}return n.setName("aMultiLineString"),n.addSource(i),n},this.readPolygon=function(t){var n=new e.geometryData,i=new e.sourceDataP3fv,r=null,o=null,a=null,s=t[0].length,u=1,l=null,c=null,h=null;for(l=0;l<s;l+=1)r=t[0][l][0],o=t[0][l][1],a=0,t[0][l].length>2&&(a=t[0][l][2]),i.pushBack([r,o,a]),this.readScalars(t[0][l],n),l>1&&(c=new Uint16Array([0,u,l]),(h=new e.triangles).setIndices(c),n.addPrimitive(h),u=l);return n.setName("POLY"),n.addSource(i),n},this.readMultiPolygon=function(t){var n=new e.geometryData,i=new e.sourceDataP3fv,r=0,o=t.length,a=0,s=3*o,u=new e.triangles,l=[],c=null,h=null,d=null,f=null,p=null,m=null,g=null,v=null,y=null,x=!1,b=0;for(i.data().length=3*o,h=0;h<o;h+=1)for(m=t[h][0].length,g=r,v=r+1,y=[!1,!1,!1],c=0;c<m;c+=1)d=t[h][0][c][0],f=t[h][0][c][1],p=0,t[h][0][c].length>2&&(p=t[h][0][c][2]),x=!1,d>180&&(x=!0,d-=360),0===c?y[0]=x:y[1+(c-1)%2]=x,i.insertAt(a,[d,f,p]),this.readScalars(t[h][0][c],n,s,a),a+=1,c>1&&(y[0]===y[1]&&y[1]===y[2]&&(l[3*b+0]=g,l[3*b+1]=v,l[3*b+2]=r,b+=1),v=r),r+=1;return u.setIndices(l),n.addPrimitive(u),n.setName("aMultiPoly"),n.addSource(i),n},this.readGJObjectInt=function(t){if(!t.hasOwnProperty("type"))return null;t.properties&&t.properties.ScalarFormat&&"values"===t.properties.ScalarFormat&&(this.m_scalarFormat="values",t.properties.ScalarRange&&(this.m_scalarRange=t.properties.ScalarRange)),t.properties&&t.properties.ScalarFormat&&"rgb"===t.properties.ScalarFormat&&(this.m_scalarFormat="rgb");var e,n=t.type,i=null,r=null,o=null;switch(n){case"Point":e=this.readPoint(t.coordinates);break;case"MultiPoint":e=this.readMultiPoint(t.coordinates);break;case"LineString":e=this.readLineString(t.coordinates);break;case"MultiLineString":e=this.readMultiLineString(t.coordinates);break;case"Polygon":e=this.readPolygon(t.coordinates);break;case"MultiPolygon":e=this.readMultiPolygon(t.coordinates);break;case"GeometryCollection":for(r=[],o=0;o<t.geometries.length;o+=1)i=this.readGJObject(t.geometries[o]),r.push(i);e=r;break;case"Feature":e=i=this.readGJObject(t.geometry);break;case"FeatureCollection":for(r=[],o=0;o<t.features.length;o+=1)i=this.readGJObject(t.features[o]),r.push(i);e=r;break;default:console.log("Don't understand type "+n),e=null}return e},this.readGJObject=function(t){return this.readGJObjectInt(t)},this.linearizeGeoms=function(t,e){var n=null;if("[object Array]"===Object.prototype.toString.call(e))for(n=0;n<e.length;n+=1)this.linearizeGeoms(t,e[n]);else t.push(e)},this.readGeomObject=function(t){var e,n=[];return e=this.readGJObject(t),this.linearizeGeoms(n,e),n},this.getPrimitives=function(t){if(!t)return[];var e=JSON.parse(t),n=this.readGJObject(e),i=[];return this.m_scalarFormat="none",this.m_scalarRange=null,this.linearizeGeoms(i,n),{geoms:i,scalarFormat:this.m_scalarFormat,scalarRange:this.m_scalarRange}},this):new e.geojsonReader},e.data=function(){"use strict";if(!(this instanceof e.data))return new e.data;this.type=function(){}},e.data.raster=0,e.data.point=1,e.data.lineString=2,e.data.polygon=3,e.data.geometry=10,e.primitive=function(){"use strict";if(!(this instanceof e.primitive))return new e.primitive;var t=0,n=0,i=0,r=null;return this.indices=function(){return r},this.createIndices=function(t){r=new Uint16Array},this.numberOfIndices=function(){return r.length},this.sizeInBytes=function(){return r.length*Uint16Array.BYTES_PER_ELEMENT},this.primitiveType=function(){return n},this.setPrimitiveType=function(t){n=t},this.indicesPerPrimitive=function(){return t},this.setIndicesPerPrimitive=function(e){t=e},this.indicesValueType=function(){return i},this.setIndicesValueType=function(t){i=t},this.setIndices=function(t){r=new Uint16Array(t)},this},e.triangleStrip=function(){"use strict";return this instanceof e.triangleStrip?(e.primitive.call(this),this.setPrimitiveType(e.GL.TRIANGLE_STRIP),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(3),this):new e.triangleStrip},inherit(e.triangleStrip,e.primitive),e.triangles=function(){"use strict";return this instanceof e.triangles?(e.primitive.call(this),this.setPrimitiveType(e.GL.TRIANGLES),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(3),this):new e.triangles},inherit(e.triangles,e.primitive),e.lines=function(){"use strict";return this instanceof e.lines?(e.primitive.call(this),this.setPrimitiveType(e.GL.LINES),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(2),this):new e.lines},inherit(e.lines,e.primitive),e.lineStrip=function(){"use strict";return this instanceof e.lineStrip?(e.primitive.call(this),this.setPrimitiveType(e.GL.LINE_STRIP),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(2),this):new e.lineStrip},inherit(e.lineStrip,e.primitive),e.points=function(){"use strict";return this instanceof e.points?(e.primitive.call(this),this.setPrimitiveType(e.GL.POINTS),this.setIndicesValueType(e.GL.UNSIGNED_SHORT),this.setIndicesPerPrimitive(1),this):new e.points},inherit(e.points,e.primitive),e.vertexDataP3f=function(){"use strict";return this instanceof e.vertexDataP3f?(this.m_position=[],this):new e.vertexDataP3f},e.vertexDataP3N3f=function(){"use strict";return this instanceof e.vertexDataP3N3f?(this.m_position=[],this.m_normal=[],this):new e.vertexDataP3N3f},e.vertexDataP3T3f=function(){"use strict";return this instanceof e.vertexDataP3T3f?(this.m_position=[],this.m_texCoordinate=[],this):new e.vertexDataP3T3f},e.sourceData=function(t){"use strict";if(!(this instanceof e.sourceData))return new e.sourceData(t);var n={},i=[],r=(t=t||{}).name||"Source "+(new Date).toISOString();return this.data=function(){return i},this.getData=function(){return this.data()},this.dataToFloat32Array=function(){return i instanceof Float32Array||(i=new Float32Array(i)),i},this.setData=function(t){t instanceof Array||t instanceof Float32Array?i=t instanceof Float32Array?t:t.slice(0):console.log("[error] Requires array")},this.addAttribute=function(t,e,i,r,o,a,s){if(!n.hasOwnProperty(t)){var u=new function(){this.m_numberOfComponents=0,this.m_dataType=0,this.m_dataTypeSize=0,this.m_normalized=!1,this.m_stride=0,this.m_offset=0};u.m_dataType=e,u.m_dataTypeSize=i,u.m_offset=r,u.m_stride=o,u.m_numberOfComponents=a,u.m_normalized=s,n[t]=u}},this.sizeOfArray=function(){return Object.size(i)},this.lengthOfArray=function(){return i.length},this.sizeInBytes=function(){var t,e=0,n=this.keys();for(t=0;t<n.length;t+=1)e+=this.attributeNumberOfComponents(n[t])*this.sizeOfAttributeDataType(n[t]);return e*=this.sizeOfArray()},this.hasKey=function(t){return n.hasOwnProperty(t)},this.keys=function(){return Object.keys(n)},this.numberOfAttributes=function(){return Object.size(n)},this.attributeNumberOfComponents=function(t){return n.hasOwnProperty(t)?n[t].m_numberOfComponents:0},this.normalized=function(t){return!!n.hasOwnProperty(t)&&n[t].m_normalized},this.sizeOfAttributeDataType=function(t){return n.hasOwnProperty(t)?n[t].m_dataTypeSize:0},this.attributeDataType=function(t){if(n.hasOwnProperty(t))return n[t].m_dataType},this.attributeOffset=function(t){return n.hasOwnProperty(t)?n[t].m_offset:0},this.attributeStride=function(t){return n.hasOwnProperty(t)?n[t].m_stride:0},this.pushBack=function(t){},this.insert=function(t){var e;if(!i.length&&t.length&&t instanceof Float32Array)i=t;else if(i.slice||!i.length&&t.slice||(i=Array.prototype.slice.call(i)),t.length)if(!i.length&&t.slice)i=t.slice(0);else for(e=0;e<t.length;e+=1)i[i.length]=t[e];else i[i.length]=t},this.insertAt=function(t,e){var n;if(e.length)for(n=0;n<e.length;n+=1)i[t*e.length+n]=e[n];else i[t]=e},this.name=function(){return r},this.setName=function(t){r=t},this},e.sourceDataAnyfv=function(t,n,i){"use strict";return this instanceof e.sourceDataAnyfv?(e.sourceData.call(this,i),this.addAttribute(n,e.GL.FLOAT,4,0,4*t,t,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataAnyfv(t,n,i)},inherit(e.sourceDataAnyfv,e.sourceData),e.sourceDataP3T3f=function(t){"use strict";return this instanceof e.sourceDataP3T3f?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Position,e.GL.FLOAT,4,0,24,3,!1),this.addAttribute(e.vertexAttributeKeys.TextureCoordinate,e.GL.FLOAT,4,12,24,3,!1),this.pushBack=function(t){this.insert(t.m_position),this.insert(t.m_texCoordinate)},this):new e.sourceDataP3T3f(t)},inherit(e.sourceDataP3T3f,e.sourceData),e.sourceDataP3N3f=function(t){"use strict";return this instanceof e.sourceDataP3N3f?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Position,e.GL.FLOAT,4,0,24,3,!1),this.addAttribute(e.vertexAttributeKeys.Normal,e.GL.FLOAT,4,12,24,3,!1),this.pushBack=function(t){this.insert(t.m_position),this.insert(t.m_normal)},this):new e.sourceDataP3N3f(t)},inherit(e.sourceDataP3N3f,e.sourceData),e.sourceDataP3fv=function(t){"use strict";return this instanceof e.sourceDataP3fv?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Position,e.GL.FLOAT,4,0,12,3,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataP3fv(t)},inherit(e.sourceDataP3fv,e.sourceData),e.sourceDataT2fv=function(t){"use strict";return this instanceof e.sourceDataT2fv?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.TextureCoordinate,e.GL.FLOAT,4,0,8,2,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataT2fv(t)},inherit(e.sourceDataT2fv,e.sourceData),e.sourceDataC3fv=function(t){"use strict";return this instanceof e.sourceDataC3fv?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Color,e.GL.FLOAT,4,0,12,3,!1),this.pushBack=function(t){this.insert(t)},this):new e.sourceDataC3fv(t)},inherit(e.sourceDataC3fv,e.sourceData),e.sourceDataSf=function(t){"use strict";if(!(this instanceof e.sourceDataSf))return new e.sourceDataSf(t);var n=null,i=null,r=null,o=null;return e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Scalar,e.GL.FLOAT,4,0,4,1,!1),this.pushBack=function(t){(null===i||t>i)&&(i=t),(null===n||t<n)&&(n=t),this.data()[this.data().length]=t},this.insertAt=function(t,e){(null===i||e>i)&&(i=e),(null===n||e<n)&&(n=e),this.data()[t]=e},this.scalarRange=function(){return null===r||null===o?[n,i]:[r,o]},this.setScalarRange=function(t,e){r=t,o=e},this},inherit(e.sourceDataSf,e.sourceData),e.sourceDataDf=function(t){"use strict";return this instanceof e.sourceDataDf?(e.sourceData.call(this,t),this.addAttribute(e.vertexAttributeKeys.Scalar,e.GL.FLOAT,4,0,4,1,!1),this.pushBack=function(t){this.data()[this.data().length]=t},this.insertAt=function(t,e){this.data()[t]=e},this):new e.sourceDataDf(t)},inherit(e.sourceDataDf,e.sourceData),e.geometryData=function(){"use strict";if(!(this instanceof e.geometryData))return new e.geometryData;e.data.call(this);var t="",n=[],i=[],r=[0,0,0,0,0,0],o=e.timestamp(),a=e.timestamp();return this.type=function(){return e.data.geometry},this.name=function(){return t},this.setName=function(e){t=e},this.addSource=function(t,n){return void 0!==n&&t.setName(n),-1===i.indexOf(t)&&(i.push(t),t.hasKey(e.vertexAttributeKeys.Position)&&a.modified(),!0)},this.source=function(t){return t<i.length?i[t]:0},this.sourceByName=function(t){for(var e=0;e<i.length;e+=1)if(i[e].name()===t)return i[e];return 0},this.numberOfSources=function(){return i.length},this.sourceData=function(t){var e;for(e=0;e<i.length;e+=1)if(i[e].hasKey(t))return i[e];return null},this.addPrimitive=function(t){return n.push(t),!0},this.primitive=function(t){return t<n.length?n[t]:null},this.numberOfPrimitives=function(){return n.length},this.bounds=function(){return a.getMTime()>o.getMTime()&&this.computeBounds(),r},this.boundsDirty=function(t){return t&&a.modified(),a.getMTime()>o.getMTime()},this.resetBounds=function(){r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0},this.setBounds=function(t,e,n,i,a,s){return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r[4]=a,r[5]=s,o.modified(),!0},this.computeBounds=function(){if(a.getMTime()>o.getMTime()){var t,n,i,s,u,l,c=e.vertexAttributeKeys.Position,h=this.sourceData(c),d=h.data(),f=h.attributeNumberOfComponents(c),p=h.attributeStride(c),m=h.attributeOffset(c),g=h.sizeOfAttributeDataType(c),v=d.length,y=null;for(p/=g,m/=g,this.resetBounds(),t=0;t<f;t+=1){for(n=2*t,i=2*t+1,s=u=v?r[i]=d[m+t]:0,l=m+p+t;l<v;l+=p)(y=d[l])>s&&(s=y),y<u&&(u=y);r[n]=u,r[i]=s}o.modified()}},this.findClosestVertex=function(t){var n,i,r,o,a,s,u,l=e.vertexAttributeKeys.Position,c=this.sourceData(l),h=c.sizeOfAttributeDataType(l),d=c.attributeNumberOfComponents(l),f=c.data(),p=c.attributeStride(l)/h,m=c.attributeOffset(l)/h,g=Number.MAX_VALUE,v=null;for(3!==d&&console.log("[warning] Find closest vertex assumes threecomponent vertex "),t.z||(t={x:t.x,y:t.y,z:0}),n=m,u=0;n<f.length;n+=p,u+=1)r=(i=[f[n],f[n+1],f[n+2]])[0]-t.x,o=i[1]-t.y,a=i[2]-t.z,(s=Math.sqrt(r*r+o*o+a*a))<g&&(g=s,v=u);return v},this.getPosition=function(t){var n=e.vertexAttributeKeys.Position,i=this.sourceData(n),r=i.sizeOfAttributeDataType(n),o=i.attributeNumberOfComponents(n),a=i.data(),s=i.attributeStride(n)/r,u=i.attributeOffset(n)/r;return 3!==o&&console.log("[warning] getPosition assumes three component data"),[a[u+t*s],a[u+t*s+1],a[u+t*s+2]]},this.getScalar=function(t){var n,i,r,o,a=e.vertexAttributeKeys.Scalar,s=this.sourceData(a);return s?(n=s.sizeOfAttributeDataType(a),i=s.data(),t*(r=s.attributeStride(a)/n)+(o=s.attributeOffset(a)/n)>=i.length&&console.log("access out of bounds in getScalar"),i[t*r+o]):null},this},inherit(e.geometryData,e.data),e.mapper=function(t){"use strict";if(!(this instanceof e.mapper))return new e.mapper(t);e.boundingObject.call(this);var n=[0,1,1],i=null,r=[],o={},a=void 0!==(t=t||{}).dynamicDraw&&t.dynamicDraw,s=e.timestamp(),u=null,l=this;function c(t){o={},r=[]}function h(t){l.deleteVertexBufferObjects(t),c(),function(t){if(i){t&&(u=t.m_context);var n,l,c,h,d,f,p,m=i.numberOfSources(),g=null;for(n=0;n<m;n+=1){for(g=u.createBuffer(),u.bindBuffer(e.GL.ARRAY_BUFFER,g),(p=i.source(n).data())instanceof Float32Array||(p=new Float32Array(p)),u.bufferData(e.GL.ARRAY_BUFFER,p,a?e.GL.DYNAMIC_DRAW:e.GL.STATIC_DRAW),h=i.source(n).keys(),d=[],l=0;l<h.length;l+=1)d.push(h[l]);o[n]=d,r[n]=g}for(f=i.numberOfPrimitives(),c=0;c<f;c+=1)g=u.createBuffer(),u.bindBuffer(e.GL.ARRAY_BUFFER,g),u.bufferData(e.GL.ARRAY_BUFFER,i.primitive(c).indices(),e.GL.STATIC_DRAW),r[n]=g,n+=1;s.modified()}}(t)}return this.deleteVertexBufferObjects=function(t){var e,n=u;if(t&&(n=t.m_context),n)for(e=0;e<r.length;e+=1)n.deleteBuffer(r[e])},this._cleanup=function(t){l.deleteVertexBufferObjects(t),c(t),l.modified()},this.computeBounds=function(){if(null!==i&&void 0!==i){var t=this.computeBoundsTimestamp(),e=null;this.boundsDirtyTimestamp().getMTime()>t.getMTime()&&(e=i.bounds(),this.setBounds(e[0],e[1],e[2],e[3],e[4],e[5]),t.modified())}else this.resetBounds()},this.color=function(){return n},this.setColor=function(t,e,i){n[0]=t,n[1]=e,n[2]=i,this.modified()},this.geometryData=function(){return i},this.setGeometryData=function(t){i!==t&&(i=t,this.modified(),this.boundsDirtyTimestamp().modified())},this.updateSourceBuffer=function(t,n,o){if(o&&(u=o.m_context),!u)return!1;for(var a=-1,s=0;s<i.numberOfSources();s+=1)if(i.source(s).name()===t){a=s;break}return!(a<0||a>=r.length)&&(n||(n=i.source(s).dataToFloat32Array()),u.bindBuffer(e.GL.ARRAY_BUFFER,r[a]),n instanceof Float32Array?u.bufferSubData(e.GL.ARRAY_BUFFER,0,n):u.bufferSubData(e.GL.ARRAY_BUFFER,0,new Float32Array(n)),!0)},this.getSourceBuffer=function(t){var e=i.sourceByName(t);return e?e.dataToFloat32Array():new Float32Array},this.render=function(t,n){(this.getMTime()>s.getMTime()||t.m_contextChanged)&&h(t),(u=t.m_context).vertexAttrib3fv(e.vertexAttributeKeys.Color,this.color());var a,l,c=0,d=0,f=null;for(a in o)if(o.hasOwnProperty(a)){for(u.bindBuffer(e.GL.ARRAY_BUFFER,r[c]),d=0;d<o[a].length;d+=1)t.m_material.bindVertexData(t,o[a][d]);c+=1}for(l=i.numberOfPrimitives(),d=0;d<l;d+=1,c+=1)if((f=i.primitive(d)).numberOfIndices()){switch(u.bindBuffer(e.GL.ARRAY_BUFFER,r[c]),f.primitiveType()){case e.GL.POINTS:u.drawArrays(e.GL.POINTS,0,f.numberOfIndices());break;case e.GL.LINES:u.drawArrays(e.GL.LINES,0,f.numberOfIndices());break;case e.GL.LINE_STRIP:u.drawArrays(e.GL.LINE_STRIP,0,f.numberOfIndices());break;case e.GL.TRIANGLES:u.drawArrays(e.GL.TRIANGLES,0,f.numberOfIndices());break;case e.GL.TRIANGLE_STRIP:u.drawArrays(e.GL.TRIANGLE_STRIP,0,f.numberOfIndices())}u.bindBuffer(e.GL.ARRAY_BUFFER,null)}n||this.undoBindVertexData(t)},this.undoBindVertexData=function(t){var e,n;for(e in o)if(o.hasOwnProperty(e))for(n=0;n<o[e].length;n+=1)t.m_material.undoBindVertexData(t,o[e][n])},this},inherit(e.mapper,e.boundingObject),e.groupMapper=function(){"use strict";if(!(this instanceof e.groupMapper))return new e.groupMapper;e.mapper.call(this);var t=e.timestamp(),n=[],i=[];return this.geometryData=function(t){return void 0!==t&&t<i.length?i[t]:i.length>0?i[0]:null},this.setGeometryData=function(t){1===i.length&&i[0]===t||((i=[]).push(t),this.modified())},this.geometryDataArray=function(){return i},this.setGeometryDataArray=function(t){if(t instanceof Array){if(i!==t)return i=[],i=t,this.modified(),!0}else console.log("[error] Requies array of geometry data");return!1},this.computeBounds=function(){if(null!==i&&void 0!==i){var t=this.computeBoundsTimestamp(),e=this.boundsDirtyTimestamp(),n=this.bounds(),r=null,o=null;if(e.getMTime()>t.getMTime()){for(o=0;o<i.length;o+=1)r=i[o].bounds(),n[0]>r[0]&&(n[0]=r[0]),n[1]<r[1]&&(n[1]=r[1]),n[2]>r[2]&&(n[2]=r[2]),n[3]<r[3]&&(n[3]=r[3]),n[4]>r[4]&&(n[4]=r[4]),n[5]<r[5]&&(n[5]=r[5]);this.modified(),t.modified()}}else this.resetBounds()},this.render=function(r){var o=null;if(this.getMTime()>t.getMTime()){for(o=0;o<i.length;o+=1)n.push(e.mapper()),n[o].setGeometryData(i[o]);t.modified()}for(o=0;o<n.length;o+=1)n[o].render(r)},this},inherit(e.groupMapper,e.mapper),e.materialAttributeType={Undefined:0,ShaderProgram:1,Texture:2,Blend:3,Depth:4},e.materialAttribute=function(t){"use strict";if(!(this instanceof e.materialAttribute))return new e.materialAttribute(t);e.graphicsObject.call(this);var n=t;return this.type=function(){return n},this.enabled=function(){return!0},this.bindVertexData=function(t,e){return t=t,e=e,!1},this.undoBindVertexData=function(t,e){return t=t,e=e,!1},this},inherit(e.materialAttribute,e.graphicsObject),e.blendFunction=function(t,n){"use strict";if(!(this instanceof e.blendFunction))return new e.blendFunction(t,n);var i=t,r=n;return this.apply=function(t){t.m_context.blendFuncSeparate(i,r,e.GL.ONE,e.GL.ONE_MINUS_SRC_ALPHA)},this},e.blend=function(){"use strict";if(!(this instanceof e.blend))return new e.blend;e.materialAttribute.call(this,e.materialAttributeType.Blend);var t=!1,n=e.blendFunction(e.GL.SRC_ALPHA,e.GL.ONE_MINUS_SRC_ALPHA);return this.bind=function(i){return t=i.m_context.isEnabled(e.GL.BLEND),this.enabled()?(i.m_context.enable(e.GL.BLEND),n.apply(i)):i.m_context.disable(e.GL.BLEND),!0},this.undoBind=function(n){return t?n.m_context.enable(e.GL.BLEND):n.m_context.disable(e.GL.BLEND),!0},this},inherit(e.blend,e.materialAttribute),e.material=function(){"use strict";if(!(this instanceof e.material))return new e.material;e.graphicsObject.call(this);var t=this,n=new e.shaderProgram,i=100,r={},o={};return this.binNumber=function(){return i},this.setBinNumber=function(e){i=e,t.modified()},this.exists=function(t){return t.type()===e.materialAttributeType.Texture?r.hasOwnProperty(t.textureUnit()):o.hasOwnProperty(t.type())},this.uniform=function(t){return n?n.uniform(t):null},this.attribute=function(t,n){return o.hasOwnProperty(t)?o[t]:t===e.materialAttributeType.Texture&&r.hasOwnProperty(n)?r[n]:null},this.setAttribute=function(i){return i.type()===e.materialAttributeType.Texture?r[i.textureUnit()]!==i&&(r[i.textureUnit()]=i,t.modified(),!0):o[i.type()]!==i&&(i.type()===e.materialAttributeType.ShaderProgram&&(n=i),o[i.type()]=i,t.modified(),!0)},this.addAttribute=function(i){return!t.exists(i)&&(i.type()===e.materialAttributeType.Texture?(r[i.textureUnit()]=i,t.modified(),!0):(i.type()===e.materialAttributeType.ShaderProgram&&(n=i),o[i.type()]=i,t.modified(),!0))},this.shaderProgram=function(){return n},this._setup=function(t){return!1},this._cleanup=function(e){for(var i in o)o.hasOwnProperty(i)&&o[i]._cleanup(e);for(i in r)r.hasOwnProperty(i)&&r[i]._cleanup(e);n._cleanup(e),t.modified()},this.bind=function(t){var e=null;for(e in n.bind(t),o)o.hasOwnProperty(e)&&o[e]!==n&&o[e].bind(t);for(e in r)r.hasOwnProperty(e)&&r[e].bind(t)},this.undoBind=function(t){var e=null;for(e in o)o.hasOwnProperty(e)&&o[e].undoBind(t);for(e in r)r.hasOwnProperty(e)&&r[e].undoBind(t)},this.bindVertexData=function(t,e){var n=null;for(n in o)o.hasOwnProperty(n)&&o[n].bindVertexData(t,e)},this.undoBindVertexData=function(t,e){var n=null;for(n in o)o.hasOwnProperty(n)&&o[n].undoBindVertexData(t,e)},t},e.material.RenderBin={Base:0,Default:100,Opaque:100,Transparent:1e3,Overlay:1e4},inherit(e.material,e.graphicsObject),e.renderState=function(){"use strict";this.m_context=null,this.m_modelViewMatrix=a.create(),this.m_normalMatrix=a.create(),this.m_projectionMatrix=null,this.m_material=null,this.m_mapper=null},e.renderer=function(t){"use strict";if(!(this instanceof e.renderer))return new e.renderer(t);e.graphicsObject.call(this),t=t||{};var n=this;return n.m_renderWindow=null,n.m_contextChanged=!1,n.m_sceneRoot=new e.groupNode,n.m_camera=new e.camera(t),n.m_nearClippingPlaneTolerance=null,n.m_x=0,n.m_y=0,n.m_width=0,n.m_height=0,n.m_resizable=!0,n.m_resetScene=!0,n.m_layer=0,n.m_renderPasses=null,n.m_resetClippingRange=!0,n.m_depthBits=null,n.m_camera.addChild(n.m_sceneRoot),this.width=function(){return n.m_width},this.height=function(){return n.m_height},this.layer=function(){return n.m_layer},this.setLayer=function(t){n.m_layer=t,n.modified()},this.isResizable=function(){return n.m_resizable},this.setResizable=function(t){n.m_resizable=t},this.renderWindow=function(){return n.m_renderWindow},this.setRenderWindow=function(t){n.m_renderWindow!==t&&(n.m_renderWindow&&n.m_renderWindow.removeRenderer(this),n.m_renderWindow=t,n.m_contextChanged=!0,n.modified())},this.backgroundColor=function(){return n.m_camera.clearColor()},this.setBackgroundColor=function(t,e,i,r){n.m_camera.setClearColor(t,e,i,r),n.modified()},this.sceneRoot=function(){return n.m_sceneRoot},this.camera=function(){return n.m_camera},this.render=function(){var t,i,r,o=null,s=[],u=a.create(),l=null;if((i=new e.renderState).m_renderer=n,i.m_context=n.renderWindow().context(),n.m_depthBits&&!n.m_contextChanged||(n.m_depthBits=i.m_context.getParameter(e.GL.DEPTH_BITS)),i.m_contextChanged=n.m_contextChanged,n.m_renderPasses)for(t=0;t<n.m_renderPasses.length;t+=1){if(n.m_renderPasses[t].render(i))return console.log("returning"),void n.m_renderPasses[t].remove(i);n.m_renderPasses[t].remove(i)}for(i.m_context.enable(e.GL.DEPTH_TEST),i.m_context.depthFunc(e.GL.LEQUAL),n.m_camera.clearMask()&e.GL.COLOR_BUFFER_BIT&&(l=n.m_camera.clearColor(),i.m_context.clearColor(l[0],l[1],l[2],l[3])),n.m_camera.clearMask()&e.GL.DEPTH_BUFFER_BIT&&i.m_context.clearDepth(n.m_camera.clearDepth()),i.m_context.clear(n.m_camera.clearMask()),i.m_context.viewport(n.m_x,n.m_y,n.m_width,n.m_height),(r=n.m_sceneRoot.children()).length>0&&n.m_resetScene&&(n.resetCamera(),n.m_resetScene=!1),t=0;t<r.length;t+=1)(o=r[t]).computeBounds(),o.visible()&&o.material().binNumber()>=0&&s.push([o.material().binNumber(),o]);for(s.sort(function(t,e){return t[0]-e[0]}),t=0;t<s.length;t+=1){if((o=s[t][1]).referenceFrame()===e.boundingObject.ReferenceFrame.Relative){var c=n.m_camera.viewMatrix();c instanceof Array&&(i.m_modelViewMatrix=new Array(16)),a.multiply(i.m_modelViewMatrix,c,o.matrix()),i.m_projectionMatrix=n.m_camera.projectionMatrix(),i.m_modelViewAlignment=n.m_camera.viewAlignment()}else i.m_modelViewMatrix=o.matrix(),i.m_modelViewAlignment=null,i.m_projectionMatrix=a.create(),a.ortho(i.m_projectionMatrix,0,n.m_width,0,n.m_height,-1,1);a.invert(u,i.m_modelViewMatrix),a.transpose(i.m_normalMatrix,u),i.m_material=o.material(),i.m_mapper=o.mapper(),i.m_material.bind(i),i.m_mapper.render(i),i.m_material.undoBind(i)}i.m_context.finish(),n.m_contextChanged=!1,n.m_lastRenderState=i},this.resetCamera=function(){n.m_camera.computeBounds();var t,e,i=n.m_camera.directionOfProjection(),r=n.m_camera.bounds(),o=[(r[0]+r[1])/2,(r[2]+r[3])/2,(r[4]+r[5])/2],a=[r[1]-r[0],r[3]-r[2],r[5]-r[4]],s=0,l=n.m_camera.viewAspect(),c=n.m_camera.viewAngle();s=a[0]>a[1]?a[0]>a[2]?a[0]/2:a[2]/2:a[1]>a[2]?a[1]/2:a[2]/2,c=l>=1?2*Math.atan(Math.tan(.5*c)/l):2*Math.atan(Math.tan(.5*c)*l),t=s/Math.sin(.5*c),e=n.m_camera.viewUpDirection(),Math.abs(u.dot(e,i))>.999&&n.m_camera.setViewUpDirection(-e[2],e[0],e[1]),n.m_camera.setFocalPoint(o[0],o[1],o[2]),n.m_camera.setPosition(o[0]+t*-i[0],o[1]+t*-i[1],o[2]+t*-i[2]),n.resetCameraClippingRange(r)},this.hasValidBounds=function(t){return t[0]!==Number.MAX_VALUE&&t[1]!==-Number.MAX_VALUE&&t[2]!==Number.MAX_VALUE&&t[3]!==-Number.MAX_VALUE&&t[4]!==Number.MAX_VALUE&&t[5]!==-Number.MAX_VALUE},this.resetCameraClippingRange=function(t){if(void 0===t&&(n.m_camera.computeBounds(),t=n.m_camera.bounds()),n.hasValidBounds(t)){var e=n.m_camera.viewPlaneNormal(),i=n.m_camera.position(),r=-e[0],o=-e[1],a=-e[2],s=-(r*i[0]+o*i[1]+a*i[2]),u=vec2.create(),l=null,c=null,h=null,d=null;if(n.m_resetClippingRange){for(u[0]=r*t[0]+o*t[2]+a*t[4]+s,u[1]=1e-18,d=0;d<2;d+=1)for(h=0;h<2;h+=1)for(c=0;c<2;c+=1)l=r*t[c]+o*t[2+h]+a*t[4+d]+s,u[0]=l<u[0]?l:u[0],u[1]=l>u[1]?l:u[1];u[0]<0&&(u[0]=0),u[0]=.99*u[0]-.5*(u[1]-u[0]),u[1]=1.01*u[1]+.5*(u[1]-u[0]),u[0]=u[0]>=u[1]?.01*u[1]:u[0],n.m_nearClippingPlaneTolerance||(n.m_nearClippingPlaneTolerance=.01,n.m_depthBits&&n.m_depthBits>16&&(n.m_nearClippingPlaneTolerance=.001)),u[0]<n.m_nearClippingPlaneTolerance*u[1]&&(u[0]=n.m_nearClippingPlaneTolerance*u[1]),n.m_camera.setClippingRange(u[0],u[1])}}},this.resize=function(t,e){t&&e&&n.positionAndResize(n.m_x,n.m_y,t,e)},this.positionAndResize=function(t,e,i,r){var o;if(t<0||e<0||i<=0||r<=0)console.log("[error] Invalid position and resize values",t,e,i,r);else if(n.m_resizable&&(n.m_width=i,n.m_height=r,n.m_camera.setViewAspect(i/r),n.m_camera.setParallelExtents({width:i,height:r}),n.modified()),n.m_renderPasses)for(o=0;o<n.m_renderPasses.length;o+=1)n.m_renderPasses[o].resize(i,r),n.m_renderPasses[o].renderer().positionAndResize(t,e,i,r)},this.addActor=function(t){return t instanceof e.actor&&(n.m_sceneRoot.addChild(t),n.modified(),!0)},this.hasActor=function(t){return n.m_sceneRoot.hasChild(t)},this.addActors=function(t){var e=null;if(t instanceof Array){for(e=0;e<t.length;e+=1)n.m_sceneRoot.addChild(t[e]);n.modified()}},this.removeActor=function(t){return-1!==n.m_sceneRoot.children().indexOf(t)&&(n.m_lastRenderState&&(t.mapper()&&t.mapper()._cleanup(n.m_lastRenderState),t.material()&&t.material()._cleanup(n.m_lastRenderState)),t.modified(),n.m_sceneRoot.removeChild(t),n.modified(),!0)},this.removeActors=function(t){if(!(t instanceof Array))return!1;var e;for(e=0;e<t.length;e+=1)n.m_sceneRoot.removeChild(t[e]);return n.modified(),!0},this.removeAllActors=function(){return n.m_sceneRoot.removeChildren()},this.worldToDisplay=function(t,e,n,i,r){var o,u,l,c,h=a.create(),d=null;return a.multiply(h,n,e),d=s.create(),s.transformMat4(d,t,h),0!==d[3]&&(d[0]=d[0]/d[3],d[1]=d[1]/d[3],d[2]=d[2]/d[3],d[3]=1),o=(d[0]+1)/2*i,u=(1-d[1])/2*r,l=d[2],c=d[3],s.fromValues(o,u,l,c)},this.displayToWorld=function(t,e,n,i,r){var o=2*t[0]/i-1,u=-2*t[1]/r+1,l=t[2],c=a.create(),h=null;return a.multiply(c,n,e),a.invert(c,c),h=s.fromValues(o,u,l,1),s.transformMat4(h,h,c),0!==h[3]&&(h[0]=h[0]/h[3],h[1]=h[1]/h[3],h[2]=h[2]/h[3],h[3]=1),h},this.focusDisplayPoint=function(){var t=n.m_camera.focalPoint(),e=s.fromValues(t[0],t[1],t[2],1);return n.worldToDisplay(e,n.m_camera.viewMatrix(),n.m_camera.projectionMatrix(),n.m_width,n.m_height)},this.resetScene=function(){return n.m_resetScene},this.setResetScene=function(t){n.m_resetScene!==t&&(n.m_resetScene=t,n.modified())},this.resetClippingRange=function(){return n.m_resetClippingRange},this.setResetClippingRange=function(t){n.m_resetClippingRange!==t&&(n.m_resetClippingRange=t,n.modified())},this.addRenderPass=function(t){var e;if(n.m_renderPasses)for(e=0;e<n.m_renderPasses.length;e+=1)if(t===n.m_renderPasses[e])return;n.m_renderPasses=[],n.m_renderPasses.push(t)},this.removeRenderPass=function(t){t=t},this._cleanup=function(t){for(var e=n.m_sceneRoot.children(),i=0;i<e.length;i+=1){var r=e[i];r.material()._cleanup(t),r.mapper()._cleanup(t)}n.m_sceneRoot.removeChildren(),n.modified()},n},inherit(e.renderer,e.graphicsObject),e.renderWindow=function(t){"use strict";if(!(this instanceof e.renderWindow))return new e.renderWindow(t);e.graphicsObject.call(this);var n=this,i=0,r=0,o=400,a=400,u=t,l=null,c=[],h=null;return this.windowSize=function(){return[o,a]},this.setWindowSize=function(t,e){return(o!==t||a!==e)&&(o=t,a=e,n.modified(),!0)},this.windowPosition=function(){return[i,r]},this.setWindowPosition=function(t,e){return(i!==t||r!==e)&&(i=t,r=e,n.modified(),!0)},this.renderers=function(){return c},this.activeRenderer=function(){return l},this.addRenderer=function(t){return!1===n.hasRenderer(t)&&(c.push(t),t.setRenderWindow(n),null===l&&(l=t),0!==t.layer()&&t.camera().setClearMask(e.GL.DepthBufferBit),n.modified(),!0)},this.removeRenderer=function(t){var e=c.indexOf(t);return-1!==e&&(l===t&&(l=null),c.splice(e,1),n.modified(),!0)},this.getRenderer=function(t){return t<c.length?c[t]:(console.log("[WARNING] Out of index array"),null)},this.hasRenderer=function(t){var e;for(e=0;e<c.length;e+=1)if(t===c[e])return!0;return!1},this.resize=function(t,e){n.positionAndResize(i,r,t,e),n.modified()},this.positionAndResize=function(t,e,s,u){var l;for(i=t,r=e,o=s,a=u,l=0;l<c.length;l+=1)c[l].positionAndResize(i,r,o,a);n.modified()},this._setup=function(t){t=t,h=null;try{var e;for(h=u.getContext("webgl")||u.getContext("experimental-webgl"),e=0;e<c.length;e+=1)(c[e].width()>o||0===c[e].width()||c[e].height()>a||0===c[e].height())&&c[e].resize(i,r,o,a);return!0}catch(t){}return h||console("[ERROR] Unable to initialize WebGL. Your browser may not support it."),!1},this.context=function(){return h},this._cleanup=function(t){var i;for(i=0;i<c.length;i+=1)c[i]._cleanup(t);e.clearCachedShaders(t?t.m_context:null),n.modified()},this.render=function(){var t;for(c.sort(function(t,e){return t.layer()-e.layer()}),t=0;t<c.length;t+=1)c[t].render()},this.focusDisplayPoint=function(){return l.focusDisplayPoint()},this.displayToWorld=function(t,e,n,i){var r=(i=void 0===i?i=l:i).camera();return n||(n=i.focusDisplayPoint()),i.displayToWorld(s.fromValues(t,e,n[2],1),r.viewMatrix(),r.projectionMatrix(),o,a)},this.worldToDisplay=function(t,e,n,i){var r=(i=void 0===i?i=l:i).camera();return i.worldToDisplay(s.fromValues(t,e,n,1),r.viewMatrix(),r.projectionMatrix(),o,a)},n},inherit(e.renderWindow,e.graphicsObject),e.camera=function(t){"use strict";if(!(this instanceof e.camera))return new e.camera(t);e.groupNode.call(this),t=t||{};var n=30*Math.PI/180,i=s.fromValues(0,0,1,1),r=s.fromValues(0,0,0,1),o=u.fromValues(0,0,0),l=s.fromValues(0,1,0,0),c=s.fromValues(1,0,0,0),h=.01,d=1e4,f=1,p=s.fromValues(0,0,-1,0),m=s.fromValues(0,0,1,0),g=a.create(),v=a.create(),y=e.timestamp(),x=e.timestamp(),b=-1,_=1,w=1,M=-1,A={zoom:1,tilesize:256},T=!0,C=!0,E=!0,O=!1,S=[0,0,0,0],P=1,k=e.GL.COLOR_BUFFER_BIT|e.GL.DEPTH_BUFFER_BIT;return void 0!==t.parallelProjection&&(O=!!t.parallelProjection),this.viewAngle=function(){return n},this.setViewAngleDegrees=function(t){this.setViewAngle(Math.PI*t/180)},this.setViewAngle=function(t){E&&(n=t,this.modified())},this.position=function(){return i},this.setPosition=function(t,e,n){T&&(i=s.fromValues(t,e,n,1),this.modified())},this.focalPoint=function(){return r},this.setFocalPoint=function(t,e,n){C&&T&&(r=s.fromValues(t,e,n,1),this.modified())},this.viewUpDirection=function(){return l},this.setViewUpDirection=function(t,e,n){l=s.fromValues(t,e,n,0),this.modified()},this.centerOfRotation=function(){return o},this.setCenterOfRotation=function(t){o=t,this.modified()},this.clippingRange=function(){return[h,d]},this.setClippingRange=function(t,e){h=t,d=e,this.modified()},this.viewAspect=function(){return f},this.setViewAspect=function(t){f=t,this.modified()},this.enableScale=function(){return E},this.setEnableScale=function(t){return t!==E?(E=t,this.modified(),!0):E},this.enableRotation=function(){return C},this.setEnableRotation=function(t){return t!==C?(C=t,this.modified(),!0):C},this.enableTranslation=function(){return T},this.setEnableTranslation=function(t){return t!==T?(T=t,this.modified(),!0):T},this.isEnabledParallelProjection=function(){return O},this.enableParallelProjection=function(t){return t!==O?(O=t,this.modified(),!0):O},this.setEnableParallelProjection=function(t){return this.enableParallelProjection(t)},this.parallelProjection=function(){return{left:b,right:_,top:w,bottom:M}},this.setParallelProjection=function(t,e,n,i){b=t,_=e,w=n,M=i,this.modified()},this.parallelExtents=function(){return A},this.setParallelExtents=function(t){var e,n,i=["width","height","zoom","tilesize"],r=!1;for(e=0;e<i.length;e+=1)void 0!==t[n=i[e]]&&t[n]!==A[n]&&(A[n]=t[n],r=!0);if(r&&A.width&&A.height&&void 0!==A.zoom&&A.tilesize){var o=this.unitsPerPixel(A.zoom,A.tilesize);_=o*A.width/2,b=-_,w=o*A.height/2,M=-w,this.modified()}},this.unitsPerPixel=function(t,e){return e=e||256,360*Math.pow(2,-t)/e},this.directionOfProjection=function(){return this.computeDirectionOfProjection(),p},this.viewPlaneNormal=function(){return this.computeViewPlaneNormal(),m},this.viewMatrix=function(){return this.computeViewMatrix()},this.setViewMatrix=function(t,e){e?g=t.slice():a.copy(g,t),y.modified()},this.projectionMatrix=function(){return this.computeProjectionMatrix()},this.setProjectionMatrix=function(t){a.copy(v,t),x.modified()},this.clearMask=function(){return k},this.setClearMask=function(t){k=t,this.modified()},this.clearColor=function(){return S},this.setClearColor=function(t,e,n,i){S[0]=t,S[1]=e,S[2]=n,S[3]=i,this.modified()},this.clearDepth=function(){return P},this.setClearDepth=function(t){P=t,this.modified()},this.computeDirectionOfProjection=function(){u.subtract(p,r,i),u.normalize(p,p),this.modified()},this.computeViewPlaneNormal=function(){m[0]=-p[0],m[1]=-p[1],m[2]=-p[2]},this.zoom=function(t,e){0!==t&&T&&(t*=u.distance(r,i),e?(i[0]=i[0]+t*e[0],i[1]=i[1]+t*e[1],i[2]=i[2]+t*e[2]):(e=p,i[0]=r[0]-t*e[0],i[1]=r[1]-t*e[1],i[2]=r[2]-t*e[2]),this.modified())},this.pan=function(t,e,n){T&&(i[0]+=t,i[1]+=e,i[2]+=n,r[0]+=t,r[1]+=e,r[2]+=n,this.modified())},this.computeOrthogonalAxes=function(){this.computeDirectionOfProjection(),u.cross(c,p,l),u.normalize(c,c),this.modified()},this.rotate=function(t,e){if(C){t=.5*t*(Math.PI/180),e=.5*e*(Math.PI/180);var n=a.create(),h=new u.create;a.identity(n),h[0]=-o[0],h[1]=-o[1],h[2]=-o[2],a.translate(n,n,o),a.rotate(n,n,t,l),a.rotate(n,n,e,c),a.translate(n,n,h),s.transformMat4(i,i,n),s.transformMat4(r,r,n),s.transformMat4(l,l,n),s.normalize(l,l),this.computeOrthogonalAxes(),this.modified()}},this.computeViewMatrix=function(){return y.getMTime()<this.getMTime()&&(a.lookAt(g,i,r,l),y.modified()),g},this.viewAlignment=function(){if(!O){var t=this.projectionMatrix();if(t[1]||t[2]||t[3]||t[4]||t[6]||t[7]||t[8]||t[9]||t[12]||t[13]||t[15])return null}var e=this.unitsPerPixel(A.zoom,A.tilesize);if(!A.width||!A.height||!e)return null;if(parseFloat(A.zoom.toFixed(6))!==parseFloat(A.zoom.toFixed(0)))return null;var n={roundx:e,roundy:e,dx:0,dy:0};return A.width%2&&(n.dx=.5*e),A.height%2&&(n.dy=.5*e),n},this.computeProjectionMatrix=function(){return x.getMTime()<this.getMTime()&&(O?a.ortho(v,b,_,M,w,h,d):a.perspective(v,n,f,h,d),x.modified()),v},this.zoomToHeight=function(t,i,r){return e.zoomToHeight(t,i,r,n)},this.computeDirectionOfProjection(),this},inherit(e.camera,e.groupNode),e.zoomToHeight=function(t,e,n,i){"use strict";i=i||30*Math.PI/180;var r=360*Math.pow(2,-t);return r/=2*Math.tan(i/2)*256/n},e.heightToZoom=function(t,e,n,i){"use strict";return i=i||30*Math.PI/180,t*=2*Math.tan(i/2)*256/n,-Math.log2(t/360)},e.interactorStyle=function(){"use strict";if(!(this instanceof e.interactorStyle))return new e.interactorStyle;e.object.call(this);var t=this,n=null;return this.viewer=function(){return n},this.setViewer=function(i){i!==n&&(l(n=i).on(e.event.mousePress,t.handleMouseDown),l(n).on(e.event.mouseRelease,t.handleMouseUp),l(n).on(e.event.mouseMove,t.handleMouseMove),l(n).on(e.event.mouseOut,t.handleMouseOut),l(n).on(e.event.mouseWheel,t.handleMouseWheel),l(n).on(e.event.keyPress,t.handleKeyPress),l(n).on(e.event.mouseContextMenu,t.handleContextMenu),l(n).on(e.event.click,t.handleClick),l(n).on(e.event.dblClick,t.handleDoubleClick),this.modified())},this.handleMouseDown=function(t){return t=t,!0},this.handleMouseUp=function(t){return t=t,!0},this.handleMouseMove=function(t){return t=t,!0},this.handleMouseOut=function(t){return t=t,!0},this.handleMouseWheel=function(t){return t=t,!0},this.handleClick=function(t){return t=t,!0},this.handleDoubleClick=function(t){return t=t,!0},this.handleKeyPress=function(t){return t=t,!0},this.handleContextMenu=function(t){return t=t,!0},this.reset=function(){return!0},this},inherit(e.interactorStyle,e.object),e.trackballInteractorStyle=function(){"use strict";if(!(this instanceof e.trackballInteractorStyle))return new e.trackballInteractorStyle;e.interactorStyle.call(this);var t,n=this,i=!1,r=!1,o=!1,a={x:0,y:0},u={x:0,y:0};return this.handleMouseMove=function(e){var l,c,h,d,f,p,m,g,v,y,x,b=n.viewer().renderWindow().windowSize()[0],_=n.viewer().renderWindow().windowSize()[1],w=n.viewer().renderWindow().activeRenderer(),M=w.camera(),A=n.viewer().relMouseCoords(e);if(t=!1,a={x:0,y:0},A.x<0||A.x>b?(a.x=0,t=!0):a.x=A.x,A.y<0||A.y>_?(a.y=0,t=!0):a.y=A.y,!0!==t)return l=M.focalPoint(),h=s.fromValues(l[0],l[1],l[2],1),c=w.worldToDisplay(h,M.viewMatrix(),M.projectionMatrix(),b,_),d=s.fromValues(a.x,a.y,c[2],1),f=s.fromValues(u.x,u.y,c[2],1),p=w.displayToWorld(d,M.viewMatrix(),M.projectionMatrix(),b,_),m=w.displayToWorld(f,M.viewMatrix(),M.projectionMatrix(),b,_),g=p[0]-m[0],v=p[1]-m[1],y=p[2]-m[2],o&&(M.pan(-g,-v,-y),n.viewer().render()),i&&(M.rotate(u.x-a.x,u.y-a.y),w.resetCameraClippingRange(),n.viewer().render()),r&&((x=2*(a.y-u.y)/_)>0?M.zoom(1-Math.abs(x)):M.zoom(1+Math.abs(x)),w.resetCameraClippingRange(),n.viewer().render()),u.x=a.x,u.y=a.y,!1},this.handleMouseDown=function(t){var e;return 0===t.button&&(i=!0),1===t.button&&(o=!0),2===t.button&&(r=!0),(e=n.viewer().relMouseCoords(t)).x<0?u.x=0:u.x=e.x,e.y<0?u.y=0:u.y=e.y,!1},this.handleMouseUp=function(t){return 0===t.button&&(i=!1),1===t.button&&(o=!1),2===t.button&&(r=!1),!1},this.handleMouseWheel=function(t){var e=n.viewer().renderWindow().activeRenderer(),i=e.camera();return t.originalEvent.wheelDelta<0?i.zoom(.9):i.zoom(1.1),e.resetCameraClippingRange(),n.viewer().render(),!0},this},inherit(e.trackballInteractorStyle,e.interactorStyle),e.viewer=function(t,n){"use strict";if(!(this instanceof e.viewer))return new e.viewer(t,n);e.object.call(this);var i=this,r=t,o=null,a=e.renderer(n),s=e.renderWindow(r);return this.canvas=function(){return r},this.renderWindow=function(){return s},this.init=function(){null!==s?s._setup():console.log("[ERROR] No render window attached")},this.exit=function(t){null!==s?s._cleanup(t):console.log("[ERROR] No render window attached")},this.interactorStyle=function(){return o},this.setInteractorStyle=function(t){t!==o&&((o=t).setViewer(this),this.modified())},this.handleMouseDown=function(t){var n=l.event.fix(t||window.event);return 2===t.button&&n.preventDefault(),n.state="down",n.type=e.event.mousePress,l(i).trigger(n),!0},this.handleMouseUp=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.state="up",n.type=e.event.mouseRelease,l(i).trigger(n),!0},this.handleMouseMove=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.type=e.event.mouseMove,l(i).trigger(n),!0},this.handleMouseWheel=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.type=e.event.mouseWheel,l(i).trigger(n),!0},this.handleMouseOut=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.type=e.event.mouseOut,l(i).trigger(n),!0},this.handleKeyPress=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.type=e.event.keyPress,l(i).trigger(n),!0},this.handleContextMenu=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.type=e.event.contextMenu,l(i).trigger(n),!1},this.handleClick=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.type=e.event.click,l(i).trigger(n),!1},this.handleDoubleClick=function(t){var n=l.event.fix(t||window.event);return n.preventDefault(),n.type=e.event.dblClick,l(i).trigger(n),!1},this.relMouseCoords=function(t){if(void 0===t.pageX||void 0===t.pageY)throw"Missing attributes pageX and pageY on the event";var e=0,n=0,i=r;do{e+=i.offsetLeft-i.scrollLeft,n+=i.offsetTop-i.scrollTop,i=i.offsetParent}while(i);return{x:t.pageX-e,y:t.pageY-n}},this.render=function(){s.render()},this.bindEventHandlers=function(){l(r).on("mousedown",this.handleMouseDown),l(r).on("mouseup",this.handleMouseUp),l(r).on("mousemove",this.handleMouseMove),l(r).on("mousewheel",this.handleMouseWheel),l(r).on("contextmenu",this.handleContextMenu)},this.unbindEventHandlers=function(){l(r).off("mousedown",this.handleMouseDown),l(r).off("mouseup",this.handleMouseUp),l(r).off("mousemove",this.handleMouseMove),l(r).off("mousewheel",this.handleMouseWheel),l(r).off("contextmenu",this.handleContextMenu)},this._init=function(){this.bindEventHandlers(),s.addRenderer(a)},this._init(),this},inherit(e.viewer,e.object),e.shader=function(t){"use strict";if(!(this instanceof e.shader))return new e.shader(t);e.object.call(this);var n=[],i=t,r="";this._getContextEntry=function(t){var i,r,o=t.m_context;for(i=0;i<n.length;i+=1)if(n[i].context===o)return n[i];return r={context:o,compileTimestamp:e.timestamp()},n.push(r),r},this.removeContext=function(t){var e,i=t.m_context;for(e=0;e<n.length;e+=1)if(n[e].context===i)return void n.splice(e,1)},this.shaderHandle=function(t){return this._getContextEntry(t).shaderHandle},this.shaderType=function(){return i},this.shaderSource=function(){return r},this.setShaderSource=function(t){r=t,this.modified()},this.compile=function(t){var n=this._getContextEntry(t);return this.getMTime()<n.compileTimestamp.getMTime()?n.shaderHandle:(t.m_context.deleteShader(n.shaderHandle),n.shaderHandle=t.m_context.createShader(i),t.m_context.shaderSource(n.shaderHandle,r),t.m_context.compileShader(n.shaderHandle),t.m_context.getShaderParameter(n.shaderHandle,e.GL.COMPILE_STATUS)?(n.compileTimestamp.modified(),n.shaderHandle):(console.log("[ERROR] An error occurred compiling the shaders: "+t.m_context.getShaderInfoLog(n.shaderHandle)),console.log(r),t.m_context.deleteShader(n.shaderHandle),null))},this.attachShader=function(t,e){t.m_context.attachShader(e,this.shaderHandle(t))}},inherit(e.shader,e.object),function(){"use strict";var t=[];e.getCachedShader=function(n,i,r){for(var o=0;o<t.length;o+=1)if(t[o].type===n&&t[o].context===i&&t[o].source===r)return o&&t.splice(0,0,t.splice(o,1)[0]),t[0].shader;var a=new e.shader(n);return a.setShaderSource(r),t.unshift({type:n,context:i,source:r,shader:a}),t.length>=10&&t.splice(10,t.length-10),a},e.clearCachedShaders=function(e){for(var n=t.length-1;n>=0;n-=1)null!==e&&void 0!==e&&t[n].context!==e||t.splice(n,1)}}();var i=function(){"use strict";var t=".",e=document.getElementsByTagName("script");if(e.length>0){var n=e.length-1,i=e[n];n=i.src.lastIndexOf("/"),t=i.src.substring(0,n)}return function(){return t}}();return e.shaderProgram=function(){"use strict";if(!(this instanceof e.shaderProgram))return new e.shaderProgram;e.materialAttribute.call(this,e.materialAttributeType.ShaderProgram);var t=this,n=0,r=e.timestamp(),o=e.timestamp(),a=[],s=[],u={},c={},h={};return this.loadFromFile=function(n,i){var r,o=!1;return l.ajax({url:i,type:"GET",dataType:"text",async:!1,success:function(i){(r=e.shader(n)).setShaderSource(i),t.addShader(r),o=!0}}),o},this.loadShader=function(t,e){return this.loadFromFile(t,i()+"/shaders/"+e)},this.queryUniformLocation=function(t,e){return t.m_context.getUniformLocation(n,e)},this.queryAttributeLocation=function(t,e){return t.m_context.getAttribLocation(n,e)},this.addShader=function(e){if(a.indexOf(e)>-1)return!1;var n;for(n=a.length-2;n>=0;n-=1)a[n].shaderType()===e.shaderType()&&a.splice(n,1);return a.push(e),t.modified(),!0},this.addUniform=function(e){return!(s.indexOf(e)>-1)&&(s.push(e),t.modified(),!0)},this.addVertexAttribute=function(e,n){u[n]=e,t.modified()},this.uniformLocation=function(t){return c[t]},this.attributeLocation=function(t){return h[t]},this.uniform=function(t){var e;for(e=0;e<s.length;e+=1)if(s[e].name()===t)return s[e];return null},this.updateUniforms=function(t){var e;for(e=0;e<s.length;e+=1)s[e].callGL(t,c[s[e].name()])},this.link=function(t){return t.m_context.linkProgram(n),!!t.m_context.getProgramParameter(n,e.GL.LINK_STATUS)||(console.log("[ERROR] Unable to initialize the shader program."),!1)},this.use=function(t){t.m_context.useProgram(n)},this._setup=function(t){0===n&&(n=t.m_context.createProgram())},this._cleanup=function(e){t.deleteVertexAndFragment(e),t.deleteProgram(e),t.modified()},this.deleteProgram=function(t){n&&t.m_context.deleteProgram(n),n=0},this.deleteVertexAndFragment=function(t){var e;for(e=0;e<a.length;e+=1)a[e].shaderHandle(t)&&t.m_context.detachShader(n,a[e].shaderHandle(t)),t.m_context.deleteShader(a[e].shaderHandle(t)),a[e].removeContext(t)},this.compileAndLink=function(e){var i;if(!(r.getMTime()>=this.getMTime())){for(t._setup(e),i=0;i<a.length;i+=1)a[i].compile(e),a[i].attachShader(e,n);t.bindAttributes(e),t.link(e)||(console.log("[ERROR] Failed to link Program"),t._cleanup(e)),r.modified()}},this.bind=function(e){var n=0;for(o.getMTime()<t.getMTime()?(t.compileAndLink(e),t.use(e),t.bindUniforms(e),o.modified()):t.use(e),n=0;n<s.length;n+=1)s[n].update(e,t);t.updateUniforms(e)},this.undoBind=function(t){t.m_context.useProgram(null)},this.bindVertexData=function(t,e){u.hasOwnProperty(e)&&u[e].bindVertexData(t,e)},this.undoBindVertexData=function(t,e){u.hasOwnProperty(e)&&u[e].undoBindVertexData(t,e)},this.bindUniforms=function(t){var e;for(e=0;e<s.length;e+=1)c[s[e].name()]=this.queryUniformLocation(t,s[e].name())},this.bindAttributes=function(t){var e,i;for(e in u)u.hasOwnProperty(e)&&(i=u[e].name(),t.m_context.bindAttribLocation(n,e,i),h[i]=e)},t},inherit(e.shaderProgram,e.materialAttribute),e.texture=function(){"use strict";if(!(this instanceof e.texture))return new e.texture;e.materialAttribute.call(this,e.materialAttributeType.Texture),this.m_width=0,this.m_height=0,this.m_depth=0,this.m_textureHandle=null,this.m_textureUnit=0,this.m_pixelFormat=e.GL.RGBA,this.m_pixelDataType=e.GL.UNSIGNED_BYTE,this.m_internalFormat=e.GL.RGBA,this.m_nearestPixel=!1,this.m_image=null;var t=e.timestamp(),n=this;function i(t){switch(n.m_textureUnit){case 0:t.m_context.activeTexture(e.GL.TEXTURE0);break;case 1:t.m_context.activeTexture(e.GL.TEXTURE1);break;case 2:t.m_context.activeTexture(e.GL.TEXTURE2);break;case 3:t.m_context.activeTexture(e.GL.TEXTURE3);break;case 4:t.m_context.activeTexture(e.GL.TEXTURE4);break;case 5:t.m_context.activeTexture(e.GL.TEXTURE5);break;case 6:t.m_context.activeTexture(e.GL.TEXTURE6);break;case 7:t.m_context.activeTexture(e.GL.TEXTURE7);break;case 8:t.m_context.activeTexture(e.GL.TEXTURE8);break;case 9:t.m_context.activeTexture(e.GL.TEXTURE9);break;case 10:t.m_context.activeTexture(e.GL.TEXTURE10);break;case 11:t.m_context.activeTexture(e.GL.TEXTURE11);break;case 12:t.m_context.activeTexture(e.GL.TEXTURE12);break;case 13:t.m_context.activeTexture(e.GL.TEXTURE13);break;case 14:t.m_context.activeTexture(e.GL.TEXTURE14);break;case 15:t.m_context.activeTexture(e.GL.TEXTURE15);break;default:throw"[error] Texture unit "+n.m_textureUnit+" is not supported"}}return this.setup=function(n){i(n),n.m_context.deleteTexture(this.m_textureHandle),this.m_textureHandle=n.m_context.createTexture(),n.m_context.bindTexture(e.GL.TEXTURE_2D,this.m_textureHandle),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,this.m_nearestPixel?e.GL.NEAREST:e.GL.LINEAR),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MAG_FILTER,this.m_nearestPixel?e.GL.NEAREST:e.GL.LINEAR),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE),null!==this.m_image?(n.m_context.pixelStorei(e.GL.UNPACK_ALIGNMENT,1),n.m_context.pixelStorei(e.GL.UNPACK_FLIP_Y_WEBGL,!0),this.updateDimensions(),this.computeInternalFormatUsingImage(),n.m_context.texImage2D(e.GL.TEXTURE_2D,0,this.m_internalFormat,this.m_pixelFormat,this.m_pixelDataType,this.m_image)):n.m_context.texImage2D(e.GL.TEXTURE_2D,0,this.m_internalFormat,this.m_width,this.m_height,0,this.m_pixelFormat,this.m_pixelDataType,null),n.m_context.bindTexture(e.GL.TEXTURE_2D,null),t.modified()},this.bind=function(n){this.getMTime()>t.getMTime()&&this.setup(n),i(n),n.m_context.bindTexture(e.GL.TEXTURE_2D,this.m_textureHandle)},this.undoBind=function(t){t.m_context.bindTexture(e.GL.TEXTURE_2D,null)},this.image=function(){return this.m_image},this.setImage=function(t){return null!==t&&(this.m_image=t,this.updateDimensions(),this.modified(),!0)},this.nearestPixel=function(){return this.m_nearestPixel},this.setNearestPixel=function(t){return(t=!!t)!==this.m_nearestPixel&&(this.m_nearestPixel=t,this.modified(),!0)},this.textureUnit=function(){return this.m_textureUnit},this.setTextureUnit=function(t){return this.m_textureUnit!==t&&(this.m_textureUnit=t,this.modified(),!0)},this.width=function(){return this.m_width},this.setWidth=function(t){return n.m_width!==t&&(n.m_width=t,n.modified(),!0)},this.height=function(){return n.m_height},this.setHeight=function(t){return n.m_height!==t&&(n.m_height=t,n.modified(),!0)},this.depth=function(){return this.m_depth},this.setDepth=function(t){return null!==this.m_image&&(this.m_depth=t,this.modified(),!0)},this.textureHandle=function(){return this.m_textureHandle},this.internalFormat=function(){return this.m_internalFormat},this.setInternalFormat=function(t){return this.m_internalFormat!==t&&(this.m_internalFormat=t,this.modified(),!0)},this.pixelFormat=function(){return this.m_pixelFormat},this.setPixelFormat=function(t){return null!==this.m_image&&(this.m_pixelFormat=t,this.modified(),!0)},this.pixelDataType=function(){return this.m_pixelDataType},this.setPixelDataType=function(t){return null!==this.m_image&&(this.m_pixelDataType=t,this.modified(),!0)},this.computeInternalFormatUsingImage=function(){this.m_internalFormat=e.GL.RGBA,this.m_pixelFormat=e.GL.RGBA,this.m_pixelDataType=e.GL.UNSIGNED_BYTE},this.updateDimensions=function(){null!==this.m_image&&(this.m_width=this.m_image.width,this.m_height=this.m_image.height,this.m_depth=0)},this},inherit(e.texture,e.materialAttribute),e.lookupTable=function(){"use strict";if(!(this instanceof e.lookupTable))return new e.lookupTable;e.texture.call(this);var t=e.timestamp(),n=[0,0];return this.m_colorTable=[.07514311,.468049805,1,1,.247872569,.498782363,1,1,.339526309,.528909511,1,1,.409505078,.558608486,1,1,.468487184,.588057293,1,1,.520796675,.617435078,1,1,.568724526,.646924167,1,1,.613686735,.676713218,1,1,.656658579,.707001303,1,1,.698372844,.738002964,1,1,.739424025,.769954435,1,1,.780330104,.803121429,1,1,.821573924,.837809045,1,1,.863634967,.874374691,1,1,.907017747,.913245283,1,1,.936129275,.938743558,.983038586,1,.943467973,.943498599,.943398095,1,.990146732,.928791426,.917447482,1,1,.88332677,.861943246,1,1,.833985467,.803839606,1,1,.788626485,.750707739,1,1,.746206642,.701389973,1,1,.70590052,.654994046,1,1,.667019783,.610806959,1,1,.6289553,.568237474,1,1,.591130233,.526775617,1,1,.552955184,.485962266,1,1,.513776083,.445364274,1,1,.472800903,.404551679,1,1,.428977855,.363073592,1,1,.380759558,.320428137,1,.961891484,.313155629,.265499262,1,.916482116,.236630659,.209939162,1].map(function(t){return 255*t}),this.setup=function(n){0===this.textureUnit()?n.m_context.activeTexture(e.GL.TEXTURE0):1===this.textureUnit()&&n.m_context.activeTexture(e.GL.TEXTURE1),n.m_context.deleteTexture(this.m_textureHandle),this.m_textureHandle=n.m_context.createTexture(),n.m_context.bindTexture(e.GL.TEXTURE_2D,this.m_textureHandle),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MIN_FILTER,e.GL.LINEAR),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_MAG_FILTER,e.GL.LINEAR),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_S,e.GL.CLAMP_TO_EDGE),n.m_context.texParameteri(e.GL.TEXTURE_2D,e.GL.TEXTURE_WRAP_T,e.GL.CLAMP_TO_EDGE),n.m_context.pixelStorei(e.GL.UNPACK_ALIGNMENT,1),this.m_width=this.m_colorTable.length/4,this.m_height=1,this.m_depth=0,n.m_context.texImage2D(e.GL.TEXTURE_2D,0,e.GL.RGBA,this.m_width,this.m_height,this.m_depth,e.GL.RGBA,e.GL.UNSIGNED_BYTE,new Uint8Array(this.m_colorTable)),n.m_context.bindTexture(e.GL.TEXTURE_2D,null),t.modified()},this.colorTable=function(){return this.m_colorTable},this.setColorTable=function(t){return this.m_colorTable!==t&&(this.m_colorTable=t,this.modified(),!0)},this.range=function(){return n},this.setRange=function(t){return n!==t&&(n=t,this.modified(),!0)},this.updateRange=function(t){t instanceof Array||console.log("[error] Invalid data type for range. Requires array [min,max]"),t[0]<n[0]&&(n[0]=t[0],this.modified()),t[1]>n[1]&&(n[1]=t[1],this.modified())},this},inherit(e.lookupTable,e.texture),e.uniform=function(t,n){"use strict";if(!(this instanceof e.uniform))return new e.uniform(t,n);this.getTypeNumberOfComponents=function(t){switch(t){case e.GL.FLOAT:case e.GL.INT:case e.GL.BOOL:return 1;case e.GL.FLOAT_VEC2:case e.GL.INT_VEC2:case e.GL.BOOL_VEC2:return 2;case e.GL.FLOAT_VEC3:case e.GL.INT_VEC3:case e.GL.BOOL_VEC3:return 3;case e.GL.FLOAT_VEC4:case e.GL.INT_VEC4:case e.GL.BOOL_VEC4:return 4;case e.GL.FLOAT_MAT3:return 9;case e.GL.FLOAT_MAT4:return 16;default:return 0}};var i=t,r=n,o=[];return o.length=this.getTypeNumberOfComponents(i),this.name=function(){return r},this.type=function(){return i},this.get=function(){return o},this.set=function(t){var e=0,n=o.length;if(1!==n)for(e=0;e<n;e+=1)o[e]=t[e];else o[0]=t},this.callGL=function(t,n){switch(i){case e.GL.BOOL:case e.GL.INT:t.m_context.uniform1iv(n,o);break;case e.GL.FLOAT:t.m_context.uniform1fv(n,o);break;case e.GL.BOOL_VEC2:case e.GL.INT_VEC2:t.m_context.uniform2iv(n,o);break;case e.GL.FLOAT_VEC2:t.m_context.uniform2fv(n,o);break;case e.GL.BOOL_VEC3:case e.GL.INT_VEC3:t.m_context.uniform3iv(n,o);break;case e.GL.FLOAT_VEC3:t.m_context.uniform3fv(n,o);break;case e.GL.BOOL_VEC4:case e.GL.INT_VEC4:t.m_context.uniform4iv(n,o);break;case e.GL.FLOAT_VEC4:t.m_context.uniform4fv(n,o);break;case e.GL.FLOAT_MAT3:t.m_context.uniformMatrix3fv(n,e.GL.FALSE,o);break;case e.GL.FLOAT_MAT4:t.m_context.uniformMatrix4fv(n,e.GL.FALSE,o)}},this.update=function(t,e){},this},e.modelViewUniform=function(t){"use strict";return this instanceof e.modelViewUniform?(t||(t="modelViewMatrix"),e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(a.create()),this.update=function(t,e){this.set(t.m_modelViewMatrix)},this):new e.modelViewUniform(t)},inherit(e.modelViewUniform,e.uniform),e.modelViewOriginUniform=function(t,n){"use strict";if(!(this instanceof e.modelViewOriginUniform))return new e.modelViewOriginUniform(t,n);t||(t="modelViewMatrix");var i=[(n=n||[0,0,0])[0],n[1],n[2]||0];return e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(a.create()),this.setOrigin=function(t){i=[(t=t||[0,0,0])[0],t[1],t[2]||0]},this.update=function(t,e){var n=t.m_modelViewMatrix;if(t.m_modelViewAlignment){var r=t.m_modelViewAlignment;(n=n.slice?n.slice():Array.prototype.slice.call(n))[12]=Math.round(n[12]/r.roundx)*r.roundx+r.dx,n[13]=Math.round(n[13]/r.roundy)*r.roundy+r.dy}n=a.translate(a.create(),n,i),this.set(n)},this},inherit(e.modelViewOriginUniform,e.uniform),e.projectionUniform=function(t){"use strict";return this instanceof e.projectionUniform?(t||(t="projectionMatrix"),e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(a.create()),this.update=function(t,e){this.set(t.m_projectionMatrix)},this):new e.projectionUniform(t)},inherit(e.projectionUniform,e.uniform),e.floatUniform=function(t,n){"use strict";if(!(this instanceof e.floatUniform))return new e.floatUniform(t,n);t||(t="floatUniform"),n=void 0===n?1:n,e.uniform.call(this,e.GL.FLOAT,t),this.set(n)},inherit(e.floatUniform,e.uniform),e.normalMatrixUniform=function(t){"use strict";return this instanceof e.normalMatrixUniform?(t||(t="normalMatrix"),e.uniform.call(this,e.GL.FLOAT_MAT4,t),this.set(a.create()),this.update=function(t,e){this.set(t.m_normalMatrix)},this):new e.normalMatrixUniform(t)},inherit(e.normalMatrixUniform,e.uniform),e.vertexAttributeKeys={Position:0,Normal:1,TextureCoordinate:2,Color:3,Scalar:4,CountAttributeIndex:5},e.vertexAttributeKeysIndexed={Zero:0,One:1,Two:2,Three:3,Four:4,Five:5,Six:6,Seven:7,Eight:8,Nine:9},e.vertexAttribute=function(t){"use strict";if(!(this instanceof e.vertexAttribute))return new e.vertexAttribute(t);var n=t;this.name=function(){return n},this.bindVertexData=function(t,e){var i=t.m_mapper.geometryData().sourceData(e),r=t.m_material.shaderProgram();t.m_context.vertexAttribPointer(r.attributeLocation(n),i.attributeNumberOfComponents(e),i.attributeDataType(e),i.normalized(e),i.attributeStride(e),i.attributeOffset(e)),t.m_context.enableVertexAttribArray(r.attributeLocation(n))},this.undoBindVertexData=function(t,e){e=e;var i=t.m_material.shaderProgram();t.m_context.disableVertexAttribArray(i.attributeLocation(n))}},e.source=function(){"use strict";return this instanceof e.source?(e.object.call(this),this.create=function(){},this):new e.source},inherit(e.source,e.object),e.planeSource=function(){"use strict";if(!(this instanceof e.planeSource))return new e.planeSource;e.source.call(this);var t=[0,0,0],n=[1,0,0],i=[0,1,0],r=[0,0,1],o=null;this.setOrigin=function(e,n,i){t[0]=e,t[1]=n,t[2]=i},this.setPoint1=function(t,e,i){n[0]=t,n[1]=e,n[2]=i},this.setPoint2=function(t,e,n){i[0]=t,i[1]=e,i[2]=n},this.create=function(){o=new e.geometryData;var a,s,u,l,c=[],h=[],d=[],f=[],p=[],m=0,g=0,v=0,y=0,x=[],b=[],_=[],w=[],M=[],A=null,T=null,C=null;for(c.length=3,h.length=2,d.length=3,f.length=3,p.length=3,a=0;a<3;a+=1)d[a]=n[a]-t[a],f[a]=i[a]-t[a];for(4,x.length=12,b.length=12,w.length=8,M.length=4,a=0;a<2;a+=1)for(h[1]=a/1,s=0;s<2;s+=1){for(h[0]=s/1,u=0;u<3;u+=1)c[u]=t[u]+h[0]*d[u]+h[1]*f[u];x[m++]=c[0],x[m++]=c[1],x[m++]=c[2],_[v++]=1,_[v++]=1,_[v++]=1,b[g++]=r[0],b[g++]=r[1],b[g++]=r[2],w[y++]=h[0],w[y++]=h[1]}for(a=0;a<1;a+=1)for(s=0;s<1;s+=1)p[0]=s+2*a,p[1]=p[0]+1,p[2]=p[0]+1+2,p[3]=p[0]+1+1;for(a=0;a<4;a+=1)M[a]=a;return(A=new e.triangleStrip).setIndices(M),(T=e.sourceDataP3fv()).pushBack(x),(C=e.sourceDataC3fv()).pushBack(_),(l=e.sourceDataT2fv()).pushBack(w),o.addSource(T),o.addSource(C),o.addSource(l),o.addPrimitive(A),o}},inherit(e.planeSource,e.source),e.pointSource=function(){"use strict";if(!(this instanceof e.pointSource))return new e.pointSource;e.source.call(this);var t=this,n=[],i=[],r=[],o=[],a=null;this.getPositions=function(){return n},this.setPositions=function(e){e instanceof Array?n=e:console.log("[ERROR] Invalid data type for positions. Array is required."),t.modified()},this.getColors=function(){return i},this.setColors=function(e){e instanceof Array?i=e:console.log("[ERROR] Invalid data type for colors. Array is required."),t.modified()},this.getSize=function(){return o},this.setSize=function(t){o=t,this.modified()},this.setTextureCoordinates=function(e){e instanceof Array?r=e:console.log("[ERROR] Invalid data type for texture coordinates. Array is required."),t.modified()},this.create=function(){if(a=new e.geometryData,n.length%3==0){var t,s,u,l,c,h=n.length/3,d=0,f=[];for(f.length=h,d=0;d<h;d+=1)f[d]=d;if(c=e.sourceDataDf(),h!==o.length)for(d=0;d<h;d+=1)c.pushBack(o);else c.setData(o);return a.addSource(c),(t=new e.points).setIndices(f),(s=e.sourceDataP3fv()).pushBack(n),a.addSource(s),i.length>0&&i.length===n.length?((u=e.sourceDataC3fv()).pushBack(i),a.addSource(u)):i.length>0&&i.length!==n.length&&console.log("[ERROR] Number of colors are different than number of points"),r.length>0&&r.length===n.length?((l=e.sourceDataT2fv()).pushBack(r),a.addSource(l)):r.length>0&&r.length/2!=n.length/3&&console.log("[ERROR] Number of texture coordinates are different than number of points"),a.addPrimitive(t),a}console.log("[ERROR] Invalid length of the points array")}},inherit(e.pointSource,e.source),e.lineSource=function(t,n){"use strict";if(!(this instanceof e.lineSource))return new e.lineSource;e.source.call(this);var i=t,r=n;this.setPositions=function(t){return t instanceof Array?(i=t,this.modified(),!0):(console.log("[ERROR] Invalid data type for positions. Array is required."),!1)},this.setColors=function(t){return t instanceof Array?(r=t,this.modified(),!0):(console.log("[ERROR] Invalid data type for colors. Array is required."),!1)},this.create=function(){if(i)if(i.length%3==0){if(i.length%3==0){var t,n,o,a,s=new e.geometryData,u=i.length/3,l=[];for(l.length=u,t=0;t<u;t+=1)l[t]=t;return(n=new e.lines).setIndices(l),(o=e.sourceDataP3fv()).pushBack(i),s.addSource(o),r&&r.length>0&&r.length===i.length?((a=e.sourceDataC3fv()).pushBack(r),s.addSource(a)):r&&r.length>0&&r.length!==i.length&&console.log("[error] Number of colors are different than number of points"),s.addPrimitive(n),s}console.log("[ERROR] Invalid length of the points array")}else console.log("[error] Line source requires 3d points");else console.log("[error] Invalid positions")}},inherit(e.lineSource,e.source),e.utils=function(){"use strict";return this instanceof e.utils?(e.object.call(this),this):new e.utils},inherit(e.utils,e.object),e.utils.computePowerOfTwo=function(t,e){"use strict";for(e=e||1;e<t;)e*=2;return e},e.utils.createTextureVertexShader=function(t){"use strict";var n=["attribute vec3 vertexPosition;","attribute vec3 textureCoord;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying highp vec3 iTextureCoord;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);"," iTextureCoord = textureCoord;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,n)},e.utils.createTextureFragmentShader=function(t){"use strict";var n=["varying highp vec3 iTextureCoord;","uniform sampler2D sampler2d;","uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4(texture2D(sampler2d, vec2(iTextureCoord.s, iTextureCoord.t)).xyz, opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,n)},e.utils.createRgbaTextureFragmentShader=function(t){"use strict";var n=["varying highp vec3 iTextureCoord;","uniform sampler2D sampler2d;","uniform mediump float opacity;","void main(void) {","  mediump vec4 color = vec4(texture2D(sampler2d, vec2(iTextureCoord.s, iTextureCoord.t)).xyzw);","  color.w *= opacity;","  gl_FragColor = color;","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,n)},e.utils.createVertexShader=function(t){"use strict";var n=["attribute vec3 vertexPosition;","attribute vec3 vertexColor;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying mediump vec3 iVertexColor;","varying highp vec3 iTextureCoord;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);"," iVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,n)},e.utils.createPointVertexShader=function(t){"use strict";var n=["attribute vec3 vertexPosition;","attribute vec3 vertexColor;","attribute float vertexSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","varying mediump vec3 iVertexColor;","varying highp vec3 iTextureCoord;","void main(void)","{","gl_PointSize =  vertexSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);"," iVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,n)},e.utils.createVertexShaderSolidColor=function(t){"use strict";var n=["attribute vec3 vertexPosition;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,n)},e.utils.createVertexShaderColorMap=function(t,n,i){"use strict";n=n,i=i;var r=["attribute vec3 vertexPosition;","attribute float vertexScalar;","uniform mediump float pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float lutMin;","uniform float lutMax;","varying mediump float iVertexScalar;","void main(void)","{","gl_PointSize = pointSize;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);","iVertexScalar = (vertexScalar-lutMin)/(lutMax-lutMin);","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,r)},e.utils.createFragmentShader=function(t){"use strict";var n=["varying mediump vec3 iVertexColor;","uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4(iVertexColor, opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,n)},e.utils.createPhongVertexShader=function(t){"use strict";var n=["attribute highp vec3 vertexPosition;","attribute mediump vec3 vertexNormal;","attribute mediump vec3 vertexColor;","uniform highp mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 normalMatrix;","varying highp vec4 varPosition;","varying mediump vec3 varNormal;","varying mediump vec3 varVertexColor;","void main(void)","{","varPosition = modelViewMatrix * vec4(vertexPosition, 1.0);","gl_Position = projectionMatrix * varPosition;","varNormal = vec3(normalMatrix * vec4(vertexNormal, 0.0));","varVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,n)},e.utils.createPhongFragmentShader=function(t){"use strict";var n=["uniform mediump float opacity;","precision mediump float;","varying vec3 varNormal;","varying vec4 varPosition;","varying mediump vec3 varVertexColor;","const vec3 lightPos = vec3(0.0, 0.0,10000.0);","const vec3 ambientColor = vec3(0.01, 0.01, 0.01);","const vec3 specColor = vec3(0.0, 0.0, 0.0);","void main() {","vec3 normal = normalize(varNormal);","vec3 lightDir = normalize(lightPos);","vec3 reflectDir = -reflect(lightDir, normal);","vec3 viewDir = normalize(-varPosition.xyz);","float lambertian = max(dot(lightDir, normal), 0.0);","vec3 color = vec3(0.0);","if(lambertian > 0.0) {","  color = lambertian * varVertexColor;","}","gl_FragColor = vec4(color * opacity, 1.0 - opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,n)},e.utils.createFragmentShaderSolidColor=function(t,n){"use strict";var i=["uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4("+n[0]+","+n[1]+","+n[2]+", opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,i)},e.utils.createFragmentShaderColorMap=function(t){"use strict";var n=["varying mediump float iVertexScalar;","uniform sampler2D sampler2d;","uniform mediump float opacity;","void main(void) {","gl_FragColor = vec4(texture2D(sampler2d, vec2(iVertexScalar, 0.0)).xyz, opacity);","}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,n)},e.utils.createPointSpritesVertexShader=function(t){"use strict";var n=["attribute vec3 vertexPosition;","attribute vec3 vertexColor;","uniform mediump vec2 pointSize;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float height;","varying mediump vec3 iVertexColor;","varying highp float iVertexScalar;","void main(void)","{","mediump float realPointSize = pointSize.y;","if (pointSize.x > pointSize.y) {","  realPointSize = pointSize.x;}","gl_PointSize = realPointSize ;","iVertexScalar = vertexPosition.z;","gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition.xy, height, 1.0);"," iVertexColor = vertexColor;","}"].join("\n");return e.getCachedShader(e.GL.VERTEX_SHADER,t,n)},e.utils.createPointSpritesFragmentShader=function(t){"use strict";var n=["varying mediump vec3 iVertexColor;","varying highp float iVertexScalar;","uniform sampler2D opacityLookup;","uniform highp float lutMin;","uniform highp float lutMax;","uniform sampler2D scalarsToColors;","uniform int useScalarsToColors;","uniform int useVertexColors;","uniform mediump vec2 pointSize;","uniform mediump float vertexColorWeight;","void main(void) {","mediump vec2 realTexCoord;","if (pointSize.x > pointSize.y) {","  realTexCoord = vec2(1.0, pointSize.y/pointSize.x) * gl_PointCoord;","} else {","  realTexCoord = vec2(pointSize.x/pointSize.y, 1.0) * gl_PointCoord;","}","highp float texOpacity = texture2D(opacityLookup, realTexCoord).w;","if (useScalarsToColors == 1) {","  gl_FragColor = vec4(texture2D(scalarsToColors, vec2((iVertexScalar - lutMin)/(lutMax - lutMin), 0.0)).xyz, texOpacity);","} else if (useVertexColors == 1) {","  gl_FragColor = vec4(iVertexColor, texOpacity);","} else {","  gl_FragColor = vec4(texture2D(opacityLookup, realTexCoord).xyz, texOpacity);","}}"].join("\n");return e.getCachedShader(e.GL.FRAGMENT_SHADER,t,n)},e.utils.createTextureMaterial=function(t,n){"use strict";var i,r,o=new e.material,a=new e.blend,s=new e.shaderProgram,u=e.utils.createTextureVertexShader(e.GL),l=null,c=new e.vertexAttribute("vertexPosition"),h=new e.vertexAttribute("textureCoord"),d=new e.floatUniform("pointSize",5),f=new e.projectionUniform("projectionMatrix"),p=new e.uniform(e.GL.INT,"sampler2d");return i=void 0!==n?new e.modelViewOriginUniform("modelViewMatrix",n):new e.modelViewUniform("modelViewMatrix"),p.set(0),s.addVertexAttribute(c,e.vertexAttributeKeys.Position),s.addVertexAttribute(h,e.vertexAttributeKeys.TextureCoordinate),s.addUniform(d),s.addUniform(i),s.addUniform(f),l=t?e.utils.createRgbaTextureFragmentShader(e.GL):e.utils.createTextureFragmentShader(e.GL),r=new e.floatUniform("opacity",1),s.addUniform(r),s.addShader(l),s.addShader(u),o.addAttribute(s),o.addAttribute(a),o},e.utils.createGeometryMaterial=function(){"use strict";var t=new e.material,n=new e.shaderProgram,i=e.utils.createVertexShader(e.GL),r=e.utils.createFragmentShader(e.GL),o=new e.vertexAttribute("vertexPosition"),a=new e.vertexAttribute("vertexColor"),s=new e.floatUniform("pointSize",5),u=new e.floatUniform("opacity",1),l=new e.modelViewUniform("modelViewMatrix"),c=new e.projectionUniform("projectionMatrix");return n.addVertexAttribute(o,e.vertexAttributeKeys.Position),n.addVertexAttribute(a,e.vertexAttributeKeys.Color),n.addUniform(s),n.addUniform(u),n.addUniform(l),n.addUniform(c),n.addShader(r),n.addShader(i),t.addAttribute(n),t},e.utils.createPointGeometryMaterial=function(t){"use strict";t=void 0===t?1:t;var n=new e.material,i=new e.blend,r=new e.shaderProgram,o=e.utils.createPointVertexShader(e.GL),a=e.utils.createFragmentShader(e.GL),s=new e.vertexAttribute("vertexPosition"),u=new e.vertexAttribute("vertexColor"),l=new e.vertexAttribute("vertexSize"),c=new e.floatUniform("opacity",t),h=new e.modelViewUniform("modelViewMatrix"),d=new e.projectionUniform("projectionMatrix");return r.addVertexAttribute(s,e.vertexAttributeKeys.Position),r.addVertexAttribute(u,e.vertexAttributeKeys.Color),r.addVertexAttribute(l,e.vertexAttributeKeys.Scalar),r.addUniform(c),r.addUniform(h),r.addUniform(d),r.addShader(a),r.addShader(o),n.addAttribute(r),n.addAttribute(i),n},e.utils.createPhongMaterial=function(){"use strict";var t=new e.material,n=new e.shaderProgram,i=e.utils.createPhongVertexShader(e.GL),r=e.utils.createPhongFragmentShader(e.GL),o=new e.vertexAttribute("vertexPosition"),a=new e.vertexAttribute("vertexNormal"),s=new e.vertexAttribute("vertexColor"),u=new e.floatUniform("opacity",1),l=new e.modelViewUniform("modelViewMatrix"),c=new e.normalMatrixUniform("normalMatrix"),h=new e.projectionUniform("projectionMatrix");return n.addVertexAttribute(o,e.vertexAttributeKeys.Position),n.addVertexAttribute(a,e.vertexAttributeKeys.Normal),n.addVertexAttribute(s,e.vertexAttributeKeys.Color),n.addUniform(u),n.addUniform(l),n.addUniform(h),n.addUniform(c),n.addShader(r),n.addShader(i),t.addAttribute(n),t},e.utils.createColorMaterial=function(){"use strict";var t=new e.material,n=new e.blend,i=new e.shaderProgram,r=e.utils.createVertexShader(e.GL),o=e.utils.createFragmentShader(e.GL),a=new e.vertexAttribute("vertexPosition"),s=new e.vertexAttribute("textureCoord"),u=new e.vertexAttribute("vertexColor"),l=new e.floatUniform("pointSize",5),c=new e.floatUniform("opacity",1),h=new e.modelViewUniform("modelViewMatrix"),d=new e.projectionUniform("projectionMatrix");return i.addVertexAttribute(a,e.vertexAttributeKeys.Position),i.addVertexAttribute(u,e.vertexAttributeKeys.Color),i.addVertexAttribute(s,e.vertexAttributeKeys.TextureCoordinate),i.addUniform(l),i.addUniform(c),i.addUniform(h),i.addUniform(d),i.addShader(o),i.addShader(r),t.addAttribute(i),t.addAttribute(n),t},e.utils.createColorMappedMaterial=function(t){"use strict";t||(t=new e.lookupTable);var n=t.range(),i=new e.material,r=new e.blend,o=new e.shaderProgram,a=e.utils.createVertexShaderColorMap(e.GL,n[0],n[1]),s=e.utils.createFragmentShaderColorMap(e.GL),u=new e.vertexAttribute("vertexPosition"),l=new e.vertexAttribute("vertexScalar"),c=new e.floatUniform("pointSize",5),h=new e.floatUniform("opacity",1),d=new e.floatUniform("lutMin",n[0]),f=new e.floatUniform("lutMax",n[1]),p=new e.modelViewUniform("modelViewMatrix"),m=new e.projectionUniform("projectionMatrix"),g=t;return new e.uniform(e.GL.FLOAT,"sampler2d").set(0),o.addVertexAttribute(u,e.vertexAttributeKeys.Position),o.addVertexAttribute(l,e.vertexAttributeKeys.Scalar),o.addUniform(c),o.addUniform(h),o.addUniform(d),o.addUniform(f),o.addUniform(p),o.addUniform(m),o.addShader(s),o.addShader(a),i.addAttribute(o),i.addAttribute(r),i.addAttribute(g),i},e.utils.updateColorMappedMaterial=function(t,e){"use strict";if(t)if(e){var n=t.shaderProgram().uniform("lutMin"),i=t.shaderProgram().uniform("lutMax");n.set(e.range()[0]),i.set(e.range()[1]),t.setAttribute(e)}else console.log("[warning] Invalid lookup table. Nothing to update.");else console.log("[warning] Invalid material. Nothing to update.")},e.utils.createSolidColorMaterial=function(t){"use strict";t||(t=[1,1,1]);var n=new e.material,i=new e.blend,r=new e.shaderProgram,o=e.utils.createVertexShaderSolidColor(e.GL),a=e.utils.createFragmentShaderSolidColor(e.GL,t),s=new e.vertexAttribute("vertexPosition"),u=new e.floatUniform("pointSize",5),l=new e.floatUniform("opacity",1),c=new e.modelViewUniform("modelViewMatrix"),h=new e.projectionUniform("projectionMatrix");return r.addVertexAttribute(s,e.vertexAttributeKeys.Position),r.addUniform(u),r.addUniform(l),r.addUniform(c),r.addUniform(h),r.addShader(a),r.addShader(o),n.addAttribute(r),n.addAttribute(i),n},e.utils.createPointSpritesMaterial=function(t,n){"use strict";var i=void 0===n?[0,1]:n.range(),r=new e.material,o=new e.blend,a=new e.shaderProgram,s=e.utils.createPointSpritesVertexShader(e.GL),u=e.utils.createPointSpritesFragmentShader(e.GL),l=new e.vertexAttribute("vertexPosition"),c=new e.vertexAttribute("vertexColor"),h=new e.floatUniform("height",0),d=new e.floatUniform("vertexColorWeight",0),f=new e.floatUniform("lutMin",i[0]),p=new e.floatUniform("lutMax",i[1]),m=new e.modelViewUniform("modelViewMatrix"),g=new e.projectionUniform("projectionMatrix"),v=new e.uniform(e.GL.INT,"opacityLookup"),y=new e.uniform(e.GL.INT,"scalarsToColors"),x=new e.uniform(e.GL.INT,"useScalarsToColors"),b=new e.uniform(e.GL.INT,"useVertexColors"),_=new e.uniform(e.GL.FLOAT_VEC2,"pointSize"),w=new e.texture;return v.set(0),y.set(1),x.set(0),b.set(0),_.set([1,1]),a.addVertexAttribute(l,e.vertexAttributeKeys.Position),a.addVertexAttribute(c,e.vertexAttributeKeys.Color),a.addUniform(h),a.addUniform(d),a.addUniform(m),a.addUniform(g),a.addUniform(v),a.addUniform(b),a.addUniform(x),a.addUniform(_),a.addShader(u),a.addShader(s),r.addAttribute(a),r.addAttribute(o),n&&(a.addUniform(y),x.set(1),a.addUniform(f),a.addUniform(p),n.setTextureUnit(1),r.addAttribute(n)),w.setImage(t),w.setTextureUnit(0),r.addAttribute(w),r},e.utils.createPlane=function(t,n,i,r,o,a,s,u,l){"use strict";var c=new e.mapper,h=new e.planeSource,d=e.utils.createGeometryMaterial(),f=new e.actor;return h.setOrigin(t,n,i),h.setPoint1(r,o,a),h.setPoint2(s,u,l),c.setGeometryData(h.create()),f.setMapper(c),f.setMaterial(d),f},e.utils.createTexturePlane=function(t,n,i,r,o,a,s,u,l,c){"use strict";var h=new e.mapper,d=new e.planeSource,f=e.utils.createTextureMaterial(c,[t,n,i]),p=new e.actor;return d.setPoint1(r-t,o-n,a-i),d.setPoint2(s-t,u-n,l-i),h.setGeometryData(d.create()),p.setMapper(h),p.setMaterial(f),p},e.utils.createPoints=function(t,n,i,r,o){"use strict";if(!t)return console.log("[ERROR] Cannot create points without positions"),null;o=void 0===o?1:o;var a=new e.mapper,s=new e.pointSource,u=e.utils.createPointGeometryMaterial(o),l=new e.actor;return s.setPositions(t),i&&s.setColors(i),r&&s.setTextureCoordinates(r),n?s.setSize(n):s.setSize(1),a.setGeometryData(s.create()),l.setMapper(a),l.setMaterial(u),l},e.utils.createPointSprites=function(t,n,i,r){"use strict";if(!t)return console.log("[ERROR] Point sprites requires an image"),null;if(!n)return console.log("[ERROR] Cannot create points without positions"),null;var o=new e.mapper,a=new e.pointSource,s=e.utils.createPointSpritesMaterial(t),u=new e.actor;return a.setPositions(n),i&&a.setColors(i),r&&a.setTextureCoordinates(r),o.setGeometryData(a.create()),u.setMapper(o),u.setMaterial(s),u},e.utils.createLines=function(t,n){"use strict";if(!t)return console.log("[ERROR] Cannot create points without positions"),null;var i=new e.mapper,r=new e.lineSource,o=e.utils.createGeometryMaterial(),a=new e.actor;return r.setPositions(t),n&&r.setColors(n),i.setGeometryData(r.create()),a.setMapper(i),a.setMaterial(o),a},e.utils.createColorLegend=function(t,n,i,r,o,a,s){"use strict";if(!n)return console.log("[error] Invalid lookup table"),[];var u=i[0]+r,l=i[1],c=i[0],h=i[1]+o,d=[],f=null,p=null,m=e.groupNode();return(p=(f=e.utils.createTexturePlane(i[0],i[1],i[2],u,l,0,c,h,0,!0)).material()).addAttribute(n),f.setMaterial(p),m.addChild(f),f.material().setBinNumber(e.material.RenderBin.Overlay),f.setReferenceFrame(e.boundingObject.ReferenceFrame.Absolute),d.push(f),d=d.concat(function(t,n,i,r,o,a,s,u,l,c,h,d,f,p,m){m=m;var g=null,v=(l-a)/d,y=[],x=[];for(g=0;g<=d;g+=1)y.push(a+v*g),y.push(s),y.push(u),y.push(a+v*g),y.push(s+p),y.push(u);return x=x.concat(function(t,n,i){if(n)if(n.length%3==0){if(i){var r,o=null,a=e.utils.computePowerOfTwo(48),s=0,u=[],l=[],c=[],h=[],d=n[6]-n[0];for(l.length=3,c.length=3,h.length=3,r=0;r<2;r+=1)s=r*(n.length-3),l[0]=n[s]-d,l[1]=n[s+1]-2*d,l[2]=n[s+2],c[0]=n[s]+d,c[1]=l[1],c[2]=l[2],h[0]=l[0],h[1]=n[1],h[2]=l[2],(o=e.utils.createTexturePlane(l[0],l[1],l[2],c[0],c[1],c[2],h[0],h[1],h[2],!0)).setReferenceFrame(e.boundingObject.ReferenceFrame.Absolute),o.material().setBinNumber(e.material.RenderBin.Overlay),o.material().addAttribute(e.utils.create2DTexture(i[r].toFixed(2).toString(),12,null)),u.push(o);return l[0]=.5*(n[0]+n[n.length-3]-a),l[1]=n[1]+4,l[2]=n[2],c[0]=l[0]+a,c[1]=l[1],c[2]=l[2],h[0]=l[0],h[1]=l[1]+a,h[2]=l[2],(o=e.utils.createTexturePlane(l[0],l[1],l[2],c[0],c[1],c[2],h[0],h[1],h[2],!0)).setReferenceFrame(e.boundingObject.ReferenceFrame.Absolute),o.material().setBinNumber(e.material.RenderBin.Overlay),o.material().addAttribute(e.utils.create2DTexture(t,24,null)),u.push(o),u}console.log("[error] Create labels requires Valid range")}else console.log("[error] Create labels require positions array contain 3d points");else console.log("[error] Create labels requires positions (x,y,z) array")}(t,y,n.range()))}(t,n,i[0],i[1],i[1],c,l,0,u,0,0,a,0,5,3))},e.utils.create2DTexture=function(t,n,i,r,o,a,s){"use strict";var u=document.getElementById("textRendering"),l=null,c=e.texture();return r=r||"sans-serif",o=o||"center",a=a||"bottom",void 0===s&&(s=!0),u||(u=document.createElement("canvas")),l=u.getContext("2d"),u.setAttribute("id","textRendering"),u.style.display="none",u.height=e.utils.computePowerOfTwo(8*n),u.width=u.height,l.fillStyle="rgba(0, 0, 0, 0)",l.fillRect(0,0,l.canvas.width,l.canvas.height),l.fillStyle="rgba(200, 85, 10, 1.0)",l.textAlign=o,l.textBaseline=a,l.font=4*n+"px "+r,s&&(l.font="bold "+l.font),l.fillText(t,u.width/2,u.height/2,u.width),c.setImage(u),c.updateDimensions(),c},e.picker=function(){"use strict";if(!(this instanceof e.picker))return new e.picker;e.object.call(this);var t=[];return this.getActors=function(){return t},this.pick=function(e,n,i){if(void 0===e)return 0;if(void 0===n)return 0;if(void 0===i)return 0;t=[];var r,o,a,u,l,c,h,d,f,p,m,g=i.camera(),v=i.width(),y=i.height(),x=g.focalPoint(),b=s.fromValues(x[0],x[1],x[2],1),_=i.worldToDisplay(b,g.viewMatrix(),g.projectionMatrix(),v,y),w=s.fromValues(e,n,_[2],1),M=i.displayToWorld(w,g.viewMatrix(),g.projectionMatrix(),v,y),A=g.position(),T=[];for(a=0;a<3;a+=1)T[a]=M[a]-A[a];for(r=i.sceneRoot().children(),o=0,a=0;a<r.length;a+=1)if(!0===(m=r[a]).visible()){if(u=m.bounds(),T[0]>=0?(l=(u[0]-A[0])/T[0],c=(u[1]-A[0])/T[0]):(l=(u[1]-A[0])/T[0],c=(u[0]-A[0])/T[0]),T[1]>=0?(h=(u[2]-A[1])/T[1],d=(u[3]-A[1])/T[1]):(h=(u[3]-A[1])/T[1],d=(u[2]-A[1])/T[1]),l>d||h>c)continue;if(h>l&&(l=h),d<c&&(c=d),T[2]>=0?(f=(u[4]-A[2])/T[2],p=(u[5]-A[2])/T[2]):(f=(u[5]-A[2])/T[2],p=(u[4]-A[2])/T[2]),l>p||f>c)continue;f>l&&(l=f),p<c&&(c=p),t[o]=m,o+=1}return o},this},inherit(e.picker,e.object),e.shapefileReader=function(){"use strict";if(!(this instanceof e.shapefileReader))return new e.shapefileReader;var t=this;return this.int8=function(t,e){return t.charCodeAt(e)},this.bint32=function(t,e){return((255&t.charCodeAt(e))<<24)+((255&t.charCodeAt(e+1))<<16)+((255&t.charCodeAt(e+2))<<8)+(255&t.charCodeAt(e+3))},this.lint32=function(t,e){return((255&t.charCodeAt(e+3))<<24)+((255&t.charCodeAt(e+2))<<16)+((255&t.charCodeAt(e+1))<<8)+(255&t.charCodeAt(e))},this.bint16=function(t,e){return((255&t.charCodeAt(e))<<8)+(255&t.charCodeAt(e+1))},this.lint16=function(t,e){return((255&t.charCodeAt(e+1))<<8)+(255&t.charCodeAt(e))},this.ldbl64=function(t,e){var n=255&t.charCodeAt(e),i=255&t.charCodeAt(e+1),r=255&t.charCodeAt(e+2),o=255&t.charCodeAt(e+3),a=255&t.charCodeAt(e+4),s=255&t.charCodeAt(e+5),u=255&t.charCodeAt(e+6),l=255&t.charCodeAt(e+7),c=((127&l)<<4)+((240&u)>>4)-1023;return(1-2*(l>>7))*(1+((15&u)*Math.pow(2,48)+s*Math.pow(2,40)+a*Math.pow(2,32)+o*Math.pow(2,24)+r*Math.pow(2,16)+i*Math.pow(2,8)+n)*Math.pow(2,-52))*Math.pow(2,c)},this.lfloat32=function(t,e){var n=255&t.charCodeAt(e),i=255&t.charCodeAt(e+1),r=255&t.charCodeAt(e+2),o=255&t.charCodeAt(e+3),a=((127&o)<<1)+((254&r)>>7)-127;return(1-2*(o>>7))*(1+((127&r)*Math.pow(2,16)+i*Math.pow(2,8)+n)*Math.pow(2,-23))*Math.pow(2,a)},this.str=function(t,e,n){for(var i=[],r=e;r<e+n;){var o=t[r];if(0===o.charCodeAt(0))break;i.push(o),r+=1}return i.join("")},this.readHeader=function(t){return{code:this.bint32(t,0),length:this.bint32(t,24),version:this.lint32(t,28),shapetype:this.lint32(t,32)}},this.loadShx=function(e){for(var n=[],i=function(i){return n.push(2*t.bint32(e,i)),i+8},r=100;r<e.length;)r=i(r);return n},this.Shapefile=function(t){var e=t.path;l.ajax({url:e+".shx",mimeType:"text/plain; charset=x-user-defined",success:function(n){var i=this.loadShx(n);l.ajax({url:e+".shp",mimeType:"text/plain; charset=x-user-defined",success:function(n){l.ajax({url:e+".dbf",mimeType:"text/plain; charset=x-user-defined",success:function(e){var r=this.loadShp(n,e,i,t);t.success(r)}})}})}})},this.localShapefile=function(e){var n=e.shx,i=e.shp,r=e.dbf,o=new FileReader;o.onloadend=function(){var n=t.loadShx(o.result),a=new FileReader;a.onloadend=function(){var i=a.result,o=new FileReader;o.onloadend=function(){var r=o.result,a=t.loadShp(i,r,n,e);e.success(a)},o.readAsBinaryString(r)},a.readAsBinaryString(i)},o.readAsBinaryString(n)},this.loadDBF=function(e){if(4===t.int8(e,0))throw"Level 7 dBASE not supported";for(var n,i=t.lint32(e,4),r=t.lint16(e,8),o=t.lint16(e,10),a=32,s=[];a<r-1;)s.push((n=a,{name:t.str(e,n,10),type:t.str(e,n+11,1),length:t.int8(e,n+16)})),a+=32;for(var u=[],l=r;l<r+i*o;){if("*"===t.str(e,l,1))l+=o;else{l+=1;for(var c={},h=0;h<s.length;h+=1){var d,f=s[h];"C"===f.type?d=t.str(e,l,f.length).trim():"N"===f.type&&(d=parseFloat(t.str(e,l,f.length))),l+=f.length,c[f.name]=d}u.push(c)}}return u},this.loadShp=function(e,n,i,r){r=r;var o,a=[],s=function(n,i,r){for(var o=[],a=r-1;a>=i;a-=1){var s=t.ldbl64(e,n+16*a),u=t.ldbl64(e,n+16*a+8);o.push([s,u])}return o},u=function(n){var i,r,o,u,l,c,h,d,f,p=n+8,m=t.lint32(e,p);if(0===m)console.log("NULL Shape");else if(1===m){var g=t.ldbl64(e,p+4),v=t.ldbl64(e,p+12);a.push({type:"Point",attr:{},geom:[[g,v]]})}else if(5===m){for(i=t.lint32(e,p+36),r=t.lint32(e,p+40),o=n+52,u=n+52+4*i,f=[],l=0;l<i;l+=1)c=t.lint32(e,o+4*l),h=l+1<i?t.lint32(e,o+4*(l+1)):r,d=s(u,c,h),f.push(d);a.push({type:"Polygon",attr:{},geom:[f]})}else{if(3!==m)throw"Not Implemented: "+m;for(i=t.lint32(e,p+36),r=t.lint32(e,p+40),o=n+52,u=n+52+4*i,f=[],l=0;l<i;l+=1)c=t.lint32(e,o+4*l),h=l+1<i?t.lint32(e,o+4*(l+1)):r,d=s(u,c,h),f.push(d);a.push({type:"Polyline",attr:{},geom:[f]})}},l=this.loadDBF(n);for(o=0;o<i.length;o+=1){u(i[o])}var c=[];for(o=0;o<a.length;o+=1){var h=a[o];h.attr=l[o],c.push(h)}return c},this},e.vtkReader=function(){"use strict";if(!(this instanceof e.vtkReader))return new e.vtkReader;var t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],n=[],i={},r=null,o=null,s="",u=0,l=0,c=null,h=0;if(0===n.length)for(h=0;h<t.length;h+=1)n[t[h]]=h;return this.ntos=function(t){var e;return 1===(e=t.toString(16)).length&&(e="0"+e),e="%"+e,unescape(e)},this.readReverseBase64=function(){var t;if(!s)return-1;for(;;){if(u>=s.length)return-1;if(t=s.charAt(u),u+=1,n[t])return n[t];if("A"===t)return 0}return-1},this.decode64=function(t){var e="",n=new Array(4),i=!1;for(s=t,u=0;!i&&-1!==(n[0]=this.readReverseBase64())&&-1!==(n[1]=this.readReverseBase64());)n[2]=this.readReverseBase64(),n[3]=this.readReverseBase64(),e+=this.ntos(n[0]<<2&255|n[1]>>4),-1!==n[2]?(e+=this.ntos(n[1]<<4&255|n[2]>>2),-1!==n[3]?e+=this.ntos(n[2]<<6&255|n[3]):i=!0):i=!0;return e},this.readNumber=function(t){return t[l++]+(t[l++]<<8)+(t[l++]<<16)+(t[l++]<<24)},this.readF3Array=function(t,e){var n,i=4*t*3,r=new Int8Array(i);for(n=0;n<i;n+=1)r[n]=e[l],l+=1;return new Float32Array(r.buffer)},this.readColorArray=function(t,e,n){var i,r=0,o=new Array(3*t);for(i=0;i<t;i+=1)o[r++]=e[l++]/255,o[r++]=e[l++]/255,o[r++]=e[l++]/255,l++;n.insert(o)},this.parseObject=function(t){var n,i,r,o,s,u,d,f,p,m,g,v=new e.geometryData,y=e.mapper(),x=[],b=null,_=null,w=null;for(b=atob(t.data),h=0;h<b.length;h+=1)x[h]=255&b.charCodeAt(h);if(l=0,i=this.readNumber(x),n=String.fromCharCode(x[l]),l+=1,v.setName(n),"L"===n)_=this.parseLineData(v,x),w=e.utils.createGeometryMaterial();else if("M"===n)_=this.parseMeshData(v,x),w=e.utils.createPhongMaterial();else if("P"===n)_=this.parsePointData(v,x),w=e.utils.createGeometryMaterial();else{if("C"===n){for(o=this.parseColorMapData(v,x,i),d=[],h=0;h<o.colors.length;h+=1)d.push(o.colors[h][1]),d.push(o.colors[h][2]),d.push(o.colors[h][3]),d.push(255*o.colors[h][0]);return(u=new e.lookupTable).setColorTable(d),f=c.renderWindow().windowSize(),p=o.size[0]*f[0],m=o.size[1]*f[1],(g=[o.position[0]*f[0],(1-o.position[1])*f[1],0])[1]=g[1]-m,m=30,e.utils.createColorLegend(o.title,u,g,p,m,3,0)}console.log("Ignoring unrecognized encoded data type "+n)}return y.setGeometryData(v),t.hasTransparency&&(s=w.shaderProgram().uniform("opacity"),console.log("opacity ",t.opacity),s.set(t.opacity),w.setBinNumber(1e3)),(r=e.actor()).setMapper(y),r.setMaterial(w),r.setMatrix(a.transpose(a.create(),_)),[r]},this.parseLineData=function(t,n){var i,r,o,s,u,c,h,d,f=null,p=null,m=a.create(),g=null,v=0;for(o=this.readNumber(n),g=new Array(3*o),f=new e.sourceDataP3fv,s=this.readF3Array(o,n),d=0;d<o;d+=1)g[v++]=s[3*d],g[v++]=s[3*d+1],g[v++]=s[3*d+2];for(f.insert(g),t.addSource(f),i=new e.sourceDataC3fv,this.readColorArray(o,n,i),t.addSource(i),p=new e.lines,t.addPrimitive(p),r=this.readNumber(n),u=new Int8Array(2*r),d=0;d<2*r;d+=1)u[d]=n[l],l+=1;for(c=new Uint16Array(u.buffer),p.setIndices(c),p.setPrimitiveType(e.GL.LINES),64,u=new Int8Array(64),d=0;d<64;d+=1)u[d]=n[l],l+=1;return h=new Float32Array(u.buffer),a.copy(m,h),m},this.parseMeshData=function(t,n){var i,r,o,s,u,c,h,d,f,p=null,m=a.create(),g=null,v=null,y=0;for(s=this.readNumber(n),v=new Array(6*s),p=new e.sourceDataP3N3f,u=this.readF3Array(s,n),r=this.readF3Array(s,n),f=0;f<s;f+=1)v[y++]=u[3*f],v[y++]=u[3*f+1],v[y++]=u[3*f+2],v[y++]=r[3*f],v[y++]=r[3*f+1],v[y++]=r[3*f+2];for(p.insert(v),t.addSource(p),i=new e.sourceDataC3fv,this.readColorArray(s,n,i),t.addSource(i),c=[],g=new e.triangles,o=this.readNumber(n),c=new Int8Array(2*o),f=0;f<2*o;f+=1)c[f]=n[l],l+=1;for(h=new Uint16Array(c.buffer),g.setIndices(h),t.addPrimitive(g),64,c=new Int8Array(64),f=0;f<64;f+=1)c[f]=n[l],l+=1;return d=new Float32Array(c.buffer),a.copy(m,d),m},this.parsePointData=function(t,n){var i,r,o,s,u,c,d=a.create(),f=null,p=null,m=null,g=0;for(i=this.readNumber(n),m=new Array(3*i),f=new e.sourceDataP3fv,r=this.readF3Array(i,n),o=new Uint16Array(i),h=0;h<i;h+=1)o[h]=h,m[g++]=r[3*h],m[g++]=r[3*h+1],m[g++]=r[3*h+2];for(f.insert(m),t.addSource(f),u=new e.sourceDataC3fv,this.readColorArray(i,n,u),t.addSource(u),(p=new e.points).setIndices(o),t.addPrimitive(p),64,s=new Int8Array(64),h=0;h<64;h+=1)s[h]=n[l],l+=1;return c=new Float32Array(s.buffer),a.copy(d,c),d},this.parseColorMapData=function(t,e,n){var i,r,o,a,s,u={};for(u.numOfColors=n,r=8,i=new Int8Array(r),a=0;a<r;a+=1)i[a]=e[l],l+=1;for(u.position=new Float32Array(i.buffer),r=8,i=new Int8Array(r),a=0;a<r;a+=1)i[a]=e[l],l+=1;for(u.size=new Float32Array(i.buffer),u.colors=[],s=0;s<u.numOfColors;s+=1){for(i=new Int8Array(4),a=0;a<4;a+=1)i[a]=e[l],l+=1;o=[new Float32Array(i.buffer)[0],e[l++],e[l++],e[l++]],u.colors[s]=o}for(u.orientation=e[l++],u.numOfLabels=e[l++],u.title="";l<e.length;)u.title+=String.fromCharCode(e[l++]);return u},this.parseSceneMetadata=function(t,e){var n,i,a,s=r.Renderers[e],u=t.camera();i=(s.size[0]-s.origin[0])*o.width,a=(s.size[1]-s.origin[1])*o.height,t.resize(i,a),u.setCenterOfRotation([s.LookAt[1],s.LookAt[2],s.LookAt[3]]),u.setViewAngleDegrees(s.LookAt[0]),u.setPosition(s.LookAt[7],s.LookAt[8],s.LookAt[9]),u.setFocalPoint(s.LookAt[1],s.LookAt[2],s.LookAt[3]),u.setViewUpDirection(s.LookAt[4],s.LookAt[5],s.LookAt[6]),0===e?(n=s.Background1,t.setBackgroundColor(n[0],n[1],n[2],1)):t.setResizable(!1),t.setLayer(e)},this.initScene=function(){var t,e;if(null===r)return c;for(e=r.Renderers.length-1;e>=0;e-=1)t=this.getRenderer(e),this.parseSceneMetadata(t,e);return c},this.createViewer=function(t){var n;return null===c&&(o=t,(c=e.viewer(t)).init(),c.renderWindow().removeRenderer(c.renderWindow().activeRenderer()),c.renderWindow().addRenderer(new e.depthPeelRenderer),i[0]=c.renderWindow().activeRenderer(),c.renderWindow().resize(t.width,t.height),n=e.pvwInteractorStyle(),c.setInteractorStyle(n)),c},this.deleteViewer=function(){i={},c=null},this.updateCanvas=function(t){return o=t,c.renderWindow().resize(t.width,t.height),c},this.numObjects=function(){return 0},this.getRenderer=function(t){var n;return null!==(n=i[t])&&void 0!==n||((n=new e.renderer).setResetScene(!1),n.setResetClippingRange(!1),c.renderWindow().addRenderer(n),0!==t&&n.camera().setClearMask(e.GL.DepthBufferBit),i[t]=n),n},this.setVtkScene=function(t){r=t},this},e.DataBuffers=function(t){"use strict";if(!(this instanceof e.DataBuffers))return new e.DataBuffers(t);var n,i={};n=t||0===t?t:256;var r=0,o=function(t,e,n,i){if(!t)throw"No destination";n||(n=0),i||(i=e.length);for(var r=0;r<i;r+=1)t[n+r]=e[r]};this.create=function(t,e){if(!e||e<0)throw"Length of buffer must be a positive integer";var r=new Float32Array(n*e);return i[t]={array:r,len:e,dirty:!1},i[t].array},this.alloc=function(t){r+t>=n&&function(t){var e=n;for(2*e<t&&(e=t);e<t;)e*=2;for(var r in n=e,i)if(i.hasOwnProperty(r)){var a=new Float32Array(e*i[r].len),s=i[r].array;o(a,s),i[r].array=a,i[r].dirty=!0}}(r+t);var e=r;return r+=t,e},this.get=function(t){return i[t].array},this.write=function(t,e,r,a){if(r+a>n)throw"Write would exceed buffer size";o(i[t].array,e,r*i[t].len,a*i[t].len),i[t].dirty=!0},this.repeat=function(t,e,r,a){if(r+a>n)throw"Repeat would exceed buffer size";for(var s=0;s<a;s+=1)o(i[t].array,e,(r+s)*i[t].len,i[t].len);i[t].dirty=!0},this.count=function(){return r},this.data=function(t){return i[t].array}},e},void 0===(i=function(){return r.vgl=o()}.apply(e,[]))||(t.exports=i)},function(t,e){t.exports=function(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}},function(t,e){t.exports=function(t){var e=new Float32Array(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},function(t,e){t.exports=function(t,e,n,i){var r=new Float32Array(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=i,r}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},function(t,e){t.exports=function(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}},function(t,e){t.exports=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}},function(t,e){t.exports=function(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t[2]=e[2]+n[2]*i,t[3]=e[3]+n[3]*i,t}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(n*n+i*i+r*r+o*o)}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return n*n+i*i+r*r+o*o}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.sqrt(e*e+n*n+i*i+r*r)}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}},function(t,e){t.exports=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}},function(t,e){t.exports=function(t,e,n,i){var r=e[0],o=e[1],a=e[2],s=e[3];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=a+i*(n[2]-a),t[3]=s+i*(n[3]-s),t}},function(t,e,n){var i=n(114),r=n(113);t.exports=function(t,e){return e=e||1,t[0]=Math.random(),t[1]=Math.random(),t[2]=Math.random(),t[3]=Math.random(),i(t,t),r(t,t,e),t}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*a,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*a,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*a,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*a,t}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*i+s*o-u*r,h=l*r+u*i-a*o,d=l*o+a*r-s*i,f=-a*i-s*r-u*o;return t[0]=c*l+f*-a+h*-u-d*-s,t[1]=h*l+f*-s+d*-a-c*-u,t[2]=d*l+f*-u+c*-s-h*-a,t[3]=e[3],t}},function(t,e,n){var i={"./aea.js":83,"./aeqd.js":94,"./cass.js":81,"./cea.js":85,"./eqc.js":86,"./eqdc.js":92,"./equi.js":259,"./etmerc.js":44,"./gauss.js":75,"./gnom.js":84,"./gstmerc.js":260,"./krovak.js":80,"./laea.js":82,"./lcc.js":79,"./longlat.js":64,"./merc.js":63,"./mill.js":89,"./moll.js":91,"./nzmg.js":88,"./omerc.js":78,"./ortho.js":95,"./poly.js":87,"./qsc.js":96,"./robin.js":97,"./sinu.js":90,"./somerc.js":77,"./stere.js":76,"./sterea.js":74,"./tmerc.js":68,"./utm.js":73,"./vandg.js":93};function r(t){return n(o(t))}function o(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}r.keys=function(){return Object.keys(i)},r.resolve=o,t.exports=r,r.id=258},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=r,e.forward=o,e.inverse=a,n.d(e,"names",function(){return s});var i=n(5);function r(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0}function o(t){var e=t.x,n=t.y,r=Object(i.a)(e-this.long0),o=this.x0+this.a*r*Math.cos(this.lat0),a=this.y0+this.a*n;return this.t1=o,this.t2=Math.cos(this.lat0),t.x=o,t.y=a,t}function a(t){t.x-=this.x0,t.y-=this.y0;var e=t.y/this.a,n=Object(i.a)(this.long0+t.x/(this.a*Math.cos(this.lat0)));t.x=n,t.y=e}var s=["equi"];e.default={init:r,forward:o,inverse:a,names:s}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.init=s,e.forward=u,e.inverse=l,n.d(e,"names",function(){return c});var i=n(261),r=n(45),o=n(72),a=n(262);function s(){var t=this.b/this.a;this.e=Math.sqrt(1-t*t),this.lc=this.long0,this.rs=Math.sqrt(1+this.e*this.e*Math.pow(Math.cos(this.lat0),4)/(1-this.e*this.e));var e=Math.sin(this.lat0),n=Math.asin(e/this.rs),r=Math.sin(n);this.cp=Object(i.a)(0,n,r)-this.rs*Object(i.a)(this.e,this.lat0,e),this.n2=this.k0*this.a*Math.sqrt(1-this.e*this.e)/(1-this.e*this.e*e*e),this.xs=this.x0,this.ys=this.y0-this.n2*n,this.title||(this.title="Gauss Schreiber transverse mercator")}function u(t){var e=t.x,n=t.y,a=this.rs*(e-this.lc),s=this.cp+this.rs*Object(i.a)(this.e,n,Math.sin(n)),u=Math.asin(Math.sin(a)/Object(o.a)(s)),l=Object(i.a)(0,u,Math.sin(u));return t.x=this.xs+this.n2*l,t.y=this.ys+this.n2*Math.atan(Object(r.a)(s)/Math.cos(a)),t}function l(t){var e=t.x,n=t.y,s=Math.atan(Object(r.a)((e-this.xs)/this.n2)/Math.cos((n-this.ys)/this.n2)),u=Math.asin(Math.sin((n-this.ys)/this.n2)/Object(o.a)((e-this.xs)/this.n2)),l=Object(i.a)(0,u,Math.sin(u));return t.x=this.lc+s/this.rs,t.y=Object(a.a)(this.e,(l-this.cp)/this.rs),t}var c=["gstmerg"];e.default={init:s,forward:u,inverse:l,names:c}},function(t,e,n){"use strict";var i=n(3);e.a=function(t,e,n){if(Math.abs(e)>i.d)return Number.NaN;if(e===i.d)return Number.POSITIVE_INFINITY;if(e===-1*i.d)return Number.NEGATIVE_INFINITY;var r=t*n;return Math.log(Math.tan((i.d+e)/2))+t*Math.log((1-r)/(1+r))/2}},function(t,e,n){"use strict";var i=n(263);e.a=function(t,e){var n=Object(i.a)(1,e),r=0,o=0;do{r=n,o=t*Math.sin(r),n=Object(i.a)(Math.exp(t*Math.log((1+o)/(1-o))/2),e)}while(Math.abs(n-r)>1e-12);return n}},function(t,e,n){"use strict";var i=n(3);e.a=function(t,e){return 2*Math.atan(t*Math.exp(e))-i.d}},function(t,e,n){var i;i=function(){"use strict";function t(n,i,r,o,a,s){if(!(a-o<=r)){var u=o+a>>1;!function t(n,i,r,o,a,s){for(;a>o;){if(a-o>600){var u=a-o+1,l=r-o+1,c=Math.log(u),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(u-h)/u)*(l-u/2<0?-1:1),f=Math.max(o,Math.floor(r-l*h/u+d)),p=Math.min(a,Math.floor(r+(u-l)*h/u+d));t(n,i,r,f,p,s)}var m=i[2*r+s],g=o,v=a;for(e(n,i,o,r),i[2*a+s]>m&&e(n,i,o,a);g<v;){for(e(n,i,g,v),g++,v--;i[2*g+s]<m;)g++;for(;i[2*v+s]>m;)v--}i[2*o+s]===m?e(n,i,o,v):e(n,i,++v,a),v<=r&&(o=v+1),r<=v&&(a=v-1)}}(n,i,u,o,a,s%2),t(n,i,r,o,u-1,s+1),t(n,i,r,u+1,a,s+1)}}function e(t,e,i,r){n(t,i,r),n(e,2*i,2*r),n(e,2*i+1,2*r+1)}function n(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function i(t,e,n,i){var r=t-n,o=e-i;return r*r+o*o}var r=function(t){return t[0]},o=function(t){return t[1]},a=function(e,n,i,a,s){void 0===n&&(n=r),void 0===i&&(i=o),void 0===a&&(a=64),void 0===s&&(s=Float64Array),this.nodeSize=a,this.points=e;for(var u=e.length<65536?Uint16Array:Uint32Array,l=this.ids=new u(e.length),c=this.coords=new s(2*e.length),h=0;h<e.length;h++)l[h]=h,c[2*h]=n(e[h]),c[2*h+1]=i(e[h]);t(l,c,a,0,l.length-1,0)};return a.prototype.range=function(t,e,n,i){return function(t,e,n,i,r,o,a){for(var s,u,l=[0,t.length-1,0],c=[];l.length;){var h=l.pop(),d=l.pop(),f=l.pop();if(d-f<=a)for(var p=f;p<=d;p++)s=e[2*p],u=e[2*p+1],s>=n&&s<=r&&u>=i&&u<=o&&c.push(t[p]);else{var m=Math.floor((f+d)/2);s=e[2*m],u=e[2*m+1],s>=n&&s<=r&&u>=i&&u<=o&&c.push(t[m]);var g=(h+1)%2;(0===h?n<=s:i<=u)&&(l.push(f),l.push(m-1),l.push(g)),(0===h?r>=s:o>=u)&&(l.push(m+1),l.push(d),l.push(g))}}return c}(this.ids,this.coords,t,e,n,i,this.nodeSize)},a.prototype.within=function(t,e,n){return function(t,e,n,r,o,a){for(var s=[0,t.length-1,0],u=[],l=o*o;s.length;){var c=s.pop(),h=s.pop(),d=s.pop();if(h-d<=a)for(var f=d;f<=h;f++)i(e[2*f],e[2*f+1],n,r)<=l&&u.push(t[f]);else{var p=Math.floor((d+h)/2),m=e[2*p],g=e[2*p+1];i(m,g,n,r)<=l&&u.push(t[p]);var v=(c+1)%2;(0===c?n-o<=m:r-o<=g)&&(s.push(d),s.push(p-1),s.push(v)),(0===c?n+o>=m:r+o>=g)&&(s.push(p+1),s.push(h),s.push(v))}}return u}(this.ids,this.coords,t,e,n,this.nodeSize)},a},t.exports=i()},function(t,e,n){"use strict";var i=n(0),r=n(37),o=n(58),a=n(6),s=n(1),u=n(7),l=n(2),c=n(117),h=n(27),d=function t(e){if(!(this instanceof t))return new t(e);r.call(this,e);var i,d,f,p,m=n(51),g=n(9),v=n(4),y=this,x=this._init,b=this._exit,_=this.draw,w=this._update,M=g(),A=null,T=[],C=[],E={closed:{dataType:"boolean",keys:["closed","close"]},fill:{dataType:"boolean",keys:["fill"]},fillColor:{dataType:"color",keys:["fillColor","fill-color","marker-color","fill"]},fillOpacity:{dataType:"opacity",keys:["fillOpacity","fill-opacity"]},lineCap:{dataType:"text",keys:["lineCap","line-cap"]},lineJoin:{dataType:"text",keys:["lineJoin","line-join"]},radius:{dataType:"positive",keys:["radius"]},scaled:{dataType:"booleanOrNumber",keys:["scaled"]},stroke:{dataType:"boolean",keys:["stroke"]},strokeColor:{dataType:"color",keys:["strokeColor","stroke-color","stroke"]},strokeOffset:{dataType:"number",keys:["strokeOffset","stroke-offset"]},strokeOpacity:{dataType:"opacity",keys:["strokeOpacity","stroke-opacity"]},strokeWidth:{dataType:"positive",keys:["strokeWidth","stroke-width"]}},O={offset:"coordinate2",rotateWithMap:"boolean",rotation:"angle",scaleWithMap:"boolean",scale:"booleanOrNumber",shadowBlur:"numberOrBlank",shadowOffset:"coordinate2",strokeWidth:"numberOrBlank",visible:"boolean"};return h.usedStyles.forEach(function(t){E[t]={option:"labelStyle",dataType:O[t]||"text",keys:[t,"label"+t.charAt(0).toUpperCase()+t.slice(1),t.replace(/([A-Z])/g,"-$1").toLowerCase(),"label-"+t.replace(/([A-Z])/g,"-$1").toLowerCase()]}}),i=l.extend(!0,{},{dblClickTime:300,adjacentPointProximity:5,continuousPointProximity:5,continuousPointColinearity:1*Math.PI/180,finalPointProximity:10,showLabels:!0,clickToEdit:!1},e),this._processAction=function(t){var e;if(t.state&&t.state.actionRecord&&t.state.actionRecord.owner===o.actionOwner&&y.currentAnnotation)switch(y.mode()){case y.modes.edit:e=y.currentAnnotation.processEditAction(t),y.currentAnnotation&&y.currentAnnotation._editHandle&&y.currentAnnotation._editHandle.handle&&(y.geoTrigger(a.annotation.edit_action,{annotation:y.currentAnnotation,handle:y.currentAnnotation._editHandle?y.currentAnnotation._editHandle.handle:void 0,action:t.event}),t.event===a.actionup&&y._selectEditHandle({data:y.currentAnnotation._editHandle.handle},y.currentAnnotation._editHandle.handle.selected));break;default:e=y.currentAnnotation.processAction(t)}y._updateFromEvent(e)},this._updateFromEvent=function(t){switch(t){case"remove":y.removeAnnotation(y.currentAnnotation,!1),y.mode(null);break;case"done":y.mode(null)}t&&(y.modified(),y.draw())},this._handleMouseMove=function(t){y.mode()&&y.currentAnnotation&&(y.currentAnnotation.mouseMove(t)&&(y.modified(),y.draw()))},this._selectEditHandle=function(t,e){if(t.data&&t.data.editHandle){if(l.each(C[o._editHandleFeatureLevel],function(t,e){e.feature.modified()}),y.currentAnnotation.selectEditHandle(t.data,e),y.draw(),y.map().node().toggleClass("annotation-input",!!e),y.map().interactor().removeAction(void 0,void 0,o.actionOwner),e){var n=y.currentAnnotation.actions(o.state.edit);l.each(n,function(t,e){y.map().interactor().addAction(e)})}return y}},this._handleMouseOn=function(t){t.data&&t.data.annotation&&(y.mode()===y.modes.edit&&y.currentAnnotation?y._selectEditHandle(t,!0):y.mode()||y.currentAnnotation||!y.options("clickToEdit")||(t.data.annotation.state(o.state.highlight),y.modified(),y.draw()))},this._handleMouseOff=function(t){t.data&&t.data.annotation&&(y.mode()===y.modes.edit&&t.data.editHandle&&t.data.selected?y._selectEditHandle(t,!1):t.data.annotation.state()===o.state.highlight&&(t.data.annotation.state(o.state.done),y.modified(),y.draw()))},this._handleMouseClick=function(t){var e,n=!1;if(y.mode()===y.modes.edit){if(y.map().interactor().hasAction(void 0,void 0,o.actionOwner))return e=y.currentAnnotation.mouseClickEdit(t),void y._updateFromEvent(e);y.mode(null),y.draw(),l.each(C,function(t,e){l.each(e,function(t,e){e.feature._clearSelectedFeatures()})}),n=!0}else if(y.mode()&&y.currentAnnotation)e=y.currentAnnotation.mouseClick(t),y._updateFromEvent(e),n=!y.mode();else if(!y.mode()&&!y.currentAnnotation&&y.options("clickToEdit")){var i=y.annotations().filter(function(t){return t.state()===o.state.highlight});if(1!==i.length)return;y.mode(y.modes.edit,i[0]),y.draw(),n=!0}n&&y.map().interactor().retriggerMouseMove()},this.options=function(t,e){return void 0===t?i:"string"==typeof t&&void 0===e?i[t]:(void 0===e?i=l.extend(!0,i,t):i[t]=e,y.modified(),y)},this.displayDistance=function(t,e,n,i){var r=y.map();return"display"!==e&&(e=null===e?r.gcs():void 0===e?r.ingcs():e,t=r.gcsToDisplay(t,e)),"display"!==i&&(i=null===i?r.gcs():void 0===i?r.ingcs():i,n=r.gcsToDisplay(n,i)),Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))},this.addAnnotation=function(t,e){if(l.inArray(t,T)<0){y.geoTrigger(a.annotation.add_before,{annotation:t}),T.push(t),t.layer(y);var n=y.map();(e=null===e?n.gcs():void 0===e?n.ingcs():e)!==n.gcs()&&t._coordinates(u.transformCoordinates(e,n.gcs(),t._coordinates())),y.modified(),y.draw(),y.geoTrigger(a.annotation.add,{annotation:t})}return y},this.removeAnnotation=function(t,e){var n=l.inArray(t,T);return n>=0&&(t===y.currentAnnotation&&(y.currentAnnotation=null),t._exit(),T.splice(n,1),!1!==e&&(y.modified(),y.draw()),y.geoTrigger(a.annotation.remove,{annotation:t})),n>=0},this.removeAllAnnotations=function(t,e){for(var n,i=0,r=0;r<T.length;)n=T[r],t&&n.state()===o.state.create?r+=1:(y.removeAnnotation(n,!1),i+=1);return i&&!1!==e&&(y.modified(),y.draw()),i},this.annotations=function(){return T.slice()},this.annotationById=function(t){void 0!==t&&null!==t&&(t=+t);var e=T.filter(function(e){return e.id()===t});if(e.length)return e[0]},this.modes={edit:"edit"},this.mode=function(t,e){if(void 0===t)return A;if(t!==A||t===y.modes.edit&&e!==y.editAnnotation){var n,i,r=y.map().node(),s=A;if(A=t,r.toggleClass("annotation-input",!(!A||A===y.modes.edit)),p||(p=c(r[0])),A?p.bind("esc",function(){y.mode(null)}):p.unbind("esc"),y.currentAnnotation){switch(y.currentAnnotation.state()){case o.state.create:y.removeAnnotation(y.currentAnnotation);break;case o.state.edit:y.currentAnnotation.state(o.state.done),y.modified(),y.draw()}y.currentAnnotation=null}switch(A){case y.modes.edit:y.currentAnnotation=e,y.currentAnnotation.state(o.state.edit),y.modified();break;case"line":n=o.lineAnnotation;break;case"point":n=o.pointAnnotation;break;case"polygon":n=o.polygonAnnotation;break;case"rectangle":n=o.rectangleAnnotation}y.map().interactor().removeAction(void 0,void 0,o.actionOwner),n&&(y.currentAnnotation=n({state:o.state.create,layer:y}),y.addAnnotation(y.currentAnnotation,null),i=y.currentAnnotation.actions(o.state.create),l.each(i,function(t,e){y.map().interactor().addAction(e)})),y.geoTrigger(a.annotation.mode,{mode:A,oldMode:s}),s===y.modes.edit&&y.modified()}return y},this.geojson=function(t,e,n,i){if(void 0!==t){var r=s.createFileReader("geojsonReader",{layer:y});if(!r.canRead(t))return;return!0===e&&y.removeAllAnnotations(!0,!1),"update"===e&&l.each(y.annotations(),function(t,e){e.options("updated",!1)}),r.read(t,function(t){l.each(t.slice(),function(t,e){y._geojsonFeatureToAnnotation(e,n),y.deleteFeature(e)})}),"update"===e&&l.each(y.annotations(),function(t,e){!1===e.options("updated")&&e.state()===o.state.done&&y.removeAnnotation(e,!1)}),y.modified(),y.draw(),T.length}t=null;var a=[];return l.each(T,function(t,e){var r=e.geojson(n,i);r&&a.push(r)}),a.length&&(t={type:"FeatureCollection",features:a}),t},this._geojsonFeatureToAnnotation=function(t,e){var n=t.data(),i=s.listAnnotations(),r=y.map();e=null===e?r.gcs():void 0===e?r.ingcs():e,l.each(n,function(n,c){var h,d,f,p,m=(c.properties||{}).annotationType||t.featureType,g=l.extend({},c.properties||{});if(!(l.inArray(m,i)<0)){switch(g.style=g.style||{},g.labelStyle=g.labelStyle||{},delete g.annotationType,t.featureType){case"line":if(!(h=t.line()(c,n))||h.length<2)return;h=h.slice();break;case"polygon":if(!(h=t.polygon()(c,n))||!h.outer||h.outer.length<3)return;if((h=h.outer.slice())[h.length-1][0]===h[0][0]&&h[h.length-1][1]===h[0][1]&&(h.splice(h.length-1,1),h.length<3))return;break;case"point":h=[t.position()(c,n)]}for(f=0;f<h.length;f+=1)h[f]=v.normalizeCoordinates(h[f]);(d=c.crs&&"name"===c.crs.type&&c.crs.properties&&"proj4"===c.crs.properties.type&&c.crs.properties.name?c.crs.properties.name:e)!==r.gcs()&&(h=u.transformCoordinates(d,r.gcs(),h)),g.coordinates=h,l.each(E,function(e,i){var r;l.each(i.keys,function(t,e){void 0===r&&(r=y.validateAttribute(g[e],i.dataType))}),void 0===r&&(r=y.validateAttribute(t.style.get(e)(c,n),i.dataType)),void 0!==r&&(g[i.option||"style"][e]=r)}),l.each(E,function(t,e){l.each(e.keys,function(t,e){delete g[e]})}),void 0!==g.annotationId&&(p=y.annotationById(g.annotationId))&&delete g.annotationId,p&&p.type()===m&&p.state()===o.state.done&&!1===p.options("updated")?(delete g.state,delete g.layer,g.updated=!0,p.options(g),y.geoTrigger(a.annotation.update,{annotation:p})):(g.state=o.state.done,g.layer=y,g.updated="new",y.addAnnotation(s.createAnnotation(m,g),null))}})},this.validateAttribute=function(t,e){var n;if(void 0!==t&&null!==t){switch(e){case"angle":if(""===t)break;if(!(n=/^\s*([-.0-9eE]+)\s*(deg|rad|grad|turn)?\s*$/.exec((""+t).toLowerCase()))||!isFinite(n[1]))return;var i="grad"===n[2]?Math.PI/200:"deg"===n[2]?Math.PI/180:"turn"===n[2]?2*Math.PI:1;t=+n[1]*i;break;case"boolean":t=!!t&&["false","no","off"].indexOf((""+t).toLowerCase())<0;break;case"booleanOrNumber":if(!t&&0!==t&&""!==t||["true","false","off","on","no","yes"].indexOf((""+t).toLowerCase())>=0)t=!!t&&["false","no","off"].indexOf((""+t).toLowerCase())<0;else{if(!v.isNonNullFinite(t))return;t=+t}break;case"coordinate2":if(""===t)break;if(t&&v.isNonNullFinite(t.x)&&v.isNonNullFinite(t.y)){t.x=+t.x,t.y=+t.y;break}try{t=JSON.parse(t)}catch(t){}if(t&&v.isNonNullFinite(t.x)&&v.isNonNullFinite(t.y)){t.x=+t.x,t.y=+t.y;break}if(Array.isArray(t)&&v.isNonNullFinite(t[0])&&v.isNonNullFinite(t[1])){t={x:+t[0],y:+t[1]};break}if(!(n=/^\s*([-.0-9eE]+)(?:\s+|\s*,)\s*([-.0-9eE]+)\s*$/.exec(""+t))||!isFinite(n[1])||!isFinite(n[2]))return;t={x:+n[1],y:+n[2]};break;case"color":if(void 0===(t=v.convertColor(t))||void 0===t.r)return;break;case"number":if(!v.isNonNullFinite(t))return;t=+t;break;case"numberOrBlank":if(""===t)break;if(!v.isNonNullFinite(t))return;t=+t;break;case"opacity":if(""===t)return;if(t=+t,isNaN(t)||t<0||t>1)return;break;case"positive":if(t=+t,!isFinite(t)||t<=0)return;break;case"text":t=""+t}return t}},this._update=function(){if(y.timestamp()>M.timestamp()){var t=y.options("showLabels")?[]:null,e=y.options("clickToEdit")||y.mode()===y.modes.edit;l.each(C,function(t,e){l.each(e,function(t,e){e.data=[],delete e.feature.scaleOnZoom})}),l.each(T,function(n,i){var r=i.features();if(t){var o=i.labelRecord();o&&t.push(o)}l.each(r,function(t,n){void 0===C[t]&&(C[t]={}),l.each(n,function(n,r){if(C[t][n])(o=C[t][n].feature).selectionAPI()!==!!e&&(o.selectionAPI(e),e?(o.geoOn(a.feature.mouseon,y._handleMouseOn),o.geoOn(a.feature.mouseoff,y._handleMouseOff)):(o.geoOff(a.feature.mouseon,y._handleMouseOn),o.geoOff(a.feature.mouseoff,y._handleMouseOff)));else{var o=y.createFeature(n,{gcs:y.map().gcs(),selectionAPI:e});if(!o){var s="error_feature_"+n;return void(y[s]||(console.warn("Cannot create a "+n+" feature for annotations."),y[s]=!0))}e&&(o.geoOn(a.feature.mouseon,y._handleMouseOn),o.geoOn(a.feature.mouseoff,y._handleMouseOff));var u={};l.each(["closed","fill","fillColor","fillOpacity","line","lineCap","lineJoin","polygon","position","radius","stroke","strokeColor","strokeOffset","strokeOpacity","strokeWidth","uniformPolygon"],function(t,e){var n;void 0!==o.style()[e]&&(n=o.style.get(e)),u[e]=function(t,i,r,o){var a=t&&t.style?t.style:t&&t[2]&&t[2].style?t[2].style:r.style,s=a?a[e]:t;return v.isFunction(s)&&(s=s(t,i,r,o)),void 0===s&&n&&(s=n(t,i,r,o)),s}}),o.style(u),C[t][n]={feature:o,style:u,data:[]}}var c=r.data||r;Array.isArray(c)||(c=[c]),c.forEach(function(e){e.annotation=i,C[t][n].data.push(e),r.scaleOnZoom&&(C[t][n].feature.scaleOnZoom=!0)})})})}),l.each(C,function(t,e){l.each(e,function(t,e){e.feature.data(e.data)})}),y._updateLabels(t),M.modified()}return w.call(y,arguments),y},this._updateLabels=function(t){if(!t||!t.length)return y._removeLabelFeature(),y;if(!d){if(!(s.registries.features[y.rendererName()]||{}).text){var e=s.rendererForFeatures(["text"]);f=s.createLayer("feature",y.map(),{renderer:e}),y.addChild(f),f._update(),y.geoTrigger(a.layerAdd,{target:y,layer:f})}var n={};h.usedStyles.forEach(function(t){n[t]=function(e,n){return e.style&&void 0!==e.style[t]?e.style[t]:(y.options("defaultLabelStyle")||{})[t]}}),d=(f||y).createFeature("text",{style:n,gcs:y.map().gcs(),position:function(t){return t.position}})}return d.data(t),y},this._handleZoom=function(){var t,e=y.features();for(t=0;t<e.length;t+=1)e[t].scaleOnZoom&&e[t].modified()},this._removeLabelFeature=function(){return f&&(f._exit(),y.removeChild(f),y.geoTrigger(a.layerRemove,{target:y,layer:f}),f=d=null),d&&(y.removeFeature(d),d=null),y},this.draw=function(){return y._update(),_.call(y),y},this._init=function(){return x.call(y),y.map().interactor()||y.map().interactor(m({actions:[]})),y.geoOn(a.actionselection,y._processAction),y.geoOn(a.actionmove,y._processAction),y.geoOn(a.actionup,y._processAction),y.geoOn(a.mouseclick,y._handleMouseClick),y.geoOn(a.mousemove,y._handleMouseMove),y.geoOn(a.zoom,y._handleZoom),y},this._exit=function(){return p&&p.reset(),y._removeLabelFeature(),b.call(y),T=[],C=[],y},y};i(d,r),s.registerLayer("annotation",d),t.exports=d},function(e,n){if(void 0===t){var i=new Error('Cannot find module "hammerjs"');throw i.code="MODULE_NOT_FOUND",i}e.exports=t},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8];return t[0]=a*c-s*l,t[1]=r*l-i*c,t[2]=i*s-r*a,t[3]=s*u-o*c,t[4]=n*c-r*u,t[5]=r*o-n*s,t[6]=o*l-a*u,t[7]=i*u-n*l,t[8]=n*a-i*o,t}},function(t,e){t.exports=function(t){var e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}},function(t,e){t.exports=function(){var t=new Float32Array(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*(l*o-a*u)+n*(a*s-l*r)+i*(u*r-o*s)}},function(t,e){t.exports=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8])}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=n+n,s=i+i,u=r+r,l=n*a,c=i*a,h=i*s,d=r*a,f=r*s,p=r*u,m=o*a,g=o*s,v=o*u;return t[0]=1-h-p,t[3]=c-v,t[6]=d+g,t[1]=c+v,t[4]=1-l-p,t[7]=f-m,t[2]=d-g,t[5]=f+m,t[8]=1-l-h,t}},function(t,e){t.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=c*a-s*l,d=-c*o+s*u,f=l*o-a*u,p=n*h+i*d+r*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*i+r*l)*p,t[2]=(s*i-r*a)*p,t[3]=d*p,t[4]=(c*n-r*u)*p,t[5]=(-s*n+r*o)*p,t[6]=f*p,t[7]=(-l*n+i*u)*p,t[8]=(a*n-i*o)*p,t):null}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=n[0],f=n[1],p=n[2],m=n[3],g=n[4],v=n[5],y=n[6],x=n[7],b=n[8];return t[0]=d*i+f*a+p*l,t[1]=d*r+f*s+p*c,t[2]=d*o+f*u+p*h,t[3]=m*i+g*a+v*l,t[4]=m*r+g*s+v*c,t[5]=m*o+g*u+v*h,t[6]=y*i+x*a+b*l,t[7]=y*r+x*s+b*c,t[8]=y*o+x*u+b*h,t}},function(t,e){t.exports=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],m=e[13],g=e[14],v=e[15],y=n*s-i*a,x=n*u-r*a,b=n*l-o*a,_=i*u-r*s,w=i*l-o*s,M=r*l-o*u,A=c*m-h*p,T=c*g-d*p,C=c*v-f*p,E=h*g-d*m,O=h*v-f*m,S=d*v-f*g,P=y*S-x*O+b*E+_*C-w*T+M*A;return P?(P=1/P,t[0]=(s*S-u*O+l*E)*P,t[1]=(u*C-a*S-l*T)*P,t[2]=(a*O-s*C+l*A)*P,t[3]=(r*O-i*S-o*E)*P,t[4]=(n*S-r*C+o*T)*P,t[5]=(i*C-n*O-o*A)*P,t[6]=(m*M-g*w+v*_)*P,t[7]=(g*b-p*M-v*x)*P,t[8]=(p*w-m*b+v*y)*P,t):null}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=Math.sin(n),f=Math.cos(n);return t[0]=f*i+d*a,t[1]=f*r+d*s,t[2]=f*o+d*u,t[3]=f*a-d*i,t[4]=f*s-d*r,t[5]=f*u-d*o,t[6]=l,t[7]=c,t[8]=h,t}},function(t,e){t.exports=function(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}},function(t,e){t.exports=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}},function(t,e){t.exports=function(t,e,n){var i=e[0],r=e[1],o=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=n[0],f=n[1];return t[0]=i,t[1]=r,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=d*i+f*a+l,t[7]=d*r+f*s+c,t[8]=d*o+f*u+h,t}},function(t,e){t.exports=function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}},function(t,n){if(void 0===e){var i=new Error('Cannot find module "d3"');throw i.code="MODULE_NOT_FOUND",i}t.exports=e},function(t,e,n){"use strict";var i=n(0),r=n(13),o=n(1).registerRenderer,a=function t(e){if(!(this instanceof t))return new t(e);r.call(this,e),e=e||{};var n=this;return this.api=function(){return"dom"},this._init=function(){var t=n.layer().node();return!n.canvas()&&t&&t.length&&n.canvas(t[0]),n},this._init(e),this};i(a,r),o("dom",a),t.exports=a},function(t,e,n){"use strict";var i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=n(0),a=n(1).registerFileReader,s=n(124),u=function t(e){if(!(this instanceof t))return new t(e);var o=n(2),a=n(4).convertColor,u=this,l=i({},e,{pointStyle:i({fill:!0,fillColor:"#ff7800",fillOpacity:.8,stroke:!0,strokeColor:"#000",strokeWidth:1,strokeOpacity:1,radius:8},e.pointStyle),lineStyle:i({strokeColor:"#ff7800",strokeWidth:4,strokeOpacity:.5,strokeOffset:0,lineCap:"butt",lineJoin:"miter",closed:!1},e.lineStyle),polygonStyle:i({fill:!0,fillColor:"#b0de5c",fillOpacity:.8,stroke:!0,strokeColor:"#999999",strokeWidth:2,strokeOpacity:1},e.polygonStyle)});s.call(this,l),this.canRead=function(t){if(t instanceof File||t instanceof Blob)return!!("application/json"===t.type||t.name&&t.name.match(/\.json$/));if("string"==typeof t){try{JSON.parse(t)}catch(t){return!1}return!0}try{if(Array.isArray(u._featureArray(t)))return!0}catch(t){}return!1},this._readObject=function(t,e,n){var i;function r(t){try{i=JSON.parse(t),e(i)}catch(n){i||o.ajax({type:"GET",url:t,dataType:"text"}).done(function(t){try{i=JSON.parse(t),e(i)}catch(t){i||e(!1)}}).fail(function(){e(!1)})}}t instanceof File||t instanceof Blob?u._getString(t,r,n):"string"==typeof t?r(t):e(t)},this._featureArray=function(t){var e,n=[];switch(t.type){case"FeatureCollection":e=t.features;break;case"Feature":e=[t];break;case"GeometryCollection":e=t.geometries.map(function(t){return{type:"Feature",geometry:t,properties:{}}});break;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":e=[{type:"Feature",geometry:t,properties:{}}];break;default:throw new Error("Invalid json type")}return e.forEach(function(t){Array.prototype.push.apply(n,u._feature(t))}),n=n.filter(function(t){return t.geometry&&t.geometry.coordinates&&t.geometry.coordinates.length})},this._feature=function(t){if("Feature"!==t.type)throw new Error("Invalid feature object");switch(t.geometry.type){case"Point":case"LineString":case"Polygon":return[t];case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.geometry.coordinates.map(function(e){return{type:"Feature",geometry:{type:t.geometry.type.replace("Multi",""),coordinates:e},properties:t.properties}});default:throw new Error("Invalid geometry type")}},this._position=function(t){return{x:t[0],y:t[1],z:t[2]||0}},this._style=function(t,e){var n=t.toLowerCase().match(/color$/);return n&&(e=a(e)),function(i,r,o,s){var u;return void 0!==(u=void 0!==o&&o.properties?o.properties:i.properties)&&u.hasOwnProperty(t)?n?a(u[t]):u[t]:e}},this.read=function(t,e,n){var o=new Promise(function(o,a){u._readObject(t,function(t){if(!1===t)return e&&e(t),void a(new Error("Failed to parse GeoJSON"));var n=void 0,s=[],c=void 0,h=void 0,d=void 0,f=void 0;try{n=u._featureArray(t)}catch(t){return void a(t)}(c=n.filter(function(t){return"Point"===t.geometry.type})).length&&(f=u.layer().createFeature("point"))&&(f.data(c).position(function(t){return u._position(t.geometry.coordinates)}).style([{}].concat(Object.keys(l.pointStyle)).reduce(function(t,e){return i(r({},e,c.some(function(t){return t.properties&&void 0!==t.properties[e]})?u._style(e,l.pointStyle[e]):l.pointStyle[e]),t)})),s.push(f)),(h=n.filter(function(t){return"LineString"===t.geometry.type})).length&&(f=u.layer().createFeature("line"))&&(f.data(h).line(function(t){return t.geometry.coordinates}).position(u._position).style([{}].concat(Object.keys(l.lineStyle)).reduce(function(t,e){return i(r({},e,h.some(function(t){return t.properties&&void 0!==t.properties[e]})?u._style(e,l.lineStyle[e]):l.lineStyle[e]),t)})),s.push(f)),(d=n.filter(function(t){return"Polygon"===t.geometry.type})).length&&(f=u.layer().createFeature("polygon"))&&(f.data(d).polygon(function(t,e){return{outer:t.geometry.coordinates[0],inner:t.geometry.coordinates.slice(1)}}).position(u._position).style([{}].concat(Object.keys(l.polygonStyle)).reduce(function(t,e){return i(r({},e,d.some(function(t){return t.properties&&void 0!==t.properties[e]})?u._style(e,l.polygonStyle[e]):l.polygonStyle[e]),t)})),s.push(f)),e&&e(s),o(s)},n)});return u.addPromise(o),o}};o(u,s),a("geojsonReader",u),a("jsonReader",u),t.exports=u},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(14),a=function t(e){if(!(this instanceof t))return new t(e);if(void 0===(e=e||{}).node||null===e.node)return console.warn("map creation requires a node"),this;o.call(this,e);var r,a,s,u,l,c=n(118),h=n(7),d=n(4),f=n(1),p=n(6),m=n(51),g=n(128),v=this,y=this._exit,x=i(e.node),b=e.width||x.width()||512,_=e.height||x.height()||512,w=void 0===e.gcs?"EPSG:3857":e.gcs,M=void 0===e.ingcs?"EPSG:4326":e.ingcs,A={x:0,y:0},T=void 0===e.zoom?4:e.zoom,C=e.rotation?e.rotation:0,E=null,O=null,S={min:0,max:16,origMin:0},P=null,k=null,R=!!e.discreteZoom,j="function"==typeof e.allowRotation?e.allowRotation:void 0===e.allowRotation||!!e.allowRotation,L=e.maxBounds||{},D=e.camera||c(),I=e.animationQueue||[],F=void 0===e.autoResize||e.autoResize,N=((L.left||0)+(L.right||0))/2,z=((L.bottom||0)+(L.top||0))/2;function B(t,e){var n=t.zIndex(),i=e.zIndex();if(n!==i)return n-i;var r=t.node()[0],o=e.node()[0],a=r&&r.parentNode,s=o&&o.parentNode;if(a&&s&&a===s){var u=Array.from(a.children),l=u.indexOf(r),c=u.indexOf(o);if(l>=0&&c>=0)return l-c}return a?-1:s?1:0}function U(t,e,n,i){t.globalAlpha=e;var r=n.css("transform");r&&"matrix("===r.substr(0,7)?t.setTransform.apply(t,r.substr(7,r.length-8).split(",").map(parseFloat)):t.setTransform(1,0,0,1,0,0),t.drawImage(i,0,0)}function G(){for(var t=I.splice(0,I.length),e=1;e<t.length;e+=1)try{t[e].apply(v,arguments)}catch(t){console.error(t)}}function V(t,e,n){var i=e.width/2,r=e.height/2,o=Math.sin(n),a=Math.cos(n),s={},u={},l={},c={};return s.x=t.x+-i*a- -r*o,s.y=t.y+-i*o+-r*a,u.x=t.x+i*a- -r*o,u.y=t.y+i*o+-r*a,l.x=t.x+-i*a-r*o,l.y=t.y+-i*o+r*a,c.x=t.x+i*a-r*o,c.y=t.y+i*o+r*a,{left:Math.min(s.x,u.x,l.x,c.x),right:Math.max(s.x,u.x,l.x,c.x),bottom:Math.min(s.y,u.y,l.y,c.y),top:Math.max(s.y,u.y,l.y,c.y)}}function q(t,e){void 0===e&&(e=C);var n=function(t){var e,n,i=t.right-t.left,r=t.top-t.bottom,o=Math.abs(i/r),a=b/_;return o>a?(e=1,n=o/a):(n=1,e=a/o),{x:e,y:n}}(t=function(t,e){return e&&(t=V({x:(t.left+t.right)/2,y:(t.top+t.bottom)/2},{width:Math.abs(t.left-t.right),height:Math.abs(t.top-t.bottom)},e)),t}(t,e));return n.y>n.x?-Math.log2(Math.abs(t.right-t.left)*n.x/(b*r)):-Math.log2(Math.abs(t.top-t.bottom)*n.y/(_*r))}function H(){S.min=u?Math.max(S.origMin,q(L)):S.origMin}function W(t,e){return t=Math.round(1e6*t)/1e6,t=Math.max(Math.min(S.max,t),S.min),R&&!e&&(t=Math.round(t))<S.min&&(t=Math.ceil(S.min)),t}function X(t,e,n){if(!j)return 0;if(e||"function"!=typeof j||(t=j(t)),!n){var i=2*Math.PI;t=t%i+(t>=0?0:i),Math.min(Math.abs(t),Math.abs(t-i))<1e-5&&(t=0)}return t}function Q(t,e,n,r){if(!a&&!s)return t;var o,u,l=L;if(e){l=i.extend({},L);var c,h,d=Math.abs(t.right-t.left),f=Math.abs(t.top-t.bottom),p=Math.abs(Math.sin(e)),m=Math.abs(Math.cos(e));if(t.width&&t.height)c=t.width,h=t.height;else if(Math.abs(p-m)<5e-4)if(b&&_){var g=Math.abs(b/_),v=Math.pow(1+Math.pow(g,2),.5);h=(c=Math.max(d,f)/v)*g}else c=d*m,h=f*p;else c=(m*d-p*f)/(m*m-p*p),h=(m*f-p*d)/(m*m-p*p);var y=d-Math.max(m*c,p*h),x=f-Math.max(m*h,p*c);l.left-=y,l.right+=y,l.top+=x,l.bottom-=x}return r&&(l={left:l.left-(t.right-t.left)/2,right:l.right+(t.right-t.left)/2,top:l.top-(t.bottom-t.top)/2,bottom:l.bottom+(t.bottom-t.top)/2}),a&&(t.right-t.left>l.right-l.left?o=l.left-(t.right-t.left-(l.right-l.left))/2-t.left:t.left<l.left?o=l.left-t.left:t.right>l.right&&(o=l.right-t.right),o&&(!n||n.x*o>0)&&(n&&Math.abs(o)>Math.abs(n.x*n.unit)&&(o=Math.abs(n.x*n.unit)*o/Math.abs(o)),t={left:t.left+=o,right:t.right+=o,top:t.top,bottom:t.bottom})),s&&(t.top-t.bottom>l.top-l.bottom?u=l.bottom-(t.top-t.bottom-(l.top-l.bottom))/2-t.bottom:t.top>l.top?u=l.top-t.top:t.bottom<l.bottom&&(u=l.bottom-t.bottom),u&&(!n||-n.y*u>0)&&(n&&Math.abs(u)>Math.abs(n.y*n.unit)&&(u=Math.abs(n.y*n.unit)*u/Math.abs(u)),t={top:t.top+=u,bottom:t.bottom+=u,left:t.left,right:t.right})),t}function K(t,e){if(D.rotation=e||0,t.width&&t.height&&e){var n=(t.left+t.right)/2,i=(t.top+t.bottom)/2;D.viewFromCenterSizeRotation({x:n,y:i},t,e)}else D.bounds=t;A={x:(D.bounds.left+D.bounds.right)/2,y:(D.bounds.top+D.bounds.bottom)/2}}function Z(){v.size({width:x.width(),height:x.height()})}return L.left=h.transformCoordinates(L.gcs||M,w,{x:void 0!==L.left?L.left:-180,y:z}).x,L.right=h.transformCoordinates(L.gcs||M,w,{x:void 0!==L.right?L.right:180,y:z}).x,L.top=void 0!==L.top?h.transformCoordinates(L.gcs||M,w,{x:N,y:L.top}).y:L.right,L.bottom=void 0!==L.bottom?h.transformCoordinates(L.gcs||M,w,{x:N,y:L.bottom}).y:L.left,r=e.unitsPerPixel||(L.right-L.left)/256,D.viewport={width:b,height:_,left:x.offset().left,top:x.offset().top},e.center=d.normalizeCoordinates(e.center),a=void 0!==e.clampBoundsX&&e.clampBoundsX,s=void 0===e.clampBoundsY||e.clampBoundsY,u=void 0===e.clampZoom||e.clampZoom,this.unitsPerPixel=function(t,e){return t=t||0,e?(r=Math.pow(2,t)*e,v.draw(),v):Math.pow(2,-t)*r},this.animationQueue=function(t){if(void 0===t)return I;if(t!==I){if(I.length){t.length&&t[0]!==I[0]&&window.cancelAnimationFrame(I[0]);for(var e=t.length?1:0;e<I.length;e+=1)t.push(I[e])}I=t}return v},this.autoResize=function(t){return void 0===t?F:(t!==F&&(i(window).off("resize",Z),(F=t)&&i(window).on("resize",Z)),v)},this.clampBoundsX=function(t){return void 0===t?a:(t!==a&&(a=!!t,v.pan({x:0,y:0})),v)},this.clampBoundsY=function(t){return void 0===t?s:(t!==s&&(s=!!t,v.pan({x:0,y:0})),v)},this.clampZoom=function(t){return void 0===t?u:(t!==u&&(u=!!t,H(),v.zoom(T)),v)},this.allowRotation=function(t){return void 0===t?j:("function"!=typeof t&&(t=!!t),t!==j&&(j=t,v.rotation(C)),v)},this.origin=function(){return i.extend({},l)},this.camera=function(){return D},this.gcs=function(t){if(void 0===t)return w;if(t!==w){var e=v.center(void 0,void 0);w=t,H();var n=W(T);n!==T&&v.zoom(n),v.center(e,void 0)}return v},this.ingcs=function(t){return void 0===t?M:(M=t,v)},this.node=function(){return x},this.zoom=function(t,e,n){if(void 0===t)return T;var i,r,o=e&&(e.mapgcs||e.geo)&&e.map,a=o;if((t=W(t,n))===T)return v;if(T=t,r=v.boundsFromZoomAndCenter(t,A,C,null,n,a),v.modified(),K(r,C),i={zoomLevel:T,screenPosition:e?e.map:void 0},v.geoTrigger(p.zoom,i),o){var s=v.gcsToDisplay(e.mapgcs||e.geo,e.mapgcs?null:void 0);v.pan({x:e.map.x-s.x,y:e.map.y-s.y},n,!0)}else v.pan({x:0,y:0},n);return v},this.pan=function(t,e,n){var i={screenDelta:t};if(t.x||t.y){var r=v.unitsPerPixel(T),o=Math.sin(C),a=Math.cos(C);D.pan({x:(t.x*a- -t.y*o)*r,y:(t.x*o+-t.y*a)*r})}var s=D.bounds;if((s=Q(s,C,"limited"===n?{x:t.x,y:t.y,unit:r}:void 0,!0===n))!==D.bounds){var u=v.gcsToDisplay({x:D.bounds.left,y:D.bounds.top},null);K(s=v.boundsFromZoomAndCenter(T,{x:(s.left+s.right)/2,y:(s.top+s.bottom)/2},C,null,e,!0),C);var l=v.gcsToDisplay({x:D.bounds.left,y:D.bounds.top},null);i.screenDelta.x+=l.x-u.x,i.screenDelta.y+=l.y-u.y}return A=D.displayToWorld({x:b/2,y:_/2}),v.geoTrigger(p.pan,i),v.modified(),v},this.rotation=function(t,e,n){if(void 0===t)return C;var i=e&&e.geo&&e.map;if((t=X(t,n))===C)return v;C=t;var r=v.boundsFromZoomAndCenter(T,A,C,null,n,!0);v.modified(),K(r,C);var o={rotation:C,screenPosition:e?e.map:void 0};if(v.geoTrigger(p.rotate,o),i){var a=v.gcsToDisplay(e.geo);v.pan({x:e.map.x-a.x,y:e.map.y-a.y},void 0,!0)}else v.pan({x:0,y:0},void 0,!0);return H(),v.zoom(T,void 0,n),v},this.center=function(t,e,n,r){var o;return void 0===t?o=i.extend({},v.worldToGcs(A,e)):(o=v.gcsToWorld(t,e),K(v.boundsFromZoomAndCenter(T,o,C,null,n,r),C),v.modified(),v.geoTrigger(p.pan,{screenDelta:{x:0,y:0}}),v)},this.createLayer=function(t,e){e=e||{};var n=f.createLayer(t,v,e);return n&&(v.addChild(n),v.children().forEach(function(t){t instanceof g&&t.moveToTop()}),n._update(),v.modified(),v.geoTrigger(p.layerAdd,{target:v,layer:n})),n},this.deleteLayer=function(t){return null!==t&&void 0!==t&&(t._exit(),v.removeChild(t),v.modified(),v.geoTrigger(p.layerRemove,{target:v,layer:t})),t},this.size=function(t){if(void 0===t)return{width:b,height:_};var e=v.center();b=t.width||b,_=t.height||_,H();var n=W(T);return n!==T&&v.zoom(n),v.camera().viewport={width:b,height:_,left:x.offset().left,top:x.offset().top},v.center(e),v.geoTrigger(p.resize,{target:v,width:b,height:_}),v.modified(),v},this.rotatedSize=function(){if(!this.rotation())return{width:b,height:_};var t=V({x:0,y:0},{width:b,height:_},v.rotation());return{width:Math.abs(t.right-t.left),height:Math.abs(t.top-t.bottom)}},this.gcsToWorld=function(t,e){return Array.isArray(t)?t.map(function(t){return v.gcsToWorld(t,e)}):((e=null===e?w:void 0===e?M:e)!==w&&(t=h.transformCoordinates(e,w,t)),l.x||l.y||l.z?t=h.affineForward({origin:l},[t])[0]:"z"in t||(t={x:t.x,y:t.y,z:0}),t)},this.worldToGcs=function(t,e){return Array.isArray(t)?t.map(function(t){return v.worldToGcs(t,e)}):(l.x||l.y||l.z?t=h.affineInverse({origin:l},[t])[0]:"z"in t||(t={x:t.x,y:t.y,z:0}),(e=null===e?w:void 0===e?M:e)!==w&&(t=h.transformCoordinates(w,e,t)),t)},this.gcsToDisplay=function(t,e){return t=v.gcsToWorld(t,e),v.worldToDisplay(t)},this.worldToDisplay=function(t){return Array.isArray(t)?t.map(function(t){return D.worldToDisplay(t)}):D.worldToDisplay(t)},this.displayToGcs=function(t,e){return t=v.displayToWorld(t),v.worldToGcs(t,e)},this.displayToWorld=function(t){return Array.isArray(t)?t.map(function(t){return D.displayToWorld(t)}):D.displayToWorld(t)},this.draw=function(){var t,e=v.children();for(v.geoTrigger(p.draw,{target:v}),v._update(),t=0;t<e.length;t+=1)e[t].draw();return v.geoTrigger(p.drawEnd,{target:v}),v},this.fileReader=function(t,e){return void 0===t?E:("string"==typeof t?((e=e||{}).layer||(e.layer=v.createLayer("feature",i.extend({},e))),e.renderer=e.layer.renderer().api(),E=f.createFileReader(t,e)):E=t,v)},this._init=function(){if(void 0===x||null===x)throw new Error("Map require DIV node");return x.data("data-geojs-map")&&i.isFunction(x.data("data-geojs-map").exit)&&x.data("data-geojs-map").exit(),x.addClass("geojs-map"),x.data("data-geojs-map",v),v},this._update=function(t){var e,n=v.children();for(e=0;e<n.length;e+=1)n[e]._update(t);return v},this.exit=function(){var t,e=v.children();for(t=e.length-1;t>=0;t-=1)e[t]._exit(),v.removeChild(e[t]);v.interactor()&&(v.interactor().destroy(),v.interactor(null)),I=[],v.node().data("data-geojs-map",null),v.node().off(".geo"),v.node().empty(),i(window).off("resize",Z),y()},this.interactor=function(t){return void 0===t?O:(O&&O!==t&&O.destroy(),(O=t)&&(x.attr("tabindex")||x.attr("tabindex",0),O.map(v)),v)},this.zoomRange=function(t,e){return void 0===t?i.extend({},S):(void 0!==t.max&&(S.max=t.max),void 0!==t.min&&(S.min=S.origMin=t.min),H(),e||v.zoom(T),v)},this.transition=function(t,e,n){if(void 0===t)return P;if(P){var r=i.extend(!0,{},P.end);return r.center&&w!==M&&(r.center=h.transformCoordinates(w,M,r.center)),k=i.extend({},r||{},k||{},t),v}var o=v.unitsPerPixel(0);function a(t){return Math.pow(2,-(t+1))*o*_}var s={center:void 0,zoom:v.zoom(),rotation:v.rotation(),duration:1e3,ease:function(t){return t},interp:function(t,e){return function(n){var r=[];return i.each(t,function(i){r.push(function(t,e,n){return t+(e-t)*n}(t[i],e[i],n))}),r}},done:null,zCoord:!0};function u(e){var n=P.done,i=k;if(!0===P.cancel)return v.geoTrigger(p.transitioncancel,t),n&&n({cancel:!0,source:P.cancelSource,transition:P}),P=null,void(k&&(i=k,k=null,v.transition(i,void 0,e)));if(P.start.time||(P.start.time=e,P.end.time=e+t.duration),P.time=e-P.start.time,e>=P.end.time||i){if(!i){if(P.end.center){var r=T!==W(P.end.zoom);v.center(P.end.center,null,r,r)}v.zoom(P.end.zoom,P.zoomOrigin),v.rotation(X(P.end.rotation))}return v.geoTrigger(p.transitionend,t),n&&n({next:!!i}),P=null,void(k&&(i=k,k=null,v.transition(i,void 0,e)))}var a=P.ease((e-P.start.time)/t.duration),s=P.interp(a);P.zCoord&&(s[2]=function(t){return-Math.log2(t/o/_)-1}(s[2])),W(s[2],!0)===T?v.center({x:s[0],y:s[1]},null,!0,!0):(A=v.gcsToWorld({x:s[0],y:s[1]},null,!0,!0),v.zoom(s[2],P.zoomOrigin,!0)),v.rotation(s[3],void 0,!0),v.scheduleAnimationFrame(u)}return t.center&&(e=null===e?w:void 0===e?M:e,(t=i.extend(!0,{},t)).center=d.normalizeCoordinates(t.center),e!==w&&(t.center=h.transformCoordinates(e,w,t.center))),t=i.extend(!0,{},s,t),(P={start:{center:v.center(void 0,null),zoom:v.zoom(),rotation:v.rotation()},end:{center:t.center,zoom:W(t.zoom),rotation:X(t.rotation,void 0,!0)},ease:t.ease,zCoord:t.zCoord,done:t.done,duration:t.duration,zoomOrigin:t.zoomOrigin}).interp=t.interp([P.start.center.x,P.start.center.y,t.zCoord?a(P.start.zoom):P.start.zoom,P.start.rotation],[P.end.center?P.end.center.x:P.start.center.x,P.end.center?P.end.center.y:P.start.center.y,t.zCoord?a(P.end.zoom):P.end.zoom,P.end.rotation]),v.geoTrigger(p.transitionstart,t),p.cancelNavigation?(P=null,v.geoTrigger(p.transitionend,t),v):(p.cancelAnimation?(t.duration=0,u(0)):n?u(n):v.scheduleAnimationFrame(u),v)},this.transitionCancel=function(t){return!(!P||!0===P.cancel&&!k)&&(P.cancel=!0,P.cancelSource=t||P.cancelSource||"",k=null,!0)},this.bounds=function(t,e){var n;if(e=null===e?w:void 0===e?M:e,void 0!==t){if(e!==w){var i=h.transformCoordinates(e,w,[{x:t.left,y:t.top},{x:t.right,y:t.bottom}]);t={left:i[0].x,top:i[0].y,right:i[1].x,bottom:i[1].y}}t=Q(t,C),n=v.zoomAndCenterFromBounds(t,C,null),v.zoom(n.zoom),v.center(n.center,null)}return v.boundsFromZoomAndCenter(T,A,C,e,!0)},this.maxBounds=function(t,e){if(e=null===e?w:void 0===e?M:e,void 0===t)return{left:h.transformCoordinates(w,e,{x:L.left,y:0}).x,right:h.transformCoordinates(w,e,{x:L.right,y:0}).x,bottom:h.transformCoordinates(w,e,{x:0,y:L.bottom}).y,top:h.transformCoordinates(w,e,{x:0,y:L.top}).y};var n=((t.left||0)+(t.right||0))/2,i=((t.bottom||0)+(t.top||0))/2;return void 0!==t.left&&(L.left=h.transformCoordinates(e,w,{x:t.left,y:i}).x),void 0!==t.right&&(L.right=h.transformCoordinates(e,w,{x:t.right,y:i}).x),void 0!==t.bottom&&(L.bottom=h.transformCoordinates(e,w,{x:n,y:t.bottom}).y),void 0!==t.top&&(L.top=h.transformCoordinates(e,w,{x:n,y:t.top}).y),H(),v.zoom(T),v.pan({x:0,y:0}),v},this.zoomAndCenterFromBounds=function(t,e,n){var i,r;if((n=null===n?w:void 0===n?M:n)!==w){var o=h.transformCoordinates(n,w,[{x:t.left,y:t.top},{x:t.right,y:t.bottom}]);t={left:o[0].x,top:o[0].y,right:o[1].x,bottom:o[1].y}}if(t.left>=t.right||t.bottom>=t.top)throw new Error("Invalid bounds provided");return r=W(q(t,e)),i={x:((t=Q(t,e)).left+t.right)/2-l.x,y:(t.top+t.bottom)/2-l.y},n!==w&&(i=h.transformCoordinates(w,n,i)),{zoom:r,center:i}},this.boundsFromZoomAndCenter=function(t,e,n,i,r,o){var a,s,u,c,d,f;if(i=null===i?w:void 0===i?M:i,t=W(t,r),f=v.unitsPerPixel(t),e=v.gcsToWorld(e,null),u=(a=b*f)/2,c=(s=_*f)/2,n?(e.x+=l.x,e.y+=l.y,(d=V(e,{width:a,height:s},n)).width=a,d.height=s,d=Q(d,n,void 0,o)):d=Q(d={left:e.x-u+l.x,right:e.x+u+l.x,bottom:e.y-c+l.y,top:e.y+c+l.y},0,void 0,o),i!==w){var p=h.transformCoordinates(w,i,[[d.left,d.top],[d.right,d.bottom]]);d={left:p[0][0],top:p[0][1],right:p[1][0],bottom:p[1][1]}}return d.width=a,d.height=s,d},this.discreteZoom=function(t){return void 0===t?R:(R!==(t=!!t)&&((R=t)&&v.zoom(Math.round(v.zoom())),v.interactor()&&v.interactor().options({discreteZoom:R})),v)},this.layers=this.children,this.sortedLayers=function(){return v.children().sort(B)},this.listSceneObjects=function(t){var e=[];return(t=t||v.sortedLayers()).forEach(function(t){if(e.indexOf(t)<0&&(e.push(t),t.children)){var n=t.children();n.length&&(e=e.concat(v.listSceneObjects(n)))}}),e},this.updateAttribution=function(){v.node().find(".geo-attribution").remove();var t=i("<div/>").addClass("geo-attribution").on("mousedown",function(t){t.stopPropagation()});return v.children().forEach(function(e){var n=e.attribution();n&&i("<span/>").addClass("geo-attribution-layer").html(n).appendTo(t)}),i("span",t).length&&t.appendTo(v.node()),v},this.screenshot=function(t,e,n,r){var o;if(!t||Array.isArray(t)||t.renderer||(e=e||t.type,n=n||t.encoderOptions,r=r||t,t=t.layers),(r=r||{}).wait){var a=i.extend({},r,{wait:!1});o=i.Deferred();var s=function(){window.requestAnimationFrame(function(){o.resolve()})};return"idle"===r.wait?v.onIdle(s):s(),o.then(function(){return v.screenshot(t,e,n,a)})}o=i.when(),t?Array.isArray(t)||(t=[t]):(t=v.layers(),null!==r.attribution&&void 0!==r.attribution||(r.attribution=!0)),t=(t=t.filter(function(t){return v.layers().indexOf(t)>=0&&t.opacity()>0&&(!t.visible||t.visible())})).sort(B);var u=document.createElement("canvas");u.width=b,u.height=_;var l=u.getContext("2d");if(!1!==r.background&&null!==r.background){var c=r.background;void 0===r.background&&(l.fillStyle="white",l.fillRect(0,0,u.width,u.height),v.node().parents().get().reverse().forEach(function(t){(c=window.getComputedStyle(t).backgroundColor)&&"transparent"!==c&&(l.fillStyle=c,l.fillRect(0,0,u.width,u.height))}),c=window.getComputedStyle(v.node()[0]).backgroundColor),c&&"transparent"!==c&&(l.fillStyle=c,l.fillRect(0,0,u.width,u.height))}return t.forEach(function(t){var e=t.opacity();t.node().children("canvas").each(function(){var n=i(this);o=o.then(function(){t.renderer()&&"webgl"===t.renderer().api()&&t.renderer()._renderFrame(),U(l,e,n,n[0])})}),!t.node().children().not("canvas").length&&t.node().children().length||t.renderer()&&"webgl"===t.renderer().api()||(o=o.then(function(){return d.htmlToImage(t.node(),1).done(function(t){U(l,1,i([]),t)})}))}),r.attribution&&v.node().find(".geo-attribution").each(function(){var t=i(this);o=o.then(function(){return d.htmlToImage(t,1).done(function(t){U(l,1,i([]),t)})})}),o=o.then(function(){var t=u;if("canvas"!==e)try{u=u.toDataURL(e,n)}catch(t){console.warn("Failed to convert screenshot to output",t);var r=i.Deferred();return r.reject(),r}return v.geoTrigger(p.screenshot.ready,{canvas:t,screenshot:u}),u})},this.scheduleAnimationFrame=function(t,e){I.length||I.push(window.requestAnimationFrame(G));var n=I.indexOf(t,1);if(n>=0){if(!e)return;if(I.splice(n,1),"remove"===e)return}return I.push(t),I[0]},this._init(e),this.node().on("dragover.geo",function(t){var e=t.originalEvent;v.fileReader()&&(e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy")}).on("drop.geo",function(t){var e,n,i=t.originalEvent,r=v.fileReader();function o(){v.draw()}if(r)for(i.stopPropagation(),i.preventDefault(),e=0;e<i.dataTransfer.files.length;e+=1)n=i.dataTransfer.files[e],r.canRead(n)&&r.read(n,o)}),l={x:0,y:0},this.zoomRange(e,!0),T=W(T),C=X(C),this.center(i.extend({},e.center||A),void 0),null!==e.interactor&&this.interactor(e.interactor||m({discreteZoom:R})),F&&i(window).on("resize",Z),v.geoOn([p.layerAdd,p.layerRemove],v.updateAttribution),this};a.create=function(t){var e=a(t),i=n(25);return e&&e.zoom?(t.data=t.data||[],t.layers=t.layers||[],t.layers.forEach(function(n){n.data=n.data||t.data,n.layer=i.create(e,n)}),e):(console.warn("Could not create map."),null)},r(a,o),t.exports=a},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(56),a=n(1),s=n(18),u=function t(e){var i=n(127);if(!(this instanceof t))return new t(e);void 0!==e.mapOpacity&&void 0===e.opacity&&(e.opacity=e.mapOpacity),o.call(this,e),this.mapOpacity=this.opacity,this._getTile=function(t,e){var n=e||t;return i({index:t,size:{x:this._options.tileWidth,y:this._options.tileHeight},queue:this._queue,overlap:this._options.tileOverlap,scale:this._options.tileScale,url:this._options.url.call(this,n.x,n.y,n.level||0,this._options.subdomains),crossDomain:this._options.crossDomain})}.bind(this)};u.defaults=i.extend({},o.defaults,{tileOffset:function(t){var e=256*Math.pow(2,t-1);return{x:e,y:e}},url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'Tile data &copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors'}),r(u,o),a.registerLayer("osm",u,[s.capabilities.image]),t.exports=u},function(t,e,n){"use strict"},function(t,e,n){"use strict";t.exports="0.19.4"},function(t,e,n){"use strict";t.exports="8549fd62a8855094cd27ed5f3765295b429efa31"},function(t,e,n){"use strict";t.exports={canvasRenderer:n(294),heatmapFeature:n(295),isolineFeature:n(296),lineFeature:n(297),pixelmapFeature:n(298),quadFeature:n(299),textFeature:n(300),tileLayer:n(301)}},function(t,e,n){"use strict";var i,r=n(0),o=n(1).registerRenderer,a=n(13),s=function t(e){var i=n(2);if(!(this instanceof t))return new t(e);e=e||{},a.call(this,e);var r=this,o=!0,s=this._init,u=this._exit;return this.clearCanvas=function(t){o=t},this.api=function(){return t.apiname},this._init=function(){if(r.initialized())return r;s.call(r);var t=e.canvas||i(document.createElement("canvas"));r.context2d=t[0].getContext("2d"),t.addClass("canvas-canvas"),i(r.layer().node().get(0)).append(t),r.canvas(t);var n=r.layer().map().size();return r._resize(0,0,n.width,n.height),r},this._resize=function(t,e,n,i){var o=r.canvas();return parseInt(o.attr("width"),10)===n&&parseInt(o.attr("height"),10)===i||(r._setWidthHeight(n,i),o.attr("width",n),o.attr("height",i),r._render()),r},this._render=function(){return r.layer().map().scheduleAnimationFrame(r._renderFrame),r},this._renderFrame=function(){var t,e=r.layer(),n=e.map(),i=n.size(),a=e.features?e.features():[];for(t=0;t<a.length;t+=1)if(a[t]._delayRender())return void r._render();for(o&&(r.context2d.setTransform(1,0,0,1,0,0),r.context2d.clearRect(0,0,i.width,i.height)),t=0;t<a.length;t+=1)a[t].visible()&&a[t]._renderOnCanvas(r.context2d,n)},this._exit=function(){r.canvas().remove(),u()},this};s.apiname="canvas",r(s,a),o("canvas",s),s.supported=function(){if(void 0===i){var t;try{t=document.createElement("canvas"),i=!(!t.getContext||!t.getContext("2d"))}catch(t){i=!1}t=void 0}return i},s.fallback=function(){return null},t.exports=s},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(126),a=n(9),s=n(4),u=function t(e){if(!(this instanceof t))return new t(e);o.call(this,e),n(19).call(this);var i,r,u,l,c,h=n(6),d=this,f=this._init,p=this._update,m=a();return this._computeGradient=function(){var t,e,n,i,r;if(r=d.style("color"),!d._grad||d._gradColors!==r){for(e in i=(n=(t=document.createElement("canvas")).getContext("2d")).createLinearGradient(0,0,0,256),t.width=1,t.height=256,r)i.addColorStop(e,s.convertColorToRGBA(r[e]));n.fillStyle=i,n.fillRect(0,0,1,256),d._grad=n.getImageData(0,0,1,256).data,d._gradColors=r}return d},this._createCircle=function(){var t,e,n,i,r,o;if(n=d.style("radius"),r=d.style("blurRadius"),o=d.style("gaussian"),!d._circle||d._circle.gaussian!==o||d._circle.radius!==n||d._circle.blurRadius!==r){if(e=(t=d._circle=document.createElement("canvas")).getContext("2d"),i=r+n,t.width=t.height=2*i,o){var a=e.createRadialGradient(i,i,0,i,i,i);a.addColorStop(0,"rgba(255,255,255,1)"),a.addColorStop(.1,"rgba(255,255,255,0.946)"),a.addColorStop(.2,"rgba(255,255,255,0.801)"),a.addColorStop(.3,"rgba(255,255,255,0.607)"),a.addColorStop(.4,"rgba(255,255,255,0.411)"),a.addColorStop(.5,"rgba(255,255,255,0.249)"),a.addColorStop(.6,"rgba(255,255,255,0.135)"),a.addColorStop(.7,"rgba(255,255,255,0.066)"),a.addColorStop(.8,"rgba(255,255,255,0.029)"),a.addColorStop(.9,"rgba(255,255,255,0.011)"),a.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=a,e.fillRect(0,0,2*i,2*i)}else e.shadowOffsetX=e.shadowOffsetY=2*i,e.shadowBlur=r,e.shadowColor="black",e.beginPath(),e.arc(-i,-i,n,0,2*Math.PI,!0),e.closePath(),e.fill();t.radius=n,t.blurRadius=r,t.gaussian=o,d._circle=t}return d},this._colorize=function(t,e){var n,o,a,s=new Uint32Array(e.buffer),l=t.length;for(i&&i.length===l||(i=new ArrayBuffer(l),r=new Uint8ClampedArray(i),u=new Uint32Array(i)),n=3,a=0;n<l;n+=4,a+=1)(o=t[n])&&(u[a]=s[o]);t.set(r)},this._renderPoints=function(t,e,n,i){var r,o,a,s=d.gcsPosition(),u=d.intensity(),l=d.minIntensity(),c=d.maxIntensity()-l||1;for(r=n.length-1;r>=0;r-=1)o=e.worldToDisplay(s[r]),(a=(u(n[r],r)-l)/c)<=0||(t.globalAlpha=a<.01?.01:a>1?1:a,t.drawImage(d._circle,o.x-i,o.y-i))},this._renderBinnedData=function(t,e,n,i,r){var o,a,s,u,l,c,h,f,p=d.gcsPosition(),m=d.intensity(),g=d.minIntensity(),v=d.maxIntensity()-g||1,y=e.size(),x=[],b=Math.ceil(i/r),_=Math.ceil(y.width/r)+2*b+2,w=Math.ceil(y.height/r)+2*b+2,M=n.length;for(o=0;o<M;o+=1)a=e.worldToDisplay(p[o]),isNaN(a.x)||isNaN(a.y)||(void 0===h&&(h=(a.x%r+r)%r,f=(a.y%r+r)%r),(u=Math.floor((a.x-h)/r)+b+1)<0||u>=_||(l=Math.floor((a.y-f)/r)+b+1)<0||l>=w||(s=(m(n[o],o)-g)/v)<=0||(s>1&&(s=1),x[l]=x[l]||[],u*=4,(c=x[l])[u]?(c[u]+=s,c[u+1]+=(1-c[u+1])*s,c[u+2]+=a.x*s,c[u+3]+=a.y*s):(c[u]=c[u+1]=s,c[u+2]=a.x*s,c[u+3]=a.y*s)));for(l=x.length-1;l>=0;l-=1)if(c=x[l])for(u=c.length-4;u>=0;u-=4)c[u]&&(s=c[u+1],t.globalAlpha=s<.01?.01:s>1?1:s,t.drawImage(d._circle,c[u+2]/c[u]-i,c[u+3]/c[u]-i))},this._renderOnCanvas=function(t,e){if(m.timestamp()<d.buildTime().timestamp()){var n,i,r=d.data()||[],o=d.style("radius")+d.style("blurRadius"),a=d.binned(),s=d.layer(),u=e.size();if(!0===a||"auto"===a)if(a=Math.max(Math.floor(o/8),3),"auto"===d.binned())Math.ceil((u.width+2*o)/a)*Math.ceil((u.height+2*o)/a)>=r.length&&(a=0);(a<1||isNaN(a))&&(a=!1),d._binned=a,t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,u.width,u.height),c="",e.scheduleAnimationFrame(d._setTransform,!1),s.canvas().css({transform:""}),d._createCircle(),d._computeGradient(),a?d._renderBinnedData(t,e,r,o,a):d._renderPoints(t,e,r,o),n=s.canvas()[0],i=t.getImageData(0,0,n.width,n.height),d._colorize(i.data,d._grad),t.putImageData(i,0,0),l={zoom:e.zoom(),gcsOrigin:e.displayToGcs({x:0,y:0},null),rotation:e.rotation(),lastScale:void 0,lastOrigin:{x:0,y:0},lastRotation:void 0},m.modified(),s.renderer().clearCanvas(!1)}return d},this._init=function(){return f.call(d,e),d.geoOn(h.pan,d._animatePan),d},this._update=function(){return p.call(d),(d.buildTime().timestamp()<=d.dataTime().timestamp()||d.updateTime().timestamp()<d.timestamp())&&d._build(),d.updateTime().modified(),d},this._setTransform=function(){d.layer()&&d.layer().canvas()&&d.layer().canvas()[0]&&(d.layer().canvas()[0].style.transform=c)},this._animatePan=function(){if(l){var t=d.layer().map(),e=t.zoom(),n=Math.pow(2,e-l.zoom),i=t.gcsToDisplay(l.gcsOrigin,null),r=t.rotation();if(l.lastScale!==n||l.lastOrigin.x!==i.x||l.lastOrigin.y!==i.y||l.lastRotation!==r){var o=" translate("+i.x+"px,"+i.y+"px) scale("+n+") rotate("+180*(r-l.rotation)/Math.PI+"deg)";t.scheduleAnimationFrame(d._setTransform),c=o,l.lastScale=n,l.lastOrigin.x=i.x,l.lastOrigin.y=i.y,l.lastRotation=r,l.timeout&&(window.clearTimeout(l.timeout),l.timeout=void 0),1===parseFloat(n.toFixed(4))&&0===parseFloat((r-l.rotation).toFixed(4))&&0===parseFloat(i.x.toFixed(1))&&0===parseFloat(i.y.toFixed(1))||(l.timeout=window.setTimeout(function(){l.timeout=void 0,d.buildTime().modified(),d.layer().draw()},d.updateDelay()))}}},d._init(e),this};i(u,o),r("canvas","heatmap",u),t.exports=u},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(55),a=function t(e){return this instanceof t?(e=e||{},o.call(this,e),n(19).call(this),this._init(e),this):new t(e)};i(a,o),r("canvas","isoline",a),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(24),a=function t(e){if(!(this instanceof t))return new t(e);var i=n(19);e=e||{},o.call(this,e),i.call(this);var r=this;return this._renderOnCanvas=function(t,e){var n,i,o,a,s,u=r.data(),l=r.position(),c=r.line(),h=r.style.get("strokeWidth"),d=r.style.get("strokeColor"),f=r.style.get("strokeOpacity"),p=r.style.get("lineCap"),m=r.style.get("lineJoin"),g=r.style.get("miterLimit")(u),v=r.style.get("closed"),y={},x={};u.forEach(function(e,u){if(!((i=c(e,u)).length<2)){for(x.closed=v(e,u),x.width=h(i[0],0,e,u),x.color=d(i[0],0,e,u),x.opacity=f(i[0],0,e,u),x.linecap=p(i[0],0,e,u),x.linejoin=m(i[0],0,e,u),x.strokeStyle="rgba("+255*x.color.g+", "+255*x.color.g+", "+255*x.color.b+", "+(void 0!==x.opacity?x.opacity:1)+")",y.strokeStyle===x.strokeStyle&&y.width===x.width&&y.linecap===x.linecap&&y.linejoin===x.linejoin&&y.miterlimit===x.miterlimit||(void 0!==y.strokeStyle&&t.stroke(),t.beginPath(),t.strokeStyle=x.strokeStyle,t.lineWidth=x.width,t.lineCap=x.linecap,t.lineJoin=x.linejoin,t.miterLimit=g),s=0;s<i.length;s+=1)o=r.featureGcsToDisplay(l(i[s],s,e,u)),s?t.lineTo(o.x,o.y):(a=o,t.moveTo(o.x,o.y));x.closed&&t.lineTo(a.x,a.y),n=y,y=x,x=n}}),void 0!==y.strokeStyle&&t.stroke()},this._init(e),this};i(a,o);var s={};s[o.capabilities.basic]=!0,s[o.capabilities.multicolor]=!1,r("canvas","line",a,s),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(131),a=function t(e){return this instanceof t?(o.call(this,e),n(19).call(this),this._init(e),this):new t(e)};i(a,o),r("canvas","pixelmap",a),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(18),a=n(4),s=function t(e){if(!(this instanceof t))return new t(e);o.call(this,e),n(19).call(this);var i,r=n(2),s=this,u=this._exit,l=this._init,c=this._update;return this._build=function(){s.position()&&((i=s._generateQuads()).imgQuads&&i.imgQuads.sort(function(t,e){return t.pos[2]-e.pos[2]}),s.buildTime().modified())},this._checkQuadUpdate=function(t,e){s.layer().map().scheduleAnimationFrame(s._checkIfChanged)},this._checkIfChanged=function(){if(i&&i.vidQuads&&i.vidQuads.length){var t=!1,e=!1;r.each(i.vidQuads,function(n,i){i.video&&void 0!==i.video.HAVE_CURRENT_DATA&&(!i.video.seeking&&i.video.readyState>=i.video.HAVE_CURRENT_DATA&&(t=!0),i.video.paused&&!i.video.seeking||(e=!0))}),t&&s.renderer()&&s.renderer()._render(),e&&s.layer().map().scheduleAnimationFrame(s._checkIfChanged)}},this._renderColorQuads=function(t,e){if(i.clrQuads&&i.clrQuads.length){var n=t.globalAlpha,o=n;r.each(i.clrQuads,function(n,i){var r=e.gcsToDisplay({x:i.pos[0],y:i.pos[1]},null),s=e.gcsToDisplay({x:i.pos[3],y:i.pos[4]},null),u=e.gcsToDisplay({x:i.pos[6],y:i.pos[7]},null),l=e.gcsToDisplay({x:i.pos[9],y:i.pos[10]},null);i.opacity!==o&&(o=i.opacity,t.globalAlpha=o),t.fillStyle=a.convertColorToHex(i.color,!0),t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(s.x,s.y),t.lineTo(l.x,l.y),t.lineTo(u.x,u.y),t.closePath(),t.fill()}),o!==n&&(t.globalAlpha=n)}},this._renderImageAndVideoQuads=function(t,e){if(i.imgQuads&&i.imgQuads.length||i.vidQuads&&i.vidQuads.length){var n=t.globalAlpha,o=n;r.each([i.imgQuads,i.vidQuads],function(n,i){i&&r.each(i,function(n,i){var r,a,s;if(i.image)a=(r=i.image).width,s=r.height;else if(i.video&&(a=(r=i.video).videoWidth,s=r.videoHeight,r.seeking))return;if(r&&a&&s&&!(i.opacity<=0)){var u=e.gcsToDisplay({x:i.pos[0],y:i.pos[1]},null),l=e.gcsToDisplay({x:i.pos[6],y:i.pos[7]},null),c=e.gcsToDisplay({x:i.pos[9],y:i.pos[10]},null);if(t.setTransform((c.x-l.x)/a,(c.y-l.y)/a,(u.x-l.x)/s,(u.y-l.y)/s,l.x,l.y),i.opacity!==o&&(o=i.opacity,t.globalAlpha=o),i.crop){var h=Math.min(a,i.crop.x),d=Math.min(s,i.crop.y);h>0&&d>0&&t.drawImage(r,0,0,h,d,0,0,h,d)}else t.drawImage(r,0,0)}})}),o!==n&&(t.globalAlpha=n),t.setTransform(1,0,0,1,0,0)}},this._delayRender=function(){var t=!1;return i&&i.vidQuads&&i.vidQuads.length&&r.each(i.vidQuads,function(e,n){n.video&&void 0!==n.video.HAVE_CURRENT_DATA&&(t|=n.video.seeking&&n.delayRenderWhenSeeking)}),t},this._renderOnCanvas=function(t,e){i&&(s._renderImageAndVideoQuads(t,e),s._renderColorQuads(t,e))},this._update=function(){c.call(s),(s.buildTime().timestamp()<=s.dataTime().timestamp()||s.updateTime().timestamp()<s.timestamp())&&s._build(),s.updateTime().modified(),s.layer().map().scheduleAnimationFrame(s._checkIfChanged)},this._init=function(){l.call(s,e)},this._exit=function(){u.call(s)},s._init(e),this};i(s,o);var u={};u[o.capabilities.color]=!0,u[o.capabilities.image]=!0,u[o.capabilities.imageCrop]=!0,u[o.capabilities.imageFixedScale]=!0,u[o.capabilities.imageFull]=!1,u[o.capabilities.canvas]=!0,u[o.capabilities.video]=!0,r("canvas","quad",s,u),t.exports=s},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(27),a=n(4),s=n(119),u=n(36),l=function t(e){if(!(this instanceof t))return new t(e);var i=n(19);e=e||{},o.call(this,e),i.call(this);var r=this,l=new RegExp('^\\s*(?=(?:(?:[-a-z0-9]+\\s+){0,3}(italic|oblique))?)(?=(?:(?:[-a-z0-9]+\\s+){0,3}(small-caps))?)(?=(?:(?:[-a-z0-9]+\\s+){0,3}(bold(?:er)?|lighter|[1-9]00))?)(?=(?:(?:[-a-z0-9]+\\s+){0,3}((?:ultra-|extra-|semi-)?(?:condensed|expanded)))?)(?:(?:normal|\\1|\\2|\\3|\\4)\\s+){0,4}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))(?:/(normal|[.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])))?\\s+([-,\\"\\sa-z]+?)\\s*$',"i");return this.getFontFromStyles=function(t,e,n){var i=r.style.get("font")(e,n)||"bold 16px sans-serif";if(t){var o=l.exec(i);null===o&&(o=l.exec("bold 16px sans-serif")),o[1]=r.style.get("fontStyle")(e,n)||o[1],o[2]=r.style.get("fontVariant")(e,n)||o[2],o[3]=r.style.get("fontWeight")(e,n)||o[3],o[4]=r.style.get("fontStretch")(e,n)||o[4],o[5]=r.style.get("fontSize")(e,n)||o[5]||"16px",o[6]=r.style.get("lineHeight")(e,n)||o[6],o[7]=r.style.get("fontFamily")(e,n)||o[7]||"sans-serif",i=(i=(o[1]||"")+" "+(o[2]||"")+" "+(o[3]||"")+" "+(o[4]||"")+" "+(o[5]||"")+(o[6]?"/"+o[6]:"")+" "+o[7]).trim().replace(/\s\s+/g," ")}return i},this._renderOnCanvas=function(t,e){var n,i,o,l,c,h,d,f,p,m,g,v,y,x,b=r.data(),_=r.style.get("position"),w=r.style.get("renderThreshold")(b),M=r.style.get("text"),A=e.rotation(),T=e.zoom(),C=e.size(),E=a.mat3AsArray();n=["fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily"].some(function(t){return null!==r.style(t)&&void 0!==r.style(t)}),r._canvasProperty(),o=r.featureGcsToDisplay(b.map(_)),b.forEach(function(e,b){l=o[b],w>0&&(l.x<-w||l.x>C.width+w||l.y<-w||l.y>C.height+w)||((c=r.style.get("visible")(e,b))||void 0===c)&&(h=a.convertColorAndOpacity(r.style.get("color")(e,b),r.style.get("textOpacity")(e,b)),f=a.convertColorAndOpacity(r.style.get("textStrokeColor")(e,b),r.style.get("textOpacity")(e,b),{r:0,g:0,b:0,a:0}),0===h.a&&0===f.a||(r._canvasProperty(t,"fillStyle",a.convertColorToRGBA(h)),i=M(e,b),r._canvasProperty(t,"font",r.getFontFromStyles(n,e,b)),r._canvasProperty(t,"textAlign",r.style.get("textAlign")(e,b)||"center"),r._canvasProperty(t,"textBaseline",r.style.get("textBaseline")(e,b)||"middle"),m=r.style.get("rotation")(e,b)||0,g=r.style.get("rotateWithMap")(e,b)&&A,v=r.style.get("textScaled")(e,b),v=a.isNonNullFinite(v)?Math.pow(2,T-v):null,y=r.style.get("offset")(e,b),x=a.mat3AsArray(),(m||g||v&&1!==v||y&&(y.x||y.y))&&(s.translate(x,x,[l.x,l.y]),g&&A&&s.rotate(x,x,A),s.translate(x,x,[y&&y.x?+y.x:0,y&&y.y?+y.y:0]),m&&s.rotate(x,x,m),v&&1!==v&&s.scale(x,x,[v,v]),s.translate(x,x,[-l.x,-l.y])),E[0]===x[0]&&E[1]===x[1]&&E[3]===x[3]&&E[4]===x[4]&&E[6]===x[6]&&E[7]===x[7]||(t.setTransform(x[0],x[1],x[3],x[4],x[6],x[7]),s.copy(E,x)),(h=a.convertColorAndOpacity(r.style.get("shadowColor")(e,b),void 0,{r:0,g:0,b:0,a:0})).a&&(y=r.style.get("shadowOffset")(e,b),d=r.style.get("shadowBlur")(e,b)),h.a&&(y&&(y.x||y.y)||d)?(r._canvasProperty(t,"shadowColor",a.convertColorToRGBA(h)),y&&(m||g)&&r.style.get("shadowRotate")(e,b)&&(x=[+y.x,+y.y,0],u.rotateZ(x,x,[0,0,0],m+(g?A:0)),y={x:x[0],y:x[1]}),r._canvasProperty(t,"shadowOffsetX",y&&y.x?+y.x:0),r._canvasProperty(t,"shadowOffsetY",y&&y.y?+y.y:0),r._canvasProperty(t,"shadowBlur",d||0)):r._canvasProperty(t,"shadowColor","rgba(0,0,0,0)"),f.a&&(p=r.style.get("textStrokeWidth")(e,b),isFinite(p)&&p>0&&(r._canvasProperty(t,"strokeStyle",a.convertColorToRGBA(f)),r._canvasProperty(t,"lineWidth",p),t.strokeText(i,l.x,l.y),r._canvasProperty(t,"shadowColor","rgba(0,0,0,0)"))),t.fillText(i,l.x,l.y)))}),r._canvasProperty(t,"globalAlpha",1),t.setTransform(1,0,0,1,0,0)},this};i(l,o);r("canvas","text",l,{}),t.exports=l},function(t,e,n){"use strict";var i=function(){var t,e=this,n=this._init,i=this._exit,r=0,o=[];this._drawTile=function(n){if(t){var i=e._tileBounds(n),a=n.index.level||0,s=e._tileOffset(a),u=e.tileCropFromBounds(n),l={};u&&(l.crop=u),l.ul=e.fromLocal(e.fromLevel({x:i.left-s.x,y:i.top-s.y},a),0),l.ll=e.fromLocal(e.fromLevel({x:i.left-s.x,y:i.bottom-s.y},a),0),l.ur=e.fromLocal(e.fromLevel({x:i.right-s.x,y:i.top-s.y},a),0),l.lr=e.fromLocal(e.fromLevel({x:i.right-s.x,y:i.bottom-s.y},a),0),l.ul.z=l.ll.z=l.ur.z=l.lr.z=a,r+=1,l.id=r,n.quadId=l.id,l.image=n.image,o.push(l),t.data(o),t._update(),e.draw()}},this._remove=function(n){if(void 0!==n.quadId&&t){for(var i=0;i<o.length;i+=1)if(o[i].id===n.quadId){o.splice(i,1);break}t.data(o),t._update(),e.draw()}},this._exit=function(){e.deleteFeature(t),t=null,o=[],i.apply(e,arguments)},this._init=function(){n.apply(e,arguments),(t=e.createFeature("quad",{previewColor:e._options.previewColor,previewImage:e._options.previewImage})).geoTrigger=void 0,t.gcs(e._options.gcs||e.map().gcs()),t.data(o),t._update()},this._getSubLayer=function(){},this._updateSubLayers=void 0};(0,n(1).registerLayerAdjustment)("canvas","tile",i),t.exports=i},function(t,e,n){"use strict";n(6).svg={rescale:n(121)},t.exports={graphFeature:n(303),lineFeature:n(304),object:n(15),pathFeature:n(305),pointFeature:n(306),quadFeature:n(307),renderer:n(10),tileLayer:n(308),uniqueID:n(52),vectorFeature:n(309)}},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(125),a=function t(e){var n=this;return this instanceof t?(o.call(this,e),this.select=function(){var t=n.renderer(),e={},i=n.nodeFeature(),r=n.linkFeatures();return e.nodes=t.select(i._svgid()),e.links=r.map(function(e){return t.select(e._svgid())}),e},this):new t(e)};i(a,o),r("svg","graph",a),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(24),a=function t(e){if(!(this instanceof t))return new t(e);var i=n(10).d3,r=n(15),a=n(9),s=n(4);e=e||{},o.call(this,e),r.call(this);var u=this,l=this._init,c=a(),h=0,d=this._update;return this._init=function(t){return l.call(u,t),u},this._build=function(){var t,e,n=u.data()||[],r=u.style(),o=u.renderer(),a=u.position();for(d.call(u),r.fill=function(){return!1},n.forEach(function(e,n){var l,c,h=u.line()(e,n),d={};function f(t){return s.isFunction(t)?function(){return t(h[0],0,e,n)}:t}for(c in r)r.hasOwnProperty(c)&&(d[c]=f(r[c]));t=i.svg.line().x(function(t){return u.featureGcsToDisplay(t).x}).y(function(t){return u.featureGcsToDisplay(t).y}).interpolate(u.style.get("closed")(e,n)&&h.length>2?"linear-closed":"linear"),l={data:[h.map(function(t,i){return a(t,i,e,n)})],append:"path",attributes:{d:t},id:u._svgid()+n,classes:["svgLineFeature","svgSubLine-"+n],visible:u.visible,style:d},o._drawFeatures(l)}),e=n.length;e<h;e+=1)o._removeFeature(u._svgid()+e);return h=n.length,c.modified(),u.updateTime().modified(),u},this._update=function(){return d.call(u),u.timestamp()>=c.timestamp()&&u._build(),u},this._init(e),this};i(a,o);var s={};s[o.capabilities.basic]=!0,s[o.capabilities.multicolor]=!1,r("svg","line",a,s),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(130),a=function t(e){if(!(this instanceof t))return new t(e);var i=n(2),r=n(10).d3,a=n(15),s=n(9);e=e||{},o.call(this,e),a.call(this);var u=this,l=s(),c=this._update,h={style:{}};return this._build=function(){var t,e,n=u.data()||[],o=u.style.get(),a=u.style.get("position");return c.call(u),e=function(t){var e={source:t.source,target:t.target};return r.svg.diagonal()(e)},t=[],n.forEach(function(e,i){var r,o;i<n.length-1&&(r=a(e,i),o=a(n[i+1],i+1),t.push({source:u.featureGcsToDisplay(r),target:u.featureGcsToDisplay(o)}))}),h.data=t,h.attributes={d:e},h.id=u._svgid(),h.append="path",h.classes=["svgPathFeature"],h.style=i.extend({fill:function(){return!1},fillColor:{r:0,g:0,b:0}},o),h.visible=u.visible,u.renderer()._drawFeatures(h),l.modified(),u.updateTime().modified(),u},this._update=function(){return c.call(u),u.dataTime().timestamp()>=l.timestamp()&&u._build(),u},this._init(e),this};i(a,o),r("svg","path",a),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(26),a=function t(e){if(!(this instanceof t))return new t(e);var i=n(15),r=n(9);e=e||{},o.call(this,e),i.call(this);var a=this,s=this._init,u=this._update,l=r(),c={};return this._init=function(t){return s.call(a,t),a},this._build=function(){var t=a.data(),e=a.style.get(),n=a.renderer(),i=a.position();return u.call(a),t||(t=[]),c.id=a._svgid(),c.data=t,c.append="circle",c.attributes={r:n._convertScale(e.radius),cx:function(t){return a.featureGcsToDisplay(i(t)).x},cy:function(t){return a.featureGcsToDisplay(i(t)).y}},c.style=e,c.classes=["svgPointFeature"],c.visible=a.visible,a.renderer()._drawFeatures(c),l.modified(),a.updateTime().modified(),a},this._update=function(){return u.call(a),a.timestamp()>=l.timestamp()&&a._build(),a},this._init(e),this};i(a,o);var s={};s[o.capabilities.stroke]=!0,r("svg","point",a,s),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(18),a=function t(e){if(!(this instanceof t))return new t(e);var i=n(2),r=n(10).d3,a=n(15);o.call(this,e),a.call(this);var s,u=this,l=this._exit,c=this._init,h=this._update;return this._build=function(){if(this.position()){var t=u.renderer(),e=t.layer().map();s=u._generateQuads();var n=[];i.each(s.clrQuads,function(t,e){n.push({type:"clr",quad:e,zIndex:e.pos[2]})}),i.each(s.imgQuads,function(t,e){e.image&&n.push({type:"img",quad:e,zIndex:e.pos[2]})});var o={id:u._svgid(),data:n,dataIndex:function(t){return t.quad.quadId},append:function(t){var e=this.namespaceURI,n="clr"===t.type?"polygon":"image";return e?document.createElementNS(e,n):document.createElement(n)},attributes:{fill:function(t){if("clr"===t.type)return r.rgb(255*t.quad.color.r,255*t.quad.color.g,255*t.quad.color.b);1!==t.quad.opacity&&r.select(this).style("opacity",t.quad.opacity)},height:function(t){return"clr"===t.type?void 0:1},points:function(n){if("clr"===n.type&&!n.points){var i,r=[];for(i=0;i<n.quad.pos.length;i+=3){var o={x:n.quad.pos[i],y:n.quad.pos[i+1],z:n.quad.pos[i+2]};o=e.gcsToDisplay(o,null),o=t.baseToLocal(o),r.push(o.x+","+o.y)}n.points=r[0]+" "+r[1]+" "+r[3]+" "+r[2]}return"clr"===n.type?n.points:void 0},preserveAspectRatio:function(t){return"clr"===t.type?void 0:"none"},reference:function(t){return t.quad.reference},stroke:!1,transform:function(n){if("img"===n.type&&n.quad.image&&!n.svgTransform){var i,r,o,a,s=[],u=-1,l=n.quad.image.width,c=n.quad.image.height;for(o=0;o<n.quad.pos.length;o+=3){var h={x:n.quad.pos[o],y:n.quad.pos[o+1],z:n.quad.pos[o+2]};h=e.gcsToDisplay(h,null),h=t.baseToLocal(h),s.push(h)}for(o=0;o<4;o+=1)(i=Math.abs(s[(o+1)%4].x*(s[(o+2)%4].y-s[(o+3)%4].y)+s[(o+2)%4].x*(s[(o+3)%4].y-s[(o+1)%4].y)+s[(o+3)%4].x*(s[(o+1)%4].y-s[(o+2)%4].y))/2)>u&&(u=i,r=o);n.svgTransform=[3===r||2===r?s[1].x-s[0].x:s[3].x-s[2].x,3===r||2===r?s[1].y-s[0].y:s[3].y-s[2].y,0===r||2===r?s[1].x-s[3].x:s[0].x-s[2].x,0===r||2===r?s[1].y-s[3].y:s[0].y-s[2].y,2===r?s[3].x+s[0].x-s[1].x:s[2].x,2===r?s[3].y+s[0].y-s[1].y:s[2].y],Math.abs(n.svgTransform[1]/l)<1e-6&&Math.abs(n.svgTransform[2]/c)<1e-6&&(a=n.svgTransform[0]/l,n.svgTransform[4]=Math.round(n.svgTransform[4]/a)*a,a=n.svgTransform[3]/c,n.svgTransform[5]=Math.round(n.svgTransform[5]/a)*a)}return"img"===n.type&&n.quad.image?"matrix("+n.svgTransform.join(" ")+")":void 0},width:function(t){return"clr"===t.type?void 0:1},x:function(t){return"clr"===t.type?void 0:0},"xlink:href":function(t){return"clr"!==t.type&&t.quad.image?t.quad.image.src:void 0},y:function(t){return"clr"===t.type?void 0:0}},style:{fillOpacity:function(t){return"clr"===t.type?t.quad.opacity:void 0}},onlyRenderNew:!this.style("previewColor")&&!this.style("previewImage"),sortByZ:!0,visible:u.visible,classes:["svgQuadFeature"]};t._drawFeatures(o),u.buildTime().modified()}},this._update=function(){return h.call(u),(u.buildTime().timestamp()<=u.dataTime().timestamp()||u.buildTime().timestamp()<u.timestamp())&&u._build(),u},this._init=function(){c.call(u,e)},this._exit=function(){l.call(u)},u._init(e),this};i(a,o);var s={};s[o.capabilities.color]=!0,s[o.capabilities.image]=!0,s[o.capabilities.imageCrop]=!1,s[o.capabilities.imageFixedScale]=!1,s[o.capabilities.imageFull]=!1,s[o.capabilities.canvas]=!1,s[o.capabilities.video]=!1,r("svg","quad",a,s),t.exports=a},function(t,e,n){"use strict";var i=function(){var t,e=this,n=this._init,i=this._exit,r=0,o=[];this._drawTile=function(n){if(t){var i=e._tileBounds(n),a=n.index.level||0,s=e._tileOffset(a),u={};u.ul=e.fromLocal(e.fromLevel({x:i.left-s.x,y:i.top-s.y},a),0),u.ll=e.fromLocal(e.fromLevel({x:i.left-s.x,y:i.bottom-s.y},a),0),u.ur=e.fromLocal(e.fromLevel({x:i.right-s.x,y:i.top-s.y},a),0),u.lr=e.fromLocal(e.fromLevel({x:i.right-s.x,y:i.bottom-s.y},a),0),u.ul.z=u.ll.z=u.ur.z=u.lr.z=a,r+=1,u.id=r,n.quadId=u.id,u.image=n.image,u.reference=n.toString(),o.push(u),t.data(o),t._update(),e.draw()}},this._remove=function(n){if(void 0!==n.quadId&&t){for(var i=0;i<o.length;i+=1)if(o[i].id===n.quadId){o.splice(i,1);break}t.data(o),t._update(),e.draw()}},this._exit=function(){e.deleteFeature(t),t=null,o=[],i.apply(e,arguments)},this._init=function(){n.apply(e,arguments),(t=e.createFeature("quad",{previewColor:e._options.previewColor,previewImage:e._options.previewImage})).geoTrigger=void 0,t.gcs(e._options.gcs||e.map().gcs()),t.data(o),t._update()},this._getSubLayer=function(){},this._updateSubLayers=void 0};(0,n(1).registerLayerAdjustment)("svg","tile",i),t.exports=i},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(132),a={arrow:{attrs:{class:"geo-vector-arrow geo-vector-marker",viewBox:"0 0 10 10",refX:1,refY:5,markerHeight:5,markerWidth:5,orient:"auto"},path:"M 0 0 L 10 5 L 0 10 z"},point:{attrs:{class:"geo-vector-point geo-vector-marker",viewBox:"0 0 12 12",refX:6,refY:6,markerHeight:8,markerWidth:8,orient:"auto"},path:"M 6 3 A 3 3 0 1 1 5.99999 3 Z"},bar:{attrs:{class:"geo-vector-bar geo-vector-marker",viewBox:"0 0 10 10",refX:0,refY:5,markerHeight:6,markerWidth:6,orient:"auto"},path:"M 0 0 L 2 0 L 2 10 L 0 10 z"},wedge:{attrs:{class:"geo-vector-wedge geo-vector-marker",viewBox:"0 0 10 10",refX:10,refY:5,markerHeight:5,markerWidth:5,orient:"auto"},path:"M 0 0 L 1 0 L 10 5 L 1 10 L 0 10 L 9 5 L 0 0"}},s=function t(e){if(!(this instanceof t))return new t(e);var i=n(15),r=n(9),s=n(10).d3;e=e||{},o.call(this,e),i.call(this);var u=this,l=this._exit,c=this._update,h=r(),d={};function f(t,e,n){return u._svgid()+"_marker_"+e+"_"+n}function p(t,e,n,i,r){var o=u.renderer()._definitions().selectAll("g.marker-group#"+u._svgid()).data(t.length?[1]:[]);o.enter().append("g").attr("id",u._svgid).attr("class","marker-group"),o.exit().remove();var l=t.reduce(function(t,e,n){var o=a[r(e,n)],s=a[i(e,n)];return o&&t.push({data:e,dataIndex:n,head:!0}),s&&t.push({data:e,dataIndex:n,head:!1}),t},[]),c=o.selectAll("marker.geo-vector-marker").data(l);c.enter().append("marker").append("path");var h=u.renderer();c.each(function(t){var e=s.select(this),n=t.head?a[r(t.data,t.dataIndex)]:a[i(t.data,t.dataIndex)];Object.keys(n.attrs).map(function(t){e.attr(t,n.attrs[t])})}).attr("id",function(t){return f(t.data,t.dataIndex,t.head?"head":"tail")}).style("stroke",function(t){return h._convertColor(e)(t.data,t.dataIndex)}).style("fill",function(t){return h._convertColor(e)(t.data,t.dataIndex)}).style("opacity",function(t){return n(t.data,t.dataIndex)}).select("path").attr("d",function(t){return t.head?a[r(t.data,t.dataIndex)].path:a[i(t.data,t.dataIndex)].path}),c.exit().remove()}return this._build=function(){var t,e=u.data(),n=u.style.get(),i=u.renderer(),r=u.origin(),o=u.delta(),a=u.style("scale"),s=0;function l(){return a/i.scaleFactor()}return c.call(u),e||(e=[]),t=e.map(function(t,e){var n=u.featureGcsToDisplay(r(t,e)),i=o(t,e);return s=Math.max(s,i.x*i.x+i.y*i.y),{x1:n.x,y1:n.y,dx:i.x,dy:-i.y}}),s=Math.sqrt(s),a||(a=75/(s||1)),d.id=u._svgid(),d.data=e,d.append="line",d.attributes={x1:function(e,n){return t[n].x1},y1:function(e,n){return t[n].y1},x2:function(e,n){return t[n].x1+l()*t[n].dx},y2:function(e,n){return t[n].y1+l()*t[n].dy},"marker-start":function(t,e){return"url(#"+f(0,e,"tail")+")"},"marker-end":function(t,e){return"url(#"+f(0,e,"head")+")"}},d.style={stroke:function(){return!0},strokeColor:n.strokeColor,strokeWidth:n.strokeWidth,strokeOpacity:n.strokeOpacity,originStyle:n.originStyle,endStyle:n.endStyle},d.classes=["svgVectorFeature"],d.visible=u.visible,p(e,n.strokeColor,n.strokeOpacity,n.originStyle,n.endStyle),u.renderer()._drawFeatures(d),h.modified(),u.updateTime().modified(),u},this._update=function(){return c.call(u),u.timestamp()>=h.timestamp()?u._build():p(d.data,d.style.strokeColor,d.style.strokeOpacity,d.style.originStyle,d.style.endStyle),u},this._exit=function(){l.call(u),d={},p([],null,null,null,null)},this._init(e),this};s.markerConfigs=a,i(s,o),r("svg","vector",s),t.exports=s},function(t,e,n){"use strict";t.exports={pointFeature:n(311),vtkjsRenderer:n(133)}},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(26),a=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var i=n(7),r=n(312),a=n(133).vtkjs,s=a.Rendering.Core.vtkActor,u=a.Common.Core.vtkDataArray,l=a.Rendering.Core.vtkGlyph3DMapper,c=a.Rendering.Core.vtkMapper,h=a.Common.DataModel.vtkPointSet,d=a.Filters.Sources.vtkSphereSource;r.call(this);var f,p,m,g,v,y=this,x=this._init,b=this._exit,_=this._update;return this._createPipeline=function(){p=h.newInstance(),(m=d.newInstance()).setThetaResolution(30),m.setPhiResolution(30);var t=l.newInstance({orient:!1,colorByArrayName:"color",scalarMode:c.ScalarMode.USE_POINT_FIELD_DATA,colorMode:c.ColorMode.DIRECT_SCALARS,scaling:!0,scaleArray:"diam",scaleMode:l.ScaleModes.SCALE_BY_MAGNITUDE});t.setInputData(p,0),t.setInputConnection(m.getOutputPort(),1),(f=s.newInstance()).setMapper(t),f.getProperty().setAmbient(1),y.renderer().contextRenderer().addActor(f)},this._init=function(){x.call(y,e),y.renderer().contextRenderer().setLayer(1),y._createPipeline()},this._build=function(){var t,e,n,r,o,a,s=y.data().length,l=new Array(3*s),c=y.data(),h=y.position(),d=y.style.get("radius"),f=y.style.get("fill"),m=y.style.get("fillColor"),x=y.style.get("fillOpacity"),b=y.layer().map().unitsPerPixel(y.layer().map().zoom());for(v&&v.length===s||(v=new Float32Array(s)),g&&g.length===4*s||(g=new Uint8Array(4*s)),t=e=n=0;t<s;t+=1,e+=3,n+=4)r=h(c[t],t),l[e]=r.x,l[e+1]=r.y,l[e+2]=r.z||0,a=a||l[e+2],v[t]=d(c[t],t)*b*2,o=m(c[t],t),g[n]=255*o.r,g[n+1]=255*o.g,g[n+2]=255*o.b,g[n+3]=f(c[t],t)?255*x(c[t],t):0;if(l=i.transformCoordinates(y.gcs(),y.layer().map().gcs(),l,3),!a&&y.gcs()!==y.layer().map().gcs())for(t=e=0;t<s;t+=1,e+=3)l[e+2]=0;p.getPoints().setData(l,3),p.getPointData().addArray(u.newInstance({name:"color",values:g,numberOfComponents:4})),p.getPointData().addArray(u.newInstance({name:"diam",values:v})),y.buildTime().modified()},this._update=function(){if(_.call(y),y.dataTime().getMTime()>=y.buildTime().getMTime()||y.updateTime().getMTime()<y.getMTime())y._build();else{var t=y.data(),e=y.style.get("radius"),n=y.layer().map().unitsPerPixel(y.layer().map().zoom()),i=p.getPointData().getArray("diam"),r=i.getData().map(function(i,r){return e(t[r],r)*n*2});i.setData(r),p.modified()}y.updateTime().modified()},this._exit=function(){y.renderer().contextRenderer().removeActor(f),b()},y._init(),this};i(a,o);var s={};s[o.capabilities.stroke]=!1,r("vtkjs","point",a,s),t.exports=a},function(t,e,n){"use strict";t.exports=function t(e){if(!(this instanceof n(11)))return new t(e);var i=this,r=this.draw;return this.draw=function(){return i.ready&&(i._update(),i.renderer()._render(),r()),i},this}},function(t,e){if(void 0===n){var i=new Error('Cannot find module "vtk"');throw i.code="MODULE_NOT_FOUND",i}t.exports=n},function(t,e,n){"use strict";t.exports={choroplethFeature:n(315),contourFeature:n(316),isolineFeature:n(319),layer:n(320),lineFeature:n(321),pointFeature:n(325),polygonFeature:n(330),quadFeature:n(334),tileLayer:n(339),webglRenderer:n(49)}},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(120),a=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var n=this,i=null,r=this._exit,a=this.draw,s=this._update;return this.draw=function(){if(n._update(),i)for(var t=0;t<i.length;t+=1)i[t].draw();return a(),n},this._build=function(){return n.buildTime().modified(),i=n.createChoropleth()},this._update=function(){s.call(n),(n.dataTime().timestamp()>=n.buildTime().timestamp()||n.updateTime().timestamp()<=n.timestamp())&&(n._wipePolygons(),n._build()),n.updateTime().modified()},this._wipePolygons=function(){i&&i.map(function(t){return t._exit()}),i=null},this._exit=function(){n._wipePolygons(),r()},this._init(e),this};i(a,o),r("webgl","choropleth",a),t.exports=a},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(122),a=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var i=n(12),r=n(7),a=n(4),s=n(20),u=n(317),l=n(318);s.call(this);var c=this,h=this._exit,d=null,f=null,p=null,m=null,g=null,v=null,y=null,x=null,b=void 0!==e.dynamicDraw&&e.dynamicDraw,_=this._init,w=this._update;function M(){var t=new i.shader(i.GL.VERTEX_SHADER);return t.setShaderSource(l),t}function A(){var t=new i.shader(i.GL.FRAGMENT_SHADER);return t.setShaderSource(u),t}return this._init=function(t){var e=i.blend(),n=i.shaderProgram(),r=i.material(),o=i.lookupTable(),a=i.geometryData(),s=new i.modelViewUniform("modelViewMatrix"),u=new i.projectionUniform("projectionMatrix"),l=new i.uniform(i.GL.INT,"sampler2d"),h=M(),w=A(),T=i.vertexAttribute("pos"),C=i.vertexAttribute("value"),E=i.vertexAttribute("opacity"),O=i.sourceDataP3fv({name:"pos"}),S=i.sourceDataAnyfv(1,i.vertexAttributeKeysIndexed.One,{name:"value"}),P=i.sourceDataAnyfv(1,i.vertexAttributeKeysIndexed.Two,{name:"opacity"}),k=new i.triangles;_.call(c,t),f=i.mapper({dynamicDraw:b}),n.addVertexAttribute(T,i.vertexAttributeKeys.Position),n.addVertexAttribute(C,i.vertexAttributeKeysIndexed.One),n.addVertexAttribute(E,i.vertexAttributeKeysIndexed.Two),n.addUniform(s),n.addUniform(u),g=new i.uniform(i.GL.FLOAT_VEC4,"minColor"),n.addUniform(g),v=new i.uniform(i.GL.FLOAT_VEC4,"maxColor"),n.addUniform(v),y=new i.uniform(i.GL.FLOAT,"steps"),n.addUniform(y),x=new i.uniform(i.GL.BOOL,"stepped"),n.addUniform(x),n.addShader(w),n.addShader(h),n.addUniform(l),o.setTextureUnit(7),l.set(7),(p=r).addAttribute(n),p.addAttribute(e),m=o,p.addAttribute(m),(d=i.actor()).setMaterial(p),d.setMapper(f),a.addSource(O),a.addSource(S),a.addSource(P),a.addPrimitive(k),a.computeBounds=function(){a.setBounds(0,0,0,0,0,0)},f.setGeometryData(a)},this.actors=function(){return d?[d]:[]},this._build=function(){d&&c.renderer().contextRenderer().removeActor(d),function(){var t,e,n,i,o,s,u,l,h=c._createContours(),d=h.elements.length,p=[],b=f.geometryData();for(g.set([h.minColor.r,h.minColor.g,h.minColor.b,h.minColor.a]),v.set([h.maxColor.r,h.maxColor.g,h.maxColor.b,h.maxColor.a]),y.set(h.colorMap.length),x.set(h.stepped),t=-1;t<h.colorMap.length+1;t+=1)n=Math.max(0,Math.min(h.colorMap.length-1,t)),p.push(255*h.colorMap[n].r),p.push(255*h.colorMap[n].g),p.push(255*h.colorMap[n].b),p.push(255*h.colorMap[n].a);for(m.setColorTable(p),h.pos=r.transformCoordinates(c.gcs(),c.layer().map().gcs(),h.pos,3),o=a.getGeomBuffer(b,"pos",3*d),s=a.getGeomBuffer(b,"opacity",d),u=a.getGeomBuffer(b,"value",d),t=e=0;t<d;t+=1,e+=3)i=3*(n=h.elements[t]),o[e]=h.pos[i],o[e+1]=h.pos[i+1],o[e+2]=h.pos[i+2],s[t]=h.opacity[n],u[t]=h.value[n];(l=b.primitive(0).indices())instanceof Uint16Array&&l.length===d||(l=new Uint16Array(d),b.primitive(0).setIndices(l)),b.boundsDirty(!0),f.modified(),f.boundsDirtyTimestamp().modified()}(),c.renderer().contextRenderer().addActor(d),c.buildTime().modified()},this._update=function(){w.call(c),(c.dataTime().timestamp()>=c.buildTime().timestamp()||c.updateTime().timestamp()<=c.timestamp())&&c._build(),d.setVisible(c.visible()),d.material().setBinNumber(c.bin()),c.updateTime().modified()},this._exit=function(){c.renderer().contextRenderer().removeActor(d),h()},this._init(e),this};i(a,o),r("webgl","contour",a),t.exports=a},function(t,e){t.exports="/* contourFeature fragment shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nuniform vec4 minColor;\nuniform vec4 maxColor;\nuniform float steps;\nuniform bool stepped;\nuniform sampler2D sampler2d;\nvarying float valueVar;\nvarying float opacityVar;\n\nvoid main () {\n  vec4 clr;\n  if (valueVar < 0.0) {\n    clr = minColor;\n  } else if (valueVar > steps) {\n    clr = maxColor;\n  } else {\n    float step;\n    if (stepped) {\n      step = floor(valueVar) + 0.5;\n      if (step > steps) {\n        step = steps - 0.5;\n      }\n    } else {\n      step = valueVar;\n    }\n    // our texture is padded on either end by a repeated value to ensure\n    // we interpolate smoothly at the ends.\n    clr = texture2D(sampler2d, vec2((step + 1.0) / (steps + 2.0), 0.0));\n  }\n  gl_FragColor = vec4(clr.rgb, clr.a * opacityVar);\n}\n"},function(t,e){t.exports="/* contourFeature vertex shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nattribute vec3 pos;\nattribute float value;\nattribute float opacity;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nvarying float valueVar;\nvarying float opacityVar;\n\nvoid main(void)\n{\n  /* Don't use z values */\n  vec4 scrPos = projectionMatrix * modelViewMatrix * vec4(pos.xy, 0, 1);\n  if (scrPos.w != 0.0) {\n    scrPos = scrPos / scrPos.w;\n  }\n  valueVar = value;\n  opacityVar = opacity;\n  gl_Position = scrPos;\n}\n"},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(55),a=function t(e){return this instanceof t?(e=e||{},o.call(this,e),n(20).call(this),this._init(e),this):new t(e)};i(a,o),r("webgl","isoline",a),t.exports=a},function(t,e,n){"use strict";var i=function(){var t=n(1).createRenderer,e=n(6),i=n(49),r=this,o=this._init,a=this.opacity,s=this.visible,u=this.zIndex;this.opacity=function(t){var e=a.apply(r,arguments);return void 0!==t&&r.initialized()&&r.map()._updateAutoshareRenderers(),e},this.visible=function(t){if(void 0===t)return s();var e=s(),n=s.apply(r,arguments);return e!==t&&r.initialized()&&(r.map().scheduleAnimationFrame(r._update,!0),r.renderer()._render()),n},this.zIndex=function(t,e){var n=u.apply(r,arguments);return void 0!==t&&r.initialized()&&(r.map().scheduleAnimationFrame(r._update,!0),r.renderer()._render(),r.map()._updateAutoshareRenderers()),n},this.switchRenderer=function(t,e){if(t instanceof i&&t!==r.renderer()){var n=r.renderer(),o=[],a=[];r.map().listSceneObjects([r]).forEach(function(t){t._cleanup&&(t._cleanup(),t._update&&a.push(t)),t.actors&&(o=o.concat(t.actors()))}),o.forEach(function(e){n.contextRenderer().removeActor(e),t.contextRenderer().addActor(e)}),r._renderer(t),r._canvas(t.canvas()),e&&(o.length||a.length)&&(n._render(),a.forEach(function(t){t._update()}),t._render())}return r},this._init=function(){var n=r.map();return n._updateAutoshareRenderers||(n._updateAutoshareRenderers=function(){var e,r,o=n.sortedLayers(),a=[],s=[],u=[];o.forEach(function(n){n.autoshareRenderer()&&n.renderer()&&n.renderer().api()===i.apiname?e&&n.opacity()===r?n.renderer()!==e&&(u.push(n.renderer()),s.push(n.renderer().canvas()[0]),n.switchRenderer(e,!1),u.push(n.renderer())):(n.node()[0].contains(n.renderer().canvas()[0])||(n.switchRenderer(t(i.apiname,n),!1),u.push(n.renderer())),e=n.renderer(),a.push(e.canvas()[0]),r=n.opacity()):e=null}),o.forEach(function(t){u.indexOf(t.renderer())>=0&&t._update&&t._update()}),o.forEach(function(t){u.indexOf(t.renderer())>=0&&(t.renderer()._render(),u=u.filter(function(e){return e!==t.renderer()}))}),s.forEach(function(t){a.indexOf(t)<0&&(t.remove(),a.push(t))})},n.geoOn(e.layerAdd,function(){return n._updateAutoshareRenderers()}),n.geoOn(e.layerRemove,function(){return n._updateAutoshareRenderers()})),o.apply(r,arguments)}};(0,n(1).registerLayerAdjustment)("webgl","all",i),t.exports=i},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(24),a=100,s={corner:0,near:1,far:3},u={butt:0,square:1,round:2},l={passthrough:3,miter:4,bevel:5,round:6,"miter-clip":7},c=2,h=5,d=8,f={normal:0,debug:1},p=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var i=n(12),r=n(7),p=n(4),m=n(20),g=n(322),v=n(323),y=n(324);m.call(this);var x,b,_,w,M,A,T,C,E,O=this,S=this._exit,P=void 0!==e.dynamicDraw&&e.dynamicDraw,k=this._init,R=this._update;return this.featureVertices=function(){return[[0,"corner",-1],[0,"near",1],[1,"far",-1],[1,"corner",1],[1,"near",-1],[0,"far",1]]},this.verticesPerFeature=function(){return O.featureVertices().length},this._init=function(t){var e,n=i.shaderProgram(),r=((e=new i.shader(i.GL.VERTEX_SHADER)).setShaderSource(y),e),o=function(t){var e=new i.shader(i.GL.FRAGMENT_SHADER);return e.setShaderSource(t?v:g),e}(void 0!==((t||{}).style||{}).debug),a=i.vertexAttribute("pos"),s=i.vertexAttribute("prev"),u=i.vertexAttribute("next"),l=i.vertexAttribute("far"),c=i.vertexAttribute("flags"),h=i.vertexAttribute("strokeWidth"),d=i.vertexAttribute("strokeColor"),f=i.vertexAttribute("strokeOpacity"),p=new i.modelViewUniform("modelViewMatrix"),m=new i.projectionUniform("projectionMatrix"),E=i.geometryData(),S=i.sourceDataP3fv({name:"pos"}),R=i.sourceDataAnyfv(3,i.vertexAttributeKeysIndexed.Four,{name:"prev"}),j=i.sourceDataAnyfv(3,i.vertexAttributeKeysIndexed.Five,{name:"next"}),L=i.sourceDataAnyfv(3,i.vertexAttributeKeysIndexed.Six,{name:"far"}),D=i.sourceDataAnyfv(1,i.vertexAttributeKeysIndexed.Seven,{name:"flags"}),I=i.sourceDataAnyfv(1,i.vertexAttributeKeysIndexed.One,{name:"strokeWidth"}),F=i.sourceDataAnyfv(3,i.vertexAttributeKeysIndexed.Two,{name:"strokeColor"}),N=i.sourceDataAnyfv(1,i.vertexAttributeKeysIndexed.Three,{name:"strokeOpacity"}),z=i.triangles();return w=new i.floatUniform("pixelWidth",1/O.renderer().width()),M=new i.floatUniform("aspect",O.renderer().width()/O.renderer().height()),A=new i.floatUniform("miterLimit",10),T=new i.floatUniform("antialiasing",0),C=new i.floatUniform("fixedFlags",0),k.call(O,t),_=i.material(),b=i.mapper({dynamicDraw:P}),n.addVertexAttribute(a,i.vertexAttributeKeys.Position),n.addVertexAttribute(h,i.vertexAttributeKeysIndexed.One),n.addVertexAttribute(d,i.vertexAttributeKeysIndexed.Two),n.addVertexAttribute(f,i.vertexAttributeKeysIndexed.Three),n.addVertexAttribute(s,i.vertexAttributeKeysIndexed.Four),n.addVertexAttribute(u,i.vertexAttributeKeysIndexed.Five),n.addVertexAttribute(l,i.vertexAttributeKeysIndexed.Six),n.addVertexAttribute(c,i.vertexAttributeKeysIndexed.Seven),n.addUniform(p),n.addUniform(m),n.addUniform(w),n.addUniform(M),n.addUniform(A),n.addUniform(T),n.addUniform(C),n.addShader(o),n.addShader(r),_.addAttribute(n),_.addAttribute(i.blend()),(x=i.actor()).setMaterial(_),x.setMapper(b),E.addSource(S),E.addSource(R),E.addSource(j),E.addSource(L),E.addSource(I),E.addSource(F),E.addSource(N),E.addSource(D),E.addPrimitive(z),E.computeBounds=function(){E.setBounds(0,0,0,0,0,0)},b.setGeometryData(E),O},this.actors=function(){return x?[x]:[]},this._build=function(){return function(t){var e,n,i,o,m,g,v,y,x,_,w,M,S,P,k,R,j,L,D,I,F,N,z,B,U,G,V,q,H,W,X,Q,K,Z=O.data(),Y=0,$=[{},{}],J=$[1],tt=O.style.get("strokeWidth"),et=O.style.get("strokeColor"),nt=O.style.get("strokeOpacity"),it=O.style.get("lineCap"),rt=O.style.get("lineJoin"),ot=O.style.get("strokeOffset"),at=O.style.get("miterLimit")(Z),st=O.style.get("antialiasing")(Z)||0,ut=O.featureVertices(),lt=ut.length,ct=f[O.style.get("debug")(Z)?"debug":"normal"]||0,ht=b.geometryData(),dt=O.style.get("closed"),ft=[],pt=!0;if(K=p.isFunction(O.style("closed"))?void 0:dt()||!1,D=p.isFunction(O.style("lineCap"))?void 0:it()||"butt",I=p.isFunction(O.style("lineJoin"))?void 0:rt()||"miter",j=p.isFunction(O.style("strokeColor"))?void 0:et(),F=p.isFunction(O.style("strokeOffset"))?void 0:ot()||0,L=p.isFunction(O.style("strokeOpacity"))?void 0:nt(),R=p.isFunction(O.style("strokeWidth"))?void 0:tt(),void 0!==at&&A.set(Math.max(1,Math.min(a,at))),C.set(ct),T.set(st),t)Y=E.numSegments,ft=E.closed,x=E.lineItemList,y=Y*lt,pt=D!==E.lineCapVal||void 0===D||I!==E.lineJoinVal||void 0===I||F!==E.strokeOffsetVal||void 0===F;else{var mt=[],gt=O.position();for(x=new Array(Z.length),n=0;n<Z.length;n+=1)if(e=Z[n],_=O.line()(e,n),x[n]=_,!(_.length<2)){for(Y+=_.length-1,i=0;i<_.length;i+=1)M=gt(_[i],i,e,n),mt.push(M.x),mt.push(M.y),mt.push(M.z||0),i||(P=M);_.length>2&&(void 0===K?dt(e,n):K)&&(M.x!==P.x||M.y!==P.y||M.z!==P.z?(Y+=1,ft[n]=2):ft[n]=1)}mt=r.transformCoordinates(O.gcs(),O.layer().map().gcs(),mt,3),y=Y*lt,N=p.getGeomBuffer(ht,"pos",3*y),z=p.getGeomBuffer(ht,"prev",3*y),B=p.getGeomBuffer(ht,"next",3*y),U=p.getGeomBuffer(ht,"far",3*y),(V=ht.primitive(0).indices())instanceof Uint16Array&&V.length===y||(V=new Uint16Array(y),ht.primitive(0).setIndices(V)),E={numSegments:Y,closed:ft,lineItemList:x,lineCapVal:D,lineJoinVal:I,strokeOffsetVal:F}}for(G=p.getGeomBuffer(ht,"flags",y),q=p.getGeomBuffer(ht,"strokeWidth",y),H=p.getGeomBuffer(ht,"strokeColor",3*y),W=p.getGeomBuffer(ht,"strokeOpacity",y),n=S=X=Q=0;n<Z.length;n+=1)if(!((_=x[n]).length<2))for(e=Z[n],k=S,i=0;i<_.length+(2===ft[n]?1:0);i+=1,S+=3)if(v=i,i===_.length&&(v=0,S-=3),w=_[v],i&&(J=$[0],$[0]=$[1],$[1]=J),t||(J.pos=i===v?S:k,J.prev=v?S-3:ft[n]?k+3*(_.length-3+ft[n]):S,J.next=i+1<_.length?S+3:ft[n]?i!==v?k+3:k+6-3*ft[n]:S),J.strokeWidth=void 0===R?tt(w,v,e,n):R,J.strokeColor=void 0===j?et(w,v,e,n):j,J.strokeOpacity=void 0===L?nt(w,v,e,n):L,pt&&(J.strokeOffset=(void 0===F?ot(w,v,e,n):F)||0,J.strokeOffset?(J.posStrokeOffset=2047&Math.round(2048+1023*Math.min(1,Math.max(-1,J.strokeOffset))),J.negStrokeOffset=2047&Math.round(2048-1023*Math.min(1,Math.max(-1,J.strokeOffset)))):J.posStrokeOffset=J.negStrokeOffset=0,ft[n]||i&&i!==_.length-1?J.flags=l[void 0===I?rt(w,v,e,n):I]||l.miter:J.flags=u[void 0===D?it(w,v,e,n):D]||u.butt),i)for(o=0;o<lt;o+=1,X+=1,Q+=3)m=$[ut[o][0]],g=$[1-ut[o][0]],t||(N[Q]=mt[m.pos],N[Q+1]=mt[m.pos+1],N[Q+2]=0),ut[o][0]?(t||(z[Q]=mt[m.next],z[Q+1]=mt[m.next+1],z[Q+2]=0,B[Q]=mt[m.prev],B[Q+1]=mt[m.prev+1],B[Q+2]=0,U[Q]=mt[g.prev],U[Q+1]=mt[g.prev+1],U[Q+2]=0),pt&&(G[X]=s[ut[o][1]]|m.flags<<c|g.flags<<h|m.posStrokeOffset<<d)):(t||(z[Q]=mt[m.prev],z[Q+1]=mt[m.prev+1],z[Q+2]=0,B[Q]=mt[m.next],B[Q+1]=mt[m.next+1],B[Q+2]=0,U[Q]=mt[g.next],U[Q+1]=mt[g.next+1],U[Q+2]=0),pt&&(G[X]=s[ut[o][1]]|m.flags<<c|g.flags<<h|m.negStrokeOffset<<d)),q[X]=m.strokeWidth,H[Q]=m.strokeColor.r,H[Q+1]=m.strokeColor.g,H[Q+2]=m.strokeColor.b,W[X]=m.strokeOpacity;b.modified(),t||(ht.boundsDirty(!0),b.boundsDirtyTimestamp().modified())}(O.dataTime().timestamp()<O.buildTime().timestamp()&&E),O.renderer().contextRenderer().hasActor(x)||O.renderer().contextRenderer().addActor(x),O.buildTime().modified(),O},this._update=function(){return R.call(O),(O.dataTime().timestamp()>=O.buildTime().timestamp()||O.updateTime().timestamp()<=O.timestamp())&&O._build(),w.set(1/O.renderer().width()),M.set(O.renderer().width()/O.renderer().height()),x.setVisible(O.visible()),x.material().setBinNumber(O.bin()),O.updateTime().modified(),O},this._exit=function(){O.renderer().contextRenderer().removeActor(x),x=null,S()},this._init(e),this};i(p,o);var m={};m[o.capabilities.basic]=!0,m[o.capabilities.multicolor]=!0,r("webgl","line",p,m),t.exports=p},function(t,e){t.exports="/* lineFeature fragment shader */\n\n#ifdef GL_ES\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n  #else\n    precision mediump float;\n  #endif\n#endif\nvarying vec4 strokeColorVar;\nvarying vec4 subpos;\nvarying vec4 info;\nvarying vec4 angles;\nuniform float antialiasing;\nuniform float miterLimit;\nuniform float fixedFlags;\n\nvoid main () {\n  vec4 color = strokeColorVar;\n  float opacity = 1.0;\n  int nearMode = int(floor(info.x + 0.5));\n  int farMode = int(floor(info.y + 0.5));\n  float cosABC = angles.x;\n  float sinABC = angles.y;\n  float cosBCD = angles.z;\n  float sinBCD = angles.w;\n  // never render on the opposite side of a miter.  This uses a bit of\n  // slop, via pow(smoothstep()) instead of step(), since there are\n  // precision issues in this calculation.  This doesn't wholy solve\n  // the precision issue; sometimes pixels are missed or double\n  // rendered along the inside seam of a miter.\n  if (nearMode >= 4) {\n    float dist = cosABC * subpos.x - sinABC * subpos.y;\n    opacity = min(opacity, pow(smoothstep(-0.02, 0.02, dist), 0.5));\n    if (opacity == 0.0) {\n      discard;\n    }\n  }\n  if (farMode >= 4) {\n    float dist = cosBCD * subpos.z - sinBCD * subpos.y;\n    opacity = min(opacity, pow(smoothstep(-0.02, 0.02, dist), 0.5));\n    if (opacity == 0.0) {\n      discard;\n    }\n  }\n  // butt or square cap\n  if ((nearMode == 0 || nearMode == 1) && subpos.x < antialiasing) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.x + subpos.w * float(nearMode)));\n  }\n  if ((farMode == 0 || farMode == 1) && subpos.z < antialiasing) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.z + subpos.w * float(farMode)));\n  }\n  // round cap\n  if (nearMode == 2 && subpos.x <= 0.0) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.w - sqrt(pow(subpos.x, 2.0) + pow(subpos.y - info.z * subpos.w, 2.0))));\n  }\n  if (farMode == 2 && subpos.z <= 0.0) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.w - sqrt(pow(subpos.z, 2.0) + pow(subpos.y - info.z * subpos.w, 2.0))));\n  }\n  // bevel and clip joins\n  if ((nearMode == 5 || nearMode == 7) && subpos.x < antialiasing) {\n    float dist = (sinABC * subpos.x + cosABC * subpos.y) * sign(sinABC);\n    float w = subpos.w * (1.0 - info.z * sign(sinABC));\n    float maxDist;\n    if (nearMode == 5)  maxDist = cosABC * w;\n    else                maxDist = miterLimit * w;\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, maxDist + dist));\n  }\n  if ((farMode == 5 || farMode == 7) && subpos.z < antialiasing) {\n    float dist = (sinBCD * subpos.z + cosBCD * subpos.y) * sign(sinBCD);\n    float w = subpos.w * (1.0 - info.z * sign(sinBCD));\n    float maxDist;\n    if (farMode == 5)  maxDist = cosBCD * w;\n    else               maxDist = miterLimit * w;\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, maxDist + dist));\n  }\n  // round join\n  if (nearMode == 6 && subpos.x <= 0.0) {\n    float w = subpos.w * (1.0 - info.z * sign(sinABC));\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, w - sqrt(pow(subpos.x, 2.0) + pow(subpos.y, 2.0))));\n  }\n  if (farMode == 6 && subpos.z <= 0.0) {\n    float w = subpos.w * (1.0 - info.z * sign(sinBCD));\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, w - sqrt(pow(subpos.z, 2.0) + pow(subpos.y, 2.0))));\n  }\n  // antialias along main edges\n  if (antialiasing > 0.0) {\n    if (subpos.y > subpos.w * (1.0 + info.z) - antialiasing) {\n      opacity = min(opacity, smoothstep(antialiasing, -antialiasing, subpos.y - subpos.w * (1.0 + info.z)));\n    }\n    if (subpos.y < subpos.w * (-1.0 + info.z) + antialiasing) {\n      opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.y - subpos.w * (-1.0 + info.z)));\n    }\n  }\n  if (opacity == 0.0) {\n    discard;\n  }\n  color.a *= opacity;\n  gl_FragColor = color;\n}\n"},function(t,e){t.exports="/* lineFeature debug fragment shader */\n\n#ifdef GL_ES\n  #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n  #else\n    precision mediump float;\n  #endif\n#endif\nvarying vec4 strokeColorVar;\nvarying vec4 subpos;\nvarying vec4 info;\nvarying vec4 angles;\nuniform float antialiasing;\nuniform float miterLimit;\nuniform float fixedFlags;\n\nvoid main () {\n  vec4 color = strokeColorVar;\n  bool debug = bool(mod(fixedFlags, 2.0));\n  float opacity = 1.0;\n  int nearMode = int(floor(info.x + 0.5));\n  int farMode = int(floor(info.y + 0.5));\n  float cosABC = angles.x;\n  float sinABC = angles.y;\n  float cosBCD = angles.z;\n  float sinBCD = angles.w;\n  // never render on the opposite side of a miter.  This uses a bit of\n  // slop, via pow(smoothstep()) instead of step(), since there are\n  // precision issues in this calculation.  This doesn't wholy solve\n  // the precision issue; sometimes pixels are missed or double\n  // rendered along the inside seam of a miter.\n  if (nearMode >= 4) {\n    float dist = cosABC * subpos.x - sinABC * subpos.y;\n    opacity = min(opacity, pow(smoothstep(-0.02, 0.02, dist), 0.5));\n    if (opacity == 0.0) {\n      if (debug) {\n        color.r = 255.0 / 255.0;\n        gl_FragColor = color;\n        return;\n      }\n      discard;\n    }\n  }\n  if (farMode >= 4) {\n    float dist = cosBCD * subpos.z - sinBCD * subpos.y;\n    opacity = min(opacity, pow(smoothstep(-0.02, 0.02, dist), 0.5));\n    if (opacity == 0.0) {\n      if (debug) {\n        color.r = 254.0 / 255.0;\n        gl_FragColor = color;\n        return;\n      }\n      discard;\n    }\n  }\n  // butt or square cap\n  if ((nearMode == 0 || nearMode == 1) && subpos.x < antialiasing) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.x + subpos.w * float(nearMode)));\n  }\n  if ((farMode == 0 || farMode == 1) && subpos.z < antialiasing) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.z + subpos.w * float(farMode)));\n  }\n  // round cap\n  if (nearMode == 2 && subpos.x <= 0.0) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.w - sqrt(pow(subpos.x, 2.0) + pow(subpos.y - info.z * subpos.w, 2.0))));\n  }\n  if (farMode == 2 && subpos.z <= 0.0) {\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.w - sqrt(pow(subpos.z, 2.0) + pow(subpos.y - info.z * subpos.w, 2.0))));\n  }\n  // bevel and clip joins\n  if ((nearMode == 5 || nearMode == 7) && subpos.x < antialiasing) {\n    float dist = (sinABC * subpos.x + cosABC * subpos.y) * sign(sinABC);\n    float w = subpos.w * (1.0 - info.z * sign(sinABC));\n    float maxDist;\n    if (nearMode == 5)  maxDist = cosABC * w;\n    else                maxDist = miterLimit * w;\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, maxDist + dist));\n  }\n  if ((farMode == 5 || farMode == 7) && subpos.z < antialiasing) {\n    float dist = (sinBCD * subpos.z + cosBCD * subpos.y) * sign(sinBCD);\n    float w = subpos.w * (1.0 - info.z * sign(sinBCD));\n    float maxDist;\n    if (farMode == 5)  maxDist = cosBCD * w;\n    else               maxDist = miterLimit * w;\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, maxDist + dist));\n  }\n  // round join\n  if (nearMode == 6 && subpos.x <= 0.0) {\n    float w = subpos.w * (1.0 - info.z * sign(sinABC));\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, w - sqrt(pow(subpos.x, 2.0) + pow(subpos.y, 2.0))));\n  }\n  if (farMode == 6 && subpos.z <= 0.0) {\n    float w = subpos.w * (1.0 - info.z * sign(sinBCD));\n    opacity = min(opacity, smoothstep(-antialiasing, antialiasing, w - sqrt(pow(subpos.z, 2.0) + pow(subpos.y, 2.0))));\n  }\n  // antialias along main edges\n  if (antialiasing > 0.0) {\n    if (subpos.y > subpos.w * (1.0 + info.z) - antialiasing) {\n      opacity = min(opacity, smoothstep(antialiasing, -antialiasing, subpos.y - subpos.w * (1.0 + info.z)));\n    }\n    if (subpos.y < subpos.w * (-1.0 + info.z) + antialiasing) {\n      opacity = min(opacity, smoothstep(-antialiasing, antialiasing, subpos.y - subpos.w * (-1.0 + info.z)));\n    }\n  }\n  if (opacity == 0.0) {\n    if (debug) {\n      color.r = 253.0 / 255.0;\n      gl_FragColor = color;\n      return;\n    }\n    discard;\n  }\n  color.a *= opacity;\n  gl_FragColor = color;\n}\n"},function(t,e){t.exports="/* lineFeature vertex shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nattribute vec3 pos;\nattribute vec3 prev;\nattribute vec3 next;\nattribute vec3 far;\nattribute float flags;\n\nattribute vec3 strokeColor;\nattribute float strokeOpacity;\nattribute float strokeWidth;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float pixelWidth;\nuniform float aspect;\nuniform float miterLimit;\nuniform float antialiasing;\n\nvarying vec4 strokeColorVar;\nvarying vec4 subpos;  /* px, py, length - px, width */\nvarying vec4 info;  /* near mode, far mode, offset */\nvarying vec4 angles; /* near angle cos, sin, far angle cos, sin */\n\nconst float PI = 3.14159265358979323846264;\n\nvec4 viewCoord(vec3 c) {\n  vec4 result = projectionMatrix * modelViewMatrix * vec4(c.xyz, 1.0);\n  if (result.w != 0.0)  result = result / result.w;\n  return result;\n}\n\nfloat atan2(float y, float x) {\n  if (x > 0.0)  return atan(y / x);\n  if (x < 0.0 && y >= 0.0)  return atan(y / x) + PI;\n  if (x < 0.0)  return atan(y / x) - PI;\n  return sign(y) * 0.5 * PI;\n}\n\nvoid main(void)\n{\n  /* If any vertex has been deliberately set to a negative opacity,\n   * skip doing computations on it. */\n  if (strokeOpacity < 0.0) {\n    gl_Position = vec4(2.0, 2.0, 0.0, 1.0);\n    return;\n  }\n  /* convert coordinates.  We have four values, since we need to\n   * calculate the angles between the lines formed by prev-pos and\n   * pos-next, and between pos-next and next-far, plus know the angle\n   *   (prev)---(pos)---(next)---(far) => A---B---C---D */\n  vec4 A = viewCoord(prev);\n  vec4 B = viewCoord(pos);\n  vec4 C = viewCoord(next);\n  vec4 D = viewCoord(far);\n  // calculate line segment vector and angle\n  vec2 deltaCB = C.xy - B.xy;\n  if (deltaCB == vec2(0.0, 0.0)) {\n    gl_Position = vec4(2.0, 2.0, 0.0, 1.0);\n    return;\n  }\n  float angleCB = atan2(deltaCB.y, deltaCB.x * aspect);\n  // values we need to pass along\n  strokeColorVar = vec4(strokeColor, strokeOpacity);\n  // extract values from our flags field\n  int vertex = int(mod(flags, 4.0));\n  int nearMode = int(mod(floor(flags / 4.0), 8.0));\n  int farMode = int(mod(floor(flags / 32.0), 8.0));\n  // we use 11 bits of the flags for the offset, where -1023 to 1023\n  // maps to -1 to 1.  The 11 bits are a signed value, so simply\n  // selecting the bits will result in an unsigned values that may be\n  // greater than 1, in which case we have to subtract appropriately.\n  float offset = mod(floor(flags / 256.0), 2048.0) / 1023.0;\n  if (offset > 1.0)  offset -= 2048.0 / 1023.0;\n  // by default, offset by the width and don't extend lines.  Later,\n  // calculate line extensions based on end cap and end join modes\n  float yOffset = strokeWidth + antialiasing;\n  if (vertex == 0 || vertex == 2)  yOffset *= -1.0;\n  yOffset += strokeWidth * offset;\n  float xOffset = 0.0;\n  // end caps\n  if (nearMode == 0) {\n    xOffset = antialiasing;\n  } else if (nearMode == 1 || nearMode == 2) {\n    xOffset = strokeWidth + antialiasing;\n  }\n\n  // If joining lines, calculate the angles in screen space formed by\n  // the near end (A-B-C) and far end (B-C-D), and determine how much\n  // space is needed for the particular join.\n  //   This could be changed: if the lines are not a uniform width and\n  // offset, then the functional join angle is not simply half the\n  // angle between the two lines, but rather half the angle of the\n  // inside edge of the the two lines.\n  float cosABC = 1.0, sinABC = 0.0, cosBCD = 1.0, sinBCD = 0.0;  // of half angles\n  // handle near end\n  if (nearMode >= 4) {\n    float angleBA = atan2(B.y - A.y, (B.x - A.x) * aspect);\n    if (A.xy == B.xy)  angleBA = angleCB;\n    float angleABC = angleCB - angleBA;\n    // ensure angle is in the range [-PI, PI], then take the half angle\n    angleABC = (mod(angleABC + 3.0 * PI, 2.0 * PI) - PI) / 2.0;\n    cosABC = cos(angleABC);  sinABC = sin(angleABC);\n    // if this angle is close to flat, pass-through the join\n    if (nearMode >= 4 && cosABC > 0.999999) {\n      nearMode = 3;\n    }\n    // miter, miter-clip\n    if (nearMode == 4 || nearMode == 7) {\n      if (cosABC < 0.000001 || 1.0 / cosABC > miterLimit) {\n        if (nearMode == 4) {\n          nearMode = 5;\n        } else {\n          xOffset = miterLimit * strokeWidth * (1.0 - offset * sign(sinABC)) + antialiasing;\n        }\n      } else {\n        // we add an extra 1.0 to the xOffset to make sure that fragment\n        // shader is doing the clipping\n        xOffset = abs(sinABC / cosABC) * strokeWidth * (1.0 - offset * sign(sinABC)) + antialiasing + 1.0;\n        nearMode = 4;\n      }\n    }\n    // bevel or round join\n    if (nearMode == 5 || nearMode == 6) {\n      xOffset = strokeWidth * (1.0 - offset * sign(sinABC)) + antialiasing;\n    }\n  }\n\n  // handle far end\n  if (farMode >= 4) {\n    float angleDC = atan2(D.y - C.y, (D.x - C.x) * aspect);\n    if (D.xy == C.xy)  angleDC = angleCB;\n    float angleBCD = angleDC - angleCB;\n    // ensure angle is in the range [-PI, PI], then take the half angle\n    angleBCD = (mod(angleBCD + 3.0 * PI, 2.0 * PI) - PI) / 2.0;\n    cosBCD = cos(angleBCD);  sinBCD = sin(angleBCD);\n    // if this angle is close to flat, pass-through the join\n    if (farMode >= 4 && cosBCD > 0.999999) {\n      farMode = 3;\n    }\n    // miter, miter-clip\n    if (farMode == 4 || farMode == 7) {\n      if (cosBCD < 0.000001 || 1.0 / cosBCD > miterLimit) {\n        if (farMode == 4)  farMode = 5;\n      } else {\n        farMode = 4;\n      }\n    }\n  }\n\n  // compute the location of a vertex to include everything that might\n  // need to be rendered\n  xOffset *= -1.0;\n  gl_Position = vec4(\n    B.x + (xOffset * cos(angleCB) - yOffset * sin(angleCB)) * pixelWidth,\n    B.y + (xOffset * sin(angleCB) + yOffset * cos(angleCB)) * pixelWidth * aspect,\n    B.z, 1.0);\n  // store other values needed to determine which pixels to plot.\n  float lineLength = length(vec2(deltaCB.x, deltaCB.y / aspect)) / pixelWidth;\n\n  if (vertex == 0 || vertex == 1) {\n    subpos = vec4(xOffset, yOffset, lineLength - xOffset, strokeWidth);\n    info = vec4(float(nearMode), float(farMode), offset, 0.0);\n    angles = vec4(cosABC, sinABC, cosBCD, sinBCD);\n  } else {\n    subpos = vec4(lineLength - xOffset, -yOffset, xOffset, strokeWidth);\n    info = vec4(float(farMode), float(nearMode), -offset, 0.0);\n    angles = vec4(cosBCD, -sinBCD, cosABC, -sinABC);\n  }\n}\n"},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(1).registerFeature,a=n(26),s=function t(e){if(!(this instanceof t))return new t(e);e=e||{},a.call(this,e);var r=n(12),o=n(7),s=n(4),u=n(20),l=n(326),c=n(327),h=n(328),d=n(329);u.call(this);var f=this,p=this._exit,m=null,g=null,v=null,y=null,x=void 0!==e.dynamicDraw&&e.dynamicDraw,b="sprite",_=this._init,w=this._update,M=this.updateStyleFromArray;function A(t,e,n,i){var r;switch(b){case"triangle":r=[t,e-2*i,t-n*Math.sqrt(3),e+i,t+n*Math.sqrt(3),e+i];break;case"sprite":r=[t,e];break;default:r=[t-n,e+i,t-n,e-i,t+n,e+i,t-n,e-i,t+n,e-i,t+n,e+i]}return r}return"triangle"!==e.primitiveShape&&"square"!==e.primitiveShape&&"sprite"!==e.primitiveShape||(b=e.primitiveShape),this.actors=function(){return m?[m]:[]},this.verticesPerFeature=function(){return A(0,0,1,1).length/2},this.updateStyleFromArray=function(t,e,n){var r,o,a={fill:"bool",fillColor:3,fillOpacity:1,radius:1,stroke:"bool",strokeColor:3,strokeOpacity:1,strokeWidth:1};if("string"==typeof t){var s={};s[t]=e,t=s}return i.each(t,function(t,e){var n,i,s,u,l,c,h,d,p;if(f.visible()&&m&&a[t]&&!r&&!f.clustering())if(p="bool"===a[t]?1:a[t],u=f.data().length,s=(i=m.mapper()).getSourceBuffer(t),n=f.verticesPerFeature(),s&&u&&u*n*p===s.length){switch(a[t]){case 1:for(c=0,d=0;c<u;c+=1)for(l=e[c],h=0;h<n;h+=1,d+=1)s[d]=l;break;case 3:for(c=0,d=0;c<u;c+=1)for(l=e[c],h=0;h<n;h+=1,d+=3)s[d]=l.r,s[d+1]=l.g,s[d+2]=l.b;break;case"bool":for(c=0,d=0;c<u;c+=1)for(l=e[c]?1:0,h=0;h<n;h+=1,d+=1)s[d]=l}i.updateSourceBuffer(t),o=!0}else r=!0;else r=!0;M(t,e,!1)}),f.visible()&&r?f.draw():o&&f.renderer()._render(),f},this._init=function(){var t,n=r.shaderProgram(),i=((t=new r.shader(r.GL.VERTEX_SHADER)).setShaderSource("sprite"===b?d:h),t),o=function(){var t=new r.shader(r.GL.FRAGMENT_SHADER);return t.setShaderSource("sprite"===b?c:l),t}(),a=r.vertexAttribute("pos"),s=r.vertexAttribute("unit"),u=r.vertexAttribute("radius"),p=r.vertexAttribute("strokeWidth"),w=r.vertexAttribute("fillColor"),M=r.vertexAttribute("fill"),A=r.vertexAttribute("strokeColor"),T=r.vertexAttribute("stroke"),C=r.vertexAttribute("fillOpacity"),E=r.vertexAttribute("strokeOpacity"),O=new r.modelViewUniform("modelViewMatrix"),S=new r.projectionUniform("projectionMatrix"),P=r.material(),k=r.blend(),R=r.geometryData(),j=r.sourceDataP3fv({name:"pos"}),L=r.sourceDataAnyfv(2,r.vertexAttributeKeysIndexed.One,{name:"unit"}),D=r.sourceDataAnyfv(1,r.vertexAttributeKeysIndexed.Two,{name:"radius"}),I=r.sourceDataAnyfv(1,r.vertexAttributeKeysIndexed.Three,{name:"strokeWidth"}),F=r.sourceDataAnyfv(3,r.vertexAttributeKeysIndexed.Four,{name:"fillColor"}),N=r.sourceDataAnyfv(1,r.vertexAttributeKeysIndexed.Five,{name:"fill"}),z=r.sourceDataAnyfv(3,r.vertexAttributeKeysIndexed.Six,{name:"strokeColor"}),B=r.sourceDataAnyfv(1,r.vertexAttributeKeysIndexed.Seven,{name:"stroke"}),U=r.sourceDataAnyfv(1,r.vertexAttributeKeysIndexed.Eight,{name:"fillOpacity"}),G=r.sourceDataAnyfv(1,r.vertexAttributeKeysIndexed.Nine,{name:"strokeOpacity"}),V=new r.triangles;"sprite"===b&&(V=new r.points),v=new r.floatUniform("pixelWidth",2/f.renderer().width()),y=new r.floatUniform("aspect",f.renderer().width()/f.renderer().height()),_.call(f,e),g=r.mapper({dynamicDraw:x}),n.addVertexAttribute(a,r.vertexAttributeKeys.Position),"sprite"!==b&&n.addVertexAttribute(s,r.vertexAttributeKeysIndexed.One),n.addVertexAttribute(u,r.vertexAttributeKeysIndexed.Two),n.addVertexAttribute(p,r.vertexAttributeKeysIndexed.Three),n.addVertexAttribute(w,r.vertexAttributeKeysIndexed.Four),n.addVertexAttribute(M,r.vertexAttributeKeysIndexed.Five),n.addVertexAttribute(A,r.vertexAttributeKeysIndexed.Six),n.addVertexAttribute(T,r.vertexAttributeKeysIndexed.Seven),n.addVertexAttribute(C,r.vertexAttributeKeysIndexed.Eight),n.addVertexAttribute(E,r.vertexAttributeKeysIndexed.Nine),n.addUniform(v),n.addUniform(y),n.addUniform(O),n.addUniform(S),n.addShader(o),n.addShader(i),P.addAttribute(n),P.addAttribute(k),(m=r.actor()).setMaterial(P),m.setMapper(g),R.addSource(j),R.addSource(L),R.addSource(D),R.addSource(I),R.addSource(F),R.addSource(N),R.addSource(z),R.addSource(B),R.addSource(U),R.addSource(G),R.addPrimitive(V),R.computeBounds=function(){R.setBounds(0,0,0,0,0,0)},g.setGeometryData(R)},this._build=function(){return function(){var t,e,n,i,r,a,u,l,c,h,d,p,m,v,y,x,_,w,M,T,C,E,O,S,P,k,R,j,L,D,I,F,N,z,B,U,G=f.data().length,V=A(0,0,1,1),q=new Array(3*G),H=f.verticesPerFeature(),W=f.data(),X=g.geometryData();for(r=f.position(),h=f.style.get("radius"),m=f.style.get("stroke"),x=f.style.get("strokeWidth"),M=f.style.get("strokeOpacity"),E=f.style.get("strokeColor"),P=f.style.get("fill"),j=f.style.get("fillOpacity"),I=f.style.get("fillColor"),t=U=0;t<G;t+=1,U+=3)i=r(W[t],t),q[U]=i.x,q[U+1]=i.y,q[U+2]=0;for(q=o.transformCoordinates(f.gcs(),f.layer().map().gcs(),q,3),n=s.getGeomBuffer(X,"pos",H*G*3),"sprite"!==b&&(a=s.getGeomBuffer(X,"unit",H*G*2)),l=s.getGeomBuffer(X,"radius",H*G),d=s.getGeomBuffer(X,"stroke",H*G),v=s.getGeomBuffer(X,"strokeWidth",H*G),_=s.getGeomBuffer(X,"strokeOpacity",H*G),T=s.getGeomBuffer(X,"strokeColor",H*G*3),O=s.getGeomBuffer(X,"fill",H*G),k=s.getGeomBuffer(X,"fillOpacity",H*G),L=s.getGeomBuffer(X,"fillColor",H*G*3),(u=X.primitive(0).indices())instanceof Uint16Array&&u.length===H*G||(u=new Uint16Array(H*G),X.primitive(0).setIndices(u)),t=N=z=B=U=0;t<G;t+=1,U+=3){if(F=W[t],"sprite"!==b)for(e=0;e<V.length;e+=1,B+=1)a[B]=V[e];for(c=h(F,t),p=m(F,t)?1:0,y=x(F,t),w=M(F,t),C=E(F,t),S=P(F,t)?1:0,R=j(F,t),D=I(F,t),e=0;e<H;e+=1,N+=1,z+=3)n[z]=q[U],n[z+1]=q[U+1],n[z+2]=q[U+2],l[N]=c,d[N]=p,v[N]=y,_[N]=w,T[z]=C.r,T[z+1]=C.g,T[z+2]=C.b,O[N]=S,k[N]=R,L[z]=D.r,L[z+1]=D.g,L[z+2]=D.b}X.boundsDirty(!0),g.modified(),g.boundsDirtyTimestamp().modified()}(),f.renderer().contextRenderer().hasActor(m)||f.renderer().contextRenderer().addActor(m),f.buildTime().modified(),f},this._update=function(){return w.call(f),(f.dataTime().timestamp()>=f.buildTime().timestamp()||f.updateTime().timestamp()<f.timestamp())&&f._build(),v.set(2/f.renderer().width()),y.set(f.renderer().width()/f.renderer().height()),m.setVisible(f.visible()),m.material().setBinNumber(f.bin()),f.updateTime().modified(),f},this._exit=function(){f.renderer().contextRenderer().removeActor(m),m=null,p()},f._init(),this};r(s,a);var u={};u[a.capabilities.stroke]=!0,o("webgl","point",s,u),t.exports=s},function(t,e){t.exports="/* pointFeature square/triangle fragment shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nuniform float aspect;\nvarying vec4 fillColorVar;\nvarying vec4 strokeColorVar;\nvarying float radiusVar;\nvarying float strokeWidthVar;\nvarying float fillVar;\nvarying float strokeVar;\nvarying vec3 unitVar;  // distinct for square/triangle\n\nvoid main () {\n  vec4 strokeColor, fillColor;\n  float endStep;\n  // No stroke or fill implies nothing to draw\n  if (fillVar == 0.0 && strokeVar == 0.0)\n    discard;\n  float rad = length(unitVar.xy); // distinct for square/triangle\n  if (rad > 1.0)\n    discard;\n  // If there is no stroke, the fill region should transition to nothing\n  if (strokeVar == 0.0) {\n    strokeColor = vec4 (fillColorVar.rgb, 0.0);\n    endStep = 1.0;\n  } else {\n    strokeColor = strokeColorVar;\n    endStep = radiusVar / (radiusVar + strokeWidthVar);\n  }\n  // Likewise, if there is no fill, the stroke should transition to nothing\n  if (fillVar == 0.0)\n    fillColor = vec4 (strokeColor.rgb, 0.0);\n  else\n    fillColor = fillColorVar;\n  // Distance to antialias over\n  float antialiasDist = 3.0 / (2.0 * radiusVar);\n  if (rad < endStep) {\n    float step = smoothstep (endStep - antialiasDist, endStep, rad);\n    gl_FragColor = mix (fillColor, strokeColor, step);\n  } else {\n    float step = smoothstep (1.0 - antialiasDist, 1.0, rad);\n    gl_FragColor = mix (strokeColor, vec4 (strokeColor.rgb, 0.0), step);\n  }\n}\n"},function(t,e){t.exports="/* pointFeature sprite fragment shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nuniform float aspect;\nvarying vec4 fillColorVar;\nvarying vec4 strokeColorVar;\nvarying float radiusVar;\nvarying float strokeWidthVar;\nvarying float fillVar;\nvarying float strokeVar;\n// the square/triangle shade defines unitVar\n\nvoid main () {\n  vec4 strokeColor, fillColor;\n  float endStep;\n  // No stroke or fill implies nothing to draw\n  if (fillVar == 0.0 && strokeVar == 0.0)\n    discard;\n  float rad = 2.0 * length (gl_PointCoord - vec2(0.5));  // distinct for sprite\n  if (rad > 1.0)\n    discard;\n  // If there is no stroke, the fill region should transition to nothing\n  if (strokeVar == 0.0) {\n    strokeColor = vec4 (fillColorVar.rgb, 0.0);\n    endStep = 1.0;\n  } else {\n    strokeColor = strokeColorVar;\n    endStep = radiusVar / (radiusVar + strokeWidthVar);\n  }\n  // Likewise, if there is no fill, the stroke should transition to nothing\n  if (fillVar == 0.0)\n    fillColor = vec4 (strokeColor.rgb, 0.0);\n  else\n    fillColor = fillColorVar;\n  // Distance to antialias over\n  float antialiasDist = 3.0 / (2.0 * radiusVar);\n  if (rad < endStep) {\n    float step = smoothstep (endStep - antialiasDist, endStep, rad);\n    gl_FragColor = mix (fillColor, strokeColor, step);\n  } else {\n    float step = smoothstep (1.0 - antialiasDist, 1.0, rad);\n    gl_FragColor = mix (strokeColor, vec4 (strokeColor.rgb, 0.0), step);\n  }\n}\n"},function(t,e){t.exports="/* pointFeature square/triangle vertex shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nattribute vec3 pos;\nattribute float radius;\nattribute vec3 fillColor;\nattribute vec3 strokeColor;\nattribute float fillOpacity;\nattribute float strokeWidth;\nattribute float strokeOpacity;\nattribute float fill;\nattribute float stroke;\nuniform float pixelWidth;\nuniform float aspect;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nvarying vec4 fillColorVar;\nvarying vec4 strokeColorVar;\nvarying float radiusVar;\nvarying float strokeWidthVar;\nvarying float fillVar;\nvarying float strokeVar;\nattribute vec2 unit; // for non-sprite\nvarying vec3 unitVar; // for non-sprite\n\nvoid main(void)\n{\n  strokeWidthVar = strokeWidth;\n  // No stroke or fill implies nothing to draw\n  if (stroke < 1.0 || strokeWidth <= 0.0 || strokeOpacity <= 0.0) {\n    strokeVar = 0.0;\n    strokeWidthVar = 0.0;\n  }\n  else\n    strokeVar = 1.0;\n  if (fill < 1.0 || radius <= 0.0 || fillOpacity <= 0.0)\n    fillVar = 0.0;\n  else\n    fillVar = 1.0;\n  /* If the point has no visible pixels, skip doing computations on it. */\n  if (fillVar == 0.0 && strokeVar == 0.0) {\n    gl_Position = vec4(2, 2, 0, 1);\n    return;\n  }\n  fillColorVar = vec4 (fillColor, fillOpacity);\n  strokeColorVar = vec4 (strokeColor, strokeOpacity);\n  radiusVar = radius;\n  // for non-sprite\n  unitVar = vec3 (unit, 1.0);\n  vec4 p = (projectionMatrix * modelViewMatrix * vec4(pos, 1.0)).xyzw;\n  if (p.w != 0.0) {\n    p = p / p.w;\n  }\n  p += (radius + strokeWidthVar) *\n       vec4 (unit.x * pixelWidth, unit.y * pixelWidth * aspect, 0.0, 1.0);\n  gl_Position = vec4(p.xyz, 1.0);\n}\n"},function(t,e){t.exports="/* pointFeature sprite vertex shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nattribute vec3 pos;\nattribute float radius;\nattribute vec3 fillColor;\nattribute vec3 strokeColor;\nattribute float fillOpacity;\nattribute float strokeWidth;\nattribute float strokeOpacity;\nattribute float fill;\nattribute float stroke;\nuniform float pixelWidth;\nuniform float aspect;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nvarying vec4 fillColorVar;\nvarying vec4 strokeColorVar;\nvarying float radiusVar;\nvarying float strokeWidthVar;\nvarying float fillVar;\nvarying float strokeVar;\n// non-sprite has ither definitions.\n\nvoid main(void)\n{\n  strokeWidthVar = strokeWidth;\n  // No stroke or fill implies nothing to draw\n  if (stroke < 1.0 || strokeWidth <= 0.0 || strokeOpacity <= 0.0) {\n    strokeVar = 0.0;\n    strokeWidthVar = 0.0;\n  }\n  else\n    strokeVar = 1.0;\n  if (fill < 1.0 || radius <= 0.0 || fillOpacity <= 0.0)\n    fillVar = 0.0;\n  else\n    fillVar = 1.0;\n  /* If the point has no visible pixels, skip doing computations on it. */\n  if (fillVar == 0.0 && strokeVar == 0.0) {\n    gl_Position = vec4(2, 2, 0, 1);\n    return;\n  }\n  fillColorVar = vec4 (fillColor, fillOpacity);\n  strokeColorVar = vec4 (strokeColor, strokeOpacity);\n  radiusVar = radius;\n  // for sprite\n  gl_Position = (projectionMatrix * modelViewMatrix * vec4(pos, 1.0)).xyzw;\n  gl_PointSize = 2.0 * (radius + strokeWidthVar);\n}\n"},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(50),a=function t(e){if(!(this instanceof t))return new t(e);e=e||{},o.call(this,e);var i=n(12),r=n(331),a=n(7),s=n(4),u=n(20),l=n(332),c=n(333);u.call(this);var h,d,f,p=this,m=this._exit,g=i.actor(),v=i.mapper(),y=i.material(),x=this._init,b=this._update;function _(){var t=new i.shader(i.GL.VERTEX_SHADER);return t.setShaderSource(c),t}function w(){var t=new i.shader(i.GL.FRAGMENT_SHADER);return t.setShaderSource(l),t}return this._init=function(t){var e=i.shaderProgram(),n=i.vertexAttribute("pos"),r=i.vertexAttribute("fillColor"),o=i.vertexAttribute("fillOpacity"),a=new i.modelViewUniform("modelViewMatrix"),s=new i.projectionUniform("projectionMatrix"),u=_(),l=w(),c=i.blend(),h=i.geometryData(),d=i.sourceDataP3fv({name:"pos"}),f=i.sourceDataAnyfv(3,i.vertexAttributeKeysIndexed.Two,{name:"fillColor"}),m=i.sourceDataAnyfv(1,i.vertexAttributeKeysIndexed.Three,{name:"fillOpacity"}),b=i.triangles();e.addVertexAttribute(n,i.vertexAttributeKeys.Position),e.addVertexAttribute(r,i.vertexAttributeKeysIndexed.Two),e.addVertexAttribute(o,i.vertexAttributeKeysIndexed.Three),e.addUniform(a),e.addUniform(s),e.addShader(l),e.addShader(u),y.addAttribute(e),y.addAttribute(c),g.setMaterial(y),g.setMapper(v),h.addSource(d),h.addSource(f),h.addSource(m),h.addPrimitive(b),h.computeBounds=function(){h.setBounds(0,0,0,0,0,0)},v.setGeometryData(h),x.call(p,t)},this.actors=function(){return[g]},this._build=function(){!function(t){var e,n,i,o,u,l,c,d,f,m,g,y,x,b,_,w,M,A,T,C,E,O,S,P,k,R,j,L,D=[],I=p.gcs(),F=p.layer().map().gcs(),N=0,z=v.geometryData();for(u=p.style.get("fillColor"),l=s.isFunction(p.style("fillColor"))?void 0:u(),d=p.style.get("fillOpacity"),f=s.isFunction(p.style("fillOpacity"))?void 0:d(),m=p.style.get("fill"),g=s.isFunction(p.style("fill"))?void 0:m(),y=p.style.get("uniformPolygon"),t?(D=h.items,N=h.numPts):(n=p.style.get("position"),i=p.style.get("polygon"),p.data().forEach(function(t,e){var o,s,u,l;if((o=i(t,e))&&!((s=o.outer||(Array.isArray(o)?o:[])).length<3)){for(u=new Array(3*s.length),E=T=0;E<s.length;E+=1,T+=3)l=n(s[E],E,t,e),u[T]=l.x,u[T+1]=l.y,u[T+2]=0;u={vertices:u,dimensions:3,holes:[]},L=s,o.inner&&o.inner.forEach(function(i){if(!(i.length<3))for(L=L.concat(i),u.holes.push(T/3),E=0;E<i.length;E+=1,T+=3)l=n(i[E],E,t,e),u.vertices[T]=l.x,u.vertices[T+1]=l.y,u.vertices[T+2]=0}),u.vertices=a.transformCoordinates(I,F,u.vertices,u.dimensions),(k={triangles:r(u.vertices,u.holes,u.dimensions),vertices:u.vertices,original:L,item:t,itemIndex:e}).triangles.length&&(D.push(k),N+=k.triangles.length)}}),e=s.getGeomBuffer(z,"pos",3*N),(b=z.primitive(0).indices())instanceof Uint16Array&&b.length===N||(b=new Uint16Array(N),z.primitive(0).setIndices(b)),h={items:D,numPts:N}),o=s.getGeomBuffer(z,"fillColor",3*N),c=s.getGeomBuffer(z,"fillOpacity",N),A=T=0,_=l,M=g,S=0;S<D.length;S+=1)if(P=D[S].triangles.length,C=D[S].vertices,R=D[S].item,j=D[S].itemIndex,L=D[S].original,w=f,(x=y(R,j))&&(void 0===l&&(_=u(C[0],0,R,j)),void 0===f&&(w=d(C[0],0,R,j))),void 0===g&&(M=m(R,j)),M||(w=0),x&&t&&D[S].uniform&&D[S].color&&_.r===D[S].color.r&&_.g===D[S].color.g&&_.b===D[S].color.b&&w===D[S].opacity)A+=P,T+=3*P;else{for(E=0;E<P;E+=1,A+=1,T+=3)t&&x?(o[T]=_.r,o[T+1]=_.g,o[T+2]=_.b,c[A]=w):(O=3*D[S].triangles[E],t||(e[T]=C[O],e[T+1]=C[O+1],e[T+2]=C[O+2],b[A]=E),x||void 0!==l||(_=u(L[O],O,R,j)),o[T]=_.r,o[T+1]=_.g,o[T+2]=_.b,x||void 0!==f||(w=d(L[O],O,R,j)),c[A]=w);(x||D[S].uniform)&&(D[S].uniform=x,D[S].color=_,D[S].opacity=w)}v.modified(),t||(z.boundsDirty(!0),v.boundsDirtyTimestamp().modified())}(p.dataTime().timestamp()<p.buildTime().timestamp()&&h),p.renderer().contextRenderer().hasActor(g)||(p.renderer().contextRenderer().addActor(g),d=!0),p.buildTime().modified()},this._update=function(t){p.ready&&(t&&t.mayDelay&&d?f=p.layer().map().scheduleAnimationFrame(p._update):(f&&(p.layer().map().scheduleAnimationFrame(p._update,"remove"),f=null),b.call(p),(p.dataTime().timestamp()>=p.buildTime().timestamp()||p.updateTime().timestamp()<=p.timestamp())&&p._build(),g.setVisible(p.visible()),g.material().setBinNumber(p.bin()),p.updateTime().modified()))},this._exit=function(){f&&p.layer()&&(p.layer().map().scheduleAnimationFrame(p._update,"remove"),f=null),p.renderer().contextRenderer().removeActor(g),m()},this._init(e),this};i(a,o),r("webgl","polygon",a),t.exports=a},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,s,u,l,c,f,m,g=e&&e.length,v=g?e[0]*n:t.length,y=r(t,0,v,n,!0),x=[];if(!y||y.next===y.prev)return x;if(g&&(y=function(t,e,n,i){var a,s,u,l,c,f=[];for(a=0,s=e.length;a<s;a++)u=e[a]*i,l=a<s-1?e[a+1]*i:t.length,(c=r(t,u,l,i,!1))===c.next&&(c.steiner=!0),f.push(p(c));for(f.sort(h),a=0;a<f.length;a++)d(f[a],n),n=o(n,n.next);return n}(t,e,y,n)),t.length>80*n){i=u=t[0],s=l=t[1];for(var b=n;b<v;b+=n)c=t[b],f=t[b+1],c<i&&(i=c),f<s&&(s=f),c>u&&(u=c),f>l&&(l=f);m=0!==(m=Math.max(u-i,l-s))?1/m:0}return a(y,x,n,i,s,m),x}function r(t,e,n,i,r){var o,a;if(r===T(t,e,n,i)>0)for(o=e;o<n;o+=i)a=w(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=w(o,t[o],t[o+1],a);return a&&y(a,a.next)&&(M(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==v(i.prev,i,i.next))i=i.next;else{if(M(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function a(t,e,n,i,r,h,d){if(t){!d&&h&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=f(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,a,s,u,l=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,i=n,s=0,e=0;e<l&&(s++,i=i.nextZ);e++);for(u=l;s>0||u>0&&i;)0!==s&&(0===u||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(a>1)}(r)}(t,i,r,h);for(var p,m,g=t;t.prev!==t.next;)if(p=t.prev,m=t.next,h?u(t,i,r,h):s(t))e.push(p.i/n),e.push(t.i/n),e.push(m.i/n),M(t),t=m.next,g=m.next;else if((t=m)===g){d?1===d?a(t=l(t,e,n),e,n,i,r,h,2):2===d&&c(t,e,n,i,r,h):a(o(t),e,n,i,r,h,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(v(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(m(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&v(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function u(t,e,n,i){var r=t.prev,o=t,a=t.next;if(v(r,o,a)>=0)return!1;for(var s=r.x<o.x?r.x<a.x?r.x:a.x:o.x<a.x?o.x:a.x,u=r.y<o.y?r.y<a.y?r.y:a.y:o.y<a.y?o.y:a.y,l=r.x>o.x?r.x>a.x?r.x:a.x:o.x>a.x?o.x:a.x,c=r.y>o.y?r.y>a.y?r.y:a.y:o.y>a.y?o.y:a.y,h=f(s,u,e,n,i),d=f(l,c,e,n,i),p=t.prevZ,g=t.nextZ;p&&p.z>=h&&g&&g.z<=d;){if(p!==t.prev&&p!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,g!==t.prev&&g!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&v(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;p&&p.z>=h;){if(p!==t.prev&&p!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;g&&g.z<=d;){if(g!==t.prev&&g!==t.next&&m(r.x,r.y,o.x,o.y,a.x,a.y,g.x,g.y)&&v(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function l(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!y(r,o)&&x(r,i,i.next,o)&&b(r,o)&&b(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),M(i),M(i.next),i=t=o),i=i.next}while(i!==t);return i}function c(t,e,n,i,r,s){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&g(u,l)){var c=_(u,l);return u=o(u,u.next),c=o(c,c.next),a(u,e,n,i,r,s),void a(c,e,n,i,r,s)}l=l.next}u=u.next}while(u!==t)}function h(t,e){return t.x-e.x}function d(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>a){if(a=s,s===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===a)return n.prev;var u,l=n,c=n.x,h=n.y,d=1/0;i=n.next;for(;i!==l;)r>=i.x&&i.x>=c&&r!==i.x&&m(o<h?r:a,o,c,h,o<h?a:r,o,i.x,i.y)&&((u=Math.abs(o-i.y)/(r-i.x))<d||u===d&&i.x>n.x)&&b(i,t)&&(n=i,d=u),i=i.next;return n}(t,e)){var n=_(e,t);o(n,n.next)}}function f(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function p(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function m(t,e,n,i,r,o,a,s){return(r-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(r-a)*(i-s)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&x(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&b(t,e)&&b(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,n,i){return!!(y(t,e)&&y(n,i)||y(t,i)&&y(n,e))||v(t,e,n)>0!=v(t,e,i)>0&&v(n,i,t)>0!=v(n,i,e)>0}function b(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function _(t,e){var n=new A(t.i,t.x,t.y),i=new A(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function w(t,e,n,i){var r=new A(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function A(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,i){for(var r=0,o=e,a=n-i;o<n;o+=i)r+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return r}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,a=Math.abs(T(t,0,o,n));if(r)for(var s=0,u=e.length;s<u;s++){var l=e[s]*n,c=s<u-1?e[s+1]*n:t.length;a-=Math.abs(T(t,l,c,n))}var h=0;for(s=0;s<i.length;s+=3){var d=i[s]*n,f=i[s+1]*n,p=i[s+2]*n;h+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===a&&0===h?0:Math.abs((h-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[r][o][a]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},function(t,e){t.exports="/* polygonFeature fragment shader */\n\n#ifdef GL_ES\n  precision highp float;\n#endif\nvarying vec4 fillColorVar;\n\nvoid main () {\n  gl_FragColor = fillColorVar;\n}\n"},function(t,e){t.exports="/* polygonFeature vertex shader */\n\nattribute vec3 pos;\nattribute vec3 fillColor;\nattribute float fillOpacity;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nvarying vec4 fillColorVar;\n\nvoid main(void)\n{\n  vec4 clipPos = projectionMatrix * modelViewMatrix * vec4(pos.xyz, 1.0);\n  if (clipPos.w != 0.0) {\n    clipPos = clipPos/clipPos.w;\n  }\n  fillColorVar = vec4(fillColor, fillOpacity);\n  gl_Position = clipPos;\n}\n"},function(t,e,n){"use strict";var i=n(0),r=n(1).registerFeature,o=n(18),a=n(9),s=function t(e){if(!(this instanceof t))return new t(e);o.call(this,e);var i=n(2),r=n(12),s=n(20),u=n(335),l=n(336),c=n(337),h=n(338);s.call(this);var d,f,p,m,g,v,y,x=this,b=this._exit,_=this._update,w={},M=a(),A=a();function T(t){var e=new r.mapper({dynamicDraw:!0});return e.s_modified=e.modified,e.g_timestamp=a(),e.timestamp=e.g_timestamp.timestamp,e.modified=function(){return e.s_modified(),e.g_timestamp.modified(),e},e.s_render=e.render,e.render=t,e}return this.actors=function(){var t=[];return f&&t.push(f),p&&t.push(p),t},this._build=function(){var t,e,n,i,o,a,s;x.position()&&((y=x._generateQuads()).imgQuads.length&&!f&&(x.visible(!1),t=T(x._renderImageQuads),(f=new r.actor).setMapper(t),e=new r.material,(n=new r.shaderProgram).addVertexAttribute(new r.vertexAttribute("vertexPosition"),r.vertexAttributeKeys.Position),n.addVertexAttribute(new r.vertexAttribute("textureCoord"),r.vertexAttributeKeys.TextureCoordinate),d=new r.modelViewOriginUniform("modelViewMatrix",y.origin),n.addUniform(d),n.addUniform(new r.projectionUniform("projectionMatrix")),n.addUniform(new r.floatUniform("opacity",1)),n.addUniform(new r.floatUniform("zOffset",0)),s=x.renderer()._glContext(),(o=new r.uniform(s.FLOAT_VEC2,"crop")).set([1,1]),n.addUniform(o),n.addShader(r.getCachedShader(s.VERTEX_SHADER,s,l)),n.addShader(r.getCachedShader(s.FRAGMENT_SHADER,s,u)),e.addAttribute(n),e.addAttribute(new r.blend),a=new r.geometryData,m=void 0,(i=new r.sourceDataT2fv).pushBack([0,0,1,0,0,1,1,1]),a.addSource(i),t.setGeometryData(a),f.setMaterial(e),x.renderer().contextRenderer().addActor(f),x.visible(!0)),y.clrQuads.length&&!p&&(x.visible(!1),t=T(x._renderColorQuads),(p=new r.actor).setMapper(t),e=new r.material,(n=new r.shaderProgram).addVertexAttribute(new r.vertexAttribute("vertexPosition"),r.vertexAttributeKeys.Position),v=new r.modelViewOriginUniform("modelViewMatrix",y.origin),n.addUniform(v),n.addUniform(new r.projectionUniform("projectionMatrix")),n.addUniform(new r.floatUniform("opacity",1)),n.addUniform(new r.floatUniform("zOffset",0)),s=x.renderer()._glContext(),n.addUniform(new r.uniform(s.FLOAT_VEC3,"vertexColor")),n.addShader(r.getCachedShader(s.VERTEX_SHADER,s,h)),n.addShader(r.getCachedShader(s.FRAGMENT_SHADER,s,c)),e.addAttribute(n),e.addAttribute(new r.blend),a=new r.geometryData,g=void 0,t.setGeometryData(a),p.setMaterial(e),x.renderer().contextRenderer().addActor(p),x.visible(!0)),d&&d.setOrigin(y.origin),v&&v.setOrigin(y.origin),x._updateTextures(),x.buildTime().modified())},this._updateTextures=function(){var t;i.each(y.imgQuads,function(e,n){n.image&&(n.image._texture?n.texture=n.image._texture:((t=new r.texture).setImage(n.image),n.texture=n.image._texture=t))})},this._renderColorQuads=function(t){if(y.clrQuads.length){(this.timestamp()>A.timestamp()||x.dataTime().timestamp()>A.timestamp()||t.m_contextChanged||!g||12*y.clrQuads.length>g.length)&&function(t){var e=t.m_context,n=!1;y.clrQuads.length&&((!g||g.length<12*y.clrQuads.length||!w.clrQuadsPosition)&&(w.clrQuadsPosition&&e.deleteBuffer(w.clrQuadsPosition),w.clrQuadsPosition=e.createBuffer(),g=new Float32Array(12*Math.max(128,2*y.clrQuads.length)),n=!0),i.each(y.clrQuads,function(t,e){for(var n=0;n<12;n+=1)g[12*t+n]=e.pos[n]-y.origin[n%3]}),e.bindBuffer(e.ARRAY_BUFFER,w.clrQuadsPosition),n?e.bufferData(e.ARRAY_BUFFER,g,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,g)),A.modified()}(t),this.s_render(t,!0);var e,n,o,a=t.m_context;a.bindBuffer(a.ARRAY_BUFFER,w.clrQuadsPosition),i.each(y.clrQuads,function(i,s){s.opacity!==e&&(e=s.opacity,a.uniform1fv(t.m_material.shaderProgram().uniformLocation("opacity"),new Float32Array([e]))),(s.zOffset||0)!==n&&(n=s.zOffset||0,a.uniform1fv(t.m_material.shaderProgram().uniformLocation("zOffset"),new Float32Array([n]))),o&&o.r===s.color.r&&o.g===s.color.g&&o.b===s.color.b||(o=s.color,a.uniform3fv(t.m_material.shaderProgram().uniformLocation("vertexColor"),new Float32Array([o.r,o.g,o.b]))),a.bindBuffer(a.ARRAY_BUFFER,w.clrQuadsPosition),a.vertexAttribPointer(r.vertexAttributeKeys.Position,3,a.FLOAT,!1,12,12*i*4),a.enableVertexAttribArray(r.vertexAttributeKeys.Position),a.drawArrays(a.TRIANGLE_STRIP,0,4)}),a.bindBuffer(a.ARRAY_BUFFER,null),this.undoBindVertexData(t)}},this._renderImageQuads=function(t){if(y.imgQuads.length){(this.timestamp()>M.timestamp()||x.dataTime().timestamp()>M.timestamp()||t.m_contextChanged||!m||12*y.imgQuads.length>m.length)&&function(t){var e=t.m_context,n=!1;y.imgQuads.length&&((!m||m.length<12*y.imgQuads.length||!w.imgQuadsPosition)&&(w.imgQuadsPosition&&e.deleteBuffer(w.imgQuadsPosition),w.imgQuadsPosition=e.createBuffer(),m=new Float32Array(12*Math.max(128,2*y.imgQuads.length)),n=!0),i.each(y.imgQuads,function(t,e){for(var n=0;n<12;n+=1)m[12*t+n]=e.pos[n]-y.origin[n%3]}),e.bindBuffer(e.ARRAY_BUFFER,w.imgQuadsPosition),n?e.bufferData(e.ARRAY_BUFFER,m,e.DYNAMIC_DRAW):e.bufferSubData(e.ARRAY_BUFFER,0,m)),M.modified()}(t),this.s_render(t,!0);var e,n,o,a=t.m_context,s={x:1,y:1};a.bindBuffer(a.ARRAY_BUFFER,w.imgQuadsPosition),i.each(y.imgQuads,function(i,u){u.image&&(u.texture.bind(t),u.opacity!==e&&(e=u.opacity,a.uniform1fv(t.m_material.shaderProgram().uniformLocation("opacity"),new Float32Array([e]))),(u.zOffset||0)!==n&&(n=u.zOffset||0,a.uniform1fv(t.m_material.shaderProgram().uniformLocation("zOffset"),new Float32Array([n]))),o=u.crop||{x:1,y:1},s&&o.x===s.x&&o.y===s.y||(s=o,a.uniform2fv(t.m_material.shaderProgram().uniformLocation("crop"),new Float32Array([s.x,s.y]))),a.bindBuffer(a.ARRAY_BUFFER,w.imgQuadsPosition),a.vertexAttribPointer(r.vertexAttributeKeys.Position,3,a.FLOAT,!1,12,12*i*4),a.enableVertexAttribArray(r.vertexAttributeKeys.Position),a.drawArrays(a.TRIANGLE_STRIP,0,4),u.texture.undoBind(t))}),a.bindBuffer(a.ARRAY_BUFFER,null),this.undoBindVertexData(t)}},this._update=function(){_.call(x),(x.buildTime().timestamp()<=x.dataTime().timestamp()||x.updateTime().timestamp()<x.timestamp())&&x._build(),p&&(p.setVisible(x.visible()),p.material().setBinNumber(x.bin())),f&&(f.setVisible(x.visible()),f.material().setBinNumber(x.bin())),x.updateTime().modified()},this._cleanup=function(){f&&(x.renderer().contextRenderer().removeActor(f),f=null),p&&(x.renderer().contextRenderer().removeActor(p),p=null),m=void 0,g=void 0,Object.keys(w).forEach(function(t){delete w[t]}),y&&y.imgQuads&&(y.imgQuads.forEach(function(t){t.texture&&(delete t.texture,delete t.image._texture)}),x._updateTextures()),x.modified()},this._exit=function(){x._cleanup(),b.call(x)},x._init(e),this};i(s,o);var u={};u[o.capabilities.color]=!0,u[o.capabilities.image]=!0,u[o.capabilities.imageCrop]=!0,u[o.capabilities.imageFixedScale]=!1,u[o.capabilities.imageFull]=!0,u[o.capabilities.canvas]=!1,u[o.capabilities.video]=!1,r("webgl","quad",s,u),t.exports=s},function(t,e){t.exports="/* quadFeature Image fragment shader */\n\nvarying highp vec2 iTextureCoord;\nuniform sampler2D sampler2d;\nuniform mediump float opacity;\nuniform highp vec2 crop;\n\nvoid main(void) {\n  mediump vec4 color = texture2D(sampler2d, iTextureCoord);\n  if ((crop.s < 1.0 && iTextureCoord.s > crop.s) || (crop.t < 1.0 && 1.0 - iTextureCoord.t > crop.t)) {\n    discard;\n  }\n  color.w *= opacity;\n  gl_FragColor = color;\n}\n\n"},function(t,e){t.exports="/* quadFeature Image vertex shader */\n\nattribute vec3 vertexPosition;\nattribute vec2 textureCoord;\nuniform float zOffset;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nvarying highp vec2 iTextureCoord;\n\nvoid main(void) {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);\n  gl_Position.z += zOffset;\n  iTextureCoord = textureCoord;\n}\n\n"},function(t,e){t.exports="/* quadFeature Color fragment shader */\n\nvarying mediump vec3 iVertexColor;\nuniform mediump float opacity;\n\nvoid main(void) {\n  gl_FragColor = vec4(iVertexColor, opacity);\n}\n"},function(t,e){t.exports="/* quadFeature Color vertex shader */\n\nattribute vec3 vertexPosition;\nuniform float zOffset;\nuniform vec3 vertexColor;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nvarying mediump vec3 iVertexColor;\n\nvoid main(void) {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(vertexPosition, 1.0);\n  gl_Position.z += zOffset;\n  iVertexColor = vertexColor;\n}\n\n"},function(t,e,n){"use strict";var i=n(1).registerLayerAdjustment,r=n(56),o=function(){var t,e=this,n=this._init,i=this._exit,o=this._update,a=this.visible,s=this.zIndex,u=0,l=[];this._drawTile=function(n){if(t){var i,o,a=e._tileBounds(n),s=n.index.level||0,c=e._tileOffset(s),h=e.tileCropFromBounds(n),d={},f=e.renderer().contextRenderer().m_depthBits;h&&(d.crop={x:h.x/e._options.tileWidth,y:h.y/e._options.tileHeight}),d.ul=e.fromLocal(e.fromLevel({x:a.left-c.x,y:a.top-c.y},s),0),d.ll=e.fromLocal(e.fromLevel({x:a.left-c.x,y:a.bottom-c.y},s),0),d.ur=e.fromLocal(e.fromLevel({x:a.right-c.x,y:a.top-c.y},s),0),d.lr=e.fromLocal(e.fromLevel({x:a.right-c.x,y:a.bottom-c.y},s),0),d.ul.z=d.ll.z=d.ur.z=d.lr.z=0,i=e._options.keepLower?e._options.maxLevel-s+1:1,(o=(o=e.map().listSceneObjects().filter(function(t){return t instanceof r})).slice(o.indexOf(e)+1)).forEach(function(t){i+=t._options.keepLower?t._options.maxLevel-t._options.minLevel+1:1}),d.zOffset=i*Math.pow(2,-f)*r._zOffsetMultiple,u+=1,d.id=u,n.quadId=d.id,d.image=n.image,l.push(d),t.data(l),t._update(),e.draw()}},this._remove=function(n){if(void 0!==n.quadId&&t){for(var i=0;i<l.length;i+=1)if(l[i].id===n.quadId){l.splice(i,1);break}t.data(l),t._update(),e.draw()}},this.visible=function(n){return void 0===n?a():(e.visible()!==n&&(a(n),t&&t.visible(t.visible(void 0,!0),!0)),e)},this.zIndex=function(n,i){return void 0!==n&&(e.clear(),t&&t.modified()),s.apply(e,arguments)},this._update=function(n){return o.call(e,n),t&&t._update(),e},this._cleanup=function(){var t;if(e.cache&&e.cache._cache){for(var n in e.cache._cache)(t=e.cache._cache[n])._image&&t._image._texture&&delete t._image._texture;e.cache.clear()}e.clear()},this._exit=function(){e._cleanup(),e.deleteFeature(t),t=null,l=[],i.apply(e,arguments)},this._init=function(){n.apply(e,arguments),(t=e.createFeature("quad",{previewColor:e._options.previewColor,previewImage:e._options.previewImage})).geoTrigger=void 0,t.gcs(e._options.gcs||e.map().gcs()),t.data(l),t._update()},this._getSubLayer=function(){},this._updateSubLayers=void 0};r._zOffsetMultiple=2,i("webgl","tile",o),t.exports=o},function(t,e,n){"use strict";t.exports={colorLegendWidget:n(341),domWidget:n(134),legendWidget:n(344),scaleWidget:n(345),sliderWidget:n(348),svgWidget:n(38),uiLayer:n(128),widget:n(57)}},function(t,e,n){"use strict";var i=n(10).d3,r=n(134),o=n(0),a=n(1).registerWidget,s=n(4),u=n(52);n(342);var l=function t(e){if(!(this instanceof t))return new t(e);r.call(this,e);var n=this,o=[],a=e.width||300,l=e.ticks||6,h=this._init;return this._init=function(){h();var t=n.canvas();i.select(t).attr("class","color-legend-container"),n.popup=i.select(t).append("div").attr("class","color-legend-popup"),e.categories&&n.categories(e.categories)},this._draw=function(){if(i.select(n.canvas()).selectAll("div.geojs-color-legends").remove(),o.length){i.select(n.canvas()).style("display","block");var t=i.select(n.canvas()).append("div").attr("class","geojs-color-legends"),e=a;o.forEach(function(i,r){var o=t.append("div").attr("class","geojs-color-legend");o.append("div").attr("class","geojs-title").text(i.name);var a=o.append("svg").attr({class:"svg",width:e,height:"40px",viewBox:"-20 0 "+e+" 40"});"discrete"===i.type?n._drawDiscrete(a,e-40,i):"continuous"===i.type&&n._drawContinous(a,e-40,i)})}else i.select(n.canvas()).style("display","none")},this.categories=function(t){return void 0===t?o:(o=n._prepareCategories(t),n._draw(),n)},this.addCategories=function(t){return o=o.concat(n._prepareCategories(t)),n._draw(),n},this.removeCategories=function(t){return o=o.filter(function(e){return-1===t.indexOf(e)}),n._draw(),n},this._prepareCategories=function(t){return t.forEach(function(t){t.color=t.colors.map(function(t){return s.convertColorToHex(t,!0)})}),t},this._drawDiscrete=function(t,e,r){if(-1===["linear","log","sqrt","pow","quantile","ordinal"].indexOf(r.scale))throw new Error("unsupported scale");var o,a,u,h,d,f,p;if("ordinal"===r.scale)u=i.scale.ordinal().domain(r.domain).range(r.colors),n._renderDiscreteColors(t,r.domain,u,e,function(t){return t}),h=i.scale.ordinal().domain(r.domain).rangeRoundBands([0,e]),d=i.svg.axis().scale(h).tickValues(function(){var t=Math.ceil(r.domain.length/l);return r.domain.filter(function(e,n){return n%t==0})});else if("quantile"===r.scale){o=[0,r.colors.length],f=s.range(0,r.colors.length-1),a=i.scale.quantile().domain(r.domain).range(f),u=i.scale.quantize().domain(o).range(r.colors),n._renderDiscreteColors(t,f,u,e,function(t){return a.invertExtent(t).join(" - ")});var m=[a.invertExtent(0)[0]];m=m.concat(f.map(function(t){return a.invertExtent(t)[1]})),d=v(h=i.scale.ordinal().domain(m).rangePoints([0,e]))}else if(-1!==["linear","log","sqrt","pow"].indexOf(r.scale)){o=[0,r.colors.length],a=i.scale[r.scale]().domain(r.domain).range(o).nice(),u=i.scale.quantize().domain(o).range(r.colors),f=s.range(0,r.colors.length-1);var g=Math.max.apply(null,r.domain.map(function(t){return c(t)}));n._renderDiscreteColors(t,f,u,e,function(t){return n._popupFormatter(a.invert(t),g)+" - "+n._popupFormatter(a.invert(t+1),g)}),(p=f.slice()).push(r.colors.length),d=v(h=i.scale.ordinal().domain(p.map(function(t){return a.invert(t)})).rangePoints([0,e]))}function v(t){return i.svg.axis().scale(t).tickFormat(i.format(".2s")).tickValues(function(){var e=Math.ceil(t.domain().length/l);return t.domain().filter(function(t,n){return n%e==0})})}r.endAxisLabelOnly&&d.tickValues([h.domain()[0],h.domain()[h.domain().length-1]]),n._renderAxis(t,d)},this._renderDiscreteColors=function(t,e,i,r,o){t.selectAll("rect").data(e).enter().append("rect").attr("width",r/e.length).attr("height","20px").attr("fill",function(t){return i(t)}).attr("transform",function(t,n){return"translate("+n*r/e.length+" ,0)"}).on("mousemove",function(t){n._showPopup(o(t))}).on("mouseout",n._hidePopup)},this._drawContinous=function(t,e,r){var o,a,s;if(-1===["linear","log","sqrt","pow"].indexOf(r.scale))throw new Error("unsupported scale");var h=[0];for(s=1;s<r.domain.length-1;s++)h.push(e/(r.domain.length-1)*s);h.push(e),o=i.scale[r.scale]().domain(r.domain).range(h).nice(),"log"===r.scale&&r.base&&o.base(r.base),"pow"===r.scale&&r.exponent&&o.exponent(r.exponent);var d=u(),f=Math.max.apply(null,r.domain.map(function(t){return c(t)})),p=t.append("defs").append("linearGradient").attr("id","gradient"+d);for(p.append("stop").attr("offset","0%").attr("stop-color",r.colors[0]),s=1;s<r.colors.length-1;s++)p.append("stop").attr("offset",(100/(r.colors.length-1)*s).toFixed(6)+"%").attr("stop-color",r.colors[s]);p.append("stop").attr("offset","100%").attr("stop-color",r.colors[r.colors.length-1]),t.append("rect").attr("fill","url(#gradient"+d+")").attr("width",e).attr("height","20px").on("mousemove",function(){var t=o.invert(i.mouse(this)[0]),e=n._popupFormatter(t,f);n._showPopup(e)}).on("mouseout",n._hidePopup),a=i.svg.axis().scale(o).ticks(l,".2s"),r.endAxisLabelOnly&&a.tickValues([r.domain[0],r.domain[r.domain.length-1]]),n._renderAxis(t,a)},this._renderAxis=function(t,e){t.append("g").attr("class","axis x").attr("transform","translate(0, 20)").call(function(t){t.call(e)})},this._popupFormatter=function(t,e){return t=parseFloat(t.toFixed(8)),e=Math.min(e,c(t)),e=Math.min(e,Math.max(3,7-Math.trunc(t).toString().length)),i.format("."+e+"f")(t)},this._showPopup=function(t){var e=i.mouse(n.canvas());n.popup.text(t);var r=n.canvas().clientWidth,o=n.popup[0][0].clientWidth;n.popup.style({left:e[0]-(e[0]+o-r>-10?o:0)+"px",top:e[1]-22+"px"}).transition().duration(200).style("opacity",1)},this._hidePopup=function(){n.popup.transition().duration(200).style("opacity",0)},this};function c(t){if(!isFinite(t))return 0;for(var e=1,n=0;Math.round(t*e)/e!==t;){if(!isFinite(t*e))return 0;e*=10,n++}return n}o(l,r),a("dom","colorLegend",l),t.exports=l},function(t,e,n){var i=n(343);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(40)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(39)(!1)).push([t.i,".color-legend-container {\n  display: none;\n  padding: 10px;\n  border: 1.5px solid #000;\n  border-radius: 3px;\n  transition: 250ms background linear;\n  background-color: rgba(255,255,255,0.75);\n}\n.color-legend-container:hover {\n  background-color: #fff;\n}\n.color-legend-container .geojs-color-legends .geojs-color-legend {\n  margin-bottom: 10px;\n}\n.color-legend-container .geojs-color-legends .geojs-color-legend .geojs-title {\n  text-align: center;\n}\n.color-legend-container .geojs-color-legends .geojs-color-legend svg.svg {\n  display: block;\n}\n.color-legend-container .geojs-color-legends .geojs-color-legend svg.svg .axis.x path.domain,\n.color-legend-container .geojs-color-legends .geojs-color-legend svg.svg .axis.x line {\n  fill: none;\n  stroke: #000;\n  stroke-width: 0.7;\n}\n.color-legend-container .geojs-color-legends .geojs-color-legend svg.svg .axis.x text {\n  font-size: 12px;\n}\n.color-legend-container .color-legend-popup {\n  position: absolute;\n  background: #fff;\n  height: 22px;\n  font-size: 14px;\n  border: solid 1px #000;\n  padding: 0 5px;\n  pointer-events: none;\n  white-space: nowrap;\n  z-index: 100000;\n  opacity: 0;\n}\n",""])},function(t,e,n){"use strict";var i=n(38),r=n(0),o=n(1).registerWidget,a=function t(e){if(!(this instanceof t))return new t(e);i.call(this,e);var r=n(10).d3,o=n(6),a=this,s=[],u=null,l=null,c=null;this.categories=function(t){return void 0===t?s.slice():(s=t.slice().map(function(t){return"line"===t.type&&(t.style.fill=!1,t.style.stroke=!0),t}),a.draw(),a)},this.size=function(){var t,e=1,n=r.select(a.canvas()).append("text").style("opacity",1e-6);return s.forEach(function(t){n.text(t.name),e=Math.max(e,n.node().getBBox().width)}),n.remove(),t=20*(s.length+1),{width:e+50,height:t}},this.draw=function(){function t(t){t.style("fill",function(t){return t.style.fill||void 0===t.style.fill?t.style.fillColor:"none"}).style("fill-opacity",function(t){return void 0===t.style.fillOpacity?1:t.style.fillOpacity}).style("stroke",function(t){return t.style.stroke||void 0===t.style.stroke?t.style.strokeColor:"none"}).style("stroke-opacity",function(t){return void 0===t.style.strokeOpacity?1:t.style.strokeOpacity}).style("stroke-width",function(t){return void 0===t.style.strokeWidth?1.5:t.style.strokeWidth})}a._init(),c.attr("height",a.size().height+24).style("display",null);var e=a._scale(),n=l.selectAll("g.geo-label").data(s,function(t){return t.name}).enter().append("g").attr("class","geo-label").attr("transform",function(t,n){return"translate(0,"+e.y(n)+")"});return t(n.filter(function(t){return"point"!==t.type&&"line"!==t.type}).append("rect").attr("x",0).attr("y",-6).attr("rx",5).attr("ry",5).attr("width",40).attr("height",12)),t(n.filter(function(t){return"point"===t.type}).append("circle").attr("cx",20).attr("cy",0).attr("r",6)),t(n.filter(function(t){return"line"===t.type}).append("line").attr("x1",0).attr("y1",0).attr("x2",40).attr("y2",0)),n.append("text").attr("x","50px").attr("y",0).attr("dy","0.3em").text(function(t){return t.name}),a.reposition(),a},this._scale=function(){return{x:r.scale.linear().domain([0,1]).range([0,a.size().width]),y:r.scale.linear().domain([0,s.length-1]).range([6,a.size().height-6])}},this._init=function(){u||(a._createCanvas(),a._appendCanvasToParent());var t=a.size().width+24+4,e=a.size().height+24+4;u&&u.remove(),r.select(a.canvas()).attr("width",t).attr("height",e),u=r.select(a.canvas()).append("g"),l=u.append("g").attr("transform","translate("+[14,14]+")"),c=l.append("rect").attr("x",-12).attr("y",-12).attr("width",t-4).attr("height",e-4).attr("rx",3).attr("ry",3).style({stroke:"black","stroke-width":"1.5px",fill:"white","fill-opacity":.75,display:"none"}),l.on("mousedown",function(){r.event.stopPropagation()}),l.on("mouseover",function(){c.transition().duration(250).style("fill-opacity",1)}),l.on("mouseout",function(){c.transition().duration(250).style("fill-opacity",.75)}),a.reposition()},this.geoOn(o.resize,function(){a.draw()})};r(a,i),o("dom","legend",a),t.exports=a},function(t,e,n){"use strict";var i=n(2),r=n(0),o=n(38),a=n(1).registerWidget;n(346);var s=function t(e){if(!(this instanceof t))return new t(e);o.call(this,e);var r=n(6),a=n(7),s=n(4),u=n(10).d3,l=this,c=this._exit,h=i.extend({},{scale:1,maxWidth:200,maxHeight:"left"===e.orientation||"right"===e.orientation?200:20,orientation:"bottom",strokeWidth:2,tickLength:10,units:"si",distance:function(t,e,n){return"+proj=longlat +axis=enu"===n?Math.sqrt(s.distance2dSquared(t,e)):a.sphericalDistance(t,e,n)}},e);this._init=function(){return l._createCanvas(),l._appendCanvasToParent(),l.reposition(),u.select(l.canvas()).attr({width:h.maxWidth,height:h.maxHeight}),l.geoOn(r.pan,l._update),l._render(),l},this._exit=function(){l.geoOff(r.pan,l._update),c()},this._vertical=function(){return"left"===h.orientation||"right"===h.orientation},this._scaleValue=function(e,n,i){var r,o,a,s=[{multiple:1,digits:1},{multiple:1.5,digits:2},{multiple:2,digits:1},{multiple:3,digits:1},{multiple:5,digits:1},{multiple:8,digits:1}],u=(i=t.unitsTable[i]||i||t.unitsTable[h.units]||h.units)[0];return i.forEach(function(t){e>=t.scale*(t.minimum||1)&&(u=t)}),o=Math.floor(Math.log(e/u.scale)/Math.log(u.basis||10)),(s=u.multiples||s).forEach(function(t){var n=u.scale*t.multiple*Math.pow(10,o);n<=e&&(r=t,a=n)}),{html:(r.multiple*Math.pow(10,o)).toFixed(Math.max(0,-o+r.digits-1))+" "+u.unit,value:a,pixels:a/e*n,power:o,multiple:r,unitRecord:u,originalValue:e,originalPixels:n}},this._render=function(){var t,e,n,r,o,a,s=u.select(l.canvas()),c=l.layer().map(),d=h.maxWidth,f=h.maxHeight,p=h.strokeWidth,m=.5*p,g=h.tickLength,v=l._vertical();if(t=(v?h.maxHeight:h.maxWidth)-p,n={x:(e={x:(e=i(s[0][0]).offset()).left+("left"===h.orientation?d-m:m),y:e.top+("top"===h.orientation?f-m:m)}).x+(v?0:t),y:e.y+(v?t:0)},(r=h.distance(c.displayToGcs(e,null),c.displayToGcs(n,null),c.gcs())*h.scale)<=0||!isFinite(r))console.warn("The distance calculated for the scale is invalid: "+r);else{switch(o=l._scaleValue(r,t),v?f=o.pixels+p:d=o.pixels+p,s.attr({width:d,height:f}),s.select("polyline").empty()&&s.append("polyline").classed("geojs-scale-widget-bar",!0).attr({fill:"none","stroke-width":p}),s.select("text").empty()&&s.append("text").classed("geojs-scale-widget-text",!0),h.orientation){case"bottom":a=[[m,g],[m,m],[d-m,m],[d-m,g]],s.select("text").attr({x:d/2,y:2*p,"text-anchor":"middle","dominant-baseline":"hanging"});break;case"top":a=[[m,f-g],[m,f-m],[d-m,f-m],[d-m,f-g]],s.select("text").attr({x:d/2,y:f-2*p,"text-anchor":"middle","dominant-baseline":"alphabetic"});break;case"left":a=[[d-g,m],[d-m,m],[d-m,f-m],[d-g,f-m]],s.select("text").attr({x:d-2*p,y:f/2,"text-anchor":"end","dominant-baseline":"middle"});break;case"right":a=[[g,m],[m,m],[m,f-m],[g,f-m]],s.select("text").attr({x:2*p,y:f/2,"text-anchor":"start","dominant-baseline":"middle"})}s.select("polyline").attr("points",a.map(function(t){return t.join(",")}).join(" ")),s.select("text").html(o.html)}},this._update=function(){l._render()},this.options=function(t,e){if(void 0===t){var n=i.extend({},h);return n.position=l.position(void 0,!0),n}return"string"==typeof t&&void 0===e?"position"===t?l.position(void 0,!0):h[t]:(void 0===e?h=i.extend(!0,h,t):h[t]=e,(t.position||"position"===t)&&l.position(t.position||e),l._render(),l)}};r(s,o),s.unitsTable={si:[{unit:"nm",scale:1e-9},{unit:"&mu;m",scale:1e-6},{unit:"mm",scale:.001},{unit:"m",scale:1},{unit:"km",scale:1e3}],miles:[{unit:"in",scale:.0254},{unit:"in",scale:.0254,basis:12,multiples:[{multiple:1,digits:1},{multiple:1.5,digits:2},{multiple:2,digits:1},{multiple:3,digits:1},{multiple:6,digits:1},{multiple:9,digits:1}]},{unit:"ft",scale:.3048},{unit:"mi",scale:1609.344}]},a("dom","scale",s),t.exports=s},function(t,e,n){var i=n(347);"string"==typeof i&&(i=[[t.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(40)(i,r);i.locals&&(t.exports=i.locals)},function(t,e,n){(t.exports=n(39)(!1)).push([t.i,".geojs-scale-widget-bar {\n  stroke: #000;\n}\n.geojs-scale-widget-text {\n  font-weight: bold;\n  font-size: 16px;\n  font-family: serif;\n}\n",""])},function(t,e,n){"use strict";var i=n(38),r=n(0),o=n(1).registerWidget,a=function t(e){if(!(this instanceof t))return new t(e);i.call(this,e);var r,o,a,s,u,l,c,h,d,f=n(10).d3,p=n(6),m=this,g=this._exit,v=e.width||20,y=e.height||160,x=e.width?.5*e.width:10,b=100;function _(t,e,n,i,r){var o=e.append("g"),a=r/1024;return o.append("g").append("g").attr("transform","translate("+n+","+i+") scale("+a+") translate(-512,-512)").append("path").attr("d",t).attr("class","geo-glyphicon"),o}l="M512 81.92c-237.568 0-430.080 192.614-430.080 430.080 0 237.568 192.563 430.080 430.080 430.080s430.080-192.563 430.080-430.080c0-237.517-192.563-430.080-430.080-430.080zM564.326 564.326v206.182h-104.653v-206.182h-206.234v-104.653h206.182v-206.234h104.704v206.182h206.182v104.704h-206.182z",c="M512 81.92c-237.568 0-430.080 192.614-430.080 430.080 0 237.568 192.563 430.080 430.080 430.080s430.080-192.563 430.080-430.080c0-237.517-192.563-430.080-430.080-430.080zM770.56 459.674v104.704h-517.12v-104.704h517.12z",d={white:"#f4f4f4",black:"#505050"},this.size=function(){return{width:v,height:y}},this._init=function(){m._createCanvas(),m._appendCanvasToParent(),m.reposition();var t=f.select(m.canvas()),e=m.layer().map();function n(n,i){var r=o.invert(f.mouse(t.node())[1]),a=e.zoomRange();r=(1-r)*(a.max-a.min)+a.min,i?e.transition({zoom:r,ease:f.ease("cubic-in-out"),duration:500,done:m._update()}):(e.zoom(r),m._update()),n.stopPropagation()}function i(){f.select(this).attr("filter",null),h.selectAll("circle,rect,path").transition().duration(b).style("fill",function(t){return d[t.fill]||null}).style("stroke",function(t){return d[t.stroke]||null})}return t.attr("width",v).attr("height",y),r=f.scale.linear().domain([-4,4]).range([0,v]),o=f.scale.linear().domain([0,1]).range([1.5*v,y-1.5*v]),t=t.append("g").classed("geo-ui-slider",!0),h=t,(a=t.append("g")).append("circle").datum({fill:"white",stroke:null}).classed("geo-zoom-in",!0).attr("cx",r(0)).attr("cy",o(0)-v+2).attr("r",(v-2)/2).style({cursor:"pointer"}).on("click",function(){var t=e.zoom();e.transition({zoom:t+1,ease:f.ease("cubic-in-out"),duration:500})}).on("mousedown",function(){f.event.stopPropagation()}),_(l,a,r(0),o(0)-v+2,v+4).style("cursor","pointer").style("pointer-events","none").select("path").datum({fill:"black",stroke:null}),(s=t.append("g")).append("circle").datum({fill:"white",stroke:null}).classed("geo-zoom-out",!0).attr("cx",r(0)).attr("cy",o(1)+v-2).attr("r",(v-2)/2).style({cursor:"pointer"}).on("click",function(){var t=e.zoom();e.transition({zoom:t-1,ease:f.ease("cubic-in-out"),duration:500})}).on("mousedown",function(){f.event.stopPropagation()}),_(c,s,r(0),o(1)+v-2,v+4).style("cursor","pointer").style("pointer-events","none").select("path").datum({fill:"black",stroke:null}),t.append("rect").datum({fill:"white",stroke:"black"}).classed("geo-zoom-track",!0).attr("x",r(0)-v/6).attr("y",o(0)).attr("rx",v/10).attr("ry",v/10).attr("width",v/3).attr("height",y-3*v).style({cursor:"pointer"}).on("click",function(){n(f.event,!0)}),u=t.append("rect").datum({fill:"black",stroke:null}).classed("geo-zoom-nub",!0).attr("x",r(-4)).attr("y",o(.5)-x/2).attr("rx",3).attr("ry",3).attr("width",v).attr("height",x).style({cursor:"pointer"}).on("mousedown",function(){f.select(document).on("mousemove.geo.slider",function(){n(f.event)}),f.select(document).on("mouseup.geo.slider",function(){n(f.event),f.select(document).on(".geo.slider",null)}),f.event.stopPropagation()}),h.selectAll("*").on("mouseover",function(){f.select(this).attr("filter","url(#geo-highlight)"),h.selectAll("rect,path,circle").transition().duration(b).style("fill",function(t){return t.fill||null}).style("stroke",function(t){return t.stroke||null})}).on("mouseout",i),m.geoOn(p.zoom,m._update),i(),m._update(),m},this._exit=function(){m.geoOff(p.zoom,m._update),h.remove(),g()},this._update=function(t){var e=m.layer().map(),n=e.zoomRange(),i=e.zoom(),r=f.scale.linear();i=(t=t||{}).value||i,r.domain([n.min,n.max]).range([1,0]).clamp(!0),u.attr("y",o(r(i))-x/2)}};r(a,i),o("dom","slider",a),t.exports=a}])});
//# sourceMappingURL=geo.lean.min.js.map