{"version":3,"sources":["vs/languages/html/common/htmlWorker.js","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/languages/html/common/htmlScanner.ts","vs/languages/html/common/fake","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/base/common/keyCodes.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/languages/html/common/htmlTags.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/editor/common/services/codeEditorService.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/platform/editor/common/editor.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/platform/keybinding/common/keybindingService.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/platform/keybinding/common/keybindingsRegistry.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/editor/common/config/config.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/editor/common/editorCommonExtensions.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/editor/contrib/hover/common/hover.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/editor/contrib/referenceSearch/common/referenceSearch.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/editor/contrib/suggest/common/suggest.ts","vs/languages/html/common/file:/C:/Alex/src/vscode/src/vs/languages/html/common/htmlWorker.ts"],"names":["define","require","exports","htmlTokenTypes_1","isDelimiter","tokenType","DELIM_START","DELIM_END","DELIM_ASSIGN","isInterestingToken","ATTRIB_NAME","ATTRIB_VALUE","isTag","getScanner","model","position","lineOffset","column","currentLine","lineNumber","tokens","getLineTokens","lineContent","getLineContent","tokenIndex","findIndexOfOffset","tokensOnLine","getTokenCount","getTokenType","tokenStart","getTokenStartIndex","tokenEnd","getTokenEndIndex","length","isAtTokenEnd","isAtTokenStart","getTokenContent","substring","isOpenBrace","charAt","getTokenPosition","getTokenRange","startLineNumber","startColumn","endLineNumber","endColumn","getModel","scanBack","scanForward","getLineCount","nls","data","create","defaultPlatform","createMapping","fill1","fill2","MAP","REVERSE_MAP","i","len","FINAL_REVERSE_MAP","entry","hasOwnProperty","toLowerCase","Mapping","_asString","keybinding","labelProvider","Platform","result","ctrlCmd","BinaryKeybindings","hasCtrlCmd","shift","hasShift","alt","hasAlt","winCtrl","hasWinCtrl","keyCode","extractKeyCode","keyLabel","getLabelForKey","isMacintosh","push","ctrlKeyLabel","shiftKeyLabel","altKeyLabel","cmdKeyLabel","windowsKeyLabel","actualResult","join","modifierSeparator","hasChord","extractChordPart","_pushKey","str","tagName","text","className","_asHTML","isChord","chordTo","concat","children","KeyCode","fromKeyCode","toKeyCode","this","_fromKeyCode","_toKeyCode","prototype","Unknown","STRING","TO_STRING_MAP","Backspace","Tab","Enter","Shift","Ctrl","Alt","PauseBreak","CapsLock","Escape","Space","PageUp","PageDown","End","Home","LeftArrow","UpArrow","RightArrow","DownArrow","Insert","Delete","KEY_0","KEY_1","KEY_2","KEY_3","KEY_4","KEY_5","KEY_6","KEY_7","KEY_8","KEY_9","KEY_A","KEY_B","KEY_C","KEY_D","KEY_E","KEY_F","KEY_G","KEY_H","KEY_I","KEY_J","KEY_K","KEY_L","KEY_M","KEY_N","KEY_O","KEY_P","KEY_Q","KEY_R","KEY_S","KEY_T","KEY_U","KEY_V","KEY_W","KEY_X","KEY_Y","KEY_Z","ContextMenu","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","F13","F14","F15","F16","F17","F18","F19","NumLock","ScrollLock","US_SEMICOLON","US_EQUAL","US_COMMA","US_MINUS","US_DOT","US_SLASH","US_BACKTICK","US_OPEN_SQUARE_BRACKET","US_BACKSLASH","US_CLOSE_SQUARE_BRACKET","US_QUOTE","OEM_8","OEM_102","NUMPAD_0","NUMPAD_1","NUMPAD_2","NUMPAD_3","NUMPAD_4","NUMPAD_5","NUMPAD_6","NUMPAD_7","NUMPAD_8","NUMPAD_9","NUMPAD_MULTIPLY","NUMPAD_ADD","NUMPAD_SEPARATOR","NUMPAD_SUBTRACT","NUMPAD_DECIMAL","NUMPAD_DIVIDE","FROM_STRING_MAP","USER_SETTINGS","TO_USER_SETTINGS_MAP","FROM_USER_SETTINGS_MAP","toString","key","fromString","BIN_CTRLCMD_MASK","BIN_SHIFT_MASK","BIN_ALT_MASK","BIN_WINCTRL_MASK","BIN_KEYCODE_MASK","extractFirstPart","KeyMod","chord","firstPart","secondPart","CtrlCmd","WinCtrl","CommonKeybindings","ENTER","SHIFT_ENTER","CTRLCMD_ENTER","WINCTRL_ENTER","TAB","SHIFT_TAB","ESCAPE","SPACE","DELETE","SHIFT_DELETE","CTRLCMD_BACKSPACE","UP_ARROW","SHIFT_UP_ARROW","CTRLCMD_UP_ARROW","DOWN_ARROW","SHIFT_DOWN_ARROW","CTRLCMD_DOWN_ARROW","LEFT_ARROW","RIGHT_ARROW","PAGE_UP","SHIFT_PAGE_UP","PAGE_DOWN","SHIFT_PAGE_DOWN","CTRLCMD_S","CTRLCMD_C","CTRLCMD_V","Keybinding","value","_toUSLabel","MacUIKeyLabelProvider","INSTANCE","ClassicUIKeyLabelProvider","_toUSAriaLabel","AriaKeyLabelProvider","_toUSHTMLLabel","_toCustomLabel","_toCustomHTMLLabel","_toElectronAccelerator","ElectronAcceleratorLabelProvider","getUserSettingsKeybindingRegex","_cachedKeybindingRegex","numpadKey","oemKey","specialKey","casualKey","mod","toUserSettingsLabel","UserSettingsKeyLabelProvider","replace","isWindows","fromUserSettingsLabel","input","trim","test","substr","firstSpaceIdx","indexOf","toCustomLabel","toCustomHTMLLabel","localize","leftArrowUnicodeLabel","upArrowUnicodeLabel","rightArrowUnicodeLabel","downArrowUnicodeLabel","String","fromCharCode","strings","getHTML5TagProvider","globalAttributes","eventHandlers","valueSets","b","u","o","y","w","d","m","fm","s","t","im","bt","lt","mt","mit","et","tk","pl","sh","xo","sb","tristate","autocomplete","current","dropeffect","invalid","live","orientation","relevant","sort","roles","collectTags","collector","collectTagsDefault","HTML_TAGS","collectAttributes","tag","collectAttributesDefault","forEach","handler","collectValues","attribute","collectValuesDefault","getAngularTagProvider","customTags","select","textarea","attributes","a","getIonicTagProvider","button","align","inputtype","listtype","menusides","navdir","navsides","scrolldir","trans","IONIC_TAGS","segments","split","tagSet","label","attr","tags","prefix","processAttributes","startsWith","typeInfo","values","customTagAttributes","HTMLTagSpecification","html","head","title","base","link","meta","style","body","article","section","nav","aside","h1","h2","h3","h4","h5","h6","header","footer","address","p","hr","pre","blockquote","ol","ul","li","dl","dt","dd","figure","figcaption","main","div","em","strong","small","cite","q","dfn","abbr","ruby","rb","rt","rp","time","code","var","samp","kbd","sub","sup","mark","bdi","bdo","span","br","wbr","ins","del","picture","img","iframe","embed","object","param","video","audio","source","track","map","area","table","caption","colgroup","col","tbody","thead","tfoot","tr","td","th","form","datalist","optgroup","option","output","progress","meter","fieldset","legend","details","summary","dialog","script","noscript","template","canvas","ion-checkbox","ion-content","ion-delete-button","ion-footer-bar","ion-header-bar","ion-infinite-scroll","ion-input","ion-item","ion-list","ion-modal-view","ion-nav-back-button","ion-nav-bar","ion-nav-buttons","ion-nav-title","ion-nav-view","ion-option-button","ion-pane","ion-popover-view","ion-radio","ion-refresher","ion-reorder-button","ion-scroll","ion-side-menu","ion-side-menu-content","ion-side-menus","ion-slide","ion-slide-box","ion-spinner","ion-tab","ion-tabs","ion-title","ion-toggle","ion-view ","instantiation_1","ID_CODE_EDITOR_SERVICE","ICodeEditorService","createDecorator","IEditorService","Position","POSITIONS","LEFT","CENTER","RIGHT","Direction","cmp","aType","getType","bType","KbExprType","KbDefinedExpression","KbNotExpression","KbEqualsExpression","KbNotEqualsExpression","Error","other","equals","evaluate","context","normalize","serialize","KbAndExpression","expr","_normalizeArr","arr","e","KbExpr","has","notEquals","not","and","_i","arguments","deserialize","serialized","pieces","_deserializeOne","serializedOne","_deserializeValue","serializedValue","exec","IKeybindingService","SET_CONTEXT_COMMAND_ID","keyCodes_1","platform","types_1","platform_1","KeybindingsRegistryImpl","WEIGHT","editorCore","importance","editorContrib","workbenchContrib","builtinExtension","externalExtension","_keybindings","_commands","Object","bindToCurrentPlatform","kb","win","mac","linux","registerCommandRule","rule","_this","actualKb","primary","registerDefaultKeybinding","id","weight","when","Array","isArray","secondary","k","registerCommandDesc","desc","description","constraints_1","_a","args","arg","constraint","accesor","validateConstraints","apply","getCommands","commandId","weight1","weight2","console","warn","command","getDefaultKeybindings","KeybindingsRegistry","Extensions","EditorModes","Registry","add","editor_1","keybindingService_1","keybindingsRegistry_1","editorCommon","codeEditorService_1","findFocusedEditor","accessor","complain","editor","get","getFocusedCodeEditor","withCodeEditorFromCommandHandler","callback","getActiveEditor","editorService","activeEditor","getControl","getEditorType","codeEditor","triggerEditorHandler","handlerId","trigger","registerCoreCommand","bind","KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS","registerCoreDispatchCommand2","desc2","getMacWordNavigationKB","getWordNavigationKB","registerWordCommand","selectAll","HANDLER","Handler","SelectAll","focusedEditor","isFocused","activeElement","document","H","Type","ReplacePreviousChar","Paste","Cut","CursorLeft","CursorLeftSelect","CursorRight","CursorRightSelect","CursorUp","CursorUpSelect","CursorDown","CursorDownSelect","CursorPageUp","CursorPageUpSelect","CursorPageDown","CursorPageDownSelect","CursorHome","CursorHomeSelect","CursorEnd","CursorEndSelect","ExpandLineSelection","ScrollLineUp","ScrollLineDown","ScrollPageUp","ScrollPageDown","CursorColumnSelectLeft","CursorColumnSelectRight","CursorColumnSelectUp","CursorColumnSelectPageUp","CursorColumnSelectDown","CursorColumnSelectPageDown","KEYBINDING_CONTEXT_EDITOR_TAB_MOVES_FOCUS","Outdent","DeleteLeft","DeleteRight","DeleteAllLeft","DeleteAllRight","CursorWordStartLeft","CursorWordEndLeft","CursorWordLeft","CursorWordStartLeftSelect","CursorWordEndLeftSelect","CursorWordLeftSelect","CursorWordEndRight","CursorWordStartRight","CursorWordRight","CursorWordEndRightSelect","CursorWordStartRightSelect","CursorWordRightSelect","DeleteWordLeft","DeleteWordStartLeft","DeleteWordEndLeft","DeleteWordRight","DeleteWordStartRight","DeleteWordEndRight","CancelSelection","KEYBINDING_CONTEXT_EDITOR_HAS_NON_EMPTY_SELECTION","RemoveSecondaryCursors","KEYBINDING_CONTEXT_EDITOR_HAS_MULTIPLE_SELECTIONS","CursorTop","CursorTopSelect","CursorBottom","CursorBottomSelect","LineBreakInsert","Undo","CursorUndo","Redo","errors_1","uri_1","descriptors_1","telemetry_1","config_1","position_1","modelService_1","triggerEditorAction","actionId","triggerEditorActionGlobal","action","getAction","ITelemetryService","publicLog","name","run","done","onUnexpectedError","whenRule","needsTextFocus","needsKey","KEYBINDING_CONTEXT_EDITOR_FOCUS","createCommandHandler","ContextKey","EditorActionDescriptor","ctor","kbOpts","alias","defaultEditorActionKeybindingOptions","CommonEditorRegistry","registerEditorAction","as","EditorCommonContributions","registerEditorContribution","registerEditorContribution2","getEditorContributions","getEditorContributions2","commandWeight","registerEditorCommand","commandDesc","registerLanguageCommand","undefined","registerDefaultLanguageCommand","resource","isIPosition","illegalArgument","IModelService","editorPosition","lift","SimpleEditorContributionDescriptor","_ctor","createInstance","instantiationService","InternalEditorActionDescriptor","_descriptor","createSyncDescriptor","instService","EditorContributionRegistry","editorContributions","EditorTextFocus","EditorFocus","kbExpr","slice","arrays_1","winjs_base_1","editorCommonExtensions_1","modes_1","async_1","getHover","supports","HoverProviderRegistry","ordered","promises","support","idx","asWinJsPromise","token","provideHover","then","hasRange","range","hasHtmlContent","htmlContent","err","TPromise","coalesce","provideReferences","ReferenceProviderRegistry","provider","includeDeclaration","references","references_1","ref","supports_1","provideCompletionItems","groups","SuggestRegistry","orderedGroups","factory","index","values_1","suggestResult","isFalsyOrEmpty","suggestions","currentWord","incomplete","sequence","snippets","SnippetsRegistry","getSnippets","Context","Visible","MultipleSuggestions","AcceptOnKey","__decorate","decorators","target","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","winjs","beautifyHTML","htmlTags","network","modes","workspace_1","markers_1","resourceService_1","htmlScanner_1","htmlEmptyTagsShared_1","suggestSupport_1","paths","hover_1","referenceSearch_1","suggest_1","isWhiteSpace","LinkDetectionState","HTMLWorker","modeId","resourceService","markerService","contextService","_modeId","_contextService","_tagProviders","addCustomTagProviders","providers","provideDocumentRangeFormattingEdits","options","formatHTML","getValueInRange","getValue","htmlOptions","indent_size","insertSpaces","tabSize","indent_char","wrap_line_length","getFormatOption","unformatted","getTagsFormatOption","indent_inner_html","preserve_newlines","max_preserve_newlines","indent_handlebars","end_with_newline","extra_liners","html_beautify","dflt","formatSettings","list","_doConfigure","format","_delegateToModeAtPosition","modelAtPosition","getEmbeddedAtPosition","modeAtPosition","getMode","getId","_delegateToAllModes","getAllEmbedded","isEmbeddedMode","findColorDeclarations","models","allPromises","filter","uri","results","oneResult","findMatchingOpenTag","scanner","closedTags","tagClosed","isEmptyElement","collectTagSuggestions","contentAfter","closeTag","collectClosingTagSuggestion","overwriteBefore","endPosition","matchingTag","suggestion","codeSnippet","type","startPosition","startIndent","endIndent","filterText","hasClose","documentationLabel","collectContentSuggestions","collectAttributeSuggestions","parentTag","collectAttributeValueSuggestions","needsQuotes","suggestHTML","doSuggest","filterSuggestions","getWordUntilPosition","word","findMatchingBracket","tagname","tagCount","isTagEnd","provideDocumentHighlights","strict","wordAtPosition","getWordAtPosition","kind","DocumentHighlightKind","Read","words","getAllWordsWithRange","upperBound","Math","min","_stripQuotes","url","match1","_getWorkspaceUrl","modelAbsoluteUri","rootAbsoluteUri","tokenContent","pickedScheme","Schemas","http","scheme","https","modelPath","dirname","path","alternativeResultPath","potentialResult","rootAbsoluteUrlStr","commonPrefixLength","endsWith","lastIndexOf","createLink","modelAbsoluteUrl","rootAbsoluteUrl","workspaceUrl","_computeHTMLLinks","lineContentLength","tokensLength","nextTokenEndIndex","lineCount","newLinks","state","LOOKING_FOR_HREF_OR_SRC","workspace","getWorkspace","strRootAbsoluteUrl","parse","AFTER_HREF_OR_SRC","provideLinks","IResourceService","IMarkerService","IWorkspaceContextService"],"mappings":"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","file":"vs/languages/html/common/htmlWorker.js","sourcesContent":["/*!-----------------------------------------------------------\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Version: 0.2.3(84e204b238a1eff25d4c6f611fdcd76a494005a7)\n * Released under the MIT license\n * https://github.com/Microsoft/vscode/blob/master/LICENSE.txt\n *-----------------------------------------------------------*/\n\ndefine(\"vs/languages/html/common/htmlScanner\", [\"require\", \"exports\", 'vs/languages/html/common/htmlTokenTypes'], function (require, exports, htmlTokenTypes_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    function isDelimiter(tokenType) {\r\n        switch (tokenType) {\r\n            case htmlTokenTypes_1.DELIM_START:\r\n            case htmlTokenTypes_1.DELIM_END:\r\n            case htmlTokenTypes_1.DELIM_ASSIGN:\r\n                return true;\r\n        }\r\n        return false;\r\n    }\r\n    function isInterestingToken(tokenType) {\r\n        switch (tokenType) {\r\n            case htmlTokenTypes_1.DELIM_START:\r\n            case htmlTokenTypes_1.DELIM_END:\r\n            case htmlTokenTypes_1.DELIM_ASSIGN:\r\n            case htmlTokenTypes_1.ATTRIB_NAME:\r\n            case htmlTokenTypes_1.ATTRIB_VALUE:\r\n                return true;\r\n        }\r\n        return htmlTokenTypes_1.isTag(tokenType);\r\n    }\r\n    function getScanner(model, position) {\r\n        var lineOffset = position.column - 1;\r\n        var currentLine = position.lineNumber;\r\n        var tokens = model.getLineTokens(currentLine);\r\n        var lineContent = model.getLineContent(currentLine);\r\n        var tokenIndex = tokens.findIndexOfOffset(lineOffset);\r\n        var tokensOnLine = tokens.getTokenCount();\r\n        var tokenType = tokens.getTokenType(tokenIndex);\r\n        var tokenStart = tokens.getTokenStartIndex(tokenIndex);\r\n        var tokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\r\n        if ((tokenType === '' || isDelimiter(tokenType)) && tokenStart === lineOffset) {\r\n            tokenIndex--;\r\n            if (tokenIndex >= 0) {\r\n                // we are at the end of a different token\r\n                tokenType = tokens.getTokenType(tokenIndex);\r\n                tokenStart = tokens.getTokenStartIndex(tokenIndex);\r\n                tokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\r\n            }\r\n            else {\r\n                tokenType = '';\r\n                tokenStart = tokenEnd = 0;\r\n            }\r\n        }\r\n        return {\r\n            getTokenType: function () { return tokenType; },\r\n            isAtTokenEnd: function () { return lineOffset === tokenEnd; },\r\n            isAtTokenStart: function () { return lineOffset === tokenStart; },\r\n            getTokenContent: function () { return lineContent.substring(tokenStart, tokenEnd); },\r\n            isOpenBrace: function () { return tokenStart < tokenEnd && lineContent.charAt(tokenStart) === '<'; },\r\n            getTokenPosition: function () { return { lineNumber: currentLine, column: tokenStart + 1 }; },\r\n            getTokenRange: function () { return { startLineNumber: currentLine, startColumn: tokenStart + 1, endLineNumber: currentLine, endColumn: tokenEnd + 1 }; },\r\n            getModel: function () { return model; },\r\n            scanBack: function () {\r\n                if (currentLine <= 0) {\r\n                    return false;\r\n                }\r\n                tokenIndex--;\r\n                do {\r\n                    while (tokenIndex >= 0) {\r\n                        tokenType = tokens.getTokenType(tokenIndex);\r\n                        tokenStart = tokens.getTokenStartIndex(tokenIndex);\r\n                        tokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\r\n                        if (isInterestingToken(tokenType)) {\r\n                            return true;\r\n                        }\r\n                        tokenIndex--;\r\n                    }\r\n                    currentLine--;\r\n                    if (currentLine > 0) {\r\n                        tokens = model.getLineTokens(currentLine);\r\n                        lineContent = model.getLineContent(currentLine);\r\n                        tokensOnLine = tokens.getTokenCount();\r\n                        tokenIndex = tokensOnLine - 1;\r\n                    }\r\n                } while (currentLine > 0);\r\n                tokens = null;\r\n                tokenType = lineContent = '';\r\n                tokenStart = tokenEnd = tokensOnLine = 0;\r\n                return false;\r\n            },\r\n            scanForward: function () {\r\n                if (currentLine > model.getLineCount()) {\r\n                    return false;\r\n                }\r\n                tokenIndex++;\r\n                do {\r\n                    while (tokenIndex < tokensOnLine) {\r\n                        tokenType = tokens.getTokenType(tokenIndex);\r\n                        tokenStart = tokens.getTokenStartIndex(tokenIndex);\r\n                        tokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\r\n                        if (isInterestingToken(tokenType)) {\r\n                            return true;\r\n                        }\r\n                        tokenIndex++;\r\n                    }\r\n                    currentLine++;\r\n                    tokenIndex = 0;\r\n                    if (currentLine <= model.getLineCount()) {\r\n                        tokens = model.getLineTokens(currentLine);\r\n                        lineContent = model.getLineContent(currentLine);\r\n                        tokensOnLine = tokens.getTokenCount();\r\n                    }\r\n                } while (currentLine <= model.getLineCount());\r\n                tokenType = lineContent = '';\r\n                tokenStart = tokenEnd = tokensOnLine = 0;\r\n                return false;\r\n            }\r\n        };\r\n    }\r\n    exports.getScanner = getScanner;\r\n});\r\n\ndefine(\"vs/nls!vs/base/common/keyCodes\",['vs/nls', 'vs/nls!vs/languages/html/common/htmlWorker'], function(nls, data) { return nls.create(\"vs/base/common/keyCodes\", data); });\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\ndefine(\"vs/base/common/keyCodes\", [\"require\", \"exports\", 'vs/nls!vs/base/common/keyCodes', 'vs/base/common/platform'], function (require, exports, nls, defaultPlatform) {\r\n    'use strict';\r\n    /**\r\n     * Virtual Key Codes, the value does not hold any inherent meaning.\r\n     * Inspired somewhat from https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\r\n     * But these are \"more general\", as they should work across browsers & OS`s.\r\n     */\r\n    (function (KeyCode) {\r\n        /**\r\n         * Placed first to cover the 0 value of the enum.\r\n         */\r\n        KeyCode[KeyCode[\"Unknown\"] = 0] = \"Unknown\";\r\n        KeyCode[KeyCode[\"Backspace\"] = 1] = \"Backspace\";\r\n        KeyCode[KeyCode[\"Tab\"] = 2] = \"Tab\";\r\n        KeyCode[KeyCode[\"Enter\"] = 3] = \"Enter\";\r\n        KeyCode[KeyCode[\"Shift\"] = 4] = \"Shift\";\r\n        KeyCode[KeyCode[\"Ctrl\"] = 5] = \"Ctrl\";\r\n        KeyCode[KeyCode[\"Alt\"] = 6] = \"Alt\";\r\n        KeyCode[KeyCode[\"PauseBreak\"] = 7] = \"PauseBreak\";\r\n        KeyCode[KeyCode[\"CapsLock\"] = 8] = \"CapsLock\";\r\n        KeyCode[KeyCode[\"Escape\"] = 9] = \"Escape\";\r\n        KeyCode[KeyCode[\"Space\"] = 10] = \"Space\";\r\n        KeyCode[KeyCode[\"PageUp\"] = 11] = \"PageUp\";\r\n        KeyCode[KeyCode[\"PageDown\"] = 12] = \"PageDown\";\r\n        KeyCode[KeyCode[\"End\"] = 13] = \"End\";\r\n        KeyCode[KeyCode[\"Home\"] = 14] = \"Home\";\r\n        KeyCode[KeyCode[\"LeftArrow\"] = 15] = \"LeftArrow\";\r\n        KeyCode[KeyCode[\"UpArrow\"] = 16] = \"UpArrow\";\r\n        KeyCode[KeyCode[\"RightArrow\"] = 17] = \"RightArrow\";\r\n        KeyCode[KeyCode[\"DownArrow\"] = 18] = \"DownArrow\";\r\n        KeyCode[KeyCode[\"Insert\"] = 19] = \"Insert\";\r\n        KeyCode[KeyCode[\"Delete\"] = 20] = \"Delete\";\r\n        KeyCode[KeyCode[\"KEY_0\"] = 21] = \"KEY_0\";\r\n        KeyCode[KeyCode[\"KEY_1\"] = 22] = \"KEY_1\";\r\n        KeyCode[KeyCode[\"KEY_2\"] = 23] = \"KEY_2\";\r\n        KeyCode[KeyCode[\"KEY_3\"] = 24] = \"KEY_3\";\r\n        KeyCode[KeyCode[\"KEY_4\"] = 25] = \"KEY_4\";\r\n        KeyCode[KeyCode[\"KEY_5\"] = 26] = \"KEY_5\";\r\n        KeyCode[KeyCode[\"KEY_6\"] = 27] = \"KEY_6\";\r\n        KeyCode[KeyCode[\"KEY_7\"] = 28] = \"KEY_7\";\r\n        KeyCode[KeyCode[\"KEY_8\"] = 29] = \"KEY_8\";\r\n        KeyCode[KeyCode[\"KEY_9\"] = 30] = \"KEY_9\";\r\n        KeyCode[KeyCode[\"KEY_A\"] = 31] = \"KEY_A\";\r\n        KeyCode[KeyCode[\"KEY_B\"] = 32] = \"KEY_B\";\r\n        KeyCode[KeyCode[\"KEY_C\"] = 33] = \"KEY_C\";\r\n        KeyCode[KeyCode[\"KEY_D\"] = 34] = \"KEY_D\";\r\n        KeyCode[KeyCode[\"KEY_E\"] = 35] = \"KEY_E\";\r\n        KeyCode[KeyCode[\"KEY_F\"] = 36] = \"KEY_F\";\r\n        KeyCode[KeyCode[\"KEY_G\"] = 37] = \"KEY_G\";\r\n        KeyCode[KeyCode[\"KEY_H\"] = 38] = \"KEY_H\";\r\n        KeyCode[KeyCode[\"KEY_I\"] = 39] = \"KEY_I\";\r\n        KeyCode[KeyCode[\"KEY_J\"] = 40] = \"KEY_J\";\r\n        KeyCode[KeyCode[\"KEY_K\"] = 41] = \"KEY_K\";\r\n        KeyCode[KeyCode[\"KEY_L\"] = 42] = \"KEY_L\";\r\n        KeyCode[KeyCode[\"KEY_M\"] = 43] = \"KEY_M\";\r\n        KeyCode[KeyCode[\"KEY_N\"] = 44] = \"KEY_N\";\r\n        KeyCode[KeyCode[\"KEY_O\"] = 45] = \"KEY_O\";\r\n        KeyCode[KeyCode[\"KEY_P\"] = 46] = \"KEY_P\";\r\n        KeyCode[KeyCode[\"KEY_Q\"] = 47] = \"KEY_Q\";\r\n        KeyCode[KeyCode[\"KEY_R\"] = 48] = \"KEY_R\";\r\n        KeyCode[KeyCode[\"KEY_S\"] = 49] = \"KEY_S\";\r\n        KeyCode[KeyCode[\"KEY_T\"] = 50] = \"KEY_T\";\r\n        KeyCode[KeyCode[\"KEY_U\"] = 51] = \"KEY_U\";\r\n        KeyCode[KeyCode[\"KEY_V\"] = 52] = \"KEY_V\";\r\n        KeyCode[KeyCode[\"KEY_W\"] = 53] = \"KEY_W\";\r\n        KeyCode[KeyCode[\"KEY_X\"] = 54] = \"KEY_X\";\r\n        KeyCode[KeyCode[\"KEY_Y\"] = 55] = \"KEY_Y\";\r\n        KeyCode[KeyCode[\"KEY_Z\"] = 56] = \"KEY_Z\";\r\n        KeyCode[KeyCode[\"Meta\"] = 57] = \"Meta\";\r\n        KeyCode[KeyCode[\"ContextMenu\"] = 58] = \"ContextMenu\";\r\n        KeyCode[KeyCode[\"F1\"] = 59] = \"F1\";\r\n        KeyCode[KeyCode[\"F2\"] = 60] = \"F2\";\r\n        KeyCode[KeyCode[\"F3\"] = 61] = \"F3\";\r\n        KeyCode[KeyCode[\"F4\"] = 62] = \"F4\";\r\n        KeyCode[KeyCode[\"F5\"] = 63] = \"F5\";\r\n        KeyCode[KeyCode[\"F6\"] = 64] = \"F6\";\r\n        KeyCode[KeyCode[\"F7\"] = 65] = \"F7\";\r\n        KeyCode[KeyCode[\"F8\"] = 66] = \"F8\";\r\n        KeyCode[KeyCode[\"F9\"] = 67] = \"F9\";\r\n        KeyCode[KeyCode[\"F10\"] = 68] = \"F10\";\r\n        KeyCode[KeyCode[\"F11\"] = 69] = \"F11\";\r\n        KeyCode[KeyCode[\"F12\"] = 70] = \"F12\";\r\n        KeyCode[KeyCode[\"F13\"] = 71] = \"F13\";\r\n        KeyCode[KeyCode[\"F14\"] = 72] = \"F14\";\r\n        KeyCode[KeyCode[\"F15\"] = 73] = \"F15\";\r\n        KeyCode[KeyCode[\"F16\"] = 74] = \"F16\";\r\n        KeyCode[KeyCode[\"F17\"] = 75] = \"F17\";\r\n        KeyCode[KeyCode[\"F18\"] = 76] = \"F18\";\r\n        KeyCode[KeyCode[\"F19\"] = 77] = \"F19\";\r\n        KeyCode[KeyCode[\"NumLock\"] = 78] = \"NumLock\";\r\n        KeyCode[KeyCode[\"ScrollLock\"] = 79] = \"ScrollLock\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         * For the US standard keyboard, the ';:' key\r\n         */\r\n        KeyCode[KeyCode[\"US_SEMICOLON\"] = 80] = \"US_SEMICOLON\";\r\n        /**\r\n         * For any country/region, the '+' key\r\n         * For the US standard keyboard, the '=+' key\r\n         */\r\n        KeyCode[KeyCode[\"US_EQUAL\"] = 81] = \"US_EQUAL\";\r\n        /**\r\n         * For any country/region, the ',' key\r\n         * For the US standard keyboard, the ',<' key\r\n         */\r\n        KeyCode[KeyCode[\"US_COMMA\"] = 82] = \"US_COMMA\";\r\n        /**\r\n         * For any country/region, the '-' key\r\n         * For the US standard keyboard, the '-_' key\r\n         */\r\n        KeyCode[KeyCode[\"US_MINUS\"] = 83] = \"US_MINUS\";\r\n        /**\r\n         * For any country/region, the '.' key\r\n         * For the US standard keyboard, the '.>' key\r\n         */\r\n        KeyCode[KeyCode[\"US_DOT\"] = 84] = \"US_DOT\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         * For the US standard keyboard, the '/?' key\r\n         */\r\n        KeyCode[KeyCode[\"US_SLASH\"] = 85] = \"US_SLASH\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         * For the US standard keyboard, the '`~' key\r\n         */\r\n        KeyCode[KeyCode[\"US_BACKTICK\"] = 86] = \"US_BACKTICK\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         * For the US standard keyboard, the '[{' key\r\n         */\r\n        KeyCode[KeyCode[\"US_OPEN_SQUARE_BRACKET\"] = 87] = \"US_OPEN_SQUARE_BRACKET\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         * For the US standard keyboard, the '\\|' key\r\n         */\r\n        KeyCode[KeyCode[\"US_BACKSLASH\"] = 88] = \"US_BACKSLASH\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         * For the US standard keyboard, the ']}' key\r\n         */\r\n        KeyCode[KeyCode[\"US_CLOSE_SQUARE_BRACKET\"] = 89] = \"US_CLOSE_SQUARE_BRACKET\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         * For the US standard keyboard, the ''\"' key\r\n         */\r\n        KeyCode[KeyCode[\"US_QUOTE\"] = 90] = \"US_QUOTE\";\r\n        /**\r\n         * Used for miscellaneous characters; it can vary by keyboard.\r\n         */\r\n        KeyCode[KeyCode[\"OEM_8\"] = 91] = \"OEM_8\";\r\n        /**\r\n         * Either the angle bracket key or the backslash key on the RT 102-key keyboard.\r\n         */\r\n        KeyCode[KeyCode[\"OEM_102\"] = 92] = \"OEM_102\";\r\n        KeyCode[KeyCode[\"NUMPAD_0\"] = 93] = \"NUMPAD_0\";\r\n        KeyCode[KeyCode[\"NUMPAD_1\"] = 94] = \"NUMPAD_1\";\r\n        KeyCode[KeyCode[\"NUMPAD_2\"] = 95] = \"NUMPAD_2\";\r\n        KeyCode[KeyCode[\"NUMPAD_3\"] = 96] = \"NUMPAD_3\";\r\n        KeyCode[KeyCode[\"NUMPAD_4\"] = 97] = \"NUMPAD_4\";\r\n        KeyCode[KeyCode[\"NUMPAD_5\"] = 98] = \"NUMPAD_5\";\r\n        KeyCode[KeyCode[\"NUMPAD_6\"] = 99] = \"NUMPAD_6\";\r\n        KeyCode[KeyCode[\"NUMPAD_7\"] = 100] = \"NUMPAD_7\";\r\n        KeyCode[KeyCode[\"NUMPAD_8\"] = 101] = \"NUMPAD_8\";\r\n        KeyCode[KeyCode[\"NUMPAD_9\"] = 102] = \"NUMPAD_9\";\r\n        KeyCode[KeyCode[\"NUMPAD_MULTIPLY\"] = 103] = \"NUMPAD_MULTIPLY\";\r\n        KeyCode[KeyCode[\"NUMPAD_ADD\"] = 104] = \"NUMPAD_ADD\";\r\n        KeyCode[KeyCode[\"NUMPAD_SEPARATOR\"] = 105] = \"NUMPAD_SEPARATOR\";\r\n        KeyCode[KeyCode[\"NUMPAD_SUBTRACT\"] = 106] = \"NUMPAD_SUBTRACT\";\r\n        KeyCode[KeyCode[\"NUMPAD_DECIMAL\"] = 107] = \"NUMPAD_DECIMAL\";\r\n        KeyCode[KeyCode[\"NUMPAD_DIVIDE\"] = 108] = \"NUMPAD_DIVIDE\";\r\n        /**\r\n         * Placed last to cover the length of the enum.\r\n         */\r\n        KeyCode[KeyCode[\"MAX_VALUE\"] = 109] = \"MAX_VALUE\";\r\n    })(exports.KeyCode || (exports.KeyCode = {}));\r\n    var KeyCode = exports.KeyCode;\r\n    var Mapping = (function () {\r\n        function Mapping(fromKeyCode, toKeyCode) {\r\n            this._fromKeyCode = fromKeyCode;\r\n            this._toKeyCode = toKeyCode;\r\n        }\r\n        Mapping.prototype.fromKeyCode = function (keyCode) {\r\n            return this._fromKeyCode[keyCode];\r\n        };\r\n        Mapping.prototype.toKeyCode = function (str) {\r\n            if (this._toKeyCode.hasOwnProperty(str)) {\r\n                return this._toKeyCode[str];\r\n            }\r\n            return KeyCode.Unknown;\r\n        };\r\n        return Mapping;\r\n    }());\r\n    function createMapping(fill1, fill2) {\r\n        var MAP = [];\r\n        fill1(MAP);\r\n        var REVERSE_MAP = {};\r\n        for (var i = 0, len = MAP.length; i < len; i++) {\r\n            if (!MAP[i]) {\r\n                continue;\r\n            }\r\n            REVERSE_MAP[MAP[i]] = i;\r\n        }\r\n        fill2(REVERSE_MAP);\r\n        var FINAL_REVERSE_MAP = {};\r\n        for (var entry in REVERSE_MAP) {\r\n            if (REVERSE_MAP.hasOwnProperty(entry)) {\r\n                FINAL_REVERSE_MAP[entry] = REVERSE_MAP[entry];\r\n                FINAL_REVERSE_MAP[entry.toLowerCase()] = REVERSE_MAP[entry];\r\n            }\r\n        }\r\n        return new Mapping(MAP, FINAL_REVERSE_MAP);\r\n    }\r\n    var STRING = createMapping(function (TO_STRING_MAP) {\r\n        TO_STRING_MAP[KeyCode.Unknown] = 'unknown';\r\n        TO_STRING_MAP[KeyCode.Backspace] = 'Backspace';\r\n        TO_STRING_MAP[KeyCode.Tab] = 'Tab';\r\n        TO_STRING_MAP[KeyCode.Enter] = 'Enter';\r\n        TO_STRING_MAP[KeyCode.Shift] = 'Shift';\r\n        TO_STRING_MAP[KeyCode.Ctrl] = 'Ctrl';\r\n        TO_STRING_MAP[KeyCode.Alt] = 'Alt';\r\n        TO_STRING_MAP[KeyCode.PauseBreak] = 'PauseBreak';\r\n        TO_STRING_MAP[KeyCode.CapsLock] = 'CapsLock';\r\n        TO_STRING_MAP[KeyCode.Escape] = 'Escape';\r\n        TO_STRING_MAP[KeyCode.Space] = 'Space';\r\n        TO_STRING_MAP[KeyCode.PageUp] = 'PageUp';\r\n        TO_STRING_MAP[KeyCode.PageDown] = 'PageDown';\r\n        TO_STRING_MAP[KeyCode.End] = 'End';\r\n        TO_STRING_MAP[KeyCode.Home] = 'Home';\r\n        TO_STRING_MAP[KeyCode.LeftArrow] = 'LeftArrow';\r\n        TO_STRING_MAP[KeyCode.UpArrow] = 'UpArrow';\r\n        TO_STRING_MAP[KeyCode.RightArrow] = 'RightArrow';\r\n        TO_STRING_MAP[KeyCode.DownArrow] = 'DownArrow';\r\n        TO_STRING_MAP[KeyCode.Insert] = 'Insert';\r\n        TO_STRING_MAP[KeyCode.Delete] = 'Delete';\r\n        TO_STRING_MAP[KeyCode.KEY_0] = '0';\r\n        TO_STRING_MAP[KeyCode.KEY_1] = '1';\r\n        TO_STRING_MAP[KeyCode.KEY_2] = '2';\r\n        TO_STRING_MAP[KeyCode.KEY_3] = '3';\r\n        TO_STRING_MAP[KeyCode.KEY_4] = '4';\r\n        TO_STRING_MAP[KeyCode.KEY_5] = '5';\r\n        TO_STRING_MAP[KeyCode.KEY_6] = '6';\r\n        TO_STRING_MAP[KeyCode.KEY_7] = '7';\r\n        TO_STRING_MAP[KeyCode.KEY_8] = '8';\r\n        TO_STRING_MAP[KeyCode.KEY_9] = '9';\r\n        TO_STRING_MAP[KeyCode.KEY_A] = 'A';\r\n        TO_STRING_MAP[KeyCode.KEY_B] = 'B';\r\n        TO_STRING_MAP[KeyCode.KEY_C] = 'C';\r\n        TO_STRING_MAP[KeyCode.KEY_D] = 'D';\r\n        TO_STRING_MAP[KeyCode.KEY_E] = 'E';\r\n        TO_STRING_MAP[KeyCode.KEY_F] = 'F';\r\n        TO_STRING_MAP[KeyCode.KEY_G] = 'G';\r\n        TO_STRING_MAP[KeyCode.KEY_H] = 'H';\r\n        TO_STRING_MAP[KeyCode.KEY_I] = 'I';\r\n        TO_STRING_MAP[KeyCode.KEY_J] = 'J';\r\n        TO_STRING_MAP[KeyCode.KEY_K] = 'K';\r\n        TO_STRING_MAP[KeyCode.KEY_L] = 'L';\r\n        TO_STRING_MAP[KeyCode.KEY_M] = 'M';\r\n        TO_STRING_MAP[KeyCode.KEY_N] = 'N';\r\n        TO_STRING_MAP[KeyCode.KEY_O] = 'O';\r\n        TO_STRING_MAP[KeyCode.KEY_P] = 'P';\r\n        TO_STRING_MAP[KeyCode.KEY_Q] = 'Q';\r\n        TO_STRING_MAP[KeyCode.KEY_R] = 'R';\r\n        TO_STRING_MAP[KeyCode.KEY_S] = 'S';\r\n        TO_STRING_MAP[KeyCode.KEY_T] = 'T';\r\n        TO_STRING_MAP[KeyCode.KEY_U] = 'U';\r\n        TO_STRING_MAP[KeyCode.KEY_V] = 'V';\r\n        TO_STRING_MAP[KeyCode.KEY_W] = 'W';\r\n        TO_STRING_MAP[KeyCode.KEY_X] = 'X';\r\n        TO_STRING_MAP[KeyCode.KEY_Y] = 'Y';\r\n        TO_STRING_MAP[KeyCode.KEY_Z] = 'Z';\r\n        TO_STRING_MAP[KeyCode.ContextMenu] = 'ContextMenu';\r\n        TO_STRING_MAP[KeyCode.F1] = 'F1';\r\n        TO_STRING_MAP[KeyCode.F2] = 'F2';\r\n        TO_STRING_MAP[KeyCode.F3] = 'F3';\r\n        TO_STRING_MAP[KeyCode.F4] = 'F4';\r\n        TO_STRING_MAP[KeyCode.F5] = 'F5';\r\n        TO_STRING_MAP[KeyCode.F6] = 'F6';\r\n        TO_STRING_MAP[KeyCode.F7] = 'F7';\r\n        TO_STRING_MAP[KeyCode.F8] = 'F8';\r\n        TO_STRING_MAP[KeyCode.F9] = 'F9';\r\n        TO_STRING_MAP[KeyCode.F10] = 'F10';\r\n        TO_STRING_MAP[KeyCode.F11] = 'F11';\r\n        TO_STRING_MAP[KeyCode.F12] = 'F12';\r\n        TO_STRING_MAP[KeyCode.F13] = 'F13';\r\n        TO_STRING_MAP[KeyCode.F14] = 'F14';\r\n        TO_STRING_MAP[KeyCode.F15] = 'F15';\r\n        TO_STRING_MAP[KeyCode.F16] = 'F16';\r\n        TO_STRING_MAP[KeyCode.F17] = 'F17';\r\n        TO_STRING_MAP[KeyCode.F18] = 'F18';\r\n        TO_STRING_MAP[KeyCode.F19] = 'F19';\r\n        TO_STRING_MAP[KeyCode.NumLock] = 'NumLock';\r\n        TO_STRING_MAP[KeyCode.ScrollLock] = 'ScrollLock';\r\n        TO_STRING_MAP[KeyCode.US_SEMICOLON] = ';';\r\n        TO_STRING_MAP[KeyCode.US_EQUAL] = '=';\r\n        TO_STRING_MAP[KeyCode.US_COMMA] = ',';\r\n        TO_STRING_MAP[KeyCode.US_MINUS] = '-';\r\n        TO_STRING_MAP[KeyCode.US_DOT] = '.';\r\n        TO_STRING_MAP[KeyCode.US_SLASH] = '/';\r\n        TO_STRING_MAP[KeyCode.US_BACKTICK] = '`';\r\n        TO_STRING_MAP[KeyCode.US_OPEN_SQUARE_BRACKET] = '[';\r\n        TO_STRING_MAP[KeyCode.US_BACKSLASH] = '\\\\';\r\n        TO_STRING_MAP[KeyCode.US_CLOSE_SQUARE_BRACKET] = ']';\r\n        TO_STRING_MAP[KeyCode.US_QUOTE] = '\\'';\r\n        TO_STRING_MAP[KeyCode.OEM_8] = 'OEM_8';\r\n        TO_STRING_MAP[KeyCode.OEM_102] = 'OEM_102';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_0] = 'NumPad0';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_1] = 'NumPad1';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_2] = 'NumPad2';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_3] = 'NumPad3';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_4] = 'NumPad4';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_5] = 'NumPad5';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_6] = 'NumPad6';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_7] = 'NumPad7';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_8] = 'NumPad8';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_9] = 'NumPad9';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_MULTIPLY] = 'NumPad_Multiply';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_ADD] = 'NumPad_Add';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_SEPARATOR] = 'NumPad_Separator';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_SUBTRACT] = 'NumPad_Subtract';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_DECIMAL] = 'NumPad_Decimal';\r\n        TO_STRING_MAP[KeyCode.NUMPAD_DIVIDE] = 'NumPad_Divide';\r\n        // for (let i = 0; i < KeyCode.MAX_VALUE; i++) {\r\n        // \tif (!TO_STRING_MAP[i]) {\r\n        // \t\tconsole.warn('Missing string representation for ' + KeyCode[i]);\r\n        // \t}\r\n        // }\r\n    }, function (FROM_STRING_MAP) {\r\n        FROM_STRING_MAP['\\r'] = KeyCode.Enter;\r\n    });\r\n    var USER_SETTINGS = createMapping(function (TO_USER_SETTINGS_MAP) {\r\n        for (var i = 0, len = STRING._fromKeyCode.length; i < len; i++) {\r\n            TO_USER_SETTINGS_MAP[i] = STRING._fromKeyCode[i];\r\n        }\r\n        TO_USER_SETTINGS_MAP[KeyCode.LeftArrow] = 'Left';\r\n        TO_USER_SETTINGS_MAP[KeyCode.UpArrow] = 'Up';\r\n        TO_USER_SETTINGS_MAP[KeyCode.RightArrow] = 'Right';\r\n        TO_USER_SETTINGS_MAP[KeyCode.DownArrow] = 'Down';\r\n    }, function (FROM_USER_SETTINGS_MAP) {\r\n        FROM_USER_SETTINGS_MAP['OEM_1'] = KeyCode.US_SEMICOLON;\r\n        FROM_USER_SETTINGS_MAP['OEM_PLUS'] = KeyCode.US_EQUAL;\r\n        FROM_USER_SETTINGS_MAP['OEM_COMMA'] = KeyCode.US_COMMA;\r\n        FROM_USER_SETTINGS_MAP['OEM_MINUS'] = KeyCode.US_MINUS;\r\n        FROM_USER_SETTINGS_MAP['OEM_PERIOD'] = KeyCode.US_DOT;\r\n        FROM_USER_SETTINGS_MAP['OEM_2'] = KeyCode.US_SLASH;\r\n        FROM_USER_SETTINGS_MAP['OEM_3'] = KeyCode.US_BACKTICK;\r\n        FROM_USER_SETTINGS_MAP['OEM_4'] = KeyCode.US_OPEN_SQUARE_BRACKET;\r\n        FROM_USER_SETTINGS_MAP['OEM_5'] = KeyCode.US_BACKSLASH;\r\n        FROM_USER_SETTINGS_MAP['OEM_6'] = KeyCode.US_CLOSE_SQUARE_BRACKET;\r\n        FROM_USER_SETTINGS_MAP['OEM_7'] = KeyCode.US_QUOTE;\r\n        FROM_USER_SETTINGS_MAP['OEM_8'] = KeyCode.OEM_8;\r\n        FROM_USER_SETTINGS_MAP['OEM_102'] = KeyCode.OEM_102;\r\n    });\r\n    var KeyCode;\r\n    (function (KeyCode) {\r\n        function toString(key) {\r\n            return STRING.fromKeyCode(key);\r\n        }\r\n        KeyCode.toString = toString;\r\n        function fromString(key) {\r\n            return STRING.toKeyCode(key);\r\n        }\r\n        KeyCode.fromString = fromString;\r\n    })(KeyCode = exports.KeyCode || (exports.KeyCode = {}));\r\n    // Binary encoding strategy:\r\n    // 15:  1 bit for ctrlCmd\r\n    // 14:  1 bit for shift\r\n    // 13:  1 bit for alt\r\n    // 12:  1 bit for winCtrl\r\n    //  0: 12 bits for keyCode (up to a maximum keyCode of 4096. Given we have 83 at this point thats good enough)\r\n    var BIN_CTRLCMD_MASK = 1 << 15;\r\n    var BIN_SHIFT_MASK = 1 << 14;\r\n    var BIN_ALT_MASK = 1 << 13;\r\n    var BIN_WINCTRL_MASK = 1 << 12;\r\n    var BIN_KEYCODE_MASK = 0x00000fff;\r\n    var BinaryKeybindings = (function () {\r\n        function BinaryKeybindings() {\r\n        }\r\n        BinaryKeybindings.extractFirstPart = function (keybinding) {\r\n            return keybinding & 0x0000ffff;\r\n        };\r\n        BinaryKeybindings.extractChordPart = function (keybinding) {\r\n            return (keybinding >> 16) & 0x0000ffff;\r\n        };\r\n        BinaryKeybindings.hasChord = function (keybinding) {\r\n            return (this.extractChordPart(keybinding) !== 0);\r\n        };\r\n        BinaryKeybindings.hasCtrlCmd = function (keybinding) {\r\n            return (keybinding & BIN_CTRLCMD_MASK ? true : false);\r\n        };\r\n        BinaryKeybindings.hasShift = function (keybinding) {\r\n            return (keybinding & BIN_SHIFT_MASK ? true : false);\r\n        };\r\n        BinaryKeybindings.hasAlt = function (keybinding) {\r\n            return (keybinding & BIN_ALT_MASK ? true : false);\r\n        };\r\n        BinaryKeybindings.hasWinCtrl = function (keybinding) {\r\n            return (keybinding & BIN_WINCTRL_MASK ? true : false);\r\n        };\r\n        BinaryKeybindings.extractKeyCode = function (keybinding) {\r\n            return (keybinding & BIN_KEYCODE_MASK);\r\n        };\r\n        return BinaryKeybindings;\r\n    }());\r\n    exports.BinaryKeybindings = BinaryKeybindings;\r\n    var KeyMod = (function () {\r\n        function KeyMod() {\r\n        }\r\n        KeyMod.chord = function (firstPart, secondPart) {\r\n            return firstPart | ((secondPart & 0x0000ffff) << 16);\r\n        };\r\n        KeyMod.CtrlCmd = BIN_CTRLCMD_MASK;\r\n        KeyMod.Shift = BIN_SHIFT_MASK;\r\n        KeyMod.Alt = BIN_ALT_MASK;\r\n        KeyMod.WinCtrl = BIN_WINCTRL_MASK;\r\n        return KeyMod;\r\n    }());\r\n    exports.KeyMod = KeyMod;\r\n    /**\r\n     * A set of usual keybindings that can be reused in code\r\n     */\r\n    var CommonKeybindings = (function () {\r\n        function CommonKeybindings() {\r\n        }\r\n        CommonKeybindings.ENTER = KeyCode.Enter;\r\n        CommonKeybindings.SHIFT_ENTER = KeyMod.Shift | KeyCode.Enter;\r\n        CommonKeybindings.CTRLCMD_ENTER = KeyMod.CtrlCmd | KeyCode.Enter;\r\n        CommonKeybindings.WINCTRL_ENTER = KeyMod.WinCtrl | KeyCode.Enter;\r\n        CommonKeybindings.TAB = KeyCode.Tab;\r\n        CommonKeybindings.SHIFT_TAB = KeyMod.Shift | KeyCode.Tab;\r\n        CommonKeybindings.ESCAPE = KeyCode.Escape;\r\n        CommonKeybindings.SPACE = KeyCode.Space;\r\n        CommonKeybindings.DELETE = KeyCode.Delete;\r\n        CommonKeybindings.SHIFT_DELETE = KeyMod.Shift | KeyCode.Delete;\r\n        CommonKeybindings.CTRLCMD_BACKSPACE = KeyMod.CtrlCmd | KeyCode.Backspace;\r\n        CommonKeybindings.UP_ARROW = KeyCode.UpArrow;\r\n        CommonKeybindings.SHIFT_UP_ARROW = KeyMod.Shift | KeyCode.UpArrow;\r\n        CommonKeybindings.CTRLCMD_UP_ARROW = KeyMod.CtrlCmd | KeyCode.UpArrow;\r\n        CommonKeybindings.DOWN_ARROW = KeyCode.DownArrow;\r\n        CommonKeybindings.SHIFT_DOWN_ARROW = KeyMod.Shift | KeyCode.DownArrow;\r\n        CommonKeybindings.CTRLCMD_DOWN_ARROW = KeyMod.CtrlCmd | KeyCode.DownArrow;\r\n        CommonKeybindings.LEFT_ARROW = KeyCode.LeftArrow;\r\n        CommonKeybindings.RIGHT_ARROW = KeyCode.RightArrow;\r\n        CommonKeybindings.PAGE_UP = KeyCode.PageUp;\r\n        CommonKeybindings.SHIFT_PAGE_UP = KeyMod.Shift | KeyCode.PageUp;\r\n        CommonKeybindings.PAGE_DOWN = KeyCode.PageDown;\r\n        CommonKeybindings.SHIFT_PAGE_DOWN = KeyMod.Shift | KeyCode.PageDown;\r\n        CommonKeybindings.F2 = KeyCode.F2;\r\n        CommonKeybindings.CTRLCMD_S = KeyMod.CtrlCmd | KeyCode.KEY_S;\r\n        CommonKeybindings.CTRLCMD_C = KeyMod.CtrlCmd | KeyCode.KEY_C;\r\n        CommonKeybindings.CTRLCMD_V = KeyMod.CtrlCmd | KeyCode.KEY_V;\r\n        return CommonKeybindings;\r\n    }());\r\n    exports.CommonKeybindings = CommonKeybindings;\r\n    var Keybinding = (function () {\r\n        function Keybinding(keybinding) {\r\n            this.value = keybinding;\r\n        }\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding._toUSLabel = function (value, Platform) {\r\n            return _asString(value, (Platform.isMacintosh ? MacUIKeyLabelProvider.INSTANCE : ClassicUIKeyLabelProvider.INSTANCE), Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for placing in an aria-label.\r\n         */\r\n        Keybinding._toUSAriaLabel = function (value, Platform) {\r\n            return _asString(value, AriaKeyLabelProvider.INSTANCE, Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding._toUSHTMLLabel = function (value, Platform) {\r\n            return _asHTML(value, (Platform.isMacintosh ? MacUIKeyLabelProvider.INSTANCE : ClassicUIKeyLabelProvider.INSTANCE), Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding._toCustomLabel = function (value, labelProvider, Platform) {\r\n            return _asString(value, labelProvider, Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding._toCustomHTMLLabel = function (value, labelProvider, Platform) {\r\n            return _asHTML(value, labelProvider, Platform);\r\n        };\r\n        /**\r\n         * This prints the binding in a format suitable for electron's accelerators.\r\n         * See https://github.com/electron/electron/blob/master/docs/api/accelerator.md\r\n         */\r\n        Keybinding._toElectronAccelerator = function (value, Platform) {\r\n            if (BinaryKeybindings.hasChord(value)) {\r\n                // Electron cannot handle chords\r\n                return null;\r\n            }\r\n            return _asString(value, ElectronAcceleratorLabelProvider.INSTANCE, Platform);\r\n        };\r\n        Keybinding.getUserSettingsKeybindingRegex = function () {\r\n            if (!this._cachedKeybindingRegex) {\r\n                var numpadKey = 'numpad(0|1|2|3|4|5|6|7|8|9|_multiply|_add|_subtract|_decimal|_divide|_separator)';\r\n                var oemKey = '`|\\\\-|=|\\\\[|\\\\]|\\\\\\\\\\\\\\\\|;|\\'|,|\\\\.|\\\\/|oem_8|oem_102';\r\n                var specialKey = 'left|up|right|down|pageup|pagedown|end|home|tab|enter|escape|space|backspace|delete|pausebreak|capslock|insert|contextmenu|numlock|scrolllock';\r\n                var casualKey = '[a-z]|[0-9]|f(1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19)';\r\n                var key = '((' + [numpadKey, oemKey, specialKey, casualKey].join(')|(') + '))';\r\n                var mod = '((ctrl|shift|alt|cmd|win|meta)\\\\+)*';\r\n                var keybinding = '(' + mod + key + ')';\r\n                this._cachedKeybindingRegex = '\"\\\\s*(' + keybinding + '(\\\\s+' + keybinding + ')?' + ')\\\\s*\"';\r\n            }\r\n            return this._cachedKeybindingRegex;\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for the user settings file.\r\n         */\r\n        Keybinding.toUserSettingsLabel = function (value, Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            var result = _asString(value, UserSettingsKeyLabelProvider.INSTANCE, Platform);\r\n            result = result.toLowerCase();\r\n            if (Platform.isMacintosh) {\r\n                result = result.replace(/meta/g, 'cmd');\r\n            }\r\n            else if (Platform.isWindows) {\r\n                result = result.replace(/meta/g, 'win');\r\n            }\r\n            return result;\r\n        };\r\n        Keybinding.fromUserSettingsLabel = function (input, Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            if (!input) {\r\n                return null;\r\n            }\r\n            input = input.toLowerCase().trim();\r\n            var ctrlCmd = false, shift = false, alt = false, winCtrl = false, key = '';\r\n            while (/^(ctrl|shift|alt|meta|win|cmd)(\\+|\\-)/.test(input)) {\r\n                if (/^ctrl(\\+|\\-)/.test(input)) {\r\n                    if (Platform.isMacintosh) {\r\n                        winCtrl = true;\r\n                    }\r\n                    else {\r\n                        ctrlCmd = true;\r\n                    }\r\n                    input = input.substr('ctrl-'.length);\r\n                }\r\n                if (/^shift(\\+|\\-)/.test(input)) {\r\n                    shift = true;\r\n                    input = input.substr('shift-'.length);\r\n                }\r\n                if (/^alt(\\+|\\-)/.test(input)) {\r\n                    alt = true;\r\n                    input = input.substr('alt-'.length);\r\n                }\r\n                if (/^meta(\\+|\\-)/.test(input)) {\r\n                    if (Platform.isMacintosh) {\r\n                        ctrlCmd = true;\r\n                    }\r\n                    else {\r\n                        winCtrl = true;\r\n                    }\r\n                    input = input.substr('meta-'.length);\r\n                }\r\n                if (/^win(\\+|\\-)/.test(input)) {\r\n                    if (Platform.isMacintosh) {\r\n                        ctrlCmd = true;\r\n                    }\r\n                    else {\r\n                        winCtrl = true;\r\n                    }\r\n                    input = input.substr('win-'.length);\r\n                }\r\n                if (/^cmd(\\+|\\-)/.test(input)) {\r\n                    if (Platform.isMacintosh) {\r\n                        ctrlCmd = true;\r\n                    }\r\n                    else {\r\n                        winCtrl = true;\r\n                    }\r\n                    input = input.substr('cmd-'.length);\r\n                }\r\n            }\r\n            var chord = 0;\r\n            var firstSpaceIdx = input.indexOf(' ');\r\n            if (firstSpaceIdx > 0) {\r\n                key = input.substring(0, firstSpaceIdx);\r\n                chord = Keybinding.fromUserSettingsLabel(input.substring(firstSpaceIdx), Platform);\r\n            }\r\n            else {\r\n                key = input;\r\n            }\r\n            var keyCode = USER_SETTINGS.toKeyCode(key);\r\n            var result = 0;\r\n            if (ctrlCmd) {\r\n                result |= KeyMod.CtrlCmd;\r\n            }\r\n            if (shift) {\r\n                result |= KeyMod.Shift;\r\n            }\r\n            if (alt) {\r\n                result |= KeyMod.Alt;\r\n            }\r\n            if (winCtrl) {\r\n                result |= KeyMod.WinCtrl;\r\n            }\r\n            result |= keyCode;\r\n            return KeyMod.chord(result, chord);\r\n        };\r\n        Keybinding.prototype.hasCtrlCmd = function () {\r\n            return BinaryKeybindings.hasCtrlCmd(this.value);\r\n        };\r\n        Keybinding.prototype.hasShift = function () {\r\n            return BinaryKeybindings.hasShift(this.value);\r\n        };\r\n        Keybinding.prototype.hasAlt = function () {\r\n            return BinaryKeybindings.hasAlt(this.value);\r\n        };\r\n        Keybinding.prototype.hasWinCtrl = function () {\r\n            return BinaryKeybindings.hasWinCtrl(this.value);\r\n        };\r\n        Keybinding.prototype.extractKeyCode = function () {\r\n            return BinaryKeybindings.extractKeyCode(this.value);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding.prototype._toUSLabel = function (Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            return Keybinding._toUSLabel(this.value, Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for placing in an aria-label.\r\n         */\r\n        Keybinding.prototype._toUSAriaLabel = function (Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            return Keybinding._toUSAriaLabel(this.value, Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding.prototype._toUSHTMLLabel = function (Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            return Keybinding._toUSHTMLLabel(this.value, Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding.prototype.toCustomLabel = function (labelProvider, Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            return Keybinding._toCustomLabel(this.value, labelProvider, Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for rendering in the UI\r\n         */\r\n        Keybinding.prototype.toCustomHTMLLabel = function (labelProvider, Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            return Keybinding._toCustomHTMLLabel(this.value, labelProvider, Platform);\r\n        };\r\n        /**\r\n         * This prints the binding in a format suitable for electron's accelerators.\r\n         * See https://github.com/electron/electron/blob/master/docs/api/accelerator.md\r\n         */\r\n        Keybinding.prototype._toElectronAccelerator = function (Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            return Keybinding._toElectronAccelerator(this.value, Platform);\r\n        };\r\n        /**\r\n         * Format the binding to a format appropiate for the user settings file.\r\n         */\r\n        Keybinding.prototype.toUserSettingsLabel = function (Platform) {\r\n            if (Platform === void 0) { Platform = defaultPlatform; }\r\n            return Keybinding.toUserSettingsLabel(this.value, Platform);\r\n        };\r\n        Keybinding._cachedKeybindingRegex = null;\r\n        return Keybinding;\r\n    }());\r\n    exports.Keybinding = Keybinding;\r\n    /**\r\n     * Print for Electron\r\n     */\r\n    var ElectronAcceleratorLabelProvider = (function () {\r\n        function ElectronAcceleratorLabelProvider() {\r\n            this.ctrlKeyLabel = 'Ctrl';\r\n            this.shiftKeyLabel = 'Shift';\r\n            this.altKeyLabel = 'Alt';\r\n            this.cmdKeyLabel = 'Cmd';\r\n            this.windowsKeyLabel = 'Super';\r\n            this.modifierSeparator = '+';\r\n        }\r\n        ElectronAcceleratorLabelProvider.prototype.getLabelForKey = function (keyCode) {\r\n            switch (keyCode) {\r\n                case KeyCode.UpArrow:\r\n                    return 'Up';\r\n                case KeyCode.DownArrow:\r\n                    return 'Down';\r\n                case KeyCode.LeftArrow:\r\n                    return 'Left';\r\n                case KeyCode.RightArrow:\r\n                    return 'Right';\r\n            }\r\n            return KeyCode.toString(keyCode);\r\n        };\r\n        ElectronAcceleratorLabelProvider.INSTANCE = new ElectronAcceleratorLabelProvider();\r\n        return ElectronAcceleratorLabelProvider;\r\n    }());\r\n    exports.ElectronAcceleratorLabelProvider = ElectronAcceleratorLabelProvider;\r\n    /**\r\n     * Print for Mac UI\r\n     */\r\n    var MacUIKeyLabelProvider = (function () {\r\n        function MacUIKeyLabelProvider() {\r\n            this.ctrlKeyLabel = '\\u2303';\r\n            this.shiftKeyLabel = '\\u21E7';\r\n            this.altKeyLabel = '\\u2325';\r\n            this.cmdKeyLabel = '\\u2318';\r\n            this.windowsKeyLabel = nls.localize(0, null);\r\n            this.modifierSeparator = '';\r\n        }\r\n        MacUIKeyLabelProvider.prototype.getLabelForKey = function (keyCode) {\r\n            switch (keyCode) {\r\n                case KeyCode.LeftArrow:\r\n                    return MacUIKeyLabelProvider.leftArrowUnicodeLabel;\r\n                case KeyCode.UpArrow:\r\n                    return MacUIKeyLabelProvider.upArrowUnicodeLabel;\r\n                case KeyCode.RightArrow:\r\n                    return MacUIKeyLabelProvider.rightArrowUnicodeLabel;\r\n                case KeyCode.DownArrow:\r\n                    return MacUIKeyLabelProvider.downArrowUnicodeLabel;\r\n            }\r\n            return KeyCode.toString(keyCode);\r\n        };\r\n        MacUIKeyLabelProvider.INSTANCE = new MacUIKeyLabelProvider();\r\n        MacUIKeyLabelProvider.leftArrowUnicodeLabel = String.fromCharCode(8592);\r\n        MacUIKeyLabelProvider.upArrowUnicodeLabel = String.fromCharCode(8593);\r\n        MacUIKeyLabelProvider.rightArrowUnicodeLabel = String.fromCharCode(8594);\r\n        MacUIKeyLabelProvider.downArrowUnicodeLabel = String.fromCharCode(8595);\r\n        return MacUIKeyLabelProvider;\r\n    }());\r\n    exports.MacUIKeyLabelProvider = MacUIKeyLabelProvider;\r\n    /**\r\n     * Aria label provider for Mac.\r\n     */\r\n    var AriaKeyLabelProvider = (function () {\r\n        function AriaKeyLabelProvider() {\r\n            this.ctrlKeyLabel = nls.localize(1, null);\r\n            this.shiftKeyLabel = nls.localize(2, null);\r\n            this.altKeyLabel = nls.localize(3, null);\r\n            this.cmdKeyLabel = nls.localize(4, null);\r\n            this.windowsKeyLabel = nls.localize(5, null);\r\n            this.modifierSeparator = '+';\r\n        }\r\n        AriaKeyLabelProvider.prototype.getLabelForKey = function (keyCode) {\r\n            return KeyCode.toString(keyCode);\r\n        };\r\n        AriaKeyLabelProvider.INSTANCE = new MacUIKeyLabelProvider();\r\n        return AriaKeyLabelProvider;\r\n    }());\r\n    exports.AriaKeyLabelProvider = AriaKeyLabelProvider;\r\n    /**\r\n     * Print for Windows, Linux UI\r\n     */\r\n    var ClassicUIKeyLabelProvider = (function () {\r\n        function ClassicUIKeyLabelProvider() {\r\n            this.ctrlKeyLabel = nls.localize(6, null);\r\n            this.shiftKeyLabel = nls.localize(7, null);\r\n            this.altKeyLabel = nls.localize(8, null);\r\n            this.cmdKeyLabel = nls.localize(9, null);\r\n            this.windowsKeyLabel = nls.localize(10, null);\r\n            this.modifierSeparator = '+';\r\n        }\r\n        ClassicUIKeyLabelProvider.prototype.getLabelForKey = function (keyCode) {\r\n            return KeyCode.toString(keyCode);\r\n        };\r\n        ClassicUIKeyLabelProvider.INSTANCE = new ClassicUIKeyLabelProvider();\r\n        return ClassicUIKeyLabelProvider;\r\n    }());\r\n    exports.ClassicUIKeyLabelProvider = ClassicUIKeyLabelProvider;\r\n    /**\r\n     * Print for the user settings file.\r\n     */\r\n    var UserSettingsKeyLabelProvider = (function () {\r\n        function UserSettingsKeyLabelProvider() {\r\n            this.ctrlKeyLabel = 'Ctrl';\r\n            this.shiftKeyLabel = 'Shift';\r\n            this.altKeyLabel = 'Alt';\r\n            this.cmdKeyLabel = 'Meta';\r\n            this.windowsKeyLabel = 'Meta';\r\n            this.modifierSeparator = '+';\r\n        }\r\n        UserSettingsKeyLabelProvider.prototype.getLabelForKey = function (keyCode) {\r\n            return USER_SETTINGS.fromKeyCode(keyCode);\r\n        };\r\n        UserSettingsKeyLabelProvider.INSTANCE = new UserSettingsKeyLabelProvider();\r\n        return UserSettingsKeyLabelProvider;\r\n    }());\r\n    function _asString(keybinding, labelProvider, Platform) {\r\n        var result = [], ctrlCmd = BinaryKeybindings.hasCtrlCmd(keybinding), shift = BinaryKeybindings.hasShift(keybinding), alt = BinaryKeybindings.hasAlt(keybinding), winCtrl = BinaryKeybindings.hasWinCtrl(keybinding), keyCode = BinaryKeybindings.extractKeyCode(keybinding);\r\n        var keyLabel = labelProvider.getLabelForKey(keyCode);\r\n        if (!keyLabel) {\r\n            // cannot trigger this key code under this kb layout\r\n            return '';\r\n        }\r\n        // translate modifier keys: Ctrl-Shift-Alt-Meta\r\n        if ((ctrlCmd && !Platform.isMacintosh) || (winCtrl && Platform.isMacintosh)) {\r\n            result.push(labelProvider.ctrlKeyLabel);\r\n        }\r\n        if (shift) {\r\n            result.push(labelProvider.shiftKeyLabel);\r\n        }\r\n        if (alt) {\r\n            result.push(labelProvider.altKeyLabel);\r\n        }\r\n        if (ctrlCmd && Platform.isMacintosh) {\r\n            result.push(labelProvider.cmdKeyLabel);\r\n        }\r\n        if (winCtrl && !Platform.isMacintosh) {\r\n            result.push(labelProvider.windowsKeyLabel);\r\n        }\r\n        // the actual key\r\n        result.push(keyLabel);\r\n        var actualResult = result.join(labelProvider.modifierSeparator);\r\n        if (BinaryKeybindings.hasChord(keybinding)) {\r\n            return actualResult + ' ' + _asString(BinaryKeybindings.extractChordPart(keybinding), labelProvider, Platform);\r\n        }\r\n        return actualResult;\r\n    }\r\n    function _pushKey(result, str) {\r\n        if (result.length > 0) {\r\n            result.push({\r\n                tagName: 'span',\r\n                text: '+'\r\n            });\r\n        }\r\n        result.push({\r\n            tagName: 'span',\r\n            className: 'monaco-kbkey',\r\n            text: str\r\n        });\r\n    }\r\n    function _asHTML(keybinding, labelProvider, Platform, isChord) {\r\n        if (isChord === void 0) { isChord = false; }\r\n        var result = [], ctrlCmd = BinaryKeybindings.hasCtrlCmd(keybinding), shift = BinaryKeybindings.hasShift(keybinding), alt = BinaryKeybindings.hasAlt(keybinding), winCtrl = BinaryKeybindings.hasWinCtrl(keybinding), keyCode = BinaryKeybindings.extractKeyCode(keybinding);\r\n        var keyLabel = labelProvider.getLabelForKey(keyCode);\r\n        if (!keyLabel) {\r\n            // cannot trigger this key code under this kb layout\r\n            return [];\r\n        }\r\n        // translate modifier keys: Ctrl-Shift-Alt-Meta\r\n        if ((ctrlCmd && !Platform.isMacintosh) || (winCtrl && Platform.isMacintosh)) {\r\n            _pushKey(result, labelProvider.ctrlKeyLabel);\r\n        }\r\n        if (shift) {\r\n            _pushKey(result, labelProvider.shiftKeyLabel);\r\n        }\r\n        if (alt) {\r\n            _pushKey(result, labelProvider.altKeyLabel);\r\n        }\r\n        if (ctrlCmd && Platform.isMacintosh) {\r\n            _pushKey(result, labelProvider.cmdKeyLabel);\r\n        }\r\n        if (winCtrl && !Platform.isMacintosh) {\r\n            _pushKey(result, labelProvider.windowsKeyLabel);\r\n        }\r\n        // the actual key\r\n        _pushKey(result, keyLabel);\r\n        var chordTo = null;\r\n        if (BinaryKeybindings.hasChord(keybinding)) {\r\n            chordTo = _asHTML(BinaryKeybindings.extractChordPart(keybinding), labelProvider, Platform, true);\r\n            result.push({\r\n                tagName: 'span',\r\n                text: ' '\r\n            });\r\n            result = result.concat(chordTo);\r\n        }\r\n        if (isChord) {\r\n            return result;\r\n        }\r\n        return [{\r\n                tagName: 'span',\r\n                className: 'monaco-kb',\r\n                children: result\r\n            }];\r\n    }\r\n});\r\n\ndefine(\"vs/nls!vs/languages/html/common/htmlTags\",['vs/nls', 'vs/nls!vs/languages/html/common/htmlWorker'], function(nls, data) { return nls.create(\"vs/languages/html/common/htmlTags\", data); });\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n/*--------------------------------------------------------------------------------------------\r\n *  This file is based on or incorporates material from the projects listed below (Third Party IP).\r\n *  The original copyright notice and the license under which Microsoft received such Third Party IP,\r\n *  are set forth below. Such licenses and notices are provided for informational purposes only.\r\n *  Microsoft licenses the Third Party IP to you under the licensing terms for the Microsoft product.\r\n *  Microsoft reserves all other rights not expressly granted under this agreement, whether by implication,\r\n *  estoppel or otherwise.\r\n *--------------------------------------------------------------------------------------------*/\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright  2015 W3C (MIT, ERCIM, Keio, Beihang). This software or document includes includes material copied\r\n *  from or derived from HTML 5.1 W3C Working Draft (http://www.w3.org/TR/2015/WD-html51-20151008/.)\"\r\n *--------------------------------------------------------------------------------------------*/\r\n/*---------------------------------------------------------------------------------------------\r\n *  Ionic Main Site (https://github.com/driftyco/ionic-site).\r\n *  Copyright Drifty Co. http://drifty.com/.\r\n *\r\n *  Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\r\n *  except in compliance with the License. You may obtain a copy of the License at\r\n *  http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n *  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n *  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n *  MERCHANTABLITY OR NON-INFRINGEMENT.\r\n *\r\n *  See the Apache Version 2.0 License for specific language governing permissions\r\n *  and limitations under the License.\r\n *--------------------------------------------------------------------------------------------*/\r\ndefine(\"vs/languages/html/common/htmlTags\", [\"require\", \"exports\", 'vs/base/common/strings', 'vs/nls!vs/languages/html/common/htmlTags'], function (require, exports, strings, nls) {\r\n    \"use strict\";\r\n    var HTMLTagSpecification = (function () {\r\n        function HTMLTagSpecification(label, attributes) {\r\n            if (attributes === void 0) { attributes = []; }\r\n            this.label = label;\r\n            this.attributes = attributes;\r\n        }\r\n        return HTMLTagSpecification;\r\n    }());\r\n    exports.HTMLTagSpecification = HTMLTagSpecification;\r\n    // HTML tag information sourced from http://www.w3.org/TR/2015/WD-html51-20151008/\r\n    exports.HTML_TAGS = {\r\n        // The root element\r\n        html: new HTMLTagSpecification(nls.localize(0, null), ['manifest']),\r\n        // Document metadata\r\n        head: new HTMLTagSpecification(nls.localize(1, null)),\r\n        title: new HTMLTagSpecification(nls.localize(2, null)),\r\n        base: new HTMLTagSpecification(nls.localize(3, null), ['href', 'target']),\r\n        link: new HTMLTagSpecification(nls.localize(4, null), ['href', 'crossorigin:xo', 'rel', 'media', 'hreflang', 'type', 'sizes']),\r\n        meta: new HTMLTagSpecification(nls.localize(5, null), ['name', 'http-equiv', 'content', 'charset']),\r\n        style: new HTMLTagSpecification(nls.localize(6, null), ['media', 'nonce', 'type', 'scoped:v']),\r\n        // Sections\r\n        body: new HTMLTagSpecification(nls.localize(7, null), ['onafterprint', 'onbeforeprint', 'onbeforeunload', 'onhashchange', 'onlanguagechange', 'onmessage', 'onoffline', 'ononline', 'onpagehide', 'onpageshow', 'onpopstate', 'onstorage', 'onunload']),\r\n        article: new HTMLTagSpecification(nls.localize(8, null)),\r\n        section: new HTMLTagSpecification(nls.localize(9, null)),\r\n        nav: new HTMLTagSpecification(nls.localize(10, null)),\r\n        aside: new HTMLTagSpecification(nls.localize(11, null)),\r\n        h1: new HTMLTagSpecification(nls.localize(12, null)),\r\n        h2: new HTMLTagSpecification(nls.localize(13, null)),\r\n        h3: new HTMLTagSpecification(nls.localize(14, null)),\r\n        h4: new HTMLTagSpecification(nls.localize(15, null)),\r\n        h5: new HTMLTagSpecification(nls.localize(16, null)),\r\n        h6: new HTMLTagSpecification(nls.localize(17, null)),\r\n        header: new HTMLTagSpecification(nls.localize(18, null)),\r\n        footer: new HTMLTagSpecification(nls.localize(19, null)),\r\n        address: new HTMLTagSpecification(nls.localize(20, null)),\r\n        // Grouping content\r\n        p: new HTMLTagSpecification(nls.localize(21, null)),\r\n        hr: new HTMLTagSpecification(nls.localize(22, null)),\r\n        pre: new HTMLTagSpecification(nls.localize(23, null)),\r\n        blockquote: new HTMLTagSpecification(nls.localize(24, null), ['cite']),\r\n        ol: new HTMLTagSpecification(nls.localize(25, null), ['reversed:v', 'start', 'type:lt']),\r\n        ul: new HTMLTagSpecification(nls.localize(26, null)),\r\n        li: new HTMLTagSpecification(nls.localize(27, null), ['value']),\r\n        dl: new HTMLTagSpecification(nls.localize(28, null)),\r\n        dt: new HTMLTagSpecification(nls.localize(29, null)),\r\n        dd: new HTMLTagSpecification(nls.localize(30, null)),\r\n        figure: new HTMLTagSpecification(nls.localize(31, null)),\r\n        figcaption: new HTMLTagSpecification(nls.localize(32, null)),\r\n        main: new HTMLTagSpecification(nls.localize(33, null)),\r\n        div: new HTMLTagSpecification(nls.localize(34, null)),\r\n        // Text-level semantics\r\n        a: new HTMLTagSpecification(nls.localize(35, null), ['href', 'target', 'download', 'ping', 'rel', 'hreflang', 'type']),\r\n        em: new HTMLTagSpecification(nls.localize(36, null)),\r\n        strong: new HTMLTagSpecification(nls.localize(37, null)),\r\n        small: new HTMLTagSpecification(nls.localize(38, null)),\r\n        s: new HTMLTagSpecification(nls.localize(39, null)),\r\n        cite: new HTMLTagSpecification(nls.localize(40, null)),\r\n        q: new HTMLTagSpecification(nls.localize(41, null), ['cite']),\r\n        dfn: new HTMLTagSpecification(nls.localize(42, null)),\r\n        abbr: new HTMLTagSpecification(nls.localize(43, null)),\r\n        ruby: new HTMLTagSpecification(nls.localize(44, null)),\r\n        rb: new HTMLTagSpecification(nls.localize(45, null)),\r\n        rt: new HTMLTagSpecification(nls.localize(46, null)),\r\n        // <rtc> is not yet supported by 2+ browsers\r\n        //rtc: new HTMLTagSpecification(\r\n        //\tnls.localize('tags.rtc', 'The rtc element marks a ruby text container for ruby text components in a ruby annotation. When it is the child of a ruby element it doesn\\'t represent anything itself, but its parent ruby element uses it as part of determining what it represents.')),\r\n        rp: new HTMLTagSpecification(nls.localize(47, null)),\r\n        // <data> is not yet supported by 2+ browsers\r\n        //data: new HTMLTagSpecification(\r\n        //\tnls.localize('tags.data', 'The data element represents its contents, along with a machine-readable form of those contents in the value attribute.')),\r\n        time: new HTMLTagSpecification(nls.localize(48, null), ['datetime']),\r\n        code: new HTMLTagSpecification(nls.localize(49, null)),\r\n        var: new HTMLTagSpecification(nls.localize(50, null)),\r\n        samp: new HTMLTagSpecification(nls.localize(51, null)),\r\n        kbd: new HTMLTagSpecification(nls.localize(52, null)),\r\n        sub: new HTMLTagSpecification(nls.localize(53, null)),\r\n        sup: new HTMLTagSpecification(nls.localize(54, null)),\r\n        i: new HTMLTagSpecification(nls.localize(55, null)),\r\n        b: new HTMLTagSpecification(nls.localize(56, null)),\r\n        u: new HTMLTagSpecification(nls.localize(57, null)),\r\n        mark: new HTMLTagSpecification(nls.localize(58, null)),\r\n        bdi: new HTMLTagSpecification(nls.localize(59, null)),\r\n        bdo: new HTMLTagSpecification(nls.localize(60, null)),\r\n        span: new HTMLTagSpecification(nls.localize(61, null)),\r\n        br: new HTMLTagSpecification(nls.localize(62, null)),\r\n        wbr: new HTMLTagSpecification(nls.localize(63, null)),\r\n        // Edits\r\n        ins: new HTMLTagSpecification(nls.localize(64, null)),\r\n        del: new HTMLTagSpecification(nls.localize(65, null), ['cite', 'datetime']),\r\n        // Embedded content\r\n        picture: new HTMLTagSpecification(nls.localize(66, null)),\r\n        img: new HTMLTagSpecification(nls.localize(67, null), ['alt', 'src', 'srcset', 'crossorigin:xo', 'usemap', 'ismap:v', 'width', 'height']),\r\n        iframe: new HTMLTagSpecification(nls.localize(68, null), ['src', 'srcdoc', 'name', 'sandbox:sb', 'seamless:v', 'allowfullscreen:v', 'width', 'height']),\r\n        embed: new HTMLTagSpecification(nls.localize(69, null), ['src', 'type', 'width', 'height']),\r\n        object: new HTMLTagSpecification(nls.localize(70, null), ['data', 'type', 'typemustmatch:v', 'name', 'usemap', 'form', 'width', 'height']),\r\n        param: new HTMLTagSpecification(nls.localize(71, null), ['name', 'value']),\r\n        video: new HTMLTagSpecification(nls.localize(72, null), ['src', 'crossorigin:xo', 'poster', 'preload:pl', 'autoplay:v', 'mediagroup', 'loop:v', 'muted:v', 'controls:v', 'width', 'height']),\r\n        audio: new HTMLTagSpecification(nls.localize(73, null), ['src', 'crossorigin:xo', 'preload:pl', 'autoplay:v', 'mediagroup', 'loop:v', 'muted:v', 'controls:v']),\r\n        source: new HTMLTagSpecification(nls.localize(74, null), \r\n        // 'When the source element has a parent that is a picture element, the source element allows authors to specify multiple alternative source sets for img elements.'\r\n        ['src', 'type']),\r\n        track: new HTMLTagSpecification(nls.localize(75, null), ['default:v', 'kind:tk', 'label', 'src', 'srclang']),\r\n        map: new HTMLTagSpecification(nls.localize(76, null), ['name']),\r\n        area: new HTMLTagSpecification(nls.localize(77, null), ['alt', 'coords', 'shape:sh', 'href', 'target', 'download', 'ping', 'rel', 'hreflang', 'type']),\r\n        // Tabular data\r\n        table: new HTMLTagSpecification(nls.localize(78, null), ['sortable:v', 'border']),\r\n        caption: new HTMLTagSpecification(nls.localize(79, null)),\r\n        colgroup: new HTMLTagSpecification(nls.localize(80, null), ['span']),\r\n        col: new HTMLTagSpecification(nls.localize(81, null), ['span']),\r\n        tbody: new HTMLTagSpecification(nls.localize(82, null)),\r\n        thead: new HTMLTagSpecification(nls.localize(83, null)),\r\n        tfoot: new HTMLTagSpecification(nls.localize(84, null)),\r\n        tr: new HTMLTagSpecification(nls.localize(85, null)),\r\n        td: new HTMLTagSpecification(nls.localize(86, null), ['colspan', 'rowspan', 'headers']),\r\n        th: new HTMLTagSpecification(nls.localize(87, null), ['colspan', 'rowspan', 'headers', 'scope:s', 'sorted', 'abbr']),\r\n        // Forms\r\n        form: new HTMLTagSpecification(nls.localize(88, null), ['accept-charset', 'action', 'autocomplete:o', 'enctype:et', 'method:m', 'name', 'novalidate:v', 'target']),\r\n        label: new HTMLTagSpecification(nls.localize(89, null), ['form', 'for']),\r\n        input: new HTMLTagSpecification(nls.localize(90, null), ['accept', 'alt', 'autocomplete:o', 'autofocus:v', 'checked:v', 'dirname', 'disabled:v', 'form', 'formaction', 'formenctype:et', 'formmethod:fm', 'formnovalidate:v', 'formtarget', 'height', 'inputmode:im', 'list', 'max', 'maxlength', 'min', 'minlength', 'multiple:v', 'name', 'pattern', 'placeholder', 'readonly:v', 'required:v', 'size', 'src', 'step', 'type:t', 'value', 'width']),\r\n        button: new HTMLTagSpecification(nls.localize(91, null), ['autofocus:v', 'disabled:v', 'form', 'formaction', 'formenctype:et', 'formmethod:fm', 'formnovalidate:v', 'formtarget', 'name', 'type:bt', 'value']),\r\n        select: new HTMLTagSpecification(nls.localize(92, null), ['autocomplete:o', 'autofocus:v', 'disabled:v', 'form', 'multiple:v', 'name', 'required:v', 'size']),\r\n        datalist: new HTMLTagSpecification(nls.localize(93, null)),\r\n        optgroup: new HTMLTagSpecification(nls.localize(94, null), ['disabled:v', 'label']),\r\n        option: new HTMLTagSpecification(nls.localize(95, null), ['disabled:v', 'label', 'selected:v', 'value']),\r\n        textarea: new HTMLTagSpecification(nls.localize(96, null), ['autocomplete:o', 'autofocus:v', 'cols', 'dirname', 'disabled:v', 'form', 'inputmode:im', 'maxlength', 'minlength', 'name', 'placeholder', 'readonly:v', 'required:v', 'rows', 'wrap:w']),\r\n        output: new HTMLTagSpecification(nls.localize(97, null), ['for', 'form', 'name']),\r\n        progress: new HTMLTagSpecification(nls.localize(98, null), ['value', 'max']),\r\n        meter: new HTMLTagSpecification(nls.localize(99, null), ['value', 'min', 'max', 'low', 'high', 'optimum']),\r\n        fieldset: new HTMLTagSpecification(nls.localize(100, null), ['disabled:v', 'form', 'name']),\r\n        legend: new HTMLTagSpecification(nls.localize(101, null)),\r\n        // Interactive elements\r\n        details: new HTMLTagSpecification(nls.localize(102, null), ['open:v']),\r\n        summary: new HTMLTagSpecification(nls.localize(103, null)),\r\n        // <menu> and <menuitem> are not yet supported by 2+ browsers\r\n        //menu: new HTMLTagSpecification(\r\n        //\tnls.localize('tags.menu', 'The menu element represents a list of commands.'),\r\n        //\t['type:mt', 'label']),\r\n        //menuitem: new HTMLTagSpecification(\r\n        //\tnls.localize('tags.menuitem', 'The menuitem element represents a command that the user can invoke from a popup menu (either a context menu or the menu of a menu button).')),\r\n        dialog: new HTMLTagSpecification(nls.localize(104, null)),\r\n        // Scripting\r\n        script: new HTMLTagSpecification(nls.localize(105, null), ['src', 'type', 'charset', 'async:v', 'defer:v', 'crossorigin:xo', 'nonce']),\r\n        noscript: new HTMLTagSpecification(nls.localize(106, null)),\r\n        template: new HTMLTagSpecification(nls.localize(107, null)),\r\n        canvas: new HTMLTagSpecification(nls.localize(108, null), ['width', 'height'])\r\n    };\r\n    // Ionic tag information sourced from Ionic main website (https://github.com/driftyco/ionic-site)\r\n    exports.IONIC_TAGS = {\r\n        'ion-checkbox': new HTMLTagSpecification(nls.localize(109, null), ['name', 'ng-false-value', 'ng-model', 'ng-true-value']),\r\n        'ion-content': new HTMLTagSpecification(nls.localize(110, null), ['delegate-handle', 'direction:scrolldir', 'has-bouncing:b', 'locking:b', 'on-scroll', 'on-scroll-complete', 'overflow-scroll:b', 'padding:b', 'scroll:b', 'scrollbar-x:b', 'scrollbar-y:b', 'start-x', 'start-y']),\r\n        'ion-delete-button': new HTMLTagSpecification(nls.localize(111, null), []),\r\n        'ion-footer-bar': new HTMLTagSpecification(nls.localize(112, null), ['align-title:align', 'keyboard-attach:v']),\r\n        'ion-header-bar': new HTMLTagSpecification(nls.localize(113, null), ['align-title:align', 'no-tap-scroll:b']),\r\n        'ion-infinite-scroll': new HTMLTagSpecification(nls.localize(114, null), ['distance', 'icon', 'immediate-check:b', 'on-infinite', 'spinner']),\r\n        'ion-input': new HTMLTagSpecification(nls.localize(115, null), ['type:inputtype', 'clearInput:v']),\r\n        'ion-item': new HTMLTagSpecification(nls.localize(116, null), []),\r\n        'ion-list': new HTMLTagSpecification(nls.localize(117, null), ['can-swipe:b', 'delegate-handle', 'show-delete:b', 'show-reorder:b', 'type:listtype']),\r\n        'ion-modal-view': new HTMLTagSpecification(nls.localize(118, null), []),\r\n        'ion-nav-back-button': new HTMLTagSpecification(nls.localize(119, null), []),\r\n        'ion-nav-bar': new HTMLTagSpecification(nls.localize(120, null), ['align-title:align', 'delegate-handle', 'no-tap-scroll:b']),\r\n        'ion-nav-buttons': new HTMLTagSpecification(nls.localize(121, null), ['side:navsides']),\r\n        'ion-nav-title': new HTMLTagSpecification(nls.localize(122, null), []),\r\n        'ion-nav-view': new HTMLTagSpecification(nls.localize(123, null), ['name']),\r\n        'ion-option-button': new HTMLTagSpecification(nls.localize(124, null), []),\r\n        'ion-pane': new HTMLTagSpecification(nls.localize(125, null), []),\r\n        'ion-popover-view': new HTMLTagSpecification(nls.localize(126, null), []),\r\n        'ion-radio': new HTMLTagSpecification(nls.localize(127, null), ['disabled:b', 'icon', 'name', 'ng-disabled:b', 'ng-model', 'ng-value', 'value']),\r\n        'ion-refresher': new HTMLTagSpecification(nls.localize(128, null), ['disable-pulling-rotation:b', 'on-pulling', 'on-refresh', 'pulling-icon', 'pulling-text', 'refreshing-icon', 'spinner']),\r\n        'ion-reorder-button': new HTMLTagSpecification(nls.localize(129, null), ['on-reorder']),\r\n        'ion-scroll': new HTMLTagSpecification(nls.localize(130, null), ['delegate-handle', 'direction:scrolldir', 'has-bouncing:b', 'locking:b', 'max-zoom', 'min-zoom', 'on-refresh', 'on-scroll', 'paging:b', 'scrollbar-x:b', 'scrollbar-y:b', 'zooming:b']),\r\n        'ion-side-menu': new HTMLTagSpecification(nls.localize(131, null), ['is-enabled:b', 'expose-aside-when', 'side:navsides', 'width']),\r\n        'ion-side-menu-content': new HTMLTagSpecification(nls.localize(132, null), ['drag-content:b', 'edge-drag-threshold']),\r\n        'ion-side-menus': new HTMLTagSpecification(nls.localize(133, null), ['delegate-handle', 'enable-menu-with-back-views:b']),\r\n        'ion-slide': new HTMLTagSpecification(nls.localize(134, null), []),\r\n        'ion-slide-box': new HTMLTagSpecification(nls.localize(135, null), ['active-slide', 'auto-play:b', 'delegate-handle', 'does-continue:b', 'on-slide-changed', 'pager-click', 'show-pager:b', 'slide-interval']),\r\n        'ion-spinner': new HTMLTagSpecification(nls.localize(136, null), ['icon']),\r\n        'ion-tab': new HTMLTagSpecification(nls.localize(137, null), ['badge', 'badge-style', 'disabled', 'hidden', 'href', 'icon', 'icon-off', 'icon-on', 'ng-click', 'on-deselect', 'on-select', 'title']),\r\n        'ion-tabs': new HTMLTagSpecification(nls.localize(138, null), ['delegate-handle']),\r\n        'ion-title': new HTMLTagSpecification(nls.localize(139, null), []),\r\n        'ion-toggle': new HTMLTagSpecification(nls.localize(140, null), ['name', 'ng-false-value', 'ng-model', 'ng-true-value', 'toggle-class']),\r\n        'ion-view ': new HTMLTagSpecification(nls.localize(141, null), ['cache-view:b', 'can-swipe-back:b', 'hide-back-button:b', 'hide-nav-bar:b', 'view-title'])\r\n    };\r\n    function getHTML5TagProvider() {\r\n        var globalAttributes = [\r\n            'aria-activedescendant', 'aria-atomic:b', 'aria-autocomplete:autocomplete', 'aria-busy:b', 'aria-checked:tristate', 'aria-colcount', 'aria-colindex', 'aria-colspan', 'aria-controls', 'aria-current:current', 'aria-describedat',\r\n            'aria-describedby', 'aria-disabled:b', 'aria-dropeffect:dropeffect', 'aria-errormessage', 'aria-expanded:u', 'aria-flowto', 'aria-grabbed:u', 'aria-haspopup:b', 'aria-hidden:b', 'aria-invalid:invalid', 'aria-kbdshortcuts',\r\n            'aria-label', 'aria-labelledby', 'aria-level', 'aria-live:live', 'aria-modal:b', 'aria-multiline:b', 'aria-multiselectable:b', 'aria-orientation:orientation', 'aria-owns', 'aria-placeholder', 'aria-posinset', 'aria-pressed:tristate',\r\n            'aria-readonly:b', 'aria-relevant:relevant', 'aria-required:b', 'aria-roledescription', 'aria-rowcount', 'aria-rowindex', 'aria-rowspan', 'aria-selected:u', 'aria-setsize', 'aria-sort:sort', 'aria-valuemax', 'aria-valuemin', 'aria-valuenow', 'aria-valuetext',\r\n            'accesskey', 'class', 'contenteditable:b', 'contextmenu', 'dir:d', 'draggable:b', 'dropzone', 'hidden:v', 'id', 'itemid', 'itemprop', 'itemref', 'itemscope:v', 'itemtype', 'lang', 'role:roles', 'spellcheck:b', 'style', 'tabindex',\r\n            'title', 'translate:y'];\r\n        var eventHandlers = ['onabort', 'onblur', 'oncanplay', 'oncanplaythrough', 'onchange', 'onclick', 'oncontextmenu', 'ondblclick', 'ondrag', 'ondragend', 'ondragenter', 'ondragleave', 'ondragover', 'ondragstart',\r\n            'ondrop', 'ondurationchange', 'onemptied', 'onended', 'onerror', 'onfocus', 'onformchange', 'onforminput', 'oninput', 'oninvalid', 'onkeydown', 'onkeypress', 'onkeyup', 'onload', 'onloadeddata', 'onloadedmetadata',\r\n            'onloadstart', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'onmousewheel', 'onpause', 'onplay', 'onplaying', 'onprogress', 'onratechange', 'onreset', 'onresize', 'onreadystatechange', 'onscroll',\r\n            'onseeked', 'onseeking', 'onselect', 'onshow', 'onstalled', 'onsubmit', 'onsuspend', 'ontimeupdate', 'onvolumechange', 'onwaiting'];\r\n        var valueSets = {\r\n            b: ['true', 'false'],\r\n            u: ['true', 'false', 'undefined'],\r\n            o: ['on', 'off'],\r\n            y: ['yes', 'no'],\r\n            w: ['soft', 'hard'],\r\n            d: ['ltr', 'rtl', 'auto'],\r\n            m: ['GET', 'POST', 'dialog'],\r\n            fm: ['GET', 'POST'],\r\n            s: ['row', 'col', 'rowgroup', 'colgroup'],\r\n            t: ['hidden', 'text', 'search', 'tel', 'url', 'email', 'password', 'datetime', 'date', 'month', 'week', 'time', 'datetime-local', 'number', 'range', 'color', 'checkbox', 'radio', 'file', 'submit', 'image', 'reset', 'button'],\r\n            im: ['verbatim', 'latin', 'latin-name', 'latin-prose', 'full-width-latin', 'kana', 'kana-name', 'katakana', 'numeric', 'tel', 'email', 'url'],\r\n            bt: ['button', 'submit', 'reset', 'menu'],\r\n            lt: ['1', 'a', 'A', 'i', 'I'],\r\n            mt: ['context', 'toolbar'],\r\n            mit: ['command', 'checkbox', 'radio'],\r\n            et: ['application/x-www-form-urlencoded', 'multipart/form-data', 'text/plain'],\r\n            tk: ['subtitles', 'captions', 'descriptions', 'chapters', 'metadata'],\r\n            pl: ['none', 'metadata', 'auto'],\r\n            sh: ['circle', 'default', 'poly', 'rect'],\r\n            xo: ['anonymous', 'use-credentials'],\r\n            sb: ['allow-forms', 'allow-modals', 'allow-pointer-lock', 'allow-popups', 'allow-popups-to-escape-sandbox', 'allow-same-origin', 'allow-scripts', 'allow-top-navigation'],\r\n            tristate: ['true', 'false', 'mixed', 'undefined'],\r\n            autocomplete: ['inline', 'list', 'both', 'none'],\r\n            current: ['page', 'step', 'location', 'date', 'time', 'true', 'false'],\r\n            dropeffect: ['copy', 'move', 'link', 'execute', 'popup', 'none'],\r\n            invalid: ['grammar', 'false', 'spelling', 'true'],\r\n            live: ['off', 'polite', 'assertive'],\r\n            orientation: ['vertical', 'horizontal', 'undefined'],\r\n            relevant: ['additions', 'removals', 'text', 'all', 'additions text'],\r\n            sort: ['ascending', 'descending', 'none', 'other'],\r\n            roles: ['alert', 'alertdialog', 'button', 'checkbox', 'dialog', 'gridcell', 'link', 'log', 'marquee', 'menuitem', 'menuitemcheckbox', 'menuitemradio', 'option', 'progressbar', 'radio', 'scrollbar', 'searchbox', 'slider',\r\n                'spinbutton', 'status', 'switch', 'tab', 'tabpanel', 'textbox', 'timer', 'tooltip', 'treeitem', 'combobox', 'grid', 'listbox', 'menu', 'menubar', 'radiogroup', 'tablist', 'tree', 'treegrid',\r\n                'application', 'article', 'cell', 'columnheader', 'definition', 'directory', 'document', 'feed', 'figure', 'group', 'heading', 'img', 'list', 'listitem', 'math', 'none', 'note', 'presentation', 'region', 'row', 'rowgroup',\r\n                'rowheader', 'separator', 'table', 'term', 'text', 'toolbar',\r\n                'banner', 'complementary', 'contentinfo', 'form', 'main', 'navigation', 'region', 'search']\r\n        };\r\n        return {\r\n            collectTags: function (collector) { return collectTagsDefault(collector, exports.HTML_TAGS); },\r\n            collectAttributes: function (tag, collector) {\r\n                collectAttributesDefault(tag, collector, exports.HTML_TAGS, globalAttributes);\r\n                eventHandlers.forEach(function (handler) {\r\n                    collector(handler, 'event');\r\n                });\r\n            },\r\n            collectValues: function (tag, attribute, collector) { return collectValuesDefault(tag, attribute, collector, exports.HTML_TAGS, globalAttributes, valueSets); }\r\n        };\r\n    }\r\n    exports.getHTML5TagProvider = getHTML5TagProvider;\r\n    function getAngularTagProvider() {\r\n        var customTags = {\r\n            input: ['ng-model', 'ng-required', 'ng-minlength', 'ng-maxlength', 'ng-pattern', 'ng-trim'],\r\n            select: ['ng-model'],\r\n            textarea: ['ng-model', 'ng-required', 'ng-minlength', 'ng-maxlength', 'ng-pattern', 'ng-trim']\r\n        };\r\n        var globalAttributes = ['ng-app', 'ng-bind', 'ng-bind-html', 'ng-bind-template', 'ng-blur', 'ng-change', 'ng-checked', 'ng-class', 'ng-class-even', 'ng-class-odd',\r\n            'ng-click', 'ng-cloak', 'ng-controller', 'ng-copy', 'ng-csp', 'ng-cut', 'ng-dblclick', 'ng-disabled', 'ng-focus', 'ng-form', 'ng-hide', 'ng-href', 'ng-if',\r\n            'ng-include', 'ng-init', 'ng-jq', 'ng-keydown', 'ng-keypress', 'ng-keyup', 'ng-list', 'ng-model-options', 'ng-mousedown', 'ng-mouseenter', 'ng-mouseleave',\r\n            'ng-mousemove', 'ng-mouseover', 'ng-mouseup', 'ng-non-bindable', 'ng-open', 'ng-options', 'ng-paste', 'ng-pluralize', 'ng-readonly', 'ng-repeat', 'ng-selected',\r\n            'ng-show', 'ng-src', 'ng-srcset', 'ng-style', 'ng-submit', 'ng-switch', 'ng-transclude', 'ng-value'\r\n        ];\r\n        return {\r\n            collectTags: function (collector) {\r\n                // no extra tags\r\n            },\r\n            collectAttributes: function (tag, collector) {\r\n                if (tag) {\r\n                    var attributes = customTags[tag];\r\n                    if (attributes) {\r\n                        attributes.forEach(function (a) {\r\n                            collector(a, null);\r\n                            collector('data-' + a, null);\r\n                        });\r\n                    }\r\n                }\r\n                globalAttributes.forEach(function (a) {\r\n                    collector(a, null);\r\n                    collector('data-' + a, null);\r\n                });\r\n            },\r\n            collectValues: function (tag, attribute, collector) {\r\n                // no values\r\n            }\r\n        };\r\n    }\r\n    exports.getAngularTagProvider = getAngularTagProvider;\r\n    function getIonicTagProvider() {\r\n        var customTags = {\r\n            a: ['nav-direction:navdir', 'nav-transition:trans'],\r\n            button: ['menu-toggle:menusides']\r\n        };\r\n        var globalAttributes = ['collection-repeat', 'force-refresh-images:b', 'ion-stop-event', 'item-height', 'item-render-buffer', 'item-width', 'menu-close:v',\r\n            'on-double-tap', 'on-drag', 'on-drag-down', 'on-drag-left', 'on-drag-right', 'on-drag-up', 'on-hold', 'on-release', 'on-swipe', 'on-swipe-down', 'on-swipe-left',\r\n            'on-swipe-right', 'on-swipe-up', 'on-tap', 'on-touch'];\r\n        var valueSets = {\r\n            align: ['center', 'left', 'right'],\r\n            b: ['true', 'false'],\r\n            inputtype: ['email', 'number', 'password', 'search', 'tel', 'text', 'url'],\r\n            listtype: ['card', 'list-inset'],\r\n            menusides: ['left', 'right'],\r\n            navdir: ['back', 'enter', 'exit', 'forward', 'swap'],\r\n            navsides: ['left', 'primary', 'right', 'secondary'],\r\n            scrolldir: ['x', 'xy', 'y'],\r\n            trans: ['android', 'ios', 'none']\r\n        };\r\n        return {\r\n            collectTags: function (collector) { return collectTagsDefault(collector, exports.IONIC_TAGS); },\r\n            collectAttributes: function (tag, collector) {\r\n                collectAttributesDefault(tag, collector, exports.IONIC_TAGS, globalAttributes);\r\n                if (tag) {\r\n                    var attributes = customTags[tag];\r\n                    if (attributes) {\r\n                        attributes.forEach(function (a) {\r\n                            var segments = a.split(':');\r\n                            collector(segments[0], segments[1]);\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            collectValues: function (tag, attribute, collector) { return collectValuesDefault(tag, attribute, collector, exports.IONIC_TAGS, globalAttributes, valueSets, customTags); }\r\n        };\r\n    }\r\n    exports.getIonicTagProvider = getIonicTagProvider;\r\n    function collectTagsDefault(collector, tagSet) {\r\n        for (var tag in tagSet) {\r\n            collector(tag, tagSet[tag].label);\r\n        }\r\n    }\r\n    function collectAttributesDefault(tag, collector, tagSet, globalAttributes) {\r\n        globalAttributes.forEach(function (attr) {\r\n            var segments = attr.split(':');\r\n            collector(segments[0], segments[1]);\r\n        });\r\n        if (tag) {\r\n            var tags = tagSet[tag];\r\n            if (tags) {\r\n                var attributes = tags.attributes;\r\n                if (attributes) {\r\n                    attributes.forEach(function (attr) {\r\n                        var segments = attr.split(':');\r\n                        collector(segments[0], segments[1]);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function collectValuesDefault(tag, attribute, collector, tagSet, globalAttributes, valueSets, customTags) {\r\n        var prefix = attribute + ':';\r\n        var processAttributes = function (attributes) {\r\n            attributes.forEach(function (attr) {\r\n                if (attr.length > prefix.length && strings.startsWith(attr, prefix)) {\r\n                    var typeInfo = attr.substr(prefix.length);\r\n                    if (typeInfo === 'v') {\r\n                        collector(attribute);\r\n                    }\r\n                    else {\r\n                        var values = valueSets[typeInfo];\r\n                        if (values) {\r\n                            values.forEach(collector);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        };\r\n        if (tag) {\r\n            var tags = tagSet[tag];\r\n            if (tags) {\r\n                var attributes = tags.attributes;\r\n                if (attributes) {\r\n                    processAttributes(attributes);\r\n                }\r\n            }\r\n        }\r\n        processAttributes(globalAttributes);\r\n        if (customTags) {\r\n            var customTagAttributes = customTags[tag];\r\n            if (customTagAttributes) {\r\n                processAttributes(customTagAttributes);\r\n            }\r\n        }\r\n    }\r\n});\r\n\ndefine(\"vs/editor/common/services/codeEditorService\", [\"require\", \"exports\", 'vs/platform/instantiation/common/instantiation'], function (require, exports, instantiation_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    exports.ID_CODE_EDITOR_SERVICE = 'codeEditorService';\r\n    exports.ICodeEditorService = instantiation_1.createDecorator(exports.ID_CODE_EDITOR_SERVICE);\r\n});\r\n\ndefine(\"vs/platform/editor/common/editor\", [\"require\", \"exports\", 'vs/platform/instantiation/common/instantiation'], function (require, exports, instantiation_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    exports.IEditorService = instantiation_1.createDecorator('editorService');\r\n    /**\r\n     * Possible locations for opening an editor.\r\n     */\r\n    (function (Position) {\r\n        /** Opens the editor in the LEFT most position replacing the input currently showing */\r\n        Position[Position[\"LEFT\"] = 0] = \"LEFT\";\r\n        /** Opens the editor in the CENTER position replacing the input currently showing */\r\n        Position[Position[\"CENTER\"] = 1] = \"CENTER\";\r\n        /** Opens the editor in the RIGHT most position replacing the input currently showing */\r\n        Position[Position[\"RIGHT\"] = 2] = \"RIGHT\";\r\n    })(exports.Position || (exports.Position = {}));\r\n    var Position = exports.Position;\r\n    exports.POSITIONS = [Position.LEFT, Position.CENTER, Position.RIGHT];\r\n    (function (Direction) {\r\n        Direction[Direction[\"LEFT\"] = 0] = \"LEFT\";\r\n        Direction[Direction[\"RIGHT\"] = 1] = \"RIGHT\";\r\n    })(exports.Direction || (exports.Direction = {}));\r\n    var Direction = exports.Direction;\r\n});\r\n\ndefine(\"vs/platform/keybinding/common/keybindingService\", [\"require\", \"exports\", 'vs/platform/instantiation/common/instantiation'], function (require, exports, instantiation_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    (function (KbExprType) {\r\n        KbExprType[KbExprType[\"KbDefinedExpression\"] = 1] = \"KbDefinedExpression\";\r\n        KbExprType[KbExprType[\"KbNotExpression\"] = 2] = \"KbNotExpression\";\r\n        KbExprType[KbExprType[\"KbEqualsExpression\"] = 3] = \"KbEqualsExpression\";\r\n        KbExprType[KbExprType[\"KbNotEqualsExpression\"] = 4] = \"KbNotEqualsExpression\";\r\n        KbExprType[KbExprType[\"KbAndExpression\"] = 5] = \"KbAndExpression\";\r\n    })(exports.KbExprType || (exports.KbExprType = {}));\r\n    var KbExprType = exports.KbExprType;\r\n    function cmp(a, b) {\r\n        var aType = a.getType();\r\n        var bType = b.getType();\r\n        if (aType !== bType) {\r\n            return aType - bType;\r\n        }\r\n        switch (aType) {\r\n            case KbExprType.KbDefinedExpression:\r\n                return a.cmp(b);\r\n            case KbExprType.KbNotExpression:\r\n                return a.cmp(b);\r\n            case KbExprType.KbEqualsExpression:\r\n                return a.cmp(b);\r\n            case KbExprType.KbNotEqualsExpression:\r\n                return a.cmp(b);\r\n            default:\r\n                throw new Error('Unknown KbExpr!');\r\n        }\r\n    }\r\n    var KbDefinedExpression = (function () {\r\n        function KbDefinedExpression(key) {\r\n            this.key = key;\r\n        }\r\n        KbDefinedExpression.prototype.getType = function () {\r\n            return KbExprType.KbDefinedExpression;\r\n        };\r\n        KbDefinedExpression.prototype.cmp = function (other) {\r\n            if (this.key < other.key) {\r\n                return -1;\r\n            }\r\n            if (this.key > other.key) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        };\r\n        KbDefinedExpression.prototype.equals = function (other) {\r\n            if (other instanceof KbDefinedExpression) {\r\n                return (this.key === other.key);\r\n            }\r\n            return false;\r\n        };\r\n        KbDefinedExpression.prototype.evaluate = function (context) {\r\n            return (!!context[this.key]);\r\n        };\r\n        KbDefinedExpression.prototype.normalize = function () {\r\n            return this;\r\n        };\r\n        KbDefinedExpression.prototype.serialize = function () {\r\n            return this.key;\r\n        };\r\n        return KbDefinedExpression;\r\n    }());\r\n    exports.KbDefinedExpression = KbDefinedExpression;\r\n    var KbEqualsExpression = (function () {\r\n        function KbEqualsExpression(key, value) {\r\n            this.key = key;\r\n            this.value = value;\r\n        }\r\n        KbEqualsExpression.prototype.getType = function () {\r\n            return KbExprType.KbEqualsExpression;\r\n        };\r\n        KbEqualsExpression.prototype.cmp = function (other) {\r\n            if (this.key < other.key) {\r\n                return -1;\r\n            }\r\n            if (this.key > other.key) {\r\n                return 1;\r\n            }\r\n            if (this.value < other.value) {\r\n                return -1;\r\n            }\r\n            if (this.value > other.value) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        };\r\n        KbEqualsExpression.prototype.equals = function (other) {\r\n            if (other instanceof KbEqualsExpression) {\r\n                return (this.key === other.key && this.value === other.value);\r\n            }\r\n            return false;\r\n        };\r\n        KbEqualsExpression.prototype.evaluate = function (context) {\r\n            /* tslint:disable:triple-equals */\r\n            // Intentional ==\r\n            return (context[this.key] == this.value);\r\n            /* tslint:enable:triple-equals */\r\n        };\r\n        KbEqualsExpression.prototype.normalize = function () {\r\n            if (typeof this.value === 'boolean') {\r\n                if (this.value) {\r\n                    return new KbDefinedExpression(this.key);\r\n                }\r\n                return new KbNotExpression(this.key);\r\n            }\r\n            return this;\r\n        };\r\n        KbEqualsExpression.prototype.serialize = function () {\r\n            if (typeof this.value === 'boolean') {\r\n                return this.normalize().serialize();\r\n            }\r\n            return this.key + ' == \\'' + this.value + '\\'';\r\n        };\r\n        return KbEqualsExpression;\r\n    }());\r\n    exports.KbEqualsExpression = KbEqualsExpression;\r\n    var KbNotEqualsExpression = (function () {\r\n        function KbNotEqualsExpression(key, value) {\r\n            this.key = key;\r\n            this.value = value;\r\n        }\r\n        KbNotEqualsExpression.prototype.getType = function () {\r\n            return KbExprType.KbNotEqualsExpression;\r\n        };\r\n        KbNotEqualsExpression.prototype.cmp = function (other) {\r\n            if (this.key < other.key) {\r\n                return -1;\r\n            }\r\n            if (this.key > other.key) {\r\n                return 1;\r\n            }\r\n            if (this.value < other.value) {\r\n                return -1;\r\n            }\r\n            if (this.value > other.value) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        };\r\n        KbNotEqualsExpression.prototype.equals = function (other) {\r\n            if (other instanceof KbNotEqualsExpression) {\r\n                return (this.key === other.key && this.value === other.value);\r\n            }\r\n            return false;\r\n        };\r\n        KbNotEqualsExpression.prototype.evaluate = function (context) {\r\n            /* tslint:disable:triple-equals */\r\n            // Intentional !=\r\n            return (context[this.key] != this.value);\r\n            /* tslint:enable:triple-equals */\r\n        };\r\n        KbNotEqualsExpression.prototype.normalize = function () {\r\n            if (typeof this.value === 'boolean') {\r\n                if (this.value) {\r\n                    return new KbNotExpression(this.key);\r\n                }\r\n                return new KbDefinedExpression(this.key);\r\n            }\r\n            return this;\r\n        };\r\n        KbNotEqualsExpression.prototype.serialize = function () {\r\n            if (typeof this.value === 'boolean') {\r\n                return this.normalize().serialize();\r\n            }\r\n            return this.key + ' != \\'' + this.value + '\\'';\r\n        };\r\n        return KbNotEqualsExpression;\r\n    }());\r\n    exports.KbNotEqualsExpression = KbNotEqualsExpression;\r\n    var KbNotExpression = (function () {\r\n        function KbNotExpression(key) {\r\n            this.key = key;\r\n        }\r\n        KbNotExpression.prototype.getType = function () {\r\n            return KbExprType.KbNotExpression;\r\n        };\r\n        KbNotExpression.prototype.cmp = function (other) {\r\n            if (this.key < other.key) {\r\n                return -1;\r\n            }\r\n            if (this.key > other.key) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        };\r\n        KbNotExpression.prototype.equals = function (other) {\r\n            if (other instanceof KbNotExpression) {\r\n                return (this.key === other.key);\r\n            }\r\n            return false;\r\n        };\r\n        KbNotExpression.prototype.evaluate = function (context) {\r\n            return (!context[this.key]);\r\n        };\r\n        KbNotExpression.prototype.normalize = function () {\r\n            return this;\r\n        };\r\n        KbNotExpression.prototype.serialize = function () {\r\n            return '!' + this.key;\r\n        };\r\n        return KbNotExpression;\r\n    }());\r\n    exports.KbNotExpression = KbNotExpression;\r\n    var KbAndExpression = (function () {\r\n        function KbAndExpression(expr) {\r\n            this.expr = KbAndExpression._normalizeArr(expr);\r\n        }\r\n        KbAndExpression.prototype.getType = function () {\r\n            return KbExprType.KbAndExpression;\r\n        };\r\n        KbAndExpression.prototype.equals = function (other) {\r\n            if (other instanceof KbAndExpression) {\r\n                if (this.expr.length !== other.expr.length) {\r\n                    return false;\r\n                }\r\n                for (var i = 0, len = this.expr.length; i < len; i++) {\r\n                    if (!this.expr[i].equals(other.expr[i])) {\r\n                        return false;\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n        };\r\n        KbAndExpression.prototype.evaluate = function (context) {\r\n            for (var i = 0, len = this.expr.length; i < len; i++) {\r\n                if (!this.expr[i].evaluate(context)) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        };\r\n        KbAndExpression._normalizeArr = function (arr) {\r\n            var expr = [];\r\n            if (arr) {\r\n                for (var i = 0, len = arr.length; i < len; i++) {\r\n                    var e = arr[i];\r\n                    if (!e) {\r\n                        continue;\r\n                    }\r\n                    e = e.normalize();\r\n                    if (!e) {\r\n                        continue;\r\n                    }\r\n                    if (e instanceof KbAndExpression) {\r\n                        expr = expr.concat(e.expr);\r\n                        continue;\r\n                    }\r\n                    expr.push(e);\r\n                }\r\n                expr.sort(cmp);\r\n            }\r\n            return expr;\r\n        };\r\n        KbAndExpression.prototype.normalize = function () {\r\n            if (this.expr.length === 0) {\r\n                return null;\r\n            }\r\n            if (this.expr.length === 1) {\r\n                return this.expr[0];\r\n            }\r\n            return this;\r\n        };\r\n        KbAndExpression.prototype.serialize = function () {\r\n            if (this.expr.length === 0) {\r\n                return '';\r\n            }\r\n            if (this.expr.length === 1) {\r\n                return this.normalize().serialize();\r\n            }\r\n            return this.expr.map(function (e) { return e.serialize(); }).join(' && ');\r\n        };\r\n        return KbAndExpression;\r\n    }());\r\n    exports.KbAndExpression = KbAndExpression;\r\n    exports.KbExpr = {\r\n        has: function (key) { return new KbDefinedExpression(key); },\r\n        equals: function (key, value) { return new KbEqualsExpression(key, value); },\r\n        notEquals: function (key, value) { return new KbNotEqualsExpression(key, value); },\r\n        not: function (key) { return new KbNotExpression(key); },\r\n        and: function () {\r\n            var expr = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                expr[_i - 0] = arguments[_i];\r\n            }\r\n            return new KbAndExpression(expr);\r\n        },\r\n        deserialize: function (serialized) {\r\n            if (!serialized) {\r\n                return null;\r\n            }\r\n            var pieces = serialized.split('&&');\r\n            var result = new KbAndExpression(pieces.map(function (p) { return exports.KbExpr._deserializeOne(p); }));\r\n            return result.normalize();\r\n        },\r\n        _deserializeOne: function (serializedOne) {\r\n            serializedOne = serializedOne.trim();\r\n            if (serializedOne.indexOf('!=') >= 0) {\r\n                var pieces = serializedOne.split('!=');\r\n                return new KbNotEqualsExpression(pieces[0].trim(), exports.KbExpr._deserializeValue(pieces[1]));\r\n            }\r\n            if (serializedOne.indexOf('==') >= 0) {\r\n                var pieces = serializedOne.split('==');\r\n                return new KbEqualsExpression(pieces[0].trim(), exports.KbExpr._deserializeValue(pieces[1]));\r\n            }\r\n            if (/^\\!\\s*/.test(serializedOne)) {\r\n                return new KbNotExpression(serializedOne.substr(1).trim());\r\n            }\r\n            return new KbDefinedExpression(serializedOne);\r\n        },\r\n        _deserializeValue: function (serializedValue) {\r\n            serializedValue = serializedValue.trim();\r\n            if (serializedValue === 'true') {\r\n                return true;\r\n            }\r\n            if (serializedValue === 'false') {\r\n                return false;\r\n            }\r\n            var m = /^'([^']*)'$/.exec(serializedValue);\r\n            if (m) {\r\n                return m[1].trim();\r\n            }\r\n            return serializedValue;\r\n        }\r\n    };\r\n    exports.IKeybindingService = instantiation_1.createDecorator('keybindingService');\r\n    exports.SET_CONTEXT_COMMAND_ID = 'setContext';\r\n});\r\n\ndefine(\"vs/platform/keybinding/common/keybindingsRegistry\", [\"require\", \"exports\", 'vs/base/common/keyCodes', 'vs/base/common/platform', 'vs/base/common/types', 'vs/platform/platform'], function (require, exports, keyCodes_1, platform, types_1, platform_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    var KeybindingsRegistryImpl = (function () {\r\n        function KeybindingsRegistryImpl() {\r\n            this.WEIGHT = {\r\n                editorCore: function (importance) {\r\n                    if (importance === void 0) { importance = 0; }\r\n                    return 0 + importance;\r\n                },\r\n                editorContrib: function (importance) {\r\n                    if (importance === void 0) { importance = 0; }\r\n                    return 100 + importance;\r\n                },\r\n                workbenchContrib: function (importance) {\r\n                    if (importance === void 0) { importance = 0; }\r\n                    return 200 + importance;\r\n                },\r\n                builtinExtension: function (importance) {\r\n                    if (importance === void 0) { importance = 0; }\r\n                    return 300 + importance;\r\n                },\r\n                externalExtension: function (importance) {\r\n                    if (importance === void 0) { importance = 0; }\r\n                    return 400 + importance;\r\n                }\r\n            };\r\n            this._keybindings = [];\r\n            this._commands = Object.create(null);\r\n        }\r\n        /**\r\n         * Take current platform into account and reduce to primary & secondary.\r\n         */\r\n        KeybindingsRegistryImpl.bindToCurrentPlatform = function (kb) {\r\n            if (platform.isWindows) {\r\n                if (kb && kb.win) {\r\n                    return kb.win;\r\n                }\r\n            }\r\n            else if (platform.isMacintosh) {\r\n                if (kb && kb.mac) {\r\n                    return kb.mac;\r\n                }\r\n            }\r\n            else {\r\n                if (kb && kb.linux) {\r\n                    return kb.linux;\r\n                }\r\n            }\r\n            return kb;\r\n        };\r\n        KeybindingsRegistryImpl.prototype.registerCommandRule = function (rule) {\r\n            var _this = this;\r\n            var actualKb = KeybindingsRegistryImpl.bindToCurrentPlatform(rule);\r\n            // here\r\n            if (actualKb && actualKb.primary) {\r\n                this.registerDefaultKeybinding(actualKb.primary, rule.id, rule.weight, 0, rule.when);\r\n            }\r\n            // here\r\n            if (actualKb && Array.isArray(actualKb.secondary)) {\r\n                actualKb.secondary.forEach(function (k, i) { return _this.registerDefaultKeybinding(k, rule.id, rule.weight, -i - 1, rule.when); });\r\n            }\r\n        };\r\n        KeybindingsRegistryImpl.prototype.registerCommandDesc = function (desc) {\r\n            this.registerCommandRule(desc);\r\n            // if (_commands[desc.id]) {\r\n            // \tconsole.warn('Duplicate handler for command: ' + desc.id);\r\n            // }\r\n            // this._commands[desc.id] = desc.handler;\r\n            var handler = desc.handler;\r\n            var description = desc.description || handler.description;\r\n            // add argument validation if rich command metadata is provided\r\n            if (typeof description === 'object') {\r\n                var constraints_1 = [];\r\n                for (var _i = 0, _a = description.args; _i < _a.length; _i++) {\r\n                    var arg = _a[_i];\r\n                    constraints_1.push(arg.constraint);\r\n                }\r\n                handler = function (accesor) {\r\n                    var args = [];\r\n                    for (var _i = 1; _i < arguments.length; _i++) {\r\n                        args[_i - 1] = arguments[_i];\r\n                    }\r\n                    types_1.validateConstraints(args, constraints_1);\r\n                    return desc.handler.apply(desc, [accesor].concat(args));\r\n                };\r\n            }\r\n            // make sure description is there\r\n            handler.description = description;\r\n            // register handler\r\n            this._commands[desc.id] = handler;\r\n        };\r\n        KeybindingsRegistryImpl.prototype.getCommands = function () {\r\n            return this._commands;\r\n        };\r\n        KeybindingsRegistryImpl.prototype.registerDefaultKeybinding = function (keybinding, commandId, weight1, weight2, when) {\r\n            if (platform.isWindows) {\r\n                if (keyCodes_1.BinaryKeybindings.hasCtrlCmd(keybinding) && !keyCodes_1.BinaryKeybindings.hasShift(keybinding) && keyCodes_1.BinaryKeybindings.hasAlt(keybinding) && !keyCodes_1.BinaryKeybindings.hasWinCtrl(keybinding)) {\r\n                    if (/^[A-Z0-9\\[\\]\\|\\;\\'\\,\\.\\/\\`]$/.test(keyCodes_1.KeyCode.toString(keyCodes_1.BinaryKeybindings.extractKeyCode(keybinding)))) {\r\n                        console.warn('Ctrl+Alt+ keybindings should not be used by default under Windows. Offender: ', keybinding, ' for ', commandId);\r\n                    }\r\n                }\r\n            }\r\n            this._keybindings.push({\r\n                keybinding: keybinding,\r\n                command: commandId,\r\n                when: when,\r\n                weight1: weight1,\r\n                weight2: weight2\r\n            });\r\n        };\r\n        KeybindingsRegistryImpl.prototype.getDefaultKeybindings = function () {\r\n            return this._keybindings;\r\n        };\r\n        return KeybindingsRegistryImpl;\r\n    }());\r\n    exports.KeybindingsRegistry = new KeybindingsRegistryImpl();\r\n    // Define extension point ids\r\n    exports.Extensions = {\r\n        EditorModes: 'platform.keybindingsRegistry'\r\n    };\r\n    platform_1.Registry.add(exports.Extensions.EditorModes, exports.KeybindingsRegistry);\r\n});\r\n\ndefine(\"vs/editor/common/config/config\", [\"require\", \"exports\", 'vs/base/common/keyCodes', 'vs/platform/editor/common/editor', 'vs/platform/keybinding/common/keybindingService', 'vs/platform/keybinding/common/keybindingsRegistry', 'vs/editor/common/editorCommon', 'vs/editor/common/services/codeEditorService'], function (require, exports, keyCodes_1, editor_1, keybindingService_1, keybindingsRegistry_1, editorCommon, codeEditorService_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    var H = editorCommon.Handler;\r\n    function findFocusedEditor(commandId, accessor, complain) {\r\n        var editor = accessor.get(codeEditorService_1.ICodeEditorService).getFocusedCodeEditor();\r\n        if (!editor) {\r\n            if (complain) {\r\n                console.warn('Cannot execute ' + commandId + ' because no code editor is focused.');\r\n            }\r\n            return null;\r\n        }\r\n        return editor;\r\n    }\r\n    exports.findFocusedEditor = findFocusedEditor;\r\n    function withCodeEditorFromCommandHandler(commandId, accessor, callback) {\r\n        var editor = findFocusedEditor(commandId, accessor, true);\r\n        if (editor) {\r\n            callback(editor);\r\n        }\r\n    }\r\n    exports.withCodeEditorFromCommandHandler = withCodeEditorFromCommandHandler;\r\n    function getActiveEditor(accessor) {\r\n        var editorService = accessor.get(editor_1.IEditorService);\r\n        var activeEditor = editorService.getActiveEditor && editorService.getActiveEditor();\r\n        if (activeEditor) {\r\n            var editor = activeEditor.getControl();\r\n            // Substitute for (editor instanceof ICodeEditor)\r\n            if (editor && typeof editor.getEditorType === 'function') {\r\n                var codeEditor = editor;\r\n                return codeEditor;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    exports.getActiveEditor = getActiveEditor;\r\n    function triggerEditorHandler(handlerId, accessor, args) {\r\n        withCodeEditorFromCommandHandler(handlerId, accessor, function (editor) {\r\n            editor.trigger('keyboard', handlerId, args);\r\n        });\r\n    }\r\n    function registerCoreCommand(handlerId, kb, weight, when) {\r\n        if (weight === void 0) { weight = keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(); }\r\n        var desc = {\r\n            id: handlerId,\r\n            handler: triggerEditorHandler.bind(null, handlerId),\r\n            weight: weight,\r\n            when: (when ? when : keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS)),\r\n            primary: kb.primary,\r\n            secondary: kb.secondary,\r\n            win: kb.win,\r\n            mac: kb.mac,\r\n            linux: kb.linux\r\n        };\r\n        keybindingsRegistry_1.KeybindingsRegistry.registerCommandDesc(desc);\r\n    }\r\n    function registerCoreDispatchCommand2(handlerId) {\r\n        var desc = {\r\n            id: handlerId,\r\n            handler: triggerEditorHandler.bind(null, handlerId),\r\n            weight: keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(),\r\n            when: null,\r\n            primary: 0\r\n        };\r\n        keybindingsRegistry_1.KeybindingsRegistry.registerCommandDesc(desc);\r\n        var desc2 = {\r\n            id: 'default:' + handlerId,\r\n            handler: function (accessor, args) {\r\n                withCodeEditorFromCommandHandler(handlerId, accessor, function (editor) {\r\n                    editor.trigger('keyboard', handlerId, args);\r\n                });\r\n            },\r\n            weight: keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(),\r\n            when: null,\r\n            primary: 0\r\n        };\r\n        keybindingsRegistry_1.KeybindingsRegistry.registerCommandDesc(desc2);\r\n    }\r\n    registerCoreDispatchCommand2(H.Type);\r\n    registerCoreDispatchCommand2(H.ReplacePreviousChar);\r\n    registerCoreDispatchCommand2(H.Paste);\r\n    registerCoreDispatchCommand2(H.Cut);\r\n    function getMacWordNavigationKB(shift, key) {\r\n        // For macs, word navigation is based on the alt modifier\r\n        if (shift) {\r\n            return keyCodes_1.KeyMod.Shift | keyCodes_1.KeyMod.Alt | key;\r\n        }\r\n        else {\r\n            return keyCodes_1.KeyMod.Alt | key;\r\n        }\r\n    }\r\n    function getWordNavigationKB(shift, key) {\r\n        // Normally word navigation is based on the ctrl modifier\r\n        if (shift) {\r\n            return keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | key;\r\n        }\r\n        else {\r\n            return keyCodes_1.KeyMod.CtrlCmd | key;\r\n        }\r\n    }\r\n    // https://support.apple.com/en-gb/HT201236\r\n    // [ADDED] Control-H\t\t\t\t\tDelete the character to the left of the insertion point. Or use Delete.\r\n    // [ADDED] Control-D\t\t\t\t\tDelete the character to the right of the insertion point. Or use Fn-Delete.\r\n    // [ADDED] Control-K\t\t\t\t\tDelete the text between the insertion point and the end of the line or paragraph.\r\n    // [ADDED] CommandUp Arrow\t\t\t\tMove the insertion point to the beginning of the document.\r\n    // [ADDED] CommandDown Arrow\t\t\tMove the insertion point to the end of the document.\r\n    // [ADDED] CommandLeft Arrow\t\t\tMove the insertion point to the beginning of the current line.\r\n    // [ADDED] CommandRight Arrow\t\t\tMove the insertion point to the end of the current line.\r\n    // [ADDED] OptionLeft Arrow\t\t\tMove the insertion point to the beginning of the previous word.\r\n    // [ADDED] OptionRight Arrow\t\t\tMove the insertion point to the end of the next word.\r\n    // [ADDED] CommandShiftUp Arrow\t\tSelect the text between the insertion point and the beginning of the document.\r\n    // [ADDED] CommandShiftDown Arrow\t\tSelect the text between the insertion point and the end of the document.\r\n    // [ADDED] CommandShiftLeft Arrow\t\tSelect the text between the insertion point and the beginning of the current line.\r\n    // [ADDED] CommandShiftRight Arrow\tSelect the text between the insertion point and the end of the current line.\r\n    // [USED BY DUPLICATE LINES] ShiftOptionUp Arrow\t\tExtend text selection to the beginning of the current paragraph, then to the beginning of the following paragraph if pressed again.\r\n    // [USED BY DUPLICATE LINES] ShiftOptionDown Arrow\tExtend text selection to the end of the current paragraph, then to the end of the following paragraph if pressed again.\r\n    // [ADDED] ShiftOptionLeft Arrow\t\tExtend text selection to the beginning of the current word, then to the beginning of the following word if pressed again.\r\n    // [ADDED] ShiftOptionRight Arrow\t\tExtend text selection to the end of the current word, then to the end of the following word if pressed again.\r\n    // [ADDED] Control-A\t\t\t\t\tMove to the beginning of the line or paragraph.\r\n    // [ADDED] Control-E\t\t\t\t\tMove to the end of a line or paragraph.\r\n    // [ADDED] Control-F\t\t\t\t\tMove one character forward.\r\n    // [ADDED] Control-B\t\t\t\t\tMove one character backward.\r\n    //Control-L\t\t\t\t\t\t\t\tCenter the cursor or selection in the visible area.\r\n    // [ADDED] Control-P\t\t\t\t\tMove up one line.\r\n    // [ADDED] Control-N\t\t\t\t\tMove down one line.\r\n    // [ADDED] Control-O\t\t\t\t\tInsert a new line after the insertion point.\r\n    //Control-T\t\t\t\t\t\t\t\tSwap the character behind the insertion point with the character in front of the insertion point.\r\n    // Unconfirmed????\r\n    //\tConfig.addKeyBinding(editorCommon.Handler.CursorPageDown,\t\tKeyMod.WinCtrl | KeyCode.KEY_V);\r\n    // OS X built in commands\r\n    // Control+y => yank\r\n    // [ADDED] Command+backspace => Delete to Hard BOL\r\n    // [ADDED] Command+delete => Delete to Hard EOL\r\n    // [ADDED] Control+k => Delete to Hard EOL\r\n    // Control+l => show_at_center\r\n    // Control+Command+d => noop\r\n    // Control+Command+shift+d => noop\r\n    registerCoreCommand(H.CursorLeft, {\r\n        primary: keyCodes_1.KeyCode.LeftArrow,\r\n        mac: { primary: keyCodes_1.KeyCode.LeftArrow, secondary: [keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_B] }\r\n    });\r\n    registerCoreCommand(H.CursorLeftSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.LeftArrow\r\n    });\r\n    registerCoreCommand(H.CursorRight, {\r\n        primary: keyCodes_1.KeyCode.RightArrow,\r\n        mac: { primary: keyCodes_1.KeyCode.RightArrow, secondary: [keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_F] }\r\n    });\r\n    registerCoreCommand(H.CursorRightSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.RightArrow\r\n    });\r\n    registerCoreCommand(H.CursorUp, {\r\n        primary: keyCodes_1.KeyCode.UpArrow,\r\n        mac: { primary: keyCodes_1.KeyCode.UpArrow, secondary: [keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_P] }\r\n    });\r\n    registerCoreCommand(H.CursorUpSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.UpArrow,\r\n        secondary: [getWordNavigationKB(true, keyCodes_1.KeyCode.UpArrow)],\r\n        mac: { primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.UpArrow },\r\n        linux: { primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.UpArrow }\r\n    });\r\n    registerCoreCommand(H.CursorDown, {\r\n        primary: keyCodes_1.KeyCode.DownArrow,\r\n        mac: { primary: keyCodes_1.KeyCode.DownArrow, secondary: [keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_N] }\r\n    });\r\n    registerCoreCommand(H.CursorDownSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.DownArrow,\r\n        secondary: [getWordNavigationKB(true, keyCodes_1.KeyCode.DownArrow)],\r\n        mac: { primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.DownArrow },\r\n        linux: { primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.DownArrow }\r\n    });\r\n    registerCoreCommand(H.CursorPageUp, {\r\n        primary: keyCodes_1.KeyCode.PageUp\r\n    });\r\n    registerCoreCommand(H.CursorPageUpSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.PageUp\r\n    });\r\n    registerCoreCommand(H.CursorPageDown, {\r\n        primary: keyCodes_1.KeyCode.PageDown\r\n    });\r\n    registerCoreCommand(H.CursorPageDownSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.PageDown\r\n    });\r\n    registerCoreCommand(H.CursorHome, {\r\n        primary: keyCodes_1.KeyCode.Home,\r\n        mac: { primary: keyCodes_1.KeyCode.Home, secondary: [keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.LeftArrow, keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_A] }\r\n    });\r\n    registerCoreCommand(H.CursorHomeSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Home,\r\n        mac: { primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Home, secondary: [keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.LeftArrow] }\r\n    });\r\n    registerCoreCommand(H.CursorEnd, {\r\n        primary: keyCodes_1.KeyCode.End,\r\n        mac: { primary: keyCodes_1.KeyCode.End, secondary: [keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.RightArrow, keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_E] }\r\n    });\r\n    registerCoreCommand(H.CursorEndSelect, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.End,\r\n        mac: { primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.End, secondary: [keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.RightArrow] }\r\n    });\r\n    registerCoreCommand(H.ExpandLineSelection, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.KEY_I\r\n    });\r\n    registerCoreCommand(H.ScrollLineUp, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.UpArrow,\r\n        mac: { primary: keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.PageUp }\r\n    });\r\n    registerCoreCommand(H.ScrollLineDown, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.DownArrow,\r\n        mac: { primary: keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.PageDown }\r\n    });\r\n    registerCoreCommand(H.ScrollPageUp, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.PageUp\r\n    });\r\n    registerCoreCommand(H.ScrollPageDown, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.PageDown\r\n    });\r\n    registerCoreCommand(H.CursorColumnSelectLeft, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyMod.Alt | keyCodes_1.KeyCode.LeftArrow,\r\n        linux: { primary: 0 }\r\n    });\r\n    registerCoreCommand(H.CursorColumnSelectRight, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyMod.Alt | keyCodes_1.KeyCode.RightArrow,\r\n        linux: { primary: 0 }\r\n    });\r\n    registerCoreCommand(H.CursorColumnSelectUp, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyMod.Alt | keyCodes_1.KeyCode.UpArrow,\r\n        linux: { primary: 0 }\r\n    });\r\n    registerCoreCommand(H.CursorColumnSelectPageUp, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyMod.Alt | keyCodes_1.KeyCode.PageUp,\r\n        linux: { primary: 0 }\r\n    });\r\n    registerCoreCommand(H.CursorColumnSelectDown, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyMod.Alt | keyCodes_1.KeyCode.DownArrow,\r\n        linux: { primary: 0 }\r\n    });\r\n    registerCoreCommand(H.CursorColumnSelectPageDown, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyMod.Alt | keyCodes_1.KeyCode.PageDown,\r\n        linux: { primary: 0 }\r\n    });\r\n    registerCoreCommand(H.Tab, {\r\n        primary: keyCodes_1.KeyCode.Tab\r\n    }, keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(), keybindingService_1.KbExpr.and(keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS), keybindingService_1.KbExpr.not(editorCommon.KEYBINDING_CONTEXT_EDITOR_TAB_MOVES_FOCUS)));\r\n    registerCoreCommand(H.Outdent, {\r\n        primary: keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Tab\r\n    }, keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(), keybindingService_1.KbExpr.and(keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS), keybindingService_1.KbExpr.not(editorCommon.KEYBINDING_CONTEXT_EDITOR_TAB_MOVES_FOCUS)));\r\n    registerCoreCommand(H.DeleteLeft, {\r\n        primary: keyCodes_1.KeyCode.Backspace,\r\n        secondary: [keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Backspace],\r\n        mac: { primary: keyCodes_1.KeyCode.Backspace, secondary: [keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Backspace, keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_H, keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.Backspace] }\r\n    });\r\n    registerCoreCommand(H.DeleteRight, {\r\n        primary: keyCodes_1.KeyCode.Delete,\r\n        mac: { primary: keyCodes_1.KeyCode.Delete, secondary: [keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_D, keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.Delete] }\r\n    });\r\n    registerCoreCommand(H.DeleteAllLeft, {\r\n        primary: null,\r\n        mac: { primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.Backspace }\r\n    });\r\n    registerCoreCommand(H.DeleteAllRight, {\r\n        primary: null,\r\n        mac: { primary: keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_K, secondary: [keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.Delete] }\r\n    });\r\n    function registerWordCommand(handlerId, shift, key) {\r\n        registerCoreCommand(handlerId, {\r\n            primary: getWordNavigationKB(shift, key),\r\n            mac: { primary: getMacWordNavigationKB(shift, key) }\r\n        });\r\n    }\r\n    registerWordCommand(H.CursorWordStartLeft, false, keyCodes_1.KeyCode.LeftArrow);\r\n    registerCoreCommand(H.CursorWordEndLeft, { primary: 0 });\r\n    registerCoreCommand(H.CursorWordLeft, { primary: 0 });\r\n    registerWordCommand(H.CursorWordStartLeftSelect, true, keyCodes_1.KeyCode.LeftArrow);\r\n    registerCoreCommand(H.CursorWordEndLeftSelect, { primary: 0 });\r\n    registerCoreCommand(H.CursorWordLeftSelect, { primary: 0 });\r\n    registerWordCommand(H.CursorWordEndRight, false, keyCodes_1.KeyCode.RightArrow);\r\n    registerCoreCommand(H.CursorWordStartRight, { primary: 0 });\r\n    registerCoreCommand(H.CursorWordRight, { primary: 0 });\r\n    registerWordCommand(H.CursorWordEndRightSelect, true, keyCodes_1.KeyCode.RightArrow);\r\n    registerCoreCommand(H.CursorWordStartRightSelect, { primary: 0 });\r\n    registerCoreCommand(H.CursorWordRightSelect, { primary: 0 });\r\n    registerWordCommand(H.DeleteWordLeft, false, keyCodes_1.KeyCode.Backspace);\r\n    registerCoreCommand(H.DeleteWordStartLeft, { primary: 0 });\r\n    registerCoreCommand(H.DeleteWordEndLeft, { primary: 0 });\r\n    registerWordCommand(H.DeleteWordRight, false, keyCodes_1.KeyCode.Delete);\r\n    registerCoreCommand(H.DeleteWordStartRight, { primary: 0 });\r\n    registerCoreCommand(H.DeleteWordEndRight, { primary: 0 });\r\n    registerCoreCommand(H.CancelSelection, {\r\n        primary: keyCodes_1.KeyCode.Escape,\r\n        secondary: [keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Escape]\r\n    }, keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(), keybindingService_1.KbExpr.and(keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS), keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_HAS_NON_EMPTY_SELECTION)));\r\n    registerCoreCommand(H.RemoveSecondaryCursors, {\r\n        primary: keyCodes_1.KeyCode.Escape,\r\n        secondary: [keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Escape]\r\n    }, keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(1), keybindingService_1.KbExpr.and(keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS), keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_HAS_MULTIPLE_SELECTIONS)));\r\n    registerCoreCommand(H.CursorTop, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.Home,\r\n        mac: { primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.UpArrow }\r\n    });\r\n    registerCoreCommand(H.CursorTopSelect, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.Home,\r\n        mac: { primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.UpArrow }\r\n    });\r\n    registerCoreCommand(H.CursorBottom, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.End,\r\n        mac: { primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.DownArrow }\r\n    });\r\n    registerCoreCommand(H.CursorBottomSelect, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.End,\r\n        mac: { primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.DownArrow }\r\n    });\r\n    registerCoreCommand(H.LineBreakInsert, {\r\n        primary: null,\r\n        mac: { primary: keyCodes_1.KeyMod.WinCtrl | keyCodes_1.KeyCode.KEY_O }\r\n    });\r\n    registerCoreCommand(H.Undo, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.KEY_Z\r\n    });\r\n    registerCoreCommand(H.CursorUndo, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.KEY_U\r\n    });\r\n    registerCoreCommand(H.Redo, {\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.KEY_Y,\r\n        secondary: [keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.KEY_Z],\r\n        mac: { primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyMod.Shift | keyCodes_1.KeyCode.KEY_Z }\r\n    });\r\n    function selectAll(accessor, args) {\r\n        var HANDLER = editorCommon.Handler.SelectAll;\r\n        var focusedEditor = findFocusedEditor(HANDLER, accessor, false);\r\n        // Only if editor text focus (i.e. not if editor has widget focus).\r\n        if (focusedEditor && focusedEditor.isFocused()) {\r\n            focusedEditor.trigger('keyboard', HANDLER, args);\r\n            return;\r\n        }\r\n        // Ignore this action when user is focussed on an element that allows for entering text\r\n        var activeElement = document.activeElement;\r\n        if (activeElement && ['input', 'textarea'].indexOf(activeElement.tagName.toLowerCase()) >= 0) {\r\n            activeElement.select();\r\n            return;\r\n        }\r\n        // Redirecting to last active editor\r\n        var activeEditor = getActiveEditor(accessor);\r\n        if (activeEditor) {\r\n            activeEditor.trigger('keyboard', HANDLER, args);\r\n            return;\r\n        }\r\n    }\r\n    keybindingsRegistry_1.KeybindingsRegistry.registerCommandDesc({\r\n        id: 'editor.action.selectAll',\r\n        handler: selectAll,\r\n        weight: keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorCore(),\r\n        when: null,\r\n        primary: keyCodes_1.KeyMod.CtrlCmd | keyCodes_1.KeyCode.KEY_A\r\n    });\r\n});\r\n\ndefine(\"vs/editor/common/editorCommonExtensions\", [\"require\", \"exports\", 'vs/base/common/errors', 'vs/base/common/uri', 'vs/platform/instantiation/common/descriptors', 'vs/platform/keybinding/common/keybindingService', 'vs/platform/keybinding/common/keybindingsRegistry', 'vs/platform/platform', 'vs/platform/telemetry/common/telemetry', 'vs/editor/common/config/config', 'vs/editor/common/core/position', 'vs/editor/common/editorCommon', 'vs/editor/common/services/modelService'], function (require, exports, errors_1, uri_1, descriptors_1, keybindingService_1, keybindingsRegistry_1, platform_1, telemetry_1, config_1, position_1, editorCommon, modelService_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    // --- Keybinding extensions to make it more concise to express keybindings conditions\r\n    (function (ContextKey) {\r\n        ContextKey[ContextKey[\"None\"] = 0] = \"None\";\r\n        ContextKey[ContextKey[\"EditorTextFocus\"] = 1] = \"EditorTextFocus\";\r\n        ContextKey[ContextKey[\"EditorFocus\"] = 2] = \"EditorFocus\";\r\n    })(exports.ContextKey || (exports.ContextKey = {}));\r\n    var ContextKey = exports.ContextKey;\r\n    // --- Editor Actions\r\n    var EditorActionDescriptor = (function () {\r\n        function EditorActionDescriptor(ctor, id, label, kbOpts, alias) {\r\n            if (kbOpts === void 0) { kbOpts = defaultEditorActionKeybindingOptions; }\r\n            this.ctor = ctor;\r\n            this.id = id;\r\n            this.label = label;\r\n            this.alias = alias;\r\n            this.kbOpts = kbOpts;\r\n        }\r\n        return EditorActionDescriptor;\r\n    }());\r\n    exports.EditorActionDescriptor = EditorActionDescriptor;\r\n    var CommonEditorRegistry;\r\n    (function (CommonEditorRegistry) {\r\n        function registerEditorAction(desc) {\r\n            platform_1.Registry.as(Extensions.EditorCommonContributions).registerEditorAction(desc);\r\n        }\r\n        CommonEditorRegistry.registerEditorAction = registerEditorAction;\r\n        // --- Editor Contributions\r\n        function registerEditorContribution(ctor) {\r\n            platform_1.Registry.as(Extensions.EditorCommonContributions).registerEditorContribution2(ctor);\r\n        }\r\n        CommonEditorRegistry.registerEditorContribution = registerEditorContribution;\r\n        function getEditorContributions() {\r\n            return platform_1.Registry.as(Extensions.EditorCommonContributions).getEditorContributions2();\r\n        }\r\n        CommonEditorRegistry.getEditorContributions = getEditorContributions;\r\n        // --- Editor Commands\r\n        function commandWeight(importance) {\r\n            if (importance === void 0) { importance = 0; }\r\n            return keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorContrib(importance);\r\n        }\r\n        CommonEditorRegistry.commandWeight = commandWeight;\r\n        function registerEditorCommand(commandId, weight, keybinding, needsTextFocus, needsKey, handler) {\r\n            var commandDesc = {\r\n                id: commandId,\r\n                handler: createCommandHandler(commandId, handler),\r\n                weight: weight,\r\n                when: whenRule(needsTextFocus, needsKey),\r\n                primary: keybinding.primary,\r\n                secondary: keybinding.secondary,\r\n                win: keybinding.win,\r\n                linux: keybinding.linux,\r\n                mac: keybinding.mac,\r\n            };\r\n            keybindingsRegistry_1.KeybindingsRegistry.registerCommandDesc(commandDesc);\r\n        }\r\n        CommonEditorRegistry.registerEditorCommand = registerEditorCommand;\r\n        function registerLanguageCommand(id, handler) {\r\n            keybindingsRegistry_1.KeybindingsRegistry.registerCommandDesc({\r\n                id: id,\r\n                handler: function (accessor, args) {\r\n                    return handler(accessor, args || {});\r\n                },\r\n                weight: keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorContrib(),\r\n                primary: undefined,\r\n                when: undefined,\r\n            });\r\n        }\r\n        CommonEditorRegistry.registerLanguageCommand = registerLanguageCommand;\r\n        function registerDefaultLanguageCommand(id, handler) {\r\n            registerLanguageCommand(id, function (accessor, args) {\r\n                var resource = args.resource, position = args.position;\r\n                if (!(resource instanceof uri_1.default) || !position_1.Position.isIPosition(position)) {\r\n                    throw errors_1.illegalArgument();\r\n                }\r\n                var model = accessor.get(modelService_1.IModelService).getModel(resource);\r\n                if (!model) {\r\n                    throw errors_1.illegalArgument();\r\n                }\r\n                var editorPosition = position_1.Position.lift(position);\r\n                return handler(model, editorPosition, args);\r\n            });\r\n        }\r\n        CommonEditorRegistry.registerDefaultLanguageCommand = registerDefaultLanguageCommand;\r\n    })(CommonEditorRegistry = exports.CommonEditorRegistry || (exports.CommonEditorRegistry = {}));\r\n    var SimpleEditorContributionDescriptor = (function () {\r\n        function SimpleEditorContributionDescriptor(ctor) {\r\n            this._ctor = ctor;\r\n        }\r\n        SimpleEditorContributionDescriptor.prototype.createInstance = function (instantiationService, editor) {\r\n            return instantiationService.createInstance(this._ctor, editor);\r\n        };\r\n        return SimpleEditorContributionDescriptor;\r\n    }());\r\n    var InternalEditorActionDescriptor = (function () {\r\n        function InternalEditorActionDescriptor(ctor, id, label, alias) {\r\n            this._descriptor = descriptors_1.createSyncDescriptor(ctor, {\r\n                id: id,\r\n                label: label,\r\n                alias: alias\r\n            });\r\n        }\r\n        InternalEditorActionDescriptor.prototype.createInstance = function (instService, editor) {\r\n            return instService.createInstance(this._descriptor, editor);\r\n        };\r\n        return InternalEditorActionDescriptor;\r\n    }());\r\n    // Editor extension points\r\n    var Extensions = {\r\n        EditorCommonContributions: 'editor.commonContributions'\r\n    };\r\n    var EditorContributionRegistry = (function () {\r\n        function EditorContributionRegistry() {\r\n            this.editorContributions = [];\r\n        }\r\n        EditorContributionRegistry.prototype.registerEditorContribution2 = function (ctor) {\r\n            this.editorContributions.push(new SimpleEditorContributionDescriptor(ctor));\r\n        };\r\n        EditorContributionRegistry.prototype.registerEditorAction = function (desc) {\r\n            var handler = desc.kbOpts.handler;\r\n            if (!handler) {\r\n                // here\r\n                if (desc.kbOpts.context === ContextKey.EditorTextFocus || desc.kbOpts.context === ContextKey.EditorFocus) {\r\n                    handler = triggerEditorAction.bind(null, desc.id);\r\n                }\r\n                else {\r\n                    handler = triggerEditorActionGlobal.bind(null, desc.id);\r\n                }\r\n            }\r\n            var when = null;\r\n            if (typeof desc.kbOpts.kbExpr === 'undefined') {\r\n                // here\r\n                if (desc.kbOpts.context === ContextKey.EditorTextFocus) {\r\n                    when = keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS);\r\n                }\r\n                else if (desc.kbOpts.context === ContextKey.EditorFocus) {\r\n                    when = keybindingService_1.KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_FOCUS);\r\n                }\r\n            }\r\n            else {\r\n                when = desc.kbOpts.kbExpr;\r\n            }\r\n            var commandDesc = {\r\n                id: desc.id,\r\n                handler: handler,\r\n                weight: keybindingsRegistry_1.KeybindingsRegistry.WEIGHT.editorContrib(),\r\n                when: when,\r\n                primary: desc.kbOpts.primary,\r\n                secondary: desc.kbOpts.secondary,\r\n                win: desc.kbOpts.win,\r\n                linux: desc.kbOpts.linux,\r\n                mac: desc.kbOpts.mac,\r\n            };\r\n            keybindingsRegistry_1.KeybindingsRegistry.registerCommandDesc(commandDesc);\r\n            this.editorContributions.push(new InternalEditorActionDescriptor(desc.ctor, desc.id, desc.label, desc.alias));\r\n        };\r\n        EditorContributionRegistry.prototype.getEditorContributions2 = function () {\r\n            return this.editorContributions.slice(0);\r\n        };\r\n        return EditorContributionRegistry;\r\n    }());\r\n    platform_1.Registry.add(Extensions.EditorCommonContributions, new EditorContributionRegistry());\r\n    function triggerEditorAction(actionId, accessor, args) {\r\n        config_1.withCodeEditorFromCommandHandler(actionId, accessor, function (editor) {\r\n            editor.trigger('keyboard', actionId, args);\r\n        });\r\n    }\r\n    function triggerEditorActionGlobal(actionId, accessor, args) {\r\n        // TODO: this is not necessarily keyboard\r\n        var focusedEditor = config_1.findFocusedEditor(actionId, accessor, false);\r\n        if (focusedEditor) {\r\n            focusedEditor.trigger('keyboard', actionId, args);\r\n            return;\r\n        }\r\n        var activeEditor = config_1.getActiveEditor(accessor);\r\n        if (activeEditor) {\r\n            var action = activeEditor.getAction(actionId);\r\n            if (action) {\r\n                accessor.get(telemetry_1.ITelemetryService).publicLog('editorActionInvoked', { name: action.label });\r\n                action.run().done(null, errors_1.onUnexpectedError);\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    var defaultEditorActionKeybindingOptions = { primary: null, context: ContextKey.EditorTextFocus };\r\n    function whenRule(needsTextFocus, needsKey) {\r\n        var base = keybindingService_1.KbExpr.has(needsTextFocus ? editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS : editorCommon.KEYBINDING_CONTEXT_EDITOR_FOCUS);\r\n        if (needsKey) {\r\n            return keybindingService_1.KbExpr.and(base, keybindingService_1.KbExpr.has(needsKey));\r\n        }\r\n        return base;\r\n    }\r\n    function createCommandHandler(commandId, handler) {\r\n        return function (accessor, args) {\r\n            config_1.withCodeEditorFromCommandHandler(commandId, accessor, function (editor) {\r\n                handler(accessor, editor, args || {});\r\n            });\r\n        };\r\n    }\r\n});\r\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\ndefine(\"vs/editor/contrib/hover/common/hover\", [\"require\", \"exports\", 'vs/base/common/arrays', 'vs/base/common/errors', 'vs/base/common/winjs.base', 'vs/editor/common/editorCommonExtensions', 'vs/editor/common/modes', 'vs/base/common/async'], function (require, exports, arrays_1, errors_1, winjs_base_1, editorCommonExtensions_1, modes_1, async_1) {\r\n    'use strict';\r\n    function getHover(model, position) {\r\n        var supports = modes_1.HoverProviderRegistry.ordered(model);\r\n        var values = [];\r\n        var promises = supports.map(function (support, idx) {\r\n            return async_1.asWinJsPromise(function (token) {\r\n                return support.provideHover(model, position, token);\r\n            }).then(function (result) {\r\n                if (result) {\r\n                    var hasRange = (typeof result.range !== 'undefined');\r\n                    var hasHtmlContent = (typeof result.htmlContent !== 'undefined' && result.htmlContent && result.htmlContent.length > 0);\r\n                    if (hasRange && hasHtmlContent) {\r\n                        values[idx] = result;\r\n                    }\r\n                }\r\n            }, function (err) {\r\n                errors_1.onUnexpectedError(err);\r\n            });\r\n        });\r\n        return winjs_base_1.TPromise.join(promises).then(function () { return arrays_1.coalesce(values); });\r\n    }\r\n    exports.getHover = getHover;\r\n    editorCommonExtensions_1.CommonEditorRegistry.registerDefaultLanguageCommand('_executeHoverProvider', getHover);\r\n});\r\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\ndefine(\"vs/editor/contrib/referenceSearch/common/referenceSearch\", [\"require\", \"exports\", 'vs/base/common/errors', 'vs/base/common/winjs.base', 'vs/editor/common/editorCommonExtensions', 'vs/editor/common/modes', 'vs/base/common/async'], function (require, exports, errors_1, winjs_base_1, editorCommonExtensions_1, modes_1, async_1) {\r\n    'use strict';\r\n    function provideReferences(model, position) {\r\n        // collect references from all providers\r\n        var promises = modes_1.ReferenceProviderRegistry.ordered(model).map(function (provider) {\r\n            return async_1.asWinJsPromise(function (token) {\r\n                return provider.provideReferences(model, position, { includeDeclaration: true }, token);\r\n            }).then(function (result) {\r\n                if (Array.isArray(result)) {\r\n                    return result;\r\n                }\r\n            }, function (err) {\r\n                errors_1.onUnexpectedError(err);\r\n            });\r\n        });\r\n        return winjs_base_1.TPromise.join(promises).then(function (references) {\r\n            var result = [];\r\n            for (var _i = 0, references_1 = references; _i < references_1.length; _i++) {\r\n                var ref = references_1[_i];\r\n                if (ref) {\r\n                    result.push.apply(result, ref);\r\n                }\r\n            }\r\n            return result;\r\n        });\r\n    }\r\n    exports.provideReferences = provideReferences;\r\n    editorCommonExtensions_1.CommonEditorRegistry.registerDefaultLanguageCommand('_executeReferenceProvider', provideReferences);\r\n});\r\n\ndefine(\"vs/editor/contrib/suggest/common/suggest\", [\"require\", \"exports\", 'vs/base/common/async', 'vs/base/common/arrays', 'vs/base/common/errors', 'vs/base/common/winjs.base', 'vs/editor/common/editorCommonExtensions', 'vs/editor/common/modes', 'vs/editor/common/modes/supports'], function (require, exports, async_1, arrays_1, errors_1, winjs_base_1, editorCommonExtensions_1, modes_1, supports_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    exports.Context = {\r\n        Visible: 'suggestWidgetVisible',\r\n        MultipleSuggestions: 'suggestWidgetMultipleSuggestions',\r\n        AcceptOnKey: 'suggestionSupportsAcceptOnKey'\r\n    };\r\n    function provideCompletionItems(model, position, groups) {\r\n        if (!groups) {\r\n            groups = modes_1.SuggestRegistry.orderedGroups(model);\r\n        }\r\n        var result = [];\r\n        var factory = groups.map(function (supports, index) {\r\n            return function () {\r\n                // stop as soon as a group produced a result\r\n                if (result.length > 0) {\r\n                    return;\r\n                }\r\n                // for each support in the group ask for suggestions\r\n                return winjs_base_1.TPromise.join(supports.map(function (support) {\r\n                    return async_1.asWinJsPromise(function (token) {\r\n                        return support.provideCompletionItems(model, position, token);\r\n                    }).then(function (values) {\r\n                        if (!values) {\r\n                            return;\r\n                        }\r\n                        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {\r\n                            var suggestResult = values_1[_i];\r\n                            if (!suggestResult || arrays_1.isFalsyOrEmpty(suggestResult.suggestions)) {\r\n                                continue;\r\n                            }\r\n                            result.push({\r\n                                support: support,\r\n                                currentWord: suggestResult.currentWord,\r\n                                incomplete: suggestResult.incomplete,\r\n                                suggestions: suggestResult.suggestions\r\n                            });\r\n                        }\r\n                    }, errors_1.onUnexpectedError);\r\n                }));\r\n            };\r\n        });\r\n        return async_1.sequence(factory).then(function () {\r\n            // add snippets to the first group\r\n            var snippets = supports_1.SnippetsRegistry.getSnippets(model, position);\r\n            result.push(snippets);\r\n            return result;\r\n        });\r\n    }\r\n    exports.provideCompletionItems = provideCompletionItems;\r\n    editorCommonExtensions_1.CommonEditorRegistry.registerDefaultLanguageCommand('_executeCompletionItemProvider', function (model, position, args) {\r\n        return provideCompletionItems(model, position);\r\n    });\r\n});\r\n\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n};\r\ndefine(\"vs/languages/html/common/htmlWorker\", [\"require\", \"exports\", 'vs/base/common/uri', 'vs/base/common/winjs.base', 'vs/languages/lib/common/beautify-html', 'vs/languages/html/common/htmlTags', 'vs/base/common/network', 'vs/editor/common/modes', 'vs/base/common/strings', 'vs/editor/common/core/position', 'vs/platform/workspace/common/workspace', 'vs/platform/markers/common/markers', 'vs/editor/common/services/resourceService', 'vs/languages/html/common/htmlScanner', 'vs/languages/html/common/htmlTokenTypes', 'vs/languages/html/common/htmlEmptyTagsShared', 'vs/editor/common/modes/supports/suggestSupport', 'vs/base/common/paths', 'vs/editor/contrib/hover/common/hover', 'vs/editor/contrib/referenceSearch/common/referenceSearch', 'vs/editor/contrib/suggest/common/suggest'], function (require, exports, uri_1, winjs, beautifyHTML, htmlTags, network, modes, strings, position_1, workspace_1, markers_1, resourceService_1, htmlScanner_1, htmlTokenTypes_1, htmlEmptyTagsShared_1, suggestSupport_1, paths, hover_1, referenceSearch_1, suggest_1) {\r\n    /*---------------------------------------------------------------------------------------------\r\n     *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n     *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n     *--------------------------------------------------------------------------------------------*/\r\n    'use strict';\r\n    var LinkDetectionState;\r\n    (function (LinkDetectionState) {\r\n        LinkDetectionState[LinkDetectionState[\"LOOKING_FOR_HREF_OR_SRC\"] = 1] = \"LOOKING_FOR_HREF_OR_SRC\";\r\n        LinkDetectionState[LinkDetectionState[\"AFTER_HREF_OR_SRC\"] = 2] = \"AFTER_HREF_OR_SRC\";\r\n    })(LinkDetectionState || (LinkDetectionState = {}));\r\n    var HTMLWorker = (function () {\r\n        function HTMLWorker(modeId, resourceService, markerService, contextService) {\r\n            this._modeId = modeId;\r\n            this.resourceService = resourceService;\r\n            this.markerService = markerService;\r\n            this._contextService = contextService;\r\n            this._tagProviders = [];\r\n            this._tagProviders.push(htmlTags.getHTML5TagProvider());\r\n            this.addCustomTagProviders(this._tagProviders);\r\n        }\r\n        HTMLWorker.prototype.addCustomTagProviders = function (providers) {\r\n            providers.push(htmlTags.getAngularTagProvider());\r\n            providers.push(htmlTags.getIonicTagProvider());\r\n        };\r\n        HTMLWorker.prototype.provideDocumentRangeFormattingEdits = function (resource, range, options) {\r\n            return this.formatHTML(resource, range, options);\r\n        };\r\n        HTMLWorker.prototype.formatHTML = function (resource, range, options) {\r\n            var model = this.resourceService.get(resource);\r\n            var value = range ? model.getValueInRange(range) : model.getValue();\r\n            var htmlOptions = {\r\n                indent_size: options.insertSpaces ? options.tabSize : 1,\r\n                indent_char: options.insertSpaces ? ' ' : '\\t',\r\n                wrap_line_length: this.getFormatOption('wrapLineLength', 120),\r\n                unformatted: this.getTagsFormatOption('unformatted', void 0),\r\n                indent_inner_html: this.getFormatOption('indentInnerHtml', false),\r\n                preserve_newlines: this.getFormatOption('preserveNewLines', false),\r\n                max_preserve_newlines: this.getFormatOption('maxPreserveNewLines', void 0),\r\n                indent_handlebars: this.getFormatOption('indentHandlebars', false),\r\n                end_with_newline: this.getFormatOption('endWithNewline', false),\r\n                extra_liners: this.getTagsFormatOption('extraLiners', void 0),\r\n            };\r\n            var result = beautifyHTML.html_beautify(value, htmlOptions);\r\n            return winjs.TPromise.as([{\r\n                    range: range,\r\n                    text: result\r\n                }]);\r\n        };\r\n        HTMLWorker.prototype.getFormatOption = function (key, dflt) {\r\n            if (this.formatSettings && this.formatSettings.hasOwnProperty(key)) {\r\n                var value = this.formatSettings[key];\r\n                if (value !== null) {\r\n                    return value;\r\n                }\r\n            }\r\n            return dflt;\r\n        };\r\n        HTMLWorker.prototype.getTagsFormatOption = function (key, dflt) {\r\n            var list = this.getFormatOption(key, null);\r\n            if (typeof list === 'string') {\r\n                if (list.length > 0) {\r\n                    return list.split(',').map(function (t) { return t.trim().toLowerCase(); });\r\n                }\r\n                return [];\r\n            }\r\n            return dflt;\r\n        };\r\n        HTMLWorker.prototype._doConfigure = function (options) {\r\n            this.formatSettings = options && options.format;\r\n            return winjs.TPromise.as(null);\r\n        };\r\n        HTMLWorker.prototype._delegateToModeAtPosition = function (resource, position, callback) {\r\n            var model = this.resourceService.get(resource);\r\n            if (!model) {\r\n                return null;\r\n            }\r\n            var modelAtPosition = model.getEmbeddedAtPosition(position);\r\n            if (!modelAtPosition) {\r\n                return callback(false, model);\r\n            }\r\n            var modeAtPosition = modelAtPosition.getMode();\r\n            return callback(modeAtPosition.getId() !== this._modeId, modelAtPosition);\r\n        };\r\n        HTMLWorker.prototype._delegateToAllModes = function (resource, callback) {\r\n            var model = this.resourceService.get(resource);\r\n            if (!model) {\r\n                return null;\r\n            }\r\n            return callback(model.getAllEmbedded());\r\n        };\r\n        HTMLWorker.prototype.provideHover = function (resource, position) {\r\n            return this._delegateToModeAtPosition(resource, position, function (isEmbeddedMode, model) {\r\n                if (isEmbeddedMode) {\r\n                    return hover_1.getHover(model, position_1.Position.lift(position)).then(function (r) {\r\n                        return (r.length > 0 ? r[0] : null);\r\n                    });\r\n                }\r\n            });\r\n        };\r\n        HTMLWorker.prototype.provideReferences = function (resource, position) {\r\n            return this._delegateToModeAtPosition(resource, position, function (isEmbeddedMode, model) {\r\n                if (isEmbeddedMode) {\r\n                    return referenceSearch_1.provideReferences(model, position_1.Position.lift(position));\r\n                }\r\n            });\r\n        };\r\n        HTMLWorker.prototype.findColorDeclarations = function (resource) {\r\n            return this._delegateToAllModes(resource, function (models) {\r\n                var allPromises = [];\r\n                allPromises = models\r\n                    .filter(function (model) { return (typeof model.getMode()['findColorDeclarations'] === 'function'); })\r\n                    .map(function (model) { return model.getMode()['findColorDeclarations'](model.uri); });\r\n                return winjs.TPromise.join(allPromises).then(function (results) {\r\n                    var result = [];\r\n                    results.forEach(function (oneResult) { return result = result.concat(oneResult); });\r\n                    return result;\r\n                });\r\n            });\r\n        };\r\n        HTMLWorker.prototype.findMatchingOpenTag = function (scanner) {\r\n            var closedTags = {};\r\n            var tagClosed = false;\r\n            while (scanner.scanBack()) {\r\n                if (htmlTokenTypes_1.isTag(scanner.getTokenType()) && !tagClosed) {\r\n                    var tag = scanner.getTokenContent();\r\n                    scanner.scanBack();\r\n                    if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_END) {\r\n                        closedTags[tag] = (closedTags[tag] || 0) + 1;\r\n                    }\r\n                    else if (!htmlEmptyTagsShared_1.isEmptyElement(tag)) {\r\n                        if (closedTags[tag]) {\r\n                            closedTags[tag]--;\r\n                        }\r\n                        else {\r\n                            return tag;\r\n                        }\r\n                    }\r\n                }\r\n                else if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_START) {\r\n                    tagClosed = scanner.getTokenContent() === '/>';\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        HTMLWorker.prototype.collectTagSuggestions = function (scanner, position, suggestions) {\r\n            var _this = this;\r\n            var model = scanner.getModel();\r\n            var currentLine = model.getLineContent(position.lineNumber);\r\n            var contentAfter = currentLine.substr(position.column - 1);\r\n            var closeTag = isWhiteSpace(contentAfter) || strings.startsWith(contentAfter, '<') ? '>' : '';\r\n            var collectClosingTagSuggestion = function (overwriteBefore) {\r\n                var endPosition = scanner.getTokenPosition();\r\n                var matchingTag = _this.findMatchingOpenTag(scanner);\r\n                if (matchingTag) {\r\n                    var suggestion = {\r\n                        label: '/' + matchingTag,\r\n                        codeSnippet: '/' + matchingTag + closeTag,\r\n                        overwriteBefore: overwriteBefore,\r\n                        type: 'property'\r\n                    };\r\n                    suggestions.suggestions.push(suggestion);\r\n                    // use indent from start tag\r\n                    var startPosition = scanner.getTokenPosition();\r\n                    if (endPosition.lineNumber !== startPosition.lineNumber) {\r\n                        var startIndent = model.getLineContent(startPosition.lineNumber).substring(0, startPosition.column - 1);\r\n                        var endIndent = model.getLineContent(endPosition.lineNumber).substring(0, endPosition.column - 1);\r\n                        if (isWhiteSpace(startIndent) && isWhiteSpace(endIndent)) {\r\n                            suggestion.overwriteBefore = position.column - 1; // replace from start of line\r\n                            suggestion.codeSnippet = startIndent + '</' + matchingTag + closeTag;\r\n                            suggestion.filterText = currentLine.substring(0, position.column - 1);\r\n                        }\r\n                    }\r\n                    return true;\r\n                }\r\n                return false;\r\n            };\r\n            if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_END) {\r\n                var hasClose = collectClosingTagSuggestion(suggestions.currentWord.length + 1);\r\n                if (!hasClose) {\r\n                    this._tagProviders.forEach(function (provider) {\r\n                        provider.collectTags(function (tag, label) {\r\n                            suggestions.suggestions.push({\r\n                                label: '/' + tag,\r\n                                overwriteBefore: suggestions.currentWord.length + 1,\r\n                                codeSnippet: '/' + tag + closeTag,\r\n                                type: 'property',\r\n                                documentationLabel: label\r\n                            });\r\n                        });\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                collectClosingTagSuggestion(suggestions.currentWord.length);\r\n                this._tagProviders.forEach(function (provider) {\r\n                    provider.collectTags(function (tag, label) {\r\n                        suggestions.suggestions.push({\r\n                            label: tag,\r\n                            codeSnippet: tag,\r\n                            type: 'property',\r\n                            documentationLabel: label\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n        };\r\n        HTMLWorker.prototype.collectContentSuggestions = function (suggestions) {\r\n            // disable the simple snippets in favor of the emmet templates\r\n        };\r\n        HTMLWorker.prototype.collectAttributeSuggestions = function (scanner, suggestions) {\r\n            var parentTag = null;\r\n            do {\r\n                if (htmlTokenTypes_1.isTag(scanner.getTokenType())) {\r\n                    parentTag = scanner.getTokenContent();\r\n                    break;\r\n                }\r\n                if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_START) {\r\n                    break;\r\n                }\r\n            } while (scanner.scanBack());\r\n            this._tagProviders.forEach(function (provider) {\r\n                provider.collectAttributes(parentTag, function (attribute, type) {\r\n                    var codeSnippet = attribute;\r\n                    if (type !== 'v') {\r\n                        codeSnippet = codeSnippet + '=\"{{}}\"';\r\n                    }\r\n                    suggestions.suggestions.push({\r\n                        label: attribute,\r\n                        codeSnippet: codeSnippet,\r\n                        type: type === 'handler' ? 'function' : 'value'\r\n                    });\r\n                });\r\n            });\r\n        };\r\n        HTMLWorker.prototype.collectAttributeValueSuggestions = function (scanner, suggestions) {\r\n            var needsQuotes = scanner.getTokenType() === htmlTokenTypes_1.DELIM_ASSIGN;\r\n            var attribute = null;\r\n            var parentTag = null;\r\n            while (scanner.scanBack()) {\r\n                if (scanner.getTokenType() === htmlTokenTypes_1.ATTRIB_NAME) {\r\n                    attribute = scanner.getTokenContent();\r\n                    break;\r\n                }\r\n            }\r\n            while (scanner.scanBack()) {\r\n                if (htmlTokenTypes_1.isTag(scanner.getTokenType())) {\r\n                    parentTag = scanner.getTokenContent();\r\n                    break;\r\n                }\r\n                if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_START) {\r\n                    return;\r\n                }\r\n            }\r\n            this._tagProviders.forEach(function (provider) {\r\n                provider.collectValues(parentTag, attribute, function (value) {\r\n                    suggestions.suggestions.push({\r\n                        label: value,\r\n                        codeSnippet: needsQuotes ? '\"' + value + '\"' : value,\r\n                        type: 'unit'\r\n                    });\r\n                });\r\n            });\r\n        };\r\n        HTMLWorker.prototype.provideCompletionItems = function (resource, position) {\r\n            var _this = this;\r\n            return this._delegateToModeAtPosition(resource, position, function (isEmbeddedMode, model) {\r\n                if (isEmbeddedMode) {\r\n                    return suggest_1.provideCompletionItems(model, position_1.Position.lift(position));\r\n                }\r\n                return _this.suggestHTML(resource, position);\r\n            });\r\n        };\r\n        HTMLWorker.prototype.suggestHTML = function (resource, position) {\r\n            return this.doSuggest(resource, position).then(function (value) { return suggestSupport_1.filterSuggestions(value); });\r\n        };\r\n        HTMLWorker.prototype.doSuggest = function (resource, position) {\r\n            var model = this.resourceService.get(resource), currentWord = model.getWordUntilPosition(position).word;\r\n            var suggestions = {\r\n                currentWord: currentWord,\r\n                suggestions: [],\r\n            };\r\n            var scanner = htmlScanner_1.getScanner(model, position);\r\n            switch (scanner.getTokenType()) {\r\n                case htmlTokenTypes_1.DELIM_START:\r\n                case htmlTokenTypes_1.DELIM_END:\r\n                    if (scanner.isOpenBrace()) {\r\n                        this.collectTagSuggestions(scanner, position, suggestions);\r\n                    }\r\n                    else {\r\n                        this.collectContentSuggestions(suggestions);\r\n                    }\r\n                    break;\r\n                case htmlTokenTypes_1.ATTRIB_NAME:\r\n                    this.collectAttributeSuggestions(scanner, suggestions);\r\n                    break;\r\n                case htmlTokenTypes_1.ATTRIB_VALUE:\r\n                    this.collectAttributeValueSuggestions(scanner, suggestions);\r\n                    break;\r\n                case htmlTokenTypes_1.DELIM_ASSIGN:\r\n                    if (scanner.isAtTokenEnd()) {\r\n                        this.collectAttributeValueSuggestions(scanner, suggestions);\r\n                    }\r\n                    break;\r\n                case '':\r\n                    if (isWhiteSpace(scanner.getTokenContent()) && scanner.scanBack()) {\r\n                        switch (scanner.getTokenType()) {\r\n                            case htmlTokenTypes_1.ATTRIB_VALUE:\r\n                            case htmlTokenTypes_1.ATTRIB_NAME:\r\n                                this.collectAttributeSuggestions(scanner, suggestions);\r\n                                break;\r\n                            case htmlTokenTypes_1.DELIM_ASSIGN:\r\n                                this.collectAttributeValueSuggestions(scanner, suggestions);\r\n                                break;\r\n                            case htmlTokenTypes_1.DELIM_START:\r\n                            case htmlTokenTypes_1.DELIM_END:\r\n                                if (scanner.isOpenBrace()) {\r\n                                    this.collectTagSuggestions(scanner, position, suggestions);\r\n                                }\r\n                                else {\r\n                                    this.collectContentSuggestions(suggestions);\r\n                                }\r\n                                break;\r\n                            default:\r\n                                if (htmlTokenTypes_1.isTag(scanner.getTokenType())) {\r\n                                    this.collectAttributeSuggestions(scanner, suggestions);\r\n                                }\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.collectContentSuggestions(suggestions);\r\n                    }\r\n                    break;\r\n                default:\r\n                    if (htmlTokenTypes_1.isTag(scanner.getTokenType())) {\r\n                        scanner.scanBack(); // one back to the end/start bracket\r\n                        this.collectTagSuggestions(scanner, position, suggestions);\r\n                    }\r\n            }\r\n            return winjs.TPromise.as(suggestions);\r\n        };\r\n        HTMLWorker.prototype.findMatchingBracket = function (tagname, scanner) {\r\n            if (htmlEmptyTagsShared_1.isEmptyElement(tagname)) {\r\n                return null;\r\n            }\r\n            var tagCount = 0;\r\n            scanner.scanBack(); // one back to the end/start bracket\r\n            if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_END) {\r\n                // find the opening tag\r\n                var tagClosed = false;\r\n                while (scanner.scanBack()) {\r\n                    if (htmlTokenTypes_1.isTag(scanner.getTokenType()) && scanner.getTokenContent() === tagname && !tagClosed) {\r\n                        var range = scanner.getTokenRange();\r\n                        scanner.scanBack(); // one back to the end/start bracket\r\n                        if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_START) {\r\n                            if (tagCount === 0) {\r\n                                return range;\r\n                            }\r\n                            else {\r\n                                tagCount--;\r\n                            }\r\n                        }\r\n                        else {\r\n                            tagCount++;\r\n                        }\r\n                    }\r\n                    else if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_START) {\r\n                        tagClosed = scanner.getTokenContent() === '/>';\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                var isTagEnd = false;\r\n                while (scanner.scanForward()) {\r\n                    if (htmlTokenTypes_1.isTag(scanner.getTokenType()) && scanner.getTokenContent() === tagname) {\r\n                        if (!isTagEnd) {\r\n                            scanner.scanForward();\r\n                            if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_START && scanner.getTokenContent() === '/>') {\r\n                                if (tagCount <= 0) {\r\n                                    return null;\r\n                                }\r\n                            }\r\n                            else {\r\n                                tagCount++;\r\n                            }\r\n                        }\r\n                        else {\r\n                            tagCount--;\r\n                            if (tagCount <= 0) {\r\n                                return scanner.getTokenRange();\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_START) {\r\n                        isTagEnd = false;\r\n                    }\r\n                    else if (scanner.getTokenType() === htmlTokenTypes_1.DELIM_END) {\r\n                        isTagEnd = true;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        HTMLWorker.prototype.provideDocumentHighlights = function (resource, position, strict) {\r\n            if (strict === void 0) { strict = false; }\r\n            var model = this.resourceService.get(resource), wordAtPosition = model.getWordAtPosition(position), currentWord = (wordAtPosition ? wordAtPosition.word : ''), result = [];\r\n            var scanner = htmlScanner_1.getScanner(model, position);\r\n            if (htmlTokenTypes_1.isTag(scanner.getTokenType())) {\r\n                var tagname = scanner.getTokenContent();\r\n                result.push({\r\n                    range: scanner.getTokenRange(),\r\n                    kind: modes.DocumentHighlightKind.Read\r\n                });\r\n                var range = this.findMatchingBracket(tagname, scanner);\r\n                if (range) {\r\n                    result.push({\r\n                        range: range,\r\n                        kind: modes.DocumentHighlightKind.Read\r\n                    });\r\n                }\r\n            }\r\n            else {\r\n                var words = model.getAllWordsWithRange(), upperBound = Math.min(1000, words.length); // Limit find occurences to 1000 occurences\r\n                for (var i = 0; i < upperBound; i++) {\r\n                    if (words[i].text === currentWord) {\r\n                        result.push({\r\n                            range: words[i].range,\r\n                            kind: modes.DocumentHighlightKind.Read\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n            return winjs.TPromise.as(result);\r\n        };\r\n        HTMLWorker._stripQuotes = function (url) {\r\n            return url\r\n                .replace(/^'([^']+)'$/, function (substr, match1) { return match1; })\r\n                .replace(/^\"([^\"]+)\"$/, function (substr, match1) { return match1; });\r\n        };\r\n        HTMLWorker._getWorkspaceUrl = function (modelAbsoluteUri, rootAbsoluteUri, tokenContent) {\r\n            tokenContent = HTMLWorker._stripQuotes(tokenContent);\r\n            if (/^\\s*javascript\\:/i.test(tokenContent) || /^\\s*\\#/i.test(tokenContent)) {\r\n                return null;\r\n            }\r\n            if (/^\\s*https?:\\/\\//i.test(tokenContent) || /^\\s*file:\\/\\//i.test(tokenContent)) {\r\n                // Absolute link that needs no treatment\r\n                return tokenContent.replace(/^\\s*/g, '');\r\n            }\r\n            if (/^\\s*\\/\\//i.test(tokenContent)) {\r\n                // Absolute link (that does not name the protocol)\r\n                var pickedScheme = network.Schemas.http;\r\n                if (modelAbsoluteUri.scheme === network.Schemas.https) {\r\n                    pickedScheme = network.Schemas.https;\r\n                }\r\n                return pickedScheme + ':' + tokenContent.replace(/^\\s*/g, '');\r\n            }\r\n            var modelPath = paths.dirname(modelAbsoluteUri.path);\r\n            var alternativeResultPath = null;\r\n            if (tokenContent.length > 0 && tokenContent.charAt(0) === '/') {\r\n                alternativeResultPath = tokenContent;\r\n            }\r\n            else {\r\n                alternativeResultPath = paths.join(modelPath, tokenContent);\r\n                alternativeResultPath = alternativeResultPath.replace(/^(\\/\\.\\.)+/, '');\r\n            }\r\n            var potentialResult = modelAbsoluteUri.with({ path: alternativeResultPath }).toString();\r\n            var rootAbsoluteUrlStr = (rootAbsoluteUri ? rootAbsoluteUri.toString() : null);\r\n            if (rootAbsoluteUrlStr && strings.startsWith(modelAbsoluteUri.toString(), rootAbsoluteUrlStr)) {\r\n                // The `rootAbsoluteUrl` is set and matches our current model\r\n                // We need to ensure that this `potentialResult` does not escape `rootAbsoluteUrl`\r\n                var commonPrefixLength = strings.commonPrefixLength(rootAbsoluteUrlStr, potentialResult);\r\n                if (strings.endsWith(rootAbsoluteUrlStr, '/')) {\r\n                    commonPrefixLength = potentialResult.lastIndexOf('/', commonPrefixLength) + 1;\r\n                }\r\n                return rootAbsoluteUrlStr + potentialResult.substr(commonPrefixLength);\r\n            }\r\n            return potentialResult;\r\n        };\r\n        HTMLWorker.prototype.createLink = function (modelAbsoluteUrl, rootAbsoluteUrl, tokenContent, lineNumber, startColumn, endColumn) {\r\n            var workspaceUrl = HTMLWorker._getWorkspaceUrl(modelAbsoluteUrl, rootAbsoluteUrl, tokenContent);\r\n            if (!workspaceUrl) {\r\n                return null;\r\n            }\r\n            //\t\tconsole.info('workspaceUrl: ' + workspaceUrl);\r\n            return {\r\n                range: {\r\n                    startLineNumber: lineNumber,\r\n                    startColumn: startColumn,\r\n                    endLineNumber: lineNumber,\r\n                    endColumn: endColumn\r\n                },\r\n                url: workspaceUrl\r\n            };\r\n        };\r\n        HTMLWorker.prototype._computeHTMLLinks = function (model) {\r\n            var lineCount = model.getLineCount(), newLinks = [], state = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC, modelAbsoluteUrl = model.uri, lineNumber, lineContent, lineContentLength, tokens, tokenType, tokensLength, i, nextTokenEndIndex, tokenContent, link;\r\n            var rootAbsoluteUrl = null;\r\n            var workspace = this._contextService.getWorkspace();\r\n            if (workspace) {\r\n                // The workspace can be null in the no folder opened case\r\n                var strRootAbsoluteUrl = String(workspace.resource);\r\n                if (strRootAbsoluteUrl.charAt(strRootAbsoluteUrl.length - 1) === '/') {\r\n                    rootAbsoluteUrl = uri_1.default.parse(strRootAbsoluteUrl);\r\n                }\r\n                else {\r\n                    rootAbsoluteUrl = uri_1.default.parse(strRootAbsoluteUrl + '/');\r\n                }\r\n            }\r\n            for (lineNumber = 1; lineNumber <= lineCount; lineNumber++) {\r\n                lineContent = model.getLineContent(lineNumber);\r\n                lineContentLength = lineContent.length;\r\n                tokens = model.getLineTokens(lineNumber);\r\n                for (i = 0, tokensLength = tokens.getTokenCount(); i < tokensLength; i++) {\r\n                    tokenType = tokens.getTokenType(i);\r\n                    switch (tokenType) {\r\n                        case htmlTokenTypes_1.DELIM_ASSIGN:\r\n                        case '':\r\n                            break;\r\n                        case htmlTokenTypes_1.ATTRIB_NAME:\r\n                            nextTokenEndIndex = tokens.getTokenEndIndex(i, lineContentLength);\r\n                            tokenContent = lineContent.substring(tokens.getTokenStartIndex(i), nextTokenEndIndex).toLowerCase();\r\n                            if (tokenContent === 'src' || tokenContent === 'href') {\r\n                                state = LinkDetectionState.AFTER_HREF_OR_SRC;\r\n                            }\r\n                            else {\r\n                                state = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\r\n                            }\r\n                            break;\r\n                        case htmlTokenTypes_1.ATTRIB_VALUE:\r\n                            if (state === LinkDetectionState.AFTER_HREF_OR_SRC) {\r\n                                nextTokenEndIndex = tokens.getTokenEndIndex(i, lineContentLength);\r\n                                tokenContent = lineContent.substring(tokens.getTokenStartIndex(i), nextTokenEndIndex);\r\n                                link = this.createLink(modelAbsoluteUrl, rootAbsoluteUrl, tokenContent, lineNumber, tokens.getTokenStartIndex(i) + 2, nextTokenEndIndex);\r\n                                if (link) {\r\n                                    newLinks.push(link);\r\n                                }\r\n                                state = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\r\n                            }\r\n                        default:\r\n                            if (htmlTokenTypes_1.isTag(tokenType)) {\r\n                                state = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\r\n                            }\r\n                            else if (state === LinkDetectionState.AFTER_HREF_OR_SRC) {\r\n                                state = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\r\n                            }\r\n                    }\r\n                }\r\n            }\r\n            return newLinks;\r\n        };\r\n        HTMLWorker.prototype.provideLinks = function (resource) {\r\n            var model = this.resourceService.get(resource);\r\n            return winjs.TPromise.as(this._computeHTMLLinks(model));\r\n        };\r\n        HTMLWorker = __decorate([\r\n            __param(1, resourceService_1.IResourceService),\r\n            __param(2, markers_1.IMarkerService),\r\n            __param(3, workspace_1.IWorkspaceContextService)\r\n        ], HTMLWorker);\r\n        return HTMLWorker;\r\n    }());\r\n    exports.HTMLWorker = HTMLWorker;\r\n    function isWhiteSpace(s) {\r\n        return /^\\s*$/.test(s);\r\n    }\r\n});\r\n\n\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {isTag, DELIM_END, DELIM_START, DELIM_ASSIGN, ATTRIB_NAME, ATTRIB_VALUE} from 'vs/languages/html/common/htmlTokenTypes';\n\nimport EditorCommon = require('vs/editor/common/editorCommon');\n\nexport interface IHTMLScanner {\n\tgetTokenType(): string;\n\tisOpenBrace(): boolean;\n\tisAtTokenStart(): boolean;\n\tisAtTokenEnd(): boolean;\n\tgetTokenContent(): string;\n\tscanBack() : boolean;\n\tscanForward() : boolean;\n\tgetTokenPosition(): EditorCommon.IPosition;\n\tgetTokenRange(): EditorCommon.IRange;\n\tgetModel(): EditorCommon.ITokenizedModel;\n}\n\nfunction isDelimiter(tokenType: string) {\n\tswitch (tokenType) {\n\t\tcase DELIM_START:\n\t\tcase DELIM_END:\n\t\tcase DELIM_ASSIGN:\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction isInterestingToken(tokenType: string) {\n\tswitch (tokenType) {\n\t\tcase DELIM_START:\n\t\tcase DELIM_END:\n\t\tcase DELIM_ASSIGN:\n\t\tcase ATTRIB_NAME:\n\t\tcase ATTRIB_VALUE:\n\t\t\treturn true;\n\t}\n\treturn isTag(tokenType);\n}\n\nexport function getScanner(model: EditorCommon.ITokenizedModel, position:EditorCommon.IPosition) : IHTMLScanner {\n\n\tvar lineOffset = position.column - 1;\n\tvar currentLine = position.lineNumber;\n\n\tvar tokens = model.getLineTokens(currentLine);\n\tvar lineContent = model.getLineContent(currentLine);\n\tvar tokenIndex = tokens.findIndexOfOffset(lineOffset);\n\tvar tokensOnLine = tokens.getTokenCount();\n\n\tvar tokenType = tokens.getTokenType(tokenIndex);\n\tvar tokenStart = tokens.getTokenStartIndex(tokenIndex);\n\tvar tokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\n\n\tif ((tokenType === '' || isDelimiter(tokenType)) && tokenStart === lineOffset) {\n\t\ttokenIndex--;\n\t\tif (tokenIndex >= 0) {\n\t\t\t// we are at the end of a different token\n\t\t\ttokenType = tokens.getTokenType(tokenIndex);\n\t\t\ttokenStart = tokens.getTokenStartIndex(tokenIndex);\n\t\t\ttokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\n\t\t} else {\n\t\t\ttokenType = '';\n\t\t\ttokenStart = tokenEnd = 0;\n\t\t}\n\t}\n\n\treturn {\n\t\tgetTokenType: () => tokenType,\n\t\tisAtTokenEnd: () => lineOffset === tokenEnd,\n\t\tisAtTokenStart: () => lineOffset === tokenStart,\n\t\tgetTokenContent: () => lineContent.substring(tokenStart, tokenEnd),\n\t\tisOpenBrace: () => tokenStart < tokenEnd && lineContent.charAt(tokenStart) === '<',\n\t\tgetTokenPosition: () => <EditorCommon.IPosition> { lineNumber: currentLine, column: tokenStart + 1 },\n\t\tgetTokenRange: () => <EditorCommon.IRange> { startLineNumber: currentLine, startColumn: tokenStart + 1, endLineNumber: currentLine, endColumn: tokenEnd + 1 },\n\t\tgetModel: () => model,\n\t\tscanBack: () => {\n\t\t\tif (currentLine <= 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttokenIndex--;\n\t\t\tdo {\n\t\t\t\twhile (tokenIndex >= 0) {\n\t\t\t\t\ttokenType = tokens.getTokenType(tokenIndex);\n\t\t\t\t\ttokenStart = tokens.getTokenStartIndex(tokenIndex);\n\t\t\t\t\ttokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\n\n\t\t\t\t\tif (isInterestingToken(tokenType)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\ttokenIndex--;\n\t\t\t\t}\n\t\t\t\tcurrentLine--;\n\t\t\t\tif (currentLine > 0) {\n\t\t\t\t\ttokens = model.getLineTokens(currentLine);\n\t\t\t\t\tlineContent = model.getLineContent(currentLine);\n\t\t\t\t\ttokensOnLine = tokens.getTokenCount();\n\t\t\t\t\ttokenIndex = tokensOnLine - 1;\n\t\t\t\t}\n\t\t\t} while (currentLine > 0);\n\t\t\ttokens = null;\n\t\t\ttokenType = lineContent = '';\n\t\t\ttokenStart = tokenEnd = tokensOnLine = 0;\n\t\t\treturn false;\n\t\t},\n\t\tscanForward: () => {\n\t\t\tif (currentLine > model.getLineCount()) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\ttokenIndex++;\n\t\t\tdo {\n\t\t\t\twhile (tokenIndex < tokensOnLine) {\n\t\t\t\t\ttokenType = tokens.getTokenType(tokenIndex);\n\t\t\t\t\ttokenStart = tokens.getTokenStartIndex(tokenIndex);\n\t\t\t\t\ttokenEnd = tokens.getTokenEndIndex(tokenIndex, lineContent.length);\n\n\t\t\t\t\tif (isInterestingToken(tokenType)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\ttokenIndex++;\n\t\t\t\t}\n\t\t\t\tcurrentLine++;\n\t\t\t\ttokenIndex = 0;\n\t\t\t\tif (currentLine <= model.getLineCount()) {\n\t\t\t\t\ttokens = model.getLineTokens(currentLine);\n\t\t\t\t\tlineContent = model.getLineContent(currentLine);\n\t\t\t\t\ttokensOnLine = tokens.getTokenCount();\n\t\t\t\t}\n\t\t\t} while (currentLine <= model.getLineCount());\n\t\t\ttokenType = lineContent = '';\n\t\t\ttokenStart = tokenEnd = tokensOnLine = 0;\n\t\t\treturn false;\n\t\t}\n\t};\n}","define(\"vs/nls!vs/languages/html/common/htmlTags\",['vs/nls', 'vs/nls!vs/languages/html/common/htmlWorker'], function(nls, data) { return nls.create(\"vs/languages/html/common/htmlTags\", data); });","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\nimport * as nls from 'vs/nls';\nimport * as defaultPlatform from 'vs/base/common/platform';\nimport {IHTMLContentElement} from 'vs/base/common/htmlContent';\n\nexport interface ISimplifiedPlatform {\n\tisMacintosh: boolean;\n\tisWindows: boolean;\n}\n\n/**\n * Virtual Key Codes, the value does not hold any inherent meaning.\n * Inspired somewhat from https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\n * But these are \"more general\", as they should work across browsers & OS`s.\n */\nexport enum KeyCode {\n\t/**\n\t * Placed first to cover the 0 value of the enum.\n\t */\n\tUnknown,\n\n\tBackspace,\n\tTab,\n\tEnter,\n\tShift,\n\tCtrl,\n\tAlt,\n\tPauseBreak,\n\tCapsLock,\n\tEscape,\n\tSpace,\n\tPageUp,\n\tPageDown,\n\tEnd,\n\tHome,\n\tLeftArrow,\n\tUpArrow,\n\tRightArrow,\n\tDownArrow,\n\tInsert,\n\tDelete,\n\n\tKEY_0,\n\tKEY_1,\n\tKEY_2,\n\tKEY_3,\n\tKEY_4,\n\tKEY_5,\n\tKEY_6,\n\tKEY_7,\n\tKEY_8,\n\tKEY_9,\n\n\tKEY_A,\n\tKEY_B,\n\tKEY_C,\n\tKEY_D,\n\tKEY_E,\n\tKEY_F,\n\tKEY_G,\n\tKEY_H,\n\tKEY_I,\n\tKEY_J,\n\tKEY_K,\n\tKEY_L,\n\tKEY_M,\n\tKEY_N,\n\tKEY_O,\n\tKEY_P,\n\tKEY_Q,\n\tKEY_R,\n\tKEY_S,\n\tKEY_T,\n\tKEY_U,\n\tKEY_V,\n\tKEY_W,\n\tKEY_X,\n\tKEY_Y,\n\tKEY_Z,\n\n\tMeta,\n\tContextMenu,\n\n\tF1,\n\tF2,\n\tF3,\n\tF4,\n\tF5,\n\tF6,\n\tF7,\n\tF8,\n\tF9,\n\tF10,\n\tF11,\n\tF12,\n\tF13,\n\tF14,\n\tF15,\n\tF16,\n\tF17,\n\tF18,\n\tF19,\n\n\tNumLock,\n\tScrollLock,\n\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ';:' key\n\t */\n\tUS_SEMICOLON,\n\t/**\n\t * For any country/region, the '+' key\n\t * For the US standard keyboard, the '=+' key\n\t */\n\tUS_EQUAL,\n\t/**\n\t * For any country/region, the ',' key\n\t * For the US standard keyboard, the ',<' key\n\t */\n\tUS_COMMA,\n\t/**\n\t * For any country/region, the '-' key\n\t * For the US standard keyboard, the '-_' key\n\t */\n\tUS_MINUS,\n\t/**\n\t * For any country/region, the '.' key\n\t * For the US standard keyboard, the '.>' key\n\t */\n\tUS_DOT,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '/?' key\n\t */\n\tUS_SLASH,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '`~' key\n\t */\n\tUS_BACKTICK,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '[{' key\n\t */\n\tUS_OPEN_SQUARE_BRACKET,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '\\|' key\n\t */\n\tUS_BACKSLASH,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ']}' key\n\t */\n\tUS_CLOSE_SQUARE_BRACKET,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ''\"' key\n\t */\n\tUS_QUOTE,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t */\n\tOEM_8,\n\t/**\n\t * Either the angle bracket key or the backslash key on the RT 102-key keyboard.\n\t */\n\tOEM_102,\n\n\tNUMPAD_0, // VK_NUMPAD0, 0x60, Numeric keypad 0 key\n\tNUMPAD_1, // VK_NUMPAD1, 0x61, Numeric keypad 1 key\n\tNUMPAD_2, // VK_NUMPAD2, 0x62, Numeric keypad 2 key\n\tNUMPAD_3, // VK_NUMPAD3, 0x63, Numeric keypad 3 key\n\tNUMPAD_4, // VK_NUMPAD4, 0x64, Numeric keypad 4 key\n\tNUMPAD_5, // VK_NUMPAD5, 0x65, Numeric keypad 5 key\n\tNUMPAD_6, // VK_NUMPAD6, 0x66, Numeric keypad 6 key\n\tNUMPAD_7, // VK_NUMPAD7, 0x67, Numeric keypad 7 key\n\tNUMPAD_8, // VK_NUMPAD8, 0x68, Numeric keypad 8 key\n\tNUMPAD_9, // VK_NUMPAD9, 0x69, Numeric keypad 9 key\n\n\tNUMPAD_MULTIPLY,\t// VK_MULTIPLY, 0x6A, Multiply key\n\tNUMPAD_ADD,\t\t\t// VK_ADD, 0x6B, Add key\n\tNUMPAD_SEPARATOR,\t// VK_SEPARATOR, 0x6C, Separator key\n\tNUMPAD_SUBTRACT,\t// VK_SUBTRACT, 0x6D, Subtract key\n\tNUMPAD_DECIMAL,\t\t// VK_DECIMAL, 0x6E, Decimal key\n\tNUMPAD_DIVIDE,\t\t// VK_DIVIDE, 0x6F,\n\n\t/**\n\t * Placed last to cover the length of the enum.\n\t */\n\tMAX_VALUE\n}\n\ninterface IReverseMap {\n\t[str:string]:KeyCode;\n}\n\nclass Mapping {\n\n\t_fromKeyCode: string[];\n\t_toKeyCode: IReverseMap;\n\n\tconstructor(fromKeyCode: string[], toKeyCode: IReverseMap) {\n\t\tthis._fromKeyCode = fromKeyCode;\n\t\tthis._toKeyCode = toKeyCode;\n\t}\n\n\tfromKeyCode(keyCode:KeyCode): string {\n\t\treturn this._fromKeyCode[keyCode];\n\t}\n\n\ttoKeyCode(str:string): KeyCode {\n\t\tif (this._toKeyCode.hasOwnProperty(str)) {\n\t\t\treturn this._toKeyCode[str];\n\t\t}\n\t\treturn KeyCode.Unknown;\n\t}\n\n}\n\nfunction createMapping(fill1:(map:string[])=>void, fill2:(reverseMap:IReverseMap)=>void): Mapping {\n\tlet MAP: string[] = [];\n\tfill1(MAP);\n\n\tlet REVERSE_MAP: IReverseMap = {};\n\tfor (let i = 0, len = MAP.length; i < len; i++) {\n\t\tif (!MAP[i]) {\n\t\t\tcontinue;\n\t\t}\n\t\tREVERSE_MAP[MAP[i]] = i;\n\t}\n\tfill2(REVERSE_MAP);\n\n\tlet FINAL_REVERSE_MAP: IReverseMap = {};\n\tfor (let entry in REVERSE_MAP) {\n\t\tif (REVERSE_MAP.hasOwnProperty(entry)) {\n\t\t\tFINAL_REVERSE_MAP[entry] = REVERSE_MAP[entry];\n\t\t\tFINAL_REVERSE_MAP[entry.toLowerCase()] = REVERSE_MAP[entry];\n\t\t}\n\t}\n\n\treturn new Mapping(MAP, FINAL_REVERSE_MAP);\n}\n\nlet STRING = createMapping((TO_STRING_MAP) => {\n\tTO_STRING_MAP[KeyCode.Unknown] \t\t= 'unknown';\n\n\tTO_STRING_MAP[KeyCode.Backspace] \t= 'Backspace';\n\tTO_STRING_MAP[KeyCode.Tab] \t\t\t= 'Tab';\n\tTO_STRING_MAP[KeyCode.Enter] \t\t= 'Enter';\n\tTO_STRING_MAP[KeyCode.Shift] \t\t= 'Shift';\n\tTO_STRING_MAP[KeyCode.Ctrl] \t\t= 'Ctrl';\n\tTO_STRING_MAP[KeyCode.Alt] \t\t\t= 'Alt';\n\tTO_STRING_MAP[KeyCode.PauseBreak] \t= 'PauseBreak';\n\tTO_STRING_MAP[KeyCode.CapsLock] \t= 'CapsLock';\n\tTO_STRING_MAP[KeyCode.Escape] \t\t= 'Escape';\n\tTO_STRING_MAP[KeyCode.Space] \t\t= 'Space';\n\tTO_STRING_MAP[KeyCode.PageUp] \t\t= 'PageUp';\n\tTO_STRING_MAP[KeyCode.PageDown] \t= 'PageDown';\n\tTO_STRING_MAP[KeyCode.End] \t\t\t= 'End';\n\tTO_STRING_MAP[KeyCode.Home] \t\t= 'Home';\n\tTO_STRING_MAP[KeyCode.LeftArrow] \t= 'LeftArrow';\n\tTO_STRING_MAP[KeyCode.UpArrow] \t\t= 'UpArrow';\n\tTO_STRING_MAP[KeyCode.RightArrow] \t= 'RightArrow';\n\tTO_STRING_MAP[KeyCode.DownArrow] \t= 'DownArrow';\n\tTO_STRING_MAP[KeyCode.Insert] \t\t= 'Insert';\n\tTO_STRING_MAP[KeyCode.Delete] \t\t= 'Delete';\n\n\tTO_STRING_MAP[KeyCode.KEY_0] = '0';\n\tTO_STRING_MAP[KeyCode.KEY_1] = '1';\n\tTO_STRING_MAP[KeyCode.KEY_2] = '2';\n\tTO_STRING_MAP[KeyCode.KEY_3] = '3';\n\tTO_STRING_MAP[KeyCode.KEY_4] = '4';\n\tTO_STRING_MAP[KeyCode.KEY_5] = '5';\n\tTO_STRING_MAP[KeyCode.KEY_6] = '6';\n\tTO_STRING_MAP[KeyCode.KEY_7] = '7';\n\tTO_STRING_MAP[KeyCode.KEY_8] = '8';\n\tTO_STRING_MAP[KeyCode.KEY_9] = '9';\n\n\tTO_STRING_MAP[KeyCode.KEY_A] = 'A';\n\tTO_STRING_MAP[KeyCode.KEY_B] = 'B';\n\tTO_STRING_MAP[KeyCode.KEY_C] = 'C';\n\tTO_STRING_MAP[KeyCode.KEY_D] = 'D';\n\tTO_STRING_MAP[KeyCode.KEY_E] = 'E';\n\tTO_STRING_MAP[KeyCode.KEY_F] = 'F';\n\tTO_STRING_MAP[KeyCode.KEY_G] = 'G';\n\tTO_STRING_MAP[KeyCode.KEY_H] = 'H';\n\tTO_STRING_MAP[KeyCode.KEY_I] = 'I';\n\tTO_STRING_MAP[KeyCode.KEY_J] = 'J';\n\tTO_STRING_MAP[KeyCode.KEY_K] = 'K';\n\tTO_STRING_MAP[KeyCode.KEY_L] = 'L';\n\tTO_STRING_MAP[KeyCode.KEY_M] = 'M';\n\tTO_STRING_MAP[KeyCode.KEY_N] = 'N';\n\tTO_STRING_MAP[KeyCode.KEY_O] = 'O';\n\tTO_STRING_MAP[KeyCode.KEY_P] = 'P';\n\tTO_STRING_MAP[KeyCode.KEY_Q] = 'Q';\n\tTO_STRING_MAP[KeyCode.KEY_R] = 'R';\n\tTO_STRING_MAP[KeyCode.KEY_S] = 'S';\n\tTO_STRING_MAP[KeyCode.KEY_T] = 'T';\n\tTO_STRING_MAP[KeyCode.KEY_U] = 'U';\n\tTO_STRING_MAP[KeyCode.KEY_V] = 'V';\n\tTO_STRING_MAP[KeyCode.KEY_W] = 'W';\n\tTO_STRING_MAP[KeyCode.KEY_X] = 'X';\n\tTO_STRING_MAP[KeyCode.KEY_Y] = 'Y';\n\tTO_STRING_MAP[KeyCode.KEY_Z] = 'Z';\n\n\tTO_STRING_MAP[KeyCode.ContextMenu] = 'ContextMenu';\n\n\tTO_STRING_MAP[KeyCode.F1] = 'F1';\n\tTO_STRING_MAP[KeyCode.F2] = 'F2';\n\tTO_STRING_MAP[KeyCode.F3] = 'F3';\n\tTO_STRING_MAP[KeyCode.F4] = 'F4';\n\tTO_STRING_MAP[KeyCode.F5] = 'F5';\n\tTO_STRING_MAP[KeyCode.F6] = 'F6';\n\tTO_STRING_MAP[KeyCode.F7] = 'F7';\n\tTO_STRING_MAP[KeyCode.F8] = 'F8';\n\tTO_STRING_MAP[KeyCode.F9] = 'F9';\n\tTO_STRING_MAP[KeyCode.F10] = 'F10';\n\tTO_STRING_MAP[KeyCode.F11] = 'F11';\n\tTO_STRING_MAP[KeyCode.F12] = 'F12';\n\tTO_STRING_MAP[KeyCode.F13] = 'F13';\n\tTO_STRING_MAP[KeyCode.F14] = 'F14';\n\tTO_STRING_MAP[KeyCode.F15] = 'F15';\n\tTO_STRING_MAP[KeyCode.F16] = 'F16';\n\tTO_STRING_MAP[KeyCode.F17] = 'F17';\n\tTO_STRING_MAP[KeyCode.F18] = 'F18';\n\tTO_STRING_MAP[KeyCode.F19] = 'F19';\n\n\n\tTO_STRING_MAP[KeyCode.NumLock] \t\t= 'NumLock';\n\tTO_STRING_MAP[KeyCode.ScrollLock] \t= 'ScrollLock';\n\n\tTO_STRING_MAP[KeyCode.US_SEMICOLON] \t\t\t= ';';\n\tTO_STRING_MAP[KeyCode.US_EQUAL] \t\t\t\t= '=';\n\tTO_STRING_MAP[KeyCode.US_COMMA] \t\t\t\t= ',';\n\tTO_STRING_MAP[KeyCode.US_MINUS] \t\t\t\t= '-';\n\tTO_STRING_MAP[KeyCode.US_DOT] \t\t\t\t\t= '.';\n\tTO_STRING_MAP[KeyCode.US_SLASH] \t\t\t\t= '/';\n\tTO_STRING_MAP[KeyCode.US_BACKTICK] \t\t\t\t= '`';\n\tTO_STRING_MAP[KeyCode.US_OPEN_SQUARE_BRACKET] \t= '[';\n\tTO_STRING_MAP[KeyCode.US_BACKSLASH] \t\t\t= '\\\\';\n\tTO_STRING_MAP[KeyCode.US_CLOSE_SQUARE_BRACKET] \t= ']';\n\tTO_STRING_MAP[KeyCode.US_QUOTE]\t\t\t\t\t= '\\'';\n\tTO_STRING_MAP[KeyCode.OEM_8]\t\t\t\t\t= 'OEM_8';\n\tTO_STRING_MAP[KeyCode.OEM_102]\t\t\t\t\t= 'OEM_102';\n\n\tTO_STRING_MAP[KeyCode.NUMPAD_0] = 'NumPad0';\n\tTO_STRING_MAP[KeyCode.NUMPAD_1] = 'NumPad1';\n\tTO_STRING_MAP[KeyCode.NUMPAD_2] = 'NumPad2';\n\tTO_STRING_MAP[KeyCode.NUMPAD_3] = 'NumPad3';\n\tTO_STRING_MAP[KeyCode.NUMPAD_4] = 'NumPad4';\n\tTO_STRING_MAP[KeyCode.NUMPAD_5] = 'NumPad5';\n\tTO_STRING_MAP[KeyCode.NUMPAD_6] = 'NumPad6';\n\tTO_STRING_MAP[KeyCode.NUMPAD_7] = 'NumPad7';\n\tTO_STRING_MAP[KeyCode.NUMPAD_8] = 'NumPad8';\n\tTO_STRING_MAP[KeyCode.NUMPAD_9] = 'NumPad9';\n\n\tTO_STRING_MAP[KeyCode.NUMPAD_MULTIPLY] = 'NumPad_Multiply';\n\tTO_STRING_MAP[KeyCode.NUMPAD_ADD] = 'NumPad_Add';\n\tTO_STRING_MAP[KeyCode.NUMPAD_SEPARATOR] = 'NumPad_Separator';\n\tTO_STRING_MAP[KeyCode.NUMPAD_SUBTRACT] = 'NumPad_Subtract';\n\tTO_STRING_MAP[KeyCode.NUMPAD_DECIMAL] = 'NumPad_Decimal';\n\tTO_STRING_MAP[KeyCode.NUMPAD_DIVIDE] = 'NumPad_Divide';\n\n\t// for (let i = 0; i < KeyCode.MAX_VALUE; i++) {\n\t// \tif (!TO_STRING_MAP[i]) {\n\t// \t\tconsole.warn('Missing string representation for ' + KeyCode[i]);\n\t// \t}\n\t// }\n}, (FROM_STRING_MAP) => {\n\tFROM_STRING_MAP['\\r'] = KeyCode.Enter;\n});\n\n\nlet USER_SETTINGS = createMapping((TO_USER_SETTINGS_MAP) => {\n\tfor (let i = 0, len = STRING._fromKeyCode.length; i < len; i++) {\n\t\tTO_USER_SETTINGS_MAP[i] = STRING._fromKeyCode[i];\n\t}\n\tTO_USER_SETTINGS_MAP[KeyCode.LeftArrow] = 'Left';\n\tTO_USER_SETTINGS_MAP[KeyCode.UpArrow] = 'Up';\n\tTO_USER_SETTINGS_MAP[KeyCode.RightArrow] = 'Right';\n\tTO_USER_SETTINGS_MAP[KeyCode.DownArrow] = 'Down';\n}, (FROM_USER_SETTINGS_MAP) => {\n\tFROM_USER_SETTINGS_MAP['OEM_1'] = KeyCode.US_SEMICOLON;\n\tFROM_USER_SETTINGS_MAP['OEM_PLUS'] = KeyCode.US_EQUAL;\n\tFROM_USER_SETTINGS_MAP['OEM_COMMA'] = KeyCode.US_COMMA;\n\tFROM_USER_SETTINGS_MAP['OEM_MINUS'] = KeyCode.US_MINUS;\n\tFROM_USER_SETTINGS_MAP['OEM_PERIOD'] = KeyCode.US_DOT;\n\tFROM_USER_SETTINGS_MAP['OEM_2'] = KeyCode.US_SLASH;\n\tFROM_USER_SETTINGS_MAP['OEM_3'] = KeyCode.US_BACKTICK;\n\tFROM_USER_SETTINGS_MAP['OEM_4'] = KeyCode.US_OPEN_SQUARE_BRACKET;\n\tFROM_USER_SETTINGS_MAP['OEM_5'] = KeyCode.US_BACKSLASH;\n\tFROM_USER_SETTINGS_MAP['OEM_6'] = KeyCode.US_CLOSE_SQUARE_BRACKET;\n\tFROM_USER_SETTINGS_MAP['OEM_7'] = KeyCode.US_QUOTE;\n\tFROM_USER_SETTINGS_MAP['OEM_8'] = KeyCode.OEM_8;\n\tFROM_USER_SETTINGS_MAP['OEM_102'] = KeyCode.OEM_102;\n});\n\nexport namespace KeyCode {\n\texport function toString(key:KeyCode): string {\n\t\treturn STRING.fromKeyCode(key);\n\t}\n\texport function fromString(key:string): KeyCode {\n\t\treturn STRING.toKeyCode(key);\n\t}\n}\n\n// Binary encoding strategy:\n// 15:  1 bit for ctrlCmd\n// 14:  1 bit for shift\n// 13:  1 bit for alt\n// 12:  1 bit for winCtrl\n//  0: 12 bits for keyCode (up to a maximum keyCode of 4096. Given we have 83 at this point thats good enough)\n\nconst BIN_CTRLCMD_MASK = 1 << 15;\nconst BIN_SHIFT_MASK = 1 << 14;\nconst BIN_ALT_MASK = 1 << 13;\nconst BIN_WINCTRL_MASK = 1 << 12;\nconst BIN_KEYCODE_MASK = 0x00000fff;\n\nexport class BinaryKeybindings {\n\n\tpublic static extractFirstPart(keybinding:number): number {\n\t\treturn keybinding & 0x0000ffff;\n\t}\n\n\tpublic static extractChordPart(keybinding:number): number {\n\t\treturn (keybinding >> 16) & 0x0000ffff;\n\t}\n\n\tpublic static hasChord(keybinding:number): boolean {\n\t\treturn (this.extractChordPart(keybinding) !== 0);\n\t}\n\n\tpublic static hasCtrlCmd(keybinding:number): boolean {\n\t\treturn (keybinding & BIN_CTRLCMD_MASK ? true : false);\n\t}\n\n\tpublic static hasShift(keybinding:number): boolean {\n\t\treturn (keybinding & BIN_SHIFT_MASK ? true : false);\n\t}\n\n\tpublic static hasAlt(keybinding:number): boolean {\n\t\treturn (keybinding & BIN_ALT_MASK ? true : false);\n\t}\n\n\tpublic static hasWinCtrl(keybinding:number): boolean {\n\t\treturn (keybinding & BIN_WINCTRL_MASK ? true : false);\n\t}\n\n\tpublic static extractKeyCode(keybinding:number): KeyCode {\n\t\treturn (keybinding & BIN_KEYCODE_MASK);\n\t}\n}\n\n\n\nexport class KeyMod {\n\tpublic static CtrlCmd = BIN_CTRLCMD_MASK;\n\tpublic static Shift = BIN_SHIFT_MASK;\n\tpublic static Alt = BIN_ALT_MASK;\n\tpublic static WinCtrl = BIN_WINCTRL_MASK;\n\n\tpublic static chord(firstPart:number, secondPart:number): number {\n\t\treturn firstPart | ((secondPart & 0x0000ffff) << 16);\n\t}\n}\n\n/**\n * A set of usual keybindings that can be reused in code\n */\nexport class CommonKeybindings {\n\n\tpublic static ENTER: number = KeyCode.Enter;\n\tpublic static SHIFT_ENTER: number = KeyMod.Shift | KeyCode.Enter;\n\tpublic static CTRLCMD_ENTER: number = KeyMod.CtrlCmd | KeyCode.Enter;\n\tpublic static WINCTRL_ENTER: number = KeyMod.WinCtrl | KeyCode.Enter;\n\n\tpublic static TAB: number = KeyCode.Tab;\n\tpublic static SHIFT_TAB: number = KeyMod.Shift | KeyCode.Tab;\n\tpublic static ESCAPE: number = KeyCode.Escape;\n\tpublic static SPACE: number = KeyCode.Space;\n\tpublic static DELETE: number = KeyCode.Delete;\n\tpublic static SHIFT_DELETE: number = KeyMod.Shift | KeyCode.Delete;\n\tpublic static CTRLCMD_BACKSPACE: number = KeyMod.CtrlCmd | KeyCode.Backspace;\n\n\tpublic static UP_ARROW: number = KeyCode.UpArrow;\n\tpublic static SHIFT_UP_ARROW: number = KeyMod.Shift | KeyCode.UpArrow;\n\tpublic static CTRLCMD_UP_ARROW: number = KeyMod.CtrlCmd | KeyCode.UpArrow;\n\n\tpublic static DOWN_ARROW: number = KeyCode.DownArrow;\n\tpublic static SHIFT_DOWN_ARROW: number = KeyMod.Shift | KeyCode.DownArrow;\n\tpublic static CTRLCMD_DOWN_ARROW: number = KeyMod.CtrlCmd | KeyCode.DownArrow;\n\n\tpublic static LEFT_ARROW: number = KeyCode.LeftArrow;\n\n\tpublic static RIGHT_ARROW: number = KeyCode.RightArrow;\n\n\tpublic static PAGE_UP: number = KeyCode.PageUp;\n\tpublic static SHIFT_PAGE_UP: number = KeyMod.Shift | KeyCode.PageUp;\n\n\tpublic static PAGE_DOWN: number = KeyCode.PageDown;\n\tpublic static SHIFT_PAGE_DOWN: number = KeyMod.Shift | KeyCode.PageDown;\n\n\tpublic static F2: number = KeyCode.F2;\n\n\tpublic static CTRLCMD_S: number = KeyMod.CtrlCmd | KeyCode.KEY_S;\n\tpublic static CTRLCMD_C: number = KeyMod.CtrlCmd | KeyCode.KEY_C;\n\tpublic static CTRLCMD_V: number = KeyMod.CtrlCmd | KeyCode.KEY_V;\n}\n\nexport class Keybinding {\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tprivate static _toUSLabel(value:number, Platform:ISimplifiedPlatform): string {\n\t\treturn _asString(value, (Platform.isMacintosh ? MacUIKeyLabelProvider.INSTANCE : ClassicUIKeyLabelProvider.INSTANCE), Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for placing in an aria-label.\n\t */\n\tprivate static _toUSAriaLabel(value:number, Platform:ISimplifiedPlatform): string {\n\t\treturn _asString(value, AriaKeyLabelProvider.INSTANCE, Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tprivate static _toUSHTMLLabel(value:number, Platform:ISimplifiedPlatform): IHTMLContentElement[] {\n\t\treturn _asHTML(value, (Platform.isMacintosh ? MacUIKeyLabelProvider.INSTANCE : ClassicUIKeyLabelProvider.INSTANCE), Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tprivate static _toCustomLabel(value:number, labelProvider:IKeyBindingLabelProvider, Platform:ISimplifiedPlatform): string {\n\t\treturn _asString(value, labelProvider, Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tprivate static _toCustomHTMLLabel(value:number, labelProvider:IKeyBindingLabelProvider, Platform:ISimplifiedPlatform): IHTMLContentElement[] {\n\t\treturn _asHTML(value, labelProvider, Platform);\n\t}\n\n\t/**\n\t * This prints the binding in a format suitable for electron's accelerators.\n\t * See https://github.com/electron/electron/blob/master/docs/api/accelerator.md\n\t */\n\tprivate static _toElectronAccelerator(value:number, Platform:ISimplifiedPlatform): string {\n\t\tif (BinaryKeybindings.hasChord(value)) {\n\t\t\t// Electron cannot handle chords\n\t\t\treturn null;\n\t\t}\n\t\treturn _asString(value, ElectronAcceleratorLabelProvider.INSTANCE, Platform);\n\t}\n\n\tprivate static _cachedKeybindingRegex: string = null;\n\tpublic static getUserSettingsKeybindingRegex(): string {\n\t\tif (!this._cachedKeybindingRegex) {\n\t\t\tlet numpadKey = 'numpad(0|1|2|3|4|5|6|7|8|9|_multiply|_add|_subtract|_decimal|_divide|_separator)';\n\t\t\tlet oemKey = '`|\\\\-|=|\\\\[|\\\\]|\\\\\\\\\\\\\\\\|;|\\'|,|\\\\.|\\\\/|oem_8|oem_102';\n\t\t\tlet specialKey = 'left|up|right|down|pageup|pagedown|end|home|tab|enter|escape|space|backspace|delete|pausebreak|capslock|insert|contextmenu|numlock|scrolllock';\n\t\t\tlet casualKey = '[a-z]|[0-9]|f(1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19)';\n\t\t\tlet key = '((' + [numpadKey, oemKey, specialKey, casualKey].join(')|(') + '))';\n\t\t\tlet mod = '((ctrl|shift|alt|cmd|win|meta)\\\\+)*';\n\t\t\tlet keybinding = '(' + mod + key + ')';\n\n\t\t\tthis._cachedKeybindingRegex = '\"\\\\s*(' + keybinding + '(\\\\s+' + keybinding +')?' + ')\\\\s*\"';\n\t\t}\n\t\treturn this._cachedKeybindingRegex;\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for the user settings file.\n\t */\n\tpublic static toUserSettingsLabel(value:number, Platform:ISimplifiedPlatform = defaultPlatform): string {\n\t\tlet result = _asString(value, UserSettingsKeyLabelProvider.INSTANCE, Platform);\n\t\tresult = result.toLowerCase();\n\n\t\tif (Platform.isMacintosh) {\n\t\t\tresult = result.replace(/meta/g, 'cmd');\n\t\t} else if (Platform.isWindows) {\n\t\t\tresult = result.replace(/meta/g, 'win');\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpublic static fromUserSettingsLabel(input: string, Platform: ISimplifiedPlatform = defaultPlatform): number {\n\t\tif (!input) {\n\t\t\treturn null;\n\t\t}\n\t\tinput = input.toLowerCase().trim();\n\n\t\tlet ctrlCmd = false,\n\t\t\tshift = false,\n\t\t\talt = false,\n\t\t\twinCtrl = false,\n\t\t\tkey:string = '';\n\n\t\twhile (/^(ctrl|shift|alt|meta|win|cmd)(\\+|\\-)/.test(input)) {\n\t\t\tif (/^ctrl(\\+|\\-)/.test(input)) {\n\t\t\t\tif (Platform.isMacintosh) {\n\t\t\t\t\twinCtrl = true;\n\t\t\t\t} else {\n\t\t\t\t\tctrlCmd = true;\n\t\t\t\t}\n\t\t\t\tinput = input.substr('ctrl-'.length);\n\t\t\t}\n\t\t\tif (/^shift(\\+|\\-)/.test(input)) {\n\t\t\t\tshift = true;\n\t\t\t\tinput = input.substr('shift-'.length);\n\t\t\t}\n\t\t\tif (/^alt(\\+|\\-)/.test(input)) {\n\t\t\t\talt = true;\n\t\t\t\tinput = input.substr('alt-'.length);\n\t\t\t}\n\t\t\tif (/^meta(\\+|\\-)/.test(input)) {\n\t\t\t\tif (Platform.isMacintosh) {\n\t\t\t\t\tctrlCmd = true;\n\t\t\t\t} else {\n\t\t\t\t\twinCtrl = true;\n\t\t\t\t}\n\t\t\t\tinput = input.substr('meta-'.length);\n\t\t\t}\n\t\t\tif (/^win(\\+|\\-)/.test(input)) {\n\t\t\t\tif (Platform.isMacintosh) {\n\t\t\t\t\tctrlCmd = true;\n\t\t\t\t} else {\n\t\t\t\t\twinCtrl = true;\n\t\t\t\t}\n\t\t\t\tinput = input.substr('win-'.length);\n\t\t\t}\n\t\t\tif (/^cmd(\\+|\\-)/.test(input)) {\n\t\t\t\tif (Platform.isMacintosh) {\n\t\t\t\t\tctrlCmd = true;\n\t\t\t\t} else {\n\t\t\t\t\twinCtrl = true;\n\t\t\t\t}\n\t\t\t\tinput = input.substr('cmd-'.length);\n\t\t\t}\n\t\t}\n\n\t\tlet chord: number = 0;\n\n\t\tlet firstSpaceIdx = input.indexOf(' ');\n\t\tif (firstSpaceIdx > 0) {\n\t\t\tkey = input.substring(0, firstSpaceIdx);\n\t\t\tchord = Keybinding.fromUserSettingsLabel(input.substring(firstSpaceIdx), Platform);\n\t\t} else {\n\t\t\tkey = input;\n\t\t}\n\n\t\tlet keyCode = USER_SETTINGS.toKeyCode(key);\n\n\t\tlet result = 0;\n\t\tif (ctrlCmd) {\n\t\t\tresult |= KeyMod.CtrlCmd;\n\t\t}\n\t\tif (shift) {\n\t\t\tresult |= KeyMod.Shift;\n\t\t}\n\t\tif (alt) {\n\t\t\tresult |= KeyMod.Alt;\n\t\t}\n\t\tif (winCtrl) {\n\t\t\tresult |= KeyMod.WinCtrl;\n\t\t}\n\t\tresult |= keyCode;\n\t\treturn KeyMod.chord(result, chord);\n\t}\n\n\tpublic value:number;\n\n\tconstructor(keybinding:number) {\n\t\tthis.value = keybinding;\n\t}\n\n\tpublic hasCtrlCmd(): boolean {\n\t\treturn BinaryKeybindings.hasCtrlCmd(this.value);\n\t}\n\n\tpublic hasShift(): boolean {\n\t\treturn BinaryKeybindings.hasShift(this.value);\n\t}\n\n\tpublic hasAlt(): boolean {\n\t\treturn BinaryKeybindings.hasAlt(this.value);\n\t}\n\n\tpublic hasWinCtrl(): boolean {\n\t\treturn BinaryKeybindings.hasWinCtrl(this.value);\n\t}\n\n\tpublic extractKeyCode(): KeyCode {\n\t\treturn BinaryKeybindings.extractKeyCode(this.value);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tpublic _toUSLabel(Platform:ISimplifiedPlatform = defaultPlatform): string {\n\t\treturn Keybinding._toUSLabel(this.value, Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for placing in an aria-label.\n\t */\n\tpublic _toUSAriaLabel(Platform:ISimplifiedPlatform = defaultPlatform): string {\n\t\treturn Keybinding._toUSAriaLabel(this.value, Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tpublic _toUSHTMLLabel(Platform:ISimplifiedPlatform = defaultPlatform): IHTMLContentElement[] {\n\t\treturn Keybinding._toUSHTMLLabel(this.value, Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tpublic toCustomLabel(labelProvider:IKeyBindingLabelProvider, Platform:ISimplifiedPlatform = defaultPlatform): string {\n\t\treturn Keybinding._toCustomLabel(this.value, labelProvider, Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for rendering in the UI\n\t */\n\tpublic toCustomHTMLLabel(labelProvider:IKeyBindingLabelProvider, Platform:ISimplifiedPlatform = defaultPlatform): IHTMLContentElement[] {\n\t\treturn Keybinding._toCustomHTMLLabel(this.value, labelProvider, Platform);\n\t}\n\n\t/**\n\t * This prints the binding in a format suitable for electron's accelerators.\n\t * See https://github.com/electron/electron/blob/master/docs/api/accelerator.md\n\t */\n\tpublic _toElectronAccelerator(Platform:ISimplifiedPlatform = defaultPlatform): string {\n\t\treturn Keybinding._toElectronAccelerator(this.value, Platform);\n\t}\n\n\t/**\n\t * Format the binding to a format appropiate for the user settings file.\n\t */\n\tpublic toUserSettingsLabel(Platform:ISimplifiedPlatform = defaultPlatform): string {\n\t\treturn Keybinding.toUserSettingsLabel(this.value, Platform);\n\t}\n\n}\n\nexport interface IKeyBindingLabelProvider {\n\tctrlKeyLabel:string;\n\tshiftKeyLabel:string;\n\taltKeyLabel:string;\n\tcmdKeyLabel:string;\n\twindowsKeyLabel:string;\n\tmodifierSeparator:string;\n\tgetLabelForKey(keyCode:KeyCode): string;\n}\n\n/**\n * Print for Electron\n */\nexport class ElectronAcceleratorLabelProvider implements IKeyBindingLabelProvider {\n\tpublic static INSTANCE = new ElectronAcceleratorLabelProvider();\n\n\tpublic ctrlKeyLabel = 'Ctrl';\n\tpublic shiftKeyLabel = 'Shift';\n\tpublic altKeyLabel = 'Alt';\n\tpublic cmdKeyLabel = 'Cmd';\n\tpublic windowsKeyLabel = 'Super';\n\tpublic modifierSeparator = '+';\n\n\tpublic getLabelForKey(keyCode:KeyCode): string {\n\t\tswitch (keyCode) {\n\t\t\tcase KeyCode.UpArrow:\n\t\t\t\treturn 'Up';\n\t\t\tcase KeyCode.DownArrow:\n\t\t\t\treturn 'Down';\n\t\t\tcase KeyCode.LeftArrow:\n\t\t\t\treturn 'Left';\n\t\t\tcase KeyCode.RightArrow:\n\t\t\t\treturn 'Right';\n\t\t}\n\n\t\treturn KeyCode.toString(keyCode);\n\t}\n}\n\n/**\n * Print for Mac UI\n */\nexport class MacUIKeyLabelProvider implements IKeyBindingLabelProvider {\n\tpublic static INSTANCE = new MacUIKeyLabelProvider();\n\n\tprivate static leftArrowUnicodeLabel = String.fromCharCode(8592);\n\tprivate static upArrowUnicodeLabel = String.fromCharCode(8593);\n\tprivate static rightArrowUnicodeLabel = String.fromCharCode(8594);\n\tprivate static downArrowUnicodeLabel = String.fromCharCode(8595);\n\n\tpublic ctrlKeyLabel = '\\u2303';\n\tpublic shiftKeyLabel = '\\u21E7';\n\tpublic altKeyLabel = '\\u2325';\n\tpublic cmdKeyLabel = '\\u2318';\n\tpublic windowsKeyLabel = nls.localize('windowsKey', \"Windows\");\n\tpublic modifierSeparator = '';\n\n\tpublic getLabelForKey(keyCode:KeyCode): string {\n\t\tswitch (keyCode) {\n\t\t\tcase KeyCode.LeftArrow:\n\t\t\t\treturn MacUIKeyLabelProvider.leftArrowUnicodeLabel;\n\t\t\tcase KeyCode.UpArrow:\n\t\t\t\treturn MacUIKeyLabelProvider.upArrowUnicodeLabel;\n\t\t\tcase KeyCode.RightArrow:\n\t\t\t\treturn MacUIKeyLabelProvider.rightArrowUnicodeLabel;\n\t\t\tcase KeyCode.DownArrow:\n\t\t\t\treturn MacUIKeyLabelProvider.downArrowUnicodeLabel;\n\t\t}\n\n\t\treturn KeyCode.toString(keyCode);\n\t}\n}\n\n/**\n * Aria label provider for Mac.\n */\nexport class AriaKeyLabelProvider implements IKeyBindingLabelProvider {\n\tpublic static INSTANCE = new MacUIKeyLabelProvider();\n\n\tpublic ctrlKeyLabel = nls.localize('ctrlKey.long', \"Control\");\n\tpublic shiftKeyLabel = nls.localize('shiftKey.long', \"Shift\");\n\tpublic altKeyLabel = nls.localize('altKey.long', \"Alt\");\n\tpublic cmdKeyLabel = nls.localize('cmdKey.long', \"Command\");\n\tpublic windowsKeyLabel = nls.localize('windowsKey.long', \"Windows\");\n\tpublic modifierSeparator = '+';\n\n\tpublic getLabelForKey(keyCode:KeyCode): string {\n\t\treturn KeyCode.toString(keyCode);\n\t}\n}\n\n/**\n * Print for Windows, Linux UI\n */\nexport class ClassicUIKeyLabelProvider implements IKeyBindingLabelProvider {\n\tpublic static INSTANCE = new ClassicUIKeyLabelProvider();\n\n\tpublic ctrlKeyLabel = nls.localize('ctrlKey', \"Ctrl\");\n\tpublic shiftKeyLabel = nls.localize('shiftKey', \"Shift\");\n\tpublic altKeyLabel = nls.localize('altKey', \"Alt\");\n\tpublic cmdKeyLabel = nls.localize('cmdKey', \"Command\");\n\tpublic windowsKeyLabel = nls.localize('windowsKey', \"Windows\");\n\tpublic modifierSeparator = '+';\n\n\tpublic getLabelForKey(keyCode:KeyCode): string {\n\t\treturn KeyCode.toString(keyCode);\n\t}\n}\n\n/**\n * Print for the user settings file.\n */\nclass UserSettingsKeyLabelProvider implements IKeyBindingLabelProvider {\n\tpublic static INSTANCE = new UserSettingsKeyLabelProvider();\n\n\tpublic ctrlKeyLabel = 'Ctrl';\n\tpublic shiftKeyLabel = 'Shift';\n\tpublic altKeyLabel = 'Alt';\n\tpublic cmdKeyLabel = 'Meta';\n\tpublic windowsKeyLabel = 'Meta';\n\n\tpublic modifierSeparator = '+';\n\n\tpublic getLabelForKey(keyCode:KeyCode): string {\n\t\treturn USER_SETTINGS.fromKeyCode(keyCode);\n\t}\n}\n\nfunction _asString(keybinding:number, labelProvider:IKeyBindingLabelProvider, Platform:ISimplifiedPlatform): string {\n\tlet result:string[] = [],\n\t\tctrlCmd = BinaryKeybindings.hasCtrlCmd(keybinding),\n\t\tshift = BinaryKeybindings.hasShift(keybinding),\n\t\talt = BinaryKeybindings.hasAlt(keybinding),\n\t\twinCtrl = BinaryKeybindings.hasWinCtrl(keybinding),\n\t\tkeyCode = BinaryKeybindings.extractKeyCode(keybinding);\n\n\tlet keyLabel = labelProvider.getLabelForKey(keyCode);\n\tif (!keyLabel) {\n\t\t// cannot trigger this key code under this kb layout\n\t\treturn '';\n\t}\n\n\t// translate modifier keys: Ctrl-Shift-Alt-Meta\n\tif ((ctrlCmd && !Platform.isMacintosh) || (winCtrl && Platform.isMacintosh)) {\n\t\tresult.push(labelProvider.ctrlKeyLabel);\n\t}\n\n\tif (shift) {\n\t\tresult.push(labelProvider.shiftKeyLabel);\n\t}\n\n\tif (alt) {\n\t\tresult.push(labelProvider.altKeyLabel);\n\t}\n\n\tif (ctrlCmd && Platform.isMacintosh) {\n\t\tresult.push(labelProvider.cmdKeyLabel);\n\t}\n\n\tif (winCtrl && !Platform.isMacintosh) {\n\t\tresult.push(labelProvider.windowsKeyLabel);\n\t}\n\n\t// the actual key\n\tresult.push(keyLabel);\n\n\tvar actualResult = result.join(labelProvider.modifierSeparator);\n\n\tif (BinaryKeybindings.hasChord(keybinding)) {\n\t\treturn actualResult + ' ' + _asString(BinaryKeybindings.extractChordPart(keybinding), labelProvider, Platform);\n\t}\n\n\treturn actualResult;\n}\n\nfunction _pushKey(result:IHTMLContentElement[], str:string): void {\n\tif (result.length > 0) {\n\t\tresult.push({\n\t\t\ttagName: 'span',\n\t\t\ttext: '+'\n\t\t});\n\t}\n\tresult.push({\n\t\ttagName: 'span',\n\t\tclassName: 'monaco-kbkey',\n\t\ttext: str\n\t});\n}\n\nfunction _asHTML(keybinding:number, labelProvider:IKeyBindingLabelProvider, Platform:ISimplifiedPlatform, isChord:boolean = false): IHTMLContentElement[] {\n\tlet result:IHTMLContentElement[] = [],\n\t\tctrlCmd = BinaryKeybindings.hasCtrlCmd(keybinding),\n\t\tshift = BinaryKeybindings.hasShift(keybinding),\n\t\talt = BinaryKeybindings.hasAlt(keybinding),\n\t\twinCtrl = BinaryKeybindings.hasWinCtrl(keybinding),\n\t\tkeyCode = BinaryKeybindings.extractKeyCode(keybinding);\n\n\tlet keyLabel = labelProvider.getLabelForKey(keyCode);\n\tif (!keyLabel) {\n\t\t// cannot trigger this key code under this kb layout\n\t\treturn [];\n\t}\n\n\t// translate modifier keys: Ctrl-Shift-Alt-Meta\n\tif ((ctrlCmd && !Platform.isMacintosh) || (winCtrl && Platform.isMacintosh)) {\n\t\t_pushKey(result, labelProvider.ctrlKeyLabel);\n\t}\n\n\tif (shift) {\n\t\t_pushKey(result, labelProvider.shiftKeyLabel);\n\t}\n\n\tif (alt) {\n\t\t_pushKey(result, labelProvider.altKeyLabel);\n\t}\n\n\tif (ctrlCmd && Platform.isMacintosh) {\n\t\t_pushKey(result, labelProvider.cmdKeyLabel);\n\t}\n\n\tif (winCtrl && !Platform.isMacintosh) {\n\t\t_pushKey(result, labelProvider.windowsKeyLabel);\n\t}\n\n\t// the actual key\n\t_pushKey(result, keyLabel);\n\n\tlet chordTo: IHTMLContentElement[] = null;\n\n\tif (BinaryKeybindings.hasChord(keybinding)) {\n\t\tchordTo = _asHTML(BinaryKeybindings.extractChordPart(keybinding), labelProvider, Platform, true);\n\t\tresult.push({\n\t\t\ttagName: 'span',\n\t\t\ttext: ' '\n\t\t});\n\t\tresult = result.concat(chordTo);\n\t}\n\n\tif (isChord) {\n\t\treturn result;\n\t}\n\n\treturn [{\n\t\ttagName: 'span',\n\t\tclassName: 'monaco-kb',\n\t\tchildren: result\n\t}];\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n/*--------------------------------------------------------------------------------------------\n *  This file is based on or incorporates material from the projects listed below (Third Party IP).\n *  The original copyright notice and the license under which Microsoft received such Third Party IP,\n *  are set forth below. Such licenses and notices are provided for informational purposes only.\n *  Microsoft licenses the Third Party IP to you under the licensing terms for the Microsoft product.\n *  Microsoft reserves all other rights not expressly granted under this agreement, whether by implication,\n *  estoppel or otherwise.\n *--------------------------------------------------------------------------------------------*/\n/*---------------------------------------------------------------------------------------------\n *  Copyright  2015 W3C (MIT, ERCIM, Keio, Beihang). This software or document includes includes material copied\n *  from or derived from HTML 5.1 W3C Working Draft (http://www.w3.org/TR/2015/WD-html51-20151008/.)\"\n *--------------------------------------------------------------------------------------------*/\n/*---------------------------------------------------------------------------------------------\n *  Ionic Main Site (https://github.com/driftyco/ionic-site).\n *  Copyright Drifty Co. http://drifty.com/.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file\n *  except in compliance with the License. You may obtain a copy of the License at\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n *  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n *  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\n *  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\n *  MERCHANTABLITY OR NON-INFRINGEMENT.\n *\n *  See the Apache Version 2.0 License for specific language governing permissions\n *  and limitations under the License.\n *--------------------------------------------------------------------------------------------*/\n\nimport strings = require('vs/base/common/strings');\nimport nls = require('vs/nls');\n\nexport interface IHTMLTagProvider {\n\tcollectTags(collector: (tag: string, label: string) => void): void;\n\tcollectAttributes(tag: string, collector: (attribute: string, type: string) => void): void;\n\tcollectValues(tag: string, attribute: string, collector: (value: string) => void): void;\n}\n\nexport interface ITagSet {\n\t[tag: string]: HTMLTagSpecification;\n}\n\nexport class HTMLTagSpecification {\n\tconstructor(public label: string, public attributes: string[] = []) { }\n}\n\ninterface IValueSets {\n\t[tag: string]: string[];\n}\n\n// HTML tag information sourced from http://www.w3.org/TR/2015/WD-html51-20151008/\nexport const HTML_TAGS: ITagSet = {\n\t// The root element\n\thtml: new HTMLTagSpecification(\n\t\tnls.localize('tags.html', 'The html element represents the root of an HTML document.'),\n\t\t['manifest']),\n\t// Document metadata\n\thead: new HTMLTagSpecification(\n\t\tnls.localize('tags.head', 'The head element represents a collection of metadata for the Document.')),\n\ttitle: new HTMLTagSpecification(\n\t\tnls.localize('tags.title', 'The title element represents the document\\'s title or name. Authors should use titles that identify their documents even when they are used out of context, for example in a user\\'s history or bookmarks, or in search results. The document\\'s title is often different from its first heading, since the first heading does not have to stand alone when taken out of context.')),\n\tbase: new HTMLTagSpecification(\n\t\tnls.localize('tags.base', 'The base element allows authors to specify the document base URL for the purposes of resolving relative URLs, and the name of the default browsing context for the purposes of following hyperlinks. The element does not represent any content beyond this information.'),\n\t\t['href', 'target']),\n\tlink: new HTMLTagSpecification(\n\t\tnls.localize('tags.link', 'The link element allows authors to link their document to other resources.'),\n\t\t['href', 'crossorigin:xo', 'rel', 'media', 'hreflang', 'type', 'sizes']),\n\tmeta: new HTMLTagSpecification(\n\t\tnls.localize('tags.meta', 'The meta element represents various kinds of metadata that cannot be expressed using the title, base, link, style, and script elements.'),\n\t\t['name', 'http-equiv', 'content', 'charset']),\n\tstyle: new HTMLTagSpecification(\n\t\tnls.localize('tags.style', 'The style element allows authors to embed style information in their documents. The style element is one of several inputs to the styling processing model. The element does not represent content for the user.'),\n\t\t['media', 'nonce', 'type', 'scoped:v']),\n\t// Sections\n\tbody: new HTMLTagSpecification(\n\t\tnls.localize('tags.body', 'The body element represents the content of the document.'),\n\t\t['onafterprint', 'onbeforeprint', 'onbeforeunload', 'onhashchange', 'onlanguagechange', 'onmessage', 'onoffline', 'ononline', 'onpagehide', 'onpageshow', 'onpopstate', 'onstorage', 'onunload']),\n\tarticle: new HTMLTagSpecification(\n\t\tnls.localize('tags.article', 'The article element represents a complete, or self-contained, composition in a document, page, application, or site and that is, in principle, independently distributable or reusable, e.g. in syndication. This could be a forum post, a magazine or newspaper article, a blog entry, a user-submitted comment, an interactive widget or gadget, or any other independent item of content. Each article should be identified, typically by including a heading (h1h6 element) as a child of the article element.')),\n\tsection: new HTMLTagSpecification(\n\t\tnls.localize('tags.section', 'The section element represents a generic section of a document or application. A section, in this context, is a thematic grouping of content. Each section should be identified, typically by including a heading ( h1- h6 element) as a child of the section element.')),\n\tnav: new HTMLTagSpecification(\n\t\tnls.localize('tags.nav', 'The nav element represents a section of a page that links to other pages or to parts within the page: a section with navigation links.')),\n\taside: new HTMLTagSpecification(\n\t\tnls.localize('tags.aside', 'The aside element represents a section of a page that consists of content that is tangentially related to the content around the aside element, and which could be considered separate from that content. Such sections are often represented as sidebars in printed typography.')),\n\th1: new HTMLTagSpecification(\n\t\tnls.localize('tags.h1', 'The h1 element represents a section heading.')),\n\th2: new HTMLTagSpecification(\n\t\tnls.localize('tags.h2', 'The h2 element represents a section heading.')),\n\th3: new HTMLTagSpecification(\n\t\tnls.localize('tags.h3', 'The h3 element represents a section heading.')),\n\th4: new HTMLTagSpecification(\n\t\tnls.localize('tags.h4', 'The h4 element represents a section heading.')),\n\th5: new HTMLTagSpecification(\n\t\tnls.localize('tags.h5', 'The h5 element represents a section heading.')),\n\th6: new HTMLTagSpecification(\n\t\tnls.localize('tags.h6', 'The h6 element represents a section heading.')),\n\theader: new HTMLTagSpecification(\n\t\tnls.localize('tags.header', 'The header element represents introductory content for its nearest ancestor sectioning content or sectioning root element. A header typically contains a group of introductory or navigational aids. When the nearest ancestor sectioning content or sectioning root element is the body element, then it applies to the whole page.')),\n\tfooter: new HTMLTagSpecification(\n\t\tnls.localize('tags.footer', 'The footer element represents a footer for its nearest ancestor sectioning content or sectioning root element. A footer typically contains information about its section such as who wrote it, links to related documents, copyright data, and the like.')),\n\taddress: new HTMLTagSpecification(\n\t\tnls.localize('tags.address', 'The address element represents the contact information for its nearest article or body element ancestor. If that is the body element, then the contact information applies to the document as a whole.')),\n\t// Grouping content\n\tp: new HTMLTagSpecification(\n\t\tnls.localize('tags.p', 'The p element represents a paragraph.')),\n\thr: new HTMLTagSpecification(\n\t\tnls.localize('tags.hr', 'The hr element represents a paragraph-level thematic break, e.g. a scene change in a story, or a transition to another topic within a section of a reference book.')),\n\tpre: new HTMLTagSpecification(\n\t\tnls.localize('tags.pre', 'The pre element represents a block of preformatted text, in which structure is represented by typographic conventions rather than by elements.')),\n\tblockquote: new HTMLTagSpecification(\n\t\tnls.localize('tags.blockquote', 'The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a footer or cite element, and optionally with in-line changes such as annotations and abbreviations.'),\n\t\t['cite']),\n\tol: new HTMLTagSpecification(\n\t\tnls.localize('tags.ol', 'The ol element represents a list of items, where the items have been intentionally ordered, such that changing the order would change the meaning of the document.'),\n\t\t['reversed:v', 'start', 'type:lt']),\n\tul: new HTMLTagSpecification(\n\t\tnls.localize('tags.ul', 'The ul element represents a list of items, where the order of the items is not important  that is, where changing the order would not materially change the meaning of the document.')),\n\tli: new HTMLTagSpecification(\n\t\tnls.localize('tags.li', 'The li element represents a list item. If its parent element is an ol, ul, or menu element, then the element is an item of the parent element\\'s list, as defined for those elements. Otherwise, the list item has no defined list-related relationship to any other li element.'),\n\t\t['value']),\n\tdl: new HTMLTagSpecification(\n\t\tnls.localize('tags.dl', 'The dl element represents an association list consisting of zero or more name-value groups (a description list). A name-value group consists of one or more names (dt elements) followed by one or more values (dd elements), ignoring any nodes other than dt and dd elements. Within a single dl element, there should not be more than one dt element for each name.')),\n\tdt: new HTMLTagSpecification(\n\t\tnls.localize('tags.dt', 'The dt element represents the term, or name, part of a term-description group in a description list (dl element).')),\n\tdd: new HTMLTagSpecification(\n\t\tnls.localize('tags.dd', 'The dd element represents the description, definition, or value, part of a term-description group in a description list (dl element).')),\n\tfigure: new HTMLTagSpecification(\n\t\tnls.localize('tags.figure', 'The figure element represents some flow content, optionally with a caption, that is self-contained (like a complete sentence) and is typically referenced as a single unit from the main flow of the document.')),\n\tfigcaption: new HTMLTagSpecification(\n\t\tnls.localize('tags.figcaption', 'The figcaption element represents a caption or legend for the rest of the contents of the figcaption element\\'s parent figure element, if any.')),\n\tmain: new HTMLTagSpecification(\n\t\tnls.localize('tags.main', 'The main element represents the main content of the body of a document or application. The main content area consists of content that is directly related to or expands upon the central topic of a document or central functionality of an application.')),\n\tdiv: new HTMLTagSpecification(\n\t\tnls.localize('tags.div', 'The div element has no special meaning at all. It represents its children. It can be used with the class, lang, and title attributes to mark up semantics common to a group of consecutive elements.')),\n\t// Text-level semantics\n\ta: new HTMLTagSpecification(\n\t\tnls.localize('tags.a', 'If the a element has an href attribute, then it represents a hyperlink (a hypertext anchor) labeled by its contents.'),\n\t\t['href', 'target', 'download', 'ping', 'rel', 'hreflang', 'type']),\n\tem: new HTMLTagSpecification(\n\t\tnls.localize('tags.em', 'The em element represents stress emphasis of its contents.')),\n\tstrong: new HTMLTagSpecification(\n\t\tnls.localize('tags.strong', 'The strong element represents strong importance, seriousness, or urgency for its contents.')),\n\tsmall: new HTMLTagSpecification(\n\t\tnls.localize('tags.small', 'The small element represents side comments such as small print.')),\n\ts: new HTMLTagSpecification(\n\t\tnls.localize('tags.s', 'The s element represents contents that are no longer accurate or no longer relevant.')),\n\tcite: new HTMLTagSpecification(\n\t\tnls.localize('tags.cite', 'The cite element represents a reference to a creative work. It must include the title of the work or the name of the author(person, people or organization) or an URL reference, or a reference in abbreviated form as per the conventions used for the addition of citation metadata.')),\n\tq: new HTMLTagSpecification(\n\t\tnls.localize('tags.q', 'The q element represents some phrasing content quoted from another source.'),\n\t\t['cite']),\n\tdfn: new HTMLTagSpecification(\n\t\tnls.localize('tags.dfn', 'The dfn element represents the defining instance of a term. The paragraph, description list group, or section that is the nearest ancestor of the dfn element must also contain the definition(s) for the term given by the dfn element.')),\n\tabbr: new HTMLTagSpecification(\n\t\tnls.localize('tags.abbr', 'The abbr element represents an abbreviation or acronym, optionally with its expansion. The title attribute may be used to provide an expansion of the abbreviation. The attribute, if specified, must contain an expansion of the abbreviation, and nothing else.')),\n\truby: new HTMLTagSpecification(\n\t\tnls.localize('tags.ruby', 'The ruby element allows one or more spans of phrasing content to be marked with ruby annotations. Ruby annotations are short runs of text presented alongside base text, primarily used in East Asian typography as a guide for pronunciation or to include other annotations. In Japanese, this form of typography is also known as furigana. Ruby text can appear on either side, and sometimes both sides, of the base text, and it is possible to control its position using CSS. A more complete introduction to ruby can be found in the Use Cases & Exploratory Approaches for Ruby Markup document as well as in CSS Ruby Module Level 1. [RUBY-UC] [CSSRUBY]')),\n\trb: new HTMLTagSpecification(\n\t\tnls.localize('tags.rb', 'The rb element marks the base text component of a ruby annotation. When it is the child of a ruby element, it doesn\\'t represent anything itself, but its parent ruby element uses it as part of determining what it represents.')),\n\trt: new HTMLTagSpecification(\n\t\tnls.localize('tags.rt', 'The rt element marks the ruby text component of a ruby annotation. When it is the child of a ruby element or of an rtc element that is itself the child of a ruby element, it doesn\\'t represent anything itself, but its ancestor ruby element uses it as part of determining what it represents.')),\n\t// <rtc> is not yet supported by 2+ browsers\n\t//rtc: new HTMLTagSpecification(\n\t//\tnls.localize('tags.rtc', 'The rtc element marks a ruby text container for ruby text components in a ruby annotation. When it is the child of a ruby element it doesn\\'t represent anything itself, but its parent ruby element uses it as part of determining what it represents.')),\n\trp: new HTMLTagSpecification(\n\t\tnls.localize('tags.rp', 'The rp element is used to provide fallback text to be shown by user agents that don\\'t support ruby annotations. One widespread convention is to provide parentheses around the ruby text component of a ruby annotation.')),\n\t// <data> is not yet supported by 2+ browsers\n\t//data: new HTMLTagSpecification(\n\t//\tnls.localize('tags.data', 'The data element represents its contents, along with a machine-readable form of those contents in the value attribute.')),\n\ttime: new HTMLTagSpecification(\n\t\tnls.localize('tags.time', 'The time element represents its contents, along with a machine-readable form of those contents in the datetime attribute. The kind of content is limited to various kinds of dates, times, time-zone offsets, and durations, as described below.'),\n\t\t['datetime']),\n\tcode: new HTMLTagSpecification(\n\t\tnls.localize('tags.code', 'The code element represents a fragment of computer code. This could be an XML element name, a file name, a computer program, or any other string that a computer would recognize.')),\n\tvar: new HTMLTagSpecification(\n\t\tnls.localize('tags.var', 'The var element represents a variable. This could be an actual variable in a mathematical expression or programming context, an identifier representing a constant, a symbol identifying a physical quantity, a function parameter, or just be a term used as a placeholder in prose.')),\n\tsamp: new HTMLTagSpecification(\n\t\tnls.localize('tags.samp', 'The samp element represents sample or quoted output from another program or computing system.')),\n\tkbd: new HTMLTagSpecification(\n\t\tnls.localize('tags.kbd', 'The kbd element represents user input (typically keyboard input, although it may also be used to represent other input, such as voice commands).')),\n\tsub: new HTMLTagSpecification(\n\t\tnls.localize('tags.sub', 'The sub element represents a subscript.')),\n\tsup: new HTMLTagSpecification(\n\t\tnls.localize('tags.sup', 'The sup element represents a superscript.')),\n\ti: new HTMLTagSpecification(\n\t\tnls.localize('tags.i', 'The i element represents a span of text in an alternate voice or mood, or otherwise offset from the normal prose in a manner indicating a different quality of text, such as a taxonomic designation, a technical term, an idiomatic phrase from another language, transliteration, a thought, or a ship name in Western texts.')),\n\tb: new HTMLTagSpecification(\n\t\tnls.localize('tags.b', 'The b element represents a span of text to which attention is being drawn for utilitarian purposes without conveying any extra importance and with no implication of an alternate voice or mood, such as key words in a document abstract, product names in a review, actionable words in interactive text-driven software, or an article lede.')),\n\tu: new HTMLTagSpecification(\n\t\tnls.localize('tags.u', 'The u element represents a span of text with an unarticulated, though explicitly rendered, non-textual annotation, such as labeling the text as being a proper name in Chinese text (a Chinese proper name mark), or labeling the text as being misspelt.')),\n\tmark: new HTMLTagSpecification(\n\t\tnls.localize('tags.mark', 'The mark element represents a run of text in one document marked or highlighted for reference purposes, due to its relevance in another context. When used in a quotation or other block of text referred to from the prose, it indicates a highlight that was not originally present but which has been added to bring the reader\\'s attention to a part of the text that might not have been considered important by the original author when the block was originally written, but which is now under previously unexpected scrutiny. When used in the main prose of a document, it indicates a part of the document that has been highlighted due to its likely relevance to the user\\'s current activity.')),\n\tbdi: new HTMLTagSpecification(\n\t\tnls.localize('tags.bdi', 'The bdi element represents a span of text that is to be isolated from its surroundings for the purposes of bidirectional text formatting. [BIDI]')),\n\tbdo: new HTMLTagSpecification(\n\t\tnls.localize('tags.dbo', 'The bdo element represents explicit text directionality formatting control for its children. It allows authors to override the Unicode bidirectional algorithm by explicitly specifying a direction override. [BIDI]')),\n\tspan: new HTMLTagSpecification(\n\t\tnls.localize('tags.span', 'The span element doesn\\'t mean anything on its own, but can be useful when used together with the global attributes, e.g. class, lang, or dir. It represents its children.')),\n\tbr: new HTMLTagSpecification(\n\t\tnls.localize('tags.br', 'The br element represents a line break.')),\n\twbr: new HTMLTagSpecification(\n\t\tnls.localize('tags.wbr', 'The wbr element represents a line break opportunity.')),\n\t// Edits\n\tins: new HTMLTagSpecification(\n\t\tnls.localize('tags.ins', 'The ins element represents an addition to the document.')),\n\tdel: new HTMLTagSpecification(\n\t\tnls.localize('tags.del', 'The del element represents a removal from the document.'),\n\t\t['cite', 'datetime']),\n\t// Embedded content\n\tpicture: new HTMLTagSpecification(\n\t\tnls.localize('tags.picture', 'The picture element is a container which provides multiple sources to its contained img element to allow authors to declaratively control or give hints to the user agent about which image resource to use, based on the screen pixel density, viewport size, image format, and other factors. It represents its children.')),\n\timg: new HTMLTagSpecification(\n\t\tnls.localize('tags.img', 'An img element represents an image.'),\n\t\t['alt', 'src', 'srcset', 'crossorigin:xo', 'usemap', 'ismap:v', 'width', 'height']),\n\tiframe: new HTMLTagSpecification(\n\t\tnls.localize('tags.iframe', 'The iframe element represents a nested browsing context.'),\n\t\t['src', 'srcdoc', 'name', 'sandbox:sb', 'seamless:v', 'allowfullscreen:v', 'width', 'height']),\n\tembed: new HTMLTagSpecification(\n\t\tnls.localize('tags.embed', 'The embed element provides an integration point for an external (typically non-HTML) application or interactive content.'),\n\t\t['src', 'type', 'width', 'height']),\n\tobject: new HTMLTagSpecification(\n\t\tnls.localize('tags.object', 'The object element can represent an external resource, which, depending on the type of the resource, will either be treated as an image, as a nested browsing context, or as an external resource to be processed by a plugin.'),\n\t\t['data', 'type', 'typemustmatch:v', 'name', 'usemap', 'form', 'width', 'height']),\n\tparam: new HTMLTagSpecification(\n\t\tnls.localize('tags.param', 'The param element defines parameters for plugins invoked by object elements. It does not represent anything on its own.'),\n\t\t['name', 'value']),\n\tvideo: new HTMLTagSpecification(\n\t\tnls.localize('tags.video', 'A video element is used for playing videos or movies, and audio files with captions.'),\n\t\t['src', 'crossorigin:xo', 'poster', 'preload:pl', 'autoplay:v', 'mediagroup', 'loop:v', 'muted:v', 'controls:v', 'width', 'height']),\n\taudio: new HTMLTagSpecification(\n\t\tnls.localize('tags.audio', 'An audio element represents a sound or audio stream.'),\n\t\t['src', 'crossorigin:xo', 'preload:pl', 'autoplay:v', 'mediagroup', 'loop:v', 'muted:v', 'controls:v']),\n\tsource: new HTMLTagSpecification(\n\t\tnls.localize('tags.source', 'The source element allows authors to specify multiple alternative media resources for media elements. It does not represent anything on its own.'),\n\t\t// 'When the source element has a parent that is a picture element, the source element allows authors to specify multiple alternative source sets for img elements.'\n\t\t['src', 'type']),\n\ttrack: new HTMLTagSpecification(\n\t\tnls.localize('tags.track', 'The track element allows authors to specify explicit external timed text tracks for media elements. It does not represent anything on its own.'),\n\t\t['default:v', 'kind:tk', 'label', 'src', 'srclang']),\n\tmap: new HTMLTagSpecification(\n\t\tnls.localize('tags.map', 'The map element, in conjunction with an img element and any area element descendants, defines an image map. The element represents its children.'),\n\t\t['name']),\n\tarea: new HTMLTagSpecification(\n\t\tnls.localize('tags.area', 'The area element represents either a hyperlink with some text and a corresponding area on an image map, or a dead area on an image map.'),\n\t\t['alt', 'coords', 'shape:sh', 'href', 'target', 'download', 'ping', 'rel', 'hreflang', 'type']),\n\t// Tabular data\n\ttable: new HTMLTagSpecification(\n\t\tnls.localize('tags.table', 'The table element represents data with more than one dimension, in the form of a table.'),\n\t\t['sortable:v', 'border']),\n\tcaption: new HTMLTagSpecification(\n\t\tnls.localize('tags.caption', 'The caption element represents the title of the table that is its parent, if it has a parent and that is a table element.')),\n\tcolgroup: new HTMLTagSpecification(\n\t\tnls.localize('tags.colgroup', 'The colgroup element represents a group of one or more columns in the table that is its parent, if it has a parent and that is a table element.'),\n\t\t['span']),\n\tcol: new HTMLTagSpecification(\n\t\tnls.localize('tags.col', 'If a col element has a parent and that is a colgroup element that itself has a parent that is a table element, then the col element represents one or more columns in the column group represented by that colgroup.'),\n\t\t['span']),\n\ttbody: new HTMLTagSpecification(\n\t\tnls.localize('tags.tbody', 'The tbody element represents a block of rows that consist of a body of data for the parent table element, if the tbody element has a parent and it is a table.')),\n\tthead: new HTMLTagSpecification(\n\t\tnls.localize('tags.thead', 'The thead element represents the block of rows that consist of the column labels (headers) for the parent table element, if the thead element has a parent and it is a table.')),\n\ttfoot: new HTMLTagSpecification(\n\t\tnls.localize('tags.tfoot', 'The tfoot element represents the block of rows that consist of the column summaries (footers) for the parent table element, if the tfoot element has a parent and it is a table.')),\n\ttr: new HTMLTagSpecification(\n\t\tnls.localize('tags.tr', 'The tr element represents a row of cells in a table.')),\n\ttd: new HTMLTagSpecification(\n\t\tnls.localize('tags.td', 'The td element represents a data cell in a table.'),\n\t\t['colspan', 'rowspan', 'headers']),\n\tth: new HTMLTagSpecification(\n\t\tnls.localize('tags.th', 'The th element represents a header cell in a table.'),\n\t\t['colspan', 'rowspan', 'headers', 'scope:s', 'sorted', 'abbr']),\n\t// Forms\n\tform: new HTMLTagSpecification(\n\t\tnls.localize('tags.form', 'The form element represents a collection of form-associated elements, some of which can represent editable values that can be submitted to a server for processing.'),\n\t\t['accept-charset', 'action', 'autocomplete:o', 'enctype:et', 'method:m', 'name', 'novalidate:v', 'target']),\n\tlabel: new HTMLTagSpecification(\n\t\tnls.localize('tags.label', 'The label element represents a caption in a user interface. The caption can be associated with a specific form control, known as the label element\\'s labeled control, either using the for attribute, or by putting the form control inside the label element itself.'),\n\t\t['form', 'for']),\n\tinput: new HTMLTagSpecification(\n\t\tnls.localize('tags.input', 'The input element represents a typed data field, usually with a form control to allow the user to edit the data.'),\n\t\t['accept', 'alt', 'autocomplete:o', 'autofocus:v', 'checked:v', 'dirname', 'disabled:v', 'form', 'formaction', 'formenctype:et', 'formmethod:fm', 'formnovalidate:v', 'formtarget', 'height', 'inputmode:im', 'list', 'max', 'maxlength', 'min', 'minlength', 'multiple:v', 'name', 'pattern', 'placeholder', 'readonly:v', 'required:v', 'size', 'src', 'step', 'type:t', 'value', 'width']),\n\tbutton: new HTMLTagSpecification(\n\t\tnls.localize('tags.button', 'The button element represents a button labeled by its contents.'),\n\t\t['autofocus:v', 'disabled:v', 'form', 'formaction', 'formenctype:et', 'formmethod:fm', 'formnovalidate:v', 'formtarget', 'name', 'type:bt', 'value']),\n\tselect: new HTMLTagSpecification(\n\t\tnls.localize('tags.select', 'The select element represents a control for selecting amongst a set of options.'),\n\t\t['autocomplete:o', 'autofocus:v', 'disabled:v', 'form', 'multiple:v', 'name', 'required:v', 'size']),\n\tdatalist: new HTMLTagSpecification(\n\t\tnls.localize('tags.datalist', 'The datalist element represents a set of option elements that represent predefined options for other controls. In the rendering, the datalist element represents nothing and it, along with its children, should be hidden.')),\n\toptgroup: new HTMLTagSpecification(\n\t\tnls.localize('tags.optgroup', 'The optgroup element represents a group of option elements with a common label.'),\n\t\t['disabled:v', 'label']),\n\toption: new HTMLTagSpecification(\n\t\tnls.localize('tags.option', 'The option element represents an option in a select element or as part of a list of suggestions in a datalist element.'),\n\t\t['disabled:v', 'label', 'selected:v', 'value']),\n\ttextarea: new HTMLTagSpecification(\n\t\tnls.localize('tags.textarea', 'The textarea element represents a multiline plain text edit control for the element\\'s raw value. The contents of the control represent the control\\'s default value.'),\n\t\t['autocomplete:o', 'autofocus:v', 'cols', 'dirname', 'disabled:v', 'form', 'inputmode:im', 'maxlength', 'minlength', 'name', 'placeholder', 'readonly:v', 'required:v', 'rows', 'wrap:w']),\n\toutput: new HTMLTagSpecification(\n\t\tnls.localize('tags.output', 'The output element represents the result of a calculation performed by the application, or the result of a user action.'),\n\t\t['for', 'form', 'name']),\n\tprogress: new HTMLTagSpecification(\n\t\tnls.localize('tags.progress', 'The progress element represents the completion progress of a task. The progress is either indeterminate, indicating that progress is being made but that it is not clear how much more work remains to be done before the task is complete (e.g. because the task is waiting for a remote host to respond), or the progress is a number in the range zero to a maximum, giving the fraction of work that has so far been completed.'),\n\t\t['value', 'max']),\n\tmeter: new HTMLTagSpecification(\n\t\tnls.localize('tags.meter', 'The meter element represents a scalar measurement within a known range, or a fractional value; for example disk usage, the relevance of a query result, or the fraction of a voting population to have selected a particular candidate.'),\n\t\t['value', 'min', 'max', 'low', 'high', 'optimum']),\n\tfieldset: new HTMLTagSpecification(\n\t\tnls.localize('tags.fieldset', 'The fieldset element represents a set of form controls optionally grouped under a common name.'),\n\t\t['disabled:v', 'form', 'name']),\n\tlegend: new HTMLTagSpecification(\n\t\tnls.localize('tags.legend', 'The legend element represents a caption for the rest of the contents of the legend element\\'s parent fieldset element, if any.')),\n\t// Interactive elements\n\tdetails: new HTMLTagSpecification(\n\t\tnls.localize('tags.details', 'The details element represents a disclosure widget from which the user can obtain additional information or controls.'),\n\t\t['open:v']),\n\tsummary: new HTMLTagSpecification(\n\t\tnls.localize('tags.summary', 'The summary element represents a summary, caption, or legend for the rest of the contents of the summary element\\'s parent details element, if any.')),\n\t// <menu> and <menuitem> are not yet supported by 2+ browsers\n\t//menu: new HTMLTagSpecification(\n\t//\tnls.localize('tags.menu', 'The menu element represents a list of commands.'),\n\t//\t['type:mt', 'label']),\n\t//menuitem: new HTMLTagSpecification(\n\t//\tnls.localize('tags.menuitem', 'The menuitem element represents a command that the user can invoke from a popup menu (either a context menu or the menu of a menu button).')),\n\tdialog: new HTMLTagSpecification(\n\t\tnls.localize('tags.dialog', 'The dialog element represents a part of an application that a user interacts with to perform a task, for example a dialog box, inspector, or window.')),\n\t// Scripting\n\tscript: new HTMLTagSpecification(\n\t\tnls.localize('tags.script', 'The script element allows authors to include dynamic script and data blocks in their documents. The element does not represent content for the user.'),\n\t\t['src', 'type', 'charset', 'async:v', 'defer:v', 'crossorigin:xo', 'nonce']),\n\tnoscript: new HTMLTagSpecification(\n\t\tnls.localize('tags.noscript', 'The noscript element represents nothing if scripting is enabled, and represents its children if scripting is disabled. It is used to present different markup to user agents that support scripting and those that don\\'t support scripting, by affecting how the document is parsed.')),\n\ttemplate: new HTMLTagSpecification(\n\t\tnls.localize('tags.template', 'The template element is used to declare fragments of HTML that can be cloned and inserted in the document by script.')),\n\tcanvas: new HTMLTagSpecification(\n\t\tnls.localize('tags.canvas', 'The canvas element provides scripts with a resolution-dependent bitmap canvas, which can be used for rendering graphs, game graphics, art, or other visual images on the fly.'),\n\t\t['width', 'height'])\n};\n\n// Ionic tag information sourced from Ionic main website (https://github.com/driftyco/ionic-site)\nexport const IONIC_TAGS: ITagSet = {\n\t'ion-checkbox': new HTMLTagSpecification(nls.localize('tags.ion.checkbox', 'The checkbox is no different than the HTML checkbox input, except it\\'s styled differently. The checkbox behaves like any AngularJS checkbox.'),\n\t\t['name', 'ng-false-value', 'ng-model', 'ng-true-value']),\n\t'ion-content': new HTMLTagSpecification(nls.localize('tags.ion.content', 'The ionContent directive provides an easy to use content area that can be configured to use Ionic\\'s custom Scroll View, or the built-in overflow scrolling of the browser.'),\n\t\t['delegate-handle', 'direction:scrolldir', 'has-bouncing:b', 'locking:b', 'on-scroll', 'on-scroll-complete', 'overflow-scroll:b', 'padding:b', 'scroll:b', 'scrollbar-x:b', 'scrollbar-y:b', 'start-x', 'start-y']),\n\t'ion-delete-button': new HTMLTagSpecification(nls.localize('tags.ion.deletebutton', 'Child of ionItem'),\n\t\t[]),\n\t'ion-footer-bar': new HTMLTagSpecification(nls.localize('tags.ion.footerbar', 'Adds a fixed footer bar below some content. Can also be a subfooter (higher up) if the \"bar-subfooter\" class is applied.'),\n\t\t['align-title:align', 'keyboard-attach:v']),\n\t'ion-header-bar': new HTMLTagSpecification(nls.localize('tags.ion.headerbar', 'Adds a fixed header bar above some content. Can also be a subheader (lower down) if the \"bar-subheader\" class is applied.'),\n\t\t['align-title:align', 'no-tap-scroll:b']),\n\t'ion-infinite-scroll': new HTMLTagSpecification(nls.localize('tags.ion.infinitescroll', 'Child of ionContent or ionScroll. The ionInfiniteScroll directive allows you to call a function whenever the user gets to the bottom of the page or near the bottom of the page.'),\n\t\t['distance', 'icon', 'immediate-check:b', 'on-infinite', 'spinner']),\n\t'ion-input': new HTMLTagSpecification(nls.localize('tags.ion.input', 'ionInput is meant for text type inputs only. Ionic uses an actual <input type=\"text\"> HTML element within the component, with Ionic wrapping to better handle the user experience and interactivity.'),\n\t\t['type:inputtype', 'clearInput:v']),\n\t'ion-item': new HTMLTagSpecification(nls.localize('tags.ion.item', 'Child of ionList.'),\n\t\t[]),\n\t'ion-list': new HTMLTagSpecification(nls.localize('tags.ion.list', 'The List is a widely used interface element in almost any mobile app, and can include content ranging from basic text all the way to buttons, toggles, icons, and thumbnails.'),\n\t\t['can-swipe:b', 'delegate-handle', 'show-delete:b', 'show-reorder:b', 'type:listtype']),\n\t'ion-modal-view': new HTMLTagSpecification(nls.localize('tags.ion.modalview', 'The Modal is a content pane that can go over the user\\'s main view temporarily. Usually used for making a choice or editing an item.'),\n\t\t[]),\n\t'ion-nav-back-button': new HTMLTagSpecification(nls.localize('tags.ion.navbackbutton', 'Child of ionNavBar. Creates a back button inside an ionNavBar. The back button will appear when the user is able to go back in the current navigation stack.'),\n\t\t[]),\n\t'ion-nav-bar': new HTMLTagSpecification(nls.localize('tags.ion.navbar', 'If you have an ionNavView directive, you can also create an <ion-nav-bar>, which will create a topbar that updates as the application state changes.'),\n\t\t['align-title:align', 'delegate-handle', 'no-tap-scroll:b']),\n\t'ion-nav-buttons': new HTMLTagSpecification(nls.localize('tags.ion.navbuttons', 'Child of ionNavView. Use ionNavButtons to set the buttons on your ionNavBar from within an ionView.'),\n\t\t['side:navsides']),\n\t'ion-nav-title': new HTMLTagSpecification(nls.localize('tags.ion.navtitle', 'Child of ionNavView. The ionNavTitle directive replaces an ionNavBar title text with custom HTML from within an ionView template.'),\n\t\t[]),\n\t'ion-nav-view': new HTMLTagSpecification(nls.localize('tags.ion.navview', 'The ionNavView directive is used to render templates in your application. Each template is part of a state. States are usually mapped to a url, and are defined programatically using angular-ui-router.'),\n\t\t['name']),\n\t'ion-option-button': new HTMLTagSpecification(nls.localize('tags.ion.optionbutton', 'Child of ionItem. Creates an option button inside a list item, that is visible when the item is swiped to the left by the user.'),\n\t\t[]),\n\t'ion-pane': new HTMLTagSpecification(nls.localize('tags.ion.pane', 'A simple container that fits content, with no side effects. Adds the \"pane\" class to the element.'),\n\t\t[]),\n\t'ion-popover-view': new HTMLTagSpecification(nls.localize('tags.ion.popoverview', 'The Popover is a view that floats above an app\\'s content. Popovers provide an easy way to present or gather information from the user.'),\n\t\t[]),\n\t'ion-radio': new HTMLTagSpecification(nls.localize('tags.ion.radio', 'The radio ionRirective is no different than the HTML radio input, except it\\'s styled differently. The ionRadio behaves like AngularJS radio input.'),\n\t\t['disabled:b', 'icon', 'name', 'ng-disabled:b', 'ng-model', 'ng-value', 'value']),\n\t'ion-refresher': new HTMLTagSpecification(nls.localize('tags.ion.refresher', 'Child of ionContent or ionScroll. Allows you to add pull-to-refresh to a scrollView. Place it as the first child of your ionContent or ionScroll element.'),\n\t\t['disable-pulling-rotation:b', 'on-pulling', 'on-refresh', 'pulling-icon', 'pulling-text', 'refreshing-icon', 'spinner']),\n\t'ion-reorder-button': new HTMLTagSpecification(nls.localize('tags.ion.reorderbutton', 'Child of ionItem.'),\n\t\t['on-reorder']),\n\t'ion-scroll': new HTMLTagSpecification(nls.localize('tags.ion.scroll', 'Creates a scrollable container for all content inside.'),\n\t\t['delegate-handle', 'direction:scrolldir', 'has-bouncing:b', 'locking:b', 'max-zoom', 'min-zoom', 'on-refresh', 'on-scroll', 'paging:b', 'scrollbar-x:b', 'scrollbar-y:b', 'zooming:b']),\n\t'ion-side-menu': new HTMLTagSpecification(nls.localize('tags.ion.sidemenu', 'Child of ionSideMenus. A container for a side menu, sibling to an ionSideMenuContent directive.'),\n\t\t['is-enabled:b', 'expose-aside-when', 'side:navsides', 'width']),\n\t'ion-side-menu-content': new HTMLTagSpecification(nls.localize('tags.ion.sidemenucontent', 'Child of ionSideMenus. A container for the main visible content, sibling to one or more ionSideMenu directives.'),\n\t\t['drag-content:b', 'edge-drag-threshold']),\n\t'ion-side-menus': new HTMLTagSpecification(nls.localize('tags.ion.sidemenus', 'A container element for side menu(s) and the main content. Allows the left and/or right side menu to be toggled by dragging the main content area side to side.'),\n\t\t['delegate-handle', 'enable-menu-with-back-views:b']),\n\t'ion-slide': new HTMLTagSpecification(nls.localize('tags.ion.slide', 'Child of ionSlideBox. Displays a slide inside of a slidebox.'),\n\t\t[]),\n\t'ion-slide-box': new HTMLTagSpecification(nls.localize('tags.ion.slidebox', 'The Slide Box is a multi-page container where each page can be swiped or dragged between.'),\n\t\t['active-slide', 'auto-play:b', 'delegate-handle', 'does-continue:b', 'on-slide-changed', 'pager-click', 'show-pager:b', 'slide-interval']),\n\t'ion-spinner': new HTMLTagSpecification(nls.localize('tags.ion.spinner', 'The ionSpinner directive provides a variety of animated spinners.'),\n\t\t['icon']),\n\t'ion-tab': new HTMLTagSpecification(nls.localize('tags.ion.tab', 'Child of ionTabs. Contains a tab\\'s content. The content only exists while the given tab is selected.'),\n\t\t['badge', 'badge-style', 'disabled', 'hidden', 'href', 'icon', 'icon-off', 'icon-on', 'ng-click', 'on-deselect', 'on-select', 'title']),\n\t'ion-tabs': new HTMLTagSpecification(nls.localize('tags.ion.tabs', 'Powers a multi-tabbed interface with a tab bar and a set of \"pages\" that can be tabbed through.'),\n\t\t['delegate-handle']),\n\t'ion-title': new HTMLTagSpecification(nls.localize('tags.ion.title', 'ion-title is a component that sets the title of the ionNavbar'),\n\t\t[]),\n\t'ion-toggle': new HTMLTagSpecification(nls.localize('tags.ion.toggle', 'A toggle is an animated switch which binds a given model to a boolean. Allows dragging of the switch\\'s nub. The toggle behaves like any AngularJS checkbox otherwise.'),\n\t\t['name', 'ng-false-value', 'ng-model', 'ng-true-value', 'toggle-class']),\n\t'ion-view ': new HTMLTagSpecification(nls.localize('tags.ion.view', 'Child of ionNavView. A container for view content and any navigational and header bar information.'),\n\t\t['cache-view:b', 'can-swipe-back:b', 'hide-back-button:b', 'hide-nav-bar:b', 'view-title'])\n};\n\nexport function getHTML5TagProvider(): IHTMLTagProvider {\n\tvar globalAttributes = [\n\t\t'aria-activedescendant', 'aria-atomic:b', 'aria-autocomplete:autocomplete', 'aria-busy:b', 'aria-checked:tristate', 'aria-colcount', 'aria-colindex', 'aria-colspan', 'aria-controls', 'aria-current:current', 'aria-describedat',\n\t\t'aria-describedby', 'aria-disabled:b', 'aria-dropeffect:dropeffect', 'aria-errormessage', 'aria-expanded:u', 'aria-flowto', 'aria-grabbed:u', 'aria-haspopup:b', 'aria-hidden:b', 'aria-invalid:invalid', 'aria-kbdshortcuts',\n\t\t'aria-label', 'aria-labelledby', 'aria-level', 'aria-live:live', 'aria-modal:b', 'aria-multiline:b', 'aria-multiselectable:b', 'aria-orientation:orientation', 'aria-owns', 'aria-placeholder', 'aria-posinset', 'aria-pressed:tristate',\n\t\t'aria-readonly:b', 'aria-relevant:relevant', 'aria-required:b', 'aria-roledescription', 'aria-rowcount', 'aria-rowindex', 'aria-rowspan', 'aria-selected:u', 'aria-setsize', 'aria-sort:sort', 'aria-valuemax', 'aria-valuemin', 'aria-valuenow', 'aria-valuetext',\n\t\t'accesskey', 'class', 'contenteditable:b', 'contextmenu', 'dir:d', 'draggable:b', 'dropzone', 'hidden:v', 'id', 'itemid', 'itemprop', 'itemref', 'itemscope:v', 'itemtype', 'lang', 'role:roles', 'spellcheck:b', 'style', 'tabindex',\n\t\t'title', 'translate:y'];\n\n\tvar eventHandlers = ['onabort', 'onblur', 'oncanplay', 'oncanplaythrough', 'onchange', 'onclick', 'oncontextmenu', 'ondblclick', 'ondrag', 'ondragend', 'ondragenter', 'ondragleave', 'ondragover', 'ondragstart',\n\t\t'ondrop', 'ondurationchange', 'onemptied', 'onended', 'onerror', 'onfocus', 'onformchange', 'onforminput', 'oninput', 'oninvalid', 'onkeydown', 'onkeypress', 'onkeyup', 'onload', 'onloadeddata', 'onloadedmetadata',\n\t\t'onloadstart', 'onmousedown', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'onmousewheel', 'onpause', 'onplay', 'onplaying', 'onprogress', 'onratechange', 'onreset', 'onresize', 'onreadystatechange', 'onscroll',\n\t\t'onseeked', 'onseeking', 'onselect', 'onshow', 'onstalled', 'onsubmit', 'onsuspend', 'ontimeupdate', 'onvolumechange', 'onwaiting'];\n\n\tvar valueSets: IValueSets = {\n\t\tb: ['true', 'false'],\n\t\tu: ['true', 'false', 'undefined'],\n\t\to: ['on', 'off'],\n\t\ty: ['yes', 'no'],\n\t\tw: ['soft', 'hard'],\n\t\td: ['ltr', 'rtl', 'auto'],\n\t\tm: ['GET', 'POST', 'dialog'],\n\t\tfm: ['GET', 'POST'],\n\t\ts: ['row', 'col', 'rowgroup', 'colgroup'],\n\t\tt: ['hidden', 'text', 'search', 'tel', 'url', 'email', 'password', 'datetime', 'date', 'month', 'week', 'time', 'datetime-local', 'number', 'range', 'color', 'checkbox', 'radio', 'file', 'submit', 'image', 'reset', 'button'],\n\t\tim: ['verbatim', 'latin', 'latin-name', 'latin-prose', 'full-width-latin', 'kana', 'kana-name', 'katakana', 'numeric', 'tel', 'email', 'url'],\n\t\tbt: ['button', 'submit', 'reset', 'menu'],\n\t\tlt: ['1', 'a', 'A', 'i', 'I'],\n\t\tmt: ['context', 'toolbar'],\n\t\tmit: ['command', 'checkbox', 'radio'],\n\t\tet: ['application/x-www-form-urlencoded', 'multipart/form-data', 'text/plain'],\n\t\ttk: ['subtitles', 'captions', 'descriptions', 'chapters', 'metadata'],\n\t\tpl: ['none', 'metadata', 'auto'],\n\t\tsh: ['circle', 'default', 'poly', 'rect'],\n\t\txo: ['anonymous', 'use-credentials'],\n\t\tsb: ['allow-forms', 'allow-modals', 'allow-pointer-lock', 'allow-popups', 'allow-popups-to-escape-sandbox', 'allow-same-origin', 'allow-scripts', 'allow-top-navigation'],\n\t\ttristate: ['true', 'false', 'mixed', 'undefined'],\n\t\tautocomplete: ['inline', 'list', 'both', 'none'],\n\t\tcurrent: ['page', 'step', 'location', 'date', 'time', 'true', 'false'],\n\t\tdropeffect: ['copy', 'move', 'link', 'execute', 'popup', 'none'],\n\t\tinvalid: ['grammar', 'false', 'spelling', 'true'],\n\t\tlive: ['off', 'polite', 'assertive'],\n\t\torientation: ['vertical', 'horizontal', 'undefined'],\n\t\trelevant: ['additions', 'removals', 'text', 'all', 'additions text'],\n\t\tsort: ['ascending', 'descending', 'none', 'other'],\n\t\troles: ['alert', 'alertdialog', 'button', 'checkbox', 'dialog', 'gridcell', 'link', 'log', 'marquee', 'menuitem', 'menuitemcheckbox', 'menuitemradio', 'option', 'progressbar', 'radio', 'scrollbar', 'searchbox', 'slider',\n\t\t\t'spinbutton', 'status', 'switch', 'tab', 'tabpanel', 'textbox', 'timer', 'tooltip', 'treeitem', 'combobox', 'grid', 'listbox', 'menu', 'menubar', 'radiogroup', 'tablist', 'tree', 'treegrid',\n\t\t\t'application', 'article', 'cell', 'columnheader', 'definition', 'directory', 'document', 'feed', 'figure', 'group', 'heading', 'img', 'list', 'listitem', 'math', 'none', 'note', 'presentation', 'region', 'row', 'rowgroup',\n\t\t\t'rowheader', 'separator', 'table', 'term', 'text', 'toolbar',\n\t\t\t'banner', 'complementary', 'contentinfo', 'form', 'main', 'navigation', 'region', 'search']\n\t};\n\n\treturn {\n\t\tcollectTags: (collector: (tag: string, label: string) => void) => collectTagsDefault(collector, HTML_TAGS),\n\t\tcollectAttributes: (tag: string, collector: (attribute: string, type: string) => void) => {\n\t\t\tcollectAttributesDefault(tag, collector, HTML_TAGS, globalAttributes);\n\t\t\teventHandlers.forEach(handler => {\n\t\t\t\tcollector(handler, 'event');\n\t\t\t});\n\t\t},\n\t\tcollectValues: (tag: string, attribute: string, collector: (value: string) => void) => collectValuesDefault(tag, attribute, collector, HTML_TAGS, globalAttributes, valueSets)\n\t};\n}\n\n\nexport function getAngularTagProvider(): IHTMLTagProvider {\n\tvar customTags: { [tag: string]: string[] } = {\n\t\tinput: ['ng-model', 'ng-required', 'ng-minlength', 'ng-maxlength', 'ng-pattern', 'ng-trim'],\n\t\tselect: ['ng-model'],\n\t\ttextarea: ['ng-model', 'ng-required', 'ng-minlength', 'ng-maxlength', 'ng-pattern', 'ng-trim']\n\t};\n\n\tvar globalAttributes = ['ng-app', 'ng-bind', 'ng-bind-html', 'ng-bind-template', 'ng-blur', 'ng-change', 'ng-checked', 'ng-class', 'ng-class-even', 'ng-class-odd',\n\t\t'ng-click', 'ng-cloak', 'ng-controller', 'ng-copy', 'ng-csp', 'ng-cut', 'ng-dblclick', 'ng-disabled', 'ng-focus', 'ng-form', 'ng-hide', 'ng-href', 'ng-if',\n\t\t'ng-include', 'ng-init', 'ng-jq', 'ng-keydown', 'ng-keypress', 'ng-keyup', 'ng-list', 'ng-model-options', 'ng-mousedown', 'ng-mouseenter', 'ng-mouseleave',\n\t\t'ng-mousemove', 'ng-mouseover', 'ng-mouseup', 'ng-non-bindable', 'ng-open', 'ng-options', 'ng-paste', 'ng-pluralize', 'ng-readonly', 'ng-repeat', 'ng-selected',\n\t\t'ng-show', 'ng-src', 'ng-srcset', 'ng-style', 'ng-submit', 'ng-switch', 'ng-transclude', 'ng-value'\n\t];\n\n\treturn {\n\t\tcollectTags: (collector: (tag: string) => void) => {\n\t\t\t// no extra tags\n\t\t},\n\t\tcollectAttributes: (tag: string, collector: (attribute: string, type: string) => void) => {\n\t\t\tif (tag) {\n\t\t\t\tvar attributes = customTags[tag];\n\t\t\t\tif (attributes) {\n\t\t\t\t\tattributes.forEach((a) => {\n\t\t\t\t\t\tcollector(a, null);\n\t\t\t\t\t\tcollector('data-' + a, null);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tglobalAttributes.forEach((a) => {\n\t\t\t\tcollector(a, null);\n\t\t\t\tcollector('data-' + a, null);\n\t\t\t});\n\t\t},\n\t\tcollectValues: (tag: string, attribute: string, collector: (value: string) => void) => {\n\t\t\t// no values\n\t\t}\n\t};\n}\n\nexport function getIonicTagProvider(): IHTMLTagProvider {\n\tvar customTags: { [tag: string]: string[] } = {\n\t\ta: ['nav-direction:navdir', 'nav-transition:trans'],\n\t\tbutton: ['menu-toggle:menusides']\n\t};\n\n\tvar globalAttributes = ['collection-repeat', 'force-refresh-images:b', 'ion-stop-event', 'item-height', 'item-render-buffer', 'item-width', 'menu-close:v',\n\t\t'on-double-tap', 'on-drag', 'on-drag-down', 'on-drag-left', 'on-drag-right', 'on-drag-up', 'on-hold', 'on-release', 'on-swipe', 'on-swipe-down', 'on-swipe-left',\n\t\t'on-swipe-right', 'on-swipe-up', 'on-tap', 'on-touch'];\n\n\tvar valueSets: IValueSets = {\n\t\talign: ['center', 'left', 'right'],\n\t\tb: ['true', 'false'],\n\t\tinputtype: ['email', 'number', 'password', 'search', 'tel', 'text', 'url'],\n\t\tlisttype: ['card', 'list-inset'],\n\t\tmenusides: ['left', 'right'],\n\t\tnavdir: ['back', 'enter', 'exit', 'forward', 'swap'],\n\t\tnavsides: ['left', 'primary', 'right', 'secondary'],\n\t\tscrolldir: ['x', 'xy', 'y'],\n\t\ttrans: ['android', 'ios', 'none']\n\t};\n\n\treturn {\n\t\tcollectTags: (collector: (tag: string, label: string) => void) => collectTagsDefault(collector, IONIC_TAGS),\n\t\tcollectAttributes: (tag: string, collector: (attribute: string, type: string) => void) => {\n\t\t\tcollectAttributesDefault(tag, collector, IONIC_TAGS, globalAttributes);\n\t\t\tif (tag) {\n\t\t\t\tvar attributes = customTags[tag];\n\t\t\t\tif (attributes) {\n\t\t\t\t\tattributes.forEach((a) => {\n\t\t\t\t\t\tvar segments = a.split(':');\n\t\t\t\t\t\tcollector(segments[0], segments[1]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcollectValues: (tag: string, attribute: string, collector: (value: string) => void) => collectValuesDefault(tag, attribute, collector, IONIC_TAGS, globalAttributes, valueSets, customTags)\n\t};\n}\n\nfunction collectTagsDefault(collector: (tag: string, label: string) => void, tagSet: ITagSet): void {\n\tfor (var tag in tagSet) {\n\t\tcollector(tag, tagSet[tag].label);\n\t}\n}\n\nfunction collectAttributesDefault(tag: string, collector: (attribute: string, type: string) => void, tagSet: ITagSet, globalAttributes: string[]): void {\n\tglobalAttributes.forEach(attr => {\n\t\tvar segments = attr.split(':');\n\t\tcollector(segments[0], segments[1]);\n\t});\n\tif (tag) {\n\t\tvar tags = tagSet[tag];\n\t\tif (tags) {\n\t\t\tvar attributes = tags.attributes;\n\t\t\tif (attributes) {\n\t\t\t\tattributes.forEach(attr => {\n\t\t\t\t\tvar segments = attr.split(':');\n\t\t\t\t\tcollector(segments[0], segments[1]);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction collectValuesDefault(tag: string, attribute: string, collector: (value: string) => void, tagSet: ITagSet, globalAttributes: string[], valueSets: IValueSets, customTags?: { [tag: string]: string[] }): void {\n\tvar prefix = attribute + ':';\n\tvar processAttributes = (attributes: string[]) => {\n\t\tattributes.forEach((attr) => {\n\t\t\tif (attr.length > prefix.length && strings.startsWith(attr, prefix)) {\n\t\t\t\tvar typeInfo = attr.substr(prefix.length);\n\t\t\t\tif (typeInfo === 'v') {\n\t\t\t\t\tcollector(attribute);\n\t\t\t\t} else {\n\t\t\t\t\tvar values = valueSets[typeInfo];\n\t\t\t\t\tif (values) {\n\t\t\t\t\t\tvalues.forEach(collector);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\tif (tag) {\n\t\tvar tags = tagSet[tag];\n\t\tif (tags) {\n\t\t\tvar attributes = tags.attributes;\n\t\t\tif (attributes) {\n\t\t\t\tprocessAttributes(attributes);\n\t\t\t}\n\t\t}\n\t}\n\tprocessAttributes(globalAttributes);\n\tif (customTags) {\n\t\tvar customTagAttributes = customTags[tag];\n\t\tif (customTagAttributes) {\n\t\t\tprocessAttributes(customTagAttributes);\n\t\t}\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport Event from 'vs/base/common/event';\nimport {ServiceIdentifier, createDecorator} from 'vs/platform/instantiation/common/instantiation';\nimport {ICommonCodeEditor, IDecorationRenderOptions, IModelDecorationOptions} from 'vs/editor/common/editorCommon';\n\nexport var ID_CODE_EDITOR_SERVICE = 'codeEditorService';\nexport var ICodeEditorService = createDecorator<ICodeEditorService>(ID_CODE_EDITOR_SERVICE);\n\nexport interface ICodeEditorService {\n\tserviceId: ServiceIdentifier<any>;\n\n\taddCodeEditor(editor: ICommonCodeEditor): void;\n\tonCodeEditorAdd: Event<ICommonCodeEditor>;\n\n\tremoveCodeEditor(editor: ICommonCodeEditor): void;\n\tonCodeEditorRemove: Event<ICommonCodeEditor>;\n\n\tgetCodeEditor(editorId: string): ICommonCodeEditor;\n\n\tlistCodeEditors(): ICommonCodeEditor[];\n\n\t/**\n\t * Returns the current focused code editor (if the focus is in the editor or in an editor widget) or null.\n\t */\n\tgetFocusedCodeEditor(): ICommonCodeEditor;\n\n\tregisterDecorationType(key:string, options: IDecorationRenderOptions): void;\n\tremoveDecorationType(key:string): void;\n\tresolveDecorationType(key:string): IModelDecorationOptions;\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport URI from 'vs/base/common/uri';\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {IEventEmitter} from 'vs/base/common/eventEmitter';\n\nimport {createDecorator, ServiceIdentifier} from 'vs/platform/instantiation/common/instantiation';\n\nexport const IEditorService = createDecorator<IEditorService>('editorService');\n\nexport interface IEditorService {\n\tserviceId: ServiceIdentifier<any>;\n\t/**\n\t * Specific overload to open an instance of IResourceInput.\n\t */\n\topenEditor(input: IResourceInput, sideBySide?: boolean): TPromise<IEditor>;\n\n\t/**\n\t * Specific overload to resolve a IResourceInput to an editor model with a text representation.\n\t */\n\tresolveEditorModel(input: IResourceInput, refresh?: boolean): TPromise<ITextEditorModel>;\n}\n\nexport interface IEditorModel extends IEventEmitter {\n}\n\nexport interface ITextEditorModel extends IEditorModel {\n\ttextEditorModel: any;\n}\n\nexport interface IResourceInput {\n\n\t/**\n\t * The resource URL of the resource to open.\n\t */\n\tresource: URI;\n\n\t/**\n\t * The mime type of the text input if known.\n\t */\n\tmime?: string;\n\n\t/**\n\t * The encoding of the text input if known.\n\t */\n\tencoding?: string;\n\n\t/**\n\t * Optional options to use when opening the text input.\n\t */\n\toptions?: ITextEditorOptions;\n}\n\nexport interface IEditorControl {\n\n}\n\nexport interface IEditor {\n\n\t/**\n\t * The assigned input of this editor.\n\t */\n\tinput: IEditorInput;\n\n\t/**\n\t * The assigned options of this editor.\n\t */\n\toptions: IEditorOptions;\n\n\t/**\n\t * The assigned position of this editor.\n\t */\n\tposition: Position;\n\n\t/**\n\t * Returns the unique identifier of this editor.\n\t */\n\tgetId(): string;\n\n\t/**\n\t * Returns the underlying control of this editor.\n\t */\n\tgetControl(): IEditorControl;\n\n\t/**\n\t * Asks the underlying control to focus.\n\t */\n\tfocus(): void;\n}\n\n/**\n * Possible locations for opening an editor.\n */\nexport enum Position {\n\n\t/** Opens the editor in the LEFT most position replacing the input currently showing */\n\tLEFT = 0,\n\n\t/** Opens the editor in the CENTER position replacing the input currently showing */\n\tCENTER = 1,\n\n\t/** Opens the editor in the RIGHT most position replacing the input currently showing */\n\tRIGHT = 2\n}\n\nexport const POSITIONS = [Position.LEFT, Position.CENTER, Position.RIGHT];\n\nexport enum Direction {\n\tLEFT,\n\tRIGHT\n}\n\nexport interface IEditorInput extends IEventEmitter {\n\n\t/**\n\t * Returns the display name of this input.\n\t */\n\tgetName(): string;\n\n\t/**\n\t * Returns the display description of this input.\n\t */\n\tgetDescription(): string;\n\n\t/**\n\t * Returns if this input is dirty or not.\n\t */\n\tisDirty(): boolean;\n\n\t/**\n\t * Returns if the other object matches this input.\n\t */\n\tmatches(other: any): boolean;\n}\n\nexport interface IEditorOptionsBag {\n\n\t/**\n\t * Tells the editor to not receive keyboard focus when the editor is being opened. By default,\n\t * the editor will receive keyboard focus on open.\n\t */\n\tpreserveFocus?: boolean;\n\n\t/**\n\t * Tells the editor to replace the editor input in the editor even if it is identical to the one\n\t * already showing. By default, the editor will not replace the input if it is identical to the\n\t * one showing.\n\t */\n\tforceOpen?: boolean;\n\n\t/**\n\t * An editor that is pinned remains in the editor stack even when another editor is being opened.\n\t * An editor that is not pinned will always get replaced by another editor that is not pinned.\n\t */\n\tpinned?: boolean;\n\n\t/**\n\t * The index in the document stack where to insert the editor into when opening.\n\t */\n\tindex?: number;\n}\n\nexport interface ITextEditorOptions extends IEditorOptionsBag {\n\n\t/**\n\t * Text editor selection.\n\t */\n\tselection?: {\n\t\tstartLineNumber: number;\n\t\tstartColumn: number;\n\t\tendLineNumber?: number;\n\t\tendColumn?: number;\n\t};\n}\n\nexport interface IEditorOptions extends IEditorOptionsBag {}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {IHTMLContentElement} from 'vs/base/common/htmlContent';\nimport {Keybinding} from 'vs/base/common/keyCodes';\nimport {TypeConstraint} from 'vs/base/common/types';\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {ServiceIdentifier, ServicesAccessor, createDecorator} from 'vs/platform/instantiation/common/instantiation';\n\nexport interface IUserFriendlyKeybinding {\n\tkey: string;\n\tcommand: string;\n\twhen?: string;\n}\n\nexport interface IKeybindings {\n\tprimary: number;\n\tsecondary?: number[];\n\twin?: {\n\t\tprimary: number;\n\t\tsecondary?: number[];\n\t};\n\tlinux?: {\n\t\tprimary: number;\n\t\tsecondary?: number[];\n\t};\n\tmac?: {\n\t\tprimary: number;\n\t\tsecondary?: number[];\n\t};\n}\n\nexport enum KbExprType {\n\tKbDefinedExpression = 1,\n\tKbNotExpression = 2,\n\tKbEqualsExpression = 3,\n\tKbNotEqualsExpression = 4,\n\tKbAndExpression = 5\n}\n\nexport interface KbExpr {\n\tgetType(): KbExprType;\n\tequals(other: KbExpr): boolean;\n\tevaluate(context: any): boolean;\n\tnormalize(): KbExpr;\n\tserialize(): string;\n}\n\nfunction cmp(a:KbExpr, b:KbExpr): number {\n\tlet aType = a.getType();\n\tlet bType = b.getType();\n\tif (aType !== bType) {\n\t\treturn aType - bType;\n\t}\n\tswitch(aType) {\n\t\tcase KbExprType.KbDefinedExpression:\n\t\t\treturn (<KbDefinedExpression>a).cmp(<KbDefinedExpression>b);\n\t\tcase KbExprType.KbNotExpression:\n\t\t\treturn (<KbNotExpression>a).cmp(<KbNotExpression>b);\n\t\tcase KbExprType.KbEqualsExpression:\n\t\t\treturn (<KbEqualsExpression>a).cmp(<KbEqualsExpression>b);\n\t\tcase KbExprType.KbNotEqualsExpression:\n\t\t\treturn (<KbNotEqualsExpression>a).cmp(<KbNotEqualsExpression>b);\n\t\tdefault:\n\t\t\tthrow new Error('Unknown KbExpr!');\n\t}\n}\n\nexport class KbDefinedExpression implements KbExpr {\n\tconstructor(private key: string) {\n\t}\n\n\tpublic getType(): KbExprType {\n\t\treturn KbExprType.KbDefinedExpression;\n\t}\n\n\tpublic cmp(other:KbDefinedExpression): number {\n\t\tif (this.key < other.key) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.key > other.key) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic equals(other: KbExpr): boolean {\n\t\tif (other instanceof KbDefinedExpression) {\n\t\t\treturn (this.key === other.key);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic evaluate(context: any): boolean {\n\t\treturn (!!context[this.key]);\n\t}\n\n\tpublic normalize(): KbExpr {\n\t\treturn this;\n\t}\n\n\tpublic serialize(): string {\n\t\treturn this.key;\n\t}\n}\n\nexport class KbEqualsExpression implements KbExpr {\n\tconstructor(private key: string, private value: any) {\n\t}\n\n\tpublic getType(): KbExprType {\n\t\treturn KbExprType.KbEqualsExpression;\n\t}\n\n\tpublic cmp(other:KbEqualsExpression): number {\n\t\tif (this.key < other.key) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.key > other.key) {\n\t\t\treturn 1;\n\t\t}\n\t\tif (this.value < other.value) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.value > other.value) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic equals(other: KbExpr): boolean {\n\t\tif (other instanceof KbEqualsExpression) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic evaluate(context: any): boolean {\n\t\t/* tslint:disable:triple-equals */\n\t\t// Intentional ==\n\t\treturn (context[this.key] == this.value);\n\t\t/* tslint:enable:triple-equals */\n\t}\n\n\tpublic normalize(): KbExpr {\n\t\tif (typeof this.value === 'boolean') {\n\t\t\tif (this.value) {\n\t\t\t\treturn new KbDefinedExpression(this.key);\n\t\t\t}\n\t\t\treturn new KbNotExpression(this.key);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic serialize(): string {\n\t\tif (typeof this.value === 'boolean') {\n\t\t\treturn this.normalize().serialize();\n\t\t}\n\n\t\treturn this.key + ' == \\'' + this.value + '\\'';\n\t}\n}\n\nexport class KbNotEqualsExpression implements KbExpr {\n\tconstructor(private key: string, private value: any) {\n\t}\n\n\tpublic getType(): KbExprType {\n\t\treturn KbExprType.KbNotEqualsExpression;\n\t}\n\n\tpublic cmp(other:KbNotEqualsExpression): number {\n\t\tif (this.key < other.key) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.key > other.key) {\n\t\t\treturn 1;\n\t\t}\n\t\tif (this.value < other.value) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.value > other.value) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic equals(other: KbExpr): boolean {\n\t\tif (other instanceof KbNotEqualsExpression) {\n\t\t\treturn (this.key === other.key && this.value === other.value);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic evaluate(context: any): boolean {\n\t\t/* tslint:disable:triple-equals */\n\t\t// Intentional !=\n\t\treturn (context[this.key] != this.value);\n\t\t/* tslint:enable:triple-equals */\n\t}\n\n\tpublic normalize(): KbExpr {\n\t\tif (typeof this.value === 'boolean') {\n\t\t\tif (this.value) {\n\t\t\t\treturn new KbNotExpression(this.key);\n\t\t\t}\n\t\t\treturn new KbDefinedExpression(this.key);\n\t\t}\n\t\treturn this;\n\t}\n\n\tpublic serialize(): string {\n\t\tif (typeof this.value === 'boolean') {\n\t\t\treturn this.normalize().serialize();\n\t\t}\n\n\t\treturn this.key + ' != \\'' + this.value + '\\'';\n\t}\n}\n\nexport class KbNotExpression implements KbExpr {\n\tconstructor(private key: string) {\n\t}\n\n\tpublic getType(): KbExprType {\n\t\treturn KbExprType.KbNotExpression;\n\t}\n\n\tpublic cmp(other:KbNotExpression): number {\n\t\tif (this.key < other.key) {\n\t\t\treturn -1;\n\t\t}\n\t\tif (this.key > other.key) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tpublic equals(other: KbExpr): boolean {\n\t\tif (other instanceof KbNotExpression) {\n\t\t\treturn (this.key === other.key);\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic evaluate(context: any): boolean {\n\t\treturn (!context[this.key]);\n\t}\n\n\tpublic normalize(): KbExpr {\n\t\treturn this;\n\t}\n\n\tpublic serialize(): string {\n\t\treturn '!' + this.key;\n\t}\n}\n\nexport class KbAndExpression implements KbExpr {\n\tprivate expr: KbExpr[];\n\n\tconstructor(expr: KbExpr[]) {\n\t\tthis.expr = KbAndExpression._normalizeArr(expr);\n\t}\n\n\tpublic getType(): KbExprType {\n\t\treturn KbExprType.KbAndExpression;\n\t}\n\n\tpublic equals(other: KbExpr): boolean {\n\t\tif (other instanceof KbAndExpression) {\n\t\t\tif (this.expr.length !== other.expr.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\t\tif (!this.expr[i].equals(other.expr[i])) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic evaluate(context: any): boolean {\n\t\tfor (let i = 0, len = this.expr.length; i < len; i++) {\n\t\t\tif (!this.expr[i].evaluate(context)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate static _normalizeArr(arr:KbExpr[]): KbExpr[] {\n\t\tlet expr: KbExpr[] = [];\n\n\t\tif (arr) {\n\t\t\tfor (let i = 0, len = arr.length; i < len; i++) {\n\t\t\t\tlet e = arr[i];\n\t\t\t\tif (!e) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\te = e.normalize();\n\t\t\t\tif (!e) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (e instanceof KbAndExpression) {\n\t\t\t\t\texpr = expr.concat(e.expr);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\texpr.push(e);\n\t\t\t}\n\n\t\t\texpr.sort(cmp);\n\t\t}\n\n\t\treturn expr;\n\t}\n\n\tpublic normalize(): KbExpr {\n\t\tif (this.expr.length === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.expr.length === 1) {\n\t\t\treturn this.expr[0];\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tpublic serialize(): string {\n\t\tif (this.expr.length === 0) {\n\t\t\treturn '';\n\t\t}\n\t\tif (this.expr.length === 1) {\n\t\t\treturn this.normalize().serialize();\n\t\t}\n\t\treturn this.expr.map(e => e.serialize()).join(' && ');\n\t}\n}\n\n\nexport let KbExpr = {\n\thas: (key: string) => new KbDefinedExpression(key),\n\tequals: (key: string, value: any) => new KbEqualsExpression(key, value),\n\tnotEquals: (key: string, value: any) => new KbNotEqualsExpression(key, value),\n\tnot: (key: string) => new KbNotExpression(key),\n\tand: (...expr: KbExpr[]) => new KbAndExpression(expr),\n\tdeserialize: (serialized: string): KbExpr => {\n\t\tif (!serialized) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet pieces = serialized.split('&&');\n\t\tlet result = new KbAndExpression(pieces.map(p => KbExpr._deserializeOne(p)));\n\t\treturn result.normalize();\n\t},\n\n\t_deserializeOne: (serializedOne: string): KbExpr => {\n\t\tserializedOne = serializedOne.trim();\n\n\t\tif (serializedOne.indexOf('!=') >= 0) {\n\t\t\tlet pieces = serializedOne.split('!=');\n\t\t\treturn new KbNotEqualsExpression(pieces[0].trim(), KbExpr._deserializeValue(pieces[1]));\n\t\t}\n\n\t\tif (serializedOne.indexOf('==') >= 0) {\n\t\t\tlet pieces = serializedOne.split('==');\n\t\t\treturn new KbEqualsExpression(pieces[0].trim(), KbExpr._deserializeValue(pieces[1]));\n\t\t}\n\n\t\tif (/^\\!\\s*/.test(serializedOne)) {\n\t\t\treturn new KbNotExpression(serializedOne.substr(1).trim());\n\t\t}\n\n\t\treturn new KbDefinedExpression(serializedOne);\n\t},\n\n\t_deserializeValue: (serializedValue: string): any => {\n\t\tserializedValue = serializedValue.trim();\n\n\t\tif (serializedValue === 'true') {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (serializedValue === 'false') {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet m = /^'([^']*)'$/.exec(serializedValue);\n\t\tif (m) {\n\t\t\treturn m[1].trim();\n\t\t}\n\n\t\treturn serializedValue;\n\t}\n};\n\nexport interface IKeybindingItem {\n\tkeybinding: number;\n\tcommand: string;\n\twhen: KbExpr;\n\tweight1: number;\n\tweight2: number;\n}\n\nexport interface ICommandHandler {\n\t(accessor: ServicesAccessor, ...args: any[]): void;\n\tdescription?: string | ICommandHandlerDescription;\n}\n\nexport interface ICommandHandlerDescription {\n\tdescription: string;\n\targs: { name: string; description?: string; constraint?: TypeConstraint; }[];\n\treturns?: string;\n}\n\nexport interface ICommandsMap {\n\t[id: string]: ICommandHandler;\n}\n\nexport interface IKeybindingContextKey<T> {\n\tset(value: T): void;\n\treset(): void;\n}\n\nexport let IKeybindingService = createDecorator<IKeybindingService>('keybindingService');\n\nexport interface IKeybindingScopeLocation {\n\tsetAttribute(attr: string, value: string): void;\n\tremoveAttribute(attr: string): void;\n}\n\nexport interface IKeybindingService {\n\tserviceId: ServiceIdentifier<any>;\n\tdispose(): void;\n\n\tcreateKey<T>(key: string, defaultValue: T): IKeybindingContextKey<T>;\n\n\tcreateScoped(domNode: IKeybindingScopeLocation): IKeybindingService;\n\n\tgetDefaultKeybindings(): string;\n\tlookupKeybindings(commandId: string): Keybinding[];\n\tcustomKeybindingsCount(): number;\n\n\tgetLabelFor(keybinding: Keybinding): string;\n\tgetAriaLabelFor(keybinding: Keybinding): string;\n\tgetHTMLLabelFor(keybinding: Keybinding): IHTMLContentElement[];\n\tgetElectronAcceleratorFor(keybinding: Keybinding): string;\n\n\texecuteCommand<T>(commandId: string, ...args: any[]): TPromise<T>;\n\texecuteCommand(commandId: string, ...args: any[]): TPromise<any>;\n\thasCommand(commandId: string): boolean;\n}\n\nexport const SET_CONTEXT_COMMAND_ID = 'setContext';\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {BinaryKeybindings, KeyCode} from 'vs/base/common/keyCodes';\nimport * as platform from 'vs/base/common/platform';\nimport {TypeConstraint, validateConstraints} from 'vs/base/common/types';\nimport {ICommandHandler, ICommandHandlerDescription, ICommandsMap, IKeybindingItem, IKeybindings, KbExpr} from 'vs/platform/keybinding/common/keybindingService';\nimport {Registry} from 'vs/platform/platform';\n\nexport interface ICommandRule extends IKeybindings {\n\tid: string;\n\tweight: number;\n\twhen: KbExpr;\n}\n\nexport interface ICommandDescriptor extends ICommandRule {\n\thandler: ICommandHandler;\n\tdescription?: string | ICommandHandlerDescription;\n}\n\nexport interface IKeybindingsRegistry {\n\tregisterCommandRule(rule: ICommandRule);\n\tregisterCommandDesc(desc: ICommandDescriptor): void;\n\tgetCommands(): ICommandsMap;\n\tgetDefaultKeybindings(): IKeybindingItem[];\n\n\tWEIGHT: {\n\t\teditorCore(importance?: number): number;\n\t\teditorContrib(importance?: number): number;\n\t\tworkbenchContrib(importance?: number): number;\n\t\tbuiltinExtension(importance?: number): number;\n\t\texternalExtension(importance?: number): number;\n\t};\n}\n\nclass KeybindingsRegistryImpl implements IKeybindingsRegistry {\n\n\tprivate _keybindings: IKeybindingItem[];\n\tprivate _commands: ICommandsMap;\n\n\tpublic WEIGHT = {\n\t\teditorCore: (importance: number = 0): number => {\n\t\t\treturn 0 + importance;\n\t\t},\n\t\teditorContrib: (importance: number = 0): number => {\n\t\t\treturn 100 + importance;\n\t\t},\n\t\tworkbenchContrib: (importance: number = 0): number => {\n\t\t\treturn 200 + importance;\n\t\t},\n\t\tbuiltinExtension: (importance: number = 0): number => {\n\t\t\treturn 300 + importance;\n\t\t},\n\t\texternalExtension: (importance: number = 0): number => {\n\t\t\treturn 400 + importance;\n\t\t}\n\t};\n\n\tconstructor() {\n\t\tthis._keybindings = [];\n\t\tthis._commands = Object.create(null);\n\t}\n\n\t/**\n\t * Take current platform into account and reduce to primary & secondary.\n\t */\n\tprivate static bindToCurrentPlatform(kb: IKeybindings): { primary?: number; secondary?: number[]; } {\n\t\tif (platform.isWindows) {\n\t\t\tif (kb && kb.win) {\n\t\t\t\treturn kb.win;\n\t\t\t}\n\t\t} else if (platform.isMacintosh) {\n\t\t\tif (kb && kb.mac) {\n\t\t\t\treturn kb.mac;\n\t\t\t}\n\t\t} else {\n\t\t\tif (kb && kb.linux) {\n\t\t\t\treturn kb.linux;\n\t\t\t}\n\t\t}\n\n\t\treturn kb;\n\t}\n\n\tpublic registerCommandRule(rule: ICommandRule): void {\n\t\tlet actualKb = KeybindingsRegistryImpl.bindToCurrentPlatform(rule);\n\n\t\t// here\n\t\tif (actualKb && actualKb.primary) {\n\t\t\tthis.registerDefaultKeybinding(actualKb.primary, rule.id, rule.weight, 0, rule.when);\n\t\t}\n\n\t\t// here\n\t\tif (actualKb && Array.isArray(actualKb.secondary)) {\n\t\t\tactualKb.secondary.forEach((k, i) => this.registerDefaultKeybinding(k, rule.id, rule.weight, -i - 1, rule.when));\n\t\t}\n\t}\n\n\tpublic registerCommandDesc(desc: ICommandDescriptor): void {\n\t\tthis.registerCommandRule(desc);\n\n\t\t// if (_commands[desc.id]) {\n\t\t// \tconsole.warn('Duplicate handler for command: ' + desc.id);\n\t\t// }\n\t\t// this._commands[desc.id] = desc.handler;\n\n\t\tlet handler = desc.handler;\n\t\tlet description = desc.description || handler.description;\n\n\t\t// add argument validation if rich command metadata is provided\n\t\tif (typeof description === 'object') {\n\t\t\tlet constraints: TypeConstraint[] = [];\n\t\t\tfor (let arg of description.args) {\n\t\t\t\tconstraints.push(arg.constraint);\n\t\t\t}\n\t\t\thandler = function (accesor, ...args: any[]) {\n\t\t\t\tvalidateConstraints(args, constraints);\n\t\t\t\treturn desc.handler(accesor, ...args);\n\t\t\t};\n\t\t}\n\n\t\t// make sure description is there\n\t\thandler.description = description;\n\n\t\t// register handler\n\t\tthis._commands[desc.id] = handler;\n\t}\n\n\tpublic getCommands(): ICommandsMap {\n\t\treturn this._commands;\n\t}\n\n\tprivate registerDefaultKeybinding(keybinding: number, commandId: string, weight1: number, weight2: number, when: KbExpr): void {\n\t\tif (platform.isWindows) {\n\t\t\tif (BinaryKeybindings.hasCtrlCmd(keybinding) && !BinaryKeybindings.hasShift(keybinding) && BinaryKeybindings.hasAlt(keybinding) && !BinaryKeybindings.hasWinCtrl(keybinding)) {\n\t\t\t\tif (/^[A-Z0-9\\[\\]\\|\\;\\'\\,\\.\\/\\`]$/.test(KeyCode.toString(BinaryKeybindings.extractKeyCode(keybinding)))) {\n\t\t\t\t\tconsole.warn('Ctrl+Alt+ keybindings should not be used by default under Windows. Offender: ', keybinding, ' for ', commandId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._keybindings.push({\n\t\t\tkeybinding: keybinding,\n\t\t\tcommand: commandId,\n\t\t\twhen: when,\n\t\t\tweight1: weight1,\n\t\t\tweight2: weight2\n\t\t});\n\t}\n\n\tpublic getDefaultKeybindings(): IKeybindingItem[] {\n\t\treturn this._keybindings;\n\t}\n}\nexport let KeybindingsRegistry: IKeybindingsRegistry = new KeybindingsRegistryImpl();\n\n// Define extension point ids\nexport let Extensions = {\n\tEditorModes: 'platform.keybindingsRegistry'\n};\nRegistry.add(Extensions.EditorModes, KeybindingsRegistry);","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {KeyCode, KeyMod} from 'vs/base/common/keyCodes';\nimport {IEditorService} from 'vs/platform/editor/common/editor';\nimport {ServicesAccessor} from 'vs/platform/instantiation/common/instantiation';\nimport {IKeybindings, KbExpr} from 'vs/platform/keybinding/common/keybindingService';\nimport {ICommandDescriptor, KeybindingsRegistry} from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport {ICodeEditorService} from 'vs/editor/common/services/codeEditorService';\n\nconst H = editorCommon.Handler;\n\nexport function findFocusedEditor(commandId: string, accessor: ServicesAccessor, complain: boolean): editorCommon.ICommonCodeEditor {\n\tlet editor = accessor.get(ICodeEditorService).getFocusedCodeEditor();\n\tif (!editor) {\n\t\tif (complain) {\n\t\t\tconsole.warn('Cannot execute ' + commandId + ' because no code editor is focused.');\n\t\t}\n\t\treturn null;\n\t}\n\treturn editor;\n}\n\nexport function withCodeEditorFromCommandHandler(commandId: string, accessor: ServicesAccessor, callback: (editor:editorCommon.ICommonCodeEditor) => void): void {\n\tlet editor = findFocusedEditor(commandId, accessor, true);\n\tif (editor) {\n\t\tcallback(editor);\n\t}\n}\n\nexport function getActiveEditor(accessor: ServicesAccessor): editorCommon.ICommonCodeEditor {\n\tlet editorService = accessor.get(IEditorService);\n\tlet activeEditor = (<any>editorService).getActiveEditor && (<any>editorService).getActiveEditor();\n\tif (activeEditor) {\n\t\tlet editor = <editorCommon.IEditor>activeEditor.getControl();\n\n\t\t// Substitute for (editor instanceof ICodeEditor)\n\t\tif (editor && typeof editor.getEditorType === 'function') {\n\t\t\tlet codeEditor = <editorCommon.ICommonCodeEditor>editor;\n\t\t\treturn codeEditor;\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction triggerEditorHandler(handlerId: string, accessor: ServicesAccessor, args: any): void {\n\twithCodeEditorFromCommandHandler(handlerId, accessor, (editor) => {\n\t\teditor.trigger('keyboard', handlerId, args);\n\t});\n}\n\nfunction registerCoreCommand(handlerId: string, kb: IKeybindings, weight: number = KeybindingsRegistry.WEIGHT.editorCore(), when?: KbExpr): void {\n\tlet desc: ICommandDescriptor = {\n\t\tid: handlerId,\n\t\thandler: triggerEditorHandler.bind(null, handlerId),\n\t\tweight: weight,\n\t\twhen: (when ? when : KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS)),\n\t\tprimary: kb.primary,\n\t\tsecondary: kb.secondary,\n\t\twin: kb.win,\n\t\tmac: kb.mac,\n\t\tlinux: kb.linux\n\t};\n\tKeybindingsRegistry.registerCommandDesc(desc);\n}\n\nfunction registerCoreDispatchCommand2(handlerId: string) {\n\tlet desc: ICommandDescriptor = {\n\t\tid: handlerId,\n\t\thandler: triggerEditorHandler.bind(null, handlerId),\n\t\tweight: KeybindingsRegistry.WEIGHT.editorCore(),\n\t\twhen: null,\n\t\tprimary: 0\n\t};\n\tKeybindingsRegistry.registerCommandDesc(desc);\n\n\tlet desc2: ICommandDescriptor = {\n\t\tid: 'default:' + handlerId,\n\t\thandler: (accessor: ServicesAccessor, args: any) => {\n\t\t\twithCodeEditorFromCommandHandler(handlerId, accessor, (editor) => {\n\t\t\t\teditor.trigger('keyboard', handlerId, args);\n\t\t\t});\n\t\t},\n\t\tweight: KeybindingsRegistry.WEIGHT.editorCore(),\n\t\twhen: null,\n\t\tprimary: 0\n\t};\n\tKeybindingsRegistry.registerCommandDesc(desc2);\n}\nregisterCoreDispatchCommand2(H.Type);\nregisterCoreDispatchCommand2(H.ReplacePreviousChar);\nregisterCoreDispatchCommand2(H.Paste);\nregisterCoreDispatchCommand2(H.Cut);\n\nfunction getMacWordNavigationKB(shift:boolean, key:KeyCode): number {\n\t// For macs, word navigation is based on the alt modifier\n\tif (shift) {\n\t\treturn KeyMod.Shift | KeyMod.Alt | key;\n\t} else {\n\t\treturn KeyMod.Alt | key;\n\t}\n}\n\nfunction getWordNavigationKB(shift:boolean, key:KeyCode): number {\n\t// Normally word navigation is based on the ctrl modifier\n\tif (shift) {\n\t\treturn KeyMod.CtrlCmd | KeyMod.Shift | key;\n\t} else {\n\t\treturn KeyMod.CtrlCmd | key;\n\t}\n}\n\n// https://support.apple.com/en-gb/HT201236\n// [ADDED] Control-H\t\t\t\t\tDelete the character to the left of the insertion point. Or use Delete.\n// [ADDED] Control-D\t\t\t\t\tDelete the character to the right of the insertion point. Or use Fn-Delete.\n// [ADDED] Control-K\t\t\t\t\tDelete the text between the insertion point and the end of the line or paragraph.\n// [ADDED] CommandUp Arrow\t\t\t\tMove the insertion point to the beginning of the document.\n// [ADDED] CommandDown Arrow\t\t\tMove the insertion point to the end of the document.\n// [ADDED] CommandLeft Arrow\t\t\tMove the insertion point to the beginning of the current line.\n// [ADDED] CommandRight Arrow\t\t\tMove the insertion point to the end of the current line.\n// [ADDED] OptionLeft Arrow\t\t\tMove the insertion point to the beginning of the previous word.\n// [ADDED] OptionRight Arrow\t\t\tMove the insertion point to the end of the next word.\n// [ADDED] CommandShiftUp Arrow\t\tSelect the text between the insertion point and the beginning of the document.\n// [ADDED] CommandShiftDown Arrow\t\tSelect the text between the insertion point and the end of the document.\n// [ADDED] CommandShiftLeft Arrow\t\tSelect the text between the insertion point and the beginning of the current line.\n// [ADDED] CommandShiftRight Arrow\tSelect the text between the insertion point and the end of the current line.\n// [USED BY DUPLICATE LINES] ShiftOptionUp Arrow\t\tExtend text selection to the beginning of the current paragraph, then to the beginning of the following paragraph if pressed again.\n// [USED BY DUPLICATE LINES] ShiftOptionDown Arrow\tExtend text selection to the end of the current paragraph, then to the end of the following paragraph if pressed again.\n// [ADDED] ShiftOptionLeft Arrow\t\tExtend text selection to the beginning of the current word, then to the beginning of the following word if pressed again.\n// [ADDED] ShiftOptionRight Arrow\t\tExtend text selection to the end of the current word, then to the end of the following word if pressed again.\n// [ADDED] Control-A\t\t\t\t\tMove to the beginning of the line or paragraph.\n// [ADDED] Control-E\t\t\t\t\tMove to the end of a line or paragraph.\n// [ADDED] Control-F\t\t\t\t\tMove one character forward.\n// [ADDED] Control-B\t\t\t\t\tMove one character backward.\n//Control-L\t\t\t\t\t\t\t\tCenter the cursor or selection in the visible area.\n// [ADDED] Control-P\t\t\t\t\tMove up one line.\n// [ADDED] Control-N\t\t\t\t\tMove down one line.\n// [ADDED] Control-O\t\t\t\t\tInsert a new line after the insertion point.\n//Control-T\t\t\t\t\t\t\t\tSwap the character behind the insertion point with the character in front of the insertion point.\n// Unconfirmed????\n//\tConfig.addKeyBinding(editorCommon.Handler.CursorPageDown,\t\tKeyMod.WinCtrl | KeyCode.KEY_V);\n\n// OS X built in commands\n// Control+y => yank\n// [ADDED] Command+backspace => Delete to Hard BOL\n// [ADDED] Command+delete => Delete to Hard EOL\n// [ADDED] Control+k => Delete to Hard EOL\n// Control+l => show_at_center\n// Control+Command+d => noop\n// Control+Command+shift+d => noop\n\nregisterCoreCommand(H.CursorLeft, {\n\tprimary: KeyCode.LeftArrow,\n\tmac: { primary: KeyCode.LeftArrow, secondary: [KeyMod.WinCtrl | KeyCode.KEY_B] }\n});\nregisterCoreCommand(H.CursorLeftSelect, {\n\tprimary: KeyMod.Shift | KeyCode.LeftArrow\n});\nregisterCoreCommand(H.CursorRight, {\n\tprimary: KeyCode.RightArrow,\n\tmac: { primary: KeyCode.RightArrow, secondary: [KeyMod.WinCtrl | KeyCode.KEY_F] }\n});\nregisterCoreCommand(H.CursorRightSelect, {\n\tprimary: KeyMod.Shift | KeyCode.RightArrow\n});\nregisterCoreCommand(H.CursorUp, {\n\tprimary: KeyCode.UpArrow,\n\tmac: { primary: KeyCode.UpArrow, secondary: [KeyMod.WinCtrl | KeyCode.KEY_P] }\n});\nregisterCoreCommand(H.CursorUpSelect, {\n\tprimary: KeyMod.Shift | KeyCode.UpArrow,\n\tsecondary: [getWordNavigationKB(true, KeyCode.UpArrow)],\n\tmac: { primary: KeyMod.Shift | KeyCode.UpArrow },\n\tlinux: { primary: KeyMod.Shift | KeyCode.UpArrow }\n});\nregisterCoreCommand(H.CursorDown, {\n\tprimary: KeyCode.DownArrow,\n\tmac: { primary: KeyCode.DownArrow, secondary: [KeyMod.WinCtrl | KeyCode.KEY_N] }\n});\nregisterCoreCommand(H.CursorDownSelect, {\n\tprimary: KeyMod.Shift | KeyCode.DownArrow,\n\tsecondary: [getWordNavigationKB(true, KeyCode.DownArrow)],\n\tmac: { primary: KeyMod.Shift | KeyCode.DownArrow },\n\tlinux: { primary: KeyMod.Shift | KeyCode.DownArrow }\n});\n\nregisterCoreCommand(H.CursorPageUp, {\n\tprimary: KeyCode.PageUp\n});\nregisterCoreCommand(H.CursorPageUpSelect, {\n\tprimary: KeyMod.Shift | KeyCode.PageUp\n});\nregisterCoreCommand(H.CursorPageDown, {\n\tprimary: KeyCode.PageDown\n});\nregisterCoreCommand(H.CursorPageDownSelect, {\n\tprimary: KeyMod.Shift | KeyCode.PageDown\n});\nregisterCoreCommand(H.CursorHome, {\n\tprimary: KeyCode.Home,\n\tmac: { primary: KeyCode.Home, secondary: [KeyMod.CtrlCmd | KeyCode.LeftArrow, KeyMod.WinCtrl | KeyCode.KEY_A] }\n});\nregisterCoreCommand(H.CursorHomeSelect, {\n\tprimary: KeyMod.Shift | KeyCode.Home,\n\tmac: { primary: KeyMod.Shift | KeyCode.Home, secondary: [KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.LeftArrow] }\n});\nregisterCoreCommand(H.CursorEnd, {\n\tprimary: KeyCode.End,\n\tmac: { primary: KeyCode.End, secondary: [KeyMod.CtrlCmd | KeyCode.RightArrow, KeyMod.WinCtrl | KeyCode.KEY_E] }\n});\nregisterCoreCommand(H.CursorEndSelect, {\n\tprimary: KeyMod.Shift | KeyCode.End,\n\tmac: { primary: KeyMod.Shift | KeyCode.End, secondary: [KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.RightArrow] }\n});\nregisterCoreCommand(H.ExpandLineSelection, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.KEY_I\n});\n\nregisterCoreCommand(H.ScrollLineUp, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.UpArrow,\n\tmac: { primary: KeyMod.WinCtrl | KeyCode.PageUp}\n});\nregisterCoreCommand(H.ScrollLineDown, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.DownArrow,\n\tmac: { primary: KeyMod.WinCtrl | KeyCode.PageDown}\n});\n\nregisterCoreCommand(H.ScrollPageUp, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.PageUp\n});\nregisterCoreCommand(H.ScrollPageDown, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.PageDown\n});\n\nregisterCoreCommand(H.CursorColumnSelectLeft, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyMod.Alt | KeyCode.LeftArrow,\n\tlinux: { primary: 0 }\n});\nregisterCoreCommand(H.CursorColumnSelectRight, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyMod.Alt | KeyCode.RightArrow,\n\tlinux: { primary: 0 }\n});\nregisterCoreCommand(H.CursorColumnSelectUp, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyMod.Alt | KeyCode.UpArrow,\n\tlinux: { primary: 0 }\n});\nregisterCoreCommand(H.CursorColumnSelectPageUp, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyMod.Alt | KeyCode.PageUp,\n\tlinux: { primary: 0 }\n});\nregisterCoreCommand(H.CursorColumnSelectDown, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyMod.Alt | KeyCode.DownArrow,\n\tlinux: { primary: 0 }\n});\nregisterCoreCommand(H.CursorColumnSelectPageDown, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyMod.Alt | KeyCode.PageDown,\n\tlinux: { primary: 0 }\n});\n\nregisterCoreCommand(H.Tab, {\n\tprimary: KeyCode.Tab\n}, KeybindingsRegistry.WEIGHT.editorCore(), KbExpr.and(\n\tKbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS),\n\tKbExpr.not(editorCommon.KEYBINDING_CONTEXT_EDITOR_TAB_MOVES_FOCUS)\n));\nregisterCoreCommand(H.Outdent, {\n\tprimary: KeyMod.Shift | KeyCode.Tab\n}, KeybindingsRegistry.WEIGHT.editorCore(), KbExpr.and(\n\tKbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS),\n\tKbExpr.not(editorCommon.KEYBINDING_CONTEXT_EDITOR_TAB_MOVES_FOCUS)\n));\n\nregisterCoreCommand(H.DeleteLeft, {\n\tprimary: KeyCode.Backspace,\n\tsecondary: [KeyMod.Shift | KeyCode.Backspace],\n\tmac: { primary: KeyCode.Backspace, secondary: [KeyMod.Shift | KeyCode.Backspace, KeyMod.WinCtrl | KeyCode.KEY_H, KeyMod.WinCtrl | KeyCode.Backspace] }\n});\nregisterCoreCommand(H.DeleteRight, {\n\tprimary: KeyCode.Delete,\n\tmac: { primary: KeyCode.Delete, secondary: [KeyMod.WinCtrl | KeyCode.KEY_D, KeyMod.WinCtrl | KeyCode.Delete] }\n});\nregisterCoreCommand(H.DeleteAllLeft, {\n\tprimary: null,\n\tmac: { primary: KeyMod.CtrlCmd | KeyCode.Backspace }\n});\nregisterCoreCommand(H.DeleteAllRight, {\n\tprimary: null,\n\tmac: { primary: KeyMod.WinCtrl | KeyCode.KEY_K, secondary: [KeyMod.CtrlCmd | KeyCode.Delete] }\n});\n\nfunction registerWordCommand(handlerId: string, shift:boolean, key:KeyCode): void {\n\tregisterCoreCommand(handlerId, {\n\t\tprimary: getWordNavigationKB(shift, key),\n\t\tmac: { primary: getMacWordNavigationKB(shift, key) }\n\t});\n}\nregisterWordCommand(H.CursorWordStartLeft, false, KeyCode.LeftArrow);\nregisterCoreCommand(H.CursorWordEndLeft, { primary: 0 });\nregisterCoreCommand(H.CursorWordLeft, { primary: 0 });\n\nregisterWordCommand(H.CursorWordStartLeftSelect, true, KeyCode.LeftArrow);\nregisterCoreCommand(H.CursorWordEndLeftSelect, { primary: 0 });\nregisterCoreCommand(H.CursorWordLeftSelect, { primary: 0 });\n\nregisterWordCommand(H.CursorWordEndRight, false, KeyCode.RightArrow);\nregisterCoreCommand(H.CursorWordStartRight, { primary: 0 });\nregisterCoreCommand(H.CursorWordRight, { primary: 0 });\n\nregisterWordCommand(H.CursorWordEndRightSelect, true, KeyCode.RightArrow);\nregisterCoreCommand(H.CursorWordStartRightSelect, { primary: 0 });\nregisterCoreCommand(H.CursorWordRightSelect, { primary: 0 });\n\nregisterWordCommand(H.DeleteWordLeft, false, KeyCode.Backspace);\nregisterCoreCommand(H.DeleteWordStartLeft, { primary: 0 });\nregisterCoreCommand(H.DeleteWordEndLeft, { primary: 0 });\n\nregisterWordCommand(H.DeleteWordRight, false, KeyCode.Delete);\nregisterCoreCommand(H.DeleteWordStartRight, { primary: 0 });\nregisterCoreCommand(H.DeleteWordEndRight, { primary: 0 });\n\nregisterCoreCommand(H.CancelSelection, {\n\tprimary: KeyCode.Escape,\n\tsecondary: [KeyMod.Shift | KeyCode.Escape]\n}, KeybindingsRegistry.WEIGHT.editorCore(), KbExpr.and(\n\tKbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS),\n\tKbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_HAS_NON_EMPTY_SELECTION)\n));\nregisterCoreCommand(H.RemoveSecondaryCursors, {\n\tprimary: KeyCode.Escape,\n\tsecondary: [KeyMod.Shift | KeyCode.Escape]\n}, KeybindingsRegistry.WEIGHT.editorCore(1), KbExpr.and(\n\tKbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS),\n\tKbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_HAS_MULTIPLE_SELECTIONS)\n));\n\nregisterCoreCommand(H.CursorTop, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.Home,\n\tmac: { primary: KeyMod.CtrlCmd | KeyCode.UpArrow }\n});\nregisterCoreCommand(H.CursorTopSelect, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.Home,\n\tmac: { primary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.UpArrow }\n});\nregisterCoreCommand(H.CursorBottom, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.End,\n\tmac: { primary: KeyMod.CtrlCmd | KeyCode.DownArrow }\n});\nregisterCoreCommand(H.CursorBottomSelect, {\n\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.End,\n\tmac: { primary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.DownArrow }\n});\n\nregisterCoreCommand(H.LineBreakInsert, {\n\tprimary: null,\n\tmac: { primary: KeyMod.WinCtrl | KeyCode.KEY_O }\n});\n\nregisterCoreCommand(H.Undo, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.KEY_Z\n});\nregisterCoreCommand(H.CursorUndo, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.KEY_U\n});\nregisterCoreCommand(H.Redo, {\n\tprimary: KeyMod.CtrlCmd | KeyCode.KEY_Y,\n\tsecondary: [KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KEY_Z],\n\tmac: { primary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.KEY_Z }\n});\n\n\nfunction selectAll(accessor: ServicesAccessor, args: any): void {\n\tlet HANDLER = editorCommon.Handler.SelectAll;\n\n\tlet focusedEditor = findFocusedEditor(HANDLER, accessor, false);\n\t// Only if editor text focus (i.e. not if editor has widget focus).\n\tif (focusedEditor && focusedEditor.isFocused()) {\n\t\tfocusedEditor.trigger('keyboard', HANDLER, args);\n\t\treturn;\n\t}\n\n\t// Ignore this action when user is focussed on an element that allows for entering text\n\tlet activeElement = <HTMLElement>document.activeElement;\n\tif (activeElement && ['input', 'textarea'].indexOf(activeElement.tagName.toLowerCase()) >= 0) {\n\t\t(<any>activeElement).select();\n\t\treturn;\n\t}\n\n\t// Redirecting to last active editor\n\tlet activeEditor = getActiveEditor(accessor);\n\tif (activeEditor) {\n\t\tactiveEditor.trigger('keyboard', HANDLER, args);\n\t\treturn;\n\t}\n}\nKeybindingsRegistry.registerCommandDesc({\n\tid: 'editor.action.selectAll',\n\thandler: selectAll,\n\tweight: KeybindingsRegistry.WEIGHT.editorCore(),\n\twhen: null,\n\tprimary: KeyMod.CtrlCmd | KeyCode.KEY_A\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {illegalArgument, onUnexpectedError} from 'vs/base/common/errors';\nimport URI from 'vs/base/common/uri';\nimport {SyncDescriptor1, createSyncDescriptor} from 'vs/platform/instantiation/common/descriptors';\nimport {ServicesAccessor} from 'vs/platform/instantiation/common/instantiation';\nimport {IInstantiationService} from 'vs/platform/instantiation/common/instantiation';\nimport {ICommandHandler, IKeybindings, KbExpr} from 'vs/platform/keybinding/common/keybindingService';\nimport {ICommandDescriptor, KeybindingsRegistry} from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport {Registry} from 'vs/platform/platform';\nimport {ITelemetryService} from 'vs/platform/telemetry/common/telemetry';\nimport {findFocusedEditor, getActiveEditor, withCodeEditorFromCommandHandler} from 'vs/editor/common/config/config';\nimport {Position} from 'vs/editor/common/core/position';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport {IModelService} from 'vs/editor/common/services/modelService';\n\n// --- Keybinding extensions to make it more concise to express keybindings conditions\nexport enum ContextKey {\n\tNone = 0,\n\tEditorTextFocus = 1,\n\tEditorFocus = 2\n}\nexport interface IEditorActionKeybindingOptions extends IKeybindings {\n\thandler?: ICommandHandler;\n\tcontext: ContextKey;\n\tkbExpr?: KbExpr;\n}\nexport interface IEditorCommandKeybindingOptions extends IKeybindings {\n\tcontext: ContextKey;\n}\n\n// --- Editor Actions\nexport class EditorActionDescriptor {\n\n\tpublic ctor:editorCommon.IEditorActionContributionCtor;\n\tpublic id:string;\n\tpublic label:string;\n\tpublic alias:string;\n\tpublic kbOpts:IEditorActionKeybindingOptions;\n\n\tconstructor(ctor:editorCommon.IEditorActionContributionCtor, id:string, label:string, kbOpts: IEditorActionKeybindingOptions = defaultEditorActionKeybindingOptions, alias?:string) {\n\t\tthis.ctor = ctor;\n\t\tthis.id = id;\n\t\tthis.label = label;\n\t\tthis.alias = alias;\n\t\tthis.kbOpts = kbOpts;\n\t}\n}\n\nexport interface IEditorCommandHandler {\n\t(accessor:ServicesAccessor, editor: editorCommon.ICommonCodeEditor, args: any): void;\n}\n\nexport module CommonEditorRegistry {\n\n\texport function registerEditorAction(desc:EditorActionDescriptor) {\n\t\t(<EditorContributionRegistry>Registry.as(Extensions.EditorCommonContributions)).registerEditorAction(desc);\n\t}\n\n\t// --- Editor Contributions\n\texport function registerEditorContribution(ctor:editorCommon.ICommonEditorContributionCtor): void {\n\t\t(<EditorContributionRegistry>Registry.as(Extensions.EditorCommonContributions)).registerEditorContribution2(ctor);\n\t}\n\texport function getEditorContributions(): editorCommon.ICommonEditorContributionDescriptor[] {\n\t\treturn (<EditorContributionRegistry>Registry.as(Extensions.EditorCommonContributions)).getEditorContributions2();\n\t}\n\n\t// --- Editor Commands\n\texport function commandWeight(importance: number = 0): number {\n\t\treturn KeybindingsRegistry.WEIGHT.editorContrib(importance);\n\t}\n\n\texport function registerEditorCommand(commandId: string, weight: number, keybinding:IKeybindings, needsTextFocus: boolean, needsKey: string, handler: IEditorCommandHandler): void {\n\t\tvar commandDesc: ICommandDescriptor = {\n\t\t\tid: commandId,\n\t\t\thandler: createCommandHandler(commandId, handler),\n\t\t\tweight: weight,\n\t\t\twhen: whenRule(needsTextFocus, needsKey),\n\t\t\tprimary: keybinding.primary,\n\t\t\tsecondary: keybinding.secondary,\n\t\t\twin: keybinding.win,\n\t\t\tlinux: keybinding.linux,\n\t\t\tmac: keybinding.mac,\n\t\t};\n\n\t\tKeybindingsRegistry.registerCommandDesc(commandDesc);\n\t}\n\n\texport function registerLanguageCommand(id: string, handler: (accessor: ServicesAccessor, args: { [n: string]: any }) => any) {\n\t\tKeybindingsRegistry.registerCommandDesc({\n\t\t\tid,\n\t\t\thandler(accessor, args: any) {\n\t\t\t\treturn handler(accessor, args || {});\n\t\t\t},\n\t\t\tweight: KeybindingsRegistry.WEIGHT.editorContrib(),\n\t\t\tprimary: undefined,\n\t\t\twhen: undefined,\n\t\t});\n\t}\n\n\texport function registerDefaultLanguageCommand(id: string, handler: (model: editorCommon.IModel, position: Position, args: { [n: string]: any }) => any) {\n\t\tregisterLanguageCommand(id, function(accessor, args) {\n\n\t\t\tconst {resource, position} = args;\n\t\t\tif (!(resource instanceof URI) || !Position.isIPosition(position)) {\n\t\t\t\tthrow illegalArgument();\n\t\t\t}\n\n\t\t\tconst model = accessor.get(IModelService).getModel(resource);\n\t\t\tif (!model) {\n\t\t\t\tthrow illegalArgument();\n\t\t\t}\n\n\t\t\tconst editorPosition = Position.lift(position);\n\n\t\t\treturn handler(model, editorPosition, args);\n\t\t});\n\t}\n}\n\nclass SimpleEditorContributionDescriptor implements editorCommon.ICommonEditorContributionDescriptor {\n\tprivate _ctor:editorCommon.ICommonEditorContributionCtor;\n\n\tconstructor(ctor:editorCommon.ICommonEditorContributionCtor) {\n\t\tthis._ctor = ctor;\n\t}\n\n\tpublic createInstance(instantiationService: IInstantiationService, editor:editorCommon.ICommonCodeEditor): editorCommon.IEditorContribution {\n\t\treturn instantiationService.createInstance(this._ctor, editor);\n\t}\n}\n\nclass InternalEditorActionDescriptor implements editorCommon.ICommonEditorContributionDescriptor {\n\n\tprivate _descriptor: SyncDescriptor1<editorCommon.ICommonCodeEditor, editorCommon.IEditorContribution>;\n\n\tconstructor(ctor:editorCommon.IEditorActionContributionCtor, id:string, label:string, alias:string) {\n\t\tthis._descriptor = createSyncDescriptor(ctor, {\n\t\t\tid,\n\t\t\tlabel,\n\t\t\talias\n\t\t});\n\t}\n\n\tpublic createInstance(instService:IInstantiationService, editor:editorCommon.ICommonCodeEditor): editorCommon.IEditorContribution {\n\t\treturn instService.createInstance(this._descriptor, editor);\n\t}\n}\n\n// Editor extension points\nvar Extensions = {\n\tEditorCommonContributions: 'editor.commonContributions'\n};\n\nclass EditorContributionRegistry {\n\n\tprivate editorContributions: editorCommon.ICommonEditorContributionDescriptor[];\n\n\tconstructor() {\n\t\tthis.editorContributions = [];\n\t}\n\n\tpublic registerEditorContribution2(ctor:editorCommon.ICommonEditorContributionCtor): void {\n\t\tthis.editorContributions.push(new SimpleEditorContributionDescriptor(ctor));\n\t}\n\n\tpublic registerEditorAction(desc:EditorActionDescriptor): void {\n\t\tlet handler = desc.kbOpts.handler;\n\t\tif (!handler) {\n\t\t\t// here\n\t\t\tif (desc.kbOpts.context === ContextKey.EditorTextFocus || desc.kbOpts.context === ContextKey.EditorFocus) {\n\t\t\t\thandler = triggerEditorAction.bind(null, desc.id);\n\t\t\t} else {\n\t\t\t\thandler = triggerEditorActionGlobal.bind(null, desc.id);\n\t\t\t}\n\t\t}\n\n\t\tlet when: KbExpr = null;\n\t\tif (typeof desc.kbOpts.kbExpr === 'undefined') {\n\t\t\t// here\n\t\t\tif (desc.kbOpts.context === ContextKey.EditorTextFocus) {\n\t\t\t\twhen = KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS);\n\t\t\t} else if (desc.kbOpts.context === ContextKey.EditorFocus) {\n\t\t\t\twhen = KbExpr.has(editorCommon.KEYBINDING_CONTEXT_EDITOR_FOCUS);\n\t\t\t}\n\t\t} else {\n\t\t\twhen = desc.kbOpts.kbExpr;\n\t\t}\n\n\t\tlet commandDesc: ICommandDescriptor = {\n\t\t\tid: desc.id,\n\t\t\thandler: handler,\n\t\t\tweight: KeybindingsRegistry.WEIGHT.editorContrib(),\n\t\t\twhen: when,\n\t\t\tprimary: desc.kbOpts.primary,\n\t\t\tsecondary: desc.kbOpts.secondary,\n\t\t\twin: desc.kbOpts.win,\n\t\t\tlinux: desc.kbOpts.linux,\n\t\t\tmac: desc.kbOpts.mac,\n\t\t};\n\n\t\tKeybindingsRegistry.registerCommandDesc(commandDesc);\n\t\tthis.editorContributions.push(new InternalEditorActionDescriptor(desc.ctor, desc.id, desc.label, desc.alias));\n\t}\n\n\tpublic getEditorContributions2(): editorCommon.ICommonEditorContributionDescriptor[] {\n\t\treturn this.editorContributions.slice(0);\n\t}\n}\nRegistry.add(Extensions.EditorCommonContributions, new EditorContributionRegistry());\n\nfunction triggerEditorAction(actionId: string, accessor: ServicesAccessor, args: any): void {\n\twithCodeEditorFromCommandHandler(actionId, accessor, (editor) => {\n\t\teditor.trigger('keyboard', actionId, args);\n\t});\n}\n\nfunction triggerEditorActionGlobal(actionId: string, accessor: ServicesAccessor, args: any): void {\n\t// TODO: this is not necessarily keyboard\n\tvar focusedEditor = findFocusedEditor(actionId, accessor, false);\n\tif (focusedEditor) {\n\t\tfocusedEditor.trigger('keyboard', actionId, args);\n\t\treturn;\n\t}\n\n\tvar activeEditor = getActiveEditor(accessor);\n\tif (activeEditor) {\n\t\tvar action = activeEditor.getAction(actionId);\n\t\tif (action) {\n\t\t\taccessor.get(ITelemetryService).publicLog('editorActionInvoked', {name: action.label} );\n\t\t\taction.run().done(null, onUnexpectedError);\n\t\t}\n\t\treturn;\n\t}\n}\n\nvar defaultEditorActionKeybindingOptions:IEditorActionKeybindingOptions = { primary: null, context: ContextKey.EditorTextFocus };\n\nfunction whenRule(needsTextFocus: boolean, needsKey: string): KbExpr {\n\n\tlet base = KbExpr.has(needsTextFocus ? editorCommon.KEYBINDING_CONTEXT_EDITOR_TEXT_FOCUS : editorCommon.KEYBINDING_CONTEXT_EDITOR_FOCUS);\n\n\tif (needsKey) {\n\t\treturn KbExpr.and(base, KbExpr.has(needsKey));\n\t}\n\n\treturn base;\n}\n\nfunction createCommandHandler(commandId: string, handler: IEditorCommandHandler): ICommandHandler {\n\treturn (accessor, args) => {\n\t\twithCodeEditorFromCommandHandler(commandId, accessor, (editor) => {\n\t\t\thandler(accessor, editor, args||{});\n\t\t});\n\t};\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\nimport {coalesce} from 'vs/base/common/arrays';\nimport {onUnexpectedError} from 'vs/base/common/errors';\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {IReadOnlyModel} from 'vs/editor/common/editorCommon';\nimport {CommonEditorRegistry} from 'vs/editor/common/editorCommonExtensions';\nimport {Hover, HoverProviderRegistry} from 'vs/editor/common/modes';\nimport {asWinJsPromise} from 'vs/base/common/async';\nimport {Position} from 'vs/editor/common/core/position';\n\nexport function getHover(model: IReadOnlyModel, position: Position): TPromise<Hover[]> {\n\n\tconst supports = HoverProviderRegistry.ordered(model);\n\tconst values: Hover[] = [];\n\n\tconst promises = supports.map((support, idx) => {\n\t\treturn asWinJsPromise((token) => {\n\t\t\treturn support.provideHover(model, position, token);\n\t\t}).then((result) => {\n\t\t\tif (result) {\n\t\t\t\tlet hasRange = (typeof result.range !== 'undefined');\n\t\t\t\tlet hasHtmlContent = (typeof result.htmlContent !== 'undefined' && result.htmlContent && result.htmlContent.length > 0);\n\t\t\t\tif (hasRange && hasHtmlContent) {\n\t\t\t\t\tvalues[idx]  = result;\n\t\t\t\t}\n\t\t\t}\n\t\t}, err => {\n\t\t\tonUnexpectedError(err);\n\t\t});\n\t});\n\n\treturn TPromise.join(promises).then(() => coalesce(values));\n}\n\nCommonEditorRegistry.registerDefaultLanguageCommand('_executeHoverProvider', getHover);","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n'use strict';\n\nimport {onUnexpectedError} from 'vs/base/common/errors';\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {IReadOnlyModel} from 'vs/editor/common/editorCommon';\nimport {CommonEditorRegistry} from 'vs/editor/common/editorCommonExtensions';\nimport {Location, ReferenceProviderRegistry} from 'vs/editor/common/modes';\nimport {asWinJsPromise} from 'vs/base/common/async';\nimport {Position} from 'vs/editor/common/core/position';\n\nexport function provideReferences(model: IReadOnlyModel, position: Position): TPromise<Location[]> {\n\n\t// collect references from all providers\n\tconst promises = ReferenceProviderRegistry.ordered(model).map(provider => {\n\t\treturn asWinJsPromise((token) => {\n\t\t\treturn provider.provideReferences(model, position, { includeDeclaration: true }, token);\n\t\t}).then(result => {\n\t\t\tif (Array.isArray(result)) {\n\t\t\t\treturn <Location[]> result;\n\t\t\t}\n\t\t}, err => {\n\t\t\tonUnexpectedError(err);\n\t\t});\n\t});\n\n\treturn TPromise.join(promises).then(references => {\n\t\tlet result: Location[] = [];\n\t\tfor (let ref of references) {\n\t\t\tif (ref) {\n\t\t\t\tresult.push(...ref);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t});\n}\n\nCommonEditorRegistry.registerDefaultLanguageCommand('_executeReferenceProvider', provideReferences);","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport {sequence, asWinJsPromise} from 'vs/base/common/async';\nimport {isFalsyOrEmpty} from 'vs/base/common/arrays';\nimport {onUnexpectedError} from 'vs/base/common/errors';\nimport {TPromise} from 'vs/base/common/winjs.base';\nimport {IReadOnlyModel} from 'vs/editor/common/editorCommon';\nimport {CommonEditorRegistry} from 'vs/editor/common/editorCommonExtensions';\nimport {ISuggestResult, ISuggestSupport, SuggestRegistry} from 'vs/editor/common/modes';\nimport {SnippetsRegistry} from 'vs/editor/common/modes/supports';\nimport {Position} from 'vs/editor/common/core/position';\n\nexport const Context = {\n\tVisible: 'suggestWidgetVisible',\n\tMultipleSuggestions: 'suggestWidgetMultipleSuggestions',\n\tAcceptOnKey: 'suggestionSupportsAcceptOnKey'\n};\n\nexport interface ISuggestResult2 extends ISuggestResult {\n\tsupport?: ISuggestSupport;\n}\n\nexport function provideCompletionItems(model: IReadOnlyModel, position: Position, groups?: ISuggestSupport[][]): TPromise<ISuggestResult2[]> {\n\n\tif (!groups) {\n\t\tgroups = SuggestRegistry.orderedGroups(model);\n\t}\n\n\tconst result: ISuggestResult2[] = [];\n\n\tconst factory = groups.map((supports, index) => {\n\t\treturn () => {\n\n\t\t\t// stop as soon as a group produced a result\n\t\t\tif (result.length > 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// for each support in the group ask for suggestions\n\t\t\treturn TPromise.join(supports.map(support => {\n\t\t\t\treturn asWinJsPromise((token) => {\n\t\t\t\t\treturn support.provideCompletionItems(model, position, token);\n\t\t\t\t}).then(values => {\n\n\t\t\t\t\tif (!values) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let suggestResult of values) {\n\n\t\t\t\t\t\tif (!suggestResult || isFalsyOrEmpty(suggestResult.suggestions)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tresult.push({\n\t\t\t\t\t\t\tsupport,\n\t\t\t\t\t\t\tcurrentWord: suggestResult.currentWord,\n\t\t\t\t\t\t\tincomplete: suggestResult.incomplete,\n\t\t\t\t\t\t\tsuggestions: suggestResult.suggestions\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t}, onUnexpectedError);\n\t\t\t}));\n\t\t};\n\t});\n\n\treturn sequence(factory).then(() => {\n\t\t// add snippets to the first group\n\t\tconst snippets = SnippetsRegistry.getSnippets(model, position);\n\t\tresult.push(snippets);\n\t\treturn result;\n\t});\n}\n\nCommonEditorRegistry.registerDefaultLanguageCommand('_executeCompletionItemProvider', (model, position, args) => {\n\treturn provideCompletionItems(model, position);\n});\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nimport URI from 'vs/base/common/uri';\nimport winjs = require('vs/base/common/winjs.base');\nimport beautifyHTML = require('vs/languages/lib/common/beautify-html');\nimport htmlTags = require('vs/languages/html/common/htmlTags');\nimport network = require('vs/base/common/network');\nimport editorCommon = require('vs/editor/common/editorCommon');\nimport modes = require('vs/editor/common/modes');\nimport strings = require('vs/base/common/strings');\nimport {Position} from 'vs/editor/common/core/position';\nimport {IWorkspaceContextService} from 'vs/platform/workspace/common/workspace';\nimport {IMarkerService} from 'vs/platform/markers/common/markers';\nimport {IResourceService} from 'vs/editor/common/services/resourceService';\nimport {getScanner, IHTMLScanner} from 'vs/languages/html/common/htmlScanner';\nimport {isTag, DELIM_END, DELIM_START, DELIM_ASSIGN, ATTRIB_NAME, ATTRIB_VALUE} from 'vs/languages/html/common/htmlTokenTypes';\nimport {isEmptyElement} from 'vs/languages/html/common/htmlEmptyTagsShared';\nimport {filterSuggestions} from 'vs/editor/common/modes/supports/suggestSupport';\nimport paths = require('vs/base/common/paths');\nimport {getHover} from 'vs/editor/contrib/hover/common/hover';\nimport {provideReferences} from 'vs/editor/contrib/referenceSearch/common/referenceSearch';\nimport {provideCompletionItems} from 'vs/editor/contrib/suggest/common/suggest';\n\nenum LinkDetectionState {\n\tLOOKING_FOR_HREF_OR_SRC = 1,\n\tAFTER_HREF_OR_SRC = 2\n}\n\ninterface IColorRange {\n\trange:editorCommon.IRange;\n\tvalue:string;\n}\n\nexport class HTMLWorker {\n\n\tprivate _contextService: IWorkspaceContextService;\n\tprivate resourceService:IResourceService;\n\tprivate markerService: IMarkerService;\n\tprivate _modeId: string;\n\tprivate _tagProviders: htmlTags.IHTMLTagProvider[];\n\tprivate formatSettings: any;\n\n\tconstructor(\n\t\tmodeId: string,\n\t\t@IResourceService resourceService: IResourceService,\n\t\t@IMarkerService markerService: IMarkerService,\n\t\t@IWorkspaceContextService contextService:IWorkspaceContextService\n\t) {\n\n\t\tthis._modeId = modeId;\n\t\tthis.resourceService = resourceService;\n\t\tthis.markerService = markerService;\n\t\tthis._contextService = contextService;\n\n\t\tthis._tagProviders = [];\n\t\tthis._tagProviders.push(htmlTags.getHTML5TagProvider());\n\n\t\tthis.addCustomTagProviders(this._tagProviders);\n\t}\n\n\tprotected addCustomTagProviders(providers: htmlTags.IHTMLTagProvider[]): void {\n\t\tproviders.push(htmlTags.getAngularTagProvider());\n\t\tproviders.push(htmlTags.getIonicTagProvider());\n\t}\n\n\tpublic provideDocumentRangeFormattingEdits(resource: URI, range: editorCommon.IRange, options: modes.IFormattingOptions): winjs.TPromise<editorCommon.ISingleEditOperation[]> {\n\t\treturn this.formatHTML(resource, range, options);\n\t}\n\n\tprivate formatHTML(resource: URI, range: editorCommon.IRange, options: modes.IFormattingOptions): winjs.TPromise<editorCommon.ISingleEditOperation[]> {\n\t\tlet model = this.resourceService.get(resource);\n\t\tlet value = range ? model.getValueInRange(range) : model.getValue();\n\n\t\tlet htmlOptions : beautifyHTML.IBeautifyHTMLOptions = {\n\t\t\tindent_size: options.insertSpaces ? options.tabSize : 1,\n\t\t\tindent_char: options.insertSpaces ? ' ' : '\\t',\n\t\t\twrap_line_length: this.getFormatOption('wrapLineLength', 120),\n\t\t\tunformatted: this.getTagsFormatOption('unformatted', void 0),\n\t\t\tindent_inner_html: this.getFormatOption('indentInnerHtml', false),\n\t\t\tpreserve_newlines: this.getFormatOption('preserveNewLines', false),\n\t\t\tmax_preserve_newlines: this.getFormatOption('maxPreserveNewLines', void 0),\n\t\t\tindent_handlebars: this.getFormatOption('indentHandlebars', false),\n\t\t\tend_with_newline: this.getFormatOption('endWithNewline', false),\n\t\t\textra_liners: this.getTagsFormatOption('extraLiners', void 0),\n\t\t};\n\n\t\tlet result = beautifyHTML.html_beautify(value, htmlOptions);\n\n\t\treturn winjs.TPromise.as([{\n\t\t\trange: range,\n\t\t\ttext: result\n\t\t}]);\n\t}\n\n\tprivate getFormatOption(key: string, dflt: any): any {\n\t\tif (this.formatSettings && this.formatSettings.hasOwnProperty(key)) {\n\t\t\tlet value = this.formatSettings[key];\n\t\t\tif (value !== null) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t\treturn dflt;\n\t}\n\n\tprivate getTagsFormatOption(key: string, dflt: string[]): string[] {\n\t\tlet list = <string> this.getFormatOption(key, null);\n\t\tif (typeof list === 'string') {\n\t\t\tif (list.length > 0) {\n\t\t\t\treturn list.split(',').map(t => t.trim().toLowerCase());\n\t\t\t}\n\t\t\treturn [];\n\t\t}\n\t\treturn dflt;\n\t}\n\n\t_doConfigure(options: any): winjs.TPromise<void> {\n\t\tthis.formatSettings = options && options.format;\n\t\treturn winjs.TPromise.as(null);\n\t}\n\n\t_delegateToModeAtPosition<T>(resource:URI, position:editorCommon.IPosition, callback:(isEmbeddedMode:boolean, model:editorCommon.IMirrorModel) => T): T {\n\t\tlet model = this.resourceService.get(resource);\n\n\t\tif (!model) {\n\t\t\treturn null;\n\t\t}\n\n\t\tlet modelAtPosition = model.getEmbeddedAtPosition(position);\n\n\t\tif (!modelAtPosition) {\n\t\t\treturn callback(false, model);\n\t\t}\n\n\t\tlet modeAtPosition = modelAtPosition.getMode();\n\n\t\treturn callback(modeAtPosition.getId() !== this._modeId, modelAtPosition);\n\t}\n\n\t_delegateToAllModes<T>(resource:URI, callback:(models:editorCommon.IMirrorModel[]) => T): T {\n\t\tlet model = this.resourceService.get(resource);\n\n\t\tif (!model) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn callback(model.getAllEmbedded());\n\t}\n\n\tpublic provideHover(resource:URI, position:editorCommon.IPosition): winjs.TPromise<modes.Hover> {\n\t\treturn this._delegateToModeAtPosition(resource, position, (isEmbeddedMode, model) => {\n\t\t\tif (isEmbeddedMode) {\n\t\t\t\treturn getHover(model, Position.lift(position)).then((r) => {\n\t\t\t\t\treturn (r.length > 0 ? r[0] : null);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic provideReferences(resource:URI, position:editorCommon.IPosition): winjs.TPromise<modes.Location[]> {\n\t\treturn this._delegateToModeAtPosition(resource, position, (isEmbeddedMode, model) => {\n\t\t\tif (isEmbeddedMode) {\n\t\t\t\treturn provideReferences(model, Position.lift(position));\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic findColorDeclarations(resource:URI):winjs.TPromise<{range:editorCommon.IRange; value:string; }[]> {\n\t\treturn this._delegateToAllModes(resource, (models) => {\n\t\t\tlet allPromises: winjs.TPromise<IColorRange[]>[] = [];\n\n\t\t\tallPromises = models\n\t\t\t\t.filter((model) => (typeof model.getMode()['findColorDeclarations'] === 'function'))\n\t\t\t\t.map((model) => model.getMode()['findColorDeclarations'](model.uri));\n\n\t\t\treturn winjs.TPromise.join(allPromises).then((results:IColorRange[][]) => {\n\t\t\t\tlet result:IColorRange[] = [];\n\n\t\t\t\tresults.forEach((oneResult) => result = result.concat(oneResult));\n\n\t\t\t\treturn result;\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate findMatchingOpenTag(scanner: IHTMLScanner) : string {\n\t\tlet closedTags : { [name:string]: number } = {};\n\t\tlet tagClosed = false;\n\t\twhile (scanner.scanBack()) {\n\t\t\tif (isTag(scanner.getTokenType()) && !tagClosed) {\n\t\t\t\tlet tag = scanner.getTokenContent();\n\t\t\t\tscanner.scanBack();\n\t\t\t\tif (scanner.getTokenType() === DELIM_END) {\n\t\t\t\t\tclosedTags[tag] = (closedTags[tag] || 0) + 1;\n\t\t\t\t} else if (!isEmptyElement(tag)) {\n\t\t\t\t\tif (closedTags[tag]) {\n\t\t\t\t\t\tclosedTags[tag]--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn tag;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (scanner.getTokenType() === DELIM_START) {\n\t\t\t\ttagClosed = scanner.getTokenContent() === '/>';\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate collectTagSuggestions(scanner: IHTMLScanner, position: editorCommon.IPosition, suggestions: modes.ISuggestResult): void {\n\t\tlet model = scanner.getModel();\n\t\tlet currentLine = model.getLineContent(position.lineNumber);\n\t\tlet contentAfter = currentLine.substr(position.column - 1);\n\t\tlet closeTag = isWhiteSpace(contentAfter) || strings.startsWith(contentAfter, '<') ? '>' : '';\n\n\t\tlet collectClosingTagSuggestion = (overwriteBefore: number) => {\n\t\t\tlet endPosition = scanner.getTokenPosition();\n\t\t\tlet matchingTag = this.findMatchingOpenTag(scanner);\n\t\t\tif (matchingTag) {\n\t\t\t\tlet suggestion : modes.ISuggestion = {\n\t\t\t\t\tlabel: '/' + matchingTag,\n\t\t\t\t\tcodeSnippet: '/' + matchingTag + closeTag,\n\t\t\t\t\toverwriteBefore: overwriteBefore,\n\t\t\t\t\ttype: 'property'\n\t\t\t\t};\n\t\t\t\tsuggestions.suggestions.push(suggestion);\n\n\t\t\t\t// use indent from start tag\n\t\t\t\tlet startPosition = scanner.getTokenPosition();\n\t\t\t\tif (endPosition.lineNumber !== startPosition.lineNumber) {\n\t\t\t\t\tlet startIndent = model.getLineContent(startPosition.lineNumber).substring(0, startPosition.column - 1);\n\t\t\t\t\tlet endIndent = model.getLineContent(endPosition.lineNumber).substring(0, endPosition.column - 1);\n\t\t\t\t\tif (isWhiteSpace(startIndent) && isWhiteSpace(endIndent)) {\n\t\t\t\t\t\tsuggestion.overwriteBefore = position.column - 1; // replace from start of line\n\t\t\t\t\t\tsuggestion.codeSnippet = startIndent + '</' + matchingTag + closeTag;\n\t\t\t\t\t\tsuggestion.filterText = currentLine.substring(0, position.column - 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\n\t\tif (scanner.getTokenType() === DELIM_END) {\n\t\t\tlet hasClose = collectClosingTagSuggestion(suggestions.currentWord.length + 1);\n\t\t\tif (!hasClose) {\n\t\t\t\tthis._tagProviders.forEach((provider) => {\n\t\t\t\t\tprovider.collectTags((tag, label) => {\n\t\t\t\t\t\tsuggestions.suggestions.push({\n\t\t\t\t\t\t\tlabel: '/' + tag,\n\t\t\t\t\t\t\toverwriteBefore: suggestions.currentWord.length + 1,\n\t\t\t\t\t\t\tcodeSnippet: '/' + tag + closeTag,\n\t\t\t\t\t\t\ttype: 'property',\n\t\t\t\t\t\t\tdocumentationLabel: label\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tcollectClosingTagSuggestion(suggestions.currentWord.length);\n\n\t\t\tthis._tagProviders.forEach((provider) => {\n\t\t\t\tprovider.collectTags((tag, label) => {\n\t\t\t\t\tsuggestions.suggestions.push({\n\t\t\t\t\t\tlabel: tag,\n\t\t\t\t\t\tcodeSnippet: tag,\n\t\t\t\t\t\ttype: 'property',\n\t\t\t\t\t\tdocumentationLabel: label\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t}\n\n\tprivate collectContentSuggestions(suggestions: modes.ISuggestResult): void {\n\t\t// disable the simple snippets in favor of the emmet templates\n\t}\n\n\tprivate collectAttributeSuggestions(scanner: IHTMLScanner, suggestions: modes.ISuggestResult): void {\n\t\tlet parentTag: string = null;\n\t\tdo {\n\t\t\tif (isTag(scanner.getTokenType())) {\n\t\t\t\tparentTag = scanner.getTokenContent();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (scanner.getTokenType() === DELIM_START) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} while (scanner.scanBack());\n\n\t\tthis._tagProviders.forEach((provider) => {\n\t\t\tprovider.collectAttributes(parentTag,(attribute, type) => {\n\t\t\t\tlet codeSnippet = attribute;\n\t\t\t\tif (type !== 'v') {\n\t\t\t\t\tcodeSnippet = codeSnippet + '=\"{{}}\"';\n\t\t\t\t}\n\t\t\t\tsuggestions.suggestions.push({\n\t\t\t\t\tlabel: attribute,\n\t\t\t\t\tcodeSnippet: codeSnippet,\n\t\t\t\t\ttype: type === 'handler' ? 'function' : 'value'\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate collectAttributeValueSuggestions(scanner: IHTMLScanner, suggestions:  modes.ISuggestResult): void {\n\t\tlet needsQuotes = scanner.getTokenType() === DELIM_ASSIGN;\n\n\t\tlet attribute: string = null;\n\t\tlet parentTag: string = null;\n\t\twhile (scanner.scanBack()) {\n\t\t\tif (scanner.getTokenType() === ATTRIB_NAME) {\n\t\t\t\tattribute = scanner.getTokenContent();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\twhile (scanner.scanBack()) {\n\t\t\tif (isTag(scanner.getTokenType())) {\n\t\t\t\tparentTag = scanner.getTokenContent();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (scanner.getTokenType() === DELIM_START) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._tagProviders.forEach((provider) => {\n\t\t\tprovider.collectValues(parentTag, attribute,(value) => {\n\t\t\t\tsuggestions.suggestions.push({\n\t\t\t\t\tlabel: value,\n\t\t\t\t\tcodeSnippet: needsQuotes ? '\"' + value + '\"' : value,\n\t\t\t\t\ttype: 'unit'\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic provideCompletionItems(resource:URI, position:editorCommon.IPosition):winjs.TPromise<modes.ISuggestResult[]> {\n\t\treturn this._delegateToModeAtPosition(resource, position, (isEmbeddedMode, model) => {\n\t\t\tif (isEmbeddedMode) {\n\t\t\t\treturn provideCompletionItems(model, Position.lift(position));\n\t\t\t}\n\n\t\t\treturn this.suggestHTML(resource, position);\n\t\t});\n\t}\n\n\tprivate suggestHTML(resource:URI, position:editorCommon.IPosition):winjs.TPromise<modes.ISuggestResult[]> {\n\t\treturn this.doSuggest(resource, position).then(value => filterSuggestions(value));\n\t}\n\n\tprivate doSuggest(resource: URI, position: editorCommon.IPosition): winjs.TPromise<modes.ISuggestResult> {\n\n\t\tlet model = this.resourceService.get(resource),\n\t\t\tcurrentWord = model.getWordUntilPosition(position).word;\n\n\t\tlet suggestions: modes.ISuggestResult = {\n\t\t\tcurrentWord: currentWord,\n\t\t\tsuggestions: [],\n\t\t};\n\n\t\tlet scanner = getScanner(model, position);\n\t\tswitch (scanner.getTokenType()) {\n\t\t\tcase DELIM_START:\n\t\t\tcase DELIM_END:\n\t\t\t\tif (scanner.isOpenBrace()) {\n\t\t\t\t\tthis.collectTagSuggestions(scanner, position, suggestions);\n\t\t\t\t} else {\n\t\t\t\t\tthis.collectContentSuggestions(suggestions);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase ATTRIB_NAME:\n\t\t\t\tthis.collectAttributeSuggestions(scanner, suggestions);\n\t\t\t\tbreak;\n\t\t\tcase ATTRIB_VALUE:\n\t\t\t\tthis.collectAttributeValueSuggestions(scanner, suggestions);\n\t\t\t\tbreak;\n\t\t\tcase DELIM_ASSIGN:\n\t\t\t\tif (scanner.isAtTokenEnd()) {\n\t\t\t\t\tthis.collectAttributeValueSuggestions(scanner, suggestions);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase '':\n\t\t\t\tif (isWhiteSpace(scanner.getTokenContent()) && scanner.scanBack()) { // go one back\n\t\t\t\t\tswitch (scanner.getTokenType()) {\n\t\t\t\t\t\tcase ATTRIB_VALUE:\n\t\t\t\t\t\tcase ATTRIB_NAME:\n\t\t\t\t\t\t\tthis.collectAttributeSuggestions(scanner, suggestions);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase DELIM_ASSIGN:\n\t\t\t\t\t\t\tthis.collectAttributeValueSuggestions(scanner, suggestions);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase DELIM_START:\n\t\t\t\t\t\tcase DELIM_END:\n\t\t\t\t\t\t\tif (scanner.isOpenBrace()) {\n\t\t\t\t\t\t\t\tthis.collectTagSuggestions(scanner, position, suggestions);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.collectContentSuggestions(suggestions);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif (isTag(scanner.getTokenType())) {\n\t\t\t\t\t\t\t\tthis.collectAttributeSuggestions(scanner, suggestions);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.collectContentSuggestions(suggestions);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (isTag(scanner.getTokenType())) {\n\t\t\t\t\tscanner.scanBack(); // one back to the end/start bracket\n\t\t\t\t\tthis.collectTagSuggestions(scanner, position, suggestions);\n\t\t\t\t}\n\t\t}\n\t\treturn winjs.TPromise.as(suggestions);\n\t}\n\n\tprivate findMatchingBracket(tagname: string, scanner: IHTMLScanner) : editorCommon.IRange {\n\t\tif (isEmptyElement(tagname)) {\n\t\t\treturn null;\n\t\t}\n\t\tlet tagCount = 0;\n\t\tscanner.scanBack(); // one back to the end/start bracket\n\t\tif (scanner.getTokenType() === DELIM_END) {\n\t\t\t// find the opening tag\n\t\t\tlet tagClosed = false;\n\t\t\twhile (scanner.scanBack()) {\n\t\t\t\tif (isTag(scanner.getTokenType()) && scanner.getTokenContent() === tagname && !tagClosed) {\n\t\t\t\t\tlet range = scanner.getTokenRange();\n\t\t\t\t\tscanner.scanBack(); // one back to the end/start bracket\n\t\t\t\t\tif (scanner.getTokenType() === DELIM_START) {\n\t\t\t\t\t\tif (tagCount === 0) {\n\t\t\t\t\t\t\treturn range;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttagCount--;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttagCount++;\n\t\t\t\t\t}\n\t\t\t\t} else if (scanner.getTokenType() === DELIM_START) {\n\t\t\t\t\ttagClosed = scanner.getTokenContent() === '/>';\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tlet isTagEnd = false;\n\t\t\twhile (scanner.scanForward()) {\n\t\t\t\tif (isTag(scanner.getTokenType()) && scanner.getTokenContent() === tagname) {\n\t\t\t\t\tif (!isTagEnd) {\n\t\t\t\t\t\tscanner.scanForward();\n\t\t\t\t\t\tif (scanner.getTokenType() === DELIM_START && scanner.getTokenContent() === '/>') {\n\t\t\t\t\t\t\tif (tagCount <= 0) {\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttagCount++;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttagCount--;\n\t\t\t\t\t\tif (tagCount <= 0) {\n\t\t\t\t\t\t\treturn scanner.getTokenRange();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (scanner.getTokenType() === DELIM_START) {\n\t\t\t\t\tisTagEnd = false;\n\t\t\t\t} else if (scanner.getTokenType() === DELIM_END) {\n\t\t\t\t\tisTagEnd = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\n\t}\n\n\tpublic provideDocumentHighlights(resource:URI, position:editorCommon.IPosition, strict:boolean = false): winjs.TPromise<modes.DocumentHighlight[]> {\n\t\tlet model = this.resourceService.get(resource),\n\t\t\twordAtPosition = model.getWordAtPosition(position),\n\t\t\tcurrentWord = (wordAtPosition ? wordAtPosition.word : ''),\n\t\t\tresult:modes.DocumentHighlight[] = [];\n\n\n\t\tlet scanner = getScanner(model, position);\n\t\tif (isTag(scanner.getTokenType())) {\n\t\t\tlet tagname = scanner.getTokenContent();\n\t\t\tresult.push({\n\t\t\t\trange: scanner.getTokenRange(),\n\t\t\t\tkind: modes.DocumentHighlightKind.Read\n\t\t\t});\n\t\t\tlet range = this.findMatchingBracket(tagname, scanner);\n\t\t\tif (range) {\n\t\t\t\tresult.push({\n\t\t\t\t\trange: range,\n\t\t\t\t\tkind: modes.DocumentHighlightKind.Read\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tlet words = model.getAllWordsWithRange(),\n\t\t\t\tupperBound = Math.min(1000, words.length); // Limit find occurences to 1000 occurences\n\n\t\t\tfor(let i = 0; i < upperBound; i++) {\n\t\t\t\tif(words[i].text === currentWord) {\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\trange: words[i].range,\n\t\t\t\t\tkind: modes.DocumentHighlightKind.Read\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn winjs.TPromise.as(result);\n\t}\n\n\tprivate static _stripQuotes(url: string): string {\n\t\treturn url\n\t\t\t.replace(/^'([^']+)'$/,(substr, match1) => match1)\n\t\t\t.replace(/^\"([^\"]+)\"$/,(substr, match1) => match1);\n\t}\n\n\tpublic static _getWorkspaceUrl(modelAbsoluteUri: URI, rootAbsoluteUri: URI, tokenContent: string): string {\n\t\ttokenContent = HTMLWorker._stripQuotes(tokenContent);\n\n\t\tif (/^\\s*javascript\\:/i.test(tokenContent) || /^\\s*\\#/i.test(tokenContent)) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (/^\\s*https?:\\/\\//i.test(tokenContent) || /^\\s*file:\\/\\//i.test(tokenContent)) {\n\t\t\t// Absolute link that needs no treatment\n\t\t\treturn tokenContent.replace(/^\\s*/g, '');\n\t\t}\n\n\t\tif (/^\\s*\\/\\//i.test(tokenContent)) {\n\t\t\t// Absolute link (that does not name the protocol)\n\t\t\tlet pickedScheme = network.Schemas.http;\n\t\t\tif (modelAbsoluteUri.scheme === network.Schemas.https) {\n\t\t\t\tpickedScheme = network.Schemas.https;\n\t\t\t}\n\t\t\treturn pickedScheme + ':' + tokenContent.replace(/^\\s*/g, '');\n\t\t}\n\n\t\tlet modelPath = paths.dirname(modelAbsoluteUri.path);\n\t\tlet alternativeResultPath: string = null;\n\t\tif (tokenContent.length > 0 && tokenContent.charAt(0) === '/') {\n\t\t\talternativeResultPath = tokenContent;\n\t\t} else {\n\t\t\talternativeResultPath = paths.join(modelPath, tokenContent);\n\t\t\talternativeResultPath = alternativeResultPath.replace(/^(\\/\\.\\.)+/, '');\n\t\t}\n\t\tlet potentialResult = modelAbsoluteUri.with({ path: alternativeResultPath }).toString();\n\n\t\tlet rootAbsoluteUrlStr = (rootAbsoluteUri ? rootAbsoluteUri.toString() : null);\n\t\tif (rootAbsoluteUrlStr && strings.startsWith(modelAbsoluteUri.toString(), rootAbsoluteUrlStr)) {\n\t\t\t// The `rootAbsoluteUrl` is set and matches our current model\n\t\t\t// We need to ensure that this `potentialResult` does not escape `rootAbsoluteUrl`\n\n\t\t\tlet commonPrefixLength = strings.commonPrefixLength(rootAbsoluteUrlStr, potentialResult);\n\t\t\tif (strings.endsWith(rootAbsoluteUrlStr, '/')) {\n\t\t\t\tcommonPrefixLength = potentialResult.lastIndexOf('/', commonPrefixLength) + 1;\n\t\t\t}\n\t\t\treturn rootAbsoluteUrlStr + potentialResult.substr(commonPrefixLength);\n\t\t}\n\n\t\treturn potentialResult;\n\t}\n\n\tprivate createLink(modelAbsoluteUrl: URI, rootAbsoluteUrl: URI, tokenContent: string, lineNumber: number, startColumn: number, endColumn: number): modes.ILink {\n\t\tlet workspaceUrl = HTMLWorker._getWorkspaceUrl(modelAbsoluteUrl, rootAbsoluteUrl, tokenContent);\n\t\tif (!workspaceUrl) {\n\t\t\treturn null;\n\t\t}\n\t\t//\t\tconsole.info('workspaceUrl: ' + workspaceUrl);\n\n\t\treturn {\n\t\t\trange: {\n\t\t\t\tstartLineNumber: lineNumber,\n\t\t\t\tstartColumn: startColumn,\n\t\t\t\tendLineNumber: lineNumber,\n\t\t\t\tendColumn: endColumn\n\t\t\t},\n\t\t\turl: workspaceUrl\n\t\t};\n\t}\n\n\tprivate _computeHTMLLinks(model: editorCommon.IMirrorModel): modes.ILink[] {\n\t\tlet lineCount = model.getLineCount(),\n\t\t\tnewLinks: modes.ILink[] = [],\n\t\t\tstate: LinkDetectionState = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC,\n\t\t\tmodelAbsoluteUrl = model.uri,\n\t\t\tlineNumber: number,\n\t\t\tlineContent: string,\n\t\t\tlineContentLength: number,\n\t\t\ttokens: editorCommon.ILineTokens,\n\t\t\ttokenType: string,\n\t\t\ttokensLength: number,\n\t\t\ti: number,\n\t\t\tnextTokenEndIndex: number,\n\t\t\ttokenContent: string,\n\t\t\tlink: modes.ILink;\n\n\t\tlet rootAbsoluteUrl: URI = null;\n\t\tlet workspace = this._contextService.getWorkspace();\n\t\tif (workspace) {\n\t\t\t// The workspace can be null in the no folder opened case\n\t\t\tlet strRootAbsoluteUrl = String(workspace.resource);\n\t\t\tif (strRootAbsoluteUrl.charAt(strRootAbsoluteUrl.length - 1) === '/') {\n\t\t\t\trootAbsoluteUrl = URI.parse(strRootAbsoluteUrl);\n\t\t\t} else {\n\t\t\t\trootAbsoluteUrl = URI.parse(strRootAbsoluteUrl + '/');\n\t\t\t}\n\t\t}\n\n\t\tfor (lineNumber = 1; lineNumber <= lineCount; lineNumber++) {\n\t\t\tlineContent = model.getLineContent(lineNumber);\n\t\t\tlineContentLength = lineContent.length;\n\t\t\ttokens = model.getLineTokens(lineNumber);\n\n\t\t\tfor (i = 0, tokensLength = tokens.getTokenCount(); i < tokensLength; i++) {\n\n\t\t\t\ttokenType = tokens.getTokenType(i);\n\n\t\t\t\tswitch (tokenType) {\n\t\t\t\t\tcase DELIM_ASSIGN:\n\t\t\t\t\tcase '':\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ATTRIB_NAME:\n\t\t\t\t\t\tnextTokenEndIndex = tokens.getTokenEndIndex(i, lineContentLength);\n\t\t\t\t\t\ttokenContent = lineContent.substring(tokens.getTokenStartIndex(i), nextTokenEndIndex).toLowerCase();\n\n\t\t\t\t\t\tif (tokenContent === 'src' || tokenContent === 'href') {\n\t\t\t\t\t\t\tstate = LinkDetectionState.AFTER_HREF_OR_SRC;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstate = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase ATTRIB_VALUE:\n\t\t\t\t\t\tif (state === LinkDetectionState.AFTER_HREF_OR_SRC) {\n\t\t\t\t\t\t\tnextTokenEndIndex = tokens.getTokenEndIndex(i, lineContentLength);\n\t\t\t\t\t\t\ttokenContent = lineContent.substring(tokens.getTokenStartIndex(i), nextTokenEndIndex);\n\n\t\t\t\t\t\t\tlink = this.createLink(modelAbsoluteUrl, rootAbsoluteUrl, tokenContent, lineNumber, tokens.getTokenStartIndex(i) + 2, nextTokenEndIndex);\n\t\t\t\t\t\t\tif (link) {\n\t\t\t\t\t\t\t\tnewLinks.push(link);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tstate = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\n\t\t\t\t\t\t}\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (isTag(tokenType)) {\n\t\t\t\t\t\t\tstate = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\n\t\t\t\t\t\t} else if (state === LinkDetectionState.AFTER_HREF_OR_SRC) {\n\t\t\t\t\t\t\tstate = LinkDetectionState.LOOKING_FOR_HREF_OR_SRC;\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn newLinks;\n\t}\n\n\tpublic provideLinks(resource: URI): winjs.TPromise<modes.ILink[]> {\n\t\tlet model = this.resourceService.get(resource);\n\t\treturn winjs.TPromise.as(this._computeHTMLLinks(model));\n\t}\n}\n\nfunction isWhiteSpace(s:string) : boolean {\n\treturn /^\\s*$/.test(s);\n}\n"]}