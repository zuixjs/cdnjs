/*!
 * js-data
 * @version 2.6.0 - Homepage <http://www.js-data.io/>
 * @author Jason Dobry <jason.dobry@gmail.com>
 * @copyright (c) 2014-2015 Jason Dobry 
 * @license MIT <https://github.com/js-data/js-data/blob/master/LICENSE>
 * 
 * @overview Robust framework-agnostic data store.
 */
(function webpackUniversalModuleDefinition(a,b){if(typeof exports==="object"&&typeof module==="object"){module.exports=b()}else{if(typeof define==="function"&&define.amd){define([],b)}else{if(typeof exports==="object"){exports.JSData=b()}else{a.JSData=b()}}}})(this,function(){return(function(a){var b={};function c(e){if(b[e]){return b[e].exports}var d=b[e]={exports:{},id:e,loaded:false};a[e].call(d.exports,d,d.exports,c);d.loaded=true;return d.exports}c.m=a;c.c=b;c.p="";return c(0)})([function(d,a,g){var e=g(1);var f=g(2);var c=g(3);d.exports={DS:e["default"],DSUtils:f["default"],DSErrors:c["default"],createStore:function b(h){return new e["default"](h)},version:{full:"2.6.0",major:parseInt("2",10),minor:parseInt("6",10),patch:parseInt("0",10),alpha:true?"false":false,beta:true?"false":false}}},function(g,j,f){var h=(function(){function r(v,t){for(var s=0;s<t.length;s++){var u=t[s];u.enumerable=u.enumerable||false;u.configurable=true;if("value" in u){u.writable=true}Object.defineProperty(v,u.key,u)}}return function(u,s,t){if(s){r(u.prototype,s)}if(t){r(u,t)}return u}})();function l(r,s){if(!(r instanceof s)){throw new TypeError("Cannot call a class as a function")}}var q=f(2);var i=f(3);var n=f(30);var k=f(36);function p(t,s,r){r(null,s)}function d(s,r){return r}function e(B,A,w,t){var u=true;_function:while(u){var z=B,s=A,C=w,y=t;r=x=v=undefined;u=false;var r=z[s];var x=q["default"].get(C,r[0]);var v=q["default"].get(y,r[0]);if(q["default"]._s(x)){x=q["default"].upperCase(x)}if(q["default"]._s(v)){v=q["default"].upperCase(v)}if(r[1]==="DESC"){if(v<x){return -1}else{if(v>x){return 1}else{if(s<z.length-1){B=z;A=s+1;w=C;t=y;u=true;continue _function}else{return 0}}}}else{if(x<v){return -1}else{if(x>v){return 1}else{if(s<z.length-1){B=z;A=s+1;w=C;t=y;u=true;continue _function}else{return 0}}}}}}var c=(function(){function r(){l(this,r)}h(r,[{key:"errorFn",value:function s(u,t){if(this.error&&typeof this.error==="function"){try{if(typeof u==="string"){throw new Error(u)}else{throw u}}catch(v){u=v}this.error(this.name||null,u||null,t||null)}}}]);return r})();var m=c.prototype;m.actions={};m.afterCreate=p;m.afterCreateCollection=d;m.afterCreateInstance=d;m.afterDestroy=p;m.afterEject=d;m.afterFind=p;m.afterFindAll=p;m.afterInject=d;m.afterLoadRelations=p;m.afterReap=d;m.afterUpdate=p;m.afterValidate=p;m.allowSimpleWhere=true;m.basePath="";m.beforeCreate=p;m.beforeCreateCollection=d;m.beforeCreateInstance=d;m.beforeDestroy=p;m.beforeEject=d;m.beforeInject=d;m.beforeReap=d;m.beforeUpdate=p;m.beforeValidate=p;m.bypassCache=false;m.cacheResponse=!!q["default"].w;m.clearEmptyQueries=true;m.computed={};m.defaultAdapter="http";m.debug=false;m.defaultValues={};m.eagerEject=false;m.eagerInject=false;m.endpoint="";m.error=console?function(s,r,t){return console[typeof console.error==="function"?"error":"log"](s,r,t)}:false;m.errorHandler=function(){return q["default"].Promise.reject(arguments[0])};m.fallbackAdapters=["http"];m.findStrictCache=false;m.idAttribute="id";m.ignoredChanges=[/\$/];m.instanceEvents=!!q["default"].w;m.keepChangeHistory=false;m.linkRelations=!!q["default"].w;m.log=console?function(s,r,v,u,t){return console[typeof console.info==="function"?"info":"log"](s,r,v,u,t)}:false;m.logFn=function(s,r,v,t){var u=this;if(u.debug&&u.log&&typeof u.log==="function"){u.log(u.name||null,s||null,r||null,v||null,t||null)}};m.maxAge=false;m.methods={};m.notify=!!q["default"].w;m.omit=[];m.onConflict="merge";m.reapAction=q["default"].w?"inject":"none";m.reapInterval=q["default"].w?30000:false;m.relationsEnumerable=false;m.resetHistoryOnInject=true;m.returnMeta=false;m.scopes={};m.strategy="single";m.upsert=!!q["default"].w;m.useClass=true;m.useFilter=false;m.validate=p;m.watchChanges=!!q["default"].w;m.defaultFilter=function(v,w,t,A){var x=v;var u=null;var r={skip:"",offset:"",where:"",limit:"",orderBy:"",sort:""};t=t||{};A=A||{};if(q["default"]._o(t.where)){u=t.where}else{u={}}if(A.allowSimpleWhere){q["default"].forOwn(t,function(C,B){if(!(B in r)&&!(B in u)){u[B]={"==":C}}})}if(q["default"].isEmpty(u)){u=null}if(u){x=q["default"].filter(x,function(C){var D=true;var B=true;q["default"].forOwn(u,function(F,E){if(!q["default"]._o(F)){F={"==":F}}q["default"].forOwn(F,function(G,K){var I=undefined;var H=K[0]==="|";var J=q["default"].get(C,E);K=H?K.substr(1):K;if(K==="=="){I=J==G}else{if(K==="==="){I=J===G}else{if(K==="!="){I=J!=G}else{if(K==="!=="){I=J!==G}else{if(K===">"){I=J>G}else{if(K===">="){I=J>=G}else{if(K==="<"){I=J<G}else{if(K==="<="){I=J<=G}else{if(K==="isectEmpty"){I=!q["default"].intersection(J||[],G||[]).length}else{if(K==="isectNotEmpty"){I=q["default"].intersection(J||[],G||[]).length}else{if(K==="in"){if(q["default"]._s(G)){I=G.indexOf(J)!==-1}else{I=q["default"].contains(G,J)}}else{if(K==="notIn"){if(q["default"]._s(G)){I=G.indexOf(J)===-1}else{I=!q["default"].contains(G,J)}}else{if(K==="contains"){if(q["default"]._s(J)){I=J.indexOf(G)!==-1}else{I=q["default"].contains(J,G)}}else{if(K==="notContains"){if(q["default"]._s(J)){I=J.indexOf(G)===-1}else{I=!q["default"].contains(J,G)}}}}}}}}}}}}}}}if(I!==undefined){B=D?I:H?B||I:B&&I}D=false})});return B})}var y=null;if(q["default"]._s(t.orderBy)){y=[[t.orderBy,"ASC"]]}else{if(q["default"]._a(t.orderBy)){y=t.orderBy}}if(!y&&q["default"]._s(t.sort)){y=[[t.sort,"ASC"]]}else{if(!y&&q["default"]._a(t.sort)){y=t.sort}}if(y){(function(){var B=0;q["default"].forEach(y,function(D,C){if(q["default"]._s(D)){y[C]=[D,"ASC"]}else{if(!q["default"]._a(D)){throw new i["default"].IA('DS.filter("'+w+'"[, params][, options]): '+q["default"].toJson(D)+": Must be a string or an array!",{params:{"orderBy[i]":{actual:typeof D,expected:"string|array"}}})}}});x=q["default"].sort(x,function(D,C){return e(y,B,D,C)})})()}var s=q["default"]._n(t.limit)?t.limit:null;var z=null;if(q["default"]._n(t.skip)){z=t.skip}else{if(q["default"]._n(t.offset)){z=t.offset}}if(s&&z){x=q["default"].slice(x,z,Math.min(x.length,z+s))}else{if(q["default"]._n(s)){x=q["default"].slice(x,0,Math.min(x.length,s))}else{if(q["default"]._n(z)){if(z<x.length){x=q["default"].slice(x,z)}else{x=[]}}}}return x===v?x.slice():x};var o=(function(){function u(y){l(this,u);var A=this;y=y||{};A.store={};A.definitions={};A.adapters={};A.defaults=new c();A.observe=q["default"].observe;q["default"].forOwn(y,function(C,B){if(B==="omit"){A.defaults.omit=C.concat(c.prototype.omit)}else{A.defaults[B]=C}});A.defaults.logFn("new data store created",A.defaults);var z=q["default"].Promise;if(z&&!z.prototype.spread){z.prototype.spread=function(B){return this.then(function(C){return B.apply(this,C)})}}q["default"].Events(A)}h(u,[{key:"getAdapterName",value:function x(y){var z=false;y=y||{};this.defaults.logFn("getAdapterName",y);if(q["default"]._s(y)){z=true;y={adapter:y}}if(this.adapters[y.adapter]){return y.adapter}else{if(z){throw new Error(y.adapter+" is not a registered adapter!")}else{return y.defaultAdapter}}}},{key:"getAdapter",value:function s(y){y=y||{};this.defaults.logFn("getAdapter",y);return this.adapters[this.getAdapterName(y)]}},{key:"registerAdapter",value:function v(z,B,y){var A=this;y=y||{};A.defaults.logFn("registerAdapter",z,B,y);if(q["default"].isFunction(B)){A.adapters[z]=new B(y)}else{A.adapters[z]=B}if(y["default"]){A.defaults.defaultAdapter=z}A.defaults.logFn("default adapter is "+A.defaults.defaultAdapter)}},{key:"is",value:function t(A,y){var z=this.definitions[A];if(!z){throw new i["default"].NER(A)}return y instanceof z[z["class"]]}},{key:"clear",value:function r(){var y=this;var z={};q["default"].forOwn(this.definitions,function(B){var A=B.name;z[A]=B.ejectAll();y.store[A].completedQueries={};y.store[A].queryData={}});return z}},{key:"errorFn",value:function w(){for(var y=arguments.length,C=Array(y),D=0;D<y;D++){C[D]=arguments[D]}var B=C[C.length-1];var A=this.defaults.errorHandler;var z=B?B.errorHandler:A;z=z||A;return function(E){return z.apply(undefined,[E].concat(C))}}}]);return u})();var b=o.prototype;b.getAdapterName.shorthand=false;b.getAdapter.shorthand=false;b.registerAdapter.shorthand=false;b.errors=i["default"];b.utils=q["default"];function a(s,r){q["default"].forOwn(r,function(u,t){s[t]=u;s[t].before=function(v){var w=s[t];s[t]=function(){for(var x=arguments.length,z=Array(x),y=0;y<x;y++){z[y]=arguments[y]}return w.apply(this,v.apply(this,z)||z)}}})}a(b,n["default"]);a(b,k["default"]);j["default"]=o},function(j,Z,p){var Q=p(3);var h=p(4);var f=p(5);var u=p(6);var ad=p(7);var N=p(10);var T=p(12);var c=p(14);var H=p(21);var A=p(22);var J=p(23);var ae=p(24);var I=p(19);var aa=p(25);var G=p(27);var k=p(29);var U=undefined,o=undefined,t=undefined;var g=Object.prototype;var m=g.toString;try{o=Promise}catch(af){console.error("js-data requires a global Promise constructor!")}try{t=window.File}catch(af){t=function(){}}function ah(e){return m.call(e)==="[object Array]"||false}var F=Array.isArray||ah;function n(e){return m.call(e)==="[object RegExp]"||false}function s(e){return typeof e==="string"||e&&typeof e==="object"&&m.call(e)==="[object String]"||false}function S(e){return m.call(e)==="[object Object]"||false}function E(e){return e&&typeof e==="object"&&m.call(e)==="[object Date]"||false}function ak(w){var e=typeof w;return e==="number"||w&&e==="object"&&m.call(w)==="[object Number]"||false}function v(e){return typeof e==="function"||e&&m.call(e)==="[object Function]"||false}function b(e){return s(e)||ak(e)}function ag(e){return new Q["default"].IA('"'+e+'" must be a string or a number!')}function L(e){return new Q["default"].IA('"'+e+'" must be an object!')}function W(e){return new Q["default"].IA('"'+e+'" must be an array!')}function x(w){if(w==null){return true}else{if(typeof w==="string"||F(w)){return !w.length}else{if(typeof w==="object"){var e=true;ad(w,function(){e=false;return false});return e}else{return true}}}}function i(an,am){if(!an||!am){return[]}var e=[];var P=undefined;for(var w=0,ao=an.length;w<ao;w++){P=an[w];if(N(e,P)){continue}if(N(am,P)){e.push(P)}}return e}function O(am,e,P){var w=[];f(am,function(ap,ao,an){if(e(ap,ao,an)){w.push(ap)}},P);return w}try{U=window;U={}}catch(af){U=null}function ai(P){var e={};P=P||this;Object.defineProperties(P,{on:{value:function w(an,ao,am){e[an]=e[an]||[];e[an].push({f:ao,c:am})}},off:{value:function w(ao,ap){var an=e[ao];if(!an){e={}}else{if(ap){for(var am=0;am<an.length;am++){if(an[am].f===ap){an.splice(am,1);break}}}else{an.splice(0,an.length)}}}},emit:{value:function w(){for(var am=arguments.length,an=Array(am),aq=0;aq<am;aq++){an[aq]=arguments[aq]}var ap=e[an.shift()]||[];if(ap){for(var ao=0;ao<ap.length;ao++){ap[ao].f.apply(ap[ao].c,an)}}}}})}var a=["beforeValidate","validate","afterValidate","beforeCreate","afterCreate","beforeUpdate","afterUpdate","beforeDestroy","afterDestroy"];var ab=k.isBlacklisted;function aj(e,ap,w,ao,P){if(!ap){ap=e;if(e){if(F(e)){ap=aj(e,[],w,ao,P)}else{if(E(e)){ap=new Date(e.getTime())}else{if(n(e)){ap=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0]);ap.lastIndex=e.lastIndex}else{if(S(e)){ap=aj(e,Object.create(Object.getPrototypeOf(e)),w,ao,P)}}}}}}else{if(e===ap){throw new Error("Cannot copy! Source and destination are identical.")}w=w||[];ao=ao||[];if(S(e)){var an=w.indexOf(e);if(an!==-1){return ao[an]}w.push(e);ao.push(ap)}var ar=undefined;if(F(e)){var am=undefined;ap.length=0;for(am=0;am<e.length;am++){ar=aj(e[am],null,w,ao,P);if(S(e[am])){w.push(e[am]);ao.push(ar)}ap.push(ar)}}else{if(F(ap)){ap.length=0}else{f(ap,function(au,at){delete ap[at]})}for(var aq in e){if(e.hasOwnProperty(aq)){if(ab(aq,P)){continue}ar=aj(e[aq],null,w,ao,P);if(S(e[aq])){w.push(e[aq]);ao.push(ar)}ap[aq]=ar}}}}return ap}function K(ar,aq){var ap=true;_function:while(ap){var P=ar,w=aq;ao=an=e=at=am=undefined;ap=false;if(P===w){return true}if(P===null||w===null){return false}if(P!==P&&w!==w){return true}var ao=typeof P;var an=typeof w;var e,at,am;if(ao==an){if(ao=="object"){if(F(P)){if(!F(w)){return false}if((e=P.length)===w.length){for(at=0;at<e;at++){if(!K(P[at],w[at])){return false}}return true}}else{if(E(P)){if(!E(w)){return false}ar=P.getTime();aq=w.getTime();ap=true;continue _function}else{if(n(P)&&n(w)){return P.toString()==w.toString()}else{if(F(w)){return false}am={};for(at in P){if(at.charAt(0)==="$"||v(P[at])){continue}if(!K(P[at],w[at])){return false}am[at]=true}for(at in w){if(!am.hasOwnProperty(at)&&at.charAt(0)!=="$"&&w[at]!==undefined&&!v(w[at])){return false}}return true}}}}}return false}}function y(w,e){if(s(e)||ak(e)){return e}else{if(e&&w){return e[w.idAttribute]||e}else{return e}}}function z(w,e){if(w&&(s(e)||ak(e))){return w.index[e]||e}else{return e}}function D(e){return e!=null&&e!==""}function r(e,w){w=w||"";return O(e,D).join(w)}function d(){for(var w=arguments.length,am=Array(w),P=0;P<w;P++){am[P]=arguments[P]}var e=r(am,"/");return e.replace(/([^:\/]|^)\/{2,}/g,"$1/")}Z["default"]={Promise:o,_:function al(P,w){var an=this;P=P||{};w=w||{};if(w&&w.constructor===P.constructor){return w}else{if(!S(w)){throw new Q["default"].IA('"options" must be an object!')}}f(a,function(ao){if(typeof w[ao]==="function"&&w[ao].toString().indexOf("for (var _len = arg")===-1){w[ao]=an.promisify(w[ao])}});var am=function e(ap){var ao=this;ad(ap,function(ar,aq){ao[aq]=ar})};am.prototype=P;am.prototype.orig=function(){var ao={};ad(this,function(aq,ap){ao[ap]=aq});return ao};return new am(w)},_n:ak,_s:s,_sn:b,_snErr:ag,_o:S,_oErr:L,_a:F,_aErr:W,applyScope:function Y(P,an,w){var am=w.scope;var e=aj(an);if(am){if(s(am)){am=[am]}}else{am=[]}am.unshift("defaultScope");f(am,function(ao){var ap=w.scopes[ao];if(typeof ap==="function"){T(an,ap(P))}else{if(ap){T(an,ap)}}});T(an,e)},compute:function q(w,P){var am=this;var e=[];if(!S(w)){f(w.deps,function(an){e.push(aa(am,an))});G(am,P,w[w.length-1].apply(am,e))}},contains:N,copy:aj,deepMixIn:T,diffObjectFromOldObject:k.diffObjectFromOldObject,BinaryHeap:h,equals:K,Events:ai,filter:O,fillIn:function V(w,e){ad(e,function(am,P){if(!(P in w)){w[P]=am}});return w},forEach:f,forOwn:ad,fromJson:function B(e){return s(e)?JSON.parse(e):e},get:aa,intersection:i,isArray:F,isBlacklisted:ab,isEmpty:x,isFunction:v,isObject:S,isNumber:ak,isString:s,keys:J,makePath:d,observe:k,omit:function C(w,P){var e=[];ad(w,function(an,am){if(ab(am,P)){e.push(am)}});f(e,function(am){delete w[am]});return w},pascalCase:c,pick:A,promisify:function ac(e,w){var P=this;if(!e){return}else{if(typeof e!=="function"){throw new Error("Can only promisify functions!")}}return function(){for(var ao=arguments.length,an=Array(ao),am=0;am<ao;am++){an[am]=arguments[am]}return new P.Promise(function(ar,aq){an.push(function(av,au){if(av){aq(av)}else{ar(au)}});try{var at=e.apply(w||this,an);if(at&&at.then){at.then(ar,aq)}}catch(ap){aq(ap)}})}},remove:H,set:G,slice:u,sort:ae,toJson:JSON.stringify,updateTimestamp:function X(w){var e=typeof Date.now==="function"?Date.now():new Date().getTime();if(w&&e<=w){return w+1}else{return e}},upperCase:I,removeCircular:function M(e){return(function w(ap,P){var an=undefined;var am=undefined;if(typeof ap==="object"&&ap!==null&&!(ap instanceof Boolean)&&!(ap instanceof Date)&&!(ap instanceof Number)&&!(ap instanceof RegExp)&&!(ap instanceof String)&&!(ap instanceof t)){var aq=P.cur;var ao=P.ctx;while(ao){if(ao.cur===aq){return undefined}ao=ao.ctx}if(F(ap)){am=[];for(an=0;an<ap.length;an+=1){am[an]=w(ap[an],{ctx:P,cur:ap[an]})}}else{am={};ad(ap,function(at,ar){am[ar]=w(ap[ar],{ctx:P,cur:ap[ar]})})}return am}return ap})(e,{ctx:null,cur:e})},resolveItem:z,resolveId:y,respond:function l(e,P,w){if(w.returnMeta==="array"){return[e,P]}else{if(w.returnMeta==="object"){return{response:e,meta:P}}else{return e}}},w:U,applyRelationGettersToTarget:function R(e,w,P){this.forEach(w.relationList,function(an){var au=an.relation;var av=an.localField;var aq=an.localKey;var at=an.foreignKey;var ao=an.localKeys;var ar=an.foreignKeys;var ap=typeof an.enumerable==="boolean"?an.enumerable:!!w.relationsEnumerable;if(typeof an.link==="boolean"?an.link:!!w.linkRelations){delete P[av];var am={enumerable:ap};if(an.type==="belongsTo"){am.get=function(){return aa(this,aq)?w.getResource(au).get(aa(this,aq)):undefined};am.set=function(aw){if(aw){G(this,aq,aa(aw,w.getResource(au).idAttribute))}return aa(this,av)}}else{if(an.type==="hasMany"){am.get=function(){var ax={};if(at){ax[at]=this[w.idAttribute];return w.getResource(au).defaultFilter.call(e,e.store[au].collection,au,ax,{allowSimpleWhere:true})}else{if(ao){var aw=aa(this,ao)||[];return w.getResource(au).getAll(F(aw)?aw:J(aw))}else{if(ar){G(ax,"where."+ar+".contains",this[w.idAttribute]);return w.getResource(au).defaultFilter.call(e,e.store[au].collection,au,ax)}}}return undefined};am.set=function(aw){var ax=this;if(aw&&aw.length){(function(){var ay=aa(ax,w.idAttribute);if(at){f(aw,function(az){G(az,at,ay)})}else{if(ao){(function(){var az=[];f(aw,function(aA){az.push(aa(aA,w.getResource(au).idAttribute))});G(ax,ao,az)})()}else{if(ar){f(aw,function(aA){var az=aa(aA,ar);if(az){if(!N(az,ay)){az.push(ay)}}else{G(aA,ar,[ay])}})}}}})()}return aa(this,av)}}else{if(an.type==="hasOne"){if(aq){am.get=function(){return aa(this,aq)?w.getResource(au).get(aa(this,aq)):undefined};am.set=function(aw){if(aw){G(this,aq,aa(aw,w.getResource(au).idAttribute))}return aa(this,av)}}else{am.get=function(){var ax={};ax[at]=this[w.idAttribute];var aw=ax[at]?w.getResource(au).defaultFilter.call(e,e.store[au].collection,au,ax,{allowSimpleWhere:true}):[];if(aw.length){return aw[0]}return undefined};am.set=function(aw){if(aw){G(aw,at,aa(this,w.idAttribute))}return aa(this,av)}}}}}if(an.get){(function(){var aw=am.get;am.get=function(){var ax=this;return an.get(w,an,this,function(){for(var aA=arguments.length,az=Array(aA),ay=0;ay<aA;ay++){az[ay]=arguments[ay]}return aw.apply(ax,az)})}})()}Object.defineProperty(P,av,am)}})}}},function(a,c){var e=function b(q,p,o){var m=true;_function:while(m){var k=q,s=p,j=o;l=r=n=undefined;m=false;if(k===null){k=Function.prototype}var l=Object.getOwnPropertyDescriptor(k,s);if(l===undefined){var r=Object.getPrototypeOf(k);if(r===null){return undefined}else{q=r;p=s;o=j;m=true;continue _function}}else{if("value" in l){return l.value}else{var n=l.get;if(n===undefined){return undefined}return n.call(j)}}}};function d(j,k){if(!(j instanceof k)){throw new TypeError("Cannot call a class as a function")}}function h(k,j){if(typeof j!=="function"&&j!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof j)}k.prototype=Object.create(j&&j.prototype,{constructor:{value:k,enumerable:false,writable:true,configurable:true}});if(j){Object.setPrototypeOf?Object.setPrototypeOf(k,j):k.__proto__=j}}var f=(function(k){h(j,k);function j(l){d(this,j);e(Object.getPrototypeOf(j.prototype),"constructor",this).call(this);if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,this.constructor)}this.type=this.constructor.name;this.message=l}return j})(Error);var i=(function(j){h(k,j);function k(l){d(this,k);e(Object.getPrototypeOf(k.prototype),"constructor",this).call(this);if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,this.constructor)}this.type=this.constructor.name;this.message=l}return k})(Error);var g=(function(j){h(k,j);function k(l){d(this,k);e(Object.getPrototypeOf(k.prototype),"constructor",this).call(this);if(typeof Error.captureStackTrace==="function"){Error.captureStackTrace(this,this.constructor)}this.type=this.constructor.name;this.message=l+" is not a registered resource!"}return k})(Error);c["default"]={IllegalArgumentError:f,IA:f,RuntimeError:i,R:i,NonexistentResourceError:g,NER:g}},function(c,b,d){
/*!
	 * yabh
	 * @version 1.1.0 - Homepage <http://jmdobry.github.io/yabh/>
	 * @author Jason Dobry <jason.dobry@gmail.com>
	 * @copyright (c) 2015 Jason Dobry 
	 * @license MIT <https://github.com/jmdobry/yabh/blob/master/LICENSE>
	 * 
	 * @overview Yet another Binary Heap.
	 */
(function a(e,f){if(true){c.exports=f()}else{if(typeof define==="function"&&define.amd){define("yabh",f)}else{if(typeof b==="object"){b.BinaryHeap=f()}else{e.BinaryHeap=f()}}}})(this,function(){return(function(e){var f={};function g(i){if(f[i]){return f[i].exports}var h=f[i]={exports:{},id:i,loaded:false};e[i].call(h.exports,h,h.exports,g);h.loaded=true;return h.exports}g.m=e;g.c=f;g.p="";return g(0)})([function(h,f,k){function i(l,q,s){var m=l[s];var p=q(m);while(s>0){var o=Math.floor((s+1)/2)-1;var r=l[o];if(p>=q(r)){break}else{l[o]=m;l[s]=r;s=o}}}var e=function e(q,l,p){var o=q.length;var s=q[p];var y=l(s);while(true){var t=(p+1)*2,w=t-1;var r=null;if(w<o){var v=q[w],x=l(v);if(x<y){r=w}}if(t<o){var u=q[t],m=l(u);if(m<(r===null?y:l(q[w]))){r=t}}if(r===null){break}else{q[p]=q[r];q[r]=s;p=r}}};function g(m,l){if(!m){m=function(n){return n}}if(!l){l=function(n,o){return n===o}}if(typeof m!=="function"){throw new Error('BinaryHeap([weightFunc][, compareFunc]): "weightFunc" must be a function!')}if(typeof l!=="function"){throw new Error('BinaryHeap([weightFunc][, compareFunc]): "compareFunc" must be a function!')}this.weightFunc=m;this.compareFunc=l;this.heap=[]}var j=g.prototype;j.push=function(l){this.heap.push(l);i(this.heap,this.weightFunc,this.heap.length-1)};j.peek=function(){return this.heap[0]};j.pop=function(){var m=this.heap[0];var l=this.heap.pop();if(this.heap.length>0){this.heap[0]=l;e(this.heap,this.weightFunc,0)}return m};j.remove=function(o){var n=this.heap.length;for(var m=0;m<n;m++){if(this.compareFunc(this.heap[m],o)){var p=this.heap[m];var l=this.heap.pop();if(m!==n-1){this.heap[m]=l;i(this.heap,this.weightFunc,m);e(this.heap,this.weightFunc,m)}return p}}return null};j.removeAll=function(){this.heap=[]};j.size=function(){return this.heap.length};h.exports=g}])})},function(b,a){function c(e,h,g){if(e==null){return}var f=-1,d=e.length;while(++f<d){if(h.call(g,e[f],f,e)===false){break}}}b.exports=c},function(b,a){function c(f,h,g){var e=f.length;if(h==null){h=0}else{if(h<0){h=Math.max(e+h,0)}else{h=Math.min(h,e)}}if(g==null){g=e}else{if(g<0){g=Math.max(e+g,0)}else{g=Math.min(g,e)}}var d=[];while(h<g){d.push(f[h++])}return d}b.exports=c},function(e,d,f){var b=f(8);var a=f(9);function c(h,g,i){a(h,function(k,j){if(b(h,j)){return g.call(i,h[j],j,h)}})}e.exports=c},function(c,b){function a(d,e){return Object.prototype.hasOwnProperty.call(d,e)}c.exports=a},function(b,d,a){var e=a(8);var i,g;function f(){g=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];i=true;for(var j in {toString:null}){i=false}}function h(o,l,p){var k,j=0;if(i==null){f()}for(k in o){if(c(l,o,k,p)===false){break}}if(i){var m=o.constructor,n=!!m&&o===m.prototype;while(k=g[j++]){if((k!=="constructor"||(!n&&e(o,k)))&&o[k]!==Object.prototype[k]){if(c(l,o,k,p)===false){break}}}}}function c(k,l,j,m){return k.call(m,l[j],j,l)}b.exports=h},function(c,a,e){var d=e(11);function b(f,g){return d(f,g)!==-1}c.exports=b},function(b,a){function c(e,h,g){g=g||0;if(e==null){return -1}var d=e.length,f=g<0?d+g:g;while(f<d){if(e[f]===h){return f}f++}return -1}b.exports=c},function(e,c,g){var b=g(7);var a=g(13);function d(l,j){var h=0,m=arguments.length,k;while(++h<m){k=arguments[h];if(k){b(k,f,l)}}return l}function f(j,h){var i=this[h];if(a(j)&&a(i)){d(i,j)}else{this[h]=j}}e.exports=d},function(c,b){function a(d){return(!!d&&typeof d==="object"&&d.constructor===Object)}c.exports=a},function(d,c,g){var f=g(15);var e=g(16);var a=g(19);function b(h){h=f(h);return e(h).replace(/^[a-z]/,a)}d.exports=b},function(b,a){function c(d){return d==null?"":d.toString()}b.exports=c},function(d,f,b){var c=b(15);var g=b(17);var a=b(18);var i=b(19);var h=b(20);function e(j){j=c(j);j=g(j);j=a(j).replace(/[\-_]/g," ").replace(/\s[a-z]/g,i).replace(/\s+/g,"").replace(/^[A-Z]/g,h);return j}d.exports=e},function(b,a,d){var c=d(15);function e(f){f=c(f);if(f.search(/[\xC0-\xFF]/g)>-1){f=f.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")}return f}b.exports=e},function(c,b,f){var e=f(15);var a=/[^\x20\x2D0-9A-Z\x5Fa-z\xC0-\xD6\xD8-\xF6\xF8-\xFF]/g;function d(g){g=e(g);return g.replace(a,"")}c.exports=d},function(c,b,e){var d=e(15);function a(f){f=d(f);return f.toUpperCase()}c.exports=a},function(c,a,e){var d=e(15);function b(f){f=d(f);return f.toLowerCase()}c.exports=b},function(c,b,e){var d=e(11);function a(g,h){var f=d(g,h);if(f!==-1){g.splice(f,1)}}c.exports=a},function(b,a,d){var e=d(6);function c(l,f){var k=typeof arguments[1]!=="string"?arguments[1]:e(arguments,1),g={},j=0,h;while(h=k[j++]){g[h]=l[h]}return g}b.exports=c},function(c,b,e){var a=e(7);var d=Object.keys||function(g){var f=[];a(g,function(i,h){f.push(h)});return f};c.exports=d},function(c,b){function a(f,j){if(f==null){return[]}else{if(f.length<2){return f}}if(j==null){j=d}var g,i,h;g=~~(f.length/2);i=a(f.slice(0,g),j);h=a(f.slice(g,f.length),j);return e(i,h,j)}function d(g,f){return g<f?-1:(g>f?1:0)}function e(h,g,i){var f=[];while(h.length&&g.length){if(i(h[0],g[0])<=0){f.push(h.shift())}else{f.push(g.shift())}}if(h.length){f.push.apply(f,h)}if(g.length){f.push.apply(f,g)}return f}c.exports=a},function(d,a,e){var c=e(26);function b(h,i){var g=i.split("."),f=g.pop();while(i=g.shift()){h=h[i];if(h==null){return}}return h[f]}d.exports=b},function(c,a){function b(d){switch(typeof d){case"string":case"number":case"boolean":return true}return d==null}c.exports=b},function(b,a,d){var c=d(28);function e(g,i,h){var f=(/^(.+)\.(.+)$/).exec(i);if(f){c(g,f[1])[f[2]]=h}else{g[i]=h}}b.exports=e},function(b,a,d){var e=d(5);function c(g,f){if(!f){return g}e(f.split("."),function(h){if(!g[h]){g[h]={}}g=g[h]});return g}b.exports=c},function(b,a){(function(w){var l=w.testingExposeCycleCount;function n(){if(typeof Object.observe!=="function"||typeof Array.observe!=="function"){return false}var I=[];function K(L){I=L}var J={};var H=[];Object.observe(J,K);Array.observe(H,K);J.id=1;J.id=2;delete J.id;H.push(1,2);H.length=0;Object.deliverChangeRecords(K);if(I.length!==5){return false}if(I[0].type!="add"||I[1].type!="update"||I[2].type!="delete"||I[3].type!="splice"||I[4].type!="splice"){return false}Object.unobserve(J,K);Array.unobserve(H,K);return true}var d=n();var t=("__proto__" in {})?function(H){return H}:function(J){var I=J.__proto__;if(!I){return J}var H=Object.create(I);Object.getOwnPropertyNames(J).forEach(function(K){Object.defineProperty(H,K,Object.getOwnPropertyDescriptor(J,K))});return H};var v=1000;function B(H){var I=0;while(I<v&&H.check_()){I++}if(l){w.dirtyCheckCycleCount=I}return I>0}function D(H){for(var I in H){return false}return true}function i(H){return D(H.added)&&D(H.removed)&&D(H.changed)}function C(K,J){if(!J||!J.length){return false}var I;for(var H=0;H<J.length;H++){if((Object.prototype.toString.call(J[H])==="[object RegExp]"&&J[H].test(K))||J[H]===K){return I=K}}return !!I}function e(L,M,J,K){var P={};var O={};var N={};for(var H in M){var I=L[H];if(C(H,K)){continue}if(I!==undefined&&(J?J(I,M[H]):I===M[H])){continue}if(!(H in L)){O[H]=undefined;continue}if(J?!J(I,M[H]):I!==M[H]){N[H]=I}}for(var H in L){if(H in M){continue}if(C(H,K)){continue}P[H]=L[H]}if(Array.isArray(L)&&L.length!==M.length){N.length=L.length}return{added:P,removed:O,changed:N}}var F=[];function o(){if(!F.length){return false}for(var H=0;H<F.length;H++){F[H]()}F.length=0;return true}var G=d?(function(){return function(H){return Promise.resolve().then(H)}})():(function(){return function(H){F.push(H)}})();var h=[];function u(){var H;var I;var J=false;var K=true;function L(M){if(H&&H.state_===j&&!J){H.check_(M)}}return{open:function(M){if(H){throw Error("ObservedObject in use")}if(!K){Object.deliverChangeRecords(L)}H=M;K=false},observe:function(N,M){I=N;if(M){Array.observe(I,L)}else{Object.observe(I,L)}},deliver:function(M){J=M;Object.deliverChangeRecords(L);J=false},close:function(){H=undefined;Object.unobserve(I,L);h.push(this)}}}function p(H,J,K){var I=h.pop()||u();I.open(H);I.observe(J,K);return I}var z=0;var j=1;var f=2;var A=1;function y(){this.state_=z;this.callback_=undefined;this.target_=undefined;this.directObserver_=undefined;this.value_=undefined;this.id_=A++}y.prototype={open:function(I,H){if(this.state_!=z){throw Error("Observer has already been opened.")}m(this);this.callback_=I;this.target_=H;this.connect_();this.state_=j;return this.value_},close:function(){if(this.state_!=j){return}x(this);this.disconnect_();this.value_=undefined;this.callback_=undefined;this.target_=undefined;this.state_=f},deliver:function(){if(this.state_!=j){return}B(this)},report_:function(I){try{this.callback_.apply(this.target_,I)}catch(H){y._errorThrownDuringCallback=true;console.error("Exception caught during observer callback: "+(H.stack||H))}},discardChanges:function(){this.check_(undefined,true);return this.value_}};var c=!d;var s;y._allObserversCount=0;if(c){s=[]}function m(H){y._allObserversCount++;if(!c){return}s.push(H)}function x(H){y._allObserversCount--}var E=false;w.Platform=w.Platform||{};w.Platform.performMicrotaskCheckpoint=function(){if(E){return}if(!c){return}E=true;var L=0;var K,J;do{L++;J=s;s=[];K=false;for(var I=0;I<J.length;I++){var H=J[I];if(H.state_!=j){continue}if(H.check_()){K=true}s.push(H)}if(o()){K=true}}while(L<v&&K);if(l){w.dirtyCheckCycleCount=L}E=false};if(c){w.Platform.clearObservers=function(){s=[]}}function g(H){y.call(this);this.value_=H;this.oldObject_=undefined}g.prototype=t({__proto__:y.prototype,arrayObserve:false,connect_:function(I,H){if(d){this.directObserver_=p(this,this.value_,this.arrayObserve)}else{this.oldObject_=this.copyObject(this.value_)}},copyObject:function(H){var J=Array.isArray(H)?[]:{};for(var I in H){J[I]=H[I]}if(Array.isArray(H)){J.length=H.length}return J},check_:function(I,J){var K;var H;if(d){if(!I){return false}H={};K=q(this.value_,I,H)}else{H=this.oldObject_;K=e(this.value_,this.oldObject_)}if(i(K)){return false}if(!d){this.oldObject_=this.copyObject(this.value_)}this.report_([K.added||{},K.removed||{},K.changed||{},function(L){return H[L]}]);return true},disconnect_:function(){if(d){this.directObserver_.close();this.directObserver_=undefined}else{this.oldObject_=undefined}},deliver:function(){if(this.state_!=j){return}if(d){this.directObserver_.deliver(false)}else{B(this)}},discardChanges:function(){if(this.directObserver_){this.directObserver_.deliver(true)}else{this.oldObject_=this.copyObject(this.value_)}return this.value_}});var r={};var k={add:true,update:true,"delete":true};function q(K,J,Q){var P={};var O={};for(var M=0;M<J.length;M++){var N=J[M];if(!k[N.type]){console.error("Unknown changeRecord type: "+N.type);console.error(N);continue}if(!(N.name in Q)){Q[N.name]=N.oldValue}if(N.type=="update"){continue}if(N.type=="add"){if(N.name in O){delete O[N.name]}else{P[N.name]=true}continue}if(N.name in P){delete P[N.name];delete Q[N.name]}else{O[N.name]=true}}for(var H in P){P[H]=K[H]}for(var H in O){O[H]=undefined}var L={};for(var H in Q){if(H in P||H in O){continue}var I=K[H];if(Q[H]!==I){L[H]=I}}return{added:P,removed:O,changed:L}}w.Observer=y;w.isBlacklisted=C;w.Observer.runEOM_=G;w.Observer.observerSentinel_=r;w.Observer.hasObjectObserve=d;w.diffObjectFromOldObject=e;w.ObjectObserver=g})(a)},function(a,x,c){var j=c(2);var p=c(3);var u=p["default"].NER;var k=p["default"].IA;var f=p["default"].R;var q="DS_"+new Date().getTime();function h(y){return !(j["default"].isEmpty(y.added)&&j["default"].isEmpty(y.removed)&&j["default"].isEmpty(y.changed))}function r(D,A,C,y){var B=this;var z=B.definitions[A];y=y||{};C=j["default"].resolveId(z,C);if(!z){throw new u(A)}else{if(!j["default"]._sn(C)){throw j["default"]._snErr("id")}}C=C===q?undefined:C;y=j["default"]._(z,y);y.logFn(D,C,y);return{_this:B,definition:z,_resourceName:A,_id:C,_options:y}}x["default"]={changes:function w(B,y,I){var z=r.call(this,"changes",B,y,I);var C=z._this;var A=z.definition;var D=z._resourceName;var E=z._id;var G=z._options;var H=A.get(E);if(H){var F=(function(){var K=C.store[D].observers[E];if(K&&typeof K==="function"){K.deliver()}var J=G.ignoredChanges||[];j["default"].forEach(A.relationFields,function(M){if(!j["default"].contains(J,M)){J.push(M)}});var L=j["default"].diffObjectFromOldObject(H,C.store[D].previousAttributes[E],j["default"].equals,J);j["default"].forOwn(L,function(O,N){var M=[];j["default"].forOwn(O,function(P,Q){if(!j["default"].isFunction(P)){M.push(Q)}});L[N]=j["default"].pick(L[N],M)});j["default"].forEach(A.relationFields,function(M){delete L.added[M];delete L.removed[M];delete L.changed[M]});return{v:L}})();if(typeof F==="object"){return F.v}}},changeHistory:function g(B,y){var E=r.call(this,"changeHistory",B,y||q);var C=E._this;var z=E.definition;var D=E._resourceName;var F=E._id;var A=C.store[D];if(!z.keepChangeHistory){z.errorFn("changeHistory is disabled for this resource!")}else{if(D){var G=z.get(F);if(G){return A.changeHistories[F]}}else{return A.changeHistory}}},compute:function o(A,y){var B=this;var z=B.definitions[A];y=j["default"].resolveItem(B.store[A],y);if(!z){throw new u(A)}else{if(!y){throw new f("Item not in the store!")}else{if(!j["default"]._o(y)&&!j["default"]._sn(y)){throw new k('"instance" must be an object, string or number!')}}}z.logFn("compute",y);j["default"].forOwn(z.computed,function(C,D){j["default"].compute.call(y,C,D)});return y},createInstance:function l(B,z,y){var A=this.definitions[B];var C=undefined;z=z||{};if(!A){throw new u(B)}else{if(z&&!j["default"].isObject(z)){throw new k('"attrs" must be an object!')}}y=j["default"]._(A,y);y.logFn("createInstance",z,y);y.beforeCreateInstance(y,z);var D=A[A["class"]];C=new D();if(A.instanceEvents){j["default"].Events(C)}if(y.defaultValues){j["default"].deepMixIn(C,y.defaultValues)}j["default"].deepMixIn(C,z);if(A.computed){A.compute(C)}y.afterCreateInstance(y,C);return C},createCollection:function n(B,y,D,z){var E=this;var A=E.definitions[B];y=y||[];D=D||{};if(!A){throw new u(B)}else{if(y&&!j["default"].isArray(y)){throw new k('"arr" must be an array!')}}z=j["default"]._(A,z);z.logFn("createCollection",y,z);z.beforeCreateCollection(z,y);Object.defineProperties(y,{fetch:{value:function C(H,F){var G=this;G.params=H||G.params;return A.findAll(G.params,F).then(function(I){if(I===G){return G}I.unshift(G.length);I.unshift(0);G.splice.apply(G,I);I.shift();I.shift();if(I.$$injected){E.store[B].queryData[j["default"].toJson(G.params)]=G;G.$$injected=true}return G})}},params:{value:D,writable:true},resourceName:{value:B}});z.afterCreateCollection(z,y);return y},defineResource:c(31),digest:function t(){this.observe.Platform.performMicrotaskCheckpoint()},eject:c(32),ejectAll:c(33),filter:c(34),get:function s(A,D){var y=r.call(this,"get",A,D);var C=y._this;var B=y._resourceName;var z=y._id;return C.store[B].index[z]},getAll:function m(A,B){var F=this;var z=F.definitions[A];var C=F.store[A];var D=[];if(!z){throw new u(A)}else{if(B&&!j["default"]._a(B)){throw j["default"]._aErr("ids")}}z.logFn("getAll",B);if(j["default"]._a(B)){var E=B.length;for(var y=0;y<E;y++){if(C.index[B[y]]){D.push(C.index[B[y]])}}}else{D=C.collection.slice()}return D},hasChanges:function e(A,C){var B=r.call(this,"hasChanges",A,C);var z=B.definition;var y=B._id;return z.get(y)?h(z.changes(y)):false},inject:c(35),lastModified:function v(z,E){var C=r.call(this,"lastModified",z,E||q);var D=C._this;var A=C._resourceName;var y=C._id;var B=D.store[A];if(y){if(!(y in B.modified)){B.modified[y]=0}return B.modified[y]}return B.collectionModified},lastSaved:function i(z,E){var C=r.call(this,"lastSaved",z,E||q);var D=C._this;var A=C._resourceName;var y=C._id;var B=D.store[A];if(!(y in B.saved)){B.saved[y]=0}return B.saved[y]},previous:function d(z,E){var C=r.call(this,"previous",z,E);var D=C._this;var A=C._resourceName;var y=C._id;var B=D.store[A];return B.previousAttributes[y]?j["default"].copy(B.previousAttributes[y]):undefined},revert:function b(A,E){var C=r.call(this,"revert",A,E);var D=C._this;var z=C.definition;var B=C._resourceName;var y=C._id;return z.inject(D.previous(B,y))}}},function(d,b,g){var f=g(2);var c=g(3);var e=["compute","eject","refresh","save","update","destroy","loadRelations","changeHistory","changes","hasChanges","lastModified","lastSaved","previous","revert"];d.exports=function a(j){var o=this;var k=o.definitions;if(f["default"]._s(j)){j={name:j.replace(/\s/gi,"")}}if(!f["default"]._o(j)){throw f["default"]._oErr("definition")}else{if(!f["default"]._s(j.name)){throw new c["default"].IA('"name" must be a string!')}else{if(k[j.name]){throw new c["default"].R(j.name+" is already registered!")}}}function n(p){this.defaultValues={};this.methods={};this.computed={};this.scopes={};this.actions={};f["default"].deepMixIn(this,p);var q=o.defaults;if(j["extends"]&&k[j["extends"]]){q=k[j["extends"]]}f["default"].fillIn(this.defaultValues,q.defaultValues);f["default"].fillIn(this.methods,q.methods);f["default"].fillIn(this.computed,q.computed);f["default"].fillIn(this.scopes,q.scopes);f["default"].fillIn(this.actions,q.actions);this.endpoint="endpoint" in p?p.endpoint:this.name}try{var m;var h;var i=(function(){if(j["extends"]&&k[j["extends"]]){n.prototype=k[j["extends"]]}else{n.prototype=o.defaults}k[j.name]=new n(j);m=k[j.name];m.getResource=function(v){return o.definitions[v]};m.logFn("Preparing resource.");if(!f["default"]._s(m.idAttribute)){throw new c["default"].IA('"idAttribute" must be a string!')}if(m.relations){m.relationList=[];m.relationFields=[];f["default"].forOwn(m.relations,function(v,w){f["default"].forOwn(v,function(x,y){if(!f["default"]._a(x)){v[y]=[x]}f["default"].forEach(v[y],function(z){z.type=w;z.relation=y;z.name=m.name;m.relationList.push(z);if(z.localField){m.relationFields.push(z.localField)}})})});if(m.relations.belongsTo){f["default"].forOwn(m.relations.belongsTo,function(w,v){f["default"].forEach(w,function(x){if(x.parent){m.parent=v;m.parentKey=x.localKey;m.parentField=x.localField}})})}if(typeof Object.freeze==="function"){Object.freeze(m.relations);Object.freeze(m.relationList)}}h=m["class"]=f["default"].pascalCase(m.name);try{if(typeof m.useClass==="function"){m[h]=new Function("def","return function "+h+"() { def.useClass.call(this); }")(m);m[h].prototype=(function(w){function v(){}v.prototype=w;return new v()})(m.useClass.prototype)}else{m[h]=new Function("return function "+h+"() {}")()}}catch(t){m[h]=function(){}}f["default"].forOwn(m.methods,function(w,v){m[h].prototype[v]=w});m[h].prototype.set=function(v,x){var w=this;f["default"].set(this,v,x);m.compute(this);if(m.instanceEvents){setTimeout(function(){w.emit("DS.change",m,w)},0)}m.handleChange(this);return this};m[h].prototype.get=function(v){return f["default"].get(this,v)};f["default"].applyRelationGettersToTarget(o,m,m[h].prototype);var p=null;if(!m.hasOwnProperty("omit")){p=m.omit;m.omit=[]}else{p=o.defaults.omit}m.omit=m.omit.concat(p||[]);f["default"].forOwn(m.computed,function(w,x){if(f["default"].isFunction(w)){m.computed[x]=[w];w=m.computed[x]}if(m.methods&&x in m.methods){m.errorFn('Computed property "'+x+'" conflicts with previously defined prototype method!')}m.omit.push(x);if(f["default"].isArray(w)){var y;if(w.length===1){var v=w[0].toString().match(/function.*?\(([\s\S]*?)\)/);y=v[1].split(",");y=f["default"].filter(y,function(z){return z});m.computed[x]=y.concat(w);w=m.computed[x];if(y.length){m.errorFn("Use the computed property array syntax for compatibility with minified code!")}}y=w.slice(0,w.length-1);f["default"].forEach(y,function(A,z){y[z]=A.trim()});w.deps=f["default"].filter(y,function(z){return !!z})}else{if(f["default"].isObject(w)){Object.defineProperty(m[h].prototype,x,w)}}});f["default"].forEach(e,function(v){m[h].prototype["DS"+f["default"].pascalCase(v)]=function(){for(var w=arguments.length,x=Array(w),y=0;y<w;y++){x[y]=arguments[y]}x.unshift(this[m.idAttribute]||this);x.unshift(m.name);return o[v].apply(o,x)}});m[h].prototype.DSCreate=function(){for(var v=arguments.length,x=Array(v),w=0;w<v;w++){x[w]=arguments[w]}x.unshift(this);x.unshift(m.name);return o.create.apply(o,x)};o.store[m.name]={collection:[],expiresHeap:new f["default"].BinaryHeap(function(v){return v.expires},function(v,w){return v.item===w}),completedQueries:{},queryData:{},pendingQueries:{},index:{},modified:{},saved:{},previousAttributes:{},observers:{},changeHistories:{},changeHistory:[],collectionModified:0};var s=o.store[m.name];if(m.reapInterval){setInterval(function(){return m.reap()},m.reapInterval)}var r=["registerAdapter","getAdapterName","getAdapter","is","!clear"];for(var q in o){if(typeof o[q]==="function"){r.push(q)}}f["default"].forEach(r,function(w){var v=w;if(v[0]==="!"){return}if(o[v].shorthand!==false){m[v]=function(){for(var z=arguments.length,y=Array(z),x=0;x<z;x++){y[x]=arguments[x]}y.unshift(m.name);return o[v].apply(o,y)};m[v].before=function(x){var y=m[v];m[v]=function(){for(var B=arguments.length,A=Array(B),z=0;z<B;z++){A[z]=arguments[z]}return y.apply(m,x.apply(m,A)||A)}}}else{m[v]=function(){for(var z=arguments.length,y=Array(z),x=0;x<z;x++){y[x]=arguments[x]}return o[v].apply(o,y)}}});m.beforeValidate=f["default"].promisify(m.beforeValidate);m.validate=f["default"].promisify(m.validate);m.afterValidate=f["default"].promisify(m.afterValidate);m.beforeCreate=f["default"].promisify(m.beforeCreate);m.afterCreate=f["default"].promisify(m.afterCreate);m.afterFind=f["default"].promisify(m.afterFind);m.afterFindAll=f["default"].promisify(m.afterFindAll);m.afterLoadRelations=f["default"].promisify(m.afterLoadRelations);m.beforeUpdate=f["default"].promisify(m.beforeUpdate);m.afterUpdate=f["default"].promisify(m.afterUpdate);m.beforeDestroy=f["default"].promisify(m.beforeDestroy);m.afterDestroy=f["default"].promisify(m.afterDestroy);var u=undefined;if(m.hasOwnProperty("defaultAdapter")){u=m.defaultAdapter}f["default"].forOwn(m.actions,function(w,v){if(m[v]&&!m.actions[v]){throw new Error('Cannot override existing method "'+v+'"!')}w.request=w.request||function(x){return x};w.response=w.response||function(x){return x};w.responseError=w.responseError||function(x){return f["default"].Promise.reject(x)};m[v]=function(B,A){if(f["default"]._o(B)){A=B}A=A||{};var x=m.getAdapter(w.adapter||u||"http");var z=f["default"].deepMixIn({},w);if(!A.hasOwnProperty("endpoint")&&z.endpoint){A.endpoint=z.endpoint}if(typeof A.getEndpoint==="function"){z.url=A.getEndpoint(m,A)}else{var y=[A.basePath||m.basePath||x.defaults.basePath,x.getEndpoint(m,f["default"]._sn(B)?B:null,A)];if(f["default"]._sn(B)){y.push(B)}y.push(w.pathname||v);z.url=f["default"].makePath.apply(null,y)}z.method=z.method||"GET";z.resourceName=m.name;f["default"].deepMixIn(z,A);return new f["default"].Promise(function(C){return C(z)}).then(A.request||w.request).then(function(C){return x.HTTP(C)}).then(function(C){if(C&&C.config){C.config.resourceName=m.name}return C}).then(A.response||w.response,A.responseError||w.responseError)}});f["default"].Events(m);m.handleChange=function(v){s.collectionModified=f["default"].updateTimestamp(s.collectionModified);if(m.notify){setTimeout(function(){m.emit("DS.change",m,v)},0)}};m.logFn("Done preparing resource.");return{v:m}})();if(typeof i==="object"){return i.v}}catch(l){o.defaults.errorFn(l);delete k[j.name];delete o.store[j.name];throw l}}},function(b,a){b.exports=function c(h,d,o){var j=this;var n=j.utils;var e=j.definitions[h];var f=j.store[h];var l=undefined;var m=false;d=n.resolveId(e,d);if(!e){throw new j.errors.NER(h)}else{if(!n._sn(d)){throw n._snErr("id")}}o=n._(e,o);o.logFn("eject",d,o);for(var g=0;g<f.collection.length;g++){if(f.collection[g][e.idAttribute]==d){l=f.collection[g];f.expiresHeap.remove(l);m=true;break}}if(m){var k=(function(){e.beforeEject(o,l);if(o.notify){e.emit("DS.beforeEject",e,l)}var i=[];n.forOwn(f.queryData,function(p,q){if(p.$$injected){n.remove(p,l)}if(!p.length&&o.clearEmptyQueries){i.push(q)}});n.forEach(f.changeHistories[d],function(p){n.remove(f.changeHistory,p)});n.forEach(i,function(p){delete f.completedQueries[p];delete f.queryData[p]});if(f.observers[d]&&typeof f.observers[d].close==="function"){f.observers[d].close()}delete f.observers[d];delete f.index[d];delete f.previousAttributes[d];delete f.completedQueries[d];delete f.pendingQueries[d];delete f.changeHistories[d];delete f.modified[d];delete f.saved[d];if(e.instanceEvents&&l.off){l.off()}f.collection.splice(g,1);e.handleChange(l);e.afterEject(o,l);if(o.notify){e.emit("DS.afterEject",e,l)}return{v:l}})();if(typeof k==="object"){return k.v}}}},function(c,a){c.exports=function b(g,f,k){var h=this;var j=h.utils;var d=h.definitions[g];f=f||{};if(!d){throw new h.errors.NER(g)}else{if(!j._o(f)){throw j._oErr("params")}}k=j._(d,k);d.logFn("ejectAll",f,k);j.applyScope(d,f,k);var e=h.store[g];var l=j.toJson(f);var i=d.filter(f);if(j.isEmpty(f)){e.completedQueries={}}else{delete e.completedQueries[l]}j.forEach(i,function(m){if(m&&m[d.idAttribute]){d.eject(m[d.idAttribute],k)}});d.handleChange(i);return i}},function(b,a){b.exports=function c(f,h,d){var i=this;var g=i.utils;var e=i.definitions[f];if(!e){throw new i.errors.NER(f)}else{if(h&&!g._o(h)){throw g._oErr("params")}}h=h||{};d=g._(e,d);d.logFn("filter",h,d);g.applyScope(e,h,d);return e.defaultFilter.call(i,i.store[f].collection,f,h,d)}},function(d,a,h){var f=h(2);var b=h(3);function e(k,l){var m=this;var j=k.name;return function i(t,p,o,q,n){var r=this;var v=undefined;var u=q&&q(k.idAttribute)?q(k.idAttribute):r[k.idAttribute];f["default"].forEach(k.relationFields,function(w){delete t[w];delete p[w];delete o[w]});if(!f["default"].isEmpty(t)||!f["default"].isEmpty(p)||!f["default"].isEmpty(o)||n){v=m.get(j,u);l.modified[u]=f["default"].updateTimestamp(l.modified[u]);if(v&&k.instanceEvents){setTimeout(function(){v.emit("DS.change",k,v)},0)}k.handleChange(v);if(k.keepChangeHistory){var s={resourceName:j,target:v,added:t,removed:p,changed:o,timestamp:l.modified[u]};l.changeHistories[u].push(s);l.changeHistory.push(s)}}if(k.computed){v=v||m.get(j,u);f["default"].forOwn(k.computed,function(w,y){if(f["default"]._o(w)){return}var x=false;f["default"].forEach(w.deps,function(z){if(z in t||z in p||z in o||!(y in v)){x=true}});x=x||!w.deps.length;if(x){f["default"].compute.call(v,w,y)}})}if(k.idAttribute in o){k.errorFn('Doh! You just changed the primary key of an object! Your data for the "'+j+'" resource is now in an undefined (probably broken) state.')}}}function g(k,l,s,t){var o=this;var p=undefined;if(f["default"]._a(s)){p=[];for(var n=0;n<s.length;n++){p.push(g.call(o,k,l,s[n],t))}}else{var r=k.computed;var j=k.idAttribute;if(r&&r[j]){(function(){var i=[];f["default"].forEach(r[j].deps,function(u){i.push(s[u])});s[j]=r[j][r[j].length-1].apply(s,i)})()}if(!(j in s)){var q=new b["default"].R(k.name+'.inject: "attrs" must contain the property specified by "idAttribute"!');t.errorFn(q);throw q}else{try{(function(){f["default"].forEach(k.relationList,function(C){var z=C.relation;var y=o.definitions[z];var D=s[C.localField];if(typeof C.inject==="function"){C.inject(k,C,s)}else{if(D&&C.inject!==false){if(!y){throw new b["default"].R(k.name+" relation is defined but the resource is not!")}if(f["default"]._a(D)){(function(){var E=[];f["default"].forEach(D,function(H){if(H!==o.store[z].index[H[y.idAttribute]]){try{var F=y.inject(H,t.orig());if(C.foreignKey){f["default"].set(F,C.foreignKey,s[k.idAttribute])}E.push(F)}catch(G){t.errorFn(G,"Failed to inject "+C.type+' relation: "'+z+'"!')}}})})()}else{if(D!==o.store[z].index[D[y.idAttribute]]){try{var A=y.inject(s[C.localField],t.orig());if(C.foreignKey){f["default"].set(A,C.foreignKey,s[k.idAttribute])}}catch(B){t.errorFn(B,"Failed to inject "+C.type+' relation: "'+z+'"!')}}}}}});var x=s[j];var u=k.get(x);var w=u?l.modified[x]:0;if(!u){if(s instanceof k[k["class"]]){u=s}else{u=new k[k["class"]]()}if(k.instanceEvents&&typeof u.emit!=="function"){f["default"].Events(u)}f["default"].forEach(k.relationList,function(y){if(typeof y.link==="boolean"?y.link:!!k.linkRelations){delete s[y.localField]}});f["default"].deepMixIn(u,s);l.collection.push(u);l.changeHistories[x]=[];var i=e.call(o,k,l);if(k.watchChanges){l.observers[x]=new o.observe.ObjectObserver(u);l.observers[x].open(i,u)}l.index[x]=u;i.call(u,{},{},{},null,true);l.previousAttributes[x]=f["default"].copy(u,null,null,null,k.relationFields)}else{if(t.onConflict==="merge"){f["default"].deepMixIn(u,s)}else{if(t.onConflict==="replace"){f["default"].forOwn(u,function(z,y){if(y!==k.idAttribute){if(!s.hasOwnProperty(y)){delete u[y]}}});f["default"].forOwn(s,function(z,y){if(y!==k.idAttribute){u[y]=z}})}}if(k.resetHistoryOnInject){l.previousAttributes[x]=f["default"].copy(u,null,null,null,k.relationFields);if(l.changeHistories[x].length){f["default"].forEach(l.changeHistories[x],function(y){f["default"].remove(l.changeHistory,y)});l.changeHistories[x].splice(0,l.changeHistories[x].length)}}if(l.observers[x]&&typeof l.observers[x]==="function"){l.observers[x].deliver()}}l.modified[x]=w&&l.modified[x]===w?f["default"].updateTimestamp(l.modified[x]):l.modified[x];l.expiresHeap.remove(u);var v=new Date().getTime();l.expiresHeap.push({item:u,timestamp:v,expires:k.maxAge?v+k.maxAge:Number.MAX_VALUE});p=u})()}catch(m){t.errorFn(m,s)}}}return p}d.exports=function c(m,j,i){var o=this;var l=o.definitions[m];var n=o.store[m];var k=undefined;if(!l){throw new b["default"].NER(m)}else{if(!f["default"]._o(j)&&!f["default"]._a(j)){throw new b["default"].IA(m+'.inject: "attrs" must be an object or an array!')}}i=f["default"]._(l,i);i.logFn("inject",j,i);i.beforeInject(i,j);if(i.notify){l.emit("DS.beforeInject",l,j)}k=g.call(o,l,n,j,i);l.handleChange(k);i.afterInject(i,k);if(i.notify){l.emit("DS.afterInject",l,k)}return k}},function(c,a,e){a["default"]={create:e(37),destroy:e(38),destroyAll:e(39),find:e(40),findAll:e(41),loadRelations:e(42),reap:e(43),refresh:function d(g,j,f){var i=this;var h=i.utils;return new h.Promise(function(m,l){var k=i.definitions[g];j=h.resolveId(i.definitions[g],j);if(!k){l(new i.errors.NER(g))}else{if(!h._sn(j)){l(h._snErr("id"))}else{f=h._(k,f);f.bypassCache=true;f.logFn("refresh",j,f);m(i.get(g,j))}}}).then(function(k){return k?i.find(g,j,f):k})["catch"](i.errorFn("refresh",g,j,f))},refreshAll:function b(h,j,f){var k=this;var i=k.utils;var g=k.definitions[h];j=j||{};return new i.Promise(function(m,l){if(!g){l(new k.errors.NER(h))}else{if(!i._o(j)){l(i._oErr("params"))}else{f=i._(g,f);f.bypassCache=true;f.logFn("refreshAll",j,f);m(k.filter(h,j,f))}}}).then(function(l){f.bypassCache=true;return k.findAll(h,j,f).then(function(m){i.forEach(l,function(n){if(m.indexOf(n)===-1){g.eject(n)}});return m})})["catch"](k.errorFn("refreshAll",h,j,f))},save:e(44),update:e(45),updateAll:e(46)}},function(c,a){c.exports=function b(i,g,f){var k=this;var j=k.utils;var h=k.definitions[i];var d=undefined;f=f||{};g=g||{};var e=undefined;if(!h){e=new k.errors.NER(i)}else{if(!j._o(g)){e=j._oErr("attrs")}else{f=j._(h,f);if(f.upsert&&j._sn(g[h.idAttribute])){return k.update(i,g[h.idAttribute],g,f)}f.logFn("create",g,f)}}return new j.Promise(function(m,l){if(e){l(e)}else{m(g)}}).then(function(l){return f.beforeValidate.call(l,f,l)}).then(function(l){return f.validate.call(l,f,l)}).then(function(l){return f.afterValidate.call(l,f,l)}).then(function(l){return f.beforeCreate.call(l,f,l)}).then(function(l){if(f.notify){h.emit("DS.beforeCreate",h,l)}d=k.getAdapterName(f);return k.adapters[d].create(h,j.omit(l,f.omit),f)}).then(function(l){return f.afterCreate.call(l,f,l)}).then(function(l){if(f.notify){h.emit("DS.afterCreate",h,l)}if(f.cacheResponse){var o=k.inject(h.name,l,f.orig());var n=o[h.idAttribute];var m=k.store[i];m.completedQueries[n]=new Date().getTime();m.saved[n]=j.updateTimestamp(m.saved[n]);return o}else{return k.createInstance(i,l,f)}}).then(function(l){return j.respond(l,{adapter:d},f)})["catch"](k.errorFn("create",i,g,f))}},function(c,a){c.exports=function b(g,k,e){var j=this;var i=j.utils;var f=j.definitions[g];var h=undefined,d=undefined;return new i.Promise(function(m,l){k=i.resolveId(f,k);if(!f){l(new j.errors.NER(g))}else{if(!i._sn(k)){l(i._snErr("id"))}else{h=f.get(k)||{id:k};e=i._(f,e);e.logFn("destroy",k,e);m(h)}}}).then(function(l){return e.beforeDestroy.call(l,e,l)}).then(function(l){if(e.notify){f.emit("DS.beforeDestroy",f,l)}if(e.eagerEject){f.eject(k)}d=f.getAdapter(e);return d.destroy(f,k,e)}).then(function(){return e.afterDestroy.call(h,e,h)}).then(function(l){if(e.notify){f.emit("DS.afterDestroy",f,l)}f.eject(k);return i.respond(k,{adapter:d},e)})["catch"](function(l){if(e&&e.eagerEject&&h){f.inject(h,{notify:false})}return j.errorFn("destroy",g,k,e)(l)})}},function(b,a){b.exports=function c(g,e,l){var h=this;var k=h.utils;var d=h.definitions[g];var f=undefined,j=undefined,i=undefined;e=e||{};return new k.Promise(function(n,m){if(!d){m(new h.errors.NER(g))}else{if(!k._o(e)){m(k._oErr("attrs"))}else{l=k._(d,l);l.logFn("destroyAll",e,l);k.applyScope(d,e,l);n()}}}).then(function(){j=d.defaultFilter.call(h,g,e);return l.beforeDestroy(l,j)}).then(function(){if(l.notify){d.emit("DS.beforeDestroy",d,j)}if(l.eagerEject){f=d.ejectAll(e)}i=d.getAdapterName(l);return h.adapters[i].destroyAll(d,e,l)}).then(function(){return l.afterDestroy(l,j)}).then(function(){if(l.notify){d.emit("DS.afterDestroy",d,j)}return f||d.ejectAll(e)}).then(function(m){return k.respond(m,{adapter:i},l)})["catch"](function(m){if(l&&l.eagerEject&&f){d.inject(f,{notify:false})}return h.errorFn("destroyAll",g,e,l)(m)})}},function(b,a){b.exports=function c(g,k,e){var j=this;var i=j.utils;var f=j.definitions[g];var h=j.store[g];var d=undefined;return new i.Promise(function(n,m){if(!f){m(new j.errors.NER(g))}else{if(!i._sn(k)){m(i._snErr("id"))}else{e=i._(f,e);e.logFn("find",k,e);if(e.params){e.params=i.copy(e.params)}if(e.bypassCache||!e.cacheResponse){delete h.completedQueries[k]}var l=e.maxAge&&k in h.completedQueries&&h.completedQueries[k]+e.maxAge<new Date().getTime();if((!e.findStrictCache||k in h.completedQueries)&&f.get(k)&&!e.bypassCache&&!l){n(f.get(k))}else{delete h.completedQueries[k];n()}}}}).then(function(m){if(!m){if(!(k in h.pendingQueries)){var o=undefined;var n=e.findStrategy||e.strategy;if(n==="fallback"){var l=function l(p){d=f.getAdapterName((e.findFallbackAdapters||e.fallbackAdapters)[p]);return j.adapters[d].find(f,k,e)["catch"](function(q){p++;if(p<e.fallbackAdapters.length){return l(p)}else{return i.Promise.reject(q)}})};o=l(0)}else{d=f.getAdapterName(e);o=j.adapters[d].find(f,k,e)}h.pendingQueries[k]=o.then(function(p){return e.afterFind.call(p,e,p)}).then(function(q){delete h.pendingQueries[k];if(e.cacheResponse){var p=f.inject(q,e.orig());h.completedQueries[k]=new Date().getTime();h.saved[k]=i.updateTimestamp(h.saved[k]);return p}else{return f.createInstance(q,e.orig())}})}return h.pendingQueries[k]}else{return m}}).then(function(l){return i.respond(l,{adapter:d},e)})["catch"](function(l){if(h){delete h.pendingQueries[k]}return j.errorFn("find",g,k,e)(l)})}},function(c,b){function a(h,i,n,o){var k=this;var m=k.utils;var e=k.definitions[i];var g=k.store[i];var l=k.definitions[i].idAttribute;var f=new Date().getTime();h=h||[];delete g.pendingQueries[n];g.completedQueries[n]=f;var j=e.inject(h,o.orig());if(m._a(j)){m.forEach(j,function(p){if(p){var q=p[l];if(q){g.completedQueries[q]=f;g.saved[q]=m.updateTimestamp(g.saved[q])}}})}else{o.errorFn("response is expected to be an array!");g.completedQueries[j[l]]=f}return j}c.exports=function d(h,g,l){var i=this;var k=i.utils;var e=i.definitions[h];var f=i.store[h];var m=undefined,j=undefined;return new k.Promise(function(p,o){g=g||{};if(!i.definitions[h]){o(new i.errors.NER(h))}else{if(!k._o(g)){o(k._oErr("params"))}else{l=k._(e,l);m=k.toJson(g);l.logFn("findAll",g,l);if(l.params){l.params=k.copy(l.params)}k.applyScope(e,g,l);if(l.bypassCache||!l.cacheResponse){delete f.completedQueries[m];delete f.queryData[m]}var n=l.maxAge&&m in f.completedQueries&&f.completedQueries[m]+l.maxAge<new Date().getTime();if(m in f.completedQueries&&!n){if(l.useFilter){if(l.localKeys){p(e.getAll(l.localKeys,l.orig()))}else{p(e.filter(g,l.orig()))}}else{p(f.queryData[m])}}else{p()}}}}).then(function(o){if(!o){if(!(m in f.pendingQueries)){var q=undefined;var p=l.findAllStrategy||l.strategy;if(p==="fallback"){var n=function n(r){j=e.getAdapterName((l.findAllFallbackAdapters||l.fallbackAdapters)[r]);return i.adapters[j].findAll(e,g,l)["catch"](function(s){r++;if(r<l.fallbackAdapters.length){return n(r)}else{return k.Promise.reject(s)}})};q=n(0)}else{j=e.getAdapterName(l);q=i.adapters[j].findAll(e,g,l)}f.pendingQueries[m]=q.then(function(r){return l.afterFindAll.call(r,l,r)}).then(function(r){delete f.pendingQueries[m];if(l.cacheResponse){f.queryData[m]=a.call(i,r,h,m,l);f.queryData[m].$$injected=true;return f.queryData[m]}else{k.forEach(r,function(t,s){r[s]=e.createInstance(t,l.orig())});return r}})}return f.pendingQueries[m]}else{return o}}).then(function(n){return k.respond(n,{adapter:j},l)})["catch"](function(n){if(f){delete f.pendingQueries[m]}return i.errorFn("findAll",h,g,l)(n)})}},function(c,b){function a(g,e,f){if(e in g){Object.defineProperty(g,e,{value:f,enumerable:true,configurable:true,writable:true})}else{g[e]=f}return g}c.exports=function d(f,j,i,m){var g=this;var l=g.utils;var h=g.errors;var e=g.definitions[f];var k=undefined;return new l.Promise(function(o,n){if(l._sn(j)){j=e.get(j)}if(l._s(i)){i=[i]}i=i||[];if(!e){n(new h.NER(f))}else{if(!l._o(j)){n(new h.IA('"instance(id)" must be a string, number or object!'))}else{if(!l._a(i)){n(new h.IA('"relations" must be a string or an array!'))}else{(function(){k=l._(e,m);k.logFn("loadRelations",j,i,k);var p=[];l.forEach(e.relationList,function(v){var t=v.relation;var s=e.getResource(t);var q=l._(s,m);if(!i.length||l.contains(i,t)||l.contains(i,v.localField)){var r=undefined;var w={};if(q.allowSimpleWhere){w[v.foreignKey]=j[e.idAttribute]}else{w.where={};w.where[v.foreignKey]={"==":j[e.idAttribute]}}var x=q.orig();if(typeof v.load==="function"){r=v.load(e,v,j,x)}else{if(v.type==="hasMany"){if(v.localKeys){delete w[v.foreignKey];var u=l.get(j,v.localKeys)||[];u=l._a(u)?u:l.keys(u);w.where=a({},s.idAttribute,{"in":u});x.localKeys=u}else{if(v.foreignKeys){delete w[v.foreignKey];w.where=a({},v.foreignKeys,{contains:j[e.idAttribute]})}}r=s.findAll(w,x)}else{if(v.type==="hasOne"){if(v.localKey&&l.get(j,v.localKey)){r=s.find(l.get(j,v.localKey),x)}else{if(v.foreignKey){r=s.findAll(w,x).then(function(y){return y.length?y[0]:null})}}}else{if(l.get(j,v.localKey)){r=s.find(l.get(j,v.localKey),x)}}}}if(r){p.push(r)}}});o(p)})()}}}}).then(function(n){return l.Promise.all(n)}).then(function(){return k.afterLoadRelations.call(j,k,j)})["catch"](g.errorFn("loadRelations",f,j,i,m))}},function(b,a){b.exports=function c(f,d){var i=this;var h=i.utils;var e=i.definitions[f];var g=i.store[f];return new h.Promise(function(m,l){if(!e){l(new i.errors.NER(f))}else{d=h._(e,d);if(!d.hasOwnProperty("notify")){d.notify=false}d.logFn("reap",d);var j=[];var k=new Date().getTime();var n=undefined;while((n=g.expiresHeap.peek())&&n.expires<k){j.push(n.item);delete n.item;g.expiresHeap.pop()}m(j)}}).then(function(j){if(j.length){e.beforeReap(d,j);if(d.notify){e.emit("DS.beforeReap",e,j)}}if(d.reapAction==="inject"){(function(){var l=new Date().getTime();h.forEach(j,function(m){g.expiresHeap.push({item:m,timestamp:l,expires:e.maxAge?l+e.maxAge:Number.MAX_VALUE})})})()}else{if(d.reapAction==="eject"){h.forEach(j,function(l){e.eject(l[e.idAttribute])})}else{if(d.reapAction==="refresh"){var k=(function(){var l=[];h.forEach(j,function(m){l.push(e.refresh(m[e.idAttribute]))});return{v:h.Promise.all(l)}})();if(typeof k==="object"){return k.v}}}}return j}).then(function(j){if(j.length){e.afterReap(d,j);if(d.notify){e.emit("DS.afterReap",e,j)}}return j})["catch"](i.errorFn("reap",f,d))}},function(b,a){b.exports=function c(g,d,n){var h=this;var m=h.utils;var j=h.errors;var e=h.definitions[g];var f=h.store[g];var k=undefined,l=undefined,i=undefined;return new m.Promise(function(p,o){d=m.resolveId(e,d);if(!e){o(new j.NER(g))}else{if(!m._sn(d)){o(m._snErr("id"))}else{if(!e.get(d)){o(new j.R('id "'+d+'" not found in cache!'))}else{k=e.get(d);n=m._(e,n);n.logFn("save",d,n);p(k)}}}}).then(function(o){return n.beforeValidate.call(o,n,o)}).then(function(o){return n.validate.call(o,n,o)}).then(function(o){return n.afterValidate.call(o,n,o)}).then(function(o){return n.beforeUpdate.call(o,n,o)}).then(function(p){if(n.notify){e.emit("DS.beforeUpdate",e,p)}if(n.changesOnly){if(f.observers[d]&&typeof f.observers[d]==="function"){f.observers[d].deliver()}var o=[];var r=e.changes(d);for(var q in r.added){o.push(q)}for(q in r.changed){o.push(q)}r=m.pick(p,o);if(m.isEmpty(r)){n.logFn("save - no changes",d,n);l=true;return p}else{p=r}}i=e.getAdapterName(n);return h.adapters[i].update(e,d,m.omit(p,n.omit),n)}).then(function(o){return n.afterUpdate.call(o,n,o)}).then(function(o){if(n.notify){e.emit("DS.afterUpdate",e,o)}if(l){return o}else{if(n.cacheResponse){var q=e.inject(o,n.orig());var p=q[e.idAttribute];f.saved[p]=m.updateTimestamp(f.saved[p]);if(!e.resetHistoryOnInject){f.previousAttributes[p]=m.copy(q,null,null,null,e.relationFields)}return q}else{return e.createInstance(o,n.orig())}}}).then(function(o){return m.respond(o,{adapter:i},n)})["catch"](h.errorFn("save",g,d,n))}},function(b,a){b.exports=function c(f,d,j,l){var g=this;var k=g.utils;var i=g.errors;var e=g.definitions[f];var h=undefined;return new k.Promise(function(n,m){d=k.resolveId(e,d);if(!e){m(new i.NER(f))}else{if(!k._sn(d)){m(k._snErr("id"))}else{l=k._(e,l);l.logFn("update",d,j,l);n(j)}}}).then(function(m){return l.beforeValidate.call(m,l,m)}).then(function(m){return l.validate.call(m,l,m)}).then(function(m){return l.afterValidate.call(m,l,m)}).then(function(m){return l.beforeUpdate.call(m,l,m)}).then(function(m){if(l.notify){e.emit("DS.beforeUpdate",e,m)}h=e.getAdapterName(l);return g.adapters[h].update(e,d,k.omit(m,l.omit),l)}).then(function(m){return l.afterUpdate.call(m,l,m)}).then(function(m){if(l.notify){e.emit("DS.afterUpdate",e,m)}if(l.cacheResponse){var o=e.inject(m,l.orig());var p=g.store[f];var n=o[e.idAttribute];p.saved[n]=k.updateTimestamp(p.saved[n]);if(!e.resetHistoryOnInject){p.previousAttributes[n]=k.copy(o,null,null,null,e.relationFields)}return o}else{return e.createInstance(m,l.orig())}}).then(function(m){return k.respond(m,{adapter:h},l)})["catch"](g.errorFn("update",f,d,j,l))}},function(b,a){b.exports=function c(f,j,e,l){var g=this;var k=g.utils;var i=g.errors;var d=g.definitions[f];var h=undefined;return new k.Promise(function(n,m){if(!d){m(new i.NER(f))}else{l=k._(d,l);l.logFn("updateAll",j,e,l);k.applyScope(d,e,l);n(j)}}).then(function(m){return l.beforeValidate.call(m,l,m)}).then(function(m){return l.validate.call(m,l,m)}).then(function(m){return l.afterValidate.call(m,l,m)}).then(function(m){return l.beforeUpdate.call(m,l,m)}).then(function(m){if(l.notify){d.emit("DS.beforeUpdate",d,m)}h=d.getAdapterName(l);return g.adapters[h].updateAll(d,k.omit(m,l.omit),e,l)}).then(function(m){return l.afterUpdate.call(m,l,m)}).then(function(p){if(l.notify){d.emit("DS.afterUpdate",d,j)}var m=l.orig();if(l.cacheResponse){var n=(function(){var q=d.inject(p,m);var r=g.store[f];k.forEach(q,function(s){var t=s[d.idAttribute];r.saved[t]=k.updateTimestamp(r.saved[t]);if(!d.resetHistoryOnInject){r.previousAttributes[t]=k.copy(s,null,null,null,d.relationFields)}});return{v:q}})();if(typeof n==="object"){return n.v}}else{var o=(function(){var q=[];k.forEach(p,function(r){q.push(d.createInstance(r,m))});return{v:q}})();if(typeof o==="object"){return o.v}}}).then(function(m){return k.respond(m,{adapter:h},l)})["catch"](g.errorFn("updateAll",f,j,e,l))}}])});