!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.avalon=t():e.avalon=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={exports:{},id:a,loaded:!1};return e[a].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a=n(1);n(8),n(15),n(19),n(35),n(70),n(74),n(75),e.exports=a},function(e,t,n){n(2);var a=n(3),r=n(4);a.shadowCopy(a,r),n(5),n(6),n(7),e.exports=a},function(e,t){function n(e,t,n){var a="for(var "+e+"i=0,n = this.length; i < n; i++){"+t.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+n;return Function("fn,scope",a)}var a=Object.prototype.hasOwnProperty;if(!"司徒正美".trim){var r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(r,"")}}var o=!{toString:null}.propertyIsEnumerable("toString"),i=function(){}.propertyIsEnumerable("prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=l.length;Object.keys||(Object.keys=function(e){var t=[],n=i&&"function"==typeof e;if("string"==typeof e||e&&e.callee)for(var r=0;r<e.length;++r)t.push(String(r));else for(var c in e)n&&"prototype"===c||!a.call(e,c)||t.push(String(c));if(o)for(var u=e.constructor,p=u&&u.prototype===e,v=0;s>v;v++){var d=l[v];p&&"constructor"===d||!a.call(e,d)||t.push(d)}return t}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.isArray.bind||(Function.prototype.bind=function(e){if(arguments.length<2&&void 0===e)return this;var t=this,n=arguments;return function(){var a,r=[];for(a=1;a<n.length;a++)r.push(n[a]);for(a=0;a<arguments.length;a++)r.push(arguments[a]);return t.apply(e,r)}});var c=Array.prototype.slice;try{c.call(document.documentElement)}catch(u){Array.prototype.slice=function(e,t){if(t="undefined"!=typeof t?t:this.length,Array.isArray(this))return c.call(this,e,t);var n,a,r=[],o=this.length,i=e||0;i=i>=0?i:o+i;var l=t?t:o;if(0>t&&(l=o+t),a=l-i,a>0)if(r=new Array(a),this.charAt)for(n=0;a>n;n++)r[n]=this.charAt(i+n);else for(n=0;a>n;n++)r[n]=this[i+n];return r}}var p=Array.prototype;if(!/\[native code\]/.test(p.map)){var v={indexOf:function(e,t){var n=this.length,a=~~t;for(0>a&&(a+=n);n>a;a++)if(this[a]===e)return a;return-1},lastIndexOf:function(e,t){var n=this.length,a=null==t?n-1:t;for(0>a&&(a=Math.max(0,n+a));a>=0;a--)if(this[a]===e)return a;return-1},forEach:n("","_",""),filter:n("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:n("r=[],","r[i]=_","return r"),some:n("","if(_)return true","return false"),every:n("","if(!_)return false","return true")};for(var d in v)p[d]=v[d]}e.exports={}},function(e,t){(function(t){function n(e){return new n.init(e)}t.avalon=n,n.init=function(e){this[0]=this.element=e},n.fn=n.prototype=n.init.prototype,n.shadowCopy=function(e,t){for(var n in t)e[n]=t[n];return e};var a=/[^, ]+/g,r=t.console;n.shadowCopy(n,{noop:function(){},rword:a,inspect:{}.toString,ohasOwn:{}.hasOwnProperty,log:function(){r&&n.config.debug&&Function.apply.call(console.log,console,arguments)},warn:function(){if(r&&n.config.debug){var e=console.warn||console.log;Function.apply.call(e,console,arguments)}},error:function(e,t){throw(t||Error)(e)},oneObject:function(e,t){"string"==typeof e&&(e=e.match(a)||[]);for(var n={},r=void 0!==t?t:1,o=0,i=e.length;i>o;o++)n[e[o]]=r;return n}}),e.exports=n}).call(t,function(){return this}())},function(e,t){(function(t){var n=t,a={window:n,document:{createElement:function(){return{}},createElementNS:function(){return{}},contains:Boolean},root:{outerHTML:"x"},msie:NaN,modern:!0,avalonDiv:{},avalonFragment:null};if(n.location&&n.navigator&&n.window){var r=n.document;a.document=r,a.modern=n.dispatchEvent,a.root=r.documentElement,a.avalonDiv=r.createElement("div"),a.avalonFragment=r.createDocumentFragment(),n.VBArray&&(a.msie=r.documentMode||(n.XMLHttpRequest?7:6))}e.exports=a}).call(t,function(){return this}())},function(e,t){function n(e){return h.lastIndex=0,'"'+(h.test(e)?String(e).replace(h,f):e)+'"'}function a(e){return i.test(o.call(e))}function r(e){if(!e)return!1;var t=e.length;if(t===t>>>0){var n=o.call(e).slice(8,-1);if(s.test(n))return!1;if("Array"===n)return!0;try{return{}.propertyIsEnumerable.call(e,"length")===!1?g.test(e.item||e.callee):!0}catch(a){return!e.window}}return!1}var o=avalon.inspect,i=/^\[object (?:Window|DOMWindow|global)\]$/,l=/\[native code\]/,s=/(Array|List|Collection|Map|Arguments)\]$/,c=avalon.ohasOwn,u={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},p="000000",v=function(e,t){return(p+(t||0)).slice(-e)},d="\\u00",f=function(e){var t=e.charCodeAt(0),n=u[t];return n?n:d+v(2,t.toString(16))},h=/[\x00-\x1f\x22\x5c]/g;avalon.quote="undefined"!=typeof JSON?JSON.stringify:n;var m={};"Boolean Number String Function Array Date RegExp Object Error".replace(avalon.rword,function(e){m["[object "+e+"]"]=e.toLowerCase()}),avalon.type=function(e){return null==e?String(e):"object"==typeof e||"function"==typeof e?m[o.call(e)]||"object":typeof e};var g=/^\s*\bfunction\b/;avalon.isFunction="object"==typeof alert?function(e){try{return g.test(e+"")}catch(t){return!1}}:function(e){return"[object Function]"===o.call(e)},avalon.isWindow=function(e){return e?e==e.document&&e.document!=e:!1},a(avalon.window)&&(avalon.isWindow=a);var y,_;for(y in avalon({}))break;_="0"!==y,avalon.isPlainObject=function(e,t){if(!e||"object"!==avalon.type(e)||e.nodeType||avalon.isWindow(e))return!1;try{if(e.constructor&&!c.call(e,"constructor")&&!c.call(e.constructor.prototype||{},"isPrototypeOf"))return!1}catch(n){return!1}if(_)for(t in e)return c.call(e,t);for(t in e);return void 0===t||c.call(e,t)},l.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(e){return"[object Object]"===o.call(e)&&Object.getPrototypeOf(e)===Object.prototype}),avalon.mix=avalon.fn.mix=function(){var e,t,n,a,r,o,i=arguments[0]||{},l=1,s=arguments.length,c=!1;for("boolean"==typeof i&&(c=i,i=arguments[1]||{},l++),"object"==typeof i||avalon.isFunction(i)||(i={}),l===s&&(i=this,l--);s>l;l++)if(null!=(e=arguments[l]))for(t in e){try{n=i[t],a=e[t]}catch(u){continue}i!==a&&(c&&a&&(avalon.isPlainObject(a)||(r=Array.isArray(a)))?(r?(r=!1,o=n&&Array.isArray(n)?n:[]):o=n&&avalon.isPlainObject(n)?n:{},i[t]=avalon.mix(c,o,a)):void 0!==a&&(i[t]=a))}return i},avalon.each=function(e,t){if(e){var n=0;if(r(e))for(var a=e.length;a>n&&t(n,e[n])!==!1;n++);else for(n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)break}},e.exports={avalon:avalon,isArrayLike:r}},function(e,t){var n={},a=/([a-z\d])([A-Z]+)/g,r=/[-_][^-_]/g,o=/\d\.\d{4}/,i=/[-.*+?^${}()|[\]\/\\]/g,l=[].slice;avalon.shadowCopy(avalon,{caches:{},vmodels:{},filters:{},components:{},resolvedComponents:{},directives:{},eventHooks:{},eventListeners:{},validators:{},cssHooks:n,parsers:{number:function(e){return""===e?"":parseFloat(e)||0},string:function(e){return null===e||void 0===e?"":e+""},"boolean":function(e){return"true"===e}},version:"2.0",slice:function(e,t,n){return l.call(e,t,n)},css:function(e,t,a,r){e instanceof avalon&&(e=e[0]);var o=avalon.camelize(t);if(t=avalon.cssName(o)||o,void 0===a||"boolean"==typeof a){r=n[o+":get"]||n["@:get"],"background"===t&&(t="backgroundColor");var i=r(e,t);return a===!0?parseFloat(i)||0:i}if(""===a)e.style[t]="";else{if(null==a||a!==a)return;isFinite(a)&&!avalon.cssNumber[o]&&(a+="px"),r=n[o+":set"]||n["@:set"],r(e,t,a)}},directive:function(e,t){return this.directives[e]=t},isObject:function(e){return null!==e&&"object"==typeof e},range:function(e,t,n){n||(n=1),null==t&&(t=e||0,e=0);for(var a=-1,r=Math.max(0,Math.ceil((t-e)/n)),o=new Array(r);++a<r;)o[a]=e,e+=n;return o},hyphen:function(e){return e.replace(a,"$1-$2").toLowerCase()},camelize:function(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(r,function(e){return e.charAt(1).toUpperCase()})},makeHashCode:function(e){return e=e||"avalon",String(Math.random()+Math.random()).replace(o,e)},escapeRegExp:function(e){return(e+"").replace(i,"\\$&")},Array:{merge:function(e,t){e.push.apply(e,t)},ensure:function(e,t){return-1===e.indexOf(t)?e.push(t):void 0},removeAt:function(e,t){return!!e.splice(t,1).length},remove:function(e,t){var n=e.indexOf(t);return~n?avalon.Array.removeAt(e,n):!1}}});var s=1;e.exports={avalon:avalon,getLongID:function(e){return e.uuid||(e.uuid=avalon.makeHashCode("e"))},getShortID:function(e){return e.uuid||(e.uuid="_"+ ++s)}}},function(e,t){function n(e){for(var t in e)if(avalon.ohasOwn.call(e,t)){var a=e[t];"function"==typeof n.plugins[t]?n.plugins[t](a):"object"==typeof n[t]?avalon.shadowCopy(n[t],a):n[t]=a}return this}avalon.config=n;var a={interpolate:function(e){var t=e[0],a=e[1];if(t===a)throw new SyntaxError("openTag!==closeTag");var r=t+"test"+a,o=avalon.avalonDiv;if(o.innerHTML=r,o.innerHTML!==r&&o.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");o.innerHTML="",n.openTag=t,n.closeTag=a;var i=avalon.escapeRegExp(t),l=avalon.escapeRegExp(a);n.rexpr=new RegExp(i+"([\\ss\\S]*)"+l),n.rexprg=new RegExp(i+"([\\ss\\S]*)"+l,"g"),n.rbind=new RegExp(i+"[\\ss\\S]*"+l+"|\\bms-|\\bslot\\b")}};n.plugins=a,n.plugins.interpolate(["{{","}}"]),n.debug=!0},function(e,t,n){function a(e){return e}var r=n(9),o=n(10),i=n(11),l=n(12),s=n(13),c=n(14),u=avalon.filters;avalon.__format__=function(e){var t=u[e];return t?t.get?t.get:t:a},avalon.mix(u,{uppercase:function(e){return e.toUpperCase()},lowercase:function(e){return e.toLowerCase()},truncate:function(e,t,n){return t=t||30,n="string"==typeof n?n:"...",e.length>t?e.slice(0,t-n.length)+n:String(e)},camelize:avalon.camelize,date:l,escape:o,sanitize:i,number:r,currency:function(e,t,n){return(t||"￥")+r(e,isFinite(n)?n:2)}},s,c),e.exports=avalon},function(e,t){function n(e,t,n,a){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,o=isFinite(+t)?Math.abs(t):3,i=a||",",l=n||".",s="",c=function(e,t){var n=Math.pow(10,t);return""+(Math.round(e*n)/n).toFixed(t)};return s=(o?c(r,o):""+Math.round(r)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,i)),(s[1]||"").length<o&&(s[1]=s[1]||"",s[1]+=new Array(o-s[1].length+1).join("0")),s.join(l)}e.exports=n},function(e,t){function n(e){return String(e).replace(/&/g,"&amp;").replace(a,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(r,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var a=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,r=/([^\#-~| |!])/g;e.exports=n},function(e,t){var n=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,a=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,r=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,o={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi};e.exports=function(e){return e.replace(n,"").replace(r,function(e,t){var n=e.toLowerCase().match(/<(\w+)\s/);if(n){var r=o[n[1]];r&&(e=e.replace(r,function(e,t,n){var a=n.charAt(0);return t+"="+a+"javascript:void(0)"+a}))}return e.replace(a," ").replace(/\s+/g," ")})}},function(e,t){function n(e){return parseInt(e,10)||0}function a(e,t,n){var a="";for(0>e&&(a="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),a+e}function r(e,t,n,r){return function(o){var i=o["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&-12===n&&(i=12),a(i,t,r)}}function o(e,t){return function(n,a){var r=n["get"+e](),o=(t?"SHORT"+e:e).toUpperCase();return a[o][r]}}function i(e){var t=-1*e.getTimezoneOffset(),n=t>=0?"+":"";return n+=a(Math[t>0?"floor":"ceil"](t/60),2)+a(Math.abs(t%60),2)}function l(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function s(e,t){var a,r,o=s.locate,i="",l=[];if(t=t||"mediumDate",t=o[t]||t,"string"==typeof e)if(/^\d+$/.test(e))e=n(e);else if(p.test(e))e=+RegExp.$1;else{var v=e.trim(),d=[0,0,0,0,0,0,0],f=new Date(0);v=v.replace(/^(\d+)\D(\d+)\D(\d+)/,function(e,t,a,r){var o=4===r.length?[r,t,a]:[t,a,r];return d[0]=n(o[0]),d[1]=n(o[1])-1,d[2]=n(o[2]),""});var h=f.setFullYear,m=f.setHours;v=v.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(e,t,a,r,o){return d[3]=n(t),d[4]=n(a),d[5]=n(r),o&&(d[6]=Math.round(1e3*parseFloat("0."+o))),""});var g=0,y=0;v=v.replace(/Z|([+-])(\d\d):?(\d\d)/,function(e,t,a,r){return h=f.setUTCFullYear,m=f.setUTCHours,t&&(g=n(t+a),y=n(t+r)),""}),d[3]-=g,d[4]-=y,h.apply(f,d.slice(0,3)),m.apply(f,d.slice(3)),e=f}if("number"==typeof e&&(e=new Date(e)),"date"===avalon.type(e)){for(;t;)r=u.exec(t),r?(l=l.concat(r.slice(1)),t=l.pop()):(l.push(t),t=null);return l.forEach(function(t){a=c[t],i+=a?a(e,o):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),i}}var c={yyyy:r("FullYear",4),yy:r("FullYear",2,0,!0),y:r("FullYear",1),MMMM:o("Month"),MMM:o("Month",!0),MM:r("Month",2,1),M:r("Month",1,1),dd:r("Date",2),d:r("Date",1),HH:r("Hours",2),H:r("Hours",1),hh:r("Hours",2,-12),h:r("Hours",1,-12),mm:r("Minutes",2),m:r("Minutes",1),ss:r("Seconds",2),s:r("Seconds",1),sss:r("Milliseconds",3),EEEE:o("Day"),EEE:o("Day",!0),a:l,Z:i},u=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,p=/^\/Date\((\d+)\)\/$/,v={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};v.SHORTMONTH=v.MONTH,s.locate=v,e.exports=s},function(e,t){function n(e,t,n){var a=avalon.type(e);if("array"!==a&&"object"!==a)throw"orderBy只能处理对象或数组";var r=n&&0>n?-1:1;if("string"==typeof t){var o=t;t=function(e){return e&&e[o]}}e=s(e),e.forEach(function(e){e.order=t(e.value,e.key)}),e.sort(function(e,t){var n=e.order,a=t.order;return Number.isNaN(n)&&Number.isNaN(a)?0:n===a?0:n>a?r:-r});var l="array"===a,c=l?[]:{};return i(c,e,function(e){l?c.push(e.value):c[e.key]=e.value})}function a(e,t){var n=avalon.type(e);if("array"!==n&&"object"!==n)throw"filterBy只能处理对象或数组";var a=avalon.slice(arguments,2);if("function"==typeof t)var r=t;else{if("string"!=typeof t)throw t+"必须是字符串或函数";""===t.trim()?r=function(){return!1}:(a.unshift(new RegExp(avalon.escapeRegExp(t),"i")),r=l)}e=s(e).filter(function(e){return!!r.apply(e,[e.value].concat(a))});var o="array"===n,c=o?[]:{};return i(c,e,function(e){o?c.push(e.value):c[e.key]=e.value})}function r(e,t,n){if(avalon.isObject(e)&&!Array.isArray(e)){var a=[];return i(a,t,function(t){a.push(e.hasOwnProperty(t)?e[t]:n?n[t]:"")})}throw"selectBy只支持对象"}function o(e,t,n){return t=Math.abs(Number(t))===1/0?Number(t):parseInt(t,10),Number.isNaN(t)?e:("number"==typeof e&&(e+=""),Array.isArray(e)||"string"==typeof e?(n=!n||Number.isNaN(n)?0:~~n,n=0>n?Math.max(0,e.length+n):n,e=t>=0?e.slice(n,n+t):0===n?e.slice(t,e.length):e.slice(Math.max(0,n+t),n),i(e,[])):e)}function i(e,t,n){for(var a=0,r=t.length;r>a;a++)n(t[a]);return e}function l(e,t){if(avalon.isPlainObject(e)){for(var n in e)if(t.test(e[n]))return!0}else{if(Array.isArray(e))return e.some(function(e){return t.test(e)});if(null!==e)return t.test(e)}return!1}function s(e){var t=[],n=0;return avalon.each(e,function(e,a){t[n++]={value:a,key:e}}),t}Number.isNaN=Number.isNaN||function(e){return e!==e},e.exports={limitBy:o,orderBy:n,selectBy:r,filterBy:a}},function(e,t){var n={stop:function(e){return e.stopPropagation(),e},prevent:function(e){return e.preventDefault(),e}},a={esc:27,tab:9,enter:13,space:32,del:46,up:38,left:37,right:39,down:40};avalon.each(a,function(e,t){n[e]=function(e){return e.which!==t&&(e.$return=!0),e}}),e.exports=n},function(e,t,n){var a=n(16),r=n(17),o=n(18);avalon.vdomAdaptor=function(e,t){if(!e)return"toHTML"===t?"":avalon.avalonFragment.cloneNode(!1);switch(e.nodeType){case 3:return a.prototype[t].call(e);case 8:return r.prototype[t].call(e);default:return o.prototype[t].call(e)}},e.exports={VText:a,VComment:r,VElement:o}},function(e,t){function n(e){if("string"==typeof e)this.type="#text",this.nodeValue=e,this.skipContent=!a.test(e),this.nodeType=3;else for(var t in e)this[t]=e[t]}var a=avalon.config.rexpr;n.prototype={constructor:n,toDOM:function(){return document.createTextNode(this.nodeValue)},toHTML:function(){return this.nodeValue}},e.exports=n},function(e,t){function n(e){if("string"==typeof e)this.type="#comment",this.nodeValue=e,this.skipContent=!0,this.nodeType=8;else for(var t in e)this[t]=e[t]}n.prototype={constructor:n,toDOM:function(){return document.createComment(this.nodeValue)},toHTML:function(){return"<!--"+this.nodeValue+"-->"}},e.exports=n},function(e,t){function n(e,t,n){if("object"==typeof e)for(var a in e)this[a]=e[a];else this.nodeType=1,this.type=e,this.props=t,this.children=n,this.template=""}function a(e){return e!==!1&&Object(e)!==e}var r={"class":function(e,t){e.className=t},style:function(e,t){e.style.cssText=t},"for":function(e,t){e.htmlFor=t}};n.prototype={constructor:n,toDOM:function(){var e=document.createElement(this.type);for(var t in this.props){var n=this.props[t];a(n)&&(r[t]&&avalon.msie<8?r[t](e,n):e.setAttribute(t,n+""))}if(this.skipContent)switch(this.type){case"script":e.text=this.template;break;case"style":case"template":e.innerHTML=this.template;break;case"noscript":e.textContent=this.template;break;default:var o=avalon.parseHTML(this.template);e.appendChild(o)}else this.isVoidTag||(this.children.length?this.children.forEach(function(t){t&&e.appendChild(avalon.vdomAdaptor(t,"toDOM"))}):e.appendChild(avalon.parseHTML(this.template)));return e},toHTML:function(){var e=[];for(var t in this.props){var n=this.props[t];a(n)&&e.push(t+"="+avalon.quote(this.props[t]+""))}e=e.length?" "+e.join(" "):"";var r="<"+this.type+e;return this.isVoidTag?r+"/>":(r+=">",r+=this.children.length?this.children.map(function(e){return e?avalon.vdomAdaptor(e,"toHTML"):""}).join(""):this.template,r+"</"+this.type+">")}},e.exports=n},function(e,t,n){n(20),n(21),n(22),n(23),n(24),n(25),n(31),n(33),e.exports=avalon},function(e,t){function n(e,t){try{for(;t=t.parentNode;)if(t===e)return!0;return!1}catch(n){return!1}}function a(){return(new XMLSerializer).serializeToString(this)}function r(e,t){if(e&&e.childNodes)for(var n,a=e.childNodes,i=0;n=a[i++];)if(1===n.nodeType){var l=document.createElementNS(o,n.nodeName.toLowerCase());avalon.each(n.attributes,function(e,t){l.setAttribute(t.name,t.value)}),r(n,l),t.appendChild(l)}else t.appendChild(n.cloneNode(!0))}if(avalon.contains=n,avalon.document.contains||(avalon.document.contains=function(e){return n(document,e)}),avalon.window.SVGElement){document.createTextNode("x").contains||(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))});var o="http://www.w3.org/2000/svg",i=avalon.document.createElementNS(o,"svg");i.innerHTML='<circle fill="red" />',/^\[object SVG\w*Element\]$/.test(i.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{configurable:!0,get:a,set:function(e){var t=this.tagName.toLowerCase(),n=this.parent,a=avalon.parseHTML(e);if("svg"===t)n.insertBefore(a,this);else{var o=document.createDocumentFragment();r(a,o),n.insertBefore(o,this)}n.removeChild(this)}},innerHTML:{configurable:!0,get:function(){var e=this.outerHTML,t=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),n=new RegExp("</"+this.nodeName+">$","i");return e.replace(t,"").replace(n,"")},set:function(e){if(avalon.clearHTML){avalon.clearHTML(this);var t=avalon.parseHTML(e);r(t,this)}}}})}!avalon.root.outerHTML&&window.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",a)},function(e,t){function n(e){if(!("classList"in e)){e.classList={node:e};for(var t in r)e.classList[t.slice(1)]=r[t]}return e.classList}var a=/\S+/g,r={_toString:function(){var e=this.node,t=e.className,n="string"==typeof t?t:t.baseVal,r=n.match(a);return r?r.join(" "):""},_contains:function(e){return(" "+this+" ").indexOf(" "+e+" ")>-1},_add:function(e){this.contains(e)||this._set(this+" "+e)},_remove:function(e){this._set((" "+this+" ").replace(" "+e+" "," "))},__set:function(e){e=e.trim();var t=this.node;"object"==typeof t.className?t.setAttribute("class",e):t.className=e}};"add,remove".replace(avalon.rword,function(e){avalon.fn[e+"Class"]=function(t){var r=this[0]||{};return t&&"string"==typeof t&&1===r.nodeType&&t.replace(a,function(t){n(r)[e](t)}),this}}),avalon.fn.mix({hasClass:function(e){var t=this[0]||{};return 1===t.nodeType&&n(t).contains(e)},toggleClass:function(e,t){var n="boolean"==typeof t,r=this;return String(e).replace(a,function(e){var a=n?t:!r.hasClass(e);r[a?"addClass":"removeClass"](e)}),this}})},function(e,t){function n(e){try{if("object"==typeof e)return e;e="true"===e?!0:"false"===e?!1:"null"===e?null:+e+""===e?+e:a.test(e)?avalon.parseJSON(e):e}catch(t){}return e}var a=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,r=/^[\],:{}\s]*$/,o=/(?:^|:|,)(?:\s*\[)+/g,i=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,l=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g;avalon.parseJSON=avalon.window.JSON?JSON.parse:function(e){if("string"==typeof e){if(e=e.trim(),e&&r.test(e.replace(i,"@").replace(l,"]").replace(o,"")))return new Function("return "+e)();avalon.error("Invalid JSON: "+e)}return e},avalon.fn.attr=function(e,t){return 2===arguments.length?(this[0].setAttribute(e,t),this):this[0].getAttribute(e)},avalon.fn.data=function(e,t){switch(e="data-"+avalon.hyphen(e||""),arguments.length){case 2:return this.attr(e,t),this;case 1:var a=this.attr(e);return n(a);case 0:var r={};return avalon.each(this[0].attributes,function(t,a){a&&(e=a.name,e.indexOf("data-")||(e=avalon.camelize(e.slice(5)),r[e]=n(a.value)))}),r}}},function(e,t){function n(e,t){if(e.offsetWidth<=0){if(g.test(l["@:get"](e,"display"))){var a={node:e};for(var r in m)a[r]=e.style[r],e.style[r]=m[r];t.push(a)}var o=e.parentNode;o&&1===o.nodeType&&n(o,t)}}function a(e){return e.window&&e.document?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var r=avalon.root,o=avalon.window,i=avalon.camelize,l=avalon.cssHooks,s=["","-webkit-","-o-","-moz-","-ms-"],c={"float":o.Range?"cssFloat":"styleFloat"};if(avalon.cssNumber=avalon.oneObject("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(e,t,n){if(c[e])return c[e];t=t||r.style||{};for(var a=0,o=s.length;o>a;a++)if(n=i(s[a]+e),n in t)return c[e]=n;return null},avalon.fn.css=function(e,t){if(avalon.isPlainObject(e))for(var n in e)avalon.css(this,n,e[n]);else var a=avalon.css(this,e,t);return void 0!==a?a:this},avalon.fn.position=function(){var e,t,n=this[0],a={top:0,left:0};return n?("fixed"===this.css("position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),"HTML"!==e[0].tagName&&(a=e.offset()),a.top+=avalon.css(e[0],"borderTopWidth",!0),a.left+=avalon.css(e[0],"borderLeftWidth",!0),a.top-=e.scrollTop(),a.left-=e.scrollLeft()),{top:t.top-a.top-avalon.css(n,"marginTop",!0),left:t.left-a.left-avalon.css(n,"marginLeft",!0)}):a},avalon.fn.offsetParent=function(){for(var e=this[0].offsetParent;e&&"static"===avalon.css(e,"position");)e=e.offsetParent;return avalon(e||r)},l["@:set"]=function(e,t,n){try{e.style[t]=n}catch(a){}},o.getComputedStyle)l["@:get"]=function(e,t){if(!e||!e.style)throw new Error("getComputedStyle要求传入一个节点 "+e);var n,a=getComputedStyle(e,null);return a&&(n="filter"===t?a.getPropertyValue(t):a[t],""===n&&(n=e.style[t])),n},l["opacity:get"]=function(e){var t=l["@:get"](e,"opacity");return""===t?"1":t};else{var u=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,p=/^(top|right|bottom|left)$/,v=/alpha\([^)]*\)/i,d=!!o.XDomainRequest,f="DXImageTransform.Microsoft.Alpha",h={thin:d?"1px":"2px",medium:d?"3px":"4px",thick:d?"5px":"6px"};l["@:get"]=function(e,t){var n=e.currentStyle,a=n[t];if(u.test(a)&&!p.test(a)){var r=e.style,o=r.left,i=e.runtimeStyle.left;e.runtimeStyle.left=n.left,r.left="fontSize"===t?"1em":a||0,a=r.pixelLeft+"px",r.left=o,e.runtimeStyle.left=i}return"medium"===a&&(t=t.replace("Width","Style"),"none"===n[t]&&(a="0px")),""===a?"auto":h[a]||a},l["opacity:set"]=function(e,t,n){var a=e.style,r=isFinite(n)&&1>=n?"alpha(opacity="+100*n+")":"",o=a.filter||"";a.zoom=1,a.filter=(v.test(o)?o.replace(v,r):o+" "+r).trim(),a.filter||a.removeAttribute("filter")},l["opacity:get"]=function(e){var t=e.filters.alpha||e.filters[f],n=t&&t.enabled?t.opacity:100;return n/100+""}}"top,left".replace(avalon.rword,function(e){l[e+":get"]=function(t){var n=l["@:get"](t,e);return/px$/.test(n)?n:avalon(t).position()[e]+"px"}});var m={position:"absolute",visibility:"hidden",display:"block"},g=/^(none|table(?!-c[ea]).+)/;avalon.each({Width:"width",Height:"height"},function(e,t){var a="client"+e,r="scroll"+e,o="offset"+e;l[t+":get"]=function(t,n,a){var r=-4;"number"==typeof a&&(r=a),n="Width"===e?["Left","Right"]:["Top","Bottom"];var i=t[o];return 2===r?i+avalon.css(t,"margin"+n[0],!0)+avalon.css(t,"margin"+n[1],!0):(0>r&&(i=i-avalon.css(t,"border"+n[0]+"Width",!0)-avalon.css(t,"border"+n[1]+"Width",!0)),-4===r&&(i=i-avalon.css(t,"padding"+n[0],!0)-avalon.css(t,"padding"+n[1],!0)),i)},l[t+"&get"]=function(e){var a=[];n(e,a);for(var r,o=l[t+":get"](e),i=0;r=a[i++];){e=r.node;for(var s in r)"string"==typeof r[s]&&(e.style[s]=r[s])}return o},avalon.fn[t]=function(n){var i=this[0];if(0===arguments.length){if(i.setTimeout)return i["inner"+e]||i.document.documentElement[a]||i.document.body[a];if(9===i.nodeType){var s=i.documentElement;return Math.max(i.body[r],s[r],i.body[o],s[o],s[a])}return l[t+"&get"](i)}return this.css(t,n)},avalon.fn["inner"+e]=function(){return l[t+":get"](this[0],void 0,-2)},avalon.fn["outer"+e]=function(e){return l[t+":get"](this[0],void 0,e===!0?2:0)}}),avalon.fn.offset=function(){var e=this[0],t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,a=n.body,r=n.documentElement,o=n.defaultView||n.parentWindow;if(!avalon.contains(r,e))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var i=r.clientTop||a.clientTop,l=r.clientLeft||a.clientLeft,s=Math.max(o.pageYOffset||0,r.scrollTop,a.scrollTop),c=Math.max(o.pageXOffset||0,r.scrollLeft,a.scrollLeft);return{top:t.top+s-i,left:t.left+c-l}},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){avalon.fn[e]=function(n){var o=this[0]||{},i=a(o),l="scrollTop"===e;return arguments.length?void(i?i.scrollTo(l?avalon(i).scrollLeft():n,l?n:avalon(i).scrollTop()):o[e]=n):i?t in i?i[t]:r[e]:o[e]}})},function(e,t){function n(e){var t=e.tagName.toLowerCase();return"input"===t&&/checkbox|radio/.test(e.type)?"checked":t}var a=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,r={"option:get":avalon.msie?function(e){return a.test(e.outerHTML)?e.value:e.text.trim()}:function(e){return e.value},"select:get":function(e,t){for(var n,a=e.options,o=e.selectedIndex,i=r["option:get"],l="select-one"===e.type||0>o,s=l?null:[],c=l?o+1:a.length,u=0>o?c:l?o:0;c>u;u++)if(n=a[u],(n.selected||u===o)&&!n.disabled&&(!n.parentNode.disabled||"OPTGROUP"!==n.parentNode.tagName)){if(t=i(n),l)return t;s.push(t)}return s},"select:set":function(e,t,n){t=[].concat(t);for(var a,o=r["option:get"],i=0;a=e.options[i++];)(a.selected=t.indexOf(o(a))>-1)&&(n=!0);n||(e.selectedIndex=-1)}};avalon.fn.val=function(e){var t=this[0];if(t&&1===t.nodeType){var a=0===arguments.length,o=a?":get":":set",i=r[n(t)+o];if(i)var l=i(t,e);else{if(a)return(t.value||"").replace(/\r/g,"");t.value=e}}return a?l:this}},function(e,t,n){var a=n(26),r=n(27),o=n(28),i=n(30),l={area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],col:[2,"<table><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table>","</table>"],td:[3,"<table><tr>","</tr></table>"],g:[1,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',"</svg>"],_default:avalon.modern?[0,"",""]:[1,"X<div>","</div>"]};l.th=l.td,l.optgroup=l.option,l.tbody=l.tfoot=l.colgroup=l.caption=l.thead,String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(avalon.rword,function(e){l[e]=l.g});var s=/<([\w:]+)/,c=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,u=avalon.modern?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,p=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,v=/<|&#?\w+;/,d=new a(128);avalon.parseHTML=function(e){var t,n=avalon.avalonFragment.cloneNode(!1);if("string"!=typeof e)return n;if(!v.test(e))return n.appendChild(document.createTextNode(e)),n;e=e.replace(c,"<$1></$2>").trim();var a=d.get(e);if(a)return i(a);var u=(s.exec(e)||["",""])[1].toLowerCase(),p=l[u]||l._default,f=avalon.avalonDiv;f.innerHTML=p[1]+e+p[2],r(f),avalon.modern||o(f,p,u);for(var h=p[0];h--;f=f.lastChild);for(;t=f.firstChild;)n.appendChild(t);return e.length<1024&&d.put(e,i(n)),n},avalon.innerHTML=function(e,t){if(!avalon.modern&&!u.test(t)&&!p.test(t))try{return void(e.innerHTML=t)}catch(n){}var a=this.parseHTML(t);this.clearHTML(e).appendChild(a)},avalon.clearHTML=function(e){for(avalon.$$unbind(e),e.textContent="";e.lastChild;)e.removeChild(e.lastChild);return e}},function(e,t){function n(e){this.size=0,this.limit=e,this.head=this.tail=void 0,this._keymap={}}var a=n.prototype;a.put=function(e,t){var n={key:e,value:t};return this._keymap[e]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():this.size++,t},a.shift=function(){var e=this.head;e&&(this.head=this.head.newer,this.head.older=e.newer=e.older=this._keymap[e.key]=void 0,delete this._keymap[e.key])},a.get=function(e){var t=this._keymap[e];if(void 0!==t)return t===this.tail?t.value:(t.newer&&(t===this.head&&(this.head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this.tail,this.tail&&(this.tail.newer=t),this.tail=t,t.value)},e.exports=n},function(e,t){function n(e){var t=e.getElementsByTagName("script");if(t.length)for(var n,o=0;n=t[o++];)if(r[n.type]){var i=a.cloneNode(!1);Array.prototype.forEach.call(n.attributes,function(e){e&&e.specified&&(i[e.name]=e.value,i.setAttribute(e.name,e.value))}),i.text=n.text,n.parentNode.replaceChild(i,n)}}var a=avalon.document.createElement("script"),r=avalon.oneObject(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]);e.exports=n},function(e,t,n){function a(e,t,n){var a="X<div>"===t[1]?e.lastChild.firstChild:e.lastChild;if(a&&"TABLE"===a.tagName&&"tbody"!==n)for(var i,l=a.childNodes,s=0;i=l[s++];)if("TBODY"===i.tagName&&!i.innerHTML){a.removeChild(i);break}for(l=e.all,s=0;i=l[s++];)o(i)&&r(i)}function r(e){"url(#default#VML)"!==e.currentStyle.behavior&&(e.style.behavior="url(#default#VML)",e.style.display="inline-block",e.style.zoom=1)}var o=n(29);e.exports=a},function(e,t){function n(e){var t=e.nodeName;return t.toLowerCase()===t&&e.scopeName&&""===e.outerText}e.exports=n},function(e,t){function n(e,t){if(1===e.nodeType){var n=e.nodeName.toLowerCase();"object"===n?e.parentNode&&(e.outerHTML=t.outerHTML):"input"===n&&o.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===n?e.defaultSelected=e.selected=t.defaultSelected:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}}function a(e){return e.getElementsByTagName?e.getElementsByTagName("*"):e.querySelectorAll("*")}function r(e){var t=e.cloneNode(!0);if(avalon.modern)return t;var r=a(t),o=a(e);return avalon.each(o,function(e){n(r[e],o[e])}),t}var o=/radio|checkbox/;e.exports=r},function(e,t,n){function a(e,t,n){var r=e.getAttribute("avalon-events");if(r&&(e.disabled!==!0||"click"!==t)){var o=[],i=m[t]||(m[t]=new RegExp(t+"\\:([^?s]+)","g"));r.replace(i,function(e,t){return o.push(t),e}),o.length&&n.push({elem:e,uuids:o})}e=e.parentNode,
e&&e.getAttribute&&v[t]&&a(e,t,n)}function r(e){e=new i(e);var t=e.type,n=e.target,r=[];a(n,t,r);for(var o,l,s,c=0;(s=r[c++])&&!e.cancelBubble;)for(e.currentTarget=s.elem,o=0;(l=s.uuids[o++])&&!e.isImmediatePropagationStopped;){var u=avalon.eventListeners[l];if(u){var p=g.test(l)?s.elem._ms_context_:0;if(p&&p.$hashcode===!1)return avalon.unbind(n,t,u);if(y.test(t)){var v=+new Date;v-h>16&&(u.call(p||n,e),h=v)}else u.call(p||n,e)}}}function o(e){var t=c.getAttribute("delegate-events")||"";if(-1===t.indexOf(e)){var n=t.match(f)||[];n.push(e),c.setAttribute("delegate-events",n.join("??")),b(c,e,r,!!_[e])}}function i(e){if(e.originalEvent)return this;for(var t in e)C.test(t)||"function"==typeof e[t]||(this[t]=e[t]);this.target||(this.target=e.srcElement);var n=this.target;if(0===e.type.indexOf("key"))this.which=null!=e.charCode?e.charCode:e.keyCode;else if(x.test(e.type)&&!("pageX"in this)){var a=n.ownerDocument||l,r="BackCompat"===a.compatMode?a.body:a.documentElement;this.pageX=e.clientX+(r.scrollLeft>>0)-(r.clientLeft>>0),this.pageY=e.clientY+(r.scrollTop>>0)-(r.clientTop>>0),this.wheelDeltaY=this.wheelDelta,this.wheelDeltaX=0}this.timeStamp=new Date-0,this.originalEvent=e}var l=avalon.document,s=avalon.window,c=avalon.root,u=avalon.modern,p=n(6).getShortID,v=n(32);u||(delete v.change,delete v.select);var d=avalon.eventHooks;avalon.bind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"",i=p(n),l=t+":"+i,s=d[t];s&&(t=s.type,s.fix&&(n=s.fix(e,n),n.uuid=i+"0"),l=t+":"+n.uuid),avalon.eventListeners[n.uuid]=n,-1===a.indexOf(t+":")&&(v[t]||avalon.modern&&_[t]?o(t):b(e,t,r));var c=a.split("??");""===c[0]&&c.shift(),-1===c.indexOf(l)&&(c.push(l),e.setAttribute("avalon-events",c.join("??")))}else b(e,t,n);return n},avalon.unbind=function(e,t,n){if(1===e.nodeType){var a=e.getAttribute("avalon-events")||"";switch(arguments.length){case 1:w(e,t,r),e.removeAttribute("avalon-events");break;case 2:a=a.split("??").filter(function(e){return-1===e.indexOf(t+":")}).join("??"),e.setAttribute("avalon-events",a);break;default:var o=t+":"+n.uuid;a=a.split("??").filter(function(e){return e!==o}).join("??"),e.setAttribute("avalon-events",a),delete avalon.eventListeners[n.uuid]}}else w(e,t,n)};var f=/[^\s\?]+/g,h=+new Date,m={},g=/^e\d+/,y=/move|scroll/,_={focus:!0,blur:!0},b=u?function(e,t,n,a){e.addEventListener(t,n,a)}:function(e,t,n){e.attachEvent("on"+t,n)},w=u?function(e,t,n){e.removeEventListener(t,n)}:function(e,t,n){e.detachEvent("on"+t,n)};avalon.fireDom=function(e,t,n){if(l.createEvent){var a=l.createEvent("Events");a.initEvent(t,!0,!0,n),avalon.shadowCopy(a,n),e.dispatchEvent(a)}else c.contains(e)&&(a=l.createEventObject(),avalon.shadowCopy(a,n),e.fireEvent("on"+t,a))};var x=/^(?:mouse|contextmenu|drag)|click/,C=/^(?:ms|webkit|moz)/;if(i.prototype={preventDefault:function(){var e=this.originalEvent;this.returnValue=!1,e&&(e.returnValue=!1,e.preventDefault&&e.preventDefault())},stopPropagation:function(){var e=this.originalEvent;this.cancelBubble=!0,e&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=!0,e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},"onmouseenter"in c||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){d[e]={type:t,fix:function(t,n){return function(a){var r=a.relatedTarget;return r&&(r===t||16&t.compareDocumentPosition(r))?void 0:(delete a.type,a.type=e,n.apply(this,arguments))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){s[e]&&!d.animationend&&(d.animationend={type:t})}),"oninput"in l.createElement("input")||(d.input={type:"propertychange",fix:function(e,t){return function(e){return"value"===e.propertyName?(e.type="input",t.apply(this,arguments)):void 0}}}),void 0===l.onmousewheel){var T=void 0!==l.onwheel?"wheel":"DOMMouseScroll",E="wheel"===T?"deltaY":"detail";d.mousewheel={type:T,fix:function(e,t){return function(n){var a=n[E]>0?-120:120;return n.wheelDelta=~~e._ms_wheel_+a,e._ms_wheel_=n.wheelDeltaY=n.wheelDelta,n.wheelDeltaX=0,Object.defineProperty&&Object.defineProperty(n,"type",{value:"mousewheel"}),t.apply(this,arguments)}}}}avalon.fn.bind=function(e,t,n){return this[0]?avalon.bind(this[0],e,t,n):void 0},avalon.fn.unbind=function(e,t,n){return this[0]&&avalon.unbind(this[0],e,t,n),this},avalon.$$unbind=function(e){var t=e.getElementsByTagName("*");avalon.each(t,function(e,t){1===t.nodeType&&t.getAttribute("avalon-events")&&avalon.unbind(t)})}},function(e,t){e.exports={click:!0,dblclick:!0,keydown:!0,keypress:!0,keyup:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseover:!0,mouseout:!0,wheel:!0,mousewheel:!0,input:!0,change:!0,beforeinput:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,select:!0,cut:!0,copy:!0,paste:!0,beforecut:!0,beforecopy:!0,beforepaste:!0,focusin:!0,focusout:!0,DOMFocusIn:!0,DOMFocusOut:!0,DOMActivate:!0,dragend:!0,datasetchanged:!0}},function(e,t,n){function a(){try{s.doScroll("left"),u()}catch(e){setTimeout(a)}}var r,o=n(34),i=avalon.document,l=avalon.window,s=avalon.root,c=[],u=function(e){for(r=!0;e=c.shift();)e(avalon)};if("complete"===i.readyState)setTimeout(u);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",u);else if(i.attachEvent){i.attachEvent("onreadystatechange",function(){"complete"===i.readyState&&u()});try{var p=null===l.frameElement}catch(v){}s.doScroll&&p&&l.external&&a()}l.document&&avalon.bind(l,"load",u),avalon.ready=function(e){r?e(avalon):c.push(e)},avalon.ready(function(){o(i.body)})},function(e,t){function n(e){for(var t,i=0;t=e[i++];)if(1===t.nodeType){var l=r(t);l&&++o;var s=avalon.vmodels[l];if(s&&!s.$element){a(t),avalon(t).removeClass("ms-controller"),s.$element=t;var c=new Date;t.vtree=avalon.lexer(t.outerHTML.trim());var u=new Date;avalon.log("create primitive vtree",u-c),s.$render=avalon.render(t.vtree);var p=new Date;avalon.log("create template Function ",p-u),avalon.rerenderStart=p,avalon.batch(l,!0)}else l||n(t.childNodes)}}function a(e){for(var t,n=0;n<e.childNodes.length;n++){var r=e.childNodes[n];3!==r.nodeType||i.test(r.nodeValue)?1===r.nodeType&&a(r):(t=e.removeChild(r),n--)}0===e.childNodes.length&&t&&e.appendChild(t)}function r(e){return e.getAttribute("ms-controller")}var o=0,i=/\S/;e.exports=avalon.scan=function(e){return e&&e.nodeType?(n([e]),0===o&&avalon.warn('[avalon.scan] your nodes must has "ms-controller" attribute'),void(o=0)):void avalon.warn("[avalon.scan] first argument must be element , documentFragment, or document")}},function(e,t,n){n(36),n(43),n(44),n(47),n(48),n(49),n(50),n(51),n(52),n(53),n(54),n(61),n(62),n(63),n(65),n(66),n(68)},function(e,t,n){var a=n(37);avalon.important=function(e,t){var n=e.props.wid,a=avalon.vmodels[t];if(a){if("string"==typeof avalon.caches[n]){var r=avalon.caches[n];r="__vmodel__ =  avalon.vmodels["+avalon.quote(t)+"]\n"+r;var o=Function("__vmodel__",r),i=o();return e=avalon.caches[n]=i[0],e.order="ms-important",e.skipAttrs=!1,e.props["ms-important"]=t,e.render=o,e}return e=avalon.caches[n],e.skipAttrs=e.skipContent=!0,e}return e},avalon.directive("important",{priority:1,parse:function(e,t,n){delete n.props["ms-important"];var r=n.props.wid||(n.props.wid=avalon.makeHashCode("w")),o=a([n],t)+"\n\nreturn vnodes"+t;return avalon.caches[r]=o,n.isVoidTag=!0,["vnode"+t+".props.wid = "+avalon.quote(r),"vnode"+t+" = avalon.important(vnode"+t+","+avalon.quote(e.expr)+")"].join("\n")+"\n"},diff:function(e,t,n,a){if(t.props[a]!==e.props[a]){var r=e.change||(e.change=[]);avalon.Array.ensure(r,this.update)&&(n.count+=1)}},update:function(e,t){var n=t.props["ms-important"],a=avalon.vmodels[n];a.$render=t.render,a.$element=e}})},function(e,t,n){function a(e){return v.test(e)?e:i(e,"text")}function r(e,t){return"(function(){\n\n"+e+"\n\nreturn vnodes"+t+"\n})();\n"}function o(e,t,n){t=t||String(new Date-0).slice(0,5);for(var p=[],v=!1,m="vnodes"+t,g="vnode"+t,y="var "+m+" = []\n",_=0;_<e.length;_++){var b=e[_];if(3!==b.nodeType)if(8!==b.nodeType){y+="var "+g+" = {\n	nodeType:1,\n	type: "+u(b.type)+",\n	props:{},\n	children: [],\n	isVoidTag: "+!!b.isVoidTag+',\n	template: ""}\n';var w=b.props["ms-widget"];!w&&b.type.indexOf("-")>0&&!b.props.resolved&&(b.props["ms-widget"]="@"+b.type.replace(/-/g,"_"));var x="",C=b.props["ms-controller"];if(x=l(b.props,t,b),x&&(y+=x),!b.isVoidTag)if(b.children.length){var v=b.props["ms-if"];v&&(y+="if("+g+"&&"+g+".nodeType === 1 ){\n"),y+=g+".children = "+r(o(b.children,t),t)+"\n",v&&(y+="}\n")}else y+=g+".template = "+u(b.template)+"\n";y+=m+".push("+g+")\n",C&&(y+="}")}else{var T=b.nodeValue;if(f.test(T)){0!==T.indexOf("ms-for:")&&avalon.error("ms-for指令前不能有空格");var E=b.signature;p.push(E),y+="\nvar "+E+' = {\n	nodeType:8,\n	type:"#comment",\n	vmodel:__vmodel__,\n	directive:"for",\n	skipContent:false,\n	cid:'+u(b.cid)+",\n	start:"+m+".length,\n	signature:"+u(E)+",\n	nodeValue:"+u(T)+"\n}\n",y+=m+".push("+E+")\n",y+=avalon.directives["for"].parse(b,t)}else if(h.test(T)){var E=p[p.length-1];if(0!==T.indexOf("ms-for-end:")&&avalon.error("ms-for-end指令前不能有空格"),y+=m+'.push({\n	nodeType: 8,\n	type:"#comment",\n	skipContent: true,\n	nodeValue:'+u(E)+",\n	key:traceKey\n})\n",y+="\n})\n",p.length){var E=p[p.length-1];y+=E+".end ="+m+'.push({\n	nodeType: 8,\n	type:"#comment",\n	skipContent: true,\n	signature: '+u(E)+',\n	nodeValue: "ms-for-end:"\n})\n',p.pop()}}else y+=0===T.indexOf("ms-js:")?i(T.replace("ms-js:",""),"js")+"\n":m+".push("+u(b)+")\n\n\n"}else{y+="var "+g+' = {type:"#text",nodeType:3,skipContent:true}\n';var A=c.test(b.nodeValue);if(A){var k=s(b.nodeValue);if(1===k.length){var $=i(k[0].expr);y+=g+".nodeValue = "+a(k[0].expr)+"\n"}else $=k.map(function(e){return e.type?a(e.expr):u(e.expr)}).join(" + "),y+=g+".nodeValue = String("+$+")\n";y+=g+".fixIESkip = true\n",y+=g+".skipContent = false\n"}else y+=d.test(b.nodeValue)?g+'.nodeValue = "\\n"\n':g+".nodeValue = "+u(b.nodeValue)+"\n";y+=m+".push("+g+")\n"}}return y}var i=n(38),l=n(41),s=n(42),c=avalon.config.rexpr,u=avalon.quote,p=(avalon.makeHashCode,n(40)),v=p.ident,d=p.sp,f=/^\s*ms\-for:/,h=/^\s*ms\-for\-end:/;avalon.htmlFactory=function(e,t){var n=avalon.lexer(e+"");avalon.__html=[];var a=o(n,t)+"\nreturn (avalon.__html = vnodes"+t+")";return{render:a}},e.exports=o},function(e,t,n){function a(e,t){function n(e){var t="??"+_++;return b[t]=e,t}function a(e){return b[e]}var m={};if(t=t||"other","object"==typeof e&&(t=e.type,m=e,e=m.expr),"string"!=typeof e)return"";var g=e,y=o.get(t+":"+g);if(y)return y;var _=1,b={},w=e.replace(i,n).replace(l,n).replace(v,n).replace(f,"$1").split(d),x=w.shift().replace(s,a).trim();if("on"===t&&p.test(x)&&(x+="($event)"),x=x.replace(u,"$1__vmodel__."),"js"===t)return o.put(t+":"+g,x);var C=w.map(function(e){e=e.replace(s,a).replace(u,"$1__vmodel__.");var t=!1;return e=e.replace(c,function(e,n){return t=!0,/\S/.test(n)?"(__value__,"+n+");":"(__value__);"}),t||(e+="(__value__);"),e=e.replace(/(\w+)/,'avalon.__format__("$1")'),"__value__ = "+e}),T=[];if("on"===t)C=C.map(function(e){return e.replace(/__value__/g,"$event")}),C.length&&C.push("if($event.$return){\n	return;\n}"),avalon.modern||(x=x.replace(/__vmodel__\.([^(]+)\(([^)]*)\)/,function(e,t,n){return"__vmodel__."+t+".call(__vmodel__"+(/\S/.test(n)?","+n:"")+")"})),T=["function self($event){","try{","	var __vmodel__ = this;","	"+x,"}catch(e){",r(e,t),"}","}"],C.unshift(2,0);else{if("duplex"===t){var E=["function (__vmodel__){","try{","return "+x+"\n","}catch(e){",r(e,t),"}","}"];o.put("duplex:"+g,h(E));var A=["function (__vmodel__,__value__){","try{","	"+x+" = __value__","}catch(e){",r(e,t),"}","}"];if(o.put("duplex:set:"+g,h(A)),w.length){var k=["function (__vmodel__, __value__){","try{",C.join("\n"),"return __value__\n","}catch(e){",r(e,t),"}","}"];o.put("duplex:format:"+g,h(k))}return}T=["(function(){","try{","var __value__ = "+x,"text"===t?'return __value__ == null ? "" :__value__':"return __value__","}catch(e){",r(e,t),'	return ""',"}","})()"],C.unshift(3,0)}return T.splice.apply(T,C),y=T.join("\n"),o.put(t+":"+g,y),y}function r(e,t){return"	avalon.warn(e, "+avalon.quote("parse "+t+" binding【 "+e+" 】fail")+")"}var o=n(39),i=/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/g,l=n(40).string,s=/\?\?\d+/g,c=/\(([^)]*)\)/,u=/(^|[^\w\u00c0-\uFFFF_])(@|#)(?=\w)/g,p=/^(?:\@|\#)[$\w]+$/,v=/\|\|/g,d=/\|(?=\w)/,f=/\s*(\.|\|)\s*/g,h=function(e){return"(function(){ return "+e.join("\n")+"})();\n"};e.exports=avalon.parseExpr=a},function(e,t,n){var a=n(26);e.exports=new a(512)},function(e,t){e.exports={ident:/^[$a-zA-Z_][$a-zA-Z0-9_]*$/,sp:/^\s+$/,leftSp:/^\s+/,rightSp:/s+$/,binding:/^ms-(\w+)-?(.*)/,string:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/g}},function(e,t,n){function a(e,t,n){var a=[],p="ms-skip"in e,v="";for(var d in e){var f,h=e[d];if(!p&&(f=d.match(s))){var m=f[1],g=f[2]||"",y=d;if(c[m]){var _=parseFloat(g)||0;g=m,m="on"}if(y="ms-"+m+(g?"-"+g:""),d!==y&&(delete e[d],e[y]=h),l[m]){var b={type:m,param:g,name:y,expr:h,priority:l[m].priority||100*m.charCodeAt(0)};"on"===m&&(_=_||0,b.name+="-"+_,b.priority+=100*g.charCodeAt(0)+_),a.push(b)}}else v+=o.test(d)||u[d]?"vnode"+t+".props["+i(d)+"] = "+i(h)+"\n":"vnode"+t+".props."+d+" = "+i(h)+"\n"}if(a.length){a.sort(r),v+="vnode"+t+'.order = "'+a.map(function(e){return e.name}).join(";;")+'"\n';var w=a[0],x=w&&"widget"===w.type;x?(a.shift(),a.forEach(function(e){v+="vnode"+t+".props["+i(e.name)+"] = "+i(e.expr)+"\n"}),v+=l.widget.parse(w,t,n)):a.forEach(function(e){v+=l[e.type].parse(e,t,n)})}else v+="	vnode"+t+".skipAttrs = true\n";return v}function r(e,t){return e.priority-t.priority}var o=/[W-]/,i=avalon.quote,l=avalon.directives,s=n(40).binding,c=avalon.oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),u=avalon.oneObject("break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile");e.exports=a},function(e,t,n){function a(e){for(var t,n,a=[],i=0;;){if(n=e.indexOf(avalon.config.openTag,i),-1===n)break;if(t=e.slice(i,n),0===i&&(t=t.replace(o.leftSp,"")),t&&a.push({expr:t}),i=n+avalon.config.openTag.length,n=e.indexOf(avalon.config.closeTag,i),-1===n)break;t=e.slice(i,n),t&&a.push({expr:t.replace(r,""),type:"{{}}"}),i=n+avalon.config.closeTag.length}t=e.slice(i);var l=t.replace(o.rightSp,"");return l&&a.push({expr:l}),a}var r=/\r?\n/g,o=n(40);e.exports=a},function(e,t){avalon.skipController=function(e,t,n){if(e){var a=t.$render?t.$render.$id:t.$id;return e.length>a.length?0!==e.indexOf(a+";;"):0!==a.indexOf(e)}return!1},avalon.directive("controller",{priority:2,parse:function(e,t,n){var a=avalon.quote(e.expr);delete n.props["ms-controller"];var r="vm"+t,o=["if(!vnodes"+t+".vm){ vnodes"+t+".vm = __vmodel__}","__vmodel__ = vnodes"+t+".vm || __vmodel__","vnode"+t+'.props["ms-controller"] = '+a+";","var "+r+" = avalon.vmodels["+a+"]","if(!"+r+"){return }","vnode"+t+".bottom = "+r,"if(__vmodel__){","vnode"+t+".top = __vmodel__",'var __id__ = __vmodel__.$id+ "_" + '+a,"__vmodel__ = avalon.caches[__id__] || (avalon.caches[__id__] = avalon.mediatorFactory(__vmodel__,"+r+"))","vnode"+t+".mediator = __vmodel__","}else{","__vmodel__ = "+r,"}","if(!avalon.skipController(__fast__, vnode"+t+".bottom)){ "];return o.join("\n")+"\n"},diff:function(e,t,n,a){if(t.props[a]!==e.props[a]){var r=e.change||(e.change=[]);avalon.Array.ensure(r,this.update)&&(n.count+=1)}},update:function(e,t){function n(){return i(0,n.$id)}var a=t.top,r=t.bottom,o=t.mediator;if(a&&r&&(r.$element=a&&a.$element||e,t.top=t.mediator=t.bottom=0,!r.$render)){var i=a.$render;i.$id||(i.$id=a.$id),r.$render=n,n.dom=r.$element,n.$id=i.$id+";;"+r.$id,o&&(o.$render=n)}}})},function(e,t,n){var a=n(45);avalon.directive("attr",{parse:function(e,t){return"vnode"+t+'.props["ms-attr"] = '+avalon.parseExpr(e)+";\n"},diff:function(e,t,n,a){var r=e.props[a],o=t.props[a];if(r&&"object"==typeof r){if(Array.isArray(r)&&(r=e.props[a]=avalon.mix.apply({},r)),"object"!=typeof o)e.changeAttr=r;else{var i={},l=!1;for(var s in r)r[s]!==o[s]&&(l=!0,i[s]=r[s]);l&&(e.changeAttr=i)}if(e.changeAttr){var c=e.change||(e.change=[]);avalon.Array.ensure(c,this.update)&&(n.count+=1)}}else e.props[a]=o;t.changeAttr=null},update:a})},function(e,t,n){function a(e,t){var n=t.changeAttr;if(e&&1===e.nodeType&&n){for(var a in n){var s=n[a];if("href"===a||"src"===a){if(e.hasAttribute||(s=String(s).replace(l,"&")),e[a]=s,window.chrome&&"EMBED"===e.tagName){var c=e.parentNode,u=document.createComment("ms-src");c.replaceChild(u,e),c.replaceChild(e,u)}}else if(0===a.indexOf("data-"))e.setAttribute(a,s);else{var p=r[a]||a;if("boolean"==typeof e[p]&&(e[p]=!!s),s===!1){e.removeAttribute(p);continue}var v=i.test(e)?!1:document.namespaces&&o(e)?!0:a in e.cloneNode(!1);v?e[p]=s+"":e.setAttribute(a,s)}}t.changeAttr=null}}var r=n(46),o=n(29),i=/^\[object SVG\w*Element\]$/,l=/&amp;/g;e.exports=a},function(e,t){var n=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected,","isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),a={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"};n.replace(/\w+/g,function(e){a[e.toLowerCase()]=e});var r=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,contentEditable,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");r.replace(/\w+/g,function(e){a[e.toLowerCase()]=e}),e.exports=a},function(e,t){avalon.directive("css",{parse:function(e,t){return"vnode"+t+'.props["ms-css"] = '+avalon.parseExpr(e)+";\n"},diff:function(e,t,n,a){var r=e.props[a],o=t.props[a];if(Object(r)===r){if(Array.isArray(r)&&(r=e.props[a]=avalon.mix.apply({},r)),"object"!=typeof o)e.changeStyle=r;else{var i={},l=!1;for(var s in r)r[s]!==o[s]&&(l=!0,i[s]=r[s]);l&&(e.changeStyle=i)}if(e.changeStyle){var c=e.change||(e.change=[]);avalon.Array.ensure(c,this.update)&&(n.count+=1)}}else e.props[a]=o},update:function(e,t){var n=t.changeStyle,a=avalon(e);for(var r in n)a.css(r,n[r]);delete t.changeStyle}})},function(e,t){function n(e,t){var r=e.ownerDocument,o=e.nodeName,i="_"+o;if(!n[i]){var l=r.body.appendChild(r.createElement(o));t=avalon.modern?getComputedStyle(l,null).display:l.currentStyle.display,r.body.removeChild(l),t===a&&(t="block"),n[i]=t}return n[i]}var a="none";avalon.parseDisplay=n,avalon.directive("visible",{parse:function(e,t){return"vnode"+t+'.props["ms-visible"] = '+avalon.parseExpr(e)+";\n"},diff:function(e,t,n,a){var r=e.props[a]=!!e.props[a];if(e.displayValue=t.displayValue,r!==t.props[a]){var o=e.change||(e.change=[]);avalon.Array.ensure(o,this.update)&&(n.count+=1)}},update:function(e,t){function r(){void 0!==o&&(e.style.display=o)}var o,i=t.props["ms-visible"],l=e.style.display;i?(l===a&&(o=t.displayValue,o||(e.style.display="")),""===e.style.display&&avalon(e).css("display")===a&&avalon.contains(e.ownerDocument,e)&&(o=n(e))):l!==a&&(o=a,t.displayValue=l),avalon.applyEffect(e,t,{hook:i?"onEnterDone":"onLeaveDone",cb:r})}})},function(e,t){avalon.directive("expr",{parse:function(){},diff:function(e,t,n){e.fixIESkip=!avalon.modern;var a=e.dom=t.dom;if(e.nodeValue!==t.nodeValue)if(a&&avalon.contains(avalon.root,a))this.update(a,e);else{var r=e.change||(e.change=[]);avalon.Array.ensure(r,this.update)&&(n.count+=1)}t.dom=null},update:function(e,t,n){if(3!==e.nodeType){var a=document.createTextNode(t.nodeValue);n.replaceChild(a,e)}else e.nodeValue=t.nodeValue,a=e;t.dom=a}})},function(e,t,n){var a=n(40).ident;avalon.directive("text",{parse:function(e,t,n){n.children=[{type:"#text",nodeType:3,nodeValue:""}];var r=a.test(e.expr)?e.expr:avalon.parseExpr(e);return"vnode"+t+'.props["ms-text"] ='+r+"\n"},diff:function(e,t,n,a){var r=e.props[a],o=t.props[a];e.children=t.children,e.skipContent=!0;var i=e.dom=t.dom;if(r!==o)if(e.children[0]||(e.children[0]={type:"#text",nodeType:3}),e.children[0].nodeValue=r,i)this.update(i,e);else{var l=e.change||(e.change=[]);avalon.Array.ensure(l,this.update)&&(n.count+=1)}return t.dom=null,!1},update:function(e,t){var n=t.props["ms-text"];"textContent"in e?e.textContent=n+"":e.innerText=n+"",t.dom=e}})},function(e,t){avalon.directive("html",{parse:function(e,t,n){var a=!!n.isVoidTag;n.isVoidTag=!1;var r=["var htmlId =  "+avalon.parseExpr(e),"vnode"+t+'.props["ms-html"]  = htmlId;',"vnode"+t+"._isVoidTag  = "+a,"var obj  = avalon.htmlFactory(htmlId,"+t+");",'try{eval(" new function(){"+ obj.render +"}")}catch(e){};',"vnode"+t+".children = avalon.__html;"];return r.join("\n")+"\n"},diff:function(e,t,n,a){var r=e.props[a],o=t.props[a];if(e.isVoidTag=e._isVoidTag,r!==o&&e.props[a]!==o){var i=e.change||(e.change=[]);avalon.Array.ensure(i,this.update)&&(n.count+=1)}},update:function(e,t){if(1===e.nodeType){avalon.clearHTML(e);var n=document.createDocumentFragment();t.children.forEach(function(e){e&&n.appendChild(avalon.vdomAdaptor(e,"toDOM"))}),e.appendChild(n)}}})},function(e,t,n){function a(e){return Object.keys(e).filter(function(t){return e[t]}).join(" ")}function r(e){var t=e.target;avalon(t).addClass(t.getAttribute(c[e.type])||"")}function o(e){var t=e.target,n=c[e.type];avalon(t).removeClass(t.getAttribute(n)||""),"change-active"!==n&&avalon(t).removeClass(t.getAttribute("change-active")||"")}function i(e,t){var n=e.getAttribute("old-change-class")||"",a=t.props["ms-class"];avalon(e).removeClass(n).addClass(a),e.setAttribute("old-change-class",a)}var l=n(6).getLongID,s=avalon.directives;avalon.directive("class",{parse:function(e,t){return"vnode"+t+'.props["'+e.name+'"] = '+avalon.parseExpr(e)+";\n"},diff:function(e,t,n,i){var l=i.slice(3),s=e.props[i],c=t.props[i];if(t.classEvent)e.classEvent=t.classEvent;else{var u={};"hover"===l?(u.mouseenter=r,u.mouseleave=o):"active"===l&&(e.props.tabindex=e.props.tabindex||-1,u.tabIndex=e.props.tabindex,u.mousedown=r,u.mouseup=o,u.mouseleave=o),e.classEvent=u}t.classEvent=null;var p=avalon.noop;if(Array.isArray(s)?p=s.map(function(e){return e&&"object"==typeof e?a(e):e?e:""}).join(" "):avalon.isObject(s)?p=a(s):s&&(p=String(s)),p!==avalon.noop&&(p=e.props[i]=p.trim().replace(/\s+/," "),!c||c!==p)){e["change-"+l]=p;var v=e.change||(e.change=[]);avalon.Array.ensure(v,this.update)&&(n.count+=1)}},update:function(e,t){var n=t.classEvent;if(n){for(var a in n)"tabIndex"===a?e[a]=n[a]:avalon.bind(e,a,n[a]);t.classEvent={}}var r=["class","hover","active"];r.forEach(function(n){var a="change-"+n,r=t[a];if(void 0!==r)if("class"===n)i(e,t);else{var o=e.getAttribute("change-"+n);o&&avalon(e).removeClass(o),e.setAttribute(a,r)}})}}),s.active=s.hover=s["class"];var c={mouseenter:"change-hover",mouseleave:"change-hover",mousedown:"change-active",mouseup:"change-active"};l(r),l(o)},function(e,t,n){var a=n(6).getLongID,r=n(26),o=new r(128),i=avalon.quote,l=/^ms-on-([a-z]+)/,s=/\|.+/g,c=/([@$]?\w+)/g,u=n(40).string;avalon.directive("on",{priority:3e3,parse:function(e,t){var n=e.expr.replace(u," ").replace(s,"").match(c),r=n.every(function(e){return"@"===e.charAt(0)||"#"===e.charAt(0)||"$event"===e}),l="vnode"+t+".onVm = __vmodel__\n",p=i(e.name);if(r){var v=e.expr,d=o.get(v);if(!d){var d=Function("return "+avalon.parseExpr(e,"on"))(),f=a(d);o.put(v,d)}return avalon.eventListeners[f]=d,l+"vnode"+t+".props["+p+"] = avalon.eventListeners."+f+"\n"}return l+"vnode"+t+".props["+p+"] = "+avalon.parseExpr(e,"on")+"\n"},diff:function(e,t,n,r){var o=e.props[r],i=(t.props||{})[r];if(o!==i){var s=r.match(l),c=s[1],u=c+":"+a(o);e.addEvents=e.addEvents||{},e.addEvents[u]=o,"function"==typeof i&&(e.removeEvents=e.removeEvents||{},e.removeEvents[c+":"+i.uuid]=i);var p=e.change||(e.change=[]);avalon.Array.ensure(p,this.update)&&(n.count+=1)}},update:function(e,t){if(e&&!(e.nodeType>1)){var n,a,r;e._ms_context_=t.onVm,delete t.onVm;for(n in t.removeEvents)a=n.split(":").shift(),r=t.removeEvents[n],avalon.unbind(e,a,r);delete t.removeEvents;for(n in t.addEvents)a=n.split(":").shift(),r=t.addEvents[n],avalon.bind(e,a,r);delete t.addEvents}}})},function(e,t,n){function a(e,t){var n=[];e.children.forEach(function(e){"option"===e.type?n.push(e):"optgroup"===e.type&&e.children.forEach(function(e){"option"===e.type&&n.push(e)})});var a=e.props.multiple,r={},o=null===a||void 0===a||a===!1;Array.isArray(t)?t.forEach(function(e){r[e]=1}):r[t]=1;for(var i,l=0;i=n[l++];){var s="value"in i.props?i.props.value:(i.children[0]||{nodeValue:""}).nodeValue.trim();if(i.props.selected=!!r[s],r[s]&&o)break}}var r=n(55),o=n(56),i=n(57),l=n(59),s=n(60),c=n(39);avalon.directive("duplex",{priority:2e3,parse:function(e,t,n){var a=e.expr;o(e,n),avalon.caches[a]=n.field;var r="vnode"+t+".duplexVm = __vmodel__;\nvnode"+t+'.props["ms-duplex"] = '+avalon.quote(a)+";\nvnode"+t+'.props["data-duplex-get"] = '+c.get("duplex:"+a)+"\nvnode"+t+'.props["data-duplex-set"] = '+c.get("duplex:set:"+a)+"\n",i=c.get("duplex:format:"+a);return i&&(r+="vnode"+t+'.props["data-duplex-format"] = '+i),r},diff:function(e,t,n){var r=e.props["ms-duplex"];e.field=t.field||avalon.mix({},avalon.caches[r]);var o=e.field;o.set||i(e),e.duplexVm=null;var l=e.props.value=o.get(o.vmodel);if("select"!==e.type||e.children.length||(avalon.Array.merge(e.children,avalon.lexer(e.template,0,2)),a(e,l)),o.element){var s=t.props.value;c=Array.isArray(l)?l+""==s+"":l===s}else var c=!1;if(!c){o.modelValue=l;var u=e.afterChange||(e.afterChange=[]);avalon.Array.ensure(u,this.update),n.count+=1}},update:function(e,t){var n=e._ms_field_=t.field;if(!n.element){n.element=e;var a=n.events;for(var o in a)avalon.bind(e,o,a[o]),delete a[o]}if(s(e,t),!avalon.msie&&r===!1&&!e.valueHijack){e.valueHijack=n.update;var i=setInterval(function(){avalon.contains(avalon.root,e)?e.valueHijack():clearInterval(i)},30)}var c=n.format(n.modelValue);if(n.viewValue!==c&&(n.viewValue=c,l[n.type].call(n),e.caret)){var u=n.caretPos;u&&n.updateCaret(e,u.start,u.end),n.caretPos=null}}})},function(e,t){function n(e){r[this.tagName].call(this,e),!this.caret&&this._ms_field_&&this._ms_field_.update.call(this)}var a=!1;try{var r={},o=HTMLInputElement.prototype,i=HTMLTextAreaElement.prototype,l=HTMLInputElement.prototype;Object.getOwnPropertyNames(l),r.INPUT=Object.getOwnPropertyDescriptor(o,"value").set,Object.defineProperty(o,"value",{set:n}),r.TEXTAREA=Object.getOwnPropertyDescriptor(i,"value").set,Object.defineProperty(i,"value",{set:n}),a=!0}catch(s){}e.exports=a},function(e,t){function n(e,t){var n=e.expr,c=t.props.type,u=e.param,p="checked"===u,v=t.field={parsers:[],formatters:[],modelValue:NaN,viewValue:NaN,validators:"",parse:a,format:r};p&&(i.test(c)?(v.isChecked=!0,v.type="radio"):u=null);var d=t.props["data-duplex-changed"];if(d){var f=d+":cb";if(avalon.caches[f])v.callback=avalon.caches[f];else{var h=Function("return "+avalon.parseExpr(d,"on"));avalon.caches[f]=v.callback=h()}}var m=avalon.parsers[u];m&&v.parsers.push(m),o.test(n)&&(s.test(c)?avalon.warn(c+"不支持change过滤器"):v.isChanged=!0);var g=n.match(l);g&&(v.isChanged||(v.debounceTime=parseInt(g[1],10)||300)),e.expr=v.expr=n.trim(),/input|textarea|select/.test(t.type)?v.type||(v.type="select"===t.type?"select":"checkbox"===c?"checkbox":"radio"===c?"radio":"input"):"contenteditable"in t.props&&(v.type="contenteditable"),avalon.parseExpr(e,"duplex")}function a(e){for(var t,n=0;t=this.parsers[n++];)e=t.call(this,e);return e}function r(e){for(var t=this.formatters,n=t.length;n--;)e=t[n](e);return e}var o=/\|\s*change\b/,i=/^(?:checkbox|radio)$/,l=/\|\s*debounce(?:\(([^)]+)\))?/,s=/^(file|button|reset|submit|checkbox|radio|range)$/;e.exports=n},function(e,t,n){function a(e){var t=e.field;t.update=r,t.updateCaret=d,t.get=e.props["data-duplex-get"],t.set=e.props["data-duplex-set"];var n=e.props["data-duplex-format"];n&&t.formatters.push(function(e){return n(t.vmodel,e)}),t.vmodel=e.duplexVm;var a=t.events={};switch(t.type){case"radio":"radio"===e.props.type?a.click=r:a[9>f?"click":"change"]=r;break;case"checkbox":case"select":a.change=r;break;case"contenteditable":t.isChanged?a.blur=r:avalon.modern?(h.webkitURL?a.webkitEditableContentChanged=r:h.MutationEvent&&(a.DOMCharacterDataModified=r),a.input=r):(a.keydown=p,a.paste=i,a.cut=i,a.focus=u,a.blur=c);break;case"input":t.isChanged?a.change=r:avalon.msie<10?(a.propertychange=o,f>7&&(a.keyup=r,a.keydown=r),f>8&&(e.valueHijack=r,a.dragend=i)):(a.input=r,/\[native code\]/.test(h.Int8Array)||(a.keydown=p,a.paste=i,a.cut=i,h.netscape&&(a.DOMAutoComplete=r)),a.compositionstart=c,a.compositionend=u)}/password|text/.test(e.props.type)&&(a.focus=l,a.blur=s)}function r(){var e=this,t=this._ms_field_;if(!e.composing){if(e.caret)try{var n=v(e);n.start!==n.end&&n.start+1!==n.end||(t.caretPos=n)}catch(a){avalon.warn("fixCaret error",a)}if(t.debounceTime>4){var r=new Date,o=r-t.time||0;t.time=r,o>=t.debounceTime?g[t.type].call(t):(clearTimeout(t.debounceID),t.debounceID=setTimeout(function(){g[t.type].call(t)},o))}else g[t.type].call(t)}}function o(e){"value"===e.propertyName&&r.call(this,e)}function i(e){var t=this;setTimeout(function(){r.call(t,e)},17)}function l(){this.caret=!0}function s(){this.caret=!1}function c(){this.composing=!0}function u(e){this.composing=!1}function p(e){var t=e.keyCode;91===t||t>15&&19>t||t>=37&&40>=t||i.call(this,e)}function v(e){var t=NaN,n=NaN;if(e.setSelectionRange)t=e.selectionStart,n=e.selectionEnd;else if(m.selection&&m.selection.createRange){var a=m.selection.createRange();t=0-a.duplicate().moveStart("character",-1e5),n=t+a.text.length}return{start:t,end:n}}function d(e,t,n){if(e.value&&!e.readOnly)if(e.createTextRange){var a=e.createTextRange();a.collapse(!0),a.moveStart("character",t),a.select()}else e.selectionStart=t,e.selectionEnd=n}var f=avalon.msie,h=avalon.window,m=avalon.document,g=n(58),y=n(6).getShortID;y(l),y(s),y(c),y(u),y(r),y(o),y(i),y(p),f>=8&&10>f&&avalon.bind(m,"selectionchange",function(e){var t=m.activeElement||{};!t.caret&&t.valueHijack&&t.valueHijack()}),e.exports=a},function(e,t){function n(e){e.validator&&avalon.directives.validate.validate(e,!1),e.callback&&e.callback.call(e.vmodel,{type:"changed",target:e.element})}var a={input:function(e){var t=this;e=e||"value";var a=t.element[e],r=a;a=t.format(a);var o=t.parse(a);a=o+"",o!==t.modelValue&&(t.set(t.vmodel,o),n(t)),r!==a&&(t.viewValue=a,t.element[e]=a)},radio:function(){var e=this;if(e.isChecked){var t=e.modelValue=!e.modelValue;e.set(e.vmodel,t),n(e)}else a.input.call(e)},checkbox:function(){var e=this,t=e.modelValue;Array.isArray(t)||(avalon.warn("ms-duplex应用于checkbox上要对应一个数组"),t=[t]);var a=e.element.checked?"ensure":"remove";if(t[a]){var r=e.parse(e.element.value);t[a](r),n(e)}},select:function(){var e=this,t=avalon(e.element).val();t+""!=this.modelValue+""&&(t=Array.isArray(t)?t.map(function(t){return e.parse(t)}):e.parse(t),e.modelValue=t,e.set(e.vmodel,t),n(e))},contenteditable:function(){a.input.call(this,"innerHTML")}};e.exports=a},function(e,t){var n={input:function(){this.element.value=this.viewValue},radio:function(){var e;e=this.isChecked?!!this.viewValue:this.viewValue+""===this.element.value;var t=this.element;6===avalon.msie?setTimeout(function(){t.defaultChecked=e,t.checked=e},31):t.checked=e},checkbox:function(){for(var e=!1,t=this.element,n=t.value,a=0;a<this.modelValue.length;a++){var r=this.modelValue[a];r+""===n&&(e=!0)}t.checked=e},select:function(){var e=Array.isArray(this.viewValue)?this.viewValue.map(String):this.viewValue+"";avalon(this.element).val(e)},contenteditable:function(){this.element.innerHTML=this.viewValue,this.update.call(this.element)}};e.exports=n},function(e,t){e.exports=function(e,t){
var n=t.field,a=t.props["ms-rules"];if(a&&!n.validator)for(;e&&1===e.nodeType;){var r=e._ms_validator_;if(r){n.rules=a,n.validator=r,avalon.Array.ensure(r.fields,n)&&r.addField(n);break}e=e.parentNode}}},function(e,t){function n(){var e=this.data||{};return this.message.replace(r,function(t,n){return null==e[n]?"":e[n]})}var a=avalon.directive("validate",{parse:function(e,t){return"vnode"+t+'.props["ms-validate"] = '+avalon.parseExpr(e)+";\n"},diff:function(e,t,n,r){var o=e.props[r],i=t.props[r];if(i&&i.onError&&i.addField)e.props[r]=i;else if(Object(o)===o){o.$id&&(o=o.$model),e.props[r]=o;for(var r in a.defaults)o[r]||(o[r]=a.defaults[r]);o.fields=o.fields||[];var l=e.change||(e.change=[]);avalon.Array.ensure(l,this.update)&&(n.count+=1)}},update:function(e,t){var n=t.props["ms-validate"];e._ms_validator_=n,n.element=e,e.setAttribute("novalidate","novalidate"),n.validateAllInSubmit&&avalon.bind(e,"submit",function(e){e.preventDefault(),a.validateAll.call(n,n.onValidateAll)}),"function"==typeof n.onInit&&n.onInit.call(e)},validateAll:function(e){var t=this,n="function"==typeof e?e:t.onValidateAll,r=t.fields.filter(function(e){var n=e.element;return n&&!n.disabled&&t.element.contains(n)}).map(function(e){return a.validate(e,!0)}),o=[];Promise.all(r).then(function(e){for(var a,r=0;a=e[r++];)o=o.concat(a);if(t.deduplicateInValidateAll){var i={};o=o.filter(function(e){var t=e.element,n=t.uniqueID||(t.uniqueID=setTimeout("1"));return i[n]?!1:(i[n]=!0,!0)})}n.call(t.element,o)})},addField:function(e){var t=this,n=e.element;!t.validateInKeyup||e.isChanged||e.debounceTime||avalon.bind(n,"keyup",function(t){a.validate(e,0,t)}),t.validateInBlur&&avalon.bind(n,"blur",function(t){a.validate(e,0,t)}),t.resetInFocus&&avalon.bind(n,"focus",function(a){t.onReset.call(n,a,e)})},validate:function(e,t,a){var r=[],o=e.get(e.vmodel),i=e.element,l=e.validator;if(!i.disabled){for(var s in e.rules){var c=e.rules[s];if(c!==!1){var u,p,v=avalon.validators[s];r.push(new Promise(function(e,t){u=e,p=t}));var d=function(t){if(e.norequired&&""===o&&(t=!0),t)u(!0);else{var a={element:i,data:e.data,message:i.getAttribute("data-"+s+"-message")||i.getAttribute("data-message")||v.message,validateRule:s,getMessage:n};u(a)}};e.data={},e.data[s]=c,v.get(o,e,d)}}var f=[],h=Promise.all(r).then(function(e){for(var n,r=0;n=e[r++];)"object"==typeof n&&f.push(n);return t||(f.length?l.onError.call(i,f,a):l.onSuccess.call(i,f,a),l.onComplete.call(i,f,a)),f});return h}}}),r=/\\?{{([^{}]+)\}}/gm;a.defaults={addField:a.addField,onError:avalon.noop,onSuccess:avalon.noop,onComplete:avalon.noop,onReset:avalon.noop,validateInBlur:!0,validateInKeyup:!0,validateAllInSubmit:!0,resetInFocus:!0,deduplicateInValidateAll:!1}},function(e,t){function n(e){return"regexp"===avalon.type(e)}function a(e){if("string"==typeof e&&e){var t=e.split("-");if(3===t.length&&4===t[0].length){var n=~~t[0],a=~~t[1]-1,r=~~t[2],o=new Date(n,a,r);return o.getFullYear()===n&&o.getMonth()===a&&o.getDate()===r}}return!1}avalon.directive("rules",{parse:function(e,t){var n=e.expr;return/{.+}/.test(n)?"vnode"+t+'.props["ms-rules"] = '+avalon.parseExpr(e)+";\n":void 0},diff:avalon.noop});var r=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/i,o=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;avalon.shadowCopy(avalon.validators,{pattern:{message:"必须匹配{{pattern}}这样的格式",get:function(e,t,a){var r=t.element,o=t.data;if(!n(o.pattern)){var i=r.getAttribute("pattern");o.pattern=new RegExp("^(?:"+i+")$")}return a(o.pattern.test(e)),e}},digits:function(e,t,n){return n(/^\-?\d+$/.test(e)),e},number:function(e,t,n){return n(isFinite(e)),e},required:{message:"必须填写",get:function(e,t,n){return n(""!==e),e}},equalto:{message:"密码输入不一致",get:function(e,t,n){var a=String(t.data.equalto).slice(1),r=avalon(document.getElementById(a)).val()||"";return n(e===r),e}},date:{message:"日期格式不正确",get:function(e,t,n){var r=t.data;return n("regexp"===avalon.type(r.date)?r.date.test(e):a(e)),e}},url:{message:"URL格式不正确",get:function(e,t,n){return n(o.test(e)),e}},email:{message:"email格式不正确",get:function(e,t,n){return n(r.test(e)),e}},minlength:{message:"最少输入{{minlength}}个字",get:function(e,t,n){var a=parseInt(t.data.minlength,10);return n(e.length>=a),e}},maxlength:{message:"最多输入{{maxlength}}个字",get:function(e,t,n){var a=parseInt(t.data.maxlength,10);return n(e.length<=a),e}},min:{message:"输入值不能小于{{min}}",get:function(e,t,n){var a=parseInt(t.data.min,10);return n(parseFloat(e)>=a),e}},max:{message:"输入值不能大于{{max}}",get:function(e,t,n){var a=parseInt(t.data.max,10);return n(parseFloat(e)<=a),e}},chs:{message:"必须是中文字符",get:function(e,t,n){return n(/^[\u4e00-\u9fa5]+$/.test(e)),e}}})},function(e,t,n){var a=n(64);avalon.directive("if",{priority:6,parse:function(e,t){var n="vnode"+t,a=["var ifVar = "+avalon.parseExpr(e,"if"),n+'.props["ms-if"] = ifVar;',"if(!ifVar){",n+".nodeType = 8;",n+'.directive="if";',n+'.nodeValue="ms-if"',"}"];return a.join("\n")+"\n"},diff:function(e,t,n){if(e.dom=t.dom,e.nodeType!==t.nodeType){var a=e.change||(e.change=[]);avalon.Array.ensure(a,this.update)&&(n.count+=1,e.steps=n)}},update:function(e,t,n){var r=e.nodeType,o=t.nodeType;if(r!==o){if(1===o){var i=t.dom;if(!i){i=avalon.vdomAdaptor(t,"toDOM"),t.dom=i;var l=t.props;for(var s in l)if(s.match(/ms\-on/g)){var c=l[s];"function"==typeof c&&(i._ms_context_=t.onVm,avalon.bind(i,s.split("-")[2],c))}t.onVm&&delete t.onVm}return n.replaceChild(i,e),t.steps.count&&a([i],[t],n,t.steps),avalon.applyEffect(e,t,{hook:"onEnterDone"}),t.steps=!1}8===o&&avalon.applyEffect(e,t,{hook:"onLeaveDone",cb:function(){var a=e._ms_if_||(e._ms_if_=document.createComment(t.nodeValue));n.replaceChild(a,e)}})}}})},function(e,t){function n(e,t,i,l){var s=e[0];if((s||i)&&l.count){i=i||s.parentNode;for(var c=0,u=t.length;u>c;c++){var p=t[c],v=s;if(!(avalon.msie<9&&!p.fixIESkip&&3===p.nodeType&&o.test(p.nodeValue)&&o.test(v.nodeValue))){if(v&&(s=v.nextSibling),"for"===p.directive&&p.change){if(!v)return;if(1===v.nodeType){var d=document.createComment(p.nodeValue);i.insertBefore(d,v),p.endRepeat=document.createComment("ms-for-end:"),i.insertBefore(p.endRepeat,v.nextSibling),v=d}else p.endRepeat||(p.endRepeat=a(v));s=p.endRepeat.nextSibling}if(!1!==r(v,p,i,l,"change")){!p.skipContent&&p.children&&v&&1===v.nodeType&&n(avalon.slice(v.childNodes),p.children,v,l);var f=p.props&&p.props["ms-controller"];if(f&&v){var h=avalon.vmodels[f];h.$render&&(h.$render.dom=v)}if(r(v,p,i,l,"afterChange"),!l.count)break}else p.repeatCount&&(c+=p.repeatCount+1),r(v,p,i,l,"afterChange")}}}}function a(e){for(var e,t=0,n=[];e&&(8===e.nodeType&&(0===e.nodeValue.indexOf("ms-for:")?++t:0===e.nodeValue.indexOf("ms-for-end:")&&--t),n.push(e),e=e.nextSibling,0!==t););return n.pop()}function r(e,t,n,a,r){var o=t[r];if(o){for(var i;i=o.shift();)if(a.count-=1,!1===i(e,t,n))return!1;delete t[r]}}var o=/^\s*$/;e.exports=n},function(e,t,n){function a(e,t,n){for(var a,r=0;a=e.children[r++];){if(1===a.nodeType)n=avalon.vdomAdaptor(a,"toDOM");else{var o=a.type+"#"+a.nodeValue,i=g.get(o);i||(i=avalon.vdomAdaptor(a,"toDOM"),g.put(o,i)),n=i.cloneNode(!0)}t.appendChild(n)}return t}function r(e,t){for(var n,a=[],r={children:[]},o=0;n=e[o];o++)8===n.nodeType&&n.nodeValue===t?(r.children.push(n),r.key=n.key,r.index=a.length,a.push(r),r={children:[]}):r.children.push(n);return a}function o(e,t){var n=t.match(y);if(n){var a=n[1];for(var r in e){var o=r.match(_);if(o&&o[1]===a)return i(e,r)}}}function i(e,t){var n=e[t],a=t;if(n){var r=e["***"+t];if(r){var o=r.pop();return delete e[o.id],0==r.length&&delete e["***"+t],o.c}for(var i=[{id:t,c:n}];;){if(t+="_",!e[t])break;i.push({id:t,c:e[t]})}var o=i.pop();return delete e[o.id],i.length&&(e["***"+a]=i),o.c}return n}function l(e,t){var n=t.key;if(e[n]){for(;;)if(n+="_",!e[n]){e[n]=t;break}}else e[n]=t}var s=n(64),c=n(26),u=/ms-for\:\s*/,p=/^\s*\(\s*/,v=/\s*\)\s*$/,d=/\s*,\s*/,f=/\s+as\s+([$\w]+)/,h=n(40).ident,m=/^(null|undefined|NaN|window|this|\$index|\$id)$/;avalon._each=function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++){var a=e[n],r=typeof a,o=a&&"object"===r?a.$hashcode:r+a;t(n,e[n],o)}else for(var n in e)e.hasOwnProperty(n)&&t(n,e[n],n)},avalon.directive("for",{priority:3,parse:function(e,t){var n,a=e.nodeValue;a=a.replace(f,function(e,t){return!h.test(t)||m.test(t)?avalon.error("alias "+t+" is invalid --- must be a valid JS identifier which is not a reserved name."):n=t,""});var r=a.replace(u,"").split(" in "),o="var loop"+t+" = "+avalon.parseExpr(r[1])+"\n",i=n?"var "+n+" = loop"+t+"\n":"",l=r[0].replace(p,"").replace(v,"").split(d);return 1===l.length&&l.unshift("$key"),o+i+"avalon._each(loop"+t+", function("+l+", traceKey){\n"},diff:function(e,t,n,a){var s,c,u,p=e[a],v=t[a]||{},d=!("directive"in v),f=!1;d&&(v.components=[],v.repeatCount=0);var h=v.components.length,m=e.slice(p.start,p.end);p.endRepeat=v.endRepeat,p.components=r(m.slice(1,-1),p.signature);var g=Math.max(m.length-2,0)-v.repeatCount;if(g>0){for(var y=[a+1,0],s=0,g=g-1;g>s;s++)y.push(null);t.splice.apply(t,y)}else 0>g&&t.splice.apply(t,[a,Math.abs(g)]);if(p.action=d?"init":"update",d){var _=n.count,b=p.cache={};for(s=0;c=p.components[s++];)avalon.diff(c.children,[],n),l(b,c);p.removedComponents={},f=0===p.components.length||n.count!==_}else{var b=v.cache,w=p.cache={};for(s=0;c=p.components[s++];){var u=i(b,c.key);u?(f||(f=c.index!==u.index),h--,c.nodes=u.nodes,avalon.diff(c.children,u.children,n)):h&&(u=o(b,c.key),u&&(h--,f=!0,c.nodes=u.nodes,avalon.diff(c.children,u.children,n))),c.nodes||(f=!0,avalon.diff(c.children,[],n)),l(w,c)}for(s in b){p.removedComponents=b,f=!0;break}}if(v.components.length=0,delete v.cache,f){var x=p.change||(p.change=[]);avalon.Array.ensure(x,this.update),p.steps=n,n.count+=1}return a+m.length-1},update:function(e,t,n){var r=t.action,o=t.endRepeat,i=document.createDocumentFragment();if("init"===r){for(var l=!1,c=e.nextSibling;c&&c!==o;){if(8===c.nodeType&&(l=c.nodeValue===t.signature)){t.hasRender=!0;break}c=c.nextSibling}if(!l)for(c=e.nextSibling;c&&c!==o;)n.removeChild(c),c=e.nextSibling}if(!e.domTemplate&&t.components[0]){var u=i.cloneNode(!1);a(t.components[0],u),e.domTemplate=u}var p=t.signature;for(var v in t.removedComponents){var d=t.removedComponents[v];d.nodes&&(d.nodes.forEach(function(e,t){e.parentNode&&avalon.applyEffect(e,d.children[t],{hook:"onLeaveDone",cb:function(){e.parentNode.removeChild(e)},staggerKey:p+"leave"})}),d.nodes.length=d.children.length=0)}delete t.removedComponents;for(var f=e,v=0;v<t.components.length;v++){var h=t.components[v],m=h.nodes;if(m){if(f.nextSibling!==m[0]){for(var g,y=i.cloneNode(!1),_=0;g=m[_++];)y.appendChild(g);n.insertBefore(y,f.nextSibling),b(h.nodes,h.children,{hook:"onMoveDone",staggerKey:p+"move"})}}else if(t.hasRender){var m=h.nodes=[];for(f=f.nextSibling;f&&f!==t.endRepeat&&(m.push(f),f.nodeValue!==t.signature);)f=f.nextSibling}else{var w=e.domTemplate.cloneNode(!0);m=h.nodes=avalon.slice(w.childNodes),n.insertBefore(w,f.nextSibling),b(h.nodes,h.children,{hook:"onEnterDone",staggerKey:p+"enter"})}if(f=m[m.length-1],!f)break}var x=[],C=[];t.components.forEach(function(e){x.push.apply(x,e.nodes),C.push.apply(C,e.children)}),t.repeatCount=C.length,s(x,C,n,t.steps);var T=avalon.caches[t.cid];return T&&T.call(t.vmodel,{type:"rendered",target:e,endRepeat:o,signature:t.signature}),!1}});var g=new c(128),y=/^(string|number|boolean)/,_=/^_*(string|number|boolean)/,b=function(e,t,n){t.forEach(function(a,r){avalon.applyEffect(e[r],t[r],n)})}},function(e,t,n){var a=n(67),r=n(64),o=avalon.directive("widget",{priority:4,parse:function(e,t,n){var a=!!n.isVoidTag;n.isVoidTag=!0;var r=n.props.wid||(n.props.wid=avalon.makeHashCode("w"));avalon.resolvedComponents[r]={props:avalon.shadowCopy({},n.props),template:n.template};var o=["vnode"+t+"._isVoidTag = "+a,"vnode"+t+'.props.wid = "'+r+'"',"vnode"+t+".template = "+avalon.quote(n.template),"vnode"+t+'.props["ms-widget"] = '+avalon.parseExpr(e,"widget"),"vnode"+t+" = avalon.component(vnode"+t+", __vmodel__)","if(typeof vnode"+t+'.render === "string"){',"avalon.__widget = [];","var __backup__ = __vmodel__;","__vmodel__ = vnode"+t+".vmodel;",'try{eval(" new function(){"+ vnode'+t+'.render +"}");',"}catch(e){avalon.warn(e)","}","vnode"+t+" = avalon.renderWidget(avalon.__widget[0])","}","__vmodel__ = __backup__;"];return o.join("\n")+"\n"},define:function(){return avalon.mediatorFactory.apply(this,arguments)},diff:function(e,t,n){var a=avalon.resolvedComponents,r=e.props.wid,o=a[r];if(o&&o.renderCount)if(t.props.resolved){var i=!e.diff||e.diff(e,t,n);e.skipContent=!i;var l=e.vmodel.$events.onViewChange;l&&l.length&&(n.count+=1,e.afterChange=[function(n,a){var i=avalon.vdomAdaptor(t,"toHTML"),l=avalon.vdomAdaptor(e,"toHTML");i!==l&&e.vmodel.$fire("onViewChange",{type:"viewchange",target:n,wid:r,vmodel:a.vmodel}),o.renderCount++}])}else{e.steps=n;var s=e.change||(e.change=[]);avalon.Array.ensure(s,this.replaceByComponent)&&(n.count+=1),e.afterChange=[function(t,n){e.vmodel.$fire("onReady",{type:"ready",target:t,wid:r,vmodel:n.vmodel}),o.renderCount=2}],0===e.children.length&&(n.count+=1)}else n.count+=1,e.change=[this.replaceByComment]},addDisposeMonitor:function(e){window.chrome&&window.MutationEvent?a.byMutationEvent(e):Object.defineProperty&&window.Node?a.byRewritePrototype(e):a.byPolling(e)},replaceByComment:function(e,t,n){var a=document.createComment(t.nodeValue);e?n.replaceChild(a,e):n.appendChild(a)},replaceByComponent:function(e,t,n){var i=t.type.indexOf("-")>0,l=!1;i&&document.registerElement&&(a.byCustomElement(t.type),l=!0);var s=avalon.vdomAdaptor(t,"toDOM");return e?n.replaceChild(s,e):n.appendChild(s),r([s],[t],n,t.steps),l||o.addDisposeMonitor(s),!1}})},function(e,t){function n(e){if(!s[e]){s[e]=!0;var t=Object.create(HTMLElement.prototype);t.detachedCallback=function(){var e=this;setTimeout(function(){i(e)})},document.registerElement(e,t)}}function a(e){e.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(function(){i(e)})})}function r(){if(!r.execute){r.execute=!0;var e=Node.prototype,t=e.removeChild;e.removeChild=function(e,n){return t.call(this,e,n),1===e.nodeType&&setTimeout(function(){i(e)}),e};var n=e.replaceChild;e.replaceChild=function(e,t){return n.call(this,e,t),1===e.nodeType&&setTimeout(function(){i(e)}),e};var a=e.innerHTML;e.innerHTML=function(e){var t=this.getElementsByTagName("*");a.call(this,e),l(t)};var o=e.appendChild;e.appendChild=function(e){return o.call(this,e),1===e.nodeType&&11===this.nodeType&&setTimeout(function(){i(e)}),e};var s=e.insertBefore;e.insertBefore=function(e){return s.call(this,e),1===e.nodeType&&11===this.nodeType&&setTimeout(function(){i(e)}),e}}}function o(e){avalon.Array.ensure(c,e),u||(u=setInterval(function(){for(var e,t=0;e=c[t++];)!1===i(e)&&(avalon.Array.removeAt(c,t),--t);0==c.length&&(clearInterval(u),u=0)},1e3))}function i(e){if(1===e.nodeType&&e.getAttribute("wid")&&!avalon.contains(avalon.root,e)){var t=e.getAttribute("wid"),n=avalon.resolvedComponents[t];if(n&&n.vmodel){var a=n.vmodel;return n.vmodel.$fire("onDispose",{type:"dispose",target:e,vmodel:a}),a.$element=null,a.$hashcode=!1,delete n.vmodel,delete avalon.resolvedComponents[t],!1}}}function l(e){for(var t,n=0;t=e[n++];)i(t)}var s={},c=[],u=0;e.exports={byPolling:o,byMutationEvent:a,byCustomElement:n,byRewritePrototype:r}},function(e,t,n){function a(e,t){for(var n in e)if(e[n]!==t[n])return!0;return!1}function r(){if(!p.lock){var e=p[0];e&&(r.lock=!0,e())}}function o(e){var t=d.test(e)?1e3:1;return parseFloat(e)*t}function i(e,t,n){var a=e[t];a=Array.isArray(a)?a:"function"==typeof a?[a]:[],a.forEach(function(e){e&&e(n)})}function l(e){var t=e.toLowerCase();return function(n){var a,l=this.el,s=avalon(l),u=isFinite(n.stagger)?1e3*n.stagger:0;if(u&&n.staggerKey){var v=f.get(n.staggerKey)||f.put(n.staggerKey,{count:0,items:0});v.count++,v.items++}var d=v&&v.count||0,h=function(t){var o=t!==!1;l.animating=void 0,a=!0;var s=o?"Done":"Abort";i(n,"on"+e+s,l),avalon.unbind(l,c.transitionEndEvent),avalon.unbind(l,c.animationEndEvent),v&&0===--v.items&&(v.count=0),n.queue&&(p.lock=!1,p.shift(),r())};i(n,"onBefore"+e,l),n[t]?n[t](l,function(e){h(e!==!1)}):c.css&&(s.addClass(n[t+"Class"]),"leave"===t?s.removeClass(n.enterClass+" "+n.enterActiveClass):"enter"===t&&s.removeClass(n.leaveClass+" "+n.leaveActiveClass),s.bind(c.transitionEndEvent,h),s.bind(c.animationEndEvent,h),setTimeout(function(){a=NaN===avalon.root.offsetWidth,s.addClass(n[t+"ActiveClass"]);var e=window.getComputedStyle(l),r=e[c.transitionDuration],i=e[c.animationDuration],p=o(r)||o(i);0===!p?h(!1):u||setTimeout(function(){a||h(!1)},p+130)},17+u*d))}}function s(e){e.acton||(e.action=e.hook.replace(/^on/,"").replace(/Done$/,"").toLowerCase())}var c=n(69),u=n(26);avalon.directive("effect",{priority:5,parse:function(e,t){return"vnode"+t+'.props["ms-effect"] = '+avalon.parseExpr(e)+";\n"},diff:function(e,t,n,r){var o=e.props[r];if("string"==typeof o){var i=o;o=e.props[r]={is:i}}else Array.isArray(o)&&(o=e.props[r]=avalon.mix.apply({},o));if(o.action=o.action||"enter",Object(o)===o){var l=t.props[r];if(Object(l)!==l||a(o,l)){var s=e.afterChange=e.afterChange||[];avalon.Array.ensure(s,this.update)&&(n.count+=1)}}},update:function(e,t,n,a){if(!e.animating){e.animating=!0;var o=t.props["ms-effect"],i=o.is;if(a=a||{},!i)return avalon.warn("need is option");var l=avalon.effects;c.css&&!l[i]&&avalon.effect(i,{});var s=l[i];if(!s)return avalon.warn(i+" effect is undefined");var u=a.action||o.action,v=avalon.Effect;if("function"!=typeof v.prototype[u])return avalon.warn(u+" action is undefined");var d=new v(e),f=avalon.mix(a,s,o);f.queue?(p.push(function(){d[u](f)}),r()):setTimeout(function(){d[u](f)},4)}}});var p=[];avalon.effects={},avalon.effect=function(e,t){avalon.effects[e]=t,c.css&&(t.enterClass||(t.enterClass=e+"-enter"),t.enterActiveClass||(t.enterActiveClass=t.enterClass+"-active"),t.leaveClass||(t.leaveClass=e+"-leave"),t.leaveActiveClass||(t.leaveActiveClass=t.leaveClass+"-active")),t.action||(t.action="enter")};var v=function(e){this.el=e};avalon.Effect=v,v.prototype={enter:l("Enter"),leave:l("Leave"),move:l("Move")};var d=/\d+s$/,f=new u(128);avalon.applyEffect=function(e,t,n){var a=n.cb,r=n.hook,o=1===t.nodeType&&t.props["ms-effect"];if(o&&!avalon.document.hidden){var i=o[r];a&&(Array.isArray(i)?i.push(a):i?o[r]=[i,a]:o[r]=[a]),s(n),e.animate=!0,avalon.directives.effect.update(e,t,0,avalon.shadowCopy({},n))}else a&&a()}},function(e,t){var n,a,r,o=!1,i=!1,l=!1,s=avalon.cssName("transition-duration"),c=avalon.cssName("animation-duration"),u={TransitionEvent:"transitionend",WebKitTransitionEvent:"webkitTransitionEnd",OTransitionEvent:"oTransitionEnd",otransitionEvent:"otransitionEnd"},p=avalon.window;for(var v in u){if(p[v]){r=u[v];break}try{document.createEvent(v);r=u[v];break}catch(d){}}"string"==typeof r&&(o=!0,l=!0,n=r),u={AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"};var f;for(v in u)if(p[v]){f=u[v];break}"string"==typeof f&&(i=!0,l=!0,a=f),e.exports={transition:o,animation:i,css:l,transitionEndEvent:n,animationEndEvent:a,transitionDuration:s,animationDuration:c}},function(e,t,n){function a(e,t,n){var t=t||String(new Date-0).slice(0,6),a=r(e,t,n)+"\n\nreturn vnodes"+t,o=Function("__vmodel__","__fast__",a);return o}avalon.lexer=n(71),avalon.diff=n(72),avalon.batch=n(73);var r=n(37);avalon.render=a,e.exports=avalon},function(e,t,n){function a(e){var t="??"+S++;return O[t]=e,t}function r(e){var t=O[e];return t}function o(e){return M.test(e)?e.replace(j,"").replace(k,a):e}function i(e,t,n){var i=[];if(n=n||1,"number"!=typeof t?t=0:t+=1,t>=n&&!$.test(e))return i;for(t||(e=e.replace(k,a));;){var c="",p=!1,d=e.match(y);if(d&&(c=d[0],p=new f(c.replace(E,r))),!p&&(d=e.match(_))){c=d[0],p=new h(d[1].replace(E,r));var b=p.nodeValue;if(x.test(b)){var C=i[i.length-1];C&&3===C.nodeType&&T.test(C.nodeValue)&&i.pop()}}if(!p&&(d=e.match(m))){c=d[0];var S=d[1].toLowerCase();c=l(c,S),d=c.match(g);var M={};d[2]&&u(o(d[2]),M);var j=c.slice(d[0].length,-1*(S.length+3));p={nodeType:1,type:S,props:M,template:j.replace(E,r).trim(),children:[]},p=s(p,j,i,t,n)}if(p||(d=e.match(g),d&&(c=d[0],S=d[1].toLowerCase(),M={},d[2]&&u(o(d[2]),M),p={nodeType:1,type:S,props:M,template:"",children:[],isVoidTag:!0},s(p,"",i,t,n))),!p)break;i.push(p),e=e.slice(c.length),8===p.nodeType&&w.test(p.nodeValue)&&(p.signature=v("for"),e=e.replace(A,""))}return t||(O={}),i}function l(e,t){var n=[],a=[],r=N[t+"open"]||(N[t+"open"]=new RegExp("<"+t+V,L)),o=N[t+"close"]||(N[t+"close"]=new RegExp("</"+t+">",L));e.replace(r,function(e,t){return n.push(("0000000000"+t+"<").slice(-10)),e.replace(D,"1")}).replace(o,function(e,t){a.push(("0000000000"+t+">").slice(-10))});for(var i=n.concat(a).sort(),l=i.join("").replace(b,""),s=0,c=0,u=0,p=l.length;p>u;u++){var v=l.charAt(u);if("<"===v?s+=1:s-=1,0===s){c=u;break}}var d=parseFloat(i[c])+t.length+3;return e.slice(0,d)}function s(e,t,n,a,r){var o=e.type;if(e.props["ms-skip"])e.skipContent=!0;else{switch(o){case"style":case"script":case"noscript":case"template":case"textarea":e.skipContent=!0,"textarea"===o&&(e.props.type="textarea");break;case"input":e.props.type||(e.props.type="text");case"xmp":e.children.push(new f(e.template));break;case"option":e.children.push(new f(p(e.template)));break;default:if(!e.isVoidTag){var l=i(t,a,r);e.children=l,"table"===o&&c(e.children)}}var s=e.props["ms-for"];if(s){var u=e.props["data-for-rendered"],d=u+":cb";n.push({nodeType:8,type:"#comment",nodeValue:"ms-for:"+s,signature:v("for"),cid:d}),u&&!avalon.caches[d]&&(avalon.caches[d]=Function("return "+avalon.parseExpr(u,"on"))()),delete e.props["ms-for"],n.push(e),e={nodeType:8,skipContent:!0,type:"#comment",nodeValue:"ms-for-end:"}}}return e}function c(e){for(var t,n=!1,a=0,r=0,o=e.length,i=0;o>i;i++){var l=e[i];t?"tr"!==l.type&&1===l.nodeType?t=!1:(t.children.push(l),a++,e[i]=0):"tr"===l.type&&(t={nodeType:1,type:"tbody",template:"",children:[],props:{}},t.children.push(l),n=!0,0===r&&(r=i),e[i]=t)}if(n)for(i=r;o>i&&(0!==e[i]||(e.splice(i,1),i--,a--,0!==a));i++);}function u(e,t){e.replace(I,"=").replace(H,function(e){var n=e.split("="),a=n[1]||"",o=n[0].toLowerCase();2===n.length&&0===a.indexOf("??")&&(a=a.replace(E,r).slice(1,-1).replace(F,"&").replace(P,'"')),t[o]=a})}function p(e){return String(e).replace(R,"").trim()}var v=avalon.makeHashCode,d=n(15),f=d.VText,h=d.VComment,m=/^<([^\s>\/=.$<]+)(?:\s+[^=\s]+(?:=[^>\s]+)?)*\s*>(?:[\s\S]*)<\/\1>/,g=/^<([^\s>\/=.$<]+)\s*([^>]*?)\/?>/,y=/^[^<]+/,_=/^<!--([\w\W]*?)-->/,b=/\d+/g,w=/^\s*ms-for\:/,x=/^\s*ms-for-end\:/,C=n(40),T=C.sp,E=/\?\?\d+/g,A=C.leftSp,k=C.string,$=avalon.config.rbind,O={},S=1,M=/=["']/,j=/\n\s*/g,V="(?:\\s+[^>=]*?(?:=[^>]+?)?)*>",N={},D=/./g,L=avalon.msie<9?"ig":"g",F=/&amp;/g,H=/\S+/g,P=/&quot;/g,I=/\s*=\s*/g,R=/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi;e.exports=i},function(e,t,n){function a(e,t,n){if(e)for(var s=0;s<e.length;s++){var c=e[s],u=t[s]||i();switch(c.nodeType){case 3:c.skipContent||l.expr.diff(c,u,n);break;case 8:"for"===c.directive?s=l["for"].diff(e,t,n,s):c.directive&&l[c.directive].diff(c,u,n);break;default:c.skipAttrs||r(c,u,n),c.skipContent||a(c.children,u.children||o,n)}}}function r(e,t,n){if(e.order)try{e.order.replace(/([^;]+)/g,function(a){var r=a.match(s),o=r&&r[1];return l[o]&&l[o].diff(e,t||i(),n,a),a})}catch(a){avalon.log(e,t,a,"diffProps error")}}var o=[],i=function(){return{children:[],props:{}}},l=avalon.directives,s=n(40).binding;avalon.diffProps=r,e.exports=a},function(e,t,n){function a(e,t){var n="string"==typeof e?avalon.vmodels[e]||{}:e;if(e=n.$id,l[e]?avalon.Array.ensure(s,e):l[e]=!0,!(avalon.suspendUpdate>0||"function"!=typeof n.$render||!n.$element||c)&&document.nodeName){var u=n.$element;o(function(){c=!0;var t=n.$render()||[],o={count:0};if(n.$render.dom){var s=r(t,n.$id);s&&(u=n.$render.dom,t=[s])}avalon.diff(t,u.vtree||[],o),i([u],t,null,o),o.count=0,u.vtree=t,c=!1,avalon.log("rerender",n.$id,new Date-avalon.rerenderStart),delete l[e];for(var p in l){a(p,!0);break}},t)}}function r(e,t){for(var n,a=0;n=e[a++];)if(1===n.nodeType){if(n.props["ms-controller"]===t)return n;if(n.children){var o=r(n.children,t);if(o)return o}}}function o(e,t){if(t){e();var n=s.shift();n&&a(n,!0)}else setTimeout(e,0)}var i=n(64),l={},s=[];avalon.suspendUpdate=0;var c=!1;e.exports=avalon.batch=a},function(e,t,n){function a(e){return e.length>3&&e.indexOf("-")>0&&m.test(e.charAt(0)+e.slice(-1))}function r(e){var t=!0;try{o(e)}catch(n){t=!1}return t}function o(e){e.children.forEach(function(e){if(8===e.nodeType&&e.props){if("ms-widget"in e.props)throw"unresolved"}else e.children&&o(e)})}function i(e,t,n){var a={};n?a[n]=t.children:t.children.forEach(function(e){if(1===e.nodeType){var t=e.props.slot||"default";a[t]?a[t].push(e):a[t]=[e]}}),l(e,a)}function l(e,t){for(var n,a=0;n=e[a++];)if(1===n.nodeType)if("slot"===n.type){var r=n.props.name||"default";if(t[r]){var o=t[r];e.splice.apply(e,[a-1,1].concat(o)),1===o.length&&3===o[0].nodeType&&s(e)}}else l(n.children,t);return e}function s(e){for(var t,n=0;t=e[n];n++)if(t.skipContent===!1&&3===t.nodeType){var a=e[n-1],r=e[n+1];a&&3===a.nodeType&&!/\S/.test(a.nodeValue)&&(avalon.Array.remove(e,a),--n),r&&3===r.nodeType&&!/\S/.test(r.nodeValue)&&avalon.Array.remove(e,r)}}var c=n(16),u=avalon.oneObject("wbr,xmp,template"),p=n(37),v=avalon.resolvedComponents,d={"ms-widget":1,widget:1,resolved:1},f=avalon.oneObject("onInit,onReady,onViewChange,onDispose"),h=avalon.mix({is:1,diff:1,define:1},f);avalon.document.createElement("slot"),avalon.component=function(e,t){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];f[n]?n in g?g[n].push(a):g[n]=[e[n]]:isFinite(t)&&(g[n]=a)}}if("string"!=typeof e){var r=e,o=t,s=r.props.wid,m={nodeType:8,type:"#comment",directive:"widget",props:{"ms-widget":s},nodeValue:"ms-widget placeholder"},g={},y=r.props["ms-widget"]||{};y=Array.isArray(y)?y:[y],y.forEach(n);var _=r.type.indexOf("-")>0?r.type:g.is,b=v[s];if(b||(v[s]=r,b=r),b.render)return b;if(avalon.components[_]){var w=r.type;u[w]||a(w)||avalon.warn(w+"不合适做组件的标签"),"xmp"!==w&&"template"!==w&&0!==r.children.length||(r.children=avalon.lexer(b.template)),t=avalon.components[_],avalon.modern||t.fixTag||(avalon.document.createElement(_),t.fixTag=1);var x=avalon.lexer(t.template.trim());x.length>1&&avalon.error("组件必须用一个元素包起来");var C=x[0];C.props.resolved=!0,C.type!==_&&avalon.warn("模板容器标签最好为"+_);for(var T in b.props)d[T]||(C.props[T]=b.props[T]);if(t.soleSlot){var E={},A=t.soleSlot;E[A]=/\S/.test(b.template)?r.children:new c("{{@"+A+"}}"),l(x,E)}else r.isVoidTag||i(x,r,t.soleSlot);var k=g.diff,$=g.define;$=$||avalon.directives.widget.define;var O=g.$id||avalon.makeHashCode(_.replace(/-/g,"_")),S=t.defaults;n(S,!1);var M=[o,S].concat(y),j=$.apply(function(e,t){for(var n in h)delete e[n],delete t[n]},M);j.$id=O,j.$element=o.$element,avalon.vmodels[O]=j;for(T in f)g[T]&&g[T].forEach(function(e){j.$watch(T,e)});var V=V||String(new Date-0).slice(0,6),N=p(x,V)+"\nreturn (avalon.__widget = vnodes"+V+");\n";return j.$render=o.$render,j.$fire("onInit",{type:"init",vmodel:j,wid:s,target:null}),avalon.shadowCopy(b,{diff:k,render:N,vmodel:j,placeholder:m}),b}return m}avalon.components[e]||(avalon.components[e]=t)};var m=/^[a-z]+$/;avalon.renderWidget=function(e){var t=avalon.resolvedComponents[e.props.wid];return e.order="ms-widget;;"+e.order,r(e)?(t.renderCount||(t.renderCount=1),e.props["ms-widget"]=t.props["ms-widget"],e.vmodel=t.vmodel,e.diff=t.diff,delete e.skipAttrs,e):t.placeholder}},function(e,t,n){function a(){}function r(e,t,n){var r={};e.$skipArray&&(r=avalon.oneObject(e.$skipArray),delete e.$skipArray);var o={};n=n||{},t=t||{};var i={},l=g("$"),s=n.pathname||"";n.id=n.id||l,n.hashcode=n.hashcode||l;var u,p,m;for(u in e)if(!v[u]){var _=o[u]=e[u];c(u,_,r)||(p=n.id+"."+u,m=s?s+"."+u:u,i[u]=d(p,m,t))}i.$model=h;var b=new a;b=y(b,i,e);for(u in o)b[u]=o[u],u in r?delete o[u]:o[u]=!0;return f(b,t,o,i,n),b}function o(e,t,n,r){var o={},i={},l={};n=n||{};var s,u,p,m=r.pathname,_=e.$accessors||{};for(s in t)v[s]||(o[s]=!0,c(s,t[s],{})?i[s]=t[s]:_[s]?l[s]=_[s]:(u=r.id+"."+s,p=m?m+"."+s:s,l[s]=d(u,p,n)));r.hashcode=e.$hashcode||g("$"),l.$model=h;var b=new a;b=y(b,l,i);for(s in i)b[s]=i[s],delete t[s];return f(b,n,o,l,r),b}function i(e,t){for(var n,r={},o={},i={},l={},s=avalon.slice(arguments),u=0;u<s.length;u++){var p,h,m=s[u];for(var n in m)if(m.hasOwnProperty(n)){r[n]=m[n];var b=m.$accessors;b&&b[n]?-1===s.indexOf(m[n])?o[n]=b[n]:(p=r[n],h=n,delete r[n]):"function"!=typeof r[n]&&(i[n]=1)}}"function"==typeof this&&this(r,i);for(n in i)v[n]||o[n]||c(n,r[n],_)||(o[n]=d(e.$id,n,l),o[n].set(r[n]));var w=new a;w=y(w,o,r);for(n in r){if(o[n]||(w[n]=r[n]),h&&o[n]&&p.hasOwnProperty(n)){var x=o[n];x.get.$decompose||(x.get.$decompose={}),x.get.$decompose[h+"."+n]=w}n in v?delete r[n]:r[n]=!0}return f(w,l,r,o,{id:e.$id,hashcode:g("$"),master:!0}),w}function l(e,t){e.length!==t&&e.notify("length",e.length,t,!0)}var s=n(76),c=s.isSkip,u=s.toJson,p=s.$$midway,v=s.$$skipArray,d=s.makeAccessor,f=s.makeObserver,h=s.modelAccessor,m=s.modelAdaptor,g=avalon.makeHashCode;p.masterFactory=r;var y=n(81);p.slaveFactory=o;var _={};p.mediatorFactory=avalon.mediatorFactory=i;var b=s.__array__,w=Array.prototype,x=w.splice;b.removeAll=function(e){var t=this.length;if(Array.isArray(e))for(var n=this.length-1;n>=0;n--)-1!==e.indexOf(this[n])&&x.call(this,n,1);else if("function"==typeof e)for(n=this.length-1;n>=0;n--){var a=this[n];e(a,n)&&x.call(this,n,1)}else x.call(this,0,this.length);avalon.modern||(this.$model=u(this)),l(this,t),this.notify()};var C=["push","pop","shift","unshift","splice"];C.forEach(function(e){var t=w[e];b[e]=function(n,a){var r=[],o=this.length;if("splice"===e&&Object(this[0])===this[0])for(var i=this.slice(n,a),s=w.slice.call(arguments,2),r=[n,a],c=0,p=s.length;p>c;c++){var v=i[c];r[c+2]=m(s[c],v,v&&v.$events,{id:this.$id+".*",master:!0})}else for(var d=0,f=arguments.length;f>d;d++)r[d]=m(arguments[d],0,{},{id:this.$id+".*",master:!0});var h=t.apply(this,r);return avalon.modern||(this.$model=u(this)),l(this,o),this.notify(),h}}),"sort,reverse".replace(avalon.rword,function(e){b[e]=function(){return w[e].apply(this,arguments),avalon.modern||(this.$model=u(this)),this.notify(),this}}),e.exports=avalon},function(e,t,n){function a(e){var t=avalon.type(e);if("array"===t){for(var n=[],r=0;r<e.length;r++)n[r]=a(e[r]);return n}if("object"===t){var o={};for(r in e)if("__proxy__"!==r&&"__data__"!==r&&"__const__"!==r&&e.hasOwnProperty(r)){var i=e[r];o[r]=i&&i.nodeType?i:a(i)}return o}return e}function r(e,t,n){l?Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!1,configurable:!0}):e[t]=n}function o(e,t,n,o,i){function l(e){return n[e]===!0}i.array?avalon.modern?Object.defineProperty(e,"$model",c):e.$model=a(e):(r(e,"$accessors",o),r(e,"hasOwnProperty",l),r(e,"$track",Object.keys(n).sort().join(";;"))),r(e,"$id",i.id),r(e,"$hashcode",i.hashcode),i.master===!0&&(r(e,"$element",null),r(e,"$render",0),s(e,t))}var i=n(77),l=n(80),s=i.makeFire,c={get:function(){return a(this)},set:avalon.noop,enumerable:!1,configurable:!0};i.$$midway.makeObserver=o,i.$$midway.hideProperty=r;var u={toJson:a,makeObserver:o,modelAccessor:c};for(var p in i)u[p]=i[p];e.exports=u},function(e,t,n){function a(e,t){t.__vmodel__=e;var n=v.hideProperty;n(e,"$events",t),n(e,"$watch",function(){if(2===arguments.length)return m.apply(e,arguments);throw"$watch方法参数不对"}),n(e,"$fire",function(t,n,a){var r=e.$events[t];h(r,e,t,n,a)})}function r(e,t,n){return"$"===e.charAt(0)||n[e]||"function"==typeof t||t&&t.nodeName&&t.nodeType>0}function o(e,t,n,a){if(Array.isArray(e))return v.arrayFactory(e,t,n,a);if(Object(e)===e&&"function"!=typeof e){if(t&&t.$id){if(++avalon.suspendUpdate,t.$track!==Object.keys(e).sort().join(";;"))var r=v.slaveFactory(t,e,n,a);else r=t;for(var o in e)d[o]||(r[o]=e[o]);return--avalon.suspendUpdate,r}return r=v.masterFactory(e,n,a)}return e}function i(e,t,n){function a(){return r}var r=NaN;return a.heirloom=n,{get:a,set:function(o){if(r!==o){o&&"object"==typeof o&&(o=v.modelAdaptor(o,r,n,{
pathname:t,id:e}));var i=r;r=o;var u=n.__vmodel__;if(this.$hashcode&&u){n!==u.$events&&(a.heirloom=u.$events),s(a.$decompose,t,o,i),-1===t.indexOf("*")&&h(a.heirloom[t],u,t,o,i),l(e,u,t,o,i),c(a.heirloom,u,t,o,i),avalon.rerenderStart=new Date;var p=u.$id.indexOf(".");p>0?avalon.batch(u.$id.slice(0,p),!0):avalon.batch(u,!0)}}},enumerable:!0,configurable:!0}}function l(e,t,n,a,r){if(e.indexOf(".*.")>0){var o=e.match(g),i=avalon.vmodels[o[1]];if(i){var l=o[2];h(i.$events[l],t,n,a,r)}}}function s(e,t,n,a){if(e&&e[t]){var r=e[t];if(r.$hashcode){var o=t.replace(/^[^.]+\./,"");o!==t&&h(r.$events[o],r,o,n,a)}else delete e[t]}}function c(e,t,n,a,r){e.__fuzzy__&&e.__fuzzy__.replace(avalon.rword,function(o){var i=e[o],l=i.reg;return l&&l.test(n)&&h(i,t,n,a,r),o})}function u(e){var t=e.$id;if(!t&&avalon.config.debug&&avalon.warn("vm.$id must be specified"),avalon.vmodels[t])throw Error("error:[",t,"] had defined!");var n=v.masterFactory(e,{},{pathname:"",id:t,master:!0});return avalon.vmodels[t]=n}function p(e,t,n,a){if(t&&t.splice){var r=[0,t.length].concat(e);return++avalon.suspendUpdate,t.splice.apply(t,r),--avalon.suspendUpdate,t}for(var i in y)e[i]=y[i];e.notify=function(e,t,r,o){var i=n.__vmodel__;if(i){var l=null===e||void 0===e?a.pathname:a.pathname+"."+e;i.$fire(l,t,r),o||avalon.suspendUpdate||(avalon.rerenderStart=new Date,avalon.batch(i,!0))}};var l=avalon.makeHashCode("$");a.array=!0,a.hashcode=l,a.id=a.id||l,v.makeObserver(e,n,{},{},a);for(var s=0,c=e.length;c>s;s++)e[s]=o(e[s],0,{},{id:e.$id+".*",master:!0});return e}var v={},d=n(78),f=n(79),h=f.$emit,m=f.$watch;v.modelAdaptor=o;var g=/([^.]+)\.(.+)/;v.arrayFactory=p;var y={set:function(e,t){if(e>>>0===e&&this[e]!==t){if(e>this.length)throw Error(e+"set方法的第一个参数不能大于原数组长度");this.splice(e,1,t)}},contains:function(e){return-1!==this.indexOf(e)},ensure:function(e){return this.contains(e)||this.push(e),this},pushArray:function(e){return this.push.apply(this,e)},remove:function(e){return this.removeAt(this.indexOf(e))},removeAt:function(e){return e>>>0===e?this.splice(e,1):[]},clear:function(){return this.removeAll(),this}};avalon.define=u,e.exports={$$midway:v,$$skipArray:d,isSkip:r,__array__:y,makeFire:a,makeAccessor:i,modelAdaptor:o}},function(e,t){e.exports=avalon.oneObject("$id,$render,$track,$element,$watch,$fire,$events,$model,$skipArray,$accessors,$hashcode,__proxy__,__data__,__const__")},function(e,t){function n(e,t){var n,a=t.split(".")[0];try{e.hasOwnProperty(a)&&(n=e.$accessors?e.$accessors[a].get.heirloom.__vmodel__:Object.getOwnPropertyDescriptor(e,a).get.heirloom.__vmodel__)}catch(r){}return n||e}function a(e){var t=e.split(".");return new RegExp("^"+t.map(function(e){return"*"===e?"(?:[^.]+)":e}).join("\\.")+"$","i")}function r(e,t,n){e&&(t.__fuzzy__?-1===t.__fuzzy__.indexOf(","+n)&&(t.__fuzzy__+=","+n):t.__fuzzy__=n)}function o(e,t){var n=e.indexOf(".*")>0||"*"===e,i=n?this:o.adjust(this,e),l=i.$events,s=l[e]||(l[e]=[]);return n&&(s.reg=s.reg||a(e)),r(n,l,e),i!==this&&(r(n,this.$events,e),this.$events[e]=s),avalon.Array.ensure(s,t),function(){avalon.Array.remove(s,t)}}function i(e,t,n,a,r,o){if(e&&e.length)try{for(o=o||e.length-1;o>=0;o--){var l=e[o];l.call(t,a,r,n)}}catch(s){o-1>0&&i(e,t,n,a,r,o-1),avalon.log(s,n)}}o.adjust=n,e.exports={$emit:i,$watch:o,adjustVm:n}},function(e,t){var n=!0;try{Object.defineProperty({},"_",{value:"x"})}catch(a){n=!1}e.exports=n},function(e,t,n){function a(e,t,n,a){var r=t[n];return 4!==arguments.length?r.get.call(e):void r.set.call(e,a)}var r,o=n(80),i=n(78),l=Object.defineProperties,s=new Date-0;if(!o&&("__defineGetter__"in avalon&&(r=function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},l=function(e,t){for(var n in t)t.hasOwnProperty(n)&&r(e,n,t[n]);return e}),avalon.msie)){var c={};window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),l=function(e,t,n){var r=[];r.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d"+s+", p"+s+")","		Set [__data__] = d"+s+": set [__proxy__] = p"+s,"		Set [__const__] = Me","	End Function");var o={__proxy__:!0,__data__:!0,__const__:!0};for(e in t)o[e]=!0,r.push("	Public Property Let ["+e+"](val"+s+")",'		Call [__proxy__](Me,[__data__], "'+e+'", val'+s+")","	End Property","	Public Property Set ["+e+"](val"+s+")",'		Call [__proxy__](Me,[__data__], "'+e+'", val'+s+")","	End Property","	Public Property Get ["+e+"]","	On Error Resume Next","		Set["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"	If Err.Number <> 0 Then","		["+e+'] = [__proxy__](Me,[__data__],"'+e+'")',"	End If","	On Error Goto 0","	End Property");for(e in n)o[e]!==!0&&(o[e]=!0,r.push("	Public ["+e+"]"));for(e in i)o[e]!==!0&&(o[e]=!0,r.push("	Public ["+e+"]"));r.push("	Public [hasOwnProperty]"),r.push("End Class");var l=r.join("\r\n"),u=c[l];u||(u=avalon.makeHashCode("VBClass"),window.parseVB("Class "+u+l),window.parseVB(["Function "+u+"Factory(a, b)","	Dim o","	Set o = (New "+u+")(a, b)","	Set "+u+"Factory = o","End Function"].join("\r\n")),c[l]=u);var p=window[u+"Factory"](t,a);return p}}e.exports=l}])});
//# sourceMappingURL=avalon.min.js.map