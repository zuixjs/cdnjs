{"version":3,"file":"ractive.min.js","sources":["../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/config/visibility.js","../src/view/items/element/transitions/prefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/Fragment.js","../src/events/HookQueue.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/Ractive/static/styles.js","../src/extend/_extend.js","../src/Ractive.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/model/specials/KeyModel.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/model/specials/CSSModel.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/view/items/shared/Item.js","../src/model/ComputationChild.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/Alias.js","../src/view/helpers/specialAttrs.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/view/items/Comment.js","../src/Ractive/prototype/teardown.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/view/items/Component.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/model/ModelBase.js","../src/global/capture.js","../src/model/LinkModel.js","../src/shared/getFunction.js","../src/config/template.js","../src/parse/Parser.js","../src/config/types.js","../src/parse/converters/expressions/readTypeof.js","../src/parse/converters/mustache/readDelimiterChange.js","../src/parse/converters/expressions/primary/literal/readRegexpLiteral.js","../src/utils/escapeRegExp.js","../src/parse/converters/utils/getLowestIndex.js","../src/utils/html.js","../src/parse/converters/expressions/shared/errors.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readTemplateStringLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/parse/converters/expressions/primary/readReference.js","../src/parse/converters/expressions/readLogicalOr.js","../src/parse/converters/element/readAttribute.js","../src/parse/converters/readMustache.js","../src/parse/converters/mustache/readAliases.js","../src/parse/converters/mustache/section/readInlineBlock.js","../src/parse/converters/mustache/handlebarsBlockCodes.js","../src/parse/converters/mustache/readSection.js","../src/parse/converters/readHtmlComment.js","../src/parse/utils/stripStandalones.js","../src/parse/utils/cleanup.js","../src/parse/converters/element/readClosingTag.js","../src/parse/converters/readElement.js","../src/parse/converters/readPartialDefinitionSection.js","../src/Ractive/shared.js","../src/parse/_parse.js","../src/Ractive/config/runtime-parser.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/view/resolvers/resolveReference.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/Ractive/prototype/update.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/utils/dom.js","../src/config/namespaces.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/observe/Observer.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/shared/progressiveText.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/items/asyncProxy.js","../src/view/items/Await.js","../src/view/helpers/processItems.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/updateModel.js","../src/Ractive/prototype/use.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/styleGet.js","../src/Ractive/static/sharedSet.js","../src/Ractive/static/sharedGet.js","../src/Ractive/static/use.js","../src/extend/_macro.js","../src/Ractive/static/keypaths.js","../src/Ractive/static/findPlugin.js","../src/polyfills/Object.assign.js","../src/utils/object.js","../src/utils/is.js","../src/polyfills/performance.now.js","../src/polyfills/array.find.js","../src/polyfills/node.contains.js","../src/polyfills/Promise.js","../src/polyfills/requestAnimationFrame.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/config/environment.js","../src/config/errors.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/utils/bind.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/compute.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/view/items/shared/findElement.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/link.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/id.js","../src/Ractive/static/styleSet.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js","../src/utils/hyphenateCamel.js","../src/Ractive/helpers/subscribe.js","../src/utils/noop.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/parse/utils/createFunction.js","../src/parse/converters/expressions/primary/literal/readBooleanLiteral.js","../src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePair.js","../src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePairs.js","../src/parse/converters/expressions/primary/literal/readObjectLiteral.js","../src/parse/converters/expressions/primary/literal/readArrayLiteral.js","../src/parse/converters/expressions/primary/readLiteral.js","../src/parse/converters/expressions/primary/readBracketedExpression.js","../src/parse/converters/expressions/readPrimary.js","../src/parse/converters/expressions/shared/readRefinement.js","../src/parse/converters/expressions/readMemberOrInvocation.js","../src/parse/converters/expressions/readConditional.js","../src/parse/converters/readExpression.js","../src/parse/converters/expressions/shared/readExpressionList.js","../src/parse/converters/readExpressionOrReference.js","../src/parse/utils/flattenExpression.js","../src/parse/utils/refineExpression.js","../src/parse/converters/mustache/readTriple.js","../src/parse/converters/mustache/readUnescaped.js","../src/parse/converters/mustache/readPartial.js","../src/parse/converters/mustache/readMustacheComment.js","../src/parse/converters/mustache/readInterpolator.js","../src/parse/converters/mustache/section/readClosing.js","../src/parse/utils/trimWhitespace.js","../src/parse/converters/readText.js","../src/parse/converters/readTemplate.js","../src/parse/utils/insertExpressions.js","../src/Ractive/helpers/getComputationSignature.js"],"sourcesContent":["import { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectType } from 'utils/is';\nimport { findMap } from 'utils/array';\nimport {\n  toEscapedString,\n  toString,\n  destroyed,\n  shuffled,\n  unbind,\n  unrender,\n  unrenderAndDestroy,\n  update\n} from 'shared/methodCallers';\nimport Fragment from './Fragment';\nimport { ELEMENT } from 'config/types';\nimport { getContext } from 'shared/getRactiveContext';\nimport { keys } from 'utils/object';\nimport KeyModel from 'src/model/specials/KeyModel';\n\nexport default class RepeatedFragment {\n  constructor(options) {\n    this.parent = options.owner.up;\n\n    // bit of a hack, so reference resolution works without another\n    // layer of indirection\n    this.up = this;\n    this.owner = options.owner;\n    this.ractive = this.parent.ractive;\n    this.delegate =\n      this.ractive.delegate !== false && (this.parent.delegate || findDelegate(this.parent));\n    // delegation disabled by directive\n    if (this.delegate && this.delegate.delegate === false) this.delegate = false;\n    // let the element know it's a delegate handler\n    if (this.delegate) this.delegate.delegate = this.delegate;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    this.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n    this.context = null;\n    this.rendered = false;\n    this.iterations = [];\n\n    this.template = options.template;\n\n    this.indexRef = options.indexRef;\n    this.keyRef = options.keyRef;\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n\n    // track array versus object so updates of type rest\n    this.isArray = false;\n  }\n\n  bind(context) {\n    this.context = context;\n    this.bound = true;\n    const value = context.get();\n\n    this.aliases = this.owner.template.z && this.owner.template.z.slice();\n\n    // {{#each array}}...\n    if ((this.isArray = isArray(value))) {\n      // we can't use map, because of sparse arrays\n      this.iterations = [];\n      const max = (this.length = value.length);\n      for (let i = 0; i < max; i += 1) {\n        this.iterations[i] = this.createIteration(i, i);\n      }\n    } else if (isObject(value)) {\n      // {{#each object}}...\n      this.isArray = false;\n\n      // TODO this is a dreadful hack. There must be a neater way\n      if (this.indexRef) {\n        const refs = this.indexRef.split(',');\n        this.keyRef = refs[0];\n        this.indexRef = refs[1];\n      }\n\n      const ks = keys(value);\n      this.length = ks.length;\n\n      this.iterations = ks.map((key, index) => {\n        return this.createIteration(key, index);\n      });\n    }\n\n    return this;\n  }\n\n  bubble(index) {\n    if (!this.bubbled) this.bubbled = [];\n    this.bubbled.push(index);\n\n    this.owner.bubble();\n  }\n\n  createIteration(key, index) {\n    const fragment = new Fragment({\n      owner: this,\n      template: this.template\n    });\n\n    fragment.isIteration = true;\n    fragment.delegate = this.delegate;\n\n    if (this.aliases) fragment.aliases = {};\n    swizzleFragment(this, fragment, key, index);\n\n    return fragment.bind(fragment.context);\n  }\n\n  destroyed() {\n    this.iterations.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    this.iterations.forEach(fragment => docFrag.appendChild(fragment.detach()));\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.iterations, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    return this.iterations.forEach(i => i.findAll(selector, options));\n  }\n\n  findAllComponents(name, options) {\n    return this.iterations.forEach(i => i.findAllComponents(name, options));\n  }\n\n  findComponent(name, options) {\n    return findMap(this.iterations, i => i.findComponent(name, options));\n  }\n\n  findContext() {\n    return this.context;\n  }\n\n  findNextNode(iteration) {\n    if (iteration.index < this.iterations.length - 1) {\n      for (let i = iteration.index + 1; i < this.iterations.length; i++) {\n        const node = this.iterations[i].firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    return this.owner.findNextNode();\n  }\n\n  firstNode(skipParent) {\n    return this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  }\n\n  getLast() {\n    return this.lastModel || (this.lastModel = new KeyModel(this.length - 1));\n  }\n\n  rebind(next) {\n    this.context = next;\n    this.iterations.forEach(fragment => {\n      swizzleFragment(this, fragment, fragment.key, fragment.index);\n    });\n  }\n\n  render(target, occupants) {\n    const xs = this.iterations;\n    if (xs) {\n      const len = xs.length;\n      for (let i = 0; i < len; i++) {\n        xs[i].render(target, occupants);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  shuffle(newIndices, merge) {\n    if (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n    if (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n    this.pendingNewIndices.push(newIndices);\n\n    const iterations = [];\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      if (newIndex === -1) return;\n\n      const fragment = this.iterations[oldIndex];\n      iterations[newIndex] = fragment;\n\n      if (merge) fragment.shouldRebind = 1;\n\n      if (newIndex !== oldIndex && fragment) fragment.dirty = true;\n    });\n\n    this.iterations = iterations;\n\n    this.bubble();\n  }\n\n  shuffled() {\n    this.iterations.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.iterations ? this.iterations.map(escape ? toEscapedString : toString).join('') : '';\n  }\n\n  unbind() {\n    this.bound = false;\n    this.iterations.forEach(unbind);\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.iterations.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    if (this.pendingNewIndices && this.previousIterations) {\n      this.previousIterations.forEach(fragment => {\n        if (fragment.rendered) shouldDestroy ? unrenderAndDestroy(fragment) : unrender(fragment);\n      });\n    }\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.pendingNewIndices) {\n      this.bubbled.length = 0;\n      this.updatePostShuffle();\n      return;\n    }\n\n    if (this.updating) return;\n    this.updating = true;\n\n    this.iterations.forEach((f, i) => f && f.idxModel && f.idxModel.applyValue(i));\n\n    const value = this.context.get();\n    const wasArray = this.isArray;\n\n    let toRemove;\n    let oldKeys;\n    let reset = true;\n    let i;\n\n    if ((this.isArray = isArray(value))) {\n      if (wasArray) {\n        reset = false;\n        if (this.iterations.length > value.length) {\n          toRemove = this.iterations.splice(value.length);\n        }\n      }\n    } else if (isObject(value) && !wasArray) {\n      reset = false;\n      toRemove = [];\n      oldKeys = {};\n      i = this.iterations.length;\n\n      while (i--) {\n        const fragment = this.iterations[i];\n        if (fragment.key in value) {\n          oldKeys[fragment.key] = true;\n        } else {\n          this.iterations.splice(i, 1);\n          toRemove.push(fragment);\n        }\n      }\n    }\n\n    const newLength = isArray(value) ? value.length : isObject(value) ? keys(value).length : 0;\n    this.length = newLength;\n    this.updateLast();\n\n    if (reset) {\n      toRemove = this.iterations;\n      this.iterations = [];\n    }\n\n    if (toRemove) {\n      toRemove.forEach(fragment => {\n        fragment.unbind();\n        fragment.unrender(true);\n      });\n    }\n\n    // update the remaining ones\n    if (!reset && this.isArray && this.bubbled && this.bubbled.length) {\n      const bubbled = this.bubbled;\n      this.bubbled = [];\n      bubbled.forEach(i => this.iterations[i] && this.iterations[i].update());\n    } else {\n      this.iterations.forEach(update);\n    }\n\n    // add new iterations\n    let docFrag;\n    let fragment;\n\n    if (newLength > this.iterations.length) {\n      docFrag = this.rendered ? createDocumentFragment() : null;\n      i = this.iterations.length;\n\n      if (isArray(value)) {\n        while (i < value.length) {\n          fragment = this.createIteration(i, i);\n\n          this.iterations.push(fragment);\n          if (this.rendered) fragment.render(docFrag);\n\n          i += 1;\n        }\n      } else if (isObject(value)) {\n        // TODO this is a dreadful hack. There must be a neater way\n        if (this.indexRef && !this.keyRef) {\n          const refs = this.indexRef.split(',');\n          this.keyRef = refs[0];\n          this.indexRef = refs[1];\n        }\n\n        keys(value).forEach(key => {\n          if (!oldKeys || !(key in oldKeys)) {\n            fragment = this.createIteration(key, i);\n\n            this.iterations.push(fragment);\n            if (this.rendered) fragment.render(docFrag);\n\n            i += 1;\n          }\n        });\n      }\n\n      if (this.rendered) {\n        const parentNode = this.parent.findParentNode();\n        const anchor = this.parent.findNextNode(this.owner);\n\n        parentNode.insertBefore(docFrag, anchor);\n      }\n    }\n\n    this.updating = false;\n  }\n\n  updateLast() {\n    if (this.lastModel) this.lastModel.applyValue(this.length - 1);\n  }\n\n  updatePostShuffle() {\n    const newIndices = this.pendingNewIndices[0];\n    const parentNode = this.rendered ? this.parent.findParentNode() : null;\n    const nextNode = parentNode && this.owner.findNextNode();\n    const docFrag = parentNode ? createDocumentFragment() : null;\n\n    // map first shuffle through\n    this.pendingNewIndices.slice(1).forEach(indices => {\n      newIndices.forEach((newIndex, oldIndex) => {\n        newIndices[oldIndex] = indices[newIndex];\n      });\n    });\n\n    const len = (this.length = this.context.get().length);\n    const prev = this.previousIterations;\n    const iters = this.iterations;\n    const stash = {};\n    let idx, dest, pos, next, anchor;\n\n    const map = new Array(newIndices.length);\n    newIndices.forEach((e, i) => (map[e] = i));\n\n    this.updateLast();\n\n    idx = pos = 0;\n    while (idx < len) {\n      dest = newIndices[pos];\n      next = null;\n\n      if (dest === -1) {\n        // drop it like it's hot\n        prev[pos++].unbind().unrender(true);\n      } else if (dest > idx) {\n        // need to stash or pull one up\n        next = newIndices[pos + 1]; // TODO: maybe a shouldMove function that tracks multiple entries?\n        if (next <= dest) {\n          stash[dest] = prev[pos];\n          prev[pos++] = null;\n        } else {\n          next = stash[idx] || prev[map[idx]];\n          prev[map[idx]] = null;\n          anchor = prev[nextRendered(pos, newIndices, prev)];\n          anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n\n          if (next) {\n            swizzleFragment(this, next, idx, idx);\n            if (parentNode) parentNode.insertBefore(next.detach(), anchor);\n          } else {\n            next = iters[idx] = this.createIteration(idx, idx);\n            if (parentNode) {\n              next.render(docFrag);\n              parentNode.insertBefore(docFrag, anchor);\n            }\n          }\n\n          idx++;\n        }\n      } else {\n        // all is well\n        next = iters[idx];\n        anchor = prev[nextRendered(pos, newIndices, prev)];\n        anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n        if (!next) {\n          next = iters[idx] = this.createIteration(idx, idx);\n          if (parentNode) {\n            next.render(docFrag);\n            parentNode.insertBefore(docFrag, anchor);\n          }\n        } else if (pos !== idx || stash[idx]) {\n          swizzleFragment(this, next, idx, idx);\n          if (stash[idx] && parentNode) parentNode.insertBefore(next.detach(), anchor);\n        }\n\n        idx++;\n        prev[pos++] = null;\n      }\n\n      if (next && isObjectType(next)) {\n        next.update();\n      }\n    }\n\n    // clean up any stragglers\n    prev.forEach(f => f && f.unbind().unrender(true));\n\n    this.pendingNewIndices = null;\n\n    this.shuffled();\n  }\n}\n\nRepeatedFragment.prototype.getContext = getContext;\n\n// find the topmost delegate\nfunction findDelegate(start) {\n  let frag = start;\n  let delegate, el;\n\n  out: while (frag) {\n    // find next element\n    el = 0;\n    while (!el && frag) {\n      if (frag.owner.type === ELEMENT) el = frag.owner;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n\n    if (el.delegate === false) break out;\n    delegate = el.delegate || el;\n\n    // find next repeated fragment\n    while (frag) {\n      if (frag.iterations) break;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n  }\n\n  return delegate;\n}\n\nfunction nextRendered(start, newIndices, frags) {\n  const len = newIndices.length;\n  for (let i = start; i < len; i++) {\n    if (~newIndices[i] && frags[i] && frags[i].rendered) return i;\n  }\n}\n\nfunction swizzleFragment(section, fragment, key, idx) {\n  const model = section.context ? section.context.joinKey(key) : undefined;\n\n  fragment.key = key;\n  fragment.index = idx;\n  fragment.context = model;\n\n  if (fragment.idxModel) fragment.idxModel.applyValue(idx);\n  if (fragment.keyModel) fragment.keyModel.applyValue(key);\n\n  // handle any aliases\n  const aliases = fragment.aliases;\n  section.aliases &&\n    section.aliases.forEach(a => {\n      if (a.x.r === '.') aliases[a.n] = model;\n      else if (a.x.r === '@index') aliases[a.n] = fragment.getIndex();\n      else if (a.x.r === '@key') aliases[a.n] = fragment.getKey();\n      else if (a.x.r === '@keypath') aliases[a.n] = fragment.getKeypath();\n      else if (a.x.r === '@rootpath') aliases[a.n] = fragment.getKeypath(true);\n    });\n}\n","import {\n  SECTION_EACH,\n  SECTION_IF,\n  SECTION_IF_WITH,\n  SECTION_UNLESS,\n  SECTION_WITH\n} from 'config/types';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectLike } from 'utils/is';\nimport { keep } from 'shared/set';\nimport runloop from 'src/global/runloop';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keys } from 'utils/object';\n\nfunction isEmpty(value) {\n  return (\n    !value ||\n    (isArray(value) && value.length === 0) ||\n    (isObject(value) && keys(value).length === 0)\n  );\n}\n\nfunction getType(value, hasIndexRef) {\n  if (hasIndexRef || isArray(value)) return SECTION_EACH;\n  if (isObjectLike(value)) return SECTION_IF_WITH;\n  if (value === undefined) return null;\n  return SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n  constructor(options) {\n    super(options);\n\n    this.sectionType = options.template.n || null;\n    this.templateSectionType = this.sectionType;\n    this.subordinate = options.template.l === 1;\n    this.fragment = null;\n  }\n\n  bind() {\n    super.bind();\n\n    if (this.subordinate) {\n      this.sibling = this.up.items[this.up.items.indexOf(this) - 1];\n      this.sibling.nextSibling = this;\n    }\n\n    // if we managed to bind, we need to create children\n    if (this.model) {\n      this.dirty = true;\n      this.update();\n    } else if (\n      this.sectionType &&\n      this.sectionType === SECTION_UNLESS &&\n      (!this.sibling || !this.sibling.isTruthy())\n    ) {\n      this.fragment = new Fragment({\n        owner: this,\n        template: this.template.f\n      }).bind();\n    }\n  }\n\n  detach() {\n    const frag = this.fragment || this.detached;\n    return frag ? frag.detach() : super.detach();\n  }\n\n  isTruthy() {\n    if (this.subordinate && this.sibling.isTruthy()) return true;\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    return !!value && (this.templateSectionType === SECTION_IF_WITH || !isEmpty(value));\n  }\n\n  rebind(next, previous, safe) {\n    if (super.rebind(next, previous, safe)) {\n      if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n        this.fragment.rebind(next);\n      }\n    }\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  shuffle(newIndices) {\n    if (this.fragment && this.sectionType === SECTION_EACH) {\n      this.fragment.shuffle(newIndices);\n    }\n  }\n\n  unbind() {\n    super.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (!this.dirty) return;\n\n    if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n      this.fragment.context = this.model;\n    }\n\n    if (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n    this.dirty = false;\n\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    const siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n    const lastType = this.sectionType;\n\n    // watch for switching section types\n    if (this.sectionType === null || this.templateSectionType === null)\n      this.sectionType = getType(value, this.template.i);\n    if (lastType && lastType !== this.sectionType && this.fragment) {\n      if (this.rendered) {\n        this.fragment.unbind().unrender(true);\n      }\n\n      this.fragment = null;\n    }\n\n    let newFragment;\n\n    const fragmentShouldExist =\n      this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n      this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n      (siblingFalsey && (this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy())); // if, unless, and if-with depend on siblings and the condition\n\n    if (fragmentShouldExist) {\n      if (!this.fragment) this.fragment = this.detached;\n\n      if (this.fragment) {\n        // check for detached fragment\n        if (this.detached) {\n          attach(this, this.fragment);\n          this.detached = false;\n          this.rendered = true;\n        }\n\n        if (!this.fragment.bound) this.fragment.bind(this.model);\n        this.fragment.update();\n      } else {\n        if (this.sectionType === SECTION_EACH) {\n          newFragment = new RepeatedFragment({\n            owner: this,\n            template: this.template.f,\n            indexRef: this.template.i\n          }).bind(this.model);\n        } else {\n          // only with and if-with provide context - if and unless do not\n          const context =\n            this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS\n              ? this.model\n              : null;\n          newFragment = new Fragment({\n            owner: this,\n            template: this.template.f\n          }).bind(context);\n        }\n      }\n    } else {\n      if (this.fragment && this.rendered) {\n        if (keep !== true) {\n          this.fragment.unbind().unrender(true);\n        } else {\n          this.unrender(false);\n          this.detached = this.fragment;\n          runloop.promise().then(() => {\n            if (this.detached) this.detach();\n          });\n        }\n      } else if (this.fragment) {\n        this.fragment.unbind();\n      }\n\n      this.fragment = null;\n    }\n\n    if (newFragment) {\n      if (this.rendered) {\n        attach(this, newFragment);\n      }\n\n      this.fragment = newFragment;\n    }\n\n    if (this.nextSibling) {\n      this.nextSibling.dirty = true;\n      this.nextSibling.update();\n    }\n  }\n}\n\nfunction attach(section, fragment) {\n  const anchor = section.up.findNextNode(section);\n\n  if (anchor) {\n    const docFrag = createDocumentFragment();\n    fragment.render(docFrag);\n\n    anchor.parentNode.insertBefore(docFrag, anchor);\n  } else {\n    fragment.render(section.up.findParentNode());\n  }\n}\n","import { toArray } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Element from '../../Element';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default class Select extends Element {\n  constructor(options) {\n    super(options);\n    this.options = [];\n  }\n\n  foundNode(node) {\n    if (this.binding) {\n      const selectedOptions = getSelectedOptions(node);\n\n      if (selectedOptions.length > 0) {\n        this.selectedOptions = selectedOptions;\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.sync();\n\n    const node = this.node;\n\n    let i = node.options.length;\n    while (i--) {\n      node.options[i].defaultSelected = node.options[i].selected;\n    }\n\n    this.rendered = true;\n  }\n\n  sync() {\n    const selectNode = this.node;\n\n    if (!selectNode) return;\n\n    const options = toArray(selectNode.options);\n\n    if (this.selectedOptions) {\n      options.forEach(o => {\n        if (this.selectedOptions.indexOf(o) >= 0) o.selected = true;\n        else o.selected = false;\n      });\n      this.binding.setFromNode(selectNode);\n      delete this.selectedOptions;\n      return;\n    }\n\n    const selectValue = this.getAttribute('value');\n    const isMultiple = this.getAttribute('multiple');\n    const array = isMultiple && isArray(selectValue);\n\n    // If the <select> has a specified value, that should override\n    // these options\n    if (selectValue !== undefined) {\n      let optionWasSelected;\n\n      options.forEach(o => {\n        const optionValue = o._ractive ? o._ractive.value : o.value;\n        const shouldSelect = isMultiple\n          ? array && this.valueContains(selectValue, optionValue)\n          : this.compare(selectValue, optionValue);\n\n        if (shouldSelect) {\n          optionWasSelected = true;\n        }\n\n        o.selected = shouldSelect;\n      });\n\n      if (!optionWasSelected && !isMultiple) {\n        if (this.binding) {\n          this.binding.forceUpdate();\n        }\n      }\n    } else if (this.binding && this.binding.forceUpdate) {\n      // Otherwise the value should be initialised according to which\n      // <option> element is selected, if twoway binding is in effect\n      this.binding.forceUpdate();\n    }\n  }\n  valueContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.compare(optionValue, selectValue[i])) return true;\n    }\n  }\n  compare(optionValue, selectValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(selectValue, optionValue);\n      }\n      if (selectValue && optionValue) {\n        return selectValue[comparator] == optionValue[comparator];\n      }\n    }\n    return selectValue == optionValue;\n  }\n  update() {\n    const dirty = this.dirty;\n    super.update();\n    if (dirty) {\n      this.sync();\n    }\n  }\n}\n","import { ATTRIBUTE } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n  constructor(options) {\n    const template = options.template;\n\n    options.deferContent = true;\n\n    super(options);\n\n    // check for single interpolator binding\n    if (!this.attributeByName.value) {\n      if (template.f && isBindable({ template })) {\n        (this.attributes || (this.attributes = [])).push(\n          createItem({\n            owner: this,\n            template: { t: ATTRIBUTE, f: template.f, n: 'value' },\n            up: this.up\n          })\n        );\n      } else {\n        this.fragment = new Fragment({\n          owner: this,\n          cssIds: null,\n          template: template.f\n        });\n      }\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.rendered && !this.binding && this.fragment) {\n        runloop.scheduleTask(() => {\n          this.dirty = false;\n          this.node.value = this.fragment.toString();\n        });\n      }\n\n      this.up.bubble(); // default behaviour\n    }\n  }\n}\n","import { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport { detachNode } from 'utils/dom';\nimport noop from 'utils/noop';\nimport Item from './shared/Item';\nimport progressiveText from './shared/progressiveText';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Text extends Item {\n  constructor(options) {\n    super(options);\n    this.type = TEXT;\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, this.template);\n  }\n\n  toString(escape) {\n    return escape ? escapeHtml(this.template) : this.template;\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  valueOf() {\n    return this.template;\n  }\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif (doc) {\n  let prefix;\n\n  /* istanbul ignore next */\n  if (hidden in doc) {\n    prefix = '';\n  } else {\n    let i = vendors.length;\n    while (i--) {\n      const vendor = vendors[i];\n      hidden = vendor + 'Hidden';\n\n      if (hidden in doc) {\n        prefix = vendor;\n        break;\n      }\n    }\n  }\n\n  /* istanbul ignore else */\n  if (prefix !== undefined) {\n    doc.addEventListener(prefix + 'visibilitychange', onChange);\n    onChange();\n  } else {\n    // gah, we're in an old browser\n    if ('onfocusout' in doc) {\n      doc.addEventListener('focusout', onHide);\n      doc.addEventListener('focusin', onShow);\n    } else {\n      win.addEventListener('pagehide', onHide);\n      win.addEventListener('blur', onHide);\n\n      win.addEventListener('pageshow', onShow);\n      win.addEventListener('focus', onShow);\n    }\n\n    visible = true; // until proven otherwise. Not ideal but hey\n  }\n}\n\nfunction onChange() {\n  visible = !doc[hidden];\n}\n\n/* istanbul ignore next */\nfunction onHide() {\n  visible = false;\n}\n\n/* istanbul ignore next */\nfunction onShow() {\n  visible = true;\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport hyphenateCamel from 'utils/hyphenateCamel';\n\nlet prefix;\n\n/* istanbul ignore next */\nif (!isClient) {\n  prefix = null;\n} else {\n  const prefixCache = {};\n  const testStyle = createElement('div').style;\n\n  // technically this also normalizes on hyphenated styles as well\n  prefix = function(prop) {\n    if (!prefixCache[prop]) {\n      const name = hyphenateCamel(prop);\n\n      if (testStyle[prop] !== undefined) {\n        prefixCache[prop] = name;\n      } else {\n        /* istanbul ignore next */\n        // test vendors...\n        let i = vendors.length;\n        while (i--) {\n          const vendor = `-${vendors[i]}-${name}`;\n          if (testStyle[vendor] !== undefined) {\n            prefixCache[prop] = vendor;\n            break;\n          }\n        }\n      }\n    }\n\n    return prefixCache[prop];\n  };\n}\n\nexport default prefix;\n","import { missingPlugin } from 'config/errors';\nimport { isClient } from 'config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport hyphenate from './hyphenate';\nimport { isFunction, isString } from 'utils/is';\n\nlet createTransitions;\n\nif (!isClient) {\n  createTransitions = null;\n} else {\n  const testStyle = createElement('div').style;\n  const linear = x => x;\n\n  const canUseCssTransitions = {};\n  const cannotUseCssTransitions = {};\n\n  // determine some facts about our environment\n  let TRANSITION;\n  let TRANSITIONEND;\n  let CSS_TRANSITIONS_ENABLED;\n  let TRANSITION_DURATION;\n  let TRANSITION_PROPERTY;\n  let TRANSITION_TIMING_FUNCTION;\n\n  if (testStyle.transition !== undefined) {\n    TRANSITION = 'transition';\n    TRANSITIONEND = 'transitionend';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else if (testStyle.webkitTransition !== undefined) {\n    TRANSITION = 'webkitTransition';\n    TRANSITIONEND = 'webkitTransitionEnd';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else {\n    CSS_TRANSITIONS_ENABLED = false;\n  }\n\n  if (TRANSITION) {\n    TRANSITION_DURATION = TRANSITION + 'Duration';\n    TRANSITION_PROPERTY = TRANSITION + 'Property';\n    TRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  }\n\n  createTransitions = function(t, to, options, changedProperties, resolve) {\n    // Wait a beat (otherwise the target styles will be applied immediately)\n    // TODO use a fastdom-style mechanism?\n    setTimeout(() => {\n      let jsTransitionsComplete;\n      let cssTransitionsComplete;\n      let cssTimeout; // eslint-disable-line prefer-const\n\n      function transitionDone() {\n        clearTimeout(cssTimeout);\n      }\n\n      function checkComplete() {\n        if (jsTransitionsComplete && cssTransitionsComplete) {\n          t.unregisterCompleteHandler(transitionDone);\n          // will changes to events and fire have an unexpected consequence here?\n          t.ractive.fire(t.name + ':end', t.node, t.isIntro);\n          resolve();\n        }\n      }\n\n      // this is used to keep track of which elements can use CSS to animate\n      // which properties\n      const hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n      // need to reset transition properties\n      const style = t.node.style;\n      const previous = {\n        property: style[TRANSITION_PROPERTY],\n        timing: style[TRANSITION_TIMING_FUNCTION],\n        duration: style[TRANSITION_DURATION]\n      };\n\n      function transitionEndHandler(event) {\n        const index = changedProperties.indexOf(event.propertyName);\n\n        if (index !== -1) {\n          changedProperties.splice(index, 1);\n        }\n\n        if (changedProperties.length) {\n          // still transitioning...\n          return;\n        }\n\n        clearTimeout(cssTimeout);\n        cssTransitionsDone();\n      }\n\n      function cssTransitionsDone() {\n        style[TRANSITION_PROPERTY] = previous.property;\n        style[TRANSITION_TIMING_FUNCTION] = previous.duration;\n        style[TRANSITION_DURATION] = previous.timing;\n\n        t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n        cssTransitionsComplete = true;\n        checkComplete();\n      }\n\n      t.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n      // safety net in case transitionend never fires\n      cssTimeout = setTimeout(() => {\n        changedProperties = [];\n        cssTransitionsDone();\n      }, options.duration + (options.delay || 0) + 50);\n      t.registerCompleteHandler(transitionDone);\n\n      style[TRANSITION_PROPERTY] = changedProperties.join(',');\n      const easingName = hyphenate(options.easing || 'linear');\n      style[TRANSITION_TIMING_FUNCTION] = easingName;\n      const cssTiming = style[TRANSITION_TIMING_FUNCTION] === easingName;\n      style[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n      setTimeout(() => {\n        let i = changedProperties.length;\n        let hash;\n        let originalValue = null;\n        let index;\n        const propertiesToTransitionInJs = [];\n        let prop;\n        let suffix;\n        let interpolator;\n\n        while (i--) {\n          prop = changedProperties[i];\n          hash = hashPrefix + prop;\n\n          if (cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n            const initial = style[prop];\n            style[prop] = to[prop];\n\n            // If we're not sure if CSS transitions are supported for\n            // this tag/property combo, find out now\n            if (!(hash in canUseCssTransitions)) {\n              originalValue = t.getStyle(prop);\n\n              // if this property is transitionable in this browser,\n              // the current style will be different from the target style\n              canUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n              cannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n              // Reset, if we're going to use timers after all\n              if (cannotUseCssTransitions[hash]) {\n                style[prop] = initial;\n              }\n            }\n          }\n\n          if (!cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n            // we need to fall back to timer-based stuff\n            if (originalValue === null) originalValue = t.getStyle(prop);\n\n            // need to remove this from changedProperties, otherwise transitionEndHandler\n            // will get confused\n            index = changedProperties.indexOf(prop);\n            if (index === -1) {\n              warnIfDebug(\n                'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!',\n                { node: t.node }\n              );\n            } else {\n              changedProperties.splice(index, 1);\n            }\n\n            // TODO Determine whether this property is animatable at all\n\n            suffix = /[^\\d]*$/.exec(originalValue)[0];\n            interpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop]));\n\n            // ...then kick off a timer-based transition\n            if (interpolator) {\n              propertiesToTransitionInJs.push({\n                name: prop,\n                interpolator,\n                suffix\n              });\n            } else {\n              style[prop] = to[prop];\n            }\n\n            originalValue = null;\n          }\n        }\n\n        // javascript transitions\n        if (propertiesToTransitionInJs.length) {\n          let easing;\n\n          if (isString(options.easing)) {\n            easing = t.ractive.easing[options.easing];\n\n            if (!easing) {\n              warnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n              easing = linear;\n            }\n          } else if (isFunction(options.easing)) {\n            easing = options.easing;\n          } else {\n            easing = linear;\n          }\n\n          new Ticker({\n            duration: options.duration,\n            easing,\n            step(pos) {\n              let i = propertiesToTransitionInJs.length;\n              while (i--) {\n                const prop = propertiesToTransitionInJs[i];\n                style[prop.name] = prop.interpolator(pos) + prop.suffix;\n              }\n            },\n            complete() {\n              jsTransitionsComplete = true;\n              checkComplete();\n            }\n          });\n        } else {\n          jsTransitionsComplete = true;\n        }\n\n        if (changedProperties.length) {\n          style[TRANSITION_PROPERTY] = changedProperties.join(',');\n        } else {\n          style[TRANSITION_PROPERTY] = 'none';\n\n          // We need to cancel the transitionEndHandler, and deal with\n          // the fact that it will never fire\n          t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n          cssTransitionsComplete = true;\n          checkComplete();\n        }\n      }, 0);\n    }, options.delay || 0);\n  };\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nconst vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\nexport default function(str) {\n  /* istanbul ignore next */\n  if (!str) return ''; // edge case\n\n  /* istanbul ignore next */\n  if (vendorPattern.test(str)) str = '-' + str;\n\n  return str.replace(/[A-Z]/g, match => '-' + match.toLowerCase());\n}\n","import { win } from 'config/environment';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction, isNumber, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { assign, hasOwn, keys } from 'utils/object';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n  t0: 'intro-outro',\n  t1: 'intro',\n  t2: 'outro'\n};\n\nexport default class Transition {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.ractive = this.owner.ractive;\n    this.template = options.template;\n    this.up = options.up;\n    this.options = options;\n    this.onComplete = [];\n  }\n\n  animateStyle(style, value, options) {\n    if (arguments.length === 4) {\n      throw new Error(\n        't.animateStyle() returns a promise - use .then() instead of passing a callback'\n      );\n    }\n\n    // Special case - page isn't visible. Don't animate anything, because\n    // that way you'll never get CSS transitionend events\n    if (!visible) {\n      this.setStyle(style, value);\n      return resolved;\n    }\n\n    let to;\n\n    if (isString(style)) {\n      to = {};\n      to[style] = value;\n    } else {\n      to = style;\n\n      // shuffle arguments\n      options = value;\n    }\n\n    return new Promise(fulfil => {\n      // Edge case - if duration is zero, set style synchronously and complete\n      if (!options.duration) {\n        this.setStyle(to);\n        fulfil();\n        return;\n      }\n\n      // Get a list of the properties we're animating\n      const propertyNames = keys(to);\n      const changedProperties = [];\n\n      // Store the current styles\n      const computedStyle = getComputedStyle(this.node);\n\n      let i = propertyNames.length;\n      while (i--) {\n        const prop = propertyNames[i];\n        const name = prefix(prop);\n\n        const current = computedStyle[prefix(prop)];\n\n        // record the starting points\n        const init = this.node.style[name];\n        if (!(name in this.originals)) this.originals[name] = this.node.style[name];\n        this.node.style[name] = to[prop];\n        this.targets[name] = this.node.style[name];\n        this.node.style[name] = init;\n\n        // we need to know if we're actually changing anything\n        if (current != to[prop]) {\n          // use != instead of !==, so we can compare strings with numbers\n          changedProperties.push(name);\n\n          // if we happened to prefix, make sure there is a properly prefixed value\n          to[name] = to[prop];\n\n          // make the computed style explicit, so we can animate where\n          // e.g. height='auto'\n          this.node.style[name] = current;\n        }\n      }\n\n      // If we're not actually changing anything, the transitionend event\n      // will never fire! So we complete early\n      if (!changedProperties.length) {\n        fulfil();\n        return;\n      }\n\n      createTransitions(this, to, options, changedProperties, fulfil);\n    });\n  }\n\n  bind() {\n    const options = this.options;\n    const type = options.template && options.template.v;\n    if (type) {\n      if (type === 't0' || type === 't1') this.element.intro = this;\n      if (type === 't0' || type === 't2') this.element.outro = this;\n      this.eventName = names[type];\n    }\n\n    const ractive = this.owner.ractive;\n\n    this.name = options.name || options.template.n;\n\n    if (options.params) {\n      this.params = options.params;\n    }\n\n    if (isFunction(this.name)) {\n      this._fn = this.name;\n      this.name = this._fn.name;\n    } else {\n      this._fn = findInViewHierarchy('transitions', ractive, this.name);\n    }\n\n    if (!this._fn) {\n      warnOnceIfDebug(missingPlugin(this.name, 'transition'), { ractive });\n    }\n\n    setupArgsFn(this, options.template);\n  }\n\n  getParams() {\n    if (this.params) return this.params;\n\n    // get expression args if supplied\n    if (this.fn) {\n      const values = resolveArgs(this, this.template, this.up).map(model => {\n        if (!model) return undefined;\n\n        return model.get();\n      });\n      return this.fn.apply(this.ractive, values);\n    }\n  }\n\n  getStyle(props) {\n    const computedStyle = getComputedStyle(this.node);\n\n    if (isString(props)) {\n      return computedStyle[prefix(props)];\n    }\n\n    if (!isArray(props)) {\n      throw new Error(\n        'Transition$getStyle must be passed a string, or an array of strings representing CSS properties'\n      );\n    }\n\n    const styles = {};\n\n    let i = props.length;\n    while (i--) {\n      const prop = props[i];\n      let value = computedStyle[prefix(prop)];\n\n      if (value === '0px') value = 0;\n      styles[prop] = value;\n    }\n\n    return styles;\n  }\n\n  processParams(params, defaults) {\n    if (isNumber(params)) {\n      params = { duration: params };\n    } else if (isString(params)) {\n      if (params === 'slow') {\n        params = { duration: 600 };\n      } else if (params === 'fast') {\n        params = { duration: 200 };\n      } else {\n        params = { duration: 400 };\n      }\n    } else if (!params) {\n      params = {};\n    }\n\n    return assign({}, defaults, params);\n  }\n\n  registerCompleteHandler(fn) {\n    addToArray(this.onComplete, fn);\n  }\n\n  setStyle(style, value) {\n    if (isString(style)) {\n      const name = prefix(style);\n      if (!hasOwn(this.originals, name)) this.originals[name] = this.node.style[name];\n      this.node.style[name] = value;\n      this.targets[name] = this.node.style[name];\n    } else {\n      let prop;\n      for (prop in style) {\n        if (hasOwn(style, prop)) {\n          this.setStyle(prop, style[prop]);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  shouldFire(type) {\n    if (!this.ractive.transitionsEnabled) return false;\n\n    // check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n    if (type === 'intro' && this.ractive.rendering && nearestProp('noIntro', this.ractive, true))\n      return false;\n    if (type === 'outro' && this.ractive.unrendering && nearestProp('noOutro', this.ractive, false))\n      return false;\n\n    const params = this.getParams(); // this is an array, the params object should be the first member\n    // if there's not a parent element, this can't be nested, so roll on\n    if (!this.element.parent) return true;\n\n    // if there is a local param, it takes precedent\n    if (params && params[0] && isObject(params[0]) && 'nested' in params[0]) {\n      if (params[0].nested !== false) return true;\n    } else {\n      // use the nearest instance setting\n      // find the nearest instance that actually has a nested setting\n      if (nearestProp('nestedTransitions', this.ractive) !== false) return true;\n    }\n\n    // check to see if this is actually a nested transition\n    let el = this.element.parent;\n    while (el) {\n      if (el[type] && el[type].starting) return false;\n      el = el.parent;\n    }\n\n    return true;\n  }\n\n  start() {\n    const node = (this.node = this.element.node);\n    const originals = (this.originals = {}); //= node.getAttribute( 'style' );\n    const targets = (this.targets = {});\n\n    let completed;\n    const args = this.getParams();\n\n    // create t.complete() - we don't want this on the prototype,\n    // because we don't want `this` silliness when passing it as\n    // an argument\n    this.complete = noReset => {\n      this.starting = false;\n      if (completed) {\n        return;\n      }\n\n      this.onComplete.forEach(fn => fn());\n      if (!noReset && this.isIntro) {\n        for (const k in targets) {\n          if (node.style[k] === targets[k]) node.style[k] = originals[k];\n        }\n      }\n\n      this._manager.remove(this);\n\n      completed = true;\n    };\n\n    // If the transition function doesn't exist, abort\n    if (!this._fn) {\n      this.complete();\n      return;\n    }\n\n    const promise = this._fn.apply(this.ractive, [this].concat(args));\n    if (promise) promise.then(this.complete);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (!this.element.attributes.unbinding) {\n      const type = this.options && this.options.template && this.options.template.v;\n      if (type === 't0' || type === 't1') this.element.intro = null;\n      if (type === 't0' || type === 't2') this.element.outro = null;\n    }\n  }\n\n  unregisterCompleteHandler(fn) {\n    removeFromArray(this.onComplete, fn);\n  }\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp(prop, ractive, rendering) {\n  let instance = ractive;\n  while (instance) {\n    if (\n      hasOwn(instance, prop) &&\n      (rendering === undefined || rendering ? instance.rendering : instance.unrendering)\n    )\n      return instance[prop];\n    instance = instance.component && instance.component.ractive;\n  }\n\n  return ractive[prop];\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n  createElement('table').innerHTML = 'foo';\n} catch (/* istanbul ignore next */ err) {\n  ieBug = true;\n\n  ieBlacklist = {\n    TABLE: ['<table class=\"x\">', '</table>'],\n    THEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n    TBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n    TR: ['<table><tr class=\"x\">', '</tr></table>'],\n    SELECT: ['<select class=\"x\">', '</select>']\n  };\n}\n\nexport default function(html, node) {\n  const nodes = [];\n\n  // render 0 and false\n  if (html == null || html === '') return nodes;\n\n  let container;\n  let wrapper;\n  let selectedOption;\n\n  /* istanbul ignore if */\n  if (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n    container = element('DIV');\n    container.innerHTML = wrapper[0] + html + wrapper[1];\n    container = container.querySelector('.x');\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  } else if (node.namespaceURI === svg) {\n    container = element('DIV');\n    container.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n    container = container.querySelector('.x');\n  } else if (node.tagName === 'TEXTAREA') {\n    container = createElement('div');\n\n    if (typeof container.textContent !== 'undefined') {\n      container.textContent = html;\n    } else {\n      container.innerHTML = html;\n    }\n  } else {\n    container = element(node.tagName);\n    container.innerHTML = html;\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  }\n\n  let child;\n  while ((child = container.firstChild)) {\n    nodes.push(child);\n    container.removeChild(child);\n  }\n\n  // This is really annoying. Extracting <option> nodes from the\n  // temporary container <select> causes the remaining ones to\n  // become selected. So now we have to deselect them. IE8, you\n  // amaze me. You really do\n  // ...and now Chrome too\n  let i;\n  if (node.tagName === 'SELECT') {\n    i = nodes.length;\n    while (i--) {\n      if (nodes[i] !== selectedOption) {\n        nodes[i].selected = false;\n      }\n    }\n  }\n\n  return nodes;\n}\n\nfunction element(tagName) {\n  return elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n}\n","import { createDocumentFragment, matches } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport { decodeCharacterReferences } from 'utils/html';\nimport runloop from 'src/global/runloop';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    if (this.nodes) this.nodes.forEach(node => docFrag.appendChild(node));\n    return docFrag;\n  }\n\n  find(selector) {\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) return node;\n\n      const queryResult = node.querySelector(selector);\n      if (queryResult) return queryResult;\n    }\n\n    return null;\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) result.push(node);\n\n      const queryAllResult = node.querySelectorAll(selector);\n      if (queryAllResult) {\n        result.push.apply(result, queryAllResult);\n      }\n    }\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  firstNode() {\n    return this.rendered && this.nodes[0];\n  }\n\n  render(target, occupants, anchor) {\n    if (!this.nodes) {\n      const html = this.model ? this.model.get() : '';\n      this.nodes = insertHtml(html, target);\n    }\n\n    let nodes = this.nodes;\n\n    // progressive enhancement\n    if (occupants) {\n      let i = -1;\n      let next;\n\n      // start with the first node that should be rendered\n      while (occupants.length && (next = this.nodes[i + 1])) {\n        let n;\n        // look through the occupants until a matching node is found\n        while ((n = occupants.shift())) {\n          const t = n.nodeType;\n\n          if (\n            t === next.nodeType &&\n            ((t === 1 && n.outerHTML === next.outerHTML) ||\n              ((t === 3 || t === 8) && n.nodeValue === next.nodeValue))\n          ) {\n            this.nodes.splice(++i, 1, n); // replace the generated node with the existing one\n            break;\n          } else {\n            target.removeChild(n); // remove the non-matching existing node\n          }\n        }\n      }\n\n      if (i >= 0) {\n        // update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n        nodes = this.nodes.slice(i);\n      }\n\n      // update the anchor to be the next occupant\n      if (occupants.length) anchor = occupants[0];\n    }\n\n    // attach any remainging nodes to the parent\n    if (nodes.length) {\n      const frag = createDocumentFragment();\n      nodes.forEach(n => frag.appendChild(n));\n\n      if (anchor) {\n        target.insertBefore(frag, anchor);\n      } else {\n        target.appendChild(frag);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    let value = this.model && this.model.get();\n    value = value != null ? '' + value : '';\n\n    return inAttribute() ? decodeCharacterReferences(value) : value;\n  }\n\n  unrender() {\n    if (this.nodes)\n      this.nodes.forEach(node => {\n        // defer detachment until all relevant outros are done\n        runloop.detachWhenReady({\n          node,\n          detach() {\n            detachNode(node);\n          }\n        });\n      });\n    this.rendered = false;\n    this.nodes = null;\n  }\n\n  update() {\n    if (this.rendered && this.dirty) {\n      this.dirty = false;\n\n      this.unrender();\n      this.render(this.up.findParentNode(), null, this.up.findNextNode(this));\n    } else {\n      // make sure to reset the dirty flag even if not rendered\n      this.dirty = false;\n    }\n  }\n}\n","import {\n  ALIAS,\n  ANCHOR,\n  AWAIT,\n  COMMENT,\n  COMPONENT,\n  DOCTYPE,\n  ELEMENT,\n  INTERPOLATOR,\n  PARTIAL,\n  SECTION,\n  TRIPLE,\n  YIELDER\n} from 'config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from 'config/types';\nimport Alias from './Alias';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Comment from './Comment';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\nimport { findInstance } from 'shared/registry';\nimport asyncProxy from './asyncProxy';\nimport Await from './Await';\nimport { isString, isFunction } from 'utils/is';\n\nconst constructors = {};\nconstructors[ALIAS] = Alias;\nconstructors[ANCHOR] = Component;\nconstructors[AWAIT] = Await;\nconstructors[DOCTYPE] = Doctype;\nconstructors[INTERPOLATOR] = Interpolator;\nconstructors[PARTIAL] = Partial;\nconstructors[SECTION] = Section;\nconstructors[TRIPLE] = Triple;\nconstructors[YIELDER] = Partial;\n\nconstructors[ATTRIBUTE] = Attribute;\nconstructors[BINDING_FLAG] = BindingFlag;\nconstructors[DECORATOR] = Decorator;\nconstructors[EVENT] = EventDirective;\nconstructors[TRANSITION] = Transition;\nconstructors[COMMENT] = Comment;\n\nconst specialElements = {\n  doctype: Doctype,\n  form: Form,\n  input: Input,\n  option: Option,\n  select: Select,\n  textarea: Textarea\n};\n\nexport default function createItem(options) {\n  if (isString(options.template)) {\n    return new Text(options);\n  }\n\n  let ctor;\n  let name;\n  const type = options.template.t;\n\n  if (type === ELEMENT) {\n    name = options.template.e;\n\n    // could be a macro partial\n    ctor = findInstance('partials', options.up.ractive, name);\n    if (ctor) {\n      ctor = ctor.partials[name];\n      if (ctor.styleSet) {\n        options.macro = ctor;\n        return new Partial(options);\n      }\n    }\n\n    // could be component or element\n    ctor = getComponentConstructor(options.up.ractive, name);\n    if (ctor) {\n      if (isFunction(ctor.then)) {\n        return asyncProxy(ctor, options);\n      } else {\n        return new Component(options, ctor);\n      }\n    }\n\n    ctor = specialElements[name.toLowerCase()] || Element;\n    return new ctor(options);\n  }\n\n  let Item;\n\n  // component mappings are a special case of attribute\n  if (type === ATTRIBUTE) {\n    let el = options.owner;\n    if (!el || (el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT)) {\n      el = findElement(options.up);\n    }\n    options.element = el;\n\n    Item = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n  } else {\n    Item = constructors[type];\n  }\n\n  if (!Item) throw new Error(`Unrecognised item type ${type}`);\n\n  return new Item(options);\n}\n","import { ELEMENT, YIELDER } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport { findMap } from 'utils/array';\nimport { getContext, findParentWithContext } from 'shared/getRactiveContext';\nimport {\n  bind,\n  destroyed,\n  shuffled,\n  toEscapedString,\n  toString,\n  unbind,\n  unrender,\n  update\n} from 'shared/methodCallers';\nimport createItem from './items/createItem';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\nimport KeyModel from 'src/model/specials/KeyModel';\n\nfunction unrenderAndDestroy(item) {\n  item.unrender(true);\n}\n\nexport default class Fragment {\n  constructor(options) {\n    this.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n    this.isRoot = !options.owner.up;\n    this.parent = this.isRoot ? null : this.owner.up;\n    this.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n    this.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.up : null;\n    if (!this.isRoot || this.ractive.delegate) {\n      this.delegate = this.owner.containerFragment\n        ? this.owner.containerFragment && this.owner.containerFragment.delegate\n        : (this.componentParent && this.componentParent.delegate) ||\n          (this.parent && this.parent.delegate);\n    } else {\n      this.delegate = false;\n    }\n\n    this.context = null;\n    this.rendered = false;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    if ('cssIds' in options) {\n      this.cssIds = options.cssIds && options.cssIds.length && options.cssIds;\n    } else {\n      this.cssIds = this.parent ? this.parent.cssIds : null;\n    }\n\n    this.dirty = false;\n    this.dirtyValue = true; // used for attribute values\n\n    this.template = options.template || [];\n    this.createItems();\n  }\n\n  bind(context) {\n    this.context = context;\n    this.items.forEach(bind);\n    this.bound = true;\n\n    // in rare cases, a forced resolution (or similar) will cause the\n    // fragment to be dirty before it's even finished binding. In those\n    // cases we update immediately\n    if (this.dirty) this.update();\n\n    return this;\n  }\n\n  bubble() {\n    this.dirtyValue = true;\n\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.isRoot) {\n        // TODO encapsulate 'is component root, but not overall root' check?\n        if (this.ractive.component) {\n          this.ractive.component.bubble();\n        } else if (this.bound) {\n          runloop.addFragment(this);\n        }\n      } else {\n        this.owner.bubble(this.index);\n      }\n    }\n  }\n\n  createItems() {\n    // this is a hot code path\n    const max = this.template.length;\n    this.items = [];\n    for (let i = 0; i < max; i++) {\n      this.items[i] = createItem({\n        up: this,\n        template: this.template[i],\n        index: i\n      });\n    }\n  }\n\n  destroyed() {\n    this.items.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      docFrag.appendChild(xs[i].detach());\n    }\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.items, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAll && i.findAll(selector, options));\n    }\n  }\n\n  findComponent(name, options) {\n    return findMap(this.items, i => i.findComponent(name, options));\n  }\n\n  findAllComponents(name, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAllComponents && i.findAllComponents(name, options));\n    }\n  }\n\n  findContext() {\n    const base = findParentWithContext(this);\n    if (!base || !base.context) return this.ractive.viewmodel;\n    else return base.context;\n  }\n\n  findNextNode(item) {\n    // search for the next node going forward\n    if (item) {\n      let it;\n      for (let i = item.index + 1; i < this.items.length; i++) {\n        it = this.items[i];\n        if (!it || !it.firstNode) continue;\n\n        const node = it.firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    // if this is the root fragment, and there are no more items,\n    // it means we're at the end...\n    if (this.isRoot) {\n      if (this.ractive.component) {\n        return this.ractive.component.up.findNextNode(this.ractive.component);\n      }\n\n      // TODO possible edge case with other content\n      // appended to this.ractive.el?\n      return null;\n    }\n\n    if (this.parent) return this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  }\n\n  findParentNode() {\n    let fragment = this;\n\n    do {\n      if (fragment.owner.type === ELEMENT) {\n        return fragment.owner.node;\n      }\n\n      if (fragment.isRoot && !fragment.ractive.component) {\n        // TODO encapsulate check\n        return fragment.ractive.el;\n      }\n\n      if (fragment.owner.type === YIELDER) {\n        fragment = fragment.owner.containerFragment;\n      } else {\n        fragment = fragment.componentParent || fragment.parent; // TODO ugh\n      }\n    } while (fragment);\n\n    throw new Error('Could not find parent node'); // TODO link to issue tracker\n  }\n\n  firstNode(skipParent) {\n    const node = findMap(this.items, i => i.firstNode(true));\n    if (node) return node;\n    if (skipParent) return null;\n\n    return this.parent.findNextNode(this.owner);\n  }\n\n  getKey() {\n    return this.keyModel || (this.keyModel = new KeyModel(this.key));\n  }\n\n  getKeypath(root) {\n    if (root) {\n      return (\n        this.rootModel ||\n        (this.rootModel = new KeyModel(this.context.getKeypath(this.ractive.root)))\n      );\n    } else {\n      return this.pathModel || (this.pathModel = new KeyModel(this.context.getKeypath()));\n    }\n  }\n\n  getIndex() {\n    return this.idxModel || (this.idxModel = new KeyModel(this.index));\n  }\n\n  rebind(next) {\n    this.context = next;\n  }\n\n  render(target, occupants) {\n    if (this.rendered) throw new Error('Fragment is already rendered!');\n    this.rendered = true;\n\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      xs[i].render(target, occupants);\n    }\n  }\n\n  resetTemplate(template) {\n    const wasBound = this.bound;\n    const wasRendered = this.rendered;\n\n    // TODO ensure transitions are disabled globally during reset\n\n    if (wasBound) {\n      if (wasRendered) this.unrender(true);\n      this.unbind();\n    }\n\n    this.template = template;\n    this.createItems();\n\n    if (wasBound) {\n      this.bind(this.context);\n\n      if (wasRendered) {\n        const parentNode = this.findParentNode();\n        const anchor = this.findNextNode();\n\n        if (anchor) {\n          const docFrag = createDocumentFragment();\n          this.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        } else {\n          this.render(parentNode);\n        }\n      }\n    }\n  }\n\n  shuffled() {\n    this.items.forEach(shuffled);\n    if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n    if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n  }\n\n  toString(escape) {\n    return this.items.map(escape ? toEscapedString : toString).join('');\n  }\n\n  unbind() {\n    this.context = null;\n    this.items.forEach(unbind);\n    this.bound = false;\n\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.items.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      if (!this.updating) {\n        this.dirty = false;\n        this.updating = true;\n        this.items.forEach(update);\n        this.updating = false;\n      } else if (this.isRoot) {\n        runloop.addFragmentToRoot(this);\n      }\n    }\n  }\n\n  valueOf() {\n    if (this.items.length === 1) {\n      return this.items[0].valueOf();\n    }\n\n    if (this.dirtyValue) {\n      const values = {};\n      const source = processItems(this.items, values, this.ractive._guid);\n      const parsed = parseJSON(source, values);\n\n      this.value = parsed ? parsed.value : this.toString();\n\n      this.dirtyValue = false;\n    }\n\n    return this.value;\n  }\n}\nFragment.prototype.getContext = getContext;\n","import Hook from './Hook';\n\nfunction getChildQueue(queue, ractive) {\n  return queue[ractive._guid] || (queue[ractive._guid] = []);\n}\n\nfunction fire(hookQueue, ractive) {\n  const childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  hookQueue.hook.fire(ractive);\n\n  // queue is \"live\" because components can end up being\n  // added while hooks fire on parents that modify data values.\n  while (childQueue.length) {\n    fire(hookQueue, childQueue.shift());\n  }\n\n  delete hookQueue.queue[ractive._guid];\n}\n\nexport default class HookQueue {\n  constructor(event) {\n    this.hook = new Hook(event);\n    this.inProcess = {};\n    this.queue = {};\n  }\n\n  begin(ractive) {\n    this.inProcess[ractive._guid] = true;\n  }\n\n  end(ractive) {\n    const parent = ractive.parent;\n\n    // If this is *isn't* a child of a component that's in process,\n    // it should call methods or fire at this point\n    if (!parent || !this.inProcess[parent._guid]) {\n      fire(this, ractive);\n    } else {\n      // elsewise, handoff to parent to fire when ready\n      getChildQueue(this.queue, parent).push(ractive);\n    }\n\n    delete this.inProcess[ractive._guid];\n  }\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { isArray } from 'utils/is';\nimport config from './config/config';\nimport Fragment from 'src/view/Fragment';\nimport Hook from 'src/events/Hook';\nimport HookQueue from 'src/events/HookQueue';\nimport Ractive from '../Ractive';\nimport subscribe from './helpers/subscribe';\n\nconst configHook = new Hook('config');\nconst initHook = new HookQueue('init');\n\nexport default function initialise(ractive, userOptions, options) {\n  // initialize settable computeds\n  const computed = ractive.viewmodel.computed;\n  if (computed) {\n    for (const k in computed) {\n      if (k in ractive.viewmodel.value && computed[k] && !computed[k].isReadonly) {\n        computed[k].set(ractive.viewmodel.value[k]);\n      }\n    }\n  }\n\n  // init config from Parent and options\n  config.init(ractive.constructor, ractive, userOptions);\n\n  configHook.fire(ractive);\n\n  initHook.begin(ractive);\n\n  const fragment = (ractive.fragment = createFragment(ractive, options));\n  if (fragment) fragment.bind(ractive.viewmodel);\n\n  initHook.end(ractive);\n\n  // general config done, set up observers\n  subscribe(ractive, userOptions, 'observe');\n\n  // call any passed in plugins\n  if (isArray(userOptions.use))\n    ractive.use.apply(ractive, userOptions.use.filter(p => !p.construct));\n\n  if (fragment) {\n    // render automatically ( if `el` is specified )\n    const el = (ractive.el = ractive.target = getElement(ractive.el || ractive.target));\n    if (el && !ractive.component) {\n      const promise = ractive.render(el, ractive.append);\n\n      if (Ractive.DEBUG_PROMISES) {\n        promise.catch(err => {\n          warnOnceIfDebug(\n            'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;'\n          );\n          warnIfDebug('An error happened during rendering', { ractive });\n          logIfDebug(err);\n\n          throw err;\n        });\n      }\n    }\n  }\n}\n\nexport function createFragment(ractive, options = {}) {\n  if (ractive.template) {\n    const cssIds = [].concat(ractive.constructor._cssIds || [], options.cssIds || []);\n\n    return new Fragment({\n      owner: ractive,\n      template: ractive.template,\n      cssIds\n    });\n  }\n}\n","import { doc } from 'config/environment';\nimport { applyCSS } from 'src/global/css';\nimport Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport { createFragment } from './initialise';\n\nconst renderHook = new Hook('render');\nconst completeHook = new Hook('complete');\n\nexport default function render(ractive, target, anchor, occupants) {\n  // set a flag to let any transitions know that this instance is currently rendering\n  ractive.rendering = true;\n\n  const promise = runloop.start();\n  runloop.scheduleTask(() => renderHook.fire(ractive), true);\n\n  if (ractive.fragment.rendered) {\n    throw new Error(\n      'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first'\n    );\n  }\n\n  if (ractive.destroyed) {\n    ractive.destroyed = false;\n    ractive.fragment = createFragment(ractive).bind(ractive.viewmodel);\n  }\n\n  anchor = getElement(anchor) || ractive.anchor;\n\n  ractive.el = ractive.target = target;\n  ractive.anchor = anchor;\n\n  // ensure encapsulated CSS is up-to-date\n  if (ractive.cssId) applyCSS();\n\n  if (target) {\n    (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n    if (anchor) {\n      const docFrag = doc.createDocumentFragment();\n      ractive.fragment.render(docFrag);\n      target.insertBefore(docFrag, anchor);\n    } else {\n      ractive.fragment.render(target, occupants);\n    }\n  }\n\n  runloop.end();\n  ractive.rendering = false;\n\n  return promise.then(() => {\n    if (ractive.torndown) return;\n\n    completeHook.fire(ractive);\n  });\n}\n","import runloop from 'src/global/runloop';\nimport config from '../config/config';\nimport Hook from '../../events/Hook';\nimport dataConfigurator from '../config/custom/data';\nimport { isObjectType } from 'utils/is';\n\nconst shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\nconst completeHook = new Hook('complete');\nconst resetHook = new Hook('reset');\nconst renderHook = new Hook('render');\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$reset(data) {\n  data = data || {};\n\n  if (!isObjectType(data)) {\n    throw new Error('The reset method takes either no arguments, or an object containing new data');\n  }\n\n  // TEMP need to tidy this up\n  data = dataConfigurator.init(this.constructor, this, { data });\n\n  const promise = runloop.start();\n\n  // If the root object is wrapped, try and use the wrapper's reset value\n  const wrapper = this.viewmodel.wrapper;\n  if (wrapper && wrapper.reset) {\n    if (wrapper.reset(data) === false) {\n      // reset was rejected, we need to replace the object\n      this.viewmodel.set(data);\n    }\n  } else {\n    this.viewmodel.set(data);\n  }\n\n  // reset config items and track if need to rerender\n  const changes = config.reset(this);\n  let rerender;\n\n  let i = changes.length;\n  while (i--) {\n    if (shouldRerender.indexOf(changes[i]) > -1) {\n      rerender = true;\n      break;\n    }\n  }\n\n  if (rerender) {\n    unrenderHook.fire(this);\n    this.fragment.resetTemplate(this.template);\n    renderHook.fire(this);\n    completeHook.fire(this);\n  }\n\n  runloop.end();\n\n  resetHook.fire(this, data);\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('reverse').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('shift').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('sort').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('splice').path;\n","import Hook from 'src/events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\n\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$unrender() {\n  if (!this.fragment.rendered) {\n    warnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n    return Promise.resolve();\n  }\n\n  this.unrendering = true;\n  const promise = runloop.start();\n\n  // If this is a component, and the component isn't marked for destruction,\n  // don't detach nodes from the DOM unnecessarily\n  const shouldDestroy =\n    !this.component ||\n    (this.component.anchor || {}).shouldDestroy ||\n    this.component.shouldDestroy ||\n    this.shouldDestroy;\n  this.fragment.unrender(shouldDestroy);\n  if (shouldDestroy) this.destroyed = true;\n\n  removeFromArray(this.el.__ractive_instances__, this);\n\n  unrenderHook.fire(this);\n\n  runloop.end();\n  this.unrendering = false;\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('unshift').path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport compute from './prototype/compute';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext, { getNodeInfo } from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\nimport use from './prototype/use';\n\nimport { defineProperty } from 'utils/object';\n\nconst proto = {\n  add,\n  animate,\n  attachChild,\n  compute,\n  detach,\n  detachChild,\n  find,\n  findAll,\n  findAllComponents,\n  findComponent,\n  findContainer,\n  findParent,\n  fire,\n  get,\n  getContext,\n  getNodeInfo,\n  insert,\n  link,\n  observe,\n  observeOnce,\n  off,\n  on,\n  once,\n  pop,\n  push,\n  readLink,\n  render,\n  reset,\n  resetPartial,\n  resetTemplate,\n  reverse,\n  set,\n  shift,\n  sort,\n  splice,\n  subtract,\n  teardown,\n  toggle,\n  toCSS,\n  toCss: toCSS,\n  toHTML,\n  toHtml: toHTML,\n  toText,\n  transition,\n  unlink,\n  unrender,\n  unshift,\n  update,\n  updateModel,\n  use\n};\n\ndefineProperty(proto, 'target', {\n  get() {\n    return this.el;\n  }\n});\n\nexport default proto;\n","import { isFunction } from 'utils/is';\nimport { addCSS, applyCSS } from 'src/global/css';\nimport { recomputeCSS } from './styleSet';\n\nconst styles = [];\n\nexport function addStyle(id, css) {\n  if (styles.find(s => s.id === id))\n    throw new Error(`Extra styles with the id '${id}' have already been added.`);\n  styles.push({ id, css });\n\n  if (!this.css) {\n    Object.defineProperty(this, 'css', { configurable: false, writable: false, value: buildCSS });\n  }\n\n  if (!this._cssDef) {\n    Object.defineProperty(this, '_cssDef', {\n      configurable: true,\n      writable: false,\n      value: {\n        transform: false,\n        id: 'Ractive.addStyle'\n      }\n    });\n\n    addCSS(this._cssDef);\n  }\n\n  recomputeCSS(this);\n  applyCSS(true);\n}\n\nfunction buildCSS(data) {\n  return styles\n    .map(s => `\\n/* ---- extra style ${s.id} */\\n` + (isFunction(s.css) ? s.css(data) : s.css))\n    .join('');\n}\n\nexport function hasStyle(id) {\n  return !!styles.find(s => s.id === id);\n}\n","import config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\nimport styleSet from '../Ractive/static/styleSet';\nimport styleGet from '../Ractive/static/styleGet';\nimport { addStyle, hasStyle } from '../Ractive/static/styles';\nimport sharedSet from '../Ractive/static/sharedSet';\nimport sharedGet from '../Ractive/static/sharedGet';\nimport use from '../Ractive/static/use';\nimport { create, defineProperties, toPairs, defineProperty } from 'utils/object';\nimport { isArray, isFunction } from 'utils/is';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend(...options) {\n  if (!options.length) {\n    return extendOne(this);\n  } else {\n    return options.reduce(extendOne, this);\n  }\n}\n\nexport function extendWith(Class, options = {}) {\n  return extendOne(this, options, Class);\n}\n\nfunction extendOne(Parent, options = {}, Target) {\n  let proto;\n  let Child = isFunction(Target) && Target;\n\n  if (options.prototype instanceof Ractive) {\n    throw new Error(`Ractive no longer supports multiple inheritance.`);\n  }\n\n  if (Child) {\n    if (!(Child.prototype instanceof Parent)) {\n      throw new Error(\n        `Only classes that inherit the appropriate prototype may be used with extend`\n      );\n    }\n    if (!callsSuper.test(Child.toString())) {\n      throw new Error(`Only classes that call super in their constructor may be used with extend`);\n    }\n\n    proto = Child.prototype;\n  } else {\n    Child = function(options) {\n      if (!(this instanceof Child)) return new Child(options);\n\n      construct(this, options || {});\n      initialise(this, options || {}, {});\n    };\n\n    proto = create(Parent.prototype);\n    proto.constructor = Child;\n\n    Child.prototype = proto;\n  }\n\n  // Static properties\n  defineProperties(Child, {\n    // alias prototype as defaults\n    defaults: { value: proto },\n\n    extend: { value: extend, writable: true, configurable: true },\n    extendWith: { value: extendWith, writable: true, configurable: true },\n    extensions: { value: [] },\n    use: { value: use },\n\n    isInstance: { value: isInstance },\n\n    Parent: { value: Parent },\n    Ractive: { value: Ractive },\n\n    styleGet: { value: styleGet.bind(Child), configurable: true },\n    styleSet: { value: styleSet.bind(Child), configurable: true }\n  });\n\n  // extend configuration\n  config.extend(Parent, proto, options, Child);\n\n  // store event and observer registries on the constructor when extending\n  Child._on = (Parent._on || []).concat(toPairs(options.on));\n  Child._observe = (Parent._observe || []).concat(toPairs(options.observe));\n\n  Parent.extensions.push(Child);\n\n  // attribute defs are not inherited, but they need to be stored\n  if (options.attributes) {\n    let attrs;\n\n    // allow an array of optional props or an object with arrays for optional and required props\n    if (isArray(options.attributes)) {\n      attrs = { optional: options.attributes, required: [] };\n    } else {\n      attrs = options.attributes;\n    }\n\n    // make sure the requisite keys actually store arrays\n    if (!isArray(attrs.required)) attrs.required = [];\n    if (!isArray(attrs.optional)) attrs.optional = [];\n\n    Child.attributes = attrs;\n  }\n\n  dataConfigurator.extend(Parent, proto, options, Child);\n\n  defineProperty(Child, 'helpers', { writable: true, value: proto.helpers });\n\n  if (isArray(options.use)) Child.use.apply(Child, options.use);\n\n  return Child;\n}\n\ndefineProperties(Ractive, {\n  sharedGet: { value: sharedGet },\n  sharedSet: { value: sharedSet },\n  styleGet: { configurable: true, value: styleGet.bind(Ractive) },\n  styleSet: { configurable: true, value: styleSet.bind(Ractive) },\n  addCSS: { configurable: false, value: addStyle.bind(Ractive) },\n  hasCSS: { configurable: false, value: hasStyle.bind(Ractive) }\n});\n","import './polyfills/Object.assign';\nimport './polyfills/array.find';\nimport './polyfills/node.contains';\nimport './polyfills/performance.now';\nimport './polyfills/Promise';\nimport './polyfills/requestAnimationFrame';\n\nimport defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport macro from './extend/_macro';\nimport parse from './parse/_parse';\nimport getContext, { getNodeInfo } from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport use from './Ractive/static/use';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\nimport CSSModel from './model/specials/CSSModel';\nimport { data as sharedData } from './model/specials/SharedModel';\nimport { extern } from './shared/getRactiveContext';\nimport { warn } from 'utils/log';\n\nimport { assign, defineProperty, defineProperties } from 'utils/object';\n\nexport default function Ractive(options) {\n  if (!(this instanceof Ractive)) return new Ractive(options);\n\n  construct(this, options || {});\n  initialise(this, options || {}, {});\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif (win && !win.Ractive) {\n  let opts = '';\n  const script =\n    document.currentScript ||\n    /* istanbul ignore next */ document.querySelector('script[data-ractive-options]');\n\n  if (script) opts = script.getAttribute('data-ractive-options') || '';\n\n  /* istanbul ignore next */\n  if (~opts.indexOf('ForceGlobal')) win.Ractive = Ractive;\n} else if (win) {\n  warn(`Ractive already appears to be loaded while loading BUILD_PLACEHOLDER_VERSION.`);\n}\n\nassign(Ractive.prototype, proto, defaults);\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\ndefineProperties(Ractive, {\n  // debug flag\n  DEBUG: { writable: true, value: true },\n  DEBUG_PROMISES: { writable: true, value: true },\n\n  // static methods:\n  extend: { value: extend },\n  extendWith: { value: extendWith },\n  escapeKey: { value: escapeKey },\n  evalObjectString: { value: parseJSON },\n  findPlugin: { value: findPlugin },\n  getContext: { value: getContext },\n  getCSS: { value: getCSS },\n  getNodeInfo: { value: getNodeInfo },\n  isInstance: { value: isInstance },\n  joinKeys: { value: joinKeys },\n  macro: { value: macro },\n  normaliseKeypath: { value: normalise },\n  parse: { value: parse },\n  splitKeypath: { value: splitKeypath },\n  // sharedSet and styleSet are in _extend because circular refs\n  unescapeKey: { value: unescapeKey },\n  use: { value: use },\n\n  // support\n  enhance: { writable: true, value: false },\n  svg: { value: svg },\n\n  // version\n  VERSION: { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n  // plugins\n  adaptors: { writable: true, value: {} },\n  components: { writable: true, value: {} },\n  decorators: { writable: true, value: {} },\n  easing: { writable: true, value: easing },\n  events: { writable: true, value: {} },\n  extensions: { value: [] },\n  helpers: { writable: true, value: defaults.helpers },\n  interpolators: { writable: true, value: interpolators },\n  partials: { writable: true, value: {} },\n  transitions: { writable: true, value: {} },\n\n  // CSS variables\n  cssData: { configurable: true, value: {} },\n\n  // access to @shared without an instance\n  sharedData: { value: sharedData },\n\n  // for getting the source Ractive lib from a constructor\n  Ractive: { value: Ractive },\n\n  // to allow extending contexts\n  Context: { value: extern.Context.prototype }\n});\n\n// cssData must already be in place\ndefineProperty(Ractive, '_cssModel', {\n  configurable: true,\n  value: new CSSModel(Ractive)\n});\n","import { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup(group, model, getValue) {\n  const hash = `${group}-bindingGroup`;\n  return model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n}\n\nclass BindingGroup {\n  constructor(hash, model, getValue) {\n    this.model = model;\n    this.hash = hash;\n    this.getValue = () => {\n      this.value = getValue.call(this);\n      return this.value;\n    };\n\n    this.bindings = [];\n  }\n\n  add(binding) {\n    this.bindings.push(binding);\n  }\n\n  bind() {\n    this.value = this.model.get();\n    this.model.registerTwowayBinding(this);\n    this.bound = true;\n  }\n\n  remove(binding) {\n    removeFromArray(this.bindings, binding);\n    if (!this.bindings.length) {\n      this.unbind();\n    }\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n    this.bound = false;\n    delete this.model[this.hash];\n  }\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport { isArray } from 'utils/is';\n\nconst push = [].push;\n\nfunction getValue() {\n  const all = this.bindings\n    .filter(b => b.node && b.node.checked)\n    .map(b => b.element.getAttribute('value'));\n  const res = [];\n  all.forEach(v => {\n    if (!this.bindings[0].arrayContains(res, v)) res.push(v);\n  });\n  return res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n    // Each input has a reference to an array containing it and its\n    // group, as two-way binding depends on being able to ascertain\n    // the status of all inputs within the group\n    this.group = getBindingGroup('checkboxes', this.model, getValue);\n    this.group.add(this);\n\n    if (this.noInitialValue) {\n      this.group.noInitialValue = true;\n    }\n\n    // If no initial value was set, and this input is checked, we\n    // update the model\n    if (this.group.noInitialValue && this.element.getAttribute('checked')) {\n      const existingValue = this.model.get();\n      const bindingValue = this.element.getAttribute('value');\n\n      if (!this.arrayContains(existingValue, bindingValue)) {\n        push.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n      }\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    // This only gets called once per group (of inputs that\n    // share a name), because it only gets called if there\n    // isn't an initial value. By the same token, we can make\n    // a note of that fact that there was no initial value,\n    // and populate it using any `checked` attributes that\n    // exist (which users should avoid, but which we should\n    // support anyway to avoid breaking expectations)\n    this.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n    return [];\n  }\n\n  getValue() {\n    return this.group.value;\n  }\n\n  handleChange() {\n    this.isChecked = this.element.node.checked;\n    this.group.value = this.model.get();\n    const value = this.element.getAttribute('value');\n    if (this.isChecked && !this.arrayContains(this.group.value, value)) {\n      this.group.value.push(value);\n    } else if (!this.isChecked && this.arrayContains(this.group.value, value)) {\n      this.removeFromArray(this.group.value, value);\n    }\n    // make sure super knows there's a change\n    this.lastValue = null;\n    super.handleChange();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    const existingValue = this.model.get();\n    const bindingValue = this.element.getAttribute('value');\n\n    if (isArray(existingValue)) {\n      this.isChecked = this.arrayContains(existingValue, bindingValue);\n    } else {\n      this.isChecked = this.element.compare(existingValue, bindingValue);\n    }\n    node.name = '{{' + this.model.getKeypath() + '}}';\n    node.checked = this.isChecked;\n\n    this.element.on('change', handleDomEvent);\n\n    // in case of IE emergency, bind to click event as well\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.group.bindings.forEach(binding => (binding.wasUndefined = true));\n\n    if (node.checked) {\n      const valueSoFar = this.group.getValue();\n      valueSoFar.push(this.element.getAttribute('value'));\n\n      this.group.model.set(valueSoFar);\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  arrayContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.element.compare(optionValue, selectValue[i])) return true;\n    }\n    return false;\n  }\n\n  removeFromArray(array, item) {\n    if (!array) return;\n    let i = array.length;\n    while (i--) {\n      if (this.element.compare(item, array[i])) {\n        array.splice(i, 1);\n      }\n    }\n  }\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n  getInitialValue() {\n    return this.element.fragment ? this.element.fragment.toString() : '';\n  }\n\n  getValue() {\n    return this.element.node.innerHTML;\n  }\n\n  render() {\n    super.render();\n\n    const el = this.element;\n\n    el.on('change', handleDomEvent);\n    el.on('blur', handleDomEvent);\n\n    if (!this.ractive.lazy) {\n      el.on('input', handleDomEvent);\n\n      if (this.node.attachEvent) {\n        el.on('keyup', handleDomEvent);\n      }\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.innerHTML);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('blur', handleDomEvent);\n    el.off('change', handleDomEvent);\n    el.off('input', handleDomEvent);\n    el.off('keyup', handleDomEvent);\n  }\n}\n","import { isNumeric } from 'utils/is';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur() {\n  handleDomEvent.call(this);\n\n  const value = this._ractive.binding.model.get();\n  this.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay(delay) {\n  let timeout;\n\n  return function() {\n    if (timeout) clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      const binding = this._ractive.binding;\n      if (binding.rendered) handleDomEvent.call(this);\n      timeout = null;\n    }, delay);\n  };\n}\n\nexport default class GenericBinding extends Binding {\n  getInitialValue() {\n    return '';\n  }\n\n  getValue() {\n    return this.node.value;\n  }\n\n  render() {\n    super.render();\n\n    // any lazy setting for this element overrides the root\n    // if the value is a number, it's a timeout\n    let lazy = this.ractive.lazy;\n    let timeout = false;\n    const el = this.element;\n\n    if ('lazy' in this.element) {\n      lazy = this.element.lazy;\n    }\n\n    if (isNumeric(lazy)) {\n      timeout = +lazy;\n      lazy = false;\n    }\n\n    this.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n    const node = this.node;\n\n    el.on('change', handleDomEvent);\n\n    if (node.type !== 'file') {\n      if (!lazy) {\n        el.on('input', this.handler);\n\n        // IE is a special snowflake\n        if (node.attachEvent) {\n          el.on('keyup', this.handler);\n        }\n      }\n\n      el.on('blur', handleBlur);\n    }\n  }\n\n  unrender() {\n    const el = this.element;\n    this.rendered = false;\n\n    el.off('change', handleDomEvent);\n    el.off('input', this.handler);\n    el.off('keyup', this.handler);\n    el.off('blur', handleBlur);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n  getInitialValue() {\n    /* istanbul ignore next */\n    return undefined;\n  }\n\n  getValue() {\n    /* istanbul ignore next */\n    return this.node.files;\n  }\n\n  render() {\n    /* istanbul ignore next */\n    this.element.lazy = false;\n    /* istanbul ignore next */\n    super.render();\n  }\n\n  setFromNode(node) {\n    /* istanbul ignore next */\n    this.model.set(node.files);\n  }\n}\n","import { arrayContentsMatch } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class MultipleSelectBinding extends Binding {\n  getInitialValue() {\n    return this.element.options\n      .filter(option => option.getAttribute('selected'))\n      .map(option => option.getAttribute('value'));\n  }\n\n  getValue() {\n    const options = this.element.node.options;\n    const len = options.length;\n\n    const selectedValues = [];\n\n    for (let i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (option.selected) {\n        const optionValue = option._ractive ? option._ractive.value : option.value;\n        selectedValues.push(optionValue);\n      }\n    }\n\n    return selectedValues;\n  }\n\n  handleChange() {\n    const attribute = this.attribute;\n    const previousValue = attribute.getValue();\n\n    const value = this.getValue();\n\n    if (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n      super.handleChange();\n    }\n\n    return this;\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.model.get() === undefined) {\n      // get value from DOM, if possible\n      this.handleChange();\n    }\n  }\n\n  setFromNode(node) {\n    const selectedOptions = getSelectedOptions(node);\n    let i = selectedOptions.length;\n    const result = new Array(i);\n\n    while (i--) {\n      const option = selectedOptions[i];\n      result[i] = option._ractive ? option._ractive.value : option.value;\n    }\n\n    this.model.set(result);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n  getInitialValue() {\n    return undefined;\n  }\n\n  getValue() {\n    const value = parseFloat(this.node.value);\n    return isNaN(value) ? undefined : value;\n  }\n\n  setFromNode(node) {\n    const value = parseFloat(node.value);\n    if (!isNaN(value)) this.model.set(value);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings(hash) {\n  return siblings[hash] || (siblings[hash] = []);\n}\n\nexport default class RadioBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n\n    this.siblings = getSiblings(this.ractive._guid + this.element.getAttribute('name'));\n    this.siblings.push(this);\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  handleChange() {\n    runloop.start();\n\n    this.siblings.forEach(binding => {\n      binding.model.set(binding.getValue());\n    });\n\n    runloop.end();\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n\n  unbind() {\n    removeFromArray(this.siblings, this);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n}\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getValue() {\n  const checked = this.bindings.filter(b => b.node.checked);\n  if (checked.length > 0) {\n    return checked[0].element.getAttribute('value');\n  }\n}\n\nexport default class RadioNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.group = getBindingGroup('radioname', this.model, getValue);\n    this.group.add(this);\n\n    if (element.checked) {\n      this.group.value = this.getValue();\n    }\n\n    this.attribute.interpolator.pathChanged = () => this.updateName();\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('checked')) {\n      return this.element.getAttribute('value');\n    }\n  }\n\n  getValue() {\n    return this.element.getAttribute('value');\n  }\n\n  handleChange() {\n    // If this <input> is the one that's checked, then the value of its\n    // `name` model gets set to its value\n    if (this.node.checked) {\n      this.group.value = this.getValue();\n      super.handleChange();\n    }\n\n    this.updateName();\n  }\n\n  lastVal(setting, value) {\n    if (!this.group) return;\n    if (setting) this.group.lastValue = value;\n    else return this.group.lastValue;\n  }\n\n  rebind(next, previous) {\n    super.rebind(next, previous);\n    this.updateName();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    this.updateName();\n    node.checked = this.element.compare(this.model.get(), this.element.getAttribute('value'));\n\n    this.element.on('change', handleDomEvent);\n\n    if (node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    if (node.checked) {\n      this.group.model.set(this.element.getAttribute('value'));\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  updateName() {\n    if (this.node) this.node.name = `{{${this.model.getKeypath()}}}`;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n  forceUpdate() {\n    const value = this.getValue();\n\n    if (value !== undefined) {\n      this.attribute.locked = true;\n      runloop.scheduleTask(() => (this.attribute.locked = false));\n      this.model.set(value);\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('value') !== undefined) {\n      return;\n    }\n\n    const options = this.element.options;\n    const len = options.length;\n\n    if (!len) return;\n\n    let value;\n    let optionWasSelected;\n    let i = len;\n\n    // take the final selected option...\n    while (i--) {\n      const option = options[i];\n\n      if (option.getAttribute('selected')) {\n        if (!option.getAttribute('disabled')) {\n          value = option.getAttribute('value');\n        }\n\n        optionWasSelected = true;\n        break;\n      }\n    }\n\n    // or the first non-disabled option, if none are selected\n    if (!optionWasSelected) {\n      while (++i < len) {\n        if (!options[i].getAttribute('disabled')) {\n          value = options[i].getAttribute('value');\n          break;\n        }\n      }\n    }\n\n    // This is an optimisation (aka hack) that allows us to forgo some\n    // other more expensive work\n    // TODO does it still work? seems at odds with new architecture\n    if (value !== undefined) {\n      this.element.attributeByName.value.value = value;\n    }\n\n    return value;\n  }\n\n  getValue() {\n    const options = this.node.options;\n    const len = options.length;\n\n    let i;\n    for (i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (options[i].selected && !options[i].disabled) {\n        return option._ractive ? option._ractive.value : option.value;\n      }\n    }\n  }\n\n  render() {\n    super.render();\n    this.element.on('change', handleDomEvent);\n  }\n\n  setFromNode(node) {\n    const option = getSelectedOptions(node)[0];\n    this.model.set(option._ractive ? option._ractive.value : option.value);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from 'config/types';\nimport { win } from 'config/environment';\nimport { html, svg } from 'config/namespaces';\nimport { toArray, addToArray, removeFromArray } from 'utils/array';\nimport { escapeHtml, voidElementNames } from 'utils/html';\nimport { createElement, detachNode, matches, safeAttributeString } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport Context from 'shared/Context';\nimport { bind, destroyed, render, unbind, update } from 'shared/methodCallers';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { assign, create, defineProperty } from 'utils/object';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.e.toLowerCase();\n\n    // find parent element\n    this.parent = findElement(this.up, false);\n\n    if (this.parent && this.parent.name === 'option') {\n      throw new Error(\n        `An <option> element cannot contain other elements (encountered <${this.name}>)`\n      );\n    }\n\n    this.decorators = [];\n\n    // create attributes\n    this.attributeByName = {};\n\n    let attrs;\n    let n, attr, val, cls, name, template, leftovers;\n\n    const m = this.template.m;\n    const len = (m && m.length) || 0;\n\n    for (let i = 0; i < len; i++) {\n      template = m[i];\n      switch (template.t) {\n        case ATTRIBUTE:\n        case BINDING_FLAG:\n        case DECORATOR:\n        case EVENT:\n        case TRANSITION:\n          attr = createItem({\n            owner: this,\n            up: this.up,\n            template\n          });\n\n          n = template.n;\n\n          attrs = attrs || (attrs = this.attributes = []);\n\n          if (n === 'value') val = attr;\n          else if (n === 'name') name = attr;\n          else if (n === 'class') cls = attr;\n          else attrs.push(attr);\n\n          break;\n\n        case DELEGATE_FLAG:\n          this.delegate = false;\n          break;\n\n        default:\n          (leftovers || (leftovers = [])).push(template);\n          break;\n      }\n    }\n\n    if (val) attrs.push(val);\n    if (name) attrs.push(name);\n    if (cls) attrs.unshift(cls);\n\n    if (leftovers) {\n      (attrs || (this.attributes = [])).push(\n        new ConditionalAttribute({\n          owner: this,\n          up: this.up,\n          template: leftovers\n        })\n      );\n\n      // empty leftovers array\n      leftovers = [];\n    }\n\n    // create children\n    if (options.template.f && !options.deferContent) {\n      this.fragment = new Fragment({\n        template: options.template.f,\n        owner: this,\n        cssIds: null\n      });\n    }\n\n    this.binding = null; // filled in later\n  }\n\n  bind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.binding = true;\n      attrs.forEach(bind);\n      attrs.binding = false;\n    }\n\n    if (this.fragment) this.fragment.bind();\n\n    // create two-way binding if necessary\n    if (!this.binding) this.recreateTwowayBinding();\n    else this.binding.bind();\n  }\n\n  createTwowayBinding() {\n    if ('twoway' in this ? this.twoway : this.ractive.twoway) {\n      const Binding = selectBinding(this);\n      if (Binding) {\n        const binding = new Binding(this);\n        if (binding && binding.model) return binding;\n      }\n    }\n  }\n\n  destroyed() {\n    if (this.attributes) this.attributes.forEach(destroyed);\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.removeEventListener(k, handler);\n      }\n    }\n\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  detach() {\n    // if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n    if (!this.rendered) this.destroyed();\n\n    return detachNode(this.node);\n  }\n\n  find(selector, options) {\n    if (this.node && matches(this.node, selector)) return this.node;\n    if (this.fragment) {\n      return this.fragment.find(selector, options);\n    }\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n\n    if (matches(this.node, selector)) {\n      result.push(this.node);\n    }\n\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findNextNode() {\n    return null;\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute ? attribute.getValue() : undefined;\n  }\n\n  getContext(...assigns) {\n    if (this.fragment) return this.fragment.getContext(...assigns);\n\n    if (!this.ctx) this.ctx = new Context(this.up, this);\n    assigns.unshift(create(this.ctx));\n    return assign.apply(null, assigns);\n  }\n\n  off(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = this.listeners && this.listeners[event];\n\n    if (!ref) return;\n    removeFromArray(ref, callback);\n\n    if (delegate) {\n      const listeners =\n        (delegate.listeners || (delegate.listeners = [])) &&\n        (delegate.listeners[event] || (delegate.listeners[event] = []));\n      if (listeners.refs && !--listeners.refs) delegate.off(event, delegateHandler, true);\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        rem.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, true);\n        add.call(n, event, handler, false);\n      }\n    }\n  }\n\n  on(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = (this.listeners || (this.listeners = {}))[event] || (this.listeners[event] = []);\n\n    if (delegate) {\n      const listeners =\n        ((delegate.listeners || (delegate.listeners = [])) && delegate.listeners[event]) ||\n        (delegate.listeners[event] = []);\n      if (!listeners.refs) {\n        listeners.refs = 0;\n        delegate.on(event, delegateHandler, true);\n        listeners.refs++;\n      } else {\n        listeners.refs++;\n      }\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        add.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, false);\n        add.call(n, event, handler, true);\n      }\n    }\n\n    addToArray(this.listeners[event], callback);\n  }\n\n  recreateTwowayBinding() {\n    if (this.binding) {\n      this.binding.unbind();\n      this.binding.unrender();\n    }\n\n    if ((this.binding = this.createTwowayBinding())) {\n      this.binding.bind();\n      if (this.rendered) this.binding.render();\n    }\n  }\n\n  render(target, occupants) {\n    // TODO determine correct namespace\n    this.namespace = getNamespace(this);\n\n    let node;\n    let existing = false;\n\n    if (occupants) {\n      let n;\n      while ((n = occupants.shift())) {\n        if (\n          n.nodeName.toUpperCase() === this.template.e.toUpperCase() &&\n          n.namespaceURI === this.namespace\n        ) {\n          this.node = node = n;\n          existing = true;\n          break;\n        } else {\n          detachNode(n);\n        }\n      }\n    }\n\n    if (!existing && this.node) {\n      node = this.node;\n      target.appendChild(node);\n      existing = true;\n    }\n\n    if (!node) {\n      const name = this.template.e;\n      node = createElement(\n        this.namespace === html ? name.toLowerCase() : name,\n        this.namespace,\n        this.getAttribute('is')\n      );\n      this.node = node;\n    }\n\n    // tie the node to this vdom element\n    defineProperty(node, '_ractive', {\n      value: {\n        proxy: this\n      },\n      configurable: true\n    });\n\n    if (existing && this.foundNode) this.foundNode(node);\n\n    // register intro before rendering content so children can find the intro\n    const intro = this.intro;\n    if (intro && intro.shouldFire('intro')) {\n      intro.isIntro = true;\n      intro.isOutro = false;\n      runloop.registerTransition(intro);\n    }\n\n    if (this.fragment) {\n      const children = existing ? toArray(node.childNodes) : undefined;\n\n      this.fragment.render(node, children);\n\n      // clean up leftover children\n      if (children) {\n        children.forEach(detachNode);\n      }\n    }\n\n    if (existing) {\n      // store initial values for two-way binding\n      if (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n      // remove unused attributes\n      let i = node.attributes.length;\n      while (i--) {\n        const name = node.attributes[i].name;\n        if (!(name in this.attributeByName)) node.removeAttribute(name);\n      }\n    }\n\n    // Is this a top-level node of a component? If so, we may need to add\n    // a data-ractive-css attribute, for CSS encapsulation\n    if (this.up.cssIds) {\n      node.setAttribute('data-ractive-css', this.up.cssIds.map(x => `{${x}}`).join(' '));\n    }\n\n    if (this.attributes) this.attributes.forEach(render);\n    if (this.binding) this.binding.render();\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.addEventListener(k, handler, !!ls[k].refs);\n      }\n    }\n\n    if (!existing) {\n      target.appendChild(node);\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    const tagName = this.template.e;\n\n    let attrs = (this.attributes && this.attributes.map(stringifyAttribute).join('')) || '';\n\n    // Special case - selected options\n    if (this.name === 'option' && this.isSelected()) {\n      attrs += ' selected';\n    }\n\n    // Special case - two-way radio name bindings\n    if (this.name === 'input' && inputIsCheckedRadio(this)) {\n      attrs += ' checked';\n    }\n\n    // Special case style and class attributes and directives\n    let style, cls;\n    this.attributes &&\n      this.attributes.forEach(attr => {\n        if (attr.name === 'class') {\n          cls = (cls || '') + (cls ? ' ' : '') + safeAttributeString(attr.getString());\n        } else if (attr.name === 'style') {\n          style = (style || '') + (style ? ' ' : '') + safeAttributeString(attr.getString());\n          if (style && !endsWithSemi.test(style)) style += ';';\n        } else if (attr.style) {\n          style =\n            (style || '') +\n            (style ? ' ' : '') +\n            `${attr.style}: ${safeAttributeString(attr.getString())};`;\n        } else if (attr.inlineClass && attr.getValue()) {\n          cls = (cls || '') + (cls ? ' ' : '') + attr.inlineClass;\n        }\n      });\n    // put classes first, then inline style\n    if (style !== undefined) attrs = ' style' + (style ? `=\"${style}\"` : '') + attrs;\n    if (cls !== undefined) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n    if (this.up.cssIds) {\n      attrs += ` data-ractive-css=\"${this.up.cssIds.map(x => `{${x}}`).join(' ')}\"`;\n    }\n\n    let str = `<${tagName}${attrs}>`;\n\n    if (voidElementNames.test(this.name)) return str;\n\n    // Special case - textarea\n    if (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n      str += escapeHtml(this.getAttribute('value'));\n    } else if (this.getAttribute('contenteditable') !== undefined) {\n      // Special case - contenteditable\n      str += this.getAttribute('value') || '';\n    }\n\n    if (this.fragment) {\n      str += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n    }\n\n    str += `</${tagName}>`;\n    return str;\n  }\n\n  unbind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.unbinding = true;\n      attrs.forEach(unbind);\n      attrs.unbinding = false;\n    }\n\n    if (this.binding) this.binding.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (!this.rendered) return;\n    this.rendered = false;\n\n    // unrendering before intro completed? complete it now\n    // TODO should be an API for aborting transitions\n    const transition = this.intro;\n    if (transition && transition.complete) transition.complete();\n\n    // Detach as soon as we can\n    if (this.name === 'option') {\n      // <option> elements detach immediately, so that\n      // their parent <select> element syncs correctly, and\n      // since option elements can't have transitions anyway\n      this.detach();\n    } else if (shouldDestroy) {\n      runloop.detachWhenReady(this);\n    }\n\n    // outro transition\n    const outro = this.outro;\n    if (outro && outro.shouldFire('outro')) {\n      outro.isIntro = false;\n      outro.isOutro = true;\n      runloop.registerTransition(outro);\n    }\n\n    if (this.fragment) this.fragment.unrender();\n\n    if (this.binding) this.binding.unrender();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      this.attributes && this.attributes.forEach(update);\n\n      if (this.fragment) this.fragment.update();\n    }\n  }\n}\n\nfunction inputIsCheckedRadio(element) {\n  const nameAttr = element.attributeByName.name;\n  return (\n    element.getAttribute('type') === 'radio' &&\n    (nameAttr || {}).interpolator &&\n    element.getAttribute('value') === nameAttr.interpolator.model.get()\n  );\n}\n\nfunction stringifyAttribute(attribute) {\n  const str = attribute.toString();\n  return str ? ' ' + str : '';\n}\n\nfunction getNamespace(element) {\n  // Use specified namespace...\n  const xmlns = element.getAttribute('xmlns');\n  if (xmlns) return xmlns;\n\n  // ...or SVG namespace, if this is an <svg> element\n  if (element.name === 'svg') return svg;\n\n  const parent = element.parent;\n\n  if (parent) {\n    // ...or HTML, if the parent is a <foreignObject>\n    if (parent.name === 'foreignobject') return html;\n\n    // ...or inherit from the parent node\n    return parent.node.namespaceURI;\n  }\n\n  return element.ractive.el.namespaceURI;\n}\n\nfunction delegateHandler(ev) {\n  const name = ev.type;\n  const end = ev.currentTarget;\n  const endEl = end._ractive && end._ractive.proxy;\n  let node = ev.target;\n  let bubble = true;\n  let listeners;\n\n  // starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n  while (bubble && node && node !== end) {\n    const proxy = node._ractive && node._ractive.proxy;\n    if (proxy && proxy.up.delegate === endEl && shouldFire(ev, node, end)) {\n      listeners = proxy.listeners && proxy.listeners[name];\n\n      if (listeners) {\n        listeners.forEach(l => {\n          bubble = l.call(node, ev) !== false && bubble;\n        });\n      }\n    }\n\n    node = node.parentNode || node.correspondingUseElement; // SVG with a <use> element in certain environments\n  }\n\n  return bubble;\n}\n\nconst UIEvent = win !== null ? win.UIEvent : null;\nfunction shouldFire(event, start, end) {\n  if (UIEvent && event instanceof UIEvent) {\n    let node = start;\n    while (node && node !== end) {\n      if (node.disabled) return false;\n      node = node.parentNode || node.correspondingUseElement;\n    }\n  }\n\n  return true;\n}\n\nfunction handler(ev) {\n  const el = this._ractive.proxy;\n  if (!el.listeners || !el.listeners[ev.type]) return;\n  el.listeners[ev.type].forEach(l => l.call(this, ev));\n}\n","import runloop from 'src/global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n  constructor(options) {\n    super(options);\n    this.formBindings = [];\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.on('reset', handleReset);\n  }\n\n  unrender(shouldDestroy) {\n    this.off('reset', handleReset);\n    super.unrender(shouldDestroy);\n  }\n}\n\nfunction handleReset() {\n  const element = this._ractive.proxy;\n\n  runloop.start();\n  element.formBindings.forEach(updateModel);\n  runloop.end();\n}\n\nfunction updateModel(binding) {\n  binding.model.set(binding.resetValue);\n}\n","import { fatal } from 'utils/log';\nimport runloop from 'src/global/runloop';\nimport { win } from 'config/environment';\n\n// because IE\nconst whitelist = {\n  animationend: 1,\n  animationiteration: 1,\n  animationstart: 1,\n  transitioncancel: 1,\n  transitionend: 1,\n  transitionstart: 1,\n  transitionrun: 1\n};\n\nclass DOMEvent {\n  constructor(name, owner) {\n    if (name.indexOf('*') !== -1) {\n      fatal(\n        `Only component proxy-events may contain \"*\" wildcards, <${\n          owner.name\n        } on-${name}=\"...\"/> is not valid`\n      );\n    }\n\n    this.name = name;\n    this.owner = owner;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    // schedule events so that they take place after twoway binding\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n      const name = this.name;\n      const on = `on${name}`;\n\n      // this is probably a custom event fired from a decorator or manually\n      if (!(on in node) && !(on in win) && !whitelist[name]) return;\n\n      this.owner.on(\n        name,\n        (this.handler = event => {\n          return directive.fire({\n            node,\n            original: event,\n            event,\n            name\n          });\n        })\n      );\n    }, true);\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.owner.off(this.name, this.handler);\n  }\n}\n\nclass CustomEvent {\n  constructor(eventPlugin, owner, name, args) {\n    this.eventPlugin = eventPlugin;\n    this.owner = owner;\n    this.name = name;\n    this.handler = null;\n    this.args = args;\n  }\n\n  bind() {}\n\n  render(directive) {\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n\n      this.handler = this.eventPlugin.apply(\n        this.owner.ractive,\n        [\n          node,\n          (event = {}) => {\n            if (event.original) event.event = event.original;\n            else event.original = event.event;\n\n            event.name = this.name;\n            event.node = event.node || node;\n            return directive.fire(event);\n          }\n        ].concat(this.args || [])\n      );\n    });\n  }\n\n  unbind() {}\n\n  unrender() {\n    this.handler.teardown();\n  }\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n  constructor(component, name) {\n    this.component = component;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind(directive) {\n    const ractive = this.component.instance;\n\n    this.handler = ractive.on(this.name, (...args) => {\n      // watch for reproxy\n      if (args[0] instanceof Context) {\n        const ctx = args.shift();\n        ctx.component = ractive;\n        directive.fire(ctx, args);\n      } else {\n        directive.fire({}, args);\n      }\n\n      // cancel bubbling\n      return false;\n    });\n  }\n\n  render() {}\n\n  unbind() {\n    this.handler.cancel();\n  }\n\n  unrender() {}\n}\n","import { ANCHOR, COMPONENT } from 'config/types';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport fireEvent from 'src/events/fireEvent';\nimport { splitKeypath } from 'shared/keypaths';\nimport { findInViewHierarchy } from 'shared/registry';\nimport findElement from './findElement';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport Context from 'src/shared/Context';\nimport { isArray, isString } from 'utils/is';\nimport getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up, true);\n    this.template = options.template;\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n    this.events = [];\n  }\n\n  bind() {\n    if (this.element.type === COMPONENT || this.element.type === ANCHOR) {\n      this.template.n.forEach(n => {\n        this.events.push(new RactiveEvent(this.element, n));\n      });\n    } else {\n      let args;\n      if ((args = this.template.a)) {\n        const rs = args.r.map(r => {\n          const model = resolveReference(this.up, r);\n          return model ? model.get() : undefined;\n        });\n        try {\n          args = getFunction(args.s, rs.length).apply(null, rs);\n        } catch (err) {\n          args = null;\n          warnIfDebug(\n            `Failed to compute args for event on-${this.template.n.join('- ')}: ${err.message ||\n              err}`\n          );\n        }\n      }\n\n      this.template.n.forEach(n => {\n        const fn = findInViewHierarchy('events', this.ractive, n);\n        if (fn) {\n          this.events.push(new CustomEvent(fn, this.element, n, args));\n        } else {\n          this.events.push(new DOMEvent(n, this.element));\n        }\n      });\n    }\n\n    // method calls\n    this.models = null;\n\n    addToArray(this.element.events || (this.element.events = []), this);\n\n    setupArgsFn(this, this.template);\n    if (!this.fn) this.action = this.template.f;\n\n    this.events.forEach(e => e.bind(this));\n  }\n\n  destroyed() {\n    this.events.forEach(e => e.unrender());\n  }\n\n  fire(event, args = []) {\n    const context =\n      event instanceof Context && event.refire ? event : this.element.getContext(event);\n\n    if (this.fn) {\n      const values = [];\n\n      const models = resolveArgs(this, this.template, this.up, {\n        specialRef(ref) {\n          const specialMatch = specialPattern.exec(ref);\n          if (specialMatch) {\n            // on-click=\"foo(event.node)\"\n            return {\n              special: specialMatch[1],\n              keys: specialMatch[2] ? splitKeypath(specialMatch[2].substr(1)) : []\n            };\n          }\n\n          const dollarMatch = dollarArgsPattern.exec(ref);\n          if (dollarMatch) {\n            // on-click=\"foo($1)\"\n            return {\n              special: 'arguments',\n              keys: [dollarMatch[1] - 1].concat(\n                dollarMatch[2] ? splitKeypath(dollarMatch[2].substr(1)) : []\n              )\n            };\n          }\n        }\n      });\n\n      if (models) {\n        models.forEach(model => {\n          if (!model) return values.push(undefined);\n\n          if (model.special) {\n            const which = model.special;\n            let obj;\n\n            if (which === '@node') {\n              obj = this.element.node;\n            } else if (which === '@event') {\n              obj = event && event.event;\n            } else if (which === 'event') {\n              warnOnceIfDebug(\n                `The event reference available to event directives is deprecated and should be replaced with @context and @event`\n              );\n              obj = context;\n            } else if (which === '@context') {\n              obj = context;\n            } else {\n              obj = args;\n            }\n\n            const keys = model.keys.slice();\n\n            while (obj && keys.length) obj = obj[keys.shift()];\n            return values.push(obj);\n          }\n\n          if (model.wrapper) {\n            return values.push(model.wrapperValue);\n          }\n\n          values.push(model.get());\n        });\n      }\n\n      // make event available as `this.event`\n      const ractive = this.ractive;\n      const oldEvent = ractive.event;\n\n      ractive.event = context;\n      const returned = this.fn.apply(ractive, values);\n      let result = returned.pop();\n\n      // Auto prevent and stop if return is explicitly false\n      if (result === false) {\n        const original = event ? event.original : undefined;\n        if (original) {\n          original.preventDefault && original.preventDefault();\n          original.stopPropagation && original.stopPropagation();\n        } else {\n          warnOnceIfDebug(\n            `handler '${this.template.n.join(\n              ' '\n            )}' returned false, but there is no event available to cancel`\n          );\n        }\n      } else if (!returned.length && isArray(result) && isString(result[0])) {\n        // watch for proxy events\n        result = fireEvent(this.ractive, result.shift(), context, result);\n      }\n\n      ractive.event = oldEvent;\n\n      return result;\n    } else {\n      return fireEvent(this.ractive, this.action, context, args);\n    }\n  }\n\n  handleChange() {}\n\n  render() {\n    this.events.forEach(e => e.render(this));\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    removeFromArray(this.element.events, this);\n    this.events.forEach(e => e.unbind());\n  }\n\n  unrender() {\n    this.events.forEach(e => e.unrender());\n  }\n}\n\nEventDirective.prototype.update = noop;\n","import { rebindMatch } from 'shared/rebind';\nimport Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { assign } from 'utils/object';\n\nexport default class Mustache extends Item {\n  constructor(options) {\n    super(options);\n\n    if (options.owner) this.parent = options.owner;\n\n    this.isStatic = !!options.template.s;\n\n    this.model = null;\n    this.dirty = false;\n  }\n\n  bind() {\n    // yield mustaches should resolve in container context\n    const start = this.containerFragment || this.up;\n    // try to find a model for this view\n    const model = resolve(start, this.template);\n\n    if (model) {\n      const value = model.get();\n\n      if (this.isStatic) {\n        this.model = { get: () => value };\n        model.unreference();\n        return;\n      }\n\n      model.register(this);\n      this.model = model;\n    }\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    next = rebindMatch(this.template, next, previous, this.up);\n    if (next === this.model) return false;\n\n    if (this.model) {\n      this.model.unregister(this);\n    }\n    if (next) next.addShuffleRegister(this, 'mark');\n    this.model = next;\n    if (!safe) this.handleChange();\n    return true;\n  }\n\n  unbind() {\n    if (!this.isStatic) {\n      this.model && this.model.unregister(this);\n      this.model = undefined;\n    }\n  }\n}\n\nexport function MustacheContainer(options) {\n  Mustache.call(this, options);\n}\n\nconst proto = (MustacheContainer.prototype = Object.create(ContainerItem.prototype));\n\nassign(proto, Mustache.prototype, { constructor: MustacheContainer });\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n  bubble() {\n    if (this.owner) this.owner.bubble();\n    super.bubble();\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getString() {\n    return this.model ? safeToStringValue(this.model.get()) : '';\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    const value = (this.value = this.getString());\n\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, value);\n  }\n\n  toString(escape) {\n    const string = this.getString();\n    return escape ? escapeHtml(string) : string;\n  }\n\n  unrender(shouldDestroy) {\n    if (shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.rendered) {\n        const value = this.getString();\n        if (value !== this.value) this.node.data = this.value = value;\n      }\n    }\n  }\n\n  valueOf() {\n    return this.model ? this.model.get() : undefined;\n  }\n}\n","import Element from '../../Element';\nimport { isFunction } from 'utils/is';\n\nexport default class Input extends Element {\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.node.defaultValue = this.node.value;\n  }\n  compare(value, attrValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(value, attrValue);\n      }\n      if (value && attrValue) {\n        return value[comparator] == attrValue[comparator];\n      }\n    }\n    return value == attrValue;\n  }\n}\n","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\nimport { hasOwn, keys } from 'utils/object';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n  true: true,\n  false: false,\n  null: null,\n  undefined\n};\n\nconst specialsPattern = new RegExp('^(?:' + keys(specials).join('|') + ')');\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n  init(str, options) {\n    this.values = options.values;\n    this.sp();\n  },\n\n  postProcess(result) {\n    if (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n      return null;\n    }\n\n    return { value: result[0].v };\n  },\n\n  converters: [\n    function getPlaceholder(parser) {\n      if (!parser.values) return null;\n\n      const placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n      if (placeholder && hasOwn(parser.values, placeholder)) {\n        return { v: parser.values[placeholder] };\n      }\n    },\n\n    function getSpecial(parser) {\n      const special = parser.matchPattern(specialsPattern);\n      if (special) return { v: specials[special] };\n    },\n\n    function getNumber(parser) {\n      const number = parser.matchPattern(numberPattern);\n      if (number) return { v: +number };\n    },\n\n    function getString(parser) {\n      const stringLiteral = readStringLiteral(parser);\n      const values = parser.values;\n\n      if (stringLiteral && values) {\n        return {\n          v: stringLiteral.v.replace(\n            placeholderPattern,\n            (match, $1) => ($1 in values ? values[$1] : $1)\n          )\n        };\n      }\n\n      return stringLiteral;\n    },\n\n    function getObject(parser) {\n      if (!parser.matchString('{')) return null;\n\n      const result = {};\n\n      parser.sp();\n\n      if (parser.matchString('}')) {\n        return { v: result };\n      }\n\n      let pair;\n      while ((pair = getKeyValuePair(parser))) {\n        result[pair.key] = pair.value;\n\n        parser.sp();\n\n        if (parser.matchString('}')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n      }\n\n      return null;\n    },\n\n    function getArray(parser) {\n      if (!parser.matchString('[')) return null;\n\n      const result = [];\n\n      parser.sp();\n\n      if (parser.matchString(']')) {\n        return { v: result };\n      }\n\n      let valueToken;\n      while ((valueToken = parser.read())) {\n        result.push(valueToken.v);\n\n        parser.sp();\n\n        if (parser.matchString(']')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n\n        parser.sp();\n      }\n\n      return null;\n    }\n  ]\n});\n\nfunction getKeyValuePair(parser) {\n  parser.sp();\n\n  const key = readKey(parser);\n\n  if (!key) return null;\n\n  const pair = { key };\n\n  parser.sp();\n  if (!parser.matchString(':')) {\n    return null;\n  }\n  parser.sp();\n\n  const valueToken = parser.read();\n\n  if (!valueToken) return null;\n\n  pair.value = valueToken.v;\n  return pair;\n}\n\nexport default function(str, values) {\n  const parser = new JsonParser(str, { values });\n  return parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isArray, isObjectType, isString } from 'utils/is';\n\nexport default class Mapping extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = this.element.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.element.attributeByName[this.name] = this;\n\n    this.value = options.template.f;\n  }\n\n  bind() {\n    const template = this.template.f;\n    const viewmodel = this.element.instance.viewmodel;\n\n    if (template === 0) {\n      // empty attributes are `true`\n      viewmodel.joinKey(this.name).set(true);\n    } else if (isString(template)) {\n      const parsed = parseJSON(template);\n      viewmodel.joinKey(this.name).set(parsed ? parsed.value : template);\n    } else if (isArray(template)) {\n      createMapping(this, true);\n    }\n  }\n\n  render() {}\n\n  unbind() {\n    if (this.model) this.model.unregister(this);\n    if (this.boundFragment) this.boundFragment.unbind();\n\n    if (this.element.bound) {\n      if (this.link.target === this.model) this.link.owner.unlink();\n    }\n  }\n\n  unrender() {}\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.boundFragment) this.boundFragment.update();\n    }\n  }\n}\n\nfunction createMapping(item) {\n  const template = item.template.f;\n  const viewmodel = item.element.instance.viewmodel;\n  const childData = viewmodel.value;\n\n  if (template.length === 1 && template[0].t === INTERPOLATOR) {\n    const model = resolve(item.up, template[0]);\n    const val = model.get(false);\n\n    // if the interpolator is not static\n    if (!template[0].s) {\n      item.model = model;\n      item.link = viewmodel.createLink(item.name, model, template[0].r, {\n        mapping: true\n      });\n\n      // initialize parent side of the mapping from child data\n      if (val === undefined && !model.isReadonly && item.name in childData) {\n        model.set(childData[item.name]);\n      }\n    } else if (!isObjectType(val) || template[0].x) {\n      // copy non-object, non-computed vals through\n      viewmodel.joinKey(splitKeypath(item.name)).set(val);\n    } else {\n      // warn about trying to copy an object\n      warnIfDebug(`Cannot copy non-computed object value from static mapping '${item.name}'`);\n    }\n\n    // if the item isn't going to manage the model, give it a change to tear down if it's computed\n    if (model !== item.model) model.unregister();\n  } else {\n    item.boundFragment = new Fragment({\n      owner: item,\n      template\n    }).bind();\n\n    item.model = viewmodel.joinKey(splitKeypath(item.name));\n    item.model.set(item.boundFragment.valueOf());\n\n    // item is a *bit* of a hack\n    item.boundFragment.bubble = () => {\n      Fragment.prototype.bubble.call(item.boundFragment);\n      // defer this to avoid mucking around model deps if there happens to be an expression involved\n      runloop.scheduleTask(() => {\n        item.boundFragment.update();\n        item.model.set(item.boundFragment.valueOf());\n      });\n    };\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Element from '../../Element';\nimport findElement from '../../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class Option extends Element {\n  constructor(options) {\n    const template = options.template;\n    if (!template.a) template.a = {};\n\n    // If the value attribute is missing, use the element's content,\n    // as long as it isn't disabled\n    if (template.a.value === undefined && !('disabled' in template.a)) {\n      template.a.value = template.f || '';\n    }\n\n    super(options);\n\n    this.select = findElement(this.parent || this.up, false, 'select');\n  }\n\n  bind() {\n    if (!this.select) {\n      super.bind();\n      return;\n    }\n\n    // If the select has a value, it overrides the `selected` attribute on\n    // this option - so we delete the attribute\n    const selectedAttribute = this.attributeByName.selected;\n    if (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n      const index = this.attributes.indexOf(selectedAttribute);\n      this.attributes.splice(index, 1);\n      delete this.attributeByName.selected;\n    }\n\n    super.bind();\n    this.select.options.push(this);\n  }\n\n  bubble() {\n    // if we're using content as value, may need to update here\n    const value = this.getAttribute('value');\n    if (this.node && this.node.value !== value) {\n      this.node._ractive.value = value;\n    }\n    super.bubble();\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute\n      ? attribute.getValue()\n      : name === 'value' && this.fragment ? this.fragment.valueOf() : undefined;\n  }\n\n  isSelected() {\n    const optionValue = this.getAttribute('value');\n\n    if (optionValue === undefined || !this.select) {\n      return false;\n    }\n\n    const selectValue = this.select.getAttribute('value');\n\n    if (this.select.compare(selectValue, optionValue)) {\n      return true;\n    }\n\n    if (this.select.getAttribute('multiple') && isArray(selectValue)) {\n      let i = selectValue.length;\n      while (i--) {\n        if (this.select.compare(selectValue[i], optionValue)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n\n    if (!this.attributeByName.value) {\n      this.node._ractive.value = this.getAttribute('value');\n    }\n  }\n\n  unbind() {\n    super.unbind();\n\n    if (this.select) {\n      removeFromArray(this.select.options, this);\n    }\n  }\n}\n","import { ELEMENT, PARTIAL, SECTION, SECTION_WITH, YIELDER } from 'config/types';\nimport { assign, create, hasOwn, keys } from 'utils/object';\nimport { isArray, isFunction, isObjectType, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport { resolveAliases } from './Alias';\nimport { warnOnceIfDebug, warnIfDebug } from 'utils/log';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport runloop from 'src/global/runloop';\nimport { applyCSS } from 'src/global/css';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Partial(options) {\n  MustacheContainer.call(this, options);\n\n  const tpl = options.template;\n\n  // yielder is a special form of partial that will later require special handling\n  if (tpl.t === YIELDER) {\n    this.yielder = 1;\n  } else if (tpl.t === ELEMENT) {\n    // this is a macro partial, complete with macro constructor\n    // leaving this as an element will confuse up-template searches\n    this.type = PARTIAL;\n    this.macro = options.macro;\n  }\n}\n\nconst proto = (Partial.prototype = create(MustacheContainer.prototype));\n\nassign(proto, {\n  constructor: Partial,\n\n  bind() {\n    const template = this.template;\n\n    if (this.yielder) {\n      // the container is the instance that owns this node\n      this.container = this.up.ractive;\n      this.component = this.container.component;\n      this.containerFragment = this.up;\n\n      // normal component\n      if (this.component) {\n        // yields skip the owning instance and go straight to the surrounding context\n        this.up = this.component.up;\n\n        // {{yield}} is equivalent to {{yield content}}\n        if (!template.r && !template.x && !template.tx) this.refName = 'content';\n      } else {\n        // plain-ish instance that may be attached to a parent later\n        this.fragment = new Fragment({\n          owner: this,\n          template: []\n        });\n        this.fragment.bind();\n        return;\n      }\n    }\n\n    // this is a macro/super partial\n    if (this.macro) {\n      this.fn = this.macro;\n    } else {\n      // this is a plain partial or yielder\n      if (!this.refName) this.refName = template.r;\n\n      // if the refName exists as a partial, this is a plain old partial reference where no model binding will happen\n      if (this.refName) {\n        partialFromValue(this, this.refName);\n      }\n\n      // this is a dynamic/inline partial\n      if (!this.partial && !this.fn) {\n        MustacheContainer.prototype.bind.call(this);\n        if (this.model) partialFromValue(this, this.model.get());\n      }\n    }\n\n    if (!this.partial && !this.fn) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    createFragment(this, this.partial || []);\n\n    // macro/super partial\n    if (this.fn) initMacro(this);\n\n    this.fragment.bind();\n  },\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.yielder) {\n        this.containerFragment.bubble();\n      } else {\n        this.up.bubble();\n      }\n    }\n  },\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  },\n\n  handleChange() {\n    this.dirtyTemplate = true;\n    this.externalChange = true;\n    this.bubble();\n  },\n\n  refreshAttrs() {\n    keys(this._attrs).forEach(k => {\n      this.handle.attributes[k] = this._attrs[k].valueOf();\n    });\n  },\n\n  resetTemplate() {\n    if (this.fn && this.proxy) {\n      if (this.externalChange) {\n        if (isFunction(this.proxy.teardown)) this.proxy.teardown();\n        this.fn = this.proxy = null;\n      } else {\n        this.partial = this.fnTemplate;\n        return true;\n      }\n    }\n\n    const partial = this.partial;\n    this.partial = null;\n\n    if (this.refName) {\n      this.partial = getPartialTemplate(this.ractive, this.refName, this.up);\n    }\n\n    if (!this.partial && this.model) {\n      partialFromValue(this, this.model.get());\n    }\n\n    if (!this.fn && partial === this.partial) return false;\n\n    this.unbindAttrs();\n\n    if (this.fn) {\n      initMacro(this);\n      if (isFunction(this.proxy.render)) runloop.scheduleTask(() => this.proxy.render());\n    } else if (!this.partial) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    return true;\n  },\n\n  render(target, occupants) {\n    if (this.fn && this.fn._cssDef && !this.fn._cssDef.applied) applyCSS();\n\n    this.fragment.render(target, occupants);\n\n    if (this.proxy && isFunction(this.proxy.render)) this.proxy.render();\n  },\n\n  unbind() {\n    this.fragment.unbind();\n\n    this.fragment.aliases = null;\n\n    this.unbindAttrs();\n\n    MustacheContainer.prototype.unbind.call(this);\n  },\n\n  unbindAttrs() {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => {\n        this._attrs[k].unbind();\n      });\n    }\n  },\n\n  unrender(shouldDestroy) {\n    if (this.proxy && isFunction(this.proxy.teardown)) this.proxy.teardown();\n\n    this.fragment.unrender(shouldDestroy);\n  },\n\n  update() {\n    const proxy = this.proxy;\n    this.updating = 1;\n\n    if (this.dirtyAttrs) {\n      this.dirtyAttrs = false;\n      keys(this._attrs).forEach(k => this._attrs[k].update());\n      this.refreshAttrs();\n      if (isFunction(proxy.update)) proxy.update(this.handle.attributes);\n    }\n\n    if (this.dirtyTemplate) {\n      this.dirtyTemplate = false;\n      this.resetTemplate() && this.fragment.resetTemplate(this.partial || []);\n    }\n\n    if (this.dirty) {\n      this.dirty = false;\n      if (proxy && isFunction(proxy.invalidate)) proxy.invalidate();\n      this.fragment.update();\n    }\n\n    this.externalChange = false;\n    this.updating = 0;\n  }\n});\n\nfunction createFragment(self, partial) {\n  self.partial = partial;\n  contextifyTemplate(self);\n\n  const options = {\n    owner: self,\n    template: self.partial\n  };\n\n  if (self.yielder) options.ractive = self.container.parent;\n\n  if (self.fn) options.cssIds = self.fn._cssIds;\n\n  const fragment = (self.fragment = new Fragment(options));\n\n  // partials may have aliases that need to be in place before binding\n  if (self.template.z) {\n    fragment.aliases = resolveAliases(self.template.z, self.containerFragment || self.up);\n  }\n}\n\nfunction contextifyTemplate(self) {\n  if (self.template.c) {\n    self.partial = [{ t: SECTION, n: SECTION_WITH, f: self.partial }];\n    assign(self.partial[0], self.template.c);\n  }\n}\n\nfunction partialFromValue(self, value, okToParse) {\n  let tpl = value;\n\n  if (isArray(tpl)) {\n    self.partial = tpl;\n  } else if (tpl && isObjectType(tpl)) {\n    if (isArray(tpl.t)) self.partial = tpl.t;\n    else if (isString(tpl.template))\n      self.partial = parsePartial(tpl.template, tpl.template, self.ractive).t;\n  } else if (isFunction(tpl) && tpl.styleSet) {\n    self.fn = tpl;\n    if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n  } else if (tpl != null) {\n    tpl = getPartialTemplate(self.ractive, '' + tpl, self.containerFragment || self.up);\n    if (tpl) {\n      self.name = value;\n      if (tpl.styleSet) {\n        self.fn = tpl;\n        if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n      } else self.partial = tpl;\n    } else if (okToParse) {\n      self.partial = parsePartial('' + value, '' + value, self.ractive).t;\n    } else {\n      self.name = value;\n    }\n  }\n\n  return self.partial;\n}\n\nfunction setTemplate(template) {\n  partialFromValue(this, template, true);\n\n  if (!this.initing) {\n    this.dirtyTemplate = true;\n    this.fnTemplate = this.partial;\n\n    if (this.updating) {\n      this.bubble();\n      runloop.promise();\n    } else {\n      const promise = runloop.start();\n\n      this.bubble();\n      runloop.end();\n\n      return promise;\n    }\n  }\n}\n\nfunction aliasLocal(ref, name) {\n  const aliases = this.fragment.aliases || (this.fragment.aliases = {});\n  if (!name) {\n    aliases[ref] = this._data;\n  } else {\n    aliases[name] = this._data.joinAll(splitKeypath(ref));\n  }\n}\n\nconst extras = 'extra-attributes';\n\nfunction initMacro(self) {\n  const fn = self.fn;\n  const fragment = self.fragment;\n\n  // defensively copy the template in case it changes\n  const template = (self.template = assign({}, self.template));\n  const handle = (self.handle = fragment.getContext({\n    proxy: self,\n    aliasLocal,\n    name: self.template.e || self.name,\n    attributes: {},\n    setTemplate: setTemplate.bind(self),\n    template\n  }));\n\n  if (!template.p) template.p = {};\n  template.p = handle.partials = assign({}, template.p);\n  if (!hasOwn(template.p, 'content')) template.p.content = template.f || [];\n\n  if (isArray(fn.attributes)) {\n    self._attrs = {};\n\n    const invalidate = function() {\n      this.dirty = true;\n      self.dirtyAttrs = true;\n      self.bubble();\n    };\n\n    if (isArray(template.m)) {\n      const attrs = template.m;\n      template.p[extras] = template.m = attrs.filter(a => !~fn.attributes.indexOf(a.n));\n      attrs.filter(a => ~fn.attributes.indexOf(a.n)).forEach(a => {\n        const fragment = new Fragment({\n          template: a.f,\n          owner: self\n        });\n        fragment.bubble = invalidate;\n        fragment.findFirstNode = noop;\n        self._attrs[a.n] = fragment;\n      });\n    } else {\n      template.p[extras] = [];\n    }\n  } else {\n    template.p[extras] = template.m;\n  }\n\n  if (self._attrs) {\n    keys(self._attrs).forEach(k => {\n      self._attrs[k].bind();\n    });\n    self.refreshAttrs();\n  }\n\n  self.initing = 1;\n  self.proxy = fn(handle, handle.attributes) || {};\n  if (!self.partial) self.partial = [];\n  self.fnTemplate = self.partial;\n  self.initing = 0;\n\n  contextifyTemplate(self);\n  fragment.resetTemplate(self.partial);\n}\n\nfunction parsePartial(name, partial, ractive) {\n  let parsed;\n\n  try {\n    parsed = parser.parse(partial, parser.getParseOptions(ractive));\n  } catch (e) {\n    warnIfDebug(`Could not parse partial from expression '${name}'\\n${e.message}`);\n  }\n\n  return parsed || { t: [] };\n}\n","import { addToArray, removeFromArray } from 'utils/array';\nimport { unescapeKey } from 'shared/keypaths';\nimport { capture } from 'src/global/capture';\nimport { handleChange } from 'src/shared/methodCallers';\nimport noop from 'utils/noop';\n\nexport default class KeyModel {\n  constructor(key) {\n    this.value = key;\n    this.isReadonly = this.isKey = true;\n    this.deps = [];\n    this.links = [];\n  }\n\n  applyValue(value) {\n    if (value !== this.value) {\n      this.value = this.key = value;\n      this.deps.forEach(handleChange);\n      this.links.forEach(handleChange);\n    }\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return unescapeKey(this.value);\n  }\n\n  getKeypath() {\n    return unescapeKey(this.value);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebind(next, previous) {\n    let i = this.deps.length;\n    while (i--) this.deps[i].rebind(next, previous, false);\n\n    i = this.links.length;\n    while (i--) this.links[i].relinking(next, false);\n  }\n\n  register(dependant) {\n    this.deps.push(dependant);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  unregister(dependant) {\n    removeFromArray(this.deps, dependant);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { escapeKey } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport { isArray, isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { create, keys } from 'utils/object';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n  constructor(ractive, baseModel, keys, callback, options) {\n    this.context = options.context || ractive;\n    this.ractive = ractive;\n    this.baseModel = baseModel;\n    this.keys = keys;\n    this.callback = callback;\n\n    const pattern = keys.join('\\\\.').replace(star, '(.+)');\n    const baseKeypath = (this.baseKeypath = baseModel.getKeypath(ractive));\n    this.pattern = new RegExp(`^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$`);\n    this.recursive = keys.length === 1 && keys[0] === '**';\n    if (this.recursive) this.keys = ['*'];\n    if (options.old) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    this.oldValues = {};\n    this.newValues = {};\n\n    this.defer = options.defer;\n    this.once = options.once;\n    this.strict = options.strict;\n\n    this.dirty = false;\n    this.changed = [];\n    this.partial = false;\n    this.links = options.links;\n\n    const models = baseModel.findMatches(this.keys);\n\n    models.forEach(model => {\n      this.newValues[model.getKeypath(this.ractive)] = model.get();\n    });\n\n    if (options.init !== false) {\n      this.dispatch();\n    } else {\n      updateOld(this, this.newValues);\n    }\n\n    baseModel.registerPatternObserver(this);\n  }\n\n  cancel() {\n    this.baseModel.unregisterPatternObserver(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    const newValues = this.newValues;\n    this.newValues = {};\n    keys(newValues).forEach(keypath => {\n      const newValue = newValues[keypath];\n      const oldValue = this.oldValues[keypath];\n\n      if (this.strict && newValue === oldValue) return;\n      if (isEqual(newValue, oldValue)) return;\n\n      let args = [newValue, oldValue, keypath];\n      if (keypath) {\n        const wildcards = this.pattern.exec(keypath);\n        if (wildcards) {\n          args = args.concat(wildcards.slice(1));\n        }\n      }\n\n      this.callback.apply(this.context, args);\n    });\n\n    updateOld(this, newValues, this.partial);\n\n    this.dirty = false;\n  }\n\n  notify(key) {\n    this.changed.push(key);\n  }\n\n  shuffle(newIndices) {\n    if (!isArray(this.baseModel.value)) return;\n\n    const max = this.baseModel.value.length;\n\n    for (let i = 0; i < newIndices.length; i++) {\n      if (newIndices[i] === -1 || newIndices[i] === i) continue;\n      this.changed.push([i]);\n    }\n\n    for (let i = newIndices.touchedFrom; i < max; i++) {\n      this.changed.push([i]);\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty || this.changed.length) {\n      if (!this.dirty) this.newValues = {};\n\n      if (!this.changed.length) {\n        this.baseModel.findMatches(this.keys).forEach(model => {\n          const keypath = model.getKeypath(this.ractive);\n          this.newValues[keypath] = model.get();\n        });\n        this.partial = false;\n      } else {\n        let count = 0;\n\n        if (this.recursive) {\n          this.changed.forEach(keys => {\n            const model = this.baseModel.joinAll(keys);\n            if (model.isLink && !this.links) return;\n            count++;\n            this.newValues[model.getKeypath(this.ractive)] = model.get();\n          });\n        } else {\n          const ok = this.baseModel.isRoot\n            ? this.changed.map(keys => keys.map(escapeKey).join('.'))\n            : this.changed.map(keys => this.baseKeypath + '.' + keys.map(escapeKey).join('.'));\n\n          this.baseModel.findMatches(this.keys).forEach(model => {\n            const keypath = model.getKeypath(this.ractive);\n            const check = k => {\n              return (\n                (k.indexOf(keypath) === 0 &&\n                  (k.length === keypath.length || k[keypath.length] === '.')) ||\n                (keypath.indexOf(k) === 0 &&\n                  (k.length === keypath.length || keypath[k.length] === '.'))\n              );\n            };\n\n            // is this model on a changed keypath?\n            if (ok.filter(check).length) {\n              count++;\n              this.newValues[keypath] = model.get();\n            }\n          });\n        }\n\n        // no valid change triggered, so bail to avoid breakage\n        if (!count) return;\n\n        this.partial = true;\n      }\n\n      runloop.addObserver(this, this.defer);\n      this.dirty = true;\n      this.changed.length = 0;\n\n      if (this.once) this.cancel();\n    }\n  }\n}\n\nfunction updateOld(observer, vals, partial) {\n  const olds = observer.oldValues;\n\n  if (observer.oldFn) {\n    if (!partial) observer.oldValues = {};\n\n    keys(vals).forEach(k => {\n      const args = [olds[k], vals[k], k];\n      const parts = observer.pattern.exec(k);\n      if (parts) {\n        args.push.apply(args, parts.slice(1));\n      }\n      observer.oldValues[k] = observer.oldFn.apply(observer.oldContext, args);\n    });\n  } else {\n    if (partial) {\n      keys(vals).forEach(k => (olds[k] = vals[k]));\n    } else {\n      observer.oldValues = vals;\n    }\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nfunction negativeOne() {\n  return -1;\n}\n\nexport default class ArrayObserver {\n  constructor(ractive, model, callback, options) {\n    this.ractive = ractive;\n    this.model = model;\n    this.keypath = model.getKeypath();\n    this.callback = callback;\n    this.options = options;\n\n    this.pending = null;\n\n    model.register(this);\n\n    if (options.init !== false) {\n      this.sliced = [];\n      this.shuffle([]);\n      this.dispatch();\n    } else {\n      this.sliced = this.slice();\n    }\n  }\n\n  cancel() {\n    this.model.unregister(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    this.callback(this.pending);\n    this.pending = null;\n    if (this.options.once) this.cancel();\n  }\n\n  handleChange(path) {\n    if (this.pending) {\n      // post-shuffle\n      runloop.addObserver(this, this.options.defer);\n    } else if (!path) {\n      // entire array changed\n      this.shuffle(this.sliced.map(negativeOne));\n      this.handleChange();\n    }\n  }\n\n  shuffle(newIndices) {\n    const newValue = this.slice();\n\n    const inserted = [];\n    const deleted = [];\n    let start;\n\n    const hadIndex = {};\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      hadIndex[newIndex] = true;\n\n      if (newIndex !== oldIndex && start === undefined) {\n        start = oldIndex;\n      }\n\n      if (newIndex === -1) {\n        deleted.push(this.sliced[oldIndex]);\n      }\n    });\n\n    if (start === undefined) start = newIndices.length;\n\n    const len = newValue.length;\n    for (let i = 0; i < len; i += 1) {\n      if (!hadIndex[i]) inserted.push(newValue[i]);\n    }\n\n    this.pending = { inserted, deleted, start };\n    this.sliced = newValue;\n  }\n\n  slice() {\n    const value = this.model.get();\n    return isArray(value) ? value.slice() : [];\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { assign } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce(keypath, callback, options) {\n  if (isObject(keypath) || isFunction(keypath)) {\n    options = assign(callback || {}, onceOptions);\n    return this.observe(keypath, options);\n  }\n\n  options = assign(options || {}, onceOptions);\n  return this.observe(keypath, callback, options);\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('pop').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('push').path;\n","import { doc } from '../config/environment';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\nexport function addCSS(styleDefinition) {\n  styleDefinitions.push(styleDefinition);\n  isDirty = true;\n}\n\nexport function applyCSS(force) {\n  const styleElement = style();\n\n  // Apply only seems to make sense when we're in the DOM. Server-side renders\n  // can call toCSS to get the updated CSS.\n  if (!styleElement || (!force && !isDirty)) return;\n\n  if (useCssText) {\n    styleElement.styleSheet.cssText = getCSS(null);\n  } else {\n    styleElement.innerHTML = getCSS(null);\n  }\n\n  isDirty = false;\n}\n\nexport function getCSS(cssIds) {\n  const filteredStyleDefinitions = cssIds\n    ? styleDefinitions.filter(style => ~cssIds.indexOf(style.id))\n    : styleDefinitions;\n\n  filteredStyleDefinitions.forEach(d => (d.applied = true));\n\n  return filteredStyleDefinitions.reduce(\n    (styles, style) => `${styles ? `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}` : ''}`,\n    PREFIX\n  );\n}\n\nfunction style() {\n  // If we're on the browser, additional setup needed.\n  if (doc && !styleElement) {\n    styleElement = doc.createElement('style');\n    styleElement.type = 'text/css';\n    styleElement.setAttribute('data-ractive-css', '');\n\n    doc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n    useCssText = !!styleElement.styleSheet;\n  }\n\n  return styleElement;\n}\n","import { ensureArray, combine } from 'utils/array';\n\nexport default {\n  extend: (Parent, proto, options) => {\n    proto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  },\n\n  init() {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function(css, callback, additionalReplaceRules = []) {\n  const values = [];\n  const reconstruct = css => css.replace(value, (match, n) => values[n]);\n  css = css.replace(escape, match => `\\0${values.push(match) - 1}`).replace(remove, '');\n\n  additionalReplaceRules.forEach(pattern => {\n    css = css.replace(pattern, match => `\\0${values.push(match) - 1}`);\n  });\n\n  return callback(css, reconstruct);\n}\n","import cleanCss from 'utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{)\\s*([^\\{\\}\\0]+)\\s*(?=\\{)/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim(str) {\n  return str.trim();\n}\n\nfunction extractString(unit) {\n  return unit.str;\n}\n\nfunction transformSelector(selector, parent) {\n  const selectorUnits = [];\n  let match;\n\n  while ((match = selectorUnitPattern.exec(selector))) {\n    selectorUnits.push({\n      str: match[0],\n      base: match[1],\n      modifiers: match[2]\n    });\n  }\n\n  // For each simple selector within the selector, we need to create a version\n  // that a) combines with the id, and b) is inside the id\n  const base = selectorUnits.map(extractString);\n\n  const transformed = [];\n  let i = selectorUnits.length;\n\n  while (i--) {\n    const appended = base.slice();\n\n    // Pseudo-selectors should go after the attribute selector\n    const unit = selectorUnits[i];\n    appended[i] = unit.base + parent + unit.modifiers || '';\n\n    const prepended = base.slice();\n    prepended[i] = parent + ' ' + prepended[i];\n\n    transformed.push(appended.join(' '), prepended.join(' '));\n  }\n\n  return transformed.join(', ');\n}\n\nexport default function transformCss(css, id) {\n  const dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n  let transformed;\n\n  if (dataRvcGuidPattern.test(css)) {\n    transformed = css.replace(dataRvcGuidPattern, dataAttr);\n  } else {\n    transformed = cleanCss(\n      css,\n      (css, reconstruct) => {\n        css = css.replace(selectorsPattern, (match, $1) => {\n          // don't transform at-rules and keyframe declarations\n          if (excludePattern.test($1)) return match;\n\n          const selectors = $1.split(',').map(trim);\n          const transformed =\n            selectors.map(selector => transformSelector(selector, dataAttr)).join(', ') + ' ';\n\n          return match.replace($1, transformed);\n        });\n\n        return reconstruct(css);\n      },\n      [keyframesDeclarationPattern]\n    );\n  }\n\n  return transformed;\n}\n","import { SharedModel } from './SharedModel';\nimport { applyChanges } from '../../Ractive/static/styleSet';\n\nexport default class CSSModel extends SharedModel {\n  constructor(component) {\n    super(component.cssData, '@style');\n    this.component = component;\n  }\n\n  downstreamChanged(path, depth) {\n    if (this.locked) return;\n\n    const component = this.component;\n\n    component.extensions.forEach(e => {\n      const model = e._cssModel;\n      model.mark();\n      model.downstreamChanged(path, depth || 1);\n    });\n\n    if (!depth) {\n      applyChanges(component, true);\n    }\n  }\n}\n","import { addCSS, applyCSS } from 'src/global/css';\nimport transformCss from './transform';\nimport { uuid } from 'utils/id';\nimport { warnIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { splitKeypath } from 'shared/keypaths';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperty } from 'utils/object';\nimport { isString, isFunction, isObjectType } from 'utils/is';\n\nconst hasCurly = /\\{/;\nexport default {\n  name: 'css',\n\n  // Called when creating a new component definition\n  extend: (Parent, proto, options, Child) => {\n    Child._cssIds = gatherIds(Parent);\n\n    defineProperty(Child, 'cssData', {\n      configurable: true,\n      value: assign(create(Parent.cssData), options.cssData || {})\n    });\n\n    defineProperty(Child, '_cssModel', {\n      configurable: true,\n      value: new CSSModel(Child)\n    });\n\n    if (options.css) initCSS(options, Child, proto);\n  },\n\n  // Called when creating a new component instance\n  init: (Parent, target, options) => {\n    if (!options.css) return;\n\n    warnIfDebug(`\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t`);\n  }\n};\n\nfunction gatherIds(start) {\n  let cmp = start;\n  const ids = [];\n\n  while (cmp) {\n    if (cmp.prototype.cssId) ids.push(cmp.prototype.cssId);\n    cmp = cmp.Parent;\n  }\n\n  return ids;\n}\n\nexport function evalCSS(component, css) {\n  if (isString(css)) return css;\n\n  const cssData = component.cssData;\n  const model = component._cssModel;\n  const data = function data(path) {\n    return model.joinAll(splitKeypath(path)).get();\n  };\n  data.__proto__ = cssData;\n\n  const result = css.call(component, data);\n  return isString(result) ? result : '';\n}\n\nexport function initCSS(options, target, proto) {\n  let css =\n    options.css === true\n      ? ''\n      : isString(options.css) && !hasCurly.test(options.css)\n        ? getElement(options.css) || options.css\n        : options.css;\n  let cssProp = css;\n\n  const id = options.cssId || uuid();\n\n  if (isObjectType(css)) {\n    css = 'textContent' in css ? css.textContent : css.innerHTML;\n    cssProp = css;\n  } else if (isFunction(css)) {\n    cssProp = css;\n    css = evalCSS(target, css);\n  }\n\n  const def = { transform: !options.noCssTransform };\n\n  defineProperty(target, '_cssDef', { configurable: true, value: def });\n\n  defineProperty(target, 'css', {\n    get() {\n      return cssProp;\n    },\n    set(next) {\n      cssProp = next;\n      const css = evalCSS(target, cssProp);\n      const styles = def.styles;\n      def.styles = def.transform ? transformCss(css, id) : css;\n      if (def.applied && styles !== def.styles) applyCSS(true);\n    }\n  });\n\n  def.styles = def.transform ? transformCss(css, id) : css;\n  def.id = proto.cssId = id;\n  target._cssIds.push(id);\n\n  addCSS(target._cssDef);\n}\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isArray, isObject, isFunction, isObjectType } from 'utils/is';\nimport bind from 'utils/bind';\n\nfunction validate(data) {\n  // Warn if userOptions.data is a non-POJO\n  if (data && data.constructor !== Object) {\n    if (isFunction(data)) {\n      // TODO do we need to support this in the new Ractive() case?\n    } else if (!isObjectType(data)) {\n      fatal(`data option must be an object or a function, \\`${data}\\` is not valid`);\n    } else {\n      warnIfDebug(\n        'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged'\n      );\n    }\n  }\n}\n\nexport default {\n  name: 'data',\n\n  extend: (Parent, proto, options) => {\n    let key;\n    let value;\n\n    // check for non-primitives, which could cause mutation-related bugs\n    if (options.data && isObject(options.data)) {\n      for (key in options.data) {\n        value = options.data[key];\n\n        if (value && isObjectType(value)) {\n          if (isObject(value) || isArray(value)) {\n            warnIfDebug(`Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }`);\n          }\n        }\n      }\n    }\n\n    proto.data = combine(proto.data, options.data);\n  },\n\n  init: (Parent, ractive, options) => {\n    let result = combine(Parent.prototype.data, options.data);\n\n    if (isFunction(result)) result = result.call(ractive);\n\n    // bind functions to the ractive instance at the top level,\n    // unless it's a non-POJO (in which case alarm bells should ring)\n    if (result && result.constructor === Object) {\n      for (const prop in result) {\n        if (isFunction(result[prop])) {\n          const value = result[prop];\n          result[prop] = bind(value, ractive);\n          result[prop]._r_unbound = value;\n        }\n      }\n    }\n\n    return result || {};\n  },\n\n  reset(ractive) {\n    const result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n    ractive.viewmodel.root.set(result);\n    return true;\n  }\n};\n\nfunction emptyData() {\n  return {};\n}\n\nfunction combine(parentValue, childValue) {\n  validate(childValue);\n\n  const parentIsFn = isFunction(parentValue);\n\n  // Very important, otherwise child instance can become\n  // the default data object on Ractive or a component.\n  // then ractive.set() ends up setting on the prototype!\n  if (!childValue && !parentIsFn) {\n    // this needs to be a function so that it can still inherit parent defaults\n    childValue = emptyData;\n  }\n\n  const childIsFn = isFunction(childValue);\n\n  // Fast path, where we just need to copy properties from\n  // parent to child\n  if (!parentIsFn && !childIsFn) {\n    return fromProperties(childValue, parentValue);\n  }\n\n  return function() {\n    const child = childIsFn ? callDataFunction(childValue, this) : childValue;\n    const parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n    return fromProperties(child, parent);\n  };\n}\n\nfunction callDataFunction(fn, context) {\n  const data = fn.call(context);\n\n  if (!data) return;\n\n  if (!isObjectType(data)) {\n    fatal('Data function must return an object');\n  }\n\n  if (data.constructor !== Object) {\n    warnOnceIfDebug(\n      'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged'\n    );\n  }\n\n  return data;\n}\n\nfunction fromProperties(primary, secondary) {\n  if (primary && secondary) {\n    for (const key in secondary) {\n      if (!(key in primary)) {\n        primary[key] = secondary[key];\n      }\n    }\n\n    return primary;\n  }\n\n  return primary || secondary;\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { addFunctions } from 'shared/getFunction';\nimport parser from '../runtime-parser';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isNumber, isString } from 'utils/is';\n\nexport default {\n  name: 'template',\n\n  extend(Parent, proto, options) {\n    // only assign if exists\n    if ('template' in options) {\n      const template = options.template;\n\n      if (isFunction(template)) {\n        proto.template = template;\n      } else {\n        proto.template = parseTemplate(template, proto);\n      }\n    }\n  },\n\n  init(Parent, ractive, options) {\n    // TODO because of prototypal inheritance, we might just be able to use\n    // ractive.template, and not bother passing through the Parent object.\n    // At present that breaks the test mocks' expectations\n    let template = 'template' in options ? options.template : Parent.prototype.template;\n    template = template || { v: TEMPLATE_VERSION, t: [] };\n\n    if (isFunction(template)) {\n      const fn = template;\n      template = getDynamicTemplate(ractive, fn);\n\n      ractive._config.template = {\n        fn,\n        result: template\n      };\n    }\n\n    template = parseTemplate(template, ractive);\n\n    // TODO the naming of this is confusing - ractive.template refers to [...],\n    // but Component.prototype.template refers to {v:1,t:[],p:[]}...\n    // it's unnecessary, because the developer never needs to access\n    // ractive.template\n    ractive.template = template.t;\n\n    if (template.p) {\n      extendPartials(ractive.partials, template.p);\n    }\n  },\n\n  reset(ractive) {\n    const result = resetValue(ractive);\n\n    if (result) {\n      const parsed = parseTemplate(result, ractive);\n\n      ractive.template = parsed.t;\n      extendPartials(ractive.partials, parsed.p, true);\n\n      return true;\n    }\n  }\n};\n\nfunction resetValue(ractive) {\n  const initial = ractive._config.template;\n\n  // If this isn't a dynamic template, there's nothing to do\n  if (!initial || !initial.fn) {\n    return;\n  }\n\n  const result = getDynamicTemplate(ractive, initial.fn);\n\n  // TODO deep equality check to prevent unnecessary re-rendering\n  // in the case of already-parsed templates\n  if (result !== initial.result) {\n    initial.result = result;\n    return result;\n  }\n}\n\nfunction getDynamicTemplate(ractive, fn) {\n  return fn.call(ractive, {\n    fromId: parser.fromId,\n    isParsed: parser.isParsed,\n    parse(template, options = parser.getParseOptions(ractive)) {\n      return parser.parse(template, options);\n    }\n  });\n}\n\nfunction parseTemplate(template, ractive) {\n  if (isString(template)) {\n    // parse will validate and add expression functions\n    template = parseAsString(template, ractive);\n  } else {\n    // need to validate and add exp for already parsed template\n    validate(template);\n    addFunctions(template);\n  }\n\n  return template;\n}\n\nfunction parseAsString(template, ractive) {\n  // ID of an element containing the template?\n  if (template[0] === '#') {\n    template = parser.fromId(template);\n  }\n\n  return parser.parseFor(template, ractive);\n}\n\nfunction validate(template) {\n  // Check that the template even exists\n  if (template == undefined) {\n    throw new Error(`The template cannot be ${template}.`);\n  } else if (!isNumber(template.v)) {\n    // Check the parsed template has a version at all\n    throw new Error(\n      \"The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.\"\n    );\n  } else if (template.v !== TEMPLATE_VERSION) {\n    // Check we're using the correct version\n    throw new Error(\n      `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${\n        template.v\n      }) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app`\n    );\n  }\n}\n\nfunction extendPartials(existingPartials, newPartials, overwrite) {\n  if (!newPartials) return;\n\n  // TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  // case, but not initially...\n\n  for (const key in newPartials) {\n    if (overwrite || !hasOwn(existingPartials, key)) {\n      existingPartials[key] = newPartials[key];\n    }\n  }\n}\n","import { assign, create, keys } from 'utils/object';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'computed',\n  'decorators',\n  'easing',\n  'events',\n  'helpers',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst registriesOnDefaults = ['computed', 'helpers'];\n\nclass Registry {\n  constructor(name, useDefaults) {\n    this.name = name;\n    this.useDefaults = useDefaults;\n  }\n\n  extend(Parent, proto, options) {\n    const parent = this.useDefaults ? Parent.defaults : Parent;\n    const target = this.useDefaults ? proto : proto.constructor;\n    this.configure(parent, target, options);\n  }\n\n  init() {\n    // noop\n  }\n\n  configure(Parent, target, options) {\n    const name = this.name;\n    const option = options[name];\n\n    const registry = create(Parent[name]);\n\n    assign(registry, option);\n\n    target[name] = registry;\n  }\n\n  reset(ractive) {\n    const registry = ractive[this.name];\n    let changed = false;\n\n    keys(registry).forEach(key => {\n      const item = registry[key];\n\n      if (item._fn) {\n        if (item._fn.isOwner) {\n          registry[key] = item._fn;\n        } else {\n          delete registry[key];\n        }\n        changed = true;\n      }\n    });\n\n    return changed;\n  }\n}\n\nconst registries = registryNames.map(name => {\n  const putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n  return new Registry(name, putInDefaults);\n});\n\nexport default registries;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\nimport { hasOwn, keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nconst config = {\n  extend: (Parent, proto, options, Child) => configure('extend', Parent, proto, options, Child),\n  init: (Parent, ractive, options) => configure('init', Parent, ractive, options),\n  reset: ractive => order.filter(c => c.reset && c.reset(ractive)).map(c => c.name)\n};\n\nconst custom = {\n  adapt: adaptConfigurator,\n  computed: config,\n  css: cssConfigurator,\n  data: dataConfigurator,\n  helpers: config,\n  template: templateConfigurator\n};\n\nconst defaultKeys = keys(defaults);\n\nconst isStandardKey = makeObj(defaultKeys.filter(key => !custom[key]));\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj(\n  defaultKeys.concat(registries.map(r => r.name), ['on', 'observe', 'attributes', 'cssData', 'use'])\n);\n\nconst order = [].concat(\n  defaultKeys.filter(key => !registries[key] && !custom[key]),\n  registries,\n  //custom.data,\n  custom.template,\n  custom.css\n);\n\nfunction configure(method, Parent, target, options, Child) {\n  deprecate(options);\n\n  for (const key in options) {\n    if (hasOwn(isStandardKey, key)) {\n      const value = options[key];\n\n      // warn the developer if they passed a function and ignore its value\n\n      // NOTE: we allow some functions on \"el\" because we duck type element lists\n      // and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n      // function object as the result of querySelector methods\n      if (key !== 'el' && isFunction(value)) {\n        warnIfDebug(\n          `${key} is a Ractive option that does not expect a function and will be ignored`,\n          method === 'init' ? target : null\n        );\n      } else {\n        target[key] = value;\n      }\n    }\n  }\n\n  // disallow combination of `append` and `enhance`\n  if (target.append && target.enhance) {\n    throw new Error('Cannot use append and enhance at the same time');\n  }\n\n  registries.forEach(registry => {\n    registry[method](Parent, target, options, Child);\n  });\n\n  adaptConfigurator[method](Parent, target, options, Child);\n  templateConfigurator[method](Parent, target, options, Child);\n  cssConfigurator[method](Parent, target, options, Child);\n\n  extendOtherMethods(Parent.prototype, target, options);\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods(parent, target, options) {\n  for (const key in options) {\n    if (!isBlacklisted[key] && hasOwn(options, key)) {\n      let member = options[key];\n\n      // if this is a method that overwrites a method, wrap it:\n      if (isFunction(member)) {\n        if (key in RactiveProto && !_super.test(member.toString())) {\n          warnIfDebug(\n            `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.`\n          );\n        }\n        member = wrapPrototype(parent, key, member);\n      }\n\n      target[key] = member;\n    }\n  }\n}\n\nfunction makeObj(array) {\n  const obj = {};\n  array.forEach(x => (obj[x] = true));\n  return obj;\n}\n\nexport default config;\n","import { createDocumentFragment } from 'utils/dom';\nimport noop from 'utils/noop';\n\nexport default class Item {\n  constructor(options) {\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n\n    this.template = options.template;\n    this.index = options.index;\n    this.type = options.template.t;\n\n    this.dirty = false;\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  find() {\n    return null;\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  findNextNode() {\n    return this.up.findNextNode(this);\n  }\n\n  shuffled() {\n    if (this.fragment) this.fragment.shuffled();\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    return this.fragment ? this.fragment.detach() : createDocumentFragment();\n  }\n\n  find(selector) {\n    if (this.fragment) {\n      return this.fragment.find(selector);\n    }\n  }\n\n  findAll(selector, options) {\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findComponent(name) {\n    if (this.fragment) {\n      return this.fragment.findComponent(name);\n    }\n  }\n\n  findAllComponents(name, options) {\n    if (this.fragment) {\n      this.fragment.findAllComponents(name, options);\n    }\n  }\n\n  firstNode(skipParent) {\n    return this.fragment && this.fragment.firstNode(skipParent);\n  }\n\n  toString(escape) {\n    return this.fragment ? this.fragment.toString(escape) : '';\n  }\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { hasOwn } from 'utils/object';\n\nexport default class ComputationChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n\n    this.isReadonly = !this.root.ractive.syncComputedChildren;\n    this.dirty = true;\n  }\n\n  get setRoot() {\n    return this.parent.setRoot;\n  }\n\n  applyValue(value) {\n    super.applyValue(value);\n\n    if (!this.isReadonly) {\n      let source = this.parent;\n      // computed models don't have a shuffle method\n      while (source && source.shuffle) {\n        source = source.parent;\n      }\n\n      if (source) {\n        source.dependencies.forEach(mark);\n      }\n    }\n\n    if (this.setRoot) {\n      this.setRoot.set(this.setRoot.value);\n    }\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const parentValue = this.parent.get();\n      this.value = parentValue ? parentValue[this.key] : undefined;\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    return (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n      ? this.wrapperValue\n      : this.value;\n  }\n\n  handleChange() {\n    this.dirty = true;\n\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n    this.deps.forEach(handleChange);\n    this.children.forEach(handleChange);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ComputationChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from 'src/global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model, { shared } from './Model';\nimport { maybeBind, noVirtual } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from 'config/environment';\nimport { isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nexport default class Computation extends Model {\n  constructor(parent, signature, key) {\n    super(parent, key);\n\n    this.signature = signature;\n\n    this.isReadonly = !this.signature.setter;\n\n    this.dependencies = [];\n\n    this.children = [];\n    this.childByKey = {};\n\n    this.deps = [];\n\n    this.dirty = true;\n\n    // TODO: is there a less hackish way to do this?\n    this.shuffle = undefined;\n  }\n\n  get setRoot() {\n    if (this.signature.setter) return this;\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const old = this.value;\n      this.value = this.getValue();\n      // this may cause a view somewhere to update, so it must be in a runloop\n      if (!runloop.active()) {\n        runloop.start();\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n        runloop.end();\n      } else {\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n      }\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    // if capturing, this value needs to be unwrapped because it's for external use\n    return maybeBind(\n      this,\n      // if unwrap is supplied, it overrides capture\n      this.wrapper && (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture)\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getContext() {\n    return this.parent.isRoot ? this.root.ractive : this.parent.get(false, noVirtual);\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      result = this.signature.getter.call(this.root.ractive, this.getContext());\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n\n      // TODO this is all well and good in Chrome, but...\n      // ...also, should encapsulate this stuff better, and only\n      // show it if Ractive.DEBUG\n      if (hasConsole) {\n        if (console.groupCollapsed)\n          console.groupCollapsed(\n            '%cshow details',\n            'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n          );\n        const sig = this.signature;\n        console.error(\n          `${err.name}: ${err.message}\\n\\n${sig.getterString}${\n            sig.getterUseStack ? '\\n\\n' + err.stack : ''\n          }`\n        );\n        if (console.groupCollapsed) console.groupEnd();\n      }\n    }\n\n    const dependencies = stopCapturing();\n    this.setDependencies(dependencies);\n\n    return result;\n  }\n\n  mark() {\n    this.handleChange();\n  }\n\n  rebind(next, previous) {\n    // computations will grab all of their deps again automagically\n    if (next !== previous) this.handleChange();\n  }\n\n  set(value) {\n    if (this.isReadonly) {\n      throw new Error(`Cannot set read-only computed value '${this.key}'`);\n    }\n\n    this.signature.setter(value);\n    this.mark();\n  }\n\n  setDependencies(dependencies) {\n    // unregister any soft dependencies we no longer have\n    let i = this.dependencies.length;\n    while (i--) {\n      const model = this.dependencies[i];\n      if (!~dependencies.indexOf(model)) model.unregister(this);\n    }\n\n    // and add any new ones\n    i = dependencies.length;\n    while (i--) {\n      const model = dependencies[i];\n      if (!~this.dependencies.indexOf(model)) model.register(this);\n    }\n\n    this.dependencies = dependencies;\n  }\n\n  teardown() {\n    let i = this.dependencies.length;\n    while (i--) {\n      if (this.dependencies[i]) this.dependencies[i].unregister(this);\n    }\n    if (this.parent.computed[this.key] === this) delete this.parent.computed[this.key];\n    super.teardown();\n  }\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n\nshared.Computation = Computation;\n","import { removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport { warnIfDebug } from 'utils/log';\nimport Model from 'src/model/Model';\nimport Computation from 'src/model/Computation';\nimport { startCapturing, stopCapturing } from 'src/global/capture';\nimport getFunction from 'shared/getFunction';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from './resolveReference';\n\nexport default class ExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(fragment.ractive.viewmodel, null);\n\n    this.fragment = fragment;\n    this.template = template;\n\n    this.isReadonly = true;\n    this.dirty = true;\n\n    this.fn =\n      fragment.ractive.allowExpressions === false\n        ? noop\n        : getFunction(template.s, template.r.length);\n\n    this.models = this.template.r.map(ref => {\n      return resolveReference(this.fragment, ref);\n    });\n    this.dependencies = [];\n\n    this.shuffle = undefined;\n\n    this.bubble();\n  }\n\n  bubble(actuallyChanged = true) {\n    // refresh the keypath\n    this.keypath = undefined;\n\n    if (actuallyChanged) {\n      this.handleChange();\n    }\n  }\n\n  getKeypath() {\n    if (!this.template) return '@undefined';\n    if (!this.keypath) {\n      this.keypath =\n        '@' +\n        this.template.s.replace(/_(\\d+)/g, (match, i) => {\n          if (i >= this.models.length) return match;\n\n          const model = this.models[i];\n          return model ? model.getKeypath() : '@undefined';\n        });\n    }\n\n    return this.keypath;\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      const params = this.models.map(m => (m ? m.get(true) : undefined));\n      result = this.fn.apply(this.fragment.ractive, params);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n    }\n\n    const dependencies = stopCapturing();\n    // remove missing deps\n    this.dependencies.filter(d => !~dependencies.indexOf(d)).forEach(d => {\n      d.unregister(this);\n      removeFromArray(this.dependencies, d);\n    });\n    // register new deps\n    dependencies.filter(d => !~this.dependencies.indexOf(d)).forEach(d => {\n      d.register(this);\n      this.dependencies.push(d);\n    });\n\n    return result;\n  }\n\n  notifyUpstream() {}\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n\n    if (~idx) {\n      next = rebindMatch(this.template.r[idx], next, previous);\n      if (next !== previous) {\n        previous.unregister(this);\n        this.models.splice(idx, 1, next);\n        if (next) next.addShuffleRegister(this, 'mark');\n      }\n    }\n    this.bubble(!safe);\n  }\n\n  retrieve() {\n    return this.get();\n  }\n\n  teardown() {\n    this.fragment = undefined;\n    if (this.dependencies) this.dependencies.forEach(d => d.unregister(this));\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n","import { fireShuffleTasks } from 'src/model/ModelBase';\nimport { REFERENCE } from 'config/types';\nimport { rebindMatch } from 'shared/rebind';\nimport { isArray, isString } from 'utils/is';\nimport { escapeKey } from 'shared/keypaths';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\n\nimport LinkModel, { Missing } from 'src/model/LinkModel';\n\nexport default class ReferenceExpressionProxy extends LinkModel {\n  constructor(fragment, template) {\n    super(null, null, null, '@undefined');\n    this.root = fragment.ractive.viewmodel;\n    this.template = template;\n    this.rootLink = true;\n\n    let base = resolve(fragment, template);\n    let idx;\n\n    const proxy = (this.proxy = {\n      rebind: (next, previous) => {\n        if (previous === base) {\n          next = rebindMatch(template, next, previous);\n          if (next !== base) {\n            base = next;\n          }\n        } else if (~(idx = members.indexOf(previous))) {\n          next = rebindMatch(template.m[idx].n, next, previous);\n          if (next !== members[idx]) {\n            members.splice(idx, 1, next || Missing);\n          }\n        }\n\n        if (next !== previous) previous.unregister(proxy);\n        if (next) next.addShuffleTask(() => next.register(proxy));\n      },\n      handleChange: () => {\n        pathChanged();\n      }\n    });\n\n    base.register(proxy);\n\n    const members = template.m.map(tpl => {\n      if (isString(tpl)) {\n        return { get: () => tpl };\n      }\n\n      let model;\n\n      if (tpl.t === REFERENCE) {\n        model = resolveReference(fragment, tpl.n);\n        model.register(proxy);\n\n        return model;\n      }\n\n      model = new ExpressionProxy(fragment, tpl);\n      model.register(proxy);\n      return model;\n    });\n\n    const pathChanged = () => {\n      const model = base.joinAll(\n        members.reduce((list, m) => {\n          const k = m.get();\n          if (isArray(k)) return list.concat(k);\n          else list.push(escapeKey(String(k)));\n          return list;\n        }, [])\n      );\n\n      if (model !== this.model) {\n        this.model = model;\n        this.relinking(model);\n        fireShuffleTasks();\n        refreshPathDeps(this);\n      }\n    };\n\n    pathChanged();\n  }\n\n  getKeypath() {\n    return this.model ? this.model.getKeypath() : '@undefined';\n  }\n}\n\nfunction refreshPathDeps(proxy) {\n  let len = proxy.deps.length;\n  let i, v;\n\n  for (i = 0; i < len; i++) {\n    v = proxy.deps[i];\n    if (v.pathChanged) v.pathChanged();\n    if (v.fragment && v.fragment.pathModel) v.fragment.pathModel.applyValue(proxy.getKeypath());\n  }\n\n  len = proxy.children.length;\n  for (i = 0; i < len; i++) {\n    refreshPathDeps(proxy.children[i]);\n  }\n}\n","import Fragment from '../Fragment';\nimport { ContainerItem } from './shared/Item';\nimport resolve from '../resolvers/resolve';\n\nexport function resolveAliases(aliases, fragment) {\n  const resolved = {};\n\n  for (let i = 0; i < aliases.length; i++) {\n    resolved[aliases[i].n] = resolve(fragment, aliases[i].x);\n  }\n\n  for (const k in resolved) {\n    resolved[k].reference();\n  }\n\n  return resolved;\n}\n\nexport default class Alias extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.fragment = null;\n  }\n\n  bind() {\n    this.fragment = new Fragment({\n      owner: this,\n      template: this.template.f\n    });\n\n    this.fragment.aliases = resolveAliases(this.template.z, this.up);\n    this.fragment.bind();\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  unbind() {\n    for (const k in this.fragment.aliases) {\n      this.fragment.aliases[k].unreference();\n    }\n\n    this.fragment.aliases = {};\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      this.fragment.update();\n    }\n  }\n}\n","import cleanCss from 'utils/cleanCss';\nimport { isString } from 'utils/is';\n\nconst space = /\\s+/;\n\nexport function readStyle(css) {\n  if (!isString(css)) return {};\n\n  return cleanCss(css, (css, reconstruct) => {\n    return css\n      .split(';')\n      .filter(rule => !!rule.trim())\n      .map(reconstruct)\n      .reduce((rules, rule) => {\n        const i = rule.indexOf(':');\n        const name = rule.substr(0, i).trim();\n        rules[name] = rule.substr(i + 1).trim();\n        return rules;\n      }, {});\n  });\n}\n\nexport function readClass(str) {\n  const list = str.split(space);\n\n  // remove any empty entries\n  let i = list.length;\n  while (i--) {\n    if (!list[i]) list.splice(i, 1);\n  }\n\n  return list;\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport noop from 'utils/noop';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport { readStyle, readClass } from 'src/view/helpers/specialAttrs';\nimport { keys as objectKeys } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nconst textTypes = [\n  undefined,\n  'text',\n  'search',\n  'url',\n  'email',\n  'hidden',\n  'password',\n  'search',\n  'reset',\n  'submit'\n];\n\nexport default function getUpdateDelegate(attribute) {\n  const { element, name } = attribute;\n\n  if (name === 'value') {\n    if (attribute.interpolator) attribute.interpolator.bound = true;\n\n    // special case - selects\n    if (element.name === 'select' && name === 'value') {\n      return element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n    }\n\n    if (element.name === 'textarea') return updateStringValue;\n\n    // special case - contenteditable\n    if (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n    // special case - <input>\n    if (element.name === 'input') {\n      const type = element.getAttribute('type');\n\n      // type='file' value='{{fileList}}'>\n      if (type === 'file') return noop; // read-only\n\n      // type='radio' name='{{twoway}}'\n      if (type === 'radio' && element.binding && element.binding.attribute.name === 'name')\n        return updateRadioValue;\n\n      if (~textTypes.indexOf(type)) return updateStringValue;\n    }\n\n    return updateValue;\n  }\n\n  const node = element.node;\n\n  // special case - <input type='radio' name='{{twoway}}' value='foo'>\n  if (attribute.isTwoway && name === 'name') {\n    if (node.type === 'radio') return updateRadioName;\n    if (node.type === 'checkbox') return updateCheckboxName;\n  }\n\n  if (name === 'style') return updateStyleAttribute;\n\n  if (name.indexOf('style-') === 0) return updateInlineStyle;\n\n  // special case - class names. IE fucks things up, again\n  if (name === 'class' && (!node.namespaceURI || node.namespaceURI === html))\n    return updateClassName;\n\n  if (name.indexOf('class-') === 0) return updateInlineClass;\n\n  if (attribute.isBoolean) {\n    const type = element.getAttribute('type');\n    if (attribute.interpolator && name === 'checked' && (type === 'checkbox' || type === 'radio'))\n      attribute.interpolator.bound = true;\n    return updateBoolean;\n  }\n\n  if (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI)\n    return updateNamespacedAttribute;\n\n  return updateAttribute;\n}\n\nfunction updateMultipleSelectValue(reset) {\n  let value = this.getValue();\n\n  if (!isArray(value)) value = [value];\n\n  const options = this.node.options;\n  let i = options.length;\n\n  if (reset) {\n    while (i--) options[i].selected = false;\n  } else {\n    while (i--) {\n      const option = options[i];\n      const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n      option.selected = arrayContains(value, optionValue);\n    }\n  }\n}\n\nfunction updateSelectValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    // TODO is locked still a thing?\n    this.node._ractive.value = value;\n\n    const options = this.node.options;\n    let i = options.length;\n    let wasSelected = false;\n\n    if (reset) {\n      while (i--) options[i].selected = false;\n    } else {\n      while (i--) {\n        const option = options[i];\n        const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n        if (option.disabled && option.selected) wasSelected = true;\n\n        if (optionValue == value) {\n          // double equals as we may be comparing numbers with strings\n          option.selected = true;\n          return;\n        }\n      }\n    }\n\n    if (!wasSelected) this.node.selectedIndex = -1;\n  }\n}\n\nfunction updateContentEditableValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    if (reset) this.node.innerHTML = '';\n    else this.node.innerHTML = value === undefined ? '' : value;\n  }\n}\n\nfunction updateRadioValue(reset) {\n  const node = this.node;\n  const wasChecked = node.checked;\n\n  const value = this.getValue();\n\n  if (reset) return (node.checked = false);\n\n  //node.value = this.element.getAttribute( 'value' );\n  node.value = this.node._ractive.value = value;\n  node.checked = this.element.compare(value, this.element.getAttribute('name'));\n\n  // This is a special case - if the input was checked, and the value\n  // changed so that it's no longer checked, the twoway binding is\n  // most likely out of date. To fix it we have to jump through some\n  // hoops... this is a little kludgy but it works\n  if (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n    this.element.binding.group.model.set(this.element.binding.group.getValue());\n  }\n}\n\nfunction updateValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node.removeAttribute('value');\n      this.node.value = this.node._ractive.value = null;\n    } else {\n      const value = this.getValue();\n\n      this.node.value = this.node._ractive.value = value;\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateStringValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node._ractive.value = '';\n      this.node.removeAttribute('value');\n    } else {\n      const value = this.getValue();\n\n      this.node._ractive.value = value;\n\n      this.node.value = safeToStringValue(value);\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateRadioName(reset) {\n  if (reset) this.node.checked = false;\n  else this.node.checked = this.element.compare(this.getValue(), this.element.binding.getValue());\n}\n\nfunction updateCheckboxName(reset) {\n  const { element, node } = this;\n  const binding = element.binding;\n\n  const value = this.getValue();\n  const valueAttribute = element.getAttribute('value');\n\n  if (reset) {\n    // TODO: WAT?\n  }\n\n  if (!isArray(value)) {\n    binding.isChecked = node.checked = element.compare(value, valueAttribute);\n  } else {\n    let i = value.length;\n    while (i--) {\n      if (element.compare(valueAttribute, value[i])) {\n        binding.isChecked = node.checked = true;\n        return;\n      }\n    }\n    binding.isChecked = node.checked = false;\n  }\n}\n\nfunction updateStyleAttribute(reset) {\n  const props = reset ? {} : readStyle(this.getValue() || '');\n  const style = this.node.style;\n  const keys = objectKeys(props);\n  const prev = this.previous || [];\n\n  let i = 0;\n  while (i < keys.length) {\n    if (keys[i] in style) {\n      const safe = props[keys[i]].replace('!important', '');\n      style.setProperty(keys[i], safe, safe.length !== props[keys[i]].length ? 'important' : '');\n    }\n    i++;\n  }\n\n  // remove now-missing attrs\n  i = prev.length;\n  while (i--) {\n    if (!~keys.indexOf(prev[i]) && prev[i] in style) style.setProperty(prev[i], '', '');\n  }\n\n  this.previous = keys;\n}\n\nfunction updateInlineStyle(reset) {\n  if (!this.style) {\n    this.style = hyphenateCamel(this.name.substr(6));\n  }\n\n  if (reset && this.node.style.getPropertyValue(this.style) !== this.last) return;\n\n  const value = reset ? '' : safeToStringValue(this.getValue());\n  const safe = value.replace('!important', '');\n  this.node.style.setProperty(this.style, safe, safe.length !== value.length ? 'important' : '');\n  this.last = this.node.style.getPropertyValue(this.style);\n}\n\nfunction updateClassName(reset) {\n  const value = reset ? [] : readClass(safeToStringValue(this.getValue()));\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const prev = this.previous || attr.slice(0);\n\n  const className = value.concat(attr.filter(c => !~prev.indexOf(c))).join(' ');\n\n  if (className !== cls) {\n    if (!isString(this.node.className)) {\n      this.node.className.baseVal = className;\n    } else {\n      this.node.className = className;\n    }\n  }\n\n  this.previous = value;\n}\n\nfunction updateInlineClass(reset) {\n  const name = this.name.substr(6);\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const value = reset ? false : this.getValue();\n\n  if (!this.inlineClass) this.inlineClass = name;\n\n  if (value && !~attr.indexOf(name)) attr.push(name);\n  else if (!value && ~attr.indexOf(name)) attr.splice(attr.indexOf(name), 1);\n\n  if (!isString(this.node.className)) {\n    this.node.className.baseVal = attr.join(' ');\n  } else {\n    this.node.className = attr.join(' ');\n  }\n}\n\nfunction updateBoolean(reset) {\n  // with two-way binding, only update if the change wasn't initiated by the user\n  // otherwise the cursor will often be sent to the wrong place\n  if (!this.locked) {\n    if (reset) {\n      if (this.useProperty) this.node[this.propertyName] = false;\n      this.node.removeAttribute(this.propertyName);\n    } else {\n      if (this.useProperty) {\n        this.node[this.propertyName] = this.getValue();\n      } else {\n        const val = this.getValue();\n        if (val) {\n          this.node.setAttribute(this.propertyName, isString(val) ? val : '');\n        } else {\n          this.node.removeAttribute(this.propertyName);\n        }\n      }\n    }\n  }\n}\n\nfunction updateAttribute(reset) {\n  if (reset) {\n    if (this.node.getAttribute(this.name) === this.value) {\n      this.node.removeAttribute(this.name);\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttribute(this.name, this.value);\n  }\n}\n\nfunction updateNamespacedAttribute(reset) {\n  if (reset) {\n    if (\n      this.value ===\n      this.node.getAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1))\n    ) {\n      this.node.removeAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1));\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttributeNS(\n      this.namespace,\n      this.name.slice(this.name.indexOf(':') + 1),\n      this.value\n    );\n  }\n}\n","export default {\n  'accept-charset': 'acceptCharset',\n  accesskey: 'accessKey',\n  bgcolor: 'bgColor',\n  class: 'className',\n  codebase: 'codeBase',\n  colspan: 'colSpan',\n  contenteditable: 'contentEditable',\n  datetime: 'dateTime',\n  dirname: 'dirName',\n  for: 'htmlFor',\n  'http-equiv': 'httpEquiv',\n  ismap: 'isMap',\n  maxlength: 'maxLength',\n  novalidate: 'noValidate',\n  pubdate: 'pubDate',\n  readonly: 'readOnly',\n  rowspan: 'rowSpan',\n  tabindex: 'tabIndex',\n  usemap: 'useMap'\n};\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement('div') : null;\n\nlet attributes = false;\nexport function inAttributes() {\n  return attributes;\n}\n\nexport default class ConditionalAttribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.attributes = [];\n\n    this.owner = options.owner;\n\n    this.fragment = new Fragment({\n      ractive: this.ractive,\n      owner: this,\n      template: this.template\n    });\n\n    // this fragment can't participate in node-y things\n    this.fragment.findNextNode = noop;\n\n    this.dirty = false;\n  }\n\n  bind() {\n    this.fragment.bind();\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.owner.bubble();\n    }\n  }\n\n  destroyed() {\n    this.unrender();\n  }\n\n  render() {\n    this.node = this.owner.node;\n    if (this.node) {\n      this.isSvg = this.node.namespaceURI === svg;\n    }\n\n    attributes = true;\n    if (!this.rendered) this.fragment.render();\n\n    this.rendered = true;\n    this.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n    this.update();\n    attributes = false;\n  }\n\n  toString() {\n    return this.fragment.toString();\n  }\n\n  unbind() {\n    this.fragment.unbind();\n  }\n\n  unrender() {\n    this.rendered = false;\n    this.fragment.unrender();\n  }\n\n  update() {\n    let str;\n    let attrs;\n\n    if (this.dirty) {\n      this.dirty = false;\n\n      const current = attributes;\n      attributes = true;\n      this.fragment.update();\n\n      if (this.rendered && this.node) {\n        str = this.fragment.toString();\n\n        attrs = parseAttributes(str, this.isSvg);\n\n        // any attributes that previously existed but no longer do\n        // must be removed\n        this.attributes.filter(a => notIn(attrs, a)).forEach(a => {\n          this.node.removeAttribute(a.name);\n        });\n\n        attrs.forEach(a => {\n          this.node.setAttribute(a.name, a.value);\n        });\n\n        this.attributes = attrs;\n      }\n\n      attributes = current || false;\n    }\n  }\n}\n\nconst onlyWhitespace = /^\\s*$/;\nfunction parseAttributes(str, isSvg) {\n  if (onlyWhitespace.test(str)) return [];\n  const tagName = isSvg ? 'svg' : 'div';\n  return str\n    ? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) && toArray(div.childNodes[0].attributes)\n    : [];\n}\n\nfunction notIn(haystack, needle) {\n  let i = haystack.length;\n\n  while (i--) {\n    if (haystack[i].name === needle.name) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport namespaces from 'config/namespaces';\nimport { safeAttributeString } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { inAttributes } from './ConditionalAttribute';\nimport { isArray, isString } from 'utils/is';\n\nfunction lookupNamespace(node, prefix) {\n  const qualified = `xmlns:${prefix}`;\n\n  while (node) {\n    if (node.hasAttribute && node.hasAttribute(qualified)) return node.getAttribute(qualified);\n    node = node.parentNode;\n  }\n\n  return namespaces[prefix];\n}\n\nlet attribute = false;\nexport function inAttribute() {\n  return attribute;\n}\n\nexport default class Attribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n    this.namespace = null;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = options.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.rendered = false;\n    this.updateDelegate = null;\n    this.fragment = null;\n\n    this.element.attributeByName[this.name] = this;\n\n    if (!isArray(options.template.f)) {\n      this.value = options.template.f;\n      if (this.value === 0) {\n        this.value = '';\n      } else if (this.value === undefined) {\n        this.value = true;\n      }\n    } else {\n      this.fragment = new Fragment({\n        owner: this,\n        template: options.template.f\n      });\n    }\n\n    this.interpolator =\n      this.fragment &&\n      this.fragment.items.length === 1 &&\n      this.fragment.items[0].type === INTERPOLATOR &&\n      this.fragment.items[0];\n\n    if (this.interpolator) this.interpolator.owner = this;\n  }\n\n  bind() {\n    if (this.fragment) {\n      this.fragment.bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.up.bubble();\n      this.element.bubble();\n      this.dirty = true;\n    }\n  }\n\n  firstNode() {}\n\n  getString() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.toString()\n      : this.value != null ? '' + this.value : '';\n    attribute = false;\n    return value;\n  }\n\n  // TODO could getValue ever be called for a static attribute,\n  // or can we assume that this.fragment exists?\n  getValue() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.valueOf()\n      : booleanAttributes.test(this.name) ? true : this.value;\n    attribute = false;\n    return value;\n  }\n\n  render() {\n    const node = this.element.node;\n    this.node = node;\n\n    // should we use direct property access, or setAttribute?\n    if (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n      this.propertyName = propertyNames[this.name] || this.name;\n\n      if (node[this.propertyName] !== undefined) {\n        this.useProperty = true;\n      }\n\n      // is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n      // node.selected = true rather than node.setAttribute( 'selected', '' )\n      if (booleanAttributes.test(this.name) || this.isTwoway) {\n        this.isBoolean = true;\n      }\n\n      if (this.propertyName === 'value') {\n        node._ractive.value = this.value;\n      }\n    }\n\n    if (node.namespaceURI) {\n      const index = this.name.indexOf(':');\n      if (index !== -1) {\n        this.namespace = lookupNamespace(node, this.name.slice(0, index));\n      } else {\n        this.namespace = node.namespaceURI;\n      }\n    }\n\n    this.rendered = true;\n    this.updateDelegate = getUpdateDelegate(this);\n    this.updateDelegate();\n  }\n\n  toString() {\n    if (inAttributes()) return '';\n    attribute = true;\n\n    const value = this.getValue();\n\n    // Special case - select and textarea values (should not be stringified)\n    if (\n      this.name === 'value' &&\n      (this.element.getAttribute('contenteditable') !== undefined ||\n        (this.element.name === 'select' || this.element.name === 'textarea'))\n    ) {\n      return;\n    }\n\n    // Special case  bound radio `name` attributes\n    if (\n      this.name === 'name' &&\n      this.element.name === 'input' &&\n      this.interpolator &&\n      this.element.getAttribute('type') === 'radio'\n    ) {\n      return `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n    }\n\n    // Special case - style and class attributes and directives\n    if (\n      this.owner === this.element &&\n      (this.name === 'style' || this.name === 'class' || this.style || this.inlineClass)\n    ) {\n      return;\n    }\n\n    if (\n      !this.rendered &&\n      this.owner === this.element &&\n      (!this.name.indexOf('style-') || !this.name.indexOf('class-'))\n    ) {\n      if (!this.name.indexOf('style-')) {\n        this.style = hyphenateCamel(this.name.substr(6));\n      } else {\n        this.inlineClass = this.name.substr(6);\n      }\n\n      return;\n    }\n\n    if (booleanAttributes.test(this.name))\n      return value\n        ? isString(value) ? `${this.name}=\"${safeAttributeString(value)}\"` : this.name\n        : '';\n    if (value == null) return '';\n\n    const str = safeAttributeString(this.getString());\n    attribute = false;\n\n    return str ? `${this.name}=\"${str}\"` : this.name;\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender() {\n    this.updateDelegate(true);\n\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      let binding;\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      if (this.rendered) this.updateDelegate();\n      if (this.isTwoway && !this.locked) {\n        this.interpolator.twowayBinding.lastVal(true, this.interpolator.model.get());\n      } else if (this.name === 'value' && (binding = this.element.binding)) {\n        // special case: name bound element with dynamic value\n        const attr = binding.attribute;\n        if (attr && !attr.dirty && attr.rendered) {\n          this.element.binding.attribute.updateDelegate();\n        }\n      }\n    }\n  }\n}\n","import { INTERPOLATOR, ELEMENT } from 'config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class BindingFlag extends Item {\n  constructor(options) {\n    super(options);\n\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n    this.bubbler = this.owner === this.element ? this.element : this.up;\n\n    if (this.element.type === ELEMENT) {\n      if (isArray(options.template.f)) {\n        this.fragment = new Fragment({\n          owner: this,\n          template: options.template.f\n        });\n      }\n\n      this.interpolator =\n        this.fragment &&\n        this.fragment.items.length === 1 &&\n        this.fragment.items[0].type === INTERPOLATOR &&\n        this.fragment.items[0];\n    }\n  }\n\n  bind() {\n    if (this.fragment) this.fragment.bind();\n    set(this, this.getValue(), true);\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.bubbler.bubble();\n      this.dirty = true;\n    }\n  }\n\n  getValue() {\n    if (this.fragment) return this.fragment.valueOf();\n    else if ('value' in this) return this.value;\n    else if ('f' in this.template) return this.template.f;\n    else return true;\n  }\n\n  render() {\n    set(this, this.getValue(), true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n\n    delete this.element[this.flag];\n  }\n\n  unrender() {\n    if (this.element.rendered) this.element.recreateTwowayBinding();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      set(this, this.getValue(), true);\n    }\n  }\n}\n\nfunction set(flag, value, update) {\n  if (value === 0) {\n    flag.value = true;\n  } else if (value === 'true') {\n    flag.value = true;\n  } else if (value === 'false' || value === '0') {\n    flag.value = false;\n  } else {\n    flag.value = value;\n  }\n\n  const current = flag.element[flag.flag];\n  flag.element[flag.flag] = flag.value;\n  if (update && !flag.element.attributes.binding && current !== flag.value) {\n    flag.element.recreateTwowayBinding();\n  }\n\n  return flag.value;\n}\n","import Item from './shared/Item';\nimport noop from 'utils/noop';\nimport { detachNode } from 'utils/dom';\nimport { doc } from 'config/environment';\nimport { assign, create } from 'utils/object';\n\nexport default function Comment(options) {\n  Item.call(this, options);\n}\n\nconst proto = create(Item.prototype);\n\nassign(proto, {\n  bind: noop,\n  unbind: noop,\n  update: noop,\n\n  detach() {\n    return detachNode(this.node);\n  },\n\n  firstNode() {\n    return this.node;\n  },\n\n  render(target) {\n    this.rendered = true;\n\n    this.node = doc.createComment(this.template.c);\n    target.appendChild(this.node);\n  },\n\n  toString() {\n    return `<!-- ${this.template.c} -->`;\n  },\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n});\n\nComment.prototype = proto;\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\nimport { warnIfDebug } from 'utils/log';\n\nconst teardownHook = new Hook('teardown');\nconst destructHook = new Hook('destruct');\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown() {\n  if (this.torndown) {\n    warnIfDebug('ractive.teardown() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  this.shouldDestroy = true;\n  return teardown(this, () => (this.fragment.rendered ? this.unrender() : Promise.resolve()));\n}\n\nexport function teardown(instance, getPromise) {\n  instance.torndown = true;\n  instance.fragment.unbind();\n  instance._observers.slice().forEach(cancel);\n\n  if (instance.el && instance.el.__ractive_instances__) {\n    removeFromArray(instance.el.__ractive_instances__, instance);\n  }\n\n  const promise = getPromise();\n\n  teardownHook.fire(instance);\n\n  promise.then(() => {\n    destructHook.fire(instance);\n    instance.viewmodel.teardown();\n  });\n\n  return promise;\n}\n","import { SharedModel } from './SharedModel';\nimport { Missing } from '../LinkModel';\nimport { create } from 'utils/object';\n\nexport default class RactiveModel extends SharedModel {\n  constructor(ractive) {\n    super(ractive, '@this');\n    this.ractive = ractive;\n  }\n\n  joinKey(key) {\n    const model = super.joinKey(key);\n\n    if ((key === 'root' || key === 'parent') && !model.isLink) return initLink(model, key);\n    else if (key === 'data') return this.ractive.viewmodel;\n    else if (key === 'cssData') return this.ractive.constructor._cssModel;\n\n    return model;\n  }\n}\n\nfunction initLink(model, key) {\n  model.applyValue = function(value) {\n    this.parent.value[key] = value;\n    if (value && value.viewmodel) {\n      this.link(value.viewmodel.getRactiveModel(), key);\n      this._link.markedAll();\n    } else {\n      this.link(create(Missing), key);\n      this._link.markedAll();\n    }\n  };\n\n  model.applyValue(model.parent.ractive[key], key);\n  model._link.set = v => model.applyValue(v);\n  model._link.applyValue = v => model.applyValue(v);\n  return model._link;\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel, SharedModel as SharedBase } from './specials/SharedModel';\nimport { splitKeypath, unescapeKey } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\n\nconst specialModels = {\n  '@this'(root) {\n    return root.getRactiveModel();\n  },\n  '@global'() {\n    return GlobalModel;\n  },\n  '@shared'() {\n    return SharedModel;\n  },\n  '@style'(root) {\n    return root.getRactiveModel().joinKey('cssData');\n  },\n  '@helpers'(root) {\n    return root.getHelpers();\n  }\n};\nspecialModels['@'] = specialModels['@this'];\n\nexport default class RootModel extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.ractive = options.ractive; // TODO sever this link\n\n    this.value = options.data;\n    this.adaptors = options.adapt;\n    this.adapt();\n  }\n\n  attached(fragment) {\n    attachImplicits(this, fragment);\n  }\n\n  createLink(keypath, target, targetPath, options) {\n    const keys = splitKeypath(keypath);\n\n    let model = this;\n    while (keys.length) {\n      const key = keys.shift();\n      model = model.childByKey[key] || model.joinKey(key);\n    }\n\n    return model.link(target, targetPath, options);\n  }\n\n  detached() {\n    detachImplicits(this);\n  }\n\n  get(shouldCapture, options) {\n    if (shouldCapture) capture(this);\n\n    if (!options || options.virtual !== false) {\n      return this.getVirtual();\n    } else {\n      return this.value;\n    }\n  }\n\n  getHelpers() {\n    if (!this.helpers) this.helpers = new SharedBase(this.ractive.helpers, 'helpers');\n    return this.helpers;\n  }\n\n  getKeypath() {\n    return '';\n  }\n\n  getRactiveModel() {\n    return this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  }\n\n  getValueChildren() {\n    const children = super.getValueChildren(this.value);\n\n    this.children.forEach(child => {\n      if (child._link) {\n        const idx = children.indexOf(child);\n        if (~idx) children.splice(idx, 1, child._link);\n        else children.push(child._link);\n      }\n    });\n\n    return children;\n  }\n\n  has(key) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n    if (specialModels[key] || key === '') return true;\n\n    if (super.has(key)) {\n      return true;\n    } else {\n      const unescapedKey = unescapeKey(key);\n\n      // mappings/links and computations\n      if (this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link) return true;\n    }\n  }\n\n  joinKey(key, opts) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n\n    if (key[0] === '@') {\n      const fn = specialModels[key];\n      if (fn) return fn(this);\n    } else {\n      return super.joinKey(key, opts);\n    }\n  }\n\n  set(value) {\n    // TODO wrapping root node is a baaaad idea. We should prevent this\n    const wrapper = this.wrapper;\n    if (wrapper) {\n      const shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        wrapper.teardown();\n        this.wrapper = null;\n        this.value = value;\n        this.adapt();\n      }\n    } else {\n      this.value = value;\n      this.adapt();\n    }\n\n    this.deps.forEach(handleChange);\n    this.children.forEach(mark);\n  }\n\n  retrieve() {\n    return this.wrapper ? this.wrapper.get() : this.value;\n  }\n\n  teardown() {\n    super.teardown();\n    this.ractiveModel && this.ractiveModel.teardown();\n  }\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits(model, fragment) {\n  if (model._link && model._link.implicit && model._link.isDetached()) {\n    model.attach(fragment);\n  }\n\n  // look for virtual children to relink and cascade\n  for (const k in model.childByKey) {\n    if (k in model.value) {\n      attachImplicits(model.childByKey[k], fragment);\n    } else if (!model.childByKey[k]._link || model.childByKey[k]._link.isDetached()) {\n      const mdl = resolveReference(fragment, k);\n      if (mdl) {\n        model.childByKey[k].link(mdl, k, { implicit: true });\n      }\n    }\n  }\n}\n\nfunction detachImplicits(model) {\n  if (model._link && model._link.implicit) {\n    model.unlink();\n  }\n\n  for (const k in model.childByKey) {\n    detachImplicits(model.childByKey[k]);\n  }\n}\n","import { fatal, warnIfDebug, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { ensureArray, combine } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from 'src/model/RootModel';\nimport Hook from 'src/events/Hook';\nimport subscribe from './helpers/subscribe';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, INTERPOLATOR, TRANSITION } from 'config/types';\nimport { assign, create, hasOwn } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\nimport { compute } from 'src/Ractive/prototype/compute';\n\nconst constructHook = new Hook('construct');\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst protoRegistries = ['computed', 'helpers'];\n\nlet uid = 0;\n\nexport default function construct(ractive, options) {\n  if (Ractive.DEBUG) welcome();\n\n  initialiseProperties(ractive);\n  handleAttributes(ractive);\n\n  // set up event subscribers\n  subscribe(ractive, options, 'on');\n\n  // if there's not a delegation setting, inherit from parent if it's not default\n  if (\n    !hasOwn(options, 'delegate') &&\n    ractive.parent &&\n    ractive.parent.delegate !== ractive.delegate\n  ) {\n    ractive.delegate = false;\n  }\n\n  // plugins that need to run at construct\n  if (isArray(options.use)) {\n    ractive.use.apply(ractive, options.use.filter(p => p.construct));\n  }\n\n  // TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n  constructHook.fire(ractive, options);\n\n  // Add registries\n  let i = registryNames.length;\n  while (i--) {\n    const name = registryNames[i];\n    ractive[name] = assign(create(ractive.constructor[name] || null), options[name]);\n  }\n\n  i = protoRegistries.length;\n  while (i--) {\n    const name = protoRegistries[i];\n    ractive[name] = assign(create(ractive.constructor.prototype[name]), options[name]);\n  }\n\n  if (ractive._attributePartial) {\n    ractive.partials['extra-attributes'] = ractive._attributePartial;\n    delete ractive._attributePartial;\n  }\n\n  // Create a viewmodel\n  const viewmodel = new RootModel({\n    adapt: getAdaptors(ractive, ractive.adapt, options),\n    data: dataConfigurator.init(ractive.constructor, ractive, options),\n    ractive\n  });\n\n  // once resolved, share the adaptors array between the root model and instance\n  ractive.adapt = viewmodel.adaptors;\n\n  ractive.viewmodel = viewmodel;\n\n  for (const k in ractive.computed) {\n    compute.call(ractive, k, ractive.computed[k]);\n  }\n}\n\nfunction getAdaptors(ractive, protoAdapt, options) {\n  protoAdapt = protoAdapt.map(lookup);\n  const adapt = ensureArray(options.adapt).map(lookup);\n\n  const srcs = [protoAdapt, adapt];\n  if (ractive.parent && !ractive.isolated) {\n    srcs.push(ractive.parent.viewmodel.adaptors);\n  }\n\n  return combine.apply(null, srcs);\n\n  function lookup(adaptor) {\n    if (isString(adaptor)) {\n      adaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n      if (!adaptor) {\n        fatal(missingPlugin(adaptor, 'adaptor'));\n      }\n    }\n\n    return adaptor;\n  }\n}\n\nfunction initialiseProperties(ractive) {\n  // Generate a unique identifier, for places where you'd use a weak map if it\n  // existed\n  ractive._guid = 'r-' + uid++;\n\n  // events\n  ractive._subs = create(null);\n  ractive._nsSubs = 0;\n\n  // storage for item configuration from instantiation to reset,\n  // like dynamic functions or original values\n  ractive._config = {};\n\n  // events\n  ractive.event = null;\n  ractive._eventQueue = [];\n\n  // observers\n  ractive._observers = [];\n\n  // external children\n  ractive._children = [];\n  ractive._children.byName = {};\n  ractive.children = ractive._children;\n\n  if (!ractive.component) {\n    ractive.root = ractive;\n    ractive.parent = ractive.container = null; // TODO container still applicable?\n  }\n}\n\nfunction handleAttributes(ractive) {\n  const component = ractive.component;\n  const attributes = ractive.constructor.attributes;\n\n  if (attributes && component) {\n    const tpl = component.template;\n    const attrs = tpl.m ? tpl.m.slice() : [];\n\n    // grab all of the passed attribute names\n    const props = attrs.filter(a => a.t === ATTRIBUTE).map(a => a.n);\n\n    // warn about missing requireds\n    attributes.required.forEach(p => {\n      if (!~props.indexOf(p)) {\n        warnIfDebug(`Component '${component.name}' requires attribute '${p}' to be provided`);\n      }\n    });\n\n    // set up a partial containing non-property attributes\n    const all = attributes.optional.concat(attributes.required);\n    const partial = [];\n    let i = attrs.length;\n    while (i--) {\n      const a = attrs[i];\n      if (a.t === ATTRIBUTE && !~all.indexOf(a.n)) {\n        if (attributes.mapAll) {\n          // map the attribute if requested and make the extra attribute in the partial refer to the mapping\n          partial.unshift({\n            t: ATTRIBUTE,\n            n: a.n,\n            f: [{ t: INTERPOLATOR, r: `~/${a.n}` }]\n          });\n        } else {\n          // transfer the attribute to the extra attributes partal\n          partial.unshift(attrs.splice(i, 1)[0]);\n        }\n      } else if (\n        !attributes.mapAll &&\n        (a.t === DECORATOR || a.t === TRANSITION || a.t === BINDING_FLAG)\n      ) {\n        partial.unshift(attrs.splice(i, 1)[0]);\n      }\n    }\n\n    if (partial.length) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n    ractive._attributePartial = partial;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\nimport { bind, render as callRender, unbind, unrender, update } from 'shared/methodCallers';\nimport { teardown } from 'src/Ractive/prototype/teardown';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnIfDebug } from 'utils/log';\nimport { createDocumentFragment } from 'utils/dom';\nimport {\n  ANCHOR,\n  ATTRIBUTE,\n  BINDING_FLAG,\n  COMPONENT,\n  DECORATOR,\n  EVENT,\n  TRANSITION,\n  YIELDER\n} from 'config/types';\nimport construct from 'src/Ractive/construct';\nimport initialise from 'src/Ractive/initialise';\nimport render from 'src/Ractive/render';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { assign, create } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nexport default class Component extends Item {\n  constructor(options, ComponentConstructor) {\n    super(options);\n    let template = options.template;\n    this.isAnchor = template.t === ANCHOR;\n    this.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n    let attrs = template.m;\n\n    const partials = template.p || {};\n    if (!('content' in partials)) partials.content = template.f || [];\n    this._partials = partials; // TEMP\n\n    if (this.isAnchor) {\n      this.name = template.n;\n\n      this.addChild = addChild;\n      this.removeChild = removeChild;\n    } else {\n      const instance = create(ComponentConstructor.prototype);\n\n      this.instance = instance;\n      this.name = template.e;\n\n      if (instance.el || instance.target) {\n        warnIfDebug(\n          `The <${this.name}> component has a default '${\n            instance.el ? 'el' : 'target'\n          }' property; it has been disregarded`\n        );\n        instance.el = instance.target = null;\n      }\n\n      // find container\n      let fragment = options.up;\n      let container;\n      while (fragment) {\n        if (fragment.owner.type === YIELDER) {\n          container = fragment.owner.container;\n          break;\n        }\n\n        fragment = fragment.parent;\n      }\n\n      // add component-instance-specific properties\n      instance.parent = this.up.ractive;\n      instance.container = container || null;\n      instance.root = instance.parent.root;\n      instance.component = this;\n\n      construct(this.instance, { partials });\n\n      // these can be modified during construction\n      template = this.template;\n      attrs = template.m;\n\n      // allow components that are so inclined to add programmatic mappings\n      if (isArray(this.mappings)) {\n        attrs = (attrs || []).concat(this.mappings);\n      } else if (isString(this.mappings)) {\n        attrs = (attrs || []).concat(parser.parse(this.mappings, { attributes: true }).t);\n      }\n\n      // for hackability, this could be an open option\n      // for any ractive instance, but for now, just\n      // for components and just for ractive...\n      instance._inlinePartials = partials;\n    }\n\n    this.attributeByName = {};\n    this.attributes = [];\n\n    if (attrs) {\n      const leftovers = [];\n      attrs.forEach(template => {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case EVENT:\n            this.attributes.push(\n              createItem({\n                owner: this,\n                up: this.up,\n                template\n              })\n            );\n            break;\n\n          case TRANSITION:\n          case BINDING_FLAG:\n          case DECORATOR:\n            break;\n\n          default:\n            leftovers.push(template);\n            break;\n        }\n      });\n\n      if (leftovers.length) {\n        this.attributes.push(\n          new ConditionalAttribute({\n            owner: this,\n            up: this.up,\n            template: leftovers\n          })\n        );\n      }\n    }\n\n    this.eventHandlers = [];\n  }\n\n  bind() {\n    if (!this.isAnchor) {\n      this.attributes.forEach(bind);\n      this.eventHandlers.forEach(bind);\n\n      initialise(\n        this.instance,\n        {\n          partials: this._partials\n        },\n        {\n          cssIds: this.up.cssIds\n        }\n      );\n\n      if (this.instance.target || this.instance.el) this.extern = true;\n\n      this.bound = true;\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (!this.isAnchor && this.instance.fragment) this.instance.fragment.destroyed();\n  }\n\n  detach() {\n    if (this.isAnchor) {\n      if (this.instance) return this.instance.fragment.detach();\n      return createDocumentFragment();\n    }\n\n    return this.instance.fragment.detach();\n  }\n\n  find(selector, options) {\n    if (this.instance) return this.instance.fragment.find(selector, options);\n  }\n\n  findAll(selector, options) {\n    if (this.instance) this.instance.fragment.findAll(selector, options);\n  }\n\n  findComponent(name, options) {\n    if (!name || this.name === name) return this.instance;\n\n    if (this.instance.fragment) {\n      return this.instance.fragment.findComponent(name, options);\n    }\n  }\n\n  findAllComponents(name, options) {\n    const { result } = options;\n\n    if (this.instance && (!name || this.name === name)) {\n      result.push(this.instance);\n    }\n\n    if (this.instance) this.instance.findAllComponents(name, options);\n  }\n\n  firstNode(skipParent) {\n    if (this.instance) return this.instance.fragment.firstNode(skipParent);\n  }\n\n  getContext(...assigns) {\n    assigns.unshift(this.instance);\n    return getRactiveContext.apply(null, assigns);\n  }\n\n  render(target, occupants) {\n    if (this.isAnchor) {\n      this.rendered = true;\n      this.target = target;\n\n      if (!checking.length) {\n        checking.push(this.ractive);\n        if (occupants) {\n          this.occupants = occupants;\n          checkAnchors();\n          this.occupants = null;\n        } else {\n          runloop.scheduleTask(checkAnchors, true);\n        }\n      }\n    } else {\n      this.attributes.forEach(callRender);\n      this.eventHandlers.forEach(callRender);\n\n      if (this.extern) {\n        this.instance.delegate = false;\n        this.instance.render();\n      } else {\n        render(this.instance, target, null, occupants);\n      }\n\n      this.rendered = true;\n    }\n  }\n\n  shuffled() {\n    super.shuffled();\n    this.instance &&\n      !this.instance.isolated &&\n      this.instance.fragment &&\n      this.instance.fragment.shuffled();\n  }\n\n  toString() {\n    if (this.instance) return this.instance.toHTML();\n  }\n\n  unbind() {\n    if (!this.isAnchor) {\n      this.bound = false;\n\n      this.attributes.forEach(unbind);\n\n      teardown(this.instance, () => runloop.promise());\n    }\n  }\n\n  unrender(shouldDestroy) {\n    this.shouldDestroy = shouldDestroy;\n\n    if (this.isAnchor) {\n      if (this.item) unrenderItem(this, this.item);\n      this.target = null;\n      if (!checking.length) {\n        checking.push(this.ractive);\n        runloop.scheduleTask(checkAnchors, true);\n      }\n    } else {\n      this.instance.unrender();\n      this.instance.el = this.instance.target = null;\n      this.attributes.forEach(unrender);\n      this.eventHandlers.forEach(unrender);\n    }\n\n    this.rendered = false;\n  }\n\n  update() {\n    this.dirty = false;\n    if (this.instance) {\n      this.instance.fragment.update();\n      this.attributes.forEach(update);\n      this.eventHandlers.forEach(update);\n    }\n  }\n}\n\nfunction addChild(meta) {\n  if (this.item) this.removeChild(this.item);\n\n  const child = meta.instance;\n  meta.anchor = this;\n\n  meta.up = this.up;\n  meta.name = meta.nameOption || this.name;\n  this.name = meta.name;\n\n  if (!child.isolated) child.viewmodel.attached(this.up);\n\n  // render as necessary\n  if (this.rendered) {\n    renderItem(this, meta);\n  }\n}\n\nfunction removeChild(meta) {\n  // unrender as necessary\n  if (this.item === meta) {\n    unrenderItem(this, meta);\n    this.name = this.template.n;\n  }\n}\n\nfunction renderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = false;\n  meta.up = anchor.up;\n\n  anchor.item = meta;\n  anchor.instance = meta.instance;\n  const nextNode = anchor.up.findNextNode(anchor);\n\n  if (meta.instance.fragment.rendered) {\n    meta.instance.unrender();\n  }\n\n  meta.partials = meta.instance.partials;\n  meta.instance.partials = assign(create(meta.partials), meta.partials, anchor._partials);\n\n  meta.instance.fragment.unbind();\n  meta.instance.fragment.componentParent = anchor.up;\n  meta.instance.fragment.bind(meta.instance.viewmodel);\n\n  anchor.attributes.forEach(bind);\n  anchor.eventHandlers.forEach(bind);\n  anchor.attributes.forEach(callRender);\n  anchor.eventHandlers.forEach(callRender);\n\n  const target = anchor.up.findParentNode();\n  render(meta.instance, target, target.contains(nextNode) ? nextNode : null, anchor.occupants);\n\n  if (meta.lastBound !== anchor) {\n    meta.lastBound = anchor;\n  }\n}\n\nfunction unrenderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = true;\n  meta.instance.unrender();\n\n  anchor.eventHandlers.forEach(unrender);\n  anchor.attributes.forEach(unrender);\n  anchor.eventHandlers.forEach(unbind);\n  anchor.attributes.forEach(unbind);\n\n  meta.instance.el = meta.instance.anchor = null;\n  meta.instance.fragment.componentParent = null;\n  meta.up = null;\n  meta.anchor = null;\n  anchor.item = null;\n  anchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors() {\n  const list = checking;\n  checking = [];\n\n  list.forEach(updateAnchors);\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { warnOnce } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport noop from 'utils/noop';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'src/shared/rebind';\nimport findElement from '../shared/findElement';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\n\nconst missingDecorator = {\n  update: noop,\n  teardown: noop\n};\n\nexport default class Decorator {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.up = options.up || this.owner.up;\n    this.ractive = this.owner.ractive;\n    const template = (this.template = options.template);\n\n    this.name = template.n;\n\n    this.node = null;\n    this.handle = null;\n\n    this.element.decorators.push(this);\n  }\n\n  bind() {\n    setupArgsFn(this, this.template, this.up, { register: true });\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      // decorators may be owned directly by an element or by a fragment if conditional\n      this.owner.bubble();\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n    this.shouldDestroy = true;\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n    if (!~idx) return;\n\n    next = rebindMatch(this.template.f.r[idx], next, previous);\n    if (next === previous) return;\n\n    previous.unregister(this);\n    this.models.splice(idx, 1, next);\n    if (next) next.addShuffleRegister(this, 'mark');\n\n    if (!safe) this.bubble();\n  }\n\n  render() {\n    this.shouldDestroy = false;\n    if (this.handle) this.unrender();\n    runloop.scheduleTask(() => {\n      const fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n      if (!fn) {\n        warnOnce(missingPlugin(this.name, 'decorator'));\n        this.handle = missingDecorator;\n        return;\n      }\n\n      this.node = this.element.node;\n\n      let args;\n      if (this.fn) {\n        args = this.models.map(model => {\n          if (!model) return undefined;\n\n          return model.get();\n        });\n        args = this.fn.apply(this.ractive, args);\n      }\n\n      this.handle = fn.apply(this.ractive, [this.node].concat(args));\n\n      if (!this.handle || !this.handle.teardown) {\n        throw new Error(\n          `The '${this.name}' decorator must return an object with a teardown method`\n        );\n      }\n\n      // watch out for decorators that cause their host element to be unrendered\n      if (this.shouldDestroy) this.destroyed();\n    }, true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    teardownArgsFn(this, this.template);\n  }\n\n  unrender(shouldDestroy) {\n    if ((!shouldDestroy || this.element.rendered) && this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n  }\n\n  update() {\n    const instance = this.handle;\n\n    if (!this.dirty) {\n      if (instance && instance.invalidate) {\n        runloop.scheduleTask(() => instance.invalidate(), true);\n      }\n      return;\n    }\n\n    this.dirty = false;\n\n    if (instance) {\n      if (!instance.update) {\n        this.unrender();\n        this.render();\n      } else {\n        const args = this.models.map(model => model && model.get());\n        instance.update.apply(this.ractive, this.fn.apply(this.ractive, args));\n      }\n    }\n  }\n}\n","import noop from 'utils/noop';\nimport Item from './shared/Item';\n\nexport default class Doctype extends Item {\n  toString() {\n    return '<!DOCTYPE' + this.template.a + '>';\n  }\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","import runloop from 'src/global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport noop from 'utils/noop';\nimport findElement from '../../shared/findElement';\n\nexport default class Binding {\n  constructor(element, name = 'value') {\n    this.element = element;\n    this.ractive = element.ractive;\n    this.attribute = element.attributeByName[name];\n\n    const interpolator = this.attribute.interpolator;\n    interpolator.twowayBinding = this;\n\n    const model = interpolator.model;\n\n    if (model.isReadonly && !model.setRoot) {\n      const keypath = model.getKeypath().replace(/^@/, '');\n      warnOnceIfDebug(\n        `Cannot use two-way binding on <${\n          element.name\n        }> element: ${keypath} is read-only. To suppress this warning use <${\n          element.name\n        } twoway='false'...>`,\n        { ractive: this.ractive }\n      );\n      return false;\n    }\n\n    this.attribute.isTwoway = true;\n    this.model = model;\n\n    // initialise value, if it's undefined\n    let value = model.get();\n    this.wasUndefined = value === undefined;\n\n    if (value === undefined && this.getInitialValue) {\n      value = this.getInitialValue();\n      model.set(value);\n    }\n    this.lastVal(true, value);\n\n    const parentForm = findElement(this.element, false, 'form');\n    if (parentForm) {\n      this.resetValue = value;\n      parentForm.formBindings.push(this);\n    }\n  }\n\n  bind() {\n    this.model.registerTwowayBinding(this);\n  }\n\n  handleChange() {\n    const value = this.getValue();\n    if (this.lastVal() === value) return;\n\n    runloop.start();\n    this.attribute.locked = true;\n    this.model.set(value);\n    this.lastVal(true, value);\n\n    // if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n    if (this.model.get() !== value) this.attribute.locked = false;\n    else runloop.scheduleTask(() => (this.attribute.locked = false));\n\n    runloop.end();\n  }\n\n  lastVal(setting, value) {\n    if (setting) this.lastValue = value;\n    else return this.lastValue;\n  }\n\n  rebind(next, previous) {\n    if (this.model && this.model === previous) previous.unregisterTwowayBinding(this);\n    if (next) {\n      this.model = next;\n      runloop.scheduleTask(() => next.registerTwowayBinding(this));\n    }\n  }\n\n  render() {\n    this.node = this.element.node;\n    this.node._ractive.binding = this;\n    this.rendered = true; // TODO is this used anywhere?\n  }\n\n  setFromNode(node) {\n    this.model.set(node.value);\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n  }\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n\n  getInitialValue() {\n    return !!this.element.getAttribute('checked');\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n}\n","import { escapeKey, unescapeKey } from 'shared/keypaths';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction } from 'utils/is';\nimport bind from 'utils/bind';\nimport { create, keys as objectKeys } from 'utils/object';\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\nexport const noVirtual = { virtual: false };\n\nexport default class ModelBase {\n  constructor(parent) {\n    this.deps = [];\n\n    this.children = [];\n    this.childByKey = {};\n    this.links = [];\n\n    this.bindings = [];\n\n    if (parent) {\n      this.parent = parent;\n      this.root = parent.root;\n    }\n  }\n\n  addShuffleTask(task, stage = 'early') {\n    shuffleTasks[stage].push(task);\n  }\n  addShuffleRegister(item, stage = 'early') {\n    registerQueue[stage].push({ model: this, item });\n  }\n\n  downstreamChanged() {}\n\n  findMatches(keys) {\n    const len = keys.length;\n\n    let existingMatches = [this];\n    let matches;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const key = keys[i];\n\n      if (key === '*') {\n        matches = [];\n        existingMatches.forEach(model => {\n          matches.push.apply(matches, model.getValueChildren(model.get()));\n        });\n      } else {\n        matches = existingMatches.map(model => model.joinKey(key));\n      }\n\n      existingMatches = matches;\n    }\n\n    return matches;\n  }\n\n  getKeypath(ractive) {\n    if (ractive !== this.ractive && this._link) return this._link.target.getKeypath(ractive);\n\n    if (!this.keypath) {\n      const parent = this.parent && this.parent.getKeypath(ractive);\n      this.keypath = parent\n        ? `${this.parent.getKeypath(ractive)}.${escapeKey(this.key)}`\n        : escapeKey(this.key);\n    }\n\n    return this.keypath;\n  }\n\n  getValueChildren(value) {\n    let children;\n    if (isArray(value)) {\n      children = [];\n      if ('length' in this && this.length !== value.length) {\n        children.push(this.joinKey('length'));\n      }\n      value.forEach((m, i) => {\n        children.push(this.joinKey(i));\n      });\n    } else if (isObject(value) || isFunction(value)) {\n      children = objectKeys(value).map(key => this.joinKey(key));\n    } else if (value != null) {\n      children = [];\n    }\n\n    const computed = this.computed;\n    if (computed) {\n      children.push.apply(children, objectKeys(computed).map(k => this.joinKey(k)));\n    }\n\n    return children;\n  }\n\n  getVirtual(shouldCapture) {\n    const value = this.get(shouldCapture, { virtual: false });\n    if (isObject(value)) {\n      const result = isArray(value) ? [] : create(null);\n\n      let keys = objectKeys(value);\n      let i = keys.length;\n      while (i--) {\n        const child = this.childByKey[keys[i]];\n        if (!child) result[keys[i]] = value[keys[i]];\n        else if (child._link) result[keys[i]] = child._link.getVirtual();\n        else result[keys[i]] = child.getVirtual();\n      }\n\n      i = this.children.length;\n      while (i--) {\n        const child = this.children[i];\n        if (!(child.key in result) && child._link) {\n          result[child.key] = child._link.getVirtual();\n        }\n      }\n\n      if (this.computed) {\n        keys = objectKeys(this.computed);\n        i = keys.length;\n        while (i--) {\n          result[keys[i]] = this.computed[keys[i]].get();\n        }\n      }\n\n      return result;\n    } else return value;\n  }\n\n  has(key) {\n    if (this._link) return this._link.has(key);\n\n    const value = this.get(false, noVirtual);\n    if (!value) return false;\n\n    key = unescapeKey(key);\n    if ((isFunction(value) || isObject(value)) && key in value) return true;\n\n    let computed = this.computed;\n    if (computed && key in this.computed) return true;\n\n    computed = this.root.ractive && this.root.ractive.computed;\n    if (computed) {\n      objectKeys(computed).forEach(k => {\n        if (computed[k].pattern && computed[k].pattern.test(this.getKeypath())) return true;\n      });\n    }\n\n    return false;\n  }\n\n  joinAll(keys, opts) {\n    let model = this;\n    for (let i = 0; i < keys.length; i += 1) {\n      if (\n        opts &&\n        opts.lastLink === false &&\n        i + 1 === keys.length &&\n        model.childByKey[keys[i]] &&\n        model.childByKey[keys[i]]._link\n      )\n        return model.childByKey[keys[i]];\n      model = model.joinKey(keys[i], opts);\n    }\n\n    return model;\n  }\n\n  notifyUpstream(startPath) {\n    let parent = this.parent;\n    const path = startPath || [this.key];\n    while (parent) {\n      if (parent.patterns) parent.patterns.forEach(o => o.notify(path.slice()));\n      path.unshift(parent.key);\n      parent.links.forEach(l => l.notifiedUpstream(path, this.root));\n      parent.deps.forEach(d => d.handleChange(path));\n      parent.downstreamChanged(startPath);\n      parent = parent.parent;\n    }\n  }\n\n  rebind(next, previous, safe) {\n    if (this._link) {\n      this._link.rebind(next, previous, false);\n    }\n\n    // tell the deps to move to the new target\n    let i = this.deps.length;\n    while (i--) {\n      if (this.deps[i].rebind) this.deps[i].rebind(next, previous, safe);\n    }\n\n    i = this.links.length;\n    while (i--) {\n      const link = this.links[i];\n      // only relink the root of the link tree\n      if (link.owner && link.owner._link) link.relinking(next, safe);\n    }\n\n    i = this.children.length;\n    while (i--) {\n      const child = this.children[i];\n      child.rebind(next ? next.joinKey(child.key) : undefined, child, safe);\n    }\n\n    i = this.bindings.length;\n    while (i--) {\n      this.bindings[i].rebind(next, previous, safe);\n    }\n  }\n\n  reference() {\n    'refs' in this ? this.refs++ : (this.refs = 1);\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  registerPatternObserver(observer) {\n    (this.patterns || (this.patterns = [])).push(observer);\n    this.register(observer);\n  }\n\n  registerTwowayBinding(binding) {\n    this.bindings.push(binding);\n  }\n\n  unreference() {\n    if ('refs' in this) this.refs--;\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n\n  unregisterPatternObserver(observer) {\n    removeFromArray(this.patterns, observer);\n    this.unregister(observer);\n  }\n\n  unregisterTwowayBinding(binding) {\n    removeFromArray(this.bindings, binding);\n  }\n\n  updateFromBindings(cascade) {\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) this.set(value);\n    }\n\n    // check for one-way bindings if there are no two-ways\n    if (!this.bindings.length) {\n      const oneway = findBoundValue(this.deps);\n      if (oneway && oneway.value !== this.value) this.set(oneway.value);\n    }\n\n    if (cascade) {\n      this.children.forEach(updateFromBindings);\n      this.links.forEach(updateFromBindings);\n      if (this._link) this._link.updateFromBindings(cascade);\n    }\n  }\n}\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nexport function maybeBind(model, value, shouldBind) {\n  if (shouldBind && isFunction(value) && model.parent && model.parent.isRoot) {\n    if (!model.boundValue) {\n      model.boundValue = bind(value._r_unbound || value, model.parent.ractive);\n    }\n\n    return model.boundValue;\n  }\n\n  return value;\n}\n\nfunction updateFromBindings(model) {\n  model.updateFromBindings(true);\n}\n\nexport function findBoundValue(list) {\n  let i = list.length;\n  while (i--) {\n    if (list[i].bound) {\n      const owner = list[i].owner;\n      if (owner) {\n        const value = owner.name === 'checked' ? owner.node.checked : owner.node.value;\n        return { value };\n      }\n    }\n  }\n}\n\nexport function fireShuffleTasks(stage) {\n  if (!stage) {\n    fireShuffleTasks('early');\n    fireShuffleTasks('mark');\n  } else {\n    const tasks = shuffleTasks[stage];\n    shuffleTasks[stage] = [];\n    let i = tasks.length;\n    while (i--) tasks[i]();\n\n    const register = registerQueue[stage];\n    registerQueue[stage] = [];\n    i = register.length;\n    while (i--) register[i].model.register(register[i].item);\n  }\n}\n\nexport function shuffle(model, newIndices, link, unsafe) {\n  model.shuffling = true;\n\n  let i = newIndices.length;\n  while (i--) {\n    const idx = newIndices[i];\n    // nothing is actually changing, so move in the index and roll on\n    if (i === idx) {\n      continue;\n    }\n\n    // rebind the children on i to idx\n    if (i in model.childByKey)\n      model.childByKey[i].rebind(\n        !~idx ? undefined : model.joinKey(idx),\n        model.childByKey[i],\n        !unsafe\n      );\n  }\n\n  const upstream = model.source().length !== model.source().value.length;\n\n  model.links.forEach(l => l.shuffle(newIndices));\n  if (!link) fireShuffleTasks('early');\n\n  i = model.deps.length;\n  while (i--) {\n    if (model.deps[i].shuffle) model.deps[i].shuffle(newIndices);\n  }\n\n  model[link ? 'marked' : 'mark']();\n  if (!link) fireShuffleTasks('mark');\n\n  if (upstream) model.notifyUpstream();\n\n  model.shuffling = false;\n}\n","const stack = [];\nlet captureGroup;\n\nexport function startCapturing() {\n  stack.push((captureGroup = []));\n}\n\nexport function stopCapturing() {\n  const dependencies = stack.pop();\n  captureGroup = stack[stack.length - 1];\n  return dependencies;\n}\n\nexport function capture(model) {\n  if (captureGroup) {\n    captureGroup.push(model);\n  }\n}\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from 'shared/methodCallers';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn } from 'utils/object';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n  key: '@missing',\n  animate: noop,\n  applyValue: noop,\n  get: noop,\n  getKeypath() {\n    return this.key;\n  },\n  joinAll() {\n    return this;\n  },\n  joinKey() {\n    return this;\n  },\n  mark: noop,\n  registerLink: noop,\n  shufle: noop,\n  set: noop,\n  unregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n  constructor(parent, owner, target, key) {\n    super(parent);\n\n    this.owner = owner;\n    this.target = target;\n    this.key = key === undefined ? owner.key : key;\n    if (owner && owner.isLink) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n    if (target) target.registerLink(this);\n\n    if (parent) this.isReadonly = parent.isReadonly;\n\n    this.isLink = true;\n  }\n\n  animate(from, to, options, interpolator) {\n    return this.target.animate(from, to, options, interpolator);\n  }\n\n  applyValue(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.applyValue(value);\n  }\n\n  attach(fragment) {\n    const model = resolveReference(fragment, this.key);\n    if (model) {\n      this.relinking(model, false);\n    } else {\n      // if there is no link available, move everything here to real models\n      this.owner.unlink();\n    }\n  }\n\n  detach() {\n    this.relinking(Missing, false);\n  }\n\n  get(shouldCapture, opts = {}) {\n    if (shouldCapture) {\n      capture(this);\n\n      // may need to tell the target to unwrap\n      opts.unwrap = 'unwrap' in opts ? opts.unwrap : true;\n    }\n\n    const bind = 'shouldBind' in opts ? opts.shouldBind : true;\n    opts.shouldBind = this.mapping && this.target.parent && this.target.parent.isRoot;\n\n    return maybeBind(this, this.target.get(false, opts), bind);\n  }\n\n  getKeypath(ractive) {\n    if (ractive && ractive !== this.root.ractive) return this.target.getKeypath(ractive);\n\n    return super.getKeypath(ractive);\n  }\n\n  handleChange() {\n    this.deps.forEach(handleChange);\n    this.links.forEach(handleChange);\n    this.notifyUpstream();\n  }\n\n  isDetached() {\n    return this.virtual && this.target === Missing;\n  }\n\n  joinKey(key) {\n    // TODO: handle nested links\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new LinkModel(this, this, this.target.joinKey(key), key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    this.target.mark(force);\n  }\n\n  marked() {\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n\n    this.deps.forEach(handleChange);\n  }\n\n  markedAll() {\n    this.children.forEach(markedAll);\n    this.marked();\n  }\n\n  notifiedUpstream(startPath, root) {\n    this.links.forEach(l => l.notifiedUpstream(startPath, this.root));\n    this.deps.forEach(handleChange);\n    if (startPath && this.rootLink && this.root !== root) {\n      const path = startPath.slice(1);\n      path.unshift(this.key);\n      this.notifyUpstream(path);\n    }\n  }\n\n  relinked() {\n    this.target.registerLink(this);\n    this.children.forEach(c => c.relinked());\n  }\n\n  relinking(target, safe) {\n    if (this.rootLink && this.sourcePath)\n      target = rebindMatch(this.sourcePath, target, this.target);\n    if (!target || this.target === target) return;\n\n    this.target && this.target.unregisterLink(this);\n\n    this.target = target;\n    this.children.forEach(c => {\n      c.relinking(target.joinKey(c.key), safe);\n    });\n\n    if (this.rootLink)\n      this.addShuffleTask(() => {\n        this.relinked();\n        if (!safe) {\n          this.markedAll();\n          this.notifyUpstream();\n        }\n      });\n  }\n\n  set(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.set(value);\n  }\n\n  shuffle(newIndices) {\n    // watch for extra shuffles caused by a shuffle in a downstream link\n    if (this.shuffling) return;\n\n    // let the real model handle firing off shuffles\n    if (!this.target.shuffling) {\n      if (this.target.shuffle) {\n        this.target.shuffle(newIndices);\n      } else {\n        // the target is a computation, which can't shuffle\n        this.target.mark();\n      }\n    } else {\n      shuffle(this, newIndices, true);\n    }\n  }\n\n  source() {\n    if (this.target.source) return this.target.source();\n    else return this.target;\n  }\n\n  teardown() {\n    if (this._link) this._link.teardown();\n    this.target.unregisterLink(this);\n    this.children.forEach(teardown);\n  }\n}\n\nModelBase.prototype.link = function link(model, keypath, options) {\n  const lnk = this._link || new LinkModel(this.parent, this, model, this.key);\n  lnk.implicit = options && options.implicit;\n  lnk.mapping = options && options.mapping;\n  lnk.sourcePath = keypath;\n  lnk.rootLink = true;\n  if (this._link) this._link.relinking(model, false);\n  this.rebind(lnk, this, false);\n  fireShuffleTasks();\n\n  this._link = lnk;\n  lnk.markedAll();\n\n  this.notifyUpstream();\n  return lnk;\n};\n\nModelBase.prototype.unlink = function unlink() {\n  if (this._link) {\n    const ln = this._link;\n    this._link = undefined;\n    ln.rebind(this, ln, false);\n    fireShuffleTasks();\n    ln.teardown();\n    this.notifyUpstream();\n  }\n};\n","import { createFunction } from '../Ractive/config/runtime-parser';\nimport { create, keys } from 'utils/object';\n\nconst functions = create(null);\n\nexport default function getFunction(str, i) {\n  if (functions[str]) return functions[str];\n  return (functions[str] = createFunction(str, i));\n}\n\nexport function addFunctions(template) {\n  if (!template) return;\n\n  const exp = template.e;\n\n  if (!exp) return;\n\n  keys(exp).forEach(str => {\n    if (functions[str]) return;\n    functions[str] = exp[str];\n  });\n}\n","export const TEMPLATE_VERSION = 4;\n","import { warnIfDebug } from 'utils/log';\nimport { create, hasOwn } from 'utils/object';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function(message) {\n  this.name = 'ParseError';\n  this.message = message;\n  try {\n    throw new Error(message);\n  } catch (e) {\n    this.stack = e.stack;\n  }\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function(str, options) {\n  let item;\n  let lineStart = 0;\n\n  this.str = str;\n  this.options = options || {};\n  this.pos = 0;\n\n  this.lines = this.str.split('\\n');\n  this.lineEnds = this.lines.map(line => {\n    const lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n    lineStart = lineEnd;\n    return lineEnd;\n  }, 0);\n\n  // Custom init logic\n  if (this.init) this.init(str, options);\n\n  const items = [];\n\n  while (this.pos < this.str.length && (item = this.read())) {\n    items.push(item);\n  }\n\n  this.leftover = this.remaining();\n  this.result = this.postProcess ? this.postProcess(items, options) : items;\n};\n\nParser.prototype = {\n  read(converters) {\n    let i, item;\n\n    if (!converters) converters = this.converters;\n\n    const pos = this.pos;\n\n    const len = converters.length;\n    for (i = 0; i < len; i += 1) {\n      this.pos = pos; // reset for each attempt\n\n      if ((item = converters[i](this))) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  getContextMessage(pos, message) {\n    const [lineNum, columnNum] = this.getLinePos(pos);\n    if (this.options.contextLines === -1) {\n      return [lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}`];\n    }\n\n    const line = this.lines[lineNum - 1];\n\n    let contextUp = '';\n    let contextDown = '';\n    if (this.options.contextLines) {\n      const start =\n        lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n      contextUp = this.lines\n        .slice(start, lineNum - 1 - start)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      contextDown = this.lines\n        .slice(lineNum, lineNum + this.options.contextLines)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      if (contextUp) {\n        contextUp += '\\n';\n      }\n      if (contextDown) {\n        contextDown = '\\n' + contextDown;\n      }\n    }\n\n    let numTabs = 0;\n    const annotation =\n      contextUp +\n      line.replace(/\\t/g, (match, char) => {\n        if (char < columnNum) {\n          numTabs += 1;\n        }\n\n        return '  ';\n      }) +\n      '\\n' +\n      new Array(columnNum + numTabs).join(' ') +\n      '^----' +\n      contextDown;\n\n    return [\n      lineNum,\n      columnNum,\n      `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}`\n    ];\n  },\n\n  getLinePos(char) {\n    let lineNum = 0;\n    let lineStart = 0;\n\n    while (char >= this.lineEnds[lineNum]) {\n      lineStart = this.lineEnds[lineNum];\n      lineNum += 1;\n    }\n\n    const columnNum = char - lineStart;\n    return [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  },\n\n  error(message) {\n    const [lineNum, columnNum, msg] = this.getContextMessage(this.pos, message);\n\n    const error = new ParseError(msg);\n\n    error.line = lineNum;\n    error.character = columnNum;\n    error.shortMessage = message;\n\n    throw error;\n  },\n\n  matchString(string) {\n    if (this.str.substr(this.pos, string.length) === string) {\n      this.pos += string.length;\n      return string;\n    }\n  },\n\n  matchPattern(pattern) {\n    let match;\n\n    if ((match = pattern.exec(this.remaining()))) {\n      this.pos += match[0].length;\n      return match[1] || match[0];\n    }\n  },\n\n  sp() {\n    this.matchPattern(leadingWhitespace);\n  },\n\n  remaining() {\n    return this.str.substring(this.pos);\n  },\n\n  nextChar() {\n    return this.str.charAt(this.pos);\n  },\n\n  warn(message) {\n    const msg = this.getContextMessage(this.pos, message)[2];\n\n    warnIfDebug(msg);\n  }\n};\n\nParser.extend = function(proto) {\n  const Parent = this;\n  const Child = function(str, options) {\n    Parser.call(this, str, options);\n  };\n\n  Child.prototype = create(Parent.prototype);\n\n  for (const key in proto) {\n    if (hasOwn(proto, key)) {\n      Child.prototype[key] = proto[key];\n    }\n  }\n\n  Child.extend = Parser.extend;\n  return Child;\n};\n\nexport default Parser;\n","export const TEXT = 1;\nexport const INTERPOLATOR = 2;\nexport const TRIPLE = 3;\nexport const SECTION = 4;\nexport const INVERTED = 5;\nexport const CLOSING = 6;\nexport const ELEMENT = 7;\nexport const PARTIAL = 8;\nexport const COMMENT = 9;\nexport const DELIMCHANGE = 10;\nexport const ANCHOR = 11;\nexport const ATTRIBUTE = 13;\nexport const CLOSING_TAG = 14;\nexport const COMPONENT = 15;\nexport const YIELDER = 16;\nexport const INLINE_PARTIAL = 17;\nexport const DOCTYPE = 18;\nexport const ALIAS = 19;\n\nexport const AWAIT = 55;\n\nexport const NUMBER_LITERAL = 20;\nexport const STRING_LITERAL = 21;\nexport const ARRAY_LITERAL = 22;\nexport const OBJECT_LITERAL = 23;\nexport const BOOLEAN_LITERAL = 24;\nexport const REGEXP_LITERAL = 25;\n\nexport const GLOBAL = 26;\nexport const KEY_VALUE_PAIR = 27;\n\nexport const REFERENCE = 30;\nexport const REFINEMENT = 31;\nexport const MEMBER = 32;\nexport const PREFIX_OPERATOR = 33;\nexport const BRACKETED = 34;\nexport const CONDITIONAL = 35;\nexport const INFIX_OPERATOR = 36;\n\nexport const INVOCATION = 40;\n\nexport const SECTION_IF = 50;\nexport const SECTION_UNLESS = 51;\nexport const SECTION_EACH = 52;\nexport const SECTION_WITH = 53;\nexport const SECTION_IF_WITH = 54;\n\nexport const ELSE = 60;\nexport const ELSEIF = 61;\nexport const THEN = 62;\nexport const CATCH = 63;\n\nexport const EVENT = 70;\nexport const DECORATOR = 71;\nexport const TRANSITION = 72;\nexport const BINDING_FLAG = 73;\nexport const DELEGATE_FLAG = 74;\n","import { PREFIX_OPERATOR } from 'config/types';\nimport { expectedExpression } from './shared/errors';\nimport readMemberOrInvocation from './readMemberOrInvocation';\nimport readExpression from '../readExpression';\n\nlet readTypeOf;\n\nconst makePrefixSequenceMatcher = function(symbol, fallthrough) {\n  return function(parser) {\n    let expression;\n\n    if ((expression = fallthrough(parser))) {\n      return expression;\n    }\n\n    if (!parser.matchString(symbol)) {\n      return null;\n    }\n\n    parser.sp();\n\n    expression = readExpression(parser);\n    if (!expression) {\n      parser.error(expectedExpression);\n    }\n\n    return {\n      s: symbol,\n      o: expression,\n      t: PREFIX_OPERATOR\n    };\n  };\n};\n\n// create all prefix sequence matchers, return readTypeOf\n(function() {\n  let i, len, matcher, fallthrough;\n\n  const prefixOperators = '! ~ + - typeof'.split(' ');\n\n  fallthrough = readMemberOrInvocation;\n  for (i = 0, len = prefixOperators.length; i < len; i += 1) {\n    matcher = makePrefixSequenceMatcher(prefixOperators[i], fallthrough);\n    fallthrough = matcher;\n  }\n\n  // typeof operator is higher precedence than multiplication, so provides the\n  // fallthrough for the multiplication sequence matcher we're about to create\n  // (we're skipping void and delete)\n  readTypeOf = fallthrough;\n})();\n\nexport default readTypeOf;\n","const delimiterChangePattern = /^[^\\s=]+/;\nconst whitespacePattern = /^\\s+/;\n\nexport default function readDelimiterChange(parser) {\n  if (!parser.matchString('=')) {\n    return null;\n  }\n\n  const start = parser.pos;\n\n  // allow whitespace before new opening delimiter\n  parser.sp();\n\n  const opening = parser.matchPattern(delimiterChangePattern);\n  if (!opening) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace (in fact, it's necessary...)\n  if (!parser.matchPattern(whitespacePattern)) {\n    return null;\n  }\n\n  const closing = parser.matchPattern(delimiterChangePattern);\n  if (!closing) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace before closing '='\n  parser.sp();\n\n  if (!parser.matchString('=')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return [opening, closing];\n}\n","import { REGEXP_LITERAL } from '../../../../../config/types';\n\nconst regexpPattern = /^(\\/(?:[^\\n\\r\\u2028\\u2029/\\\\[]|\\\\.|\\[(?:[^\\n\\r\\u2028\\u2029\\]\\\\]|\\\\.)*])+\\/(?:([gimuy])(?![a-z]*\\2))*(?![a-zA-Z_$0-9]))/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(regexpPattern))) {\n    return {\n      t: REGEXP_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","const pattern = /[-/\\\\^$*+?.()|[\\]{}]/g;\n\nexport default function escapeRegExp(str) {\n  return str.replace(pattern, '\\\\$&');\n}\n","import escapeRegExp from 'utils/escapeRegExp';\n\nconst regExpCache = {};\n\nexport default function(haystack, needles) {\n  return haystack.search(\n    regExpCache[needles.join()] ||\n      (regExpCache[needles.join()] = new RegExp(needles.map(escapeRegExp).join('|')))\n  );\n}\n","import { keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nexport const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nconst htmlEntities = {\n  quot: 34,\n  amp: 38,\n  apos: 39,\n  lt: 60,\n  gt: 62,\n  nbsp: 160,\n  iexcl: 161,\n  cent: 162,\n  pound: 163,\n  curren: 164,\n  yen: 165,\n  brvbar: 166,\n  sect: 167,\n  uml: 168,\n  copy: 169,\n  ordf: 170,\n  laquo: 171,\n  not: 172,\n  shy: 173,\n  reg: 174,\n  macr: 175,\n  deg: 176,\n  plusmn: 177,\n  sup2: 178,\n  sup3: 179,\n  acute: 180,\n  micro: 181,\n  para: 182,\n  middot: 183,\n  cedil: 184,\n  sup1: 185,\n  ordm: 186,\n  raquo: 187,\n  frac14: 188,\n  frac12: 189,\n  frac34: 190,\n  iquest: 191,\n  Agrave: 192,\n  Aacute: 193,\n  Acirc: 194,\n  Atilde: 195,\n  Auml: 196,\n  Aring: 197,\n  AElig: 198,\n  Ccedil: 199,\n  Egrave: 200,\n  Eacute: 201,\n  Ecirc: 202,\n  Euml: 203,\n  Igrave: 204,\n  Iacute: 205,\n  Icirc: 206,\n  Iuml: 207,\n  ETH: 208,\n  Ntilde: 209,\n  Ograve: 210,\n  Oacute: 211,\n  Ocirc: 212,\n  Otilde: 213,\n  Ouml: 214,\n  times: 215,\n  Oslash: 216,\n  Ugrave: 217,\n  Uacute: 218,\n  Ucirc: 219,\n  Uuml: 220,\n  Yacute: 221,\n  THORN: 222,\n  szlig: 223,\n  agrave: 224,\n  aacute: 225,\n  acirc: 226,\n  atilde: 227,\n  auml: 228,\n  aring: 229,\n  aelig: 230,\n  ccedil: 231,\n  egrave: 232,\n  eacute: 233,\n  ecirc: 234,\n  euml: 235,\n  igrave: 236,\n  iacute: 237,\n  icirc: 238,\n  iuml: 239,\n  eth: 240,\n  ntilde: 241,\n  ograve: 242,\n  oacute: 243,\n  ocirc: 244,\n  otilde: 245,\n  ouml: 246,\n  divide: 247,\n  oslash: 248,\n  ugrave: 249,\n  uacute: 250,\n  ucirc: 251,\n  uuml: 252,\n  yacute: 253,\n  thorn: 254,\n  yuml: 255,\n  OElig: 338,\n  oelig: 339,\n  Scaron: 352,\n  scaron: 353,\n  Yuml: 376,\n  fnof: 402,\n  circ: 710,\n  tilde: 732,\n  Alpha: 913,\n  Beta: 914,\n  Gamma: 915,\n  Delta: 916,\n  Epsilon: 917,\n  Zeta: 918,\n  Eta: 919,\n  Theta: 920,\n  Iota: 921,\n  Kappa: 922,\n  Lambda: 923,\n  Mu: 924,\n  Nu: 925,\n  Xi: 926,\n  Omicron: 927,\n  Pi: 928,\n  Rho: 929,\n  Sigma: 931,\n  Tau: 932,\n  Upsilon: 933,\n  Phi: 934,\n  Chi: 935,\n  Psi: 936,\n  Omega: 937,\n  alpha: 945,\n  beta: 946,\n  gamma: 947,\n  delta: 948,\n  epsilon: 949,\n  zeta: 950,\n  eta: 951,\n  theta: 952,\n  iota: 953,\n  kappa: 954,\n  lambda: 955,\n  mu: 956,\n  nu: 957,\n  xi: 958,\n  omicron: 959,\n  pi: 960,\n  rho: 961,\n  sigmaf: 962,\n  sigma: 963,\n  tau: 964,\n  upsilon: 965,\n  phi: 966,\n  chi: 967,\n  psi: 968,\n  omega: 969,\n  thetasym: 977,\n  upsih: 978,\n  piv: 982,\n  ensp: 8194,\n  emsp: 8195,\n  thinsp: 8201,\n  zwnj: 8204,\n  zwj: 8205,\n  lrm: 8206,\n  rlm: 8207,\n  ndash: 8211,\n  mdash: 8212,\n  lsquo: 8216,\n  rsquo: 8217,\n  sbquo: 8218,\n  ldquo: 8220,\n  rdquo: 8221,\n  bdquo: 8222,\n  dagger: 8224,\n  Dagger: 8225,\n  bull: 8226,\n  hellip: 8230,\n  permil: 8240,\n  prime: 8242,\n  Prime: 8243,\n  lsaquo: 8249,\n  rsaquo: 8250,\n  oline: 8254,\n  frasl: 8260,\n  euro: 8364,\n  image: 8465,\n  weierp: 8472,\n  real: 8476,\n  trade: 8482,\n  alefsym: 8501,\n  larr: 8592,\n  uarr: 8593,\n  rarr: 8594,\n  darr: 8595,\n  harr: 8596,\n  crarr: 8629,\n  lArr: 8656,\n  uArr: 8657,\n  rArr: 8658,\n  dArr: 8659,\n  hArr: 8660,\n  forall: 8704,\n  part: 8706,\n  exist: 8707,\n  empty: 8709,\n  nabla: 8711,\n  isin: 8712,\n  notin: 8713,\n  ni: 8715,\n  prod: 8719,\n  sum: 8721,\n  minus: 8722,\n  lowast: 8727,\n  radic: 8730,\n  prop: 8733,\n  infin: 8734,\n  ang: 8736,\n  and: 8743,\n  or: 8744,\n  cap: 8745,\n  cup: 8746,\n  int: 8747,\n  there4: 8756,\n  sim: 8764,\n  cong: 8773,\n  asymp: 8776,\n  ne: 8800,\n  equiv: 8801,\n  le: 8804,\n  ge: 8805,\n  sub: 8834,\n  sup: 8835,\n  nsub: 8836,\n  sube: 8838,\n  supe: 8839,\n  oplus: 8853,\n  otimes: 8855,\n  perp: 8869,\n  sdot: 8901,\n  lceil: 8968,\n  rceil: 8969,\n  lfloor: 8970,\n  rfloor: 8971,\n  lang: 9001,\n  rang: 9002,\n  loz: 9674,\n  spades: 9824,\n  clubs: 9827,\n  hearts: 9829,\n  diams: 9830\n};\nconst controlCharacters = [\n  8364,\n  129,\n  8218,\n  402,\n  8222,\n  8230,\n  8224,\n  8225,\n  710,\n  8240,\n  352,\n  8249,\n  338,\n  141,\n  381,\n  143,\n  144,\n  8216,\n  8217,\n  8220,\n  8221,\n  8226,\n  8211,\n  8212,\n  732,\n  8482,\n  353,\n  8250,\n  339,\n  157,\n  382,\n  376\n];\nconst entityPattern = new RegExp(\n  '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + keys(htmlEntities).join('|') + '));?',\n  'g'\n);\nconst codePointSupport = isFunction(String.fromCodePoint);\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences(html) {\n  return html.replace(entityPattern, (match, entity) => {\n    let code;\n\n    // Handle named entities\n    if (entity[0] !== '#') {\n      code = htmlEntities[entity];\n    } else if (entity[1] === 'x') {\n      code = parseInt(entity.substring(2), 16);\n    } else {\n      code = parseInt(entity.substring(1), 10);\n    }\n\n    if (!code) {\n      return match;\n    }\n\n    return codeToChar(validateCode(code));\n  });\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml(str) {\n  return str\n    .replace(amp, '&amp;')\n    .replace(lessThan, '&lt;')\n    .replace(greaterThan, '&gt;');\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n/* istanbul ignore next */\nfunction validateCode(code) {\n  if (!code) {\n    return invalid;\n  }\n\n  // line feed becomes generic whitespace\n  if (code === 10) {\n    return 32;\n  }\n\n  // ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  if (code < 128) {\n    return code;\n  }\n\n  // code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  // to correct the mistake or we'll end up with missing  signs and so on\n  if (code <= 159) {\n    return controlCharacters[code - 128];\n  }\n\n  // basic multilingual plane\n  if (code < 55296) {\n    return code;\n  }\n\n  // UTF-16 surrogate halves\n  if (code <= 57343) {\n    return invalid;\n  }\n\n  // rest of the basic multilingual plane\n  if (code <= 65535) {\n    return code;\n  } else if (!codePointSupport) {\n    return invalid;\n  }\n\n  // supplementary multilingual plane 0x10000 - 0x1ffff\n  if (code >= 65536 && code <= 131071) {\n    return code;\n  }\n\n  // supplementary ideographic plane 0x20000 - 0x2ffff\n  if (code >= 131072 && code <= 196607) {\n    return code;\n  }\n\n  return invalid;\n}\n","export const expectedExpression = 'Expected a JavaScript expression';\nexport const expectedParen = 'Expected closing paren';\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(numberPattern))) {\n    return {\n      t: NUMBER_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function(okQuote) {\n  return function(parser) {\n    let literal = '\"';\n    let done = false;\n    let next;\n\n    while (!done) {\n      next =\n        parser.matchPattern(stringMiddlePattern) ||\n        parser.matchPattern(escapeSequencePattern) ||\n        parser.matchString(okQuote);\n      if (next) {\n        if (next === `\"`) {\n          literal += `\\\\\"`;\n        } else if (next === `\\\\'`) {\n          literal += `'`;\n        } else {\n          literal += next;\n        }\n      } else {\n        next = parser.matchPattern(lineContinuationPattern);\n        if (next) {\n          // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n          literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n        } else {\n          done = true;\n        }\n      }\n    }\n\n    literal += '\"';\n\n    // use JSON.parse to interpret escapes\n    return JSON.parse(literal);\n  };\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher(`\"`);\nconst doubleMatcher = makeQuotedStringMatcher(`'`);\n\nexport default function(parser) {\n  const start = parser.pos;\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n\n  if (quote) {\n    const string = (quote === `'` ? singleMatcher : doubleMatcher)(parser);\n\n    if (!parser.matchString(quote)) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: STRING_LITERAL,\n      v: string\n    };\n  }\n\n  return null;\n}\n","import readExpression from '../../../readExpression';\nimport { STRING_LITERAL, BRACKETED, INFIX_OPERATOR } from '../../../../../config/types';\nimport {\n  escapeSequencePattern,\n  lineContinuationPattern\n} from './stringLiteral/makeQuotedStringMatcher';\n\n// Match one or more characters until: \", ', or \\\nconst stringMiddlePattern = /^[^`\"\\\\\\$]+?(?:(?=[`\"\\\\\\$]))/;\n\nconst escapes = /[\\r\\n\\t\\b\\f]/g;\nfunction getString(literal) {\n  return JSON.parse(`\"${literal.replace(escapes, escapeChar)}\"`);\n}\n\nfunction escapeChar(c) {\n  switch (c) {\n    case '\\n':\n      return '\\\\n';\n    case '\\r':\n      return '\\\\r';\n    case '\\t':\n      return '\\\\t';\n    case '\\b':\n      return '\\\\b';\n    case '\\f':\n      return '\\\\f';\n  }\n}\n\nexport default function readTemplateStringLiteral(parser) {\n  if (!parser.matchString('`')) return null;\n\n  let literal = '';\n  let done = false;\n  let next;\n  const parts = [];\n\n  while (!done) {\n    next =\n      parser.matchPattern(stringMiddlePattern) ||\n      parser.matchPattern(escapeSequencePattern) ||\n      parser.matchString('$') ||\n      parser.matchString('\"');\n    if (next) {\n      if (next === `\"`) {\n        literal += `\\\\\"`;\n      } else if (next === '\\\\`') {\n        literal += '`';\n      } else if (next === '$') {\n        if (parser.matchString('{')) {\n          parts.push({ t: STRING_LITERAL, v: getString(literal) });\n          literal = '';\n\n          parser.sp();\n          const expr = readExpression(parser);\n\n          if (!expr) parser.error('Expected valid expression');\n\n          parts.push({ t: BRACKETED, x: expr });\n\n          parser.sp();\n          if (!parser.matchString('}'))\n            parser.error(`Expected closing '}' after interpolated expression`);\n        } else {\n          literal += '$';\n        }\n      } else {\n        literal += next;\n      }\n    } else {\n      next = parser.matchPattern(lineContinuationPattern);\n      if (next) {\n        // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n        literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n      } else {\n        done = true;\n      }\n    }\n  }\n\n  if (literal.length) parts.push({ t: STRING_LITERAL, v: getString(literal) });\n\n  if (!parser.matchString('`')) parser.error(\"Expected closing '`'\");\n\n  if (parts.length === 1) {\n    return parts[0];\n  } else {\n    let result = parts.pop();\n    let part;\n\n    while ((part = parts.pop())) {\n      result = {\n        t: INFIX_OPERATOR,\n        s: '+',\n        o: [part, result]\n      };\n    }\n\n    return {\n      t: BRACKETED,\n      x: result\n    };\n  }\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey(parser) {\n  let token;\n\n  if ((token = readStringLiteral(parser))) {\n    return identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  }\n\n  if ((token = readNumberLiteral(parser))) {\n    return token.v;\n  }\n\n  if ((token = parser.matchPattern(namePattern))) {\n    return token;\n  }\n\n  return null;\n}\n","import { BRACKETED, GLOBAL, REFERENCE } from 'src/config/types';\nimport { normalise } from 'src/shared/keypaths';\nimport { legalReference, relaxedName } from '../shared/patterns';\n\n// if a reference is a browser global, we don't deference it later, so it needs special treatment\nconst globals = /^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null|Object|Number|String|Boolean)\\b/;\n\n// keywords are not valid references, with the exception of `this`\nconst keywords = /^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;\n\nconst prefixPattern = /^(?:\\@\\.|\\@|~\\/|(?:\\^\\^\\/(?:\\^\\^\\/)*(?:\\.\\.\\/)*)|(?:\\.\\.\\/)+|\\.\\/(?:\\.\\.\\/)*|\\.)/;\nconst specials = /^(key|index|keypath|rootpath|this|global|shared|context|event|node|local|style|helpers|last)/;\n\nexport default function readReference(parser) {\n  let prefix, name, global, reference, lastDotIndex;\n\n  const startPos = parser.pos;\n\n  prefix = parser.matchPattern(prefixPattern) || '';\n  name =\n    (!prefix && parser.relaxedNames && parser.matchPattern(relaxedName)) ||\n    parser.matchPattern(legalReference);\n  const actual = prefix.length + ((name && name.length) || 0);\n\n  if (prefix === '@.') {\n    prefix = '@';\n    if (name) name = 'this.' + name;\n    else name = 'this';\n  }\n\n  if (!name && prefix) {\n    name = prefix;\n    prefix = '';\n  }\n\n  if (!name) {\n    return null;\n  }\n\n  if (prefix === '@') {\n    if (!specials.test(name)) {\n      parser.error(`Unrecognized special reference @${name}`);\n    } else if ((~name.indexOf('event') || ~name.indexOf('node')) && !parser.inEvent) {\n      parser.error(`@event and @node are only valid references within an event directive`);\n    } else if (~name.indexOf('context')) {\n      parser.pos = parser.pos - (name.length - 7);\n      return {\n        t: BRACKETED,\n        x: {\n          t: REFERENCE,\n          n: '@context'\n        }\n      };\n    }\n  }\n\n  // bug out if it's a keyword (exception for ancestor/restricted refs - see https://github.com/ractivejs/ractive/issues/1497)\n  if (!prefix && !parser.relaxedNames && keywords.test(name)) {\n    parser.pos = startPos;\n    return null;\n  }\n\n  // if this is a browser global, stop here\n  if (!prefix && globals.test(name)) {\n    global = globals.exec(name)[0];\n    parser.pos = startPos + global.length;\n\n    return {\n      t: GLOBAL,\n      v: global\n    };\n  }\n\n  reference = (prefix || '') + normalise(name);\n\n  if (parser.matchString('(')) {\n    // if this is a method invocation (as opposed to a function) we need\n    // to strip the method name from the reference combo, else the context\n    // will be wrong\n    // but only if the reference was actually a member and not a refinement\n    lastDotIndex = reference.lastIndexOf('.');\n    if (lastDotIndex !== -1 && name[name.length - 1] !== ']') {\n      if (lastDotIndex === 0) {\n        reference = '.';\n        parser.pos = startPos;\n      } else {\n        const refLength = reference.length;\n        reference = reference.substr(0, lastDotIndex);\n        parser.pos = startPos + (actual - (refLength - lastDotIndex));\n      }\n    } else {\n      parser.pos -= 1;\n    }\n  }\n\n  return {\n    t: REFERENCE,\n    n: reference.replace(/^this\\./, './').replace(/^this$/, '.')\n  };\n}\n","import { INFIX_OPERATOR } from 'config/types';\nimport readTypeof from './readTypeof';\n\nlet readLogicalOr;\n\nconst makeInfixSequenceMatcher = function(symbol, fallthrough) {\n  return function(parser) {\n    // > and / have to be quoted\n    if (parser.inUnquotedAttribute && (symbol === '>' || symbol === '/'))\n      return fallthrough(parser);\n\n    let start, left, right;\n\n    left = fallthrough(parser);\n    if (!left) {\n      return null;\n    }\n\n    // Loop to handle left-recursion in a case like `a * b * c` and produce\n    // left association, i.e. `(a * b) * c`.  The matcher can't call itself\n    // to parse `left` because that would be infinite regress.\n    while (true) {\n      start = parser.pos;\n\n      parser.sp();\n\n      if (!parser.matchString(symbol)) {\n        parser.pos = start;\n        return left;\n      }\n\n      // special case - in operator must not be followed by [a-zA-Z_$0-9]\n      if (symbol === 'in' && /[a-zA-Z_$0-9]/.test(parser.remaining().charAt(0))) {\n        parser.pos = start;\n        return left;\n      }\n\n      parser.sp();\n\n      // right operand must also consist of only higher-precedence operators\n      right = fallthrough(parser);\n      if (!right) {\n        parser.pos = start;\n        return left;\n      }\n\n      left = {\n        t: INFIX_OPERATOR,\n        s: symbol,\n        o: [left, right]\n      };\n\n      // Loop back around.  If we don't see another occurrence of the symbol,\n      // we'll return left.\n    }\n  };\n};\n\n// create all infix sequence matchers, and return readLogicalOr\n(function() {\n  let i, len, matcher, fallthrough;\n\n  // All the infix operators on order of precedence (source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)\n  // Each sequence matcher will initially fall through to its higher precedence\n  // neighbour, and only attempt to match if one of the higher precedence operators\n  // (or, ultimately, a literal, reference, or bracketed expression) already matched\n  const infixOperators = '* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||'.split(\n    ' '\n  );\n\n  // A typeof operator is higher precedence than multiplication\n  fallthrough = readTypeof;\n  for (i = 0, len = infixOperators.length; i < len; i += 1) {\n    matcher = makeInfixSequenceMatcher(infixOperators[i], fallthrough);\n    fallthrough = matcher;\n  }\n\n  // Logical OR is the fallthrough for the conditional matcher\n  readLogicalOr = fallthrough;\n})();\n\nexport default readLogicalOr;\n","import {\n  ARRAY_LITERAL,\n  ATTRIBUTE,\n  DECORATOR,\n  DELEGATE_FLAG,\n  BINDING_FLAG,\n  INTERPOLATOR,\n  TRANSITION,\n  EVENT\n} from '../../../config/types';\nimport getLowestIndex from '../utils/getLowestIndex';\nimport readMustache from '../readMustache';\nimport { decodeCharacterReferences } from 'src/utils/html';\nimport readExpressionList from '../expressions/shared/readExpressionList';\nimport readExpressionOrReference from '../readExpressionOrReference';\nimport flattenExpression from 'parse/utils/flattenExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { isString } from 'utils/is';\n\nconst attributeNamePattern = /^[^\\s\"'>\\/=(]+/;\nconst onPattern = /^on/;\nconst eventPattern = /^on-([a-zA-Z\\*\\.$_]((?:[a-zA-Z\\*\\.$_0-9\\-]|\\\\-)+))$/;\nconst reservedEventNames = /^(?:change|reset|teardown|update|construct|config|init|render|complete|unrender|detach|insert|destruct|attachchild|detachchild)$/;\nconst decoratorPattern = /^as-([a-z-A-Z][-a-zA-Z_0-9]*)$/;\nconst transitionPattern = /^([a-zA-Z](?:(?!-in-out)[-a-zA-Z_0-9])*)-(in|out|in-out)$/;\nconst boundPattern = /^((bind|class)-(([-a-zA-Z0-9_])+))$/;\nconst directives = {\n  lazy: { t: BINDING_FLAG, v: 'l' },\n  twoway: { t: BINDING_FLAG, v: 't' },\n  'no-delegation': { t: DELEGATE_FLAG }\n};\nconst unquotedAttributeValueTextPattern = /^[^\\s\"'=<>\\/`]+/;\nconst proxyEvent = /^[^\\s\"'=<>@\\[\\]()]*/;\nconst whitespace = /^\\s+/;\n\nconst slashes = /\\\\/g;\nfunction splitEvent(str) {\n  const result = [];\n  let s = 0;\n\n  for (let i = 0; i < str.length; i++) {\n    if (str[i] === '-' && str[i - 1] !== '\\\\') {\n      result.push(str.substring(s, i).replace(slashes, ''));\n      s = i + 1;\n    }\n  }\n\n  result.push(str.substring(s).replace(slashes, ''));\n\n  return result;\n}\n\nexport default function readAttribute(parser) {\n  let name, i, nearest, idx;\n\n  parser.sp();\n\n  name = parser.matchPattern(attributeNamePattern);\n  if (!name) {\n    return null;\n  }\n\n  // check for accidental delimiter consumption e.g. <tag bool{{>attrs}} />\n  nearest = name.length;\n  for (i = 0; i < parser.tags.length; i++) {\n    if (~(idx = name.indexOf(parser.tags[i].open))) {\n      if (idx < nearest) nearest = idx;\n    }\n  }\n  if (nearest < name.length) {\n    parser.pos -= name.length - nearest;\n    name = name.substr(0, nearest);\n    if (!name) return null;\n  }\n\n  return { n: name };\n}\n\nfunction readAttributeValue(parser) {\n  const start = parser.pos;\n\n  // next character must be `=`, `/`, `>` or whitespace\n  if (!/[=\\/>\\s]/.test(parser.nextChar())) {\n    parser.error('Expected `=`, `/`, `>` or whitespace');\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('=')) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  const valueStart = parser.pos;\n  const startDepth = parser.sectionDepth;\n\n  const value =\n    readQuotedAttributeValue(parser, `'`) ||\n    readQuotedAttributeValue(parser, `\"`) ||\n    readUnquotedAttributeValue(parser);\n\n  if (value === null) {\n    parser.error('Expected valid attribute value');\n  }\n\n  if (parser.sectionDepth !== startDepth) {\n    parser.pos = valueStart;\n    parser.error(\n      'An attribute value must contain as many opening section tags as closing section tags'\n    );\n  }\n\n  if (!value.length) {\n    return '';\n  }\n\n  if (value.length === 1 && isString(value[0])) {\n    return decodeCharacterReferences(value[0]);\n  }\n\n  return value;\n}\n\nfunction readUnquotedAttributeValueToken(parser) {\n  let text, index;\n\n  const start = parser.pos;\n\n  text = parser.matchPattern(unquotedAttributeValueTextPattern);\n\n  if (!text) {\n    return null;\n  }\n\n  const haystack = text;\n  const needles = parser.tags.map(t => t.open); // TODO refactor... we do this in readText.js as well\n\n  if ((index = getLowestIndex(haystack, needles)) !== -1) {\n    text = text.substr(0, index);\n    parser.pos = start + text.length;\n  }\n\n  return text;\n}\n\nfunction readUnquotedAttributeValue(parser) {\n  parser.inAttribute = true;\n\n  const tokens = [];\n\n  let token = readMustache(parser) || readUnquotedAttributeValueToken(parser);\n  while (token) {\n    tokens.push(token);\n    token = readMustache(parser) || readUnquotedAttributeValueToken(parser);\n  }\n\n  if (!tokens.length) {\n    return null;\n  }\n\n  parser.inAttribute = false;\n  return tokens;\n}\n\nfunction readQuotedAttributeValue(parser, quoteMark) {\n  const start = parser.pos;\n\n  if (!parser.matchString(quoteMark)) {\n    return null;\n  }\n\n  parser.inAttribute = quoteMark;\n\n  const tokens = [];\n\n  let token = readMustache(parser) || readQuotedStringToken(parser, quoteMark);\n  while (token !== null) {\n    tokens.push(token);\n    token = readMustache(parser) || readQuotedStringToken(parser, quoteMark);\n  }\n\n  if (!parser.matchString(quoteMark)) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.inAttribute = false;\n\n  return tokens;\n}\n\nfunction readQuotedStringToken(parser, quoteMark) {\n  const haystack = parser.remaining();\n\n  const needles = parser.tags.map(t => t.open); // TODO refactor... we do this in readText.js as well\n  needles.push(quoteMark);\n\n  const index = getLowestIndex(haystack, needles);\n\n  if (index === -1) {\n    parser.error('Quoted attribute value must have a closing quote');\n  }\n\n  if (!index) {\n    return null;\n  }\n\n  parser.pos += index;\n  return haystack.substr(0, index);\n}\n\nexport function readAttributeOrDirective(parser) {\n  let match, directive;\n\n  const attribute = readAttribute(parser, false);\n\n  if (!attribute) return null;\n\n  // lazy, twoway\n  if ((directive = directives[attribute.n])) {\n    attribute.t = directive.t;\n    if (directive.v) attribute.v = directive.v;\n    delete attribute.n; // no name necessary\n    parser.sp();\n    if (parser.nextChar() === '=') attribute.f = readAttributeValue(parser);\n  } else if ((match = decoratorPattern.exec(attribute.n))) {\n    // decorators\n    attribute.n = match[1];\n    attribute.t = DECORATOR;\n    readArguments(parser, attribute);\n  } else if ((match = transitionPattern.exec(attribute.n))) {\n    // transitions\n    attribute.n = match[1];\n    attribute.t = TRANSITION;\n    readArguments(parser, attribute);\n    attribute.v = match[2] === 'in-out' ? 't0' : match[2] === 'in' ? 't1' : 't2';\n  } else if ((match = eventPattern.exec(attribute.n))) {\n    // on-click etc\n    attribute.n = splitEvent(match[1]);\n    attribute.t = EVENT;\n\n    if (parser.matchString('(')) {\n      attribute.a = flattenExpression({\n        t: ARRAY_LITERAL,\n        m: readExpressionList(parser)\n      });\n      if (!parser.matchString(')')) parser.error(`Expected closing ')'`);\n    }\n\n    parser.inEvent = true;\n\n    // check for a proxy event\n    if (!readProxyEvent(parser, attribute)) {\n      // otherwise, it's an expression\n      readArguments(parser, attribute, true);\n    } else if (reservedEventNames.test(attribute.f)) {\n      parser.pos -= attribute.f.length;\n      parser.error(\n        'Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, complete, detach, insert, destruct, attachchild, detachchild)'\n      );\n    }\n\n    parser.inEvent = false;\n  } else if ((match = boundPattern.exec(attribute.n))) {\n    // bound directives\n    const bind = match[2] === 'bind';\n    attribute.n = bind ? match[3] : match[1];\n    attribute.t = ATTRIBUTE;\n    readArguments(parser, attribute, false, true);\n\n    if (!attribute.f && bind) {\n      attribute.f = [{ t: INTERPOLATOR, r: match[3] }];\n    }\n  } else {\n    parser.sp();\n    const value = parser.nextChar() === '=' ? readAttributeValue(parser) : null;\n    attribute.f = value != null ? value : attribute.f;\n\n    if (parser.sanitizeEventAttributes && onPattern.test(attribute.n)) {\n      return { exclude: true };\n    } else {\n      attribute.f = attribute.f || (attribute.f === '' ? '' : 0);\n      attribute.t = ATTRIBUTE;\n    }\n  }\n\n  return attribute;\n}\n\nfunction readProxyEvent(parser, attribute) {\n  const start = parser.pos;\n  if (!parser.matchString('=')) parser.error(`Missing required directive arguments`);\n\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n  parser.sp();\n  const proxy = parser.matchPattern(proxyEvent);\n\n  if (proxy !== undefined) {\n    if (quote) {\n      parser.sp();\n      if (!parser.matchString(quote)) parser.pos = start;\n      else return (attribute.f = proxy) || true;\n    } else if (!parser.matchPattern(whitespace)) {\n      parser.pos = start;\n    } else {\n      return (attribute.f = proxy) || true;\n    }\n  } else {\n    parser.pos = start;\n  }\n}\n\nfunction readArguments(parser, attribute, required = false, single = false) {\n  parser.sp();\n  if (!parser.matchString('=')) {\n    if (required) parser.error(`Missing required directive arguments`);\n    return;\n  }\n  parser.sp();\n\n  const quote = parser.matchString('\"') || parser.matchString(\"'\");\n  const spread = parser.spreadArgs;\n  parser.spreadArgs = true;\n  parser.inUnquotedAttribute = !quote;\n  const expr = single\n    ? readExpressionOrReference(parser, [quote || ' ', '/', '>'])\n    : { m: readExpressionList(parser), t: ARRAY_LITERAL };\n  parser.inUnquotedAttribute = false;\n  parser.spreadArgs = spread;\n\n  if (quote) {\n    parser.sp();\n    if (parser.matchString(quote) !== quote) parser.error(`Expected matching quote '${quote}'`);\n  }\n\n  if (single) {\n    const interpolator = { t: INTERPOLATOR };\n    refineExpression(expr, interpolator);\n    attribute.f = [interpolator];\n  } else {\n    attribute.f = flattenExpression(expr);\n  }\n}\n","import { DELIMCHANGE } from 'config/types';\nimport readDelimiterChange from './mustache/readDelimiterChange';\nimport readRegexpLiteral from './expressions/primary/literal/readRegexpLiteral';\nimport { readAttributeOrDirective } from './element/readAttribute';\n\nconst delimiterChangeToken = { t: DELIMCHANGE, exclude: true };\n\nexport default function readMustache(parser) {\n  let mustache, i;\n\n  // If we're inside a <script> or <style> tag, and we're not\n  // interpolating, bug out\n  if (parser.interpolate[parser.inside] === false) {\n    return null;\n  }\n\n  for (i = 0; i < parser.tags.length; i += 1) {\n    if ((mustache = readMustacheOfType(parser, parser.tags[i]))) {\n      return mustache;\n    }\n  }\n\n  if (parser.inTag && !parser.inAttribute) {\n    mustache = readAttributeOrDirective(parser);\n    if (mustache) {\n      parser.sp();\n      return mustache;\n    }\n  }\n}\n\nfunction readMustacheOfType(parser, tag) {\n  let mustache, reader, i;\n\n  const start = parser.pos;\n\n  if (parser.matchString('\\\\' + tag.open)) {\n    if (start === 0 || parser.str[start - 1] !== '\\\\') {\n      return tag.open;\n    }\n  } else if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  // delimiter change?\n  if ((mustache = readDelimiterChange(parser))) {\n    // find closing delimiter or abort...\n    if (!parser.matchString(tag.close)) {\n      return null;\n    }\n\n    // ...then make the switch\n    tag.open = mustache[0];\n    tag.close = mustache[1];\n    parser.sortMustacheTags();\n\n    return delimiterChangeToken;\n  }\n\n  parser.sp();\n\n  // illegal section closer\n  if (parser.matchString('/')) {\n    parser.pos -= 1;\n    const rewind = parser.pos;\n    if (!readRegexpLiteral(parser)) {\n      parser.pos = rewind - tag.close.length;\n      if (parser.inAttribute) {\n        parser.pos = start;\n        return null;\n      } else {\n        parser.error(\"Attempted to close a section that wasn't open\");\n      }\n    } else {\n      parser.pos = rewind;\n    }\n  }\n\n  for (i = 0; i < tag.readers.length; i += 1) {\n    reader = tag.readers[i];\n\n    if ((mustache = reader(parser, tag))) {\n      if (tag.isStatic) {\n        mustache.s = 1;\n      }\n\n      if (parser.includeLinePositions) {\n        mustache.p = parser.getLinePos(start);\n      }\n\n      return mustache;\n    }\n  }\n\n  parser.pos = start;\n  return null;\n}\n","import readExpression from '../readExpression';\nimport refineExpression from '../../utils/refineExpression';\n\nconst legalAlias = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nconst asRE = /^as/i;\n\nexport function readAliases(parser) {\n  const aliases = [];\n  let alias;\n  const start = parser.pos;\n\n  parser.sp();\n\n  alias = readAlias(parser);\n\n  if (alias) {\n    alias.x = refineExpression(alias.x, {});\n    aliases.push(alias);\n\n    parser.sp();\n\n    while (parser.matchString(',')) {\n      alias = readAlias(parser);\n\n      if (!alias) {\n        parser.error('Expected another alias.');\n      }\n\n      alias.x = refineExpression(alias.x, {});\n      aliases.push(alias);\n\n      parser.sp();\n    }\n\n    return aliases;\n  }\n\n  parser.pos = start;\n  return null;\n}\n\nexport function readAlias(parser) {\n  const start = parser.pos;\n\n  parser.sp();\n\n  const expr = readExpression(parser, []);\n\n  if (!expr) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n  parser.matchPattern(asRE);\n  parser.sp();\n\n  const alias = parser.matchPattern(legalAlias);\n\n  if (!alias) {\n    parser.pos = start;\n    return null;\n  }\n\n  return { n: alias, x: expr };\n}\n","import { CATCH, ELSE, ELSEIF, THEN } from 'config/types';\nimport readExpression from '../../readExpression';\nimport { name } from '../../expressions/shared/patterns';\n\nconst patterns = {\n  else: /^\\s*else\\s*/,\n  elseif: /^\\s*elseif\\s+/,\n  then: /^\\s*then\\s*/,\n  catch: /^\\s*catch\\s*/\n};\n\nconst types = {\n  else: ELSE,\n  elseif: ELSEIF,\n  then: THEN,\n  catch: CATCH\n};\n\nexport default function readInlineBlock(parser, tag, type) {\n  const start = parser.pos;\n\n  if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  if (!parser.matchPattern(patterns[type])) {\n    parser.pos = start;\n    return null;\n  }\n\n  const res = { t: types[type] };\n\n  if (type === 'elseif') {\n    res.x = readExpression(parser);\n  } else if (type === 'catch' || type === 'then') {\n    const nm = parser.matchPattern(name);\n    if (nm) res.n = nm;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  return res;\n}\n","import { SECTION_EACH, SECTION_IF, SECTION_IF_WITH, SECTION_UNLESS } from 'config/types';\n\nexport default {\n  each: SECTION_EACH,\n  if: SECTION_IF,\n  with: SECTION_IF_WITH,\n  unless: SECTION_UNLESS\n};\n","import {\n  ALIAS,\n  AWAIT,\n  CATCH,\n  ELSE,\n  ELSEIF,\n  SECTION,\n  SECTION_IF,\n  SECTION_UNLESS,\n  THEN\n} from 'config/types';\nimport { READERS } from 'parse/_parse';\nimport readClosing from './section/readClosing';\nimport readInlineBlock from './section/readInlineBlock';\nimport handlebarsBlockCodes from './handlebarsBlockCodes';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { readAlias, readAliases } from './readAliases';\nimport { keys } from 'utils/object';\nimport { name } from '../expressions/shared/patterns';\n\nconst indexRefPattern = /^\\s*:\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nconst keyIndexRefPattern = /^\\s*,\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nconst handlebarsBlockPattern = new RegExp('^(' + keys(handlebarsBlockCodes).join('|') + ')\\\\b');\n\nexport default function readSection(parser, tag) {\n  let expression,\n    section,\n    child,\n    children,\n    hasElse,\n    block,\n    unlessBlock,\n    closed,\n    i,\n    expectedClose,\n    hasThen,\n    hasCatch,\n    inlineThen;\n  let aliasOnly = false;\n\n  const start = parser.pos;\n\n  if (parser.matchString('^')) {\n    // watch out for parent context refs - {{^^/^^/foo}}\n    if (parser.matchString('^/')) {\n      parser.pos = start;\n      return null;\n    }\n    section = { t: SECTION, f: [], n: SECTION_UNLESS };\n  } else if (parser.matchString('#')) {\n    section = { t: SECTION, f: [] };\n\n    if (parser.matchString('partial')) {\n      parser.pos = start - parser.standardDelimiters[0].length;\n      parser.error(\n        'Partial definitions can only be at the top level of the template, or immediately inside components'\n      );\n    }\n\n    if ((block = parser.matchString('await'))) {\n      expectedClose = block;\n      section.t = AWAIT;\n    } else if ((block = parser.matchPattern(handlebarsBlockPattern))) {\n      expectedClose = block;\n      section.n = handlebarsBlockCodes[block];\n    }\n  } else {\n    return null;\n  }\n\n  parser.sp();\n\n  if (block === 'with') {\n    const aliases = readAliases(parser);\n    if (aliases) {\n      aliasOnly = true;\n      section.z = aliases;\n      section.t = ALIAS;\n    }\n  } else if (block === 'each') {\n    const alias = readAlias(parser);\n    if (alias) {\n      section.z = [{ n: alias.n, x: { r: '.' } }];\n      expression = alias.x;\n    }\n  }\n\n  if (!aliasOnly) {\n    if (!expression) expression = readExpression(parser);\n\n    if (!expression) {\n      parser.error('Expected expression');\n    }\n\n    // extra each aliases\n    if (block === 'each' && parser.matchString(',')) {\n      const aliases = readAliases(parser);\n      if (aliases) {\n        if (section.z) aliases.unshift(section.z[0]);\n        section.z = aliases;\n      }\n    }\n\n    // optional index and key references\n    if ((block === 'each' || !block) && (i = parser.matchPattern(indexRefPattern))) {\n      let extra;\n\n      if ((extra = parser.matchPattern(keyIndexRefPattern))) {\n        section.i = i + ',' + extra;\n      } else {\n        section.i = i;\n      }\n    } else if (block === 'await' && parser.matchString('then')) {\n      parser.sp();\n      hasThen = true;\n      inlineThen = parser.matchPattern(name);\n      if (!inlineThen) inlineThen = true;\n    }\n\n    if (!block && expression.n) {\n      expectedClose = expression.n;\n    }\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  parser.sectionDepth += 1;\n  children = section.f;\n\n  let pos;\n  do {\n    pos = parser.pos;\n    if ((child = readClosing(parser, tag))) {\n      if (expectedClose && child.r !== expectedClose) {\n        if (!block) {\n          if (child.r)\n            parser.warn(\n              `Expected ${tag.open}/${expectedClose}${tag.close} but found ${tag.open}/${child.r}${\n                tag.close\n              }`\n            );\n        } else {\n          parser.pos = pos;\n          parser.error(`Expected ${tag.open}/${expectedClose}${tag.close}`);\n        }\n      }\n\n      parser.sectionDepth -= 1;\n      closed = true;\n    } else if (\n      !aliasOnly &&\n      ((child = readInlineBlock(parser, tag, 'elseif')) ||\n        (child = readInlineBlock(parser, tag, 'else')) ||\n        (block === 'await' &&\n          ((child = readInlineBlock(parser, tag, 'then')) ||\n            (child = readInlineBlock(parser, tag, 'catch')))))\n    ) {\n      if (section.n === SECTION_UNLESS) {\n        parser.error('{{else}} not allowed in {{#unless}}');\n      }\n\n      if (hasElse) {\n        if (child.t === ELSE) {\n          parser.error('there can only be one {{else}} block, at the end of a section');\n        } else if (child.t === ELSEIF) {\n          parser.error('illegal {{elseif...}} after {{else}}');\n        }\n      }\n\n      if (!unlessBlock && (inlineThen || !hasThen) && !hasCatch) {\n        if (block === 'await') {\n          const s = { f: children };\n          section.f = [s];\n          if (inlineThen) {\n            s.t = THEN;\n            inlineThen !== true && (s.n = inlineThen);\n          } else {\n            s.t = SECTION;\n          }\n        } else {\n          unlessBlock = [];\n        }\n      }\n\n      const mustache = {\n        t: SECTION,\n        f: (children = [])\n      };\n\n      if (child.t === ELSE) {\n        if (block === 'await') {\n          section.f.push(mustache);\n          mustache.t = ELSE;\n        } else {\n          mustache.n = SECTION_UNLESS;\n          unlessBlock.push(mustache);\n        }\n        hasElse = true;\n      } else if (child.t === ELSEIF) {\n        mustache.n = SECTION_IF;\n        refineExpression(child.x, mustache);\n        unlessBlock.push(mustache);\n      } else if (child.t === THEN) {\n        if (hasElse) parser.error('{{then}} block must appear before any {{else}} block');\n        if (hasCatch) parser.error('{{then}} block must appear before any {{catch}} block');\n        if (hasThen) parser.error('there can only be one {{then}} block per {{#await}}');\n        mustache.t = THEN;\n        hasThen = true;\n        child.n && (mustache.n = child.n);\n        section.f.push(mustache);\n      } else if (child.t === CATCH) {\n        if (hasElse) parser.error('{{catch}} block must appear before any {{else}} block');\n        if (hasCatch) parser.error('there can only be one {{catch}} block per {{#await}}');\n        mustache.t = CATCH;\n        hasCatch = true;\n        mustache.n = child.n;\n        section.f.push(mustache);\n      }\n    } else {\n      child = parser.read(READERS);\n\n      if (!child) {\n        break;\n      }\n\n      children.push(child);\n    }\n  } while (!closed);\n\n  if (unlessBlock) {\n    section.l = unlessBlock;\n  }\n\n  if (!aliasOnly) {\n    refineExpression(expression, section);\n  }\n\n  if (block === 'await' && (inlineThen || !hasThen) && !hasCatch && !hasElse) {\n    const s = { f: section.f };\n    section.f = [s];\n    if (inlineThen) {\n      s.t = THEN;\n      inlineThen !== true && (s.n = inlineThen);\n    } else {\n      s.t = SECTION;\n    }\n  }\n\n  // TODO if a section is empty it should be discarded. Don't do\n  // that here though - we need to clean everything up first, as\n  // it may contain removeable whitespace. As a temporary measure,\n  // to pass the existing tests, remove empty `f` arrays\n  if (!section.f.length) {\n    delete section.f;\n  }\n\n  return section;\n}\n","import { COMMENT } from 'config/types';\n\nconst OPEN_COMMENT = '<!--';\nconst CLOSE_COMMENT = '-->';\n\nexport default function readHtmlComment(parser) {\n  const start = parser.pos;\n\n  if (parser.textOnlyMode || !parser.matchString(OPEN_COMMENT)) {\n    return null;\n  }\n\n  const remaining = parser.remaining();\n  const endIndex = remaining.indexOf(CLOSE_COMMENT);\n\n  if (endIndex === -1) {\n    parser.error(\"Illegal HTML - expected closing comment sequence ('-->')\");\n  }\n\n  const content = remaining.substr(0, endIndex);\n  parser.pos += endIndex + 3;\n\n  const comment = {\n    t: COMMENT,\n    c: content\n  };\n\n  if (parser.includeLinePositions) {\n    comment.p = parser.getLinePos(start);\n  }\n\n  return comment;\n}\n","import { COMMENT, DELIMCHANGE, SECTION, INVERTED } from 'config/types';\nimport { lastItem } from 'utils/array';\nimport { isString } from 'utils/is';\n\nconst leadingLinebreak = /^[ \\t\\f\\r\\n]*\\r?\\n/;\nconst trailingLinebreak = /\\r?\\n[ \\t\\f\\r\\n]*$/;\n\nexport default function(items) {\n  let i, current, backOne, backTwo, lastSectionItem;\n\n  for (i = 1; i < items.length; i += 1) {\n    current = items[i];\n    backOne = items[i - 1];\n    backTwo = items[i - 2];\n\n    // if we're at the end of a [text][comment][text] sequence...\n    if (isString(current) && isComment(backOne) && isString(backTwo)) {\n      // ... and the comment is a standalone (i.e. line breaks either side)...\n      if (trailingLinebreak.test(backTwo) && leadingLinebreak.test(current)) {\n        // ... then we want to remove the whitespace after the first line break\n        items[i - 2] = backTwo.replace(trailingLinebreak, '\\n');\n\n        // and the leading line break of the second text token\n        items[i] = current.replace(leadingLinebreak, '');\n      }\n    }\n\n    // if the current item is a section, and it is preceded by a linebreak, and\n    // its first item is a linebreak...\n    if (isSection(current) && isString(backOne)) {\n      if (\n        trailingLinebreak.test(backOne) &&\n        isString(current.f[0]) &&\n        leadingLinebreak.test(current.f[0])\n      ) {\n        items[i - 1] = backOne.replace(trailingLinebreak, '\\n');\n        current.f[0] = current.f[0].replace(leadingLinebreak, '');\n      }\n    }\n\n    // if the last item was a section, and it is followed by a linebreak, and\n    // its last item is a linebreak...\n    if (isString(current) && isSection(backOne)) {\n      lastSectionItem = lastItem(backOne.f);\n\n      if (\n        isString(lastSectionItem) &&\n        trailingLinebreak.test(lastSectionItem) &&\n        leadingLinebreak.test(current)\n      ) {\n        backOne.f[backOne.f.length - 1] = lastSectionItem.replace(trailingLinebreak, '\\n');\n        items[i] = current.replace(leadingLinebreak, '');\n      }\n    }\n  }\n\n  return items;\n}\n\nfunction isComment(item) {\n  return item.t === COMMENT || item.t === DELIMCHANGE;\n}\n\nfunction isSection(item) {\n  return (item.t === SECTION || item.t === INVERTED) && item.f;\n}\n","import { COMMENT, ELEMENT } from 'config/types';\nimport stripStandalones from './stripStandalones';\nimport trimWhitespace from './trimWhitespace';\nimport { isString } from 'utils/is';\n\nconst contiguousWhitespace = /[ \\t\\f\\r\\n]+/g;\nconst leadingWhitespace = /^[ \\t\\f\\r\\n]+/;\nconst trailingWhitespace = /[ \\t\\f\\r\\n]+$/;\nconst leadingNewLine = /^(?:\\r\\n|\\r|\\n)/;\nconst trailingNewLine = /(?:\\r\\n|\\r|\\n)$/;\n\nexport default function cleanup(\n  items,\n  stripComments,\n  preserveWhitespace,\n  removeLeadingWhitespace,\n  removeTrailingWhitespace,\n  whiteSpaceElements\n) {\n  if (isString(items)) return;\n\n  let i,\n    item,\n    previousItem,\n    nextItem,\n    preserveWhitespaceInsideFragment,\n    removeLeadingWhitespaceInsideFragment,\n    removeTrailingWhitespaceInsideFragment;\n\n  // First pass - remove standalones and comments etc\n  stripStandalones(items);\n\n  i = items.length;\n  while (i--) {\n    item = items[i];\n\n    // Remove delimiter changes, unsafe elements etc\n    if (item.exclude) {\n      items.splice(i, 1);\n    } else if (stripComments && item.t === COMMENT) {\n      // Remove comments, unless we want to keep them\n      items.splice(i, 1);\n    }\n  }\n\n  // If necessary, remove leading and trailing whitespace\n  trimWhitespace(\n    items,\n    removeLeadingWhitespace ? leadingWhitespace : null,\n    removeTrailingWhitespace ? trailingWhitespace : null\n  );\n\n  i = items.length;\n  while (i--) {\n    item = items[i];\n\n    // Recurse\n    if (item.f) {\n      const isPreserveWhitespaceElement =\n        item.t === ELEMENT &&\n        (whiteSpaceElements[item.e.toLowerCase()] || whiteSpaceElements[item.e]);\n      preserveWhitespaceInsideFragment = preserveWhitespace || isPreserveWhitespaceElement;\n\n      if (!preserveWhitespace && isPreserveWhitespaceElement) {\n        trimWhitespace(item.f, leadingNewLine, trailingNewLine);\n      }\n\n      if (!preserveWhitespaceInsideFragment) {\n        previousItem = items[i - 1];\n        nextItem = items[i + 1];\n\n        // if the previous item was a text item with trailing whitespace,\n        // remove leading whitespace inside the fragment\n        if (!previousItem || (isString(previousItem) && trailingWhitespace.test(previousItem))) {\n          removeLeadingWhitespaceInsideFragment = true;\n        }\n\n        // and vice versa\n        if (!nextItem || (isString(nextItem) && leadingWhitespace.test(nextItem))) {\n          removeTrailingWhitespaceInsideFragment = true;\n        }\n      }\n\n      cleanup(\n        item.f,\n        stripComments,\n        preserveWhitespaceInsideFragment,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment,\n        whiteSpaceElements\n      );\n    }\n\n    // Split if-else blocks into two (an if, and an unless)\n    if (item.l) {\n      cleanup(\n        item.l,\n        stripComments,\n        preserveWhitespace,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment,\n        whiteSpaceElements\n      );\n\n      item.l.forEach(s => (s.l = 1));\n      item.l.unshift(i + 1, 0);\n      items.splice.apply(items, item.l);\n      delete item.l; // TODO would be nice if there was a way around this\n    }\n\n    // Clean up conditional attributes\n    if (item.m) {\n      cleanup(\n        item.m,\n        stripComments,\n        preserveWhitespace,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment,\n        whiteSpaceElements\n      );\n      if (item.m.length < 1) delete item.m;\n    }\n  }\n\n  // final pass - fuse text nodes together\n  i = items.length;\n  while (i--) {\n    if (isString(items[i])) {\n      if (isString(items[i + 1])) {\n        items[i] = items[i] + items[i + 1];\n        items.splice(i + 1, 1);\n      }\n\n      if (!preserveWhitespace) {\n        items[i] = items[i].replace(contiguousWhitespace, ' ');\n      }\n\n      if (items[i] === '') {\n        items.splice(i, 1);\n      }\n    }\n  }\n}\n","import { CLOSING_TAG } from 'src/config/types';\n\nconst closingTagPattern = /^([a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*)\\s*\\>/;\n\nexport default function readClosingTag(parser) {\n  let tag;\n\n  const start = parser.pos;\n\n  // are we looking at a closing tag?\n  if (!parser.matchString('</')) {\n    return null;\n  }\n\n  if ((tag = parser.matchPattern(closingTagPattern))) {\n    if (parser.inside && tag !== parser.inside) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: CLOSING_TAG,\n      e: tag\n    };\n  }\n\n  // We have an illegal closing tag, report it\n  parser.pos -= 2;\n  parser.error('Illegal closing tag');\n}\n","import { ANCHOR, DOCTYPE, ELEMENT } from 'config/types';\nimport { voidElementNames } from 'utils/html';\nimport { READERS, PARTIAL_READERS } from '../_parse';\nimport cleanup from 'parse/utils/cleanup';\nimport readMustache from './readMustache';\nimport readClosingTag from './element/readClosingTag';\nimport readClosing from './mustache/section/readClosing';\nimport { create } from 'utils/object';\n\nconst tagNamePattern = /^[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/;\nconst anchorPattern = /^[a-zA-Z_$][-a-zA-Z0-9_$]*/;\nconst validTagNameFollower = /^[\\s\\n\\/>]/;\nconst exclude = { exclude: true };\n\n// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\nconst disallowedContents = {\n  li: ['li'],\n  dt: ['dt', 'dd'],\n  dd: ['dt', 'dd'],\n  p: 'address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split(\n    ' '\n  ),\n  rt: ['rt', 'rp'],\n  rp: ['rt', 'rp'],\n  optgroup: ['optgroup'],\n  option: ['option', 'optgroup'],\n  thead: ['tbody', 'tfoot'],\n  tbody: ['tbody', 'tfoot'],\n  tfoot: ['tbody'],\n  tr: ['tr', 'tbody'],\n  td: ['td', 'th', 'tr'],\n  th: ['td', 'th', 'tr']\n};\n\nexport default readElement;\n\nfunction readElement(parser) {\n  let attribute,\n    selfClosing,\n    children,\n    partials,\n    hasPartials,\n    child,\n    closed,\n    pos,\n    remaining,\n    closingTag,\n    anchor;\n\n  const start = parser.pos;\n\n  if (parser.inside || parser.inAttribute || parser.textOnlyMode) {\n    return null;\n  }\n\n  if (!parser.matchString('<')) {\n    return null;\n  }\n\n  // if this is a closing tag, abort straight away\n  if (parser.nextChar() === '/') {\n    return null;\n  }\n\n  const element = {};\n  if (parser.includeLinePositions) {\n    element.p = parser.getLinePos(start);\n  }\n\n  // check for doctype decl\n  if (parser.matchString('!')) {\n    element.t = DOCTYPE;\n    if (!parser.matchPattern(/^doctype/i)) {\n      parser.error('Expected DOCTYPE declaration');\n    }\n\n    element.a = parser.matchPattern(/^(.+?)>/);\n    return element;\n  } else if ((anchor = parser.matchString('#'))) {\n    // check for anchor\n    parser.sp();\n    element.t = ANCHOR;\n    element.n = parser.matchPattern(anchorPattern);\n  } else {\n    // otherwise, it's an element/component\n    element.t = ELEMENT;\n\n    // element name\n    element.e = parser.matchPattern(tagNamePattern);\n    if (!element.e) {\n      return null;\n    }\n  }\n\n  // next character must be whitespace, closing solidus or '>'\n  if (!validTagNameFollower.test(parser.nextChar())) {\n    parser.error('Illegal tag name');\n  }\n\n  parser.sp();\n\n  parser.inTag = true;\n\n  // directives and attributes\n  while ((attribute = readMustache(parser))) {\n    if (attribute !== false) {\n      if (!element.m) element.m = [];\n      element.m.push(attribute);\n    }\n\n    parser.sp();\n  }\n\n  parser.inTag = false;\n\n  // allow whitespace before closing solidus\n  parser.sp();\n\n  // self-closing solidus?\n  if (parser.matchString('/')) {\n    selfClosing = true;\n  }\n\n  // closing angle bracket\n  if (!parser.matchString('>')) {\n    return null;\n  }\n\n  const lowerCaseName = (element.e || element.n).toLowerCase();\n  const preserveWhitespace = parser.preserveWhitespace;\n\n  if (!selfClosing && (anchor || !voidElementNames.test(element.e))) {\n    if (!anchor) {\n      parser.elementStack.push(lowerCaseName);\n\n      // Special case - if we open a script element, further tags should\n      // be ignored unless they're a closing script element\n      if (lowerCaseName in parser.interpolate) {\n        parser.inside = lowerCaseName;\n      }\n    }\n\n    children = [];\n    partials = create(null);\n\n    do {\n      pos = parser.pos;\n      remaining = parser.remaining();\n\n      if (!remaining) {\n        // if this happens to be a script tag and there's no content left, it's because\n        // a closing script tag can't appear in a script\n        if (parser.inside === 'script') {\n          closed = true;\n          break;\n        }\n\n        parser.error(\n          `Missing end ${parser.elementStack.length > 1 ? 'tags' : 'tag'} (${parser.elementStack\n            .reverse()\n            .map(x => `</${x}>`)\n            .join('')})`\n        );\n      }\n\n      // if for example we're in an <li> element, and we see another\n      // <li> tag, close the first so they become siblings\n      if (!anchor && !canContain(lowerCaseName, remaining)) {\n        closed = true;\n      } else if (!anchor && (closingTag = readClosingTag(parser))) {\n        // closing tag\n        closed = true;\n\n        const closingTagName = closingTag.e.toLowerCase();\n\n        // if this *isn't* the closing tag for the current element...\n        if (closingTagName !== lowerCaseName) {\n          // rewind parser\n          parser.pos = pos;\n\n          // if it doesn't close a parent tag, error\n          if (!~parser.elementStack.indexOf(closingTagName)) {\n            let errorMessage = 'Unexpected closing tag';\n\n            // add additional help for void elements, since component names\n            // might clash with them\n            if (voidElementNames.test(closingTagName)) {\n              errorMessage += ` (<${closingTagName}> is a void element - it cannot contain children)`;\n            }\n\n            parser.error(errorMessage);\n          }\n        }\n      } else if (anchor && readAnchorClose(parser, element.n)) {\n        closed = true;\n      } else {\n        // implicit close by closing section tag. TODO clean this up\n        const tag = {\n          open: parser.standardDelimiters[0],\n          close: parser.standardDelimiters[1]\n        };\n        if (readClosing(parser, tag) || readInline(parser, tag)) {\n          closed = true;\n          parser.pos = pos;\n        } else if ((child = parser.read(PARTIAL_READERS))) {\n          if (partials[child.n]) {\n            parser.pos = pos;\n            parser.error('Duplicate partial definition');\n          }\n\n          cleanup(\n            child.f,\n            parser.stripComments,\n            preserveWhitespace,\n            !preserveWhitespace,\n            !preserveWhitespace,\n            parser.whiteSpaceElements\n          );\n\n          partials[child.n] = child.f;\n          hasPartials = true;\n        } else {\n          if ((child = parser.read(READERS))) {\n            children.push(child);\n          } else {\n            closed = true;\n          }\n        }\n      }\n    } while (!closed);\n\n    if (children.length) {\n      element.f = children;\n    }\n\n    if (hasPartials) {\n      element.p = partials;\n    }\n\n    parser.elementStack.pop();\n  }\n\n  parser.inside = null;\n\n  if (parser.sanitizeElements && parser.sanitizeElements.indexOf(lowerCaseName) !== -1) {\n    return exclude;\n  }\n\n  return element;\n}\n\nfunction canContain(name, remaining) {\n  const match = /^<([a-zA-Z][a-zA-Z0-9]*)/.exec(remaining);\n  const disallowed = disallowedContents[name];\n\n  if (!match || !disallowed) {\n    return true;\n  }\n\n  return !~disallowed.indexOf(match[1].toLowerCase());\n}\n\nfunction readAnchorClose(parser, name) {\n  const pos = parser.pos;\n  if (!parser.matchString('</')) {\n    return null;\n  }\n\n  parser.matchString('#');\n  parser.sp();\n\n  if (!parser.matchString(name)) {\n    parser.pos = pos;\n    return null;\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('>')) {\n    parser.pos = pos;\n    return null;\n  }\n\n  return true;\n}\n\nconst inlines = /^\\s*(elseif|else|then|catch)\\s*/;\nfunction readInline(parser, tag) {\n  const pos = parser.pos;\n  if (!parser.matchString(tag.open)) return;\n  if (parser.matchPattern(inlines)) {\n    return true;\n  } else {\n    parser.pos = pos;\n  }\n}\n","import { INLINE_PARTIAL } from 'config/types';\nimport { READERS } from '../_parse';\nimport readClosing from './mustache/section/readClosing';\n\nconst partialDefinitionSectionPattern = /^\\s*#\\s*partial\\s+/;\n\nexport default function readPartialDefinitionSection(parser) {\n  let child, closed;\n\n  const start = parser.pos;\n\n  const delimiters = parser.standardDelimiters;\n\n  if (!parser.matchString(delimiters[0])) {\n    return null;\n  }\n\n  if (!parser.matchPattern(partialDefinitionSectionPattern)) {\n    parser.pos = start;\n    return null;\n  }\n\n  const name = parser.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\\-\\/]*/);\n\n  if (!name) {\n    parser.error('expected legal partial name');\n  }\n\n  parser.sp();\n  if (!parser.matchString(delimiters[1])) {\n    parser.error(`Expected closing delimiter '${delimiters[1]}'`);\n  }\n\n  const content = [];\n\n  const [open, close] = delimiters;\n\n  do {\n    if ((child = readClosing(parser, { open, close }))) {\n      if (child.r !== 'partial') {\n        parser.error(`Expected ${open}/partial${close}`);\n      }\n\n      closed = true;\n    } else {\n      child = parser.read(READERS);\n\n      if (!child) {\n        parser.error(`Expected ${open}/partial${close}`);\n      }\n\n      content.push(child);\n    }\n  } while (!closed);\n\n  return {\n    t: INLINE_PARTIAL,\n    n: name,\n    f: content\n  };\n}\n","export default {};\n","import { TEMPLATE_VERSION } from 'config/template';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport readExpression from './converters/readExpression';\nimport { fromExpression } from './utils/createFunction';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport flattenExpression from './utils/flattenExpression';\nimport shared from '../Ractive/shared';\nimport { assign, keys } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [\n  readPartial,\n  readUnescaped,\n  readSection,\n  readInterpolator,\n  readMustacheComment\n];\nconst TRIPLE_READERS = [readTriple];\n\nexport const READERS = [readMustache, readHtmlComment, readElement, readText];\nexport const PARTIAL_READERS = [readPartialDefinitionSection];\n\nconst preserveWhitespaceElements = { pre: 1, script: 1, style: 1, textarea: 1 };\n\nconst defaultInterpolate = { textarea: true, script: true, style: true, template: true };\n\nconst StandardParser = Parser.extend({\n  init(str, options) {\n    const tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n    const staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n    const staticTripleDelimiters =\n      options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n    this.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n    this.tags = [\n      {\n        isStatic: false,\n        isTriple: false,\n        open: this.standardDelimiters[0],\n        close: this.standardDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: false,\n        isTriple: true,\n        open: tripleDelimiters[0],\n        close: tripleDelimiters[1],\n        readers: TRIPLE_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: false,\n        open: staticDelimiters[0],\n        close: staticDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: true,\n        open: staticTripleDelimiters[0],\n        close: staticTripleDelimiters[1],\n        readers: TRIPLE_READERS\n      }\n    ];\n\n    this.contextLines = options.contextLines || shared.defaults.contextLines;\n\n    this.sortMustacheTags();\n\n    this.sectionDepth = 0;\n    this.elementStack = [];\n\n    this.interpolate = assign(\n      {},\n      defaultInterpolate,\n      shared.defaults.interpolate,\n      options.interpolate\n    );\n\n    if (options.sanitize === true) {\n      options.sanitize = {\n        // blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n        elements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split(\n          ' '\n        ),\n        eventAttributes: true\n      };\n    }\n\n    this.stripComments = options.stripComments !== false;\n    this.preserveWhitespace = isObjectType(options.preserveWhitespace)\n      ? false\n      : options.preserveWhitespace;\n    this.sanitizeElements = options.sanitize && options.sanitize.elements;\n    this.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n    this.includeLinePositions = options.includeLinePositions;\n    this.textOnlyMode = options.textOnlyMode;\n    this.csp = options.csp;\n    this.allowExpressions = options.allowExpressions;\n\n    if (options.expression) this.converters = [readExpression];\n\n    if (options.attributes) this.inTag = true;\n\n    // special whitespace handling requested for certain elements\n    this.whiteSpaceElements = assign({}, options.preserveWhitespace, preserveWhitespaceElements);\n  },\n\n  postProcess(result, options) {\n    if (options.expression) {\n      const expr = flattenExpression(result[0]);\n      expr.e = fromExpression(expr.s, expr.r.length);\n      return expr;\n    } else {\n      // special case - empty string\n      if (!result.length) {\n        return { t: [], v: TEMPLATE_VERSION };\n      }\n\n      if (this.sectionDepth > 0) {\n        this.error('A section was left open');\n      }\n\n      cleanup(\n        result[0].t,\n        this.stripComments,\n        this.preserveWhitespace,\n        !this.preserveWhitespace,\n        !this.preserveWhitespace,\n        this.whiteSpaceElements\n      );\n\n      if (this.csp !== false) {\n        const expr = {};\n        insertExpressions(result[0].t, expr);\n        if (keys(expr).length) result[0].e = expr;\n      }\n\n      return result[0];\n    }\n  },\n\n  converters: [readTemplate],\n\n  sortMustacheTags() {\n    // Sort in order of descending opening delimiter length (longer first),\n    // to protect against opening delimiters being substrings of each other\n    this.tags.sort((a, b) => {\n      return b.open.length - a.open.length;\n    });\n  }\n});\n\nexport default function parse(template, options) {\n  return new StandardParser(template, options || {}).result;\n}\n","import { fromExpression } from 'parse/utils/createFunction';\nimport { doc } from 'config/environment';\nimport { fatal } from 'utils/log';\nimport { addFunctions } from 'shared/getFunction';\nimport parse from 'parse/_parse';\nimport { isString } from 'utils/is';\n\nconst parseOptions = [\n  'delimiters',\n  'tripleDelimiters',\n  'staticDelimiters',\n  'staticTripleDelimiters',\n  'csp',\n  'interpolate',\n  'preserveWhitespace',\n  'sanitize',\n  'stripComments',\n  'contextLines',\n  'allowExpressions',\n  'attributes'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\nfunction throwNoParse(method, error, instructions) {\n  if (!method) {\n    fatal(`Missing Ractive.parse - cannot parse ${error}. ${instructions}`);\n  }\n}\n\nexport function createFunction(body, length) {\n  throwNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  return fromExpression(body, length);\n}\n\nexport function createFunctionFromString(str, bindTo) {\n  throwNoParse(parse, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  const tpl = parse(str, { expression: true });\n  return function() {\n    return tpl.e.apply(bindTo, tpl.r.map(r => bindTo.get(r)));\n  };\n}\n\nconst parser = {\n  fromId(id, options) {\n    if (!doc) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Cannot retrieve template #${id} as Ractive is not running in a browser.`);\n    }\n\n    if (id) id = id.replace(/^#/, '');\n\n    let template;\n\n    if (!(template = doc.getElementById(id))) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Could not find template element with id #${id}`);\n    }\n\n    if (template.tagName.toUpperCase() !== 'SCRIPT') {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Template element with id #${id}, must be a <script> element`);\n    }\n\n    return 'textContent' in template ? template.textContent : template.innerHTML;\n  },\n\n  isParsed(template) {\n    return !isString(template);\n  },\n\n  getParseOptions(ractive) {\n    // Could be Ractive or a Component\n    if (ractive.defaults) {\n      ractive = ractive.defaults;\n    }\n\n    return parseOptions.reduce((val, key) => {\n      val[key] = ractive[key];\n      return val;\n    }, {});\n  },\n\n  parse(template, options) {\n    throwNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n    const parsed = parse(template, options);\n    addFunctions(parsed);\n    return parsed;\n  },\n\n  parseFor(template, ractive) {\n    return this.parse(template, this.getParseOptions(ractive));\n  }\n};\n\nexport default parser;\n","import { removeFromArray } from 'utils/array';\nimport { isFunction } from 'utils/is';\n\nexport default class TransitionManager {\n  constructor(callback, parent) {\n    this.callback = callback;\n    this.parent = parent;\n\n    this.intros = [];\n    this.outros = [];\n\n    this.children = [];\n    this.totalChildren = this.outroChildren = 0;\n\n    this.detachQueue = [];\n    this.outrosComplete = false;\n\n    if (parent) {\n      parent.addChild(this);\n    }\n  }\n\n  add(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    transition.starting = true;\n    list.push(transition);\n  }\n\n  addChild(child) {\n    this.children.push(child);\n\n    this.totalChildren += 1;\n    this.outroChildren += 1;\n  }\n\n  decrementOutros() {\n    this.outroChildren -= 1;\n    check(this);\n  }\n\n  decrementTotal() {\n    this.totalChildren -= 1;\n    check(this);\n  }\n\n  detachNodes() {\n    this.detachQueue.forEach(detach);\n    this.children.forEach(_detachNodes);\n    this.detachQueue = [];\n  }\n\n  ready() {\n    if (this.detachQueue.length) detachImmediate(this);\n  }\n\n  remove(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    removeFromArray(list, transition);\n    check(this);\n  }\n\n  start() {\n    this.children.forEach(c => c.start());\n    this.intros.concat(this.outros).forEach(t => t.start());\n    this.ready = true;\n    check(this);\n  }\n}\n\nfunction detach(element) {\n  element.detach();\n}\n\nfunction _detachNodes(tm) {\n  // _ to avoid transpiler quirk\n  tm.detachNodes();\n}\n\nfunction check(tm) {\n  if (!tm.ready || tm.outros.length || tm.outroChildren) return;\n\n  // If all outros are complete, and we haven't already done this,\n  // we notify the parent if there is one, otherwise\n  // start detaching nodes\n  if (!tm.outrosComplete) {\n    tm.outrosComplete = true;\n\n    if (tm.parent && !tm.parent.outrosComplete) {\n      tm.parent.decrementOutros(tm);\n    } else {\n      tm.detachNodes();\n    }\n  }\n\n  // Once everything is done, we can notify parent transition\n  // manager and call the callback\n  if (!tm.intros.length && !tm.totalChildren) {\n    if (isFunction(tm.callback)) {\n      tm.callback();\n    }\n\n    if (tm.parent && !tm.notifiedTotal) {\n      tm.notifiedTotal = true;\n      tm.parent.decrementTotal();\n    }\n  }\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate(manager) {\n  const queue = manager.detachQueue;\n  const outros = collectAllOutros(manager);\n\n  let i = queue.length;\n  let j = 0;\n  let node, trans;\n  start: while (i--) {\n    node = queue[i].node;\n    j = outros.length;\n    while (j--) {\n      trans = outros[j].element.node;\n      // check to see if the node is, contains, or is contained by the transitioning node\n      if (trans === node || trans.contains(node) || node.contains(trans)) continue start;\n    }\n\n    // no match, we can drop it\n    queue[i].detach();\n    queue.splice(i, 1);\n  }\n}\n\nfunction collectAllOutros(manager, _list) {\n  let list = _list;\n\n  // if there's no list, we're starting at the root to build one\n  if (!list) {\n    list = [];\n    let parent = manager;\n    while (parent.parent) parent = parent.parent;\n    return collectAllOutros(parent, list);\n  } else {\n    // grab all outros from child managers\n    let i = manager.children.length;\n    while (i--) {\n      list = collectAllOutros(manager.children[i], list);\n    }\n\n    // grab any from this manager if there are any\n    if (manager.outros.length) list = list.concat(manager.outros);\n\n    return list;\n  }\n}\n","import { addToArray } from 'utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n  active() {\n    return !!batch;\n  },\n\n  start() {\n    let fulfilPromise;\n    const promise = new Promise(f => (fulfilPromise = f));\n\n    batch = {\n      previousBatch: batch,\n      transitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n      fragments: [],\n      tasks: [],\n      immediateObservers: [],\n      deferredObservers: [],\n      promise\n    };\n\n    return promise;\n  },\n\n  end() {\n    flushChanges();\n\n    if (!batch.previousBatch) batch.transitionManager.start();\n\n    batch = batch.previousBatch;\n  },\n\n  addFragment(fragment) {\n    addToArray(batch.fragments, fragment);\n  },\n\n  // TODO: come up with a better way to handle fragments that trigger their own update\n  addFragmentToRoot(fragment) {\n    if (!batch) return;\n\n    let b = batch;\n    while (b.previousBatch) {\n      b = b.previousBatch;\n    }\n\n    addToArray(b.fragments, fragment);\n  },\n\n  addObserver(observer, defer) {\n    if (!batch) {\n      observer.dispatch();\n    } else {\n      addToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n    }\n  },\n\n  registerTransition(transition) {\n    transition._manager = batch.transitionManager;\n    batch.transitionManager.add(transition);\n  },\n\n  // synchronise node detachments with transition ends\n  detachWhenReady(thing) {\n    batch.transitionManager.detachQueue.push(thing);\n  },\n\n  scheduleTask(task, postRender) {\n    let _batch;\n\n    if (!batch) {\n      task();\n    } else {\n      _batch = batch;\n      while (postRender && _batch.previousBatch) {\n        // this can't happen until the DOM has been fully updated\n        // otherwise in some situations (with components inside elements)\n        // transitions and decorators will initialise prematurely\n        _batch = _batch.previousBatch;\n      }\n\n      _batch.tasks.push(task);\n    }\n  },\n\n  promise() {\n    if (!batch) return Promise.resolve();\n\n    let target = batch;\n    while (target.previousBatch) {\n      target = target.previousBatch;\n    }\n\n    return target.promise || Promise.resolve();\n  }\n};\n\nexport default runloop;\n\nfunction dispatch(observer) {\n  observer.dispatch();\n}\n\nfunction flushChanges() {\n  let which = batch.immediateObservers;\n  batch.immediateObservers = [];\n  which.forEach(dispatch);\n\n  // Now that changes have been fully propagated, we can update the DOM\n  // and complete other tasks\n  let i = batch.fragments.length;\n  let fragment;\n\n  which = batch.fragments;\n  batch.fragments = [];\n\n  while (i--) {\n    fragment = which[i];\n    fragment.update();\n  }\n\n  batch.transitionManager.ready();\n\n  which = batch.deferredObservers;\n  batch.deferredObservers = [];\n  which.forEach(dispatch);\n\n  const tasks = batch.tasks;\n  batch.tasks = [];\n\n  for (i = 0; i < tasks.length; i += 1) {\n    tasks[i]();\n  }\n\n  // If updating the view caused some model blowback - e.g. a triple\n  // containing <option> elements caused the binding on the <select>\n  // to update - then we start over\n  if (\n    batch.fragments.length ||\n    batch.immediateObservers.length ||\n    batch.deferredObservers.length ||\n    batch.tasks.length\n  )\n    return flushChanges();\n}\n","import runloop from 'src/global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick() {\n  runloop.start();\n\n  const now = performance.now();\n\n  let i;\n  let ticker;\n\n  for (i = 0; i < tickers.length; i += 1) {\n    ticker = tickers[i];\n\n    if (!ticker.tick(now)) {\n      // ticker is complete, remove it from the stack, and decrement i so we don't miss one\n      tickers.splice(i--, 1);\n    }\n  }\n\n  runloop.end();\n\n  if (tickers.length) {\n    requestAnimationFrame(tick);\n  } else {\n    running = false;\n  }\n}\n\nexport default class Ticker {\n  constructor(options) {\n    this.duration = options.duration;\n    this.step = options.step;\n    this.complete = options.complete;\n    this.easing = options.easing;\n\n    this.start = performance.now();\n    this.end = this.start + this.duration;\n\n    this.running = true;\n\n    tickers.push(this);\n    if (!running) requestAnimationFrame(tick);\n  }\n\n  tick(now) {\n    if (!this.running) return false;\n\n    if (now > this.end) {\n      if (this.step) this.step(1);\n      if (this.complete) this.complete(1);\n\n      return false;\n    }\n\n    const elapsed = now - this.start;\n    const eased = this.easing(elapsed / this.duration);\n\n    if (this.step) this.step(eased);\n\n    return true;\n  }\n\n  stop() {\n    if (this.abort) this.abort();\n    this.running = false;\n  }\n}\n","import { hasOwn } from 'utils/object';\nimport { isString, isObjectType } from 'utils/is';\n\nconst prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\n/* istanbul ignore next */\nfunction prefixKeypath(obj, prefix) {\n  const prefixed = {};\n\n  if (!prefix) {\n    return obj;\n  }\n\n  prefix += '.';\n\n  for (const key in obj) {\n    if (hasOwn(obj, key)) {\n      prefixed[prefix + key] = obj[key];\n    }\n  }\n\n  return prefixed;\n}\n\nexport default function getPrefixer(rootKeypath) {\n  let rootDot;\n\n  if (!prefixers[rootKeypath]) {\n    rootDot = rootKeypath ? rootKeypath + '.' : '';\n\n    /* istanbul ignore next */\n    prefixers[rootKeypath] = function(relativeKeypath, value) {\n      let obj;\n\n      if (isString(relativeKeypath)) {\n        obj = {};\n        obj[rootDot + relativeKeypath] = value;\n        return obj;\n      }\n\n      if (isObjectType(relativeKeypath)) {\n        // 'relativeKeypath' is in fact a hash, not a keypath\n        return rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n      }\n    };\n  }\n\n  return prefixers[rootKeypath];\n}\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport getComputationSignature from 'src/Ractive/helpers/getComputationSignature';\nimport { capture } from 'src/global/capture';\nimport { isArray, isEqual, isNumeric, isObjectLike } from 'utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from 'shared/methodCallers';\nimport Ticker from 'shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from 'shared/keypaths';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn, keys } from 'utils/object';\nimport { buildNewIndices } from 'utils/array';\n\nexport const shared = {};\n\nexport default class Model extends ModelBase {\n  constructor(parent, key) {\n    super(parent);\n\n    this.ticker = null;\n\n    if (parent) {\n      this.key = unescapeKey(key);\n      this.isReadonly = parent.isReadonly;\n\n      if (parent.value) {\n        this.value = parent.value[this.key];\n        if (isArray(this.value)) this.length = this.value.length;\n        this.adapt();\n      }\n    }\n  }\n\n  adapt() {\n    const adaptors = this.root.adaptors;\n    const len = adaptors.length;\n\n    this.rewrap = false;\n\n    // Exit early if no adaptors\n    if (len === 0) return;\n\n    const value = this.wrapper\n      ? 'newWrapperValue' in this ? this.newWrapperValue : this.wrapperValue\n      : this.value;\n\n    // TODO remove this legacy nonsense\n    const ractive = this.root.ractive;\n    const keypath = this.getKeypath();\n\n    // tear previous adaptor down if present\n    if (this.wrapper) {\n      const shouldTeardown =\n        this.wrapperValue === value\n          ? false\n          : !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        this.wrapper.teardown();\n        delete this.wrapper;\n        delete this.wrapperValue;\n\n        // don't branch for undefined values\n        if (this.value !== undefined) {\n          const parentValue = this.parent.value || this.parent.createBranch(this.key);\n          if (parentValue[this.key] !== value) parentValue[this.key] = value;\n          this.value = value;\n        }\n      } else {\n        delete this.newWrapperValue;\n        this.value = this.wrapper.get();\n        return;\n      }\n    }\n\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const adaptor = adaptors[i];\n      if (adaptor.filter(value, keypath, ractive)) {\n        this.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n        this.wrapperValue = value;\n        this.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n        this.value = this.wrapper.get();\n\n        break;\n      }\n    }\n  }\n\n  animate(from, to, options, interpolator) {\n    if (this.ticker) this.ticker.stop();\n\n    let fulfilPromise;\n    const promise = new Promise(fulfil => (fulfilPromise = fulfil));\n\n    this.ticker = new Ticker({\n      duration: options.duration,\n      easing: options.easing,\n      step: t => {\n        const value = interpolator(t);\n        this.applyValue(value);\n        if (options.step) options.step(t, value);\n      },\n      complete: () => {\n        this.applyValue(to);\n        if (options.complete) options.complete(to);\n\n        this.ticker = null;\n        fulfilPromise(to);\n      }\n    });\n\n    promise.stop = this.ticker.stop;\n    return promise;\n  }\n\n  applyValue(value, notify = true) {\n    if (isEqual(value, this.value)) return;\n    if (this.boundValue) this.boundValue = null;\n\n    if (this.parent.wrapper && this.parent.wrapper.set) {\n      this.parent.wrapper.set(this.key, value);\n      this.parent.value = this.parent.wrapper.get();\n\n      this.value = this.parent.value[this.key];\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    } else if (this.wrapper) {\n      this.newWrapperValue = value;\n      this.adapt();\n    } else {\n      const parentValue = this.parent.value || this.parent.createBranch(this.key);\n      if (isObjectLike(parentValue)) {\n        parentValue[this.key] = value;\n      } else {\n        warnIfDebug(`Attempted to set a property of a non-object '${this.getKeypath()}'`);\n        return;\n      }\n\n      this.value = value;\n      this.adapt();\n    }\n\n    // keep track of array stuff\n    if (isArray(value)) {\n      this.length = value.length;\n      this.isArray = true;\n    } else {\n      this.isArray = false;\n    }\n\n    // notify dependants\n    this.links.forEach(handleChange);\n    this.children.forEach(mark);\n    this.deps.forEach(handleChange);\n\n    if (notify) this.notifyUpstream();\n\n    if (this.parent.isArray) {\n      if (this.key === 'length') this.parent.length = value;\n      else this.parent.joinKey('length').mark();\n    }\n  }\n\n  compute(key, computed) {\n    const registry = this.computed || (this.computed = {});\n\n    if (registry[key]) {\n      registry[key].signature = getComputationSignature(this.root.ractive, key, computed);\n      registry[key].mark();\n    } else {\n      registry[key] = new shared.Computation(\n        this,\n        getComputationSignature(this.root.ractive, key, computed),\n        key\n      );\n    }\n\n    return registry[key];\n  }\n\n  createBranch(key) {\n    const branch = isNumeric(key) ? [] : {};\n    this.applyValue(branch, false);\n\n    return branch;\n  }\n\n  get(shouldCapture, opts) {\n    if (this._link) return this._link.get(shouldCapture, opts);\n    if (shouldCapture) capture(this);\n    // if capturing, this value needs to be unwrapped because it's for external use\n    if (opts && opts.virtual) return this.getVirtual(false);\n    return maybeBind(\n      this,\n      (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  joinKey(key, opts) {\n    if (this._link) {\n      if (opts && opts.lastLink !== false && (key === undefined || key === '')) return this;\n      return this._link.joinKey(key);\n    }\n\n    if (key === undefined || key === '') return this;\n\n    let child;\n    if (hasOwn(this.childByKey, key)) child = this.childByKey[key];\n    else child = this.computed && this.computed[key];\n\n    if (!child) {\n      let computed;\n      if (this.isRoot && this.ractive && (computed = this.ractive.computed[key])) {\n        child = this.compute(key, computed);\n      } else if (!this.isRoot && this.root.ractive) {\n        const registry = this.root.ractive.computed;\n        for (const k in registry) {\n          computed = registry[k];\n          if (computed.pattern && computed.pattern.test(this.getKeypath() + '.' + key)) {\n            child = this.compute(key, computed);\n          }\n        }\n      }\n    }\n\n    if (!child) {\n      child = new Model(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    if (child._link && (!opts || opts.lastLink !== false)) return child._link;\n\n    return child;\n  }\n\n  mark(force) {\n    if (this._link) return this._link.mark(force);\n\n    const old = this.value;\n    const value = this.retrieve();\n\n    if (force || !isEqual(value, old)) {\n      this.value = value;\n      if (this.boundValue) this.boundValue = null;\n\n      // make sure the wrapper stays in sync\n      if (old !== value || this.rewrap) {\n        if (this.wrapper) this.newWrapperValue = value;\n        this.adapt();\n      }\n\n      // keep track of array stuff\n      if (isArray(value)) {\n        this.length = value.length;\n        this.isArray = true;\n      } else {\n        this.isArray = false;\n      }\n\n      this.children.forEach(force ? markForce : mark);\n      this.links.forEach(marked);\n\n      this.deps.forEach(handleChange);\n    }\n  }\n\n  merge(array, comparator) {\n    const newIndices = buildNewIndices(\n      this.value === array ? recreateArray(this) : this.value,\n      array,\n      comparator\n    );\n    this.parent.value[this.key] = array;\n    this.shuffle(newIndices, true);\n  }\n\n  retrieve() {\n    return this.parent.value ? this.parent.value[this.key] : undefined;\n  }\n\n  set(value) {\n    if (this.ticker) this.ticker.stop();\n    this.applyValue(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    shuffle(this, newIndices, false, unsafe);\n  }\n\n  source() {\n    return this;\n  }\n\n  teardown() {\n    if (this._link) {\n      this._link.teardown();\n      this._link = null;\n    }\n    this.children.forEach(teardown);\n    if (this.wrapper) this.wrapper.teardown();\n    if (this.computed) keys(this.computed).forEach(k => this.computed[k].teardown());\n  }\n}\n\nfunction recreateArray(model) {\n  const array = [];\n\n  for (let i = 0; i < model.length; i++) {\n    array[i] = (model.childByKey[i] || {}).value;\n  }\n\n  return array;\n}\n","/* global global */\nimport Model from '../Model';\n\nexport const data = {};\n\nexport class SharedModel extends Model {\n  constructor(value, name) {\n    super(null, `@${name}`);\n    this.key = `@${name}`;\n    this.value = value;\n    this.isRoot = true;\n    this.root = this;\n    this.adaptors = [];\n  }\n\n  getKeypath() {\n    return this.key;\n  }\n\n  retrieve() {\n    return this.value;\n  }\n}\n\nexport default new SharedModel(data, 'shared');\n\nexport const GlobalModel = new SharedModel(\n  typeof global !== 'undefined' ? global : window,\n  'global'\n);\n","import { splitKeypath } from 'shared/keypaths';\nimport SharedModel, { GlobalModel } from 'src/model/specials/SharedModel';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction findContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context && !frag.aliases) frag = frag.parent;\n  return frag;\n}\n\nexport default function resolveReference(fragment, ref) {\n  const initialFragment = fragment;\n  // current context ref\n  if (ref === '.') return fragment.findContext();\n\n  // ancestor references\n  if (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypath(ref.slice(2)));\n\n  // scoped references\n  if (ref[0] === '.' || ref[0] === '^') {\n    let frag = fragment;\n    const parts = ref.split('/');\n    const explicitContext = parts[0] === '^^';\n\n    // find nearest context node\n    while (frag && !frag.context) {\n      frag = up(frag);\n    }\n    let context = frag && frag.context;\n\n    // walk up the context chain\n    while (frag && parts[0] === '^^') {\n      parts.shift();\n\n      // the current fragment should always be a context,\n      // and if it happens to be an iteration, jump above the each block\n      if (frag.isIteration) {\n        frag = frag.parent.parent;\n      } else {\n        // otherwise jump above the current fragment\n        frag = up(frag);\n      }\n\n      // walk to the next contexted fragment\n      while (frag && !frag.context) {\n        frag = up(frag);\n      }\n      context = frag && frag.context;\n    }\n\n    if (!context && explicitContext) {\n      throw new Error(\n        `Invalid context parent reference ('${ref}'). There is not context at that level.`\n      );\n    }\n\n    // walk up the context path\n    while (parts[0] === '.' || parts[0] === '..') {\n      const part = parts.shift();\n\n      if (part === '..') {\n        context = context.parent;\n      }\n    }\n\n    ref = parts.join('/');\n\n    // special case - `{{.foo}}` means the same as `{{./foo}}`\n    if (ref[0] === '.') ref = ref.slice(1);\n    return context.joinAll(splitKeypath(ref));\n  }\n\n  const keys = splitKeypath(ref);\n  if (!keys.length) return;\n  const base = keys.shift();\n\n  // special refs\n  if (base[0] === '@') {\n    // shorthand from outside the template\n    // @this referring to local ractive instance\n    if (base === '@this' || base === '@') {\n      return fragment.ractive.viewmodel.getRactiveModel().joinAll(keys);\n    } else if (base === '@index' || base === '@key') {\n      // @index or @key referring to the nearest repeating index or key\n      if (keys.length) badReference(base);\n      const repeater = findIter(fragment);\n      return repeater && repeater[`get${base[1] === 'i' ? 'Index' : 'Key'}`]();\n    } else if (base === '@last') {\n      const repeater = findIter(fragment);\n      return repeater && repeater.parent.getLast();\n    } else if (base === '@global') {\n      // @global referring to window or global\n      return GlobalModel.joinAll(keys);\n    } else if (base === '@shared') {\n      // @global referring to window or global\n      return SharedModel.joinAll(keys);\n    } else if (base === '@keypath' || base === '@rootpath') {\n      // @keypath or @rootpath, the current keypath string\n      const root = ref[1] === 'r' ? fragment.ractive.root : null;\n      let f = fragment;\n\n      while (f && (!f.context || (f.isRoot && f.ractive.component))) {\n        f = f.isRoot ? f.componentParent : f.parent;\n      }\n\n      return f.getKeypath(root);\n    } else if (base === '@context') {\n      return new ContextModel(fragment.getContext());\n    } else if (base === '@local') {\n      // @context-local data\n      return fragment.getContext()._data.joinAll(keys);\n    } else if (base === '@style') {\n      // @style shared model\n      return fragment.ractive.constructor._cssModel.joinAll(keys);\n    } else if (base === '@helpers') {\n      // @helpers instance model\n      return fragment.ractive.viewmodel.getHelpers().joinAll(keys);\n    } else {\n      // nope\n      throw new Error(`Invalid special reference '${base}'`);\n    }\n  }\n\n  // helpers\n  if (base && !keys.length) {\n    const helpers = fragment.ractive.viewmodel.getHelpers();\n    if (helpers.has(base)) return helpers.joinKey(base);\n  }\n\n  let context = findContext(fragment);\n\n  // check immediate context for a match\n  if (context) {\n    if (context.context) {\n      context = context.context;\n      if (context.has(base)) return context.joinKey(base).joinAll(keys);\n    } else {\n      // alias block, so get next full context for later\n      context = fragment.findContext();\n    }\n  } else {\n    context = fragment.findContext();\n  }\n\n  // walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n  let createMapping = false;\n  const shouldWarn = fragment.ractive.warnAboutAmbiguity;\n  let model;\n\n  while (fragment) {\n    // repeated fragments\n    if (fragment.isIteration) {\n      if (base === fragment.parent.keyRef) {\n        model = fragment.getKey();\n      } else if (base === fragment.parent.indexRef) {\n        model = fragment.getIndex();\n      }\n\n      if (model && keys.length) badReference(base);\n    }\n\n    // alias node or iteration\n    if (!model && fragment.aliases && hasOwn(fragment.aliases, base)) {\n      model = fragment.aliases[base];\n    }\n\n    // check fragment context to see if it has the key we need\n    if (!model && fragment.context && fragment.context.has(base)) {\n      model = fragment.context.joinKey(base);\n\n      // this is an implicit mapping\n      if (createMapping) {\n        if (shouldWarn)\n          warnIfDebug(\n            `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.`\n          );\n      } else if (shouldWarn) warnIfDebug(`'${ref}' resolved but is ambiguous.`);\n    }\n\n    if (model) {\n      if (createMapping) {\n        model = initialFragment.ractive.viewmodel.createLink(base, model, base, { implicit: true });\n      }\n\n      if (keys.length > 0 && isFunction(model.joinAll)) {\n        model = model.joinAll(keys);\n      }\n\n      return model;\n    }\n\n    if (\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component)) &&\n      !fragment.ractive.isolated\n    ) {\n      // ascend through component boundary\n      fragment = fragment.componentParent || fragment.ractive.component.up;\n      createMapping = true;\n    } else {\n      fragment = fragment.parent;\n    }\n  }\n\n  // if enabled, check the instance for a match\n  const instance = initialFragment.ractive;\n  if (instance.resolveInstanceMembers && base !== 'data' && base in instance) {\n    return instance.viewmodel\n      .getRactiveModel()\n      .joinKey(base)\n      .joinAll(keys);\n  }\n\n  if (shouldWarn) {\n    warnIfDebug(`'${ref}' is ambiguous and did not resolve.`);\n  }\n\n  // didn't find anything, so go ahead and create the key on the local model\n  return context.joinKey(base).joinAll(keys);\n}\n\nfunction up(fragment) {\n  return fragment && ((!fragment.ractive.isolated && fragment.componentParent) || fragment.parent);\n}\n\nfunction findIter(start) {\n  let fragment = start;\n  let next;\n  while (!fragment.isIteration && (next = up(fragment))) {\n    fragment = next;\n  }\n\n  return fragment.isIteration && fragment;\n}\n\nfunction badReference(key) {\n  throw new Error(`An index or key reference (${key}) cannot have child properties`);\n}\n\nclass ContextModel {\n  constructor(context) {\n    this.context = context;\n  }\n\n  get() {\n    return this.context;\n  }\n\n  getKeypath() {\n    return '@context';\n  }\n}\n","import noop from 'utils/noop';\nimport { assign, create } from 'utils/object';\n\nexport const extern = {};\n\nexport default function getRactiveContext(ractive, ...assigns) {\n  const fragment =\n    ractive.fragment ||\n    ractive._fakeFragment ||\n    (ractive._fakeFragment = new FakeFragment(ractive));\n  return fragment.getContext.apply(fragment, assigns);\n}\n\nexport function getContext(...assigns) {\n  if (!this.ctx) this.ctx = new extern.Context(this);\n  assigns.unshift(create(this.ctx));\n  return assign.apply(null, assigns);\n}\n\nexport class FakeFragment {\n  constructor(ractive) {\n    this.ractive = ractive;\n  }\n\n  findContext() {\n    return this.ractive.viewmodel;\n  }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n\nexport function findParentWithContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context) frag = frag.parent;\n  if (!frag) return fragment && fragment.ractive.fragment;\n  else return frag;\n}\n","import { isArray, isObject, isObjectType, isFunction, isString } from 'utils/is';\nimport { warnIfDebug } from 'utils/log';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { FakeFragment } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\n\nexport let keep = false;\n\nexport function set(pairs, options) {\n  const k = keep;\n\n  const deep = options && options.deep;\n  const shuffle = options && options.shuffle;\n  const promise = runloop.start();\n  if (options && 'keep' in options) keep = options.keep;\n\n  let i = pairs.length;\n  while (i--) {\n    const model = pairs[i][0];\n    const value = pairs[i][1];\n    const keypath = pairs[i][2];\n\n    if (!model) {\n      runloop.end();\n      throw new Error(`Failed to set invalid keypath '${keypath}'`);\n    }\n\n    if (deep) deepSet(model, value);\n    else if (shuffle) {\n      let array = value;\n      const target = model.get();\n      // shuffle target array with itself\n      if (!array) array = target;\n\n      // if there's not an array there yet, go ahead and set\n      if (target === undefined) {\n        model.set(array);\n      } else {\n        if (!isArray(target) || !isArray(array)) {\n          runloop.end();\n          throw new Error('You cannot merge an array with a non-array');\n        }\n\n        const comparator = getComparator(shuffle);\n        model.merge(array, comparator);\n      }\n    } else model.set(value);\n  }\n\n  runloop.end();\n\n  keep = k;\n\n  return promise;\n}\n\nconst star = /\\*/;\nexport function gather(ractive, keypath, base, isolated) {\n  if (!base && (keypath[0] === '.' || keypath[1] === '^')) {\n    warnIfDebug(\n      `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.`\n    );\n    return [];\n  }\n\n  const keys = splitKeypath(keypath);\n  const model = base || ractive.viewmodel;\n\n  if (star.test(keypath)) {\n    return model.findMatches(keys);\n  } else {\n    if (model === ractive.viewmodel) {\n      // allow implicit mappings\n      if (\n        ractive.component &&\n        !ractive.isolated &&\n        !model.has(keys[0]) &&\n        keypath[0] !== '@' &&\n        keypath[0] &&\n        !isolated\n      ) {\n        return [resolveReference(ractive.fragment || new FakeFragment(ractive), keypath)];\n      } else {\n        return [model.joinAll(keys)];\n      }\n    } else {\n      return [model.joinAll(keys)];\n    }\n  }\n}\n\nexport function build(ractive, keypath, value, isolated) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push.apply(sets, gather(ractive, k, null, isolated).map(m => [m, keypath[k], k]));\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push.apply(sets, gather(ractive, keypath, null, isolated).map(m => [m, value, keypath]));\n  }\n\n  return sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet(model, value) {\n  const dest = model.get(false, deepOpts);\n\n  // if dest doesn't exist, just set it\n  if (dest == null || !isObjectType(value)) return model.set(value);\n  if (!isObjectType(dest)) return model.set(value);\n\n  for (const k in value) {\n    if (hasOwn(value, k)) {\n      deepSet(model.joinKey(k), value[k]);\n    }\n  }\n}\n\nconst comparators = {};\nfunction getComparator(option) {\n  if (option === true) return null; // use existing arrays\n  if (isFunction(option)) return option;\n\n  if (isString(option)) {\n    return comparators[option] || (comparators[option] = thing => thing[option]);\n  }\n\n  throw new Error('If supplied, options.compare must be a string, function, or true'); // TODO link to docs\n}\n","import { isNumeric, isString } from 'utils/is';\nimport { build, set } from 'shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add(ractive, keypath, d, options) {\n  if (!isString(keypath) || !isNumeric(d)) {\n    throw new Error('Bad arguments');\n  }\n\n  const sets = build(ractive, keypath, d, options && options.isolated);\n\n  return set(\n    sets.map(pair => {\n      const [model, add] = pair;\n      const value = model.get();\n      if (!isNumeric(add) || !isNumeric(value)) throw new Error(errorMessage);\n      return [model, value + add];\n    })\n  );\n}\n","import runloop from 'src/global/runloop';\nimport easing from 'src/Ractive/static/easing';\nimport interpolate from 'shared/interpolate';\nimport { isEqual, isFunction, isObjectType } from 'utils/is';\nimport noop from 'utils/noop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { defineProperty, keys as objectKeys } from 'utils/object';\n\nfunction immediate(value) {\n  const result = Promise.resolve(value);\n  defineProperty(result, 'stop', { value: noop });\n  return result;\n}\n\nconst linear = easing.linear;\n\nfunction getOptions(options, instance) {\n  options = options || {};\n\n  let easing;\n  if (options.easing) {\n    easing = isFunction(options.easing) ? options.easing : instance.easing[options.easing];\n  }\n\n  return {\n    easing: easing || linear,\n    duration: 'duration' in options ? options.duration : 400,\n    complete: options.complete || noop,\n    step: options.step || noop,\n    interpolator: options.interpolator\n  };\n}\n\nexport function animate(ractive, model, to, options) {\n  options = getOptions(options, ractive);\n  const from = model.get();\n\n  // don't bother animating values that stay the same\n  if (isEqual(from, to)) {\n    options.complete(options.to);\n    return immediate(to);\n  }\n\n  const interpolator = interpolate(from, to, ractive, options.interpolator);\n\n  // if we can't interpolate the value, set it immediately\n  if (!interpolator) {\n    runloop.start();\n    model.set(to);\n    runloop.end();\n\n    return immediate(to);\n  }\n\n  return model.animate(from, to, options, interpolator);\n}\n\nexport default function Ractive$animate(keypath, to, options) {\n  if (isObjectType(keypath)) {\n    const keys = objectKeys(keypath);\n\n    throw new Error(`ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map(key => `'${key}': ${keypath[key]}`).join('\\n  ')}\n}, {...}), do\n\n${keys.map(key => `ractive.animate('${key}', ${keypath[key]}, {...});`).join('\\n')}\n`);\n  }\n\n  return animate(this, this.viewmodel.joinAll(splitKeypath(keypath)), to, options);\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants(name, initial) {\n  const map = initial ? initStars : bubbleStars;\n  if (map[name]) return map[name];\n\n  const parts = name.split('.');\n  const result = [];\n  let base = false;\n\n  // initial events the implicit namespace of 'this'\n  if (initial) {\n    parts.unshift('this');\n    base = true;\n  }\n\n  // use max - 1 bits as a bitmap to pick a part or a *\n  // need to skip the full star case if the namespace is synthetic\n  const max = Math.pow(2, parts.length) - (initial ? 1 : 0);\n  for (let i = 0; i < max; i++) {\n    const join = [];\n    for (let j = 0; j < parts.length; j++) {\n      join.push(1 & (i >> j) ? '*' : parts[j]);\n    }\n    result.unshift(join.join('.'));\n  }\n\n  if (base) {\n    // include non-this-namespaced versions\n    if (parts.length > 2) {\n      result.push.apply(result, variants(name, false));\n    } else {\n      result.push('*');\n      result.push(name);\n    }\n  }\n\n  map[name] = result;\n  return result;\n}\n\nexport default function fireEvent(ractive, eventName, context, args = []) {\n  if (!eventName) {\n    return;\n  }\n\n  context.name = eventName;\n  args.unshift(context);\n\n  const eventNames = ractive._nsSubs ? variants(eventName, true) : ['*', eventName];\n\n  return fireEventAs(ractive, eventNames, context, args, true);\n}\n\nfunction fireEventAs(ractive, eventNames, context, args, initialFire = false) {\n  let bubble = true;\n\n  if (initialFire || ractive._nsSubs) {\n    enqueue(ractive, context);\n\n    let i = eventNames.length;\n    while (i--) {\n      if (eventNames[i] in ractive._subs) {\n        bubble = notifySubscribers(ractive, ractive._subs[eventNames[i]], context, args) && bubble;\n      }\n    }\n\n    dequeue(ractive);\n  }\n\n  if (ractive.parent && bubble) {\n    if (initialFire && ractive.component) {\n      const fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n      eventNames = variants(fullName, false);\n\n      if (context && !context.component) {\n        context.component = ractive;\n      }\n    }\n\n    bubble = fireEventAs(ractive.parent, eventNames, context, args);\n  }\n\n  return bubble;\n}\n\nfunction notifySubscribers(ractive, subscribers, context, args) {\n  let originalEvent = null;\n  let stopEvent = false;\n\n  // subscribers can be modified inflight, e.g. \"once\" functionality\n  // so we need to copy to make sure everyone gets called\n  subscribers = subscribers.slice();\n\n  for (let i = 0, len = subscribers.length; i < len; i += 1) {\n    if (!subscribers[i].off && subscribers[i].handler.apply(ractive, args) === false) {\n      stopEvent = true;\n    }\n  }\n\n  if (context && stopEvent && (originalEvent = context.event)) {\n    originalEvent.preventDefault && originalEvent.preventDefault();\n    originalEvent.stopPropagation && originalEvent.stopPropagation();\n  }\n\n  return !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport default class Hook {\n  constructor(event) {\n    this.event = event;\n    this.method = 'on' + event;\n  }\n\n  fire(ractive, arg) {\n    const context = getRactiveContext(ractive);\n\n    if (ractive[this.method]) {\n      arg ? ractive[this.method](context, arg) : ractive[this.method](context);\n    }\n\n    fireEvent(ractive, this.event, context, arg ? [arg, ractive] : [ractive]);\n  }\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { unrenderChild, updateAnchors } from 'shared/anchors';\n\nconst attachHook = new Hook('attachchild');\n\nexport default function attachChild(child, options = {}) {\n  const children = this._children;\n  let idx;\n\n  if (child.parent && child.parent !== this)\n    throw new Error(\n      `Instance ${child._guid} is already attached to a different instance ${\n        child.parent._guid\n      }. Please detach it from the other instance using detachChild first.`\n    );\n  else if (child.parent)\n    throw new Error(`Instance ${child._guid} is already attached to this instance.`);\n\n  const meta = {\n    instance: child,\n    ractive: this,\n    name: options.name || child.constructor.name || 'Ractive',\n    target: options.target || false,\n    bubble,\n    findNextNode\n  };\n  meta.nameOption = options.name;\n\n  // child is managing itself\n  if (!meta.target) {\n    meta.up = this.fragment;\n    meta.external = true;\n  } else {\n    let list;\n    if (!(list = children.byName[meta.target])) {\n      list = [];\n      this.set(`@this.children.byName.${meta.target}`, list);\n    }\n    idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n  }\n\n  child.set({\n    '@this.parent': this,\n    '@this.root': this.root\n  });\n  child.component = meta;\n  children.push(meta);\n\n  attachHook.fire(child);\n\n  const promise = runloop.start();\n\n  if (meta.target) {\n    unrenderChild(meta);\n    this.splice(`@this.children.byName.${meta.target}`, idx, 0, meta);\n    updateAnchors(this, meta.target);\n  } else {\n    if (!child.isolated) child.viewmodel.attached(this.fragment);\n  }\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n\nfunction bubble() {\n  runloop.addFragment(this.instance.fragment);\n}\n\nfunction findNextNode() {\n  if (this.anchor) return this.anchor.findNextNode();\n}\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nconst detachHook = new Hook('detach');\n\nexport default function Ractive$detach() {\n  if (this.isDetached) {\n    return this.el;\n  }\n\n  if (this.el) {\n    removeFromArray(this.el.__ractive_instances__, this);\n  }\n\n  this.el = this.fragment.detach();\n  this.isDetached = true;\n\n  detachHook.fire(this);\n  return this.el;\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\n\nconst detachHook = new Hook('detachchild');\n\nexport default function detachChild(child) {\n  const children = this._children;\n  let meta, index;\n\n  let i = children.length;\n  while (i--) {\n    if (children[i].instance === child) {\n      index = i;\n      meta = children[i];\n      break;\n    }\n  }\n\n  if (!meta || child.parent !== this)\n    throw new Error(`Instance ${child._guid} is not attached to this instance.`);\n\n  const promise = runloop.start();\n\n  if (meta.anchor) meta.anchor.removeChild(meta);\n  if (!child.isolated) child.viewmodel.detached();\n\n  runloop.end();\n\n  children.splice(index, 1);\n  if (meta.target) {\n    this.splice(\n      `@this.children.byName.${meta.target}`,\n      children.byName[meta.target].indexOf(meta),\n      1\n    );\n    updateAnchors(this, meta.target);\n  }\n  child.set({\n    '@this.parent': undefined,\n    '@this.root': child\n  });\n  child.component = null;\n\n  detachHook.fire(child);\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\nimport { isArray } from 'utils/is';\n\nconst arrayProto = Array.prototype;\n\nexport default function(methodName) {\n  function path(keypath, ...args) {\n    return model(this.viewmodel.joinAll(splitKeypath(keypath)), args);\n  }\n\n  function model(mdl, args) {\n    let array = mdl.get();\n\n    if (!isArray(array)) {\n      if (array === undefined) {\n        array = [];\n        const result = arrayProto[methodName].apply(array, args);\n        const promise = runloop.start().then(() => result);\n        mdl.set(array);\n        runloop.end();\n        return promise;\n      } else {\n        throw new Error(\n          `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}`\n        );\n      }\n    }\n\n    const newIndices = getNewIndices(array.length, methodName, args);\n    const result = arrayProto[methodName].apply(array, args);\n\n    const promise = runloop.start().then(() => result);\n    promise.result = result;\n\n    if (newIndices) {\n      if (mdl.shuffle) {\n        mdl.shuffle(newIndices);\n      } else {\n        // it's a computation, which don't have a shuffle, so just invalidate\n        mdl.mark();\n      }\n    } else {\n      mdl.set(result);\n    }\n\n    runloop.end();\n\n    return promise;\n  }\n\n  return { path, model };\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isString } from 'utils/is';\n\nconst updateHook = new Hook('update');\n\nexport function update(ractive, model, options) {\n  // if the parent is wrapped, the adaptor will need to be updated before\n  // updating on this keypath\n  if (model.parent && model.parent.wrapper) {\n    model.parent.adapt();\n  }\n\n  const promise = runloop.start();\n\n  model.mark(options && options.force);\n\n  // notify upstream of changes\n  model.notifyUpstream();\n\n  runloop.end();\n\n  updateHook.fire(ractive, model);\n\n  return promise;\n}\n\nexport default function Ractive$update(keypath, options) {\n  let opts, path;\n\n  if (isString(keypath)) {\n    path = splitKeypath(keypath);\n    opts = options;\n  } else {\n    opts = keypath;\n  }\n\n  return update(this, path ? this.viewmodel.joinAll(path) : this.viewmodel, opts);\n}\n","import resolveReference from 'src/view/resolvers/resolveReference';\nimport Model from 'src/model/Model';\nimport { isNumeric, isObject, isNumber, isObjectType, isString } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport findElement from 'src/view/items/shared/findElement';\nimport { set as sharedSet } from './set';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport getRactiveContext, { extern, findParentWithContext } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\nimport { ELEMENT } from 'config/types';\n\nconst modelPush = makeArrayMethod('push').model;\nconst modelPop = makeArrayMethod('pop').model;\nconst modelShift = makeArrayMethod('shift').model;\nconst modelUnshift = makeArrayMethod('unshift').model;\nconst modelSort = makeArrayMethod('sort').model;\nconst modelSplice = makeArrayMethod('splice').model;\nconst modelReverse = makeArrayMethod('reverse').model;\n\nclass ContextData extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.value = {};\n    this.ractive = options.ractive;\n    this.adaptors = [];\n    this.context = options.context;\n  }\n\n  getKeypath() {\n    return '@context.data';\n  }\n}\n\nexport default class Context {\n  constructor(fragment, element) {\n    this.fragment = fragment;\n    this.element = element || findElement(fragment);\n    this.node = this.element && this.element.node;\n    this.ractive = fragment.ractive;\n    this.root = this;\n  }\n\n  get decorators() {\n    const items = {};\n    if (!this.element) return items;\n    this.element.decorators.forEach(d => (items[d.name] = d.handle));\n    return items;\n  }\n\n  get _data() {\n    return (\n      this.model ||\n      (this.root.model = new ContextData({\n        ractive: this.ractive,\n        context: this.root\n      }))\n    );\n  }\n\n  // the usual mutation suspects\n  add(keypath, d, options) {\n    const num = isNumber(d) ? +d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value + val];\n      }),\n      opts\n    );\n  }\n\n  animate(keypath, value, options) {\n    const model = findModel(this, keypath).model;\n    return protoAnimate(this.ractive, model, value, options);\n  }\n\n  // get relative keypaths and values\n  get(keypath) {\n    if (!keypath) return this.fragment.findContext().get(true);\n\n    const { model } = findModel(this, keypath);\n\n    return model ? model.get(true) : undefined;\n  }\n\n  getParent(component) {\n    let fragment = this.fragment;\n\n    if (fragment.context)\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n    else {\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n      if (fragment)\n        fragment = findParentWithContext(\n          fragment.parent || (component && fragment.componentParent)\n        );\n    }\n\n    if (!fragment || fragment === this.fragment) return;\n    else return fragment.getContext();\n  }\n\n  hasListener(name, bubble) {\n    let el = this.element || this.fragment.owner;\n\n    do {\n      if (el.template.t === ELEMENT) {\n        if (findEvent(el, name)) return true;\n      }\n      el = el.up && el.up.owner;\n      if (el && el.component) el = el.component;\n    } while (el && bubble);\n  }\n\n  link(source, dest) {\n    const there = findModel(this, source).model;\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    here.link(there, source);\n    runloop.end();\n    return promise;\n  }\n\n  listen(event, handler) {\n    const el = this.element;\n    el.on(event, handler);\n    return {\n      cancel() {\n        el.off(event, handler);\n      }\n    };\n  }\n\n  observe(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observe(keypath, callback, options);\n  }\n\n  observeOnce(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observeOnce(keypath, callback, options);\n  }\n\n  pop(keypath) {\n    return modelPop(findModel(this, keypath).model, []);\n  }\n\n  push(keypath, ...values) {\n    return modelPush(findModel(this, keypath).model, values);\n  }\n\n  raise(name, event, ...args) {\n    let el = this.element;\n    let ev;\n\n    while (el) {\n      if (el.component) el = el.component;\n      ev = findEvent(el, name);\n      if (ev) {\n        return ev.fire(\n          ev.element.getContext(\n            event || {},\n            event && !('original' in event) ? { original: {} } : {}\n          ),\n          args\n        );\n      }\n\n      el = el.up && el.up.owner;\n    }\n  }\n\n  readLink(keypath, options) {\n    return this.ractive.readLink(this.resolve(keypath), options);\n  }\n\n  resolve(path, ractive) {\n    const { model, instance } = findModel(this, path);\n    return model ? model.getKeypath(ractive || instance) : path;\n  }\n\n  reverse(keypath) {\n    return modelReverse(findModel(this, keypath).model, []);\n  }\n\n  set(keypath, value, options) {\n    return sharedSet(build(this, keypath, value), options);\n  }\n\n  shift(keypath) {\n    return modelShift(findModel(this, keypath).model, []);\n  }\n\n  splice(keypath, index, drop, ...add) {\n    add.unshift(index, drop);\n    return modelSplice(findModel(this, keypath).model, add);\n  }\n\n  sort(keypath) {\n    return modelSort(findModel(this, keypath).model, []);\n  }\n\n  subtract(keypath, d, options) {\n    const num = isNumber(d) ? d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value - val];\n      }),\n      opts\n    );\n  }\n\n  toggle(keypath, options) {\n    const { model } = findModel(this, keypath);\n    return sharedSet([[model, !model.get()]], options);\n  }\n\n  unlink(dest) {\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    if (here.owner && here.owner._link) here.owner.unlink();\n    runloop.end();\n    return promise;\n  }\n\n  unlisten(event, handler) {\n    this.element.off(event, handler);\n  }\n\n  unshift(keypath, ...add) {\n    return modelUnshift(findModel(this, keypath).model, add);\n  }\n\n  update(keypath, options) {\n    return protoUpdate(this.ractive, findModel(this, keypath).model, options);\n  }\n\n  updateModel(keypath, cascade) {\n    const { model } = findModel(this, keypath);\n    const promise = runloop.start();\n    model.updateFromBindings(cascade);\n    runloop.end();\n    return promise;\n  }\n\n  // two-way binding related helpers\n  isBound() {\n    const { model } = this.getBindingModel(this);\n    return !!model;\n  }\n\n  getBindingPath(ractive) {\n    const { model, instance } = this.getBindingModel(this);\n    if (model) return model.getKeypath(ractive || instance);\n  }\n\n  getBinding() {\n    const { model } = this.getBindingModel(this);\n    if (model) return model.get(true);\n  }\n\n  getBindingModel(ctx) {\n    const el = ctx.element;\n    return { model: el.binding && el.binding.model, instance: el.up.ractive };\n  }\n\n  setBinding(value) {\n    const { model } = this.getBindingModel(this);\n    return sharedSet([[model, value]]);\n  }\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build(ctx, keypath, value) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push([findModel(ctx, k).model, keypath[k]]);\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push([findModel(ctx, keypath).model, value]);\n  }\n\n  return sets;\n}\n\nfunction findModel(ctx, path) {\n  const frag = ctx.fragment;\n\n  if (!isString(path)) {\n    return { model: frag.findContext(), instance: path };\n  }\n\n  return { model: resolveReference(frag, path), instance: frag.ractive };\n}\n\nfunction findEvent(el, name) {\n  return el.events && el.events.find(e => ~e.template.n.indexOf(name));\n}\n","import { doc } from 'config/environment';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { isString } from 'utils/is';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext(node) {\n  if (isString(node) && query) {\n    node = query.call(document, node);\n  }\n\n  let instances;\n  if (node) {\n    if (node._ractive) {\n      return node._ractive.proxy.getContext();\n    } else if ((instances = node.__ractive_instances__) && instances.length === 1) {\n      return getRactiveContext(instances[0]);\n    }\n  }\n}\n\nexport function getNodeInfo(node) {\n  warnOnceIfDebug(\n    `getNodeInfo has been renamed to getContext, and the getNodeInfo alias will be removed in a future release.`\n  );\n  return getContext(node);\n}\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\nimport { isString, isNumber } from 'utils/is';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif (!svg) {\n  /* istanbul ignore next */\n  createElement = (type, ns, extend) => {\n    if (ns && ns !== html) {\n      throw \"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information\";\n    }\n\n    return extend ? doc.createElement(type, extend) : doc.createElement(type);\n  };\n} else {\n  createElement = (type, ns, extend) => {\n    if (!ns || ns === html) {\n      return extend ? doc.createElement(type, extend) : doc.createElement(type);\n    }\n\n    return extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  };\n}\n\nexport function createDocumentFragment() {\n  return doc.createDocumentFragment();\n}\n\nfunction getElement(input) {\n  let output;\n\n  if (!input || typeof input === 'boolean') {\n    return;\n  }\n\n  /* istanbul ignore next */\n  if (!win || !doc || !input) {\n    return null;\n  }\n\n  // We already have a DOM node - no work to do. (Duck typing alert!)\n  if (input.nodeType) {\n    return input;\n  }\n\n  // Get node from string\n  if (isString(input)) {\n    // try ID first\n    output = doc.getElementById(input);\n\n    // then as selector, if possible\n    if (!output && doc.querySelector) {\n      try {\n        output = doc.querySelector(input);\n      } catch (e) {\n        /* this space intentionally left blank */\n      }\n    }\n\n    // did it work?\n    if (output && output.nodeType) {\n      return output;\n    }\n  }\n\n  // If we've been given a collection (jQuery, Zepto etc), extract the first item\n  if (input[0] && input[0].nodeType) {\n    return input[0];\n  }\n\n  return null;\n}\n\nif (!isClient) {\n  matches = null;\n} else {\n  div = createElement('div');\n  methodNames = ['matches', 'matchesSelector'];\n\n  makeFunction = function(methodName) {\n    return function(node, selector) {\n      return node[methodName](selector);\n    };\n  };\n\n  i = methodNames.length;\n\n  while (i-- && !matches) {\n    unprefixed = methodNames[i];\n\n    if (div[unprefixed]) {\n      matches = makeFunction(unprefixed);\n    } else {\n      j = vendors.length;\n      while (j--) {\n        prefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n        if (div[prefixed]) {\n          matches = makeFunction(prefixed);\n          break;\n        }\n      }\n    }\n  }\n\n  // IE8... and apparently phantom some?\n  /* istanbul ignore next */\n  if (!matches) {\n    matches = function(node, selector) {\n      let parentNode, i;\n\n      parentNode = node.parentNode;\n\n      if (!parentNode) {\n        // empty dummy <div>\n        div.innerHTML = '';\n\n        parentNode = div;\n        node = node.cloneNode();\n\n        div.appendChild(node);\n      }\n\n      const nodes = parentNode.querySelectorAll(selector);\n\n      i = nodes.length;\n      while (i--) {\n        if (nodes[i] === node) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  }\n}\n\nfunction detachNode(node) {\n  // stupid ie\n  // eslint-disable-next-line valid-typeof\n  if (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return node;\n}\n\nfunction safeToStringValue(value) {\n  return value == null || (isNumber(value) && isNaN(value)) || !value.toString ? '' : '' + value;\n}\n\nfunction safeAttributeString(string) {\n  return safeToStringValue(string)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","export const html = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg = 'http://www.w3.org/2000/svg';\nexport const xlink = 'http://www.w3.org/1999/xlink';\nexport const xml = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\n\nconst insertHook = new Hook('insert');\n\nexport default function Ractive$insert(target, anchor) {\n  if (!this.fragment.rendered) {\n    // TODO create, and link to, documentation explaining this\n    throw new Error(\n      'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.'\n    );\n  }\n\n  target = getElement(target);\n  anchor = getElement(anchor) || null;\n\n  if (!target) {\n    throw new Error('You must specify a valid target to insert into');\n  }\n\n  target.insertBefore(this.detach(), anchor);\n  this.el = target;\n\n  (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  this.isDetached = false;\n\n  fireInsertHook(this);\n}\n\nfunction fireInsertHook(ractive) {\n  insertHook.fire(ractive);\n\n  ractive.findAllComponents('*').forEach(child => {\n    fireInsertHook(child.instance);\n  });\n}\n","import { isEqual, isFunction } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'shared/rebind';\nimport { create } from 'utils/object';\n\nexport default class Observer {\n  constructor(ractive, model, callback, options) {\n    this.context = options.context || ractive;\n    this.callback = callback;\n    this.ractive = ractive;\n    this.keypath = options.keypath;\n    this.options = options;\n\n    if (model) this.resolved(model);\n\n    if (isFunction(options.old)) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    if (options.init !== false) {\n      this.dirty = true;\n      this.dispatch();\n    } else {\n      updateOld(this);\n    }\n\n    this.dirty = false;\n  }\n\n  cancel() {\n    this.cancelled = true;\n    if (this.model) {\n      this.model.unregister(this);\n    } else {\n      this.resolver.unbind();\n    }\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    if (!this.cancelled) {\n      this.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n      updateOld(this, true);\n      this.dirty = false;\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty) {\n      const newValue = this.model.get();\n      if (isEqual(newValue, this.oldValue)) return;\n\n      this.newValue = newValue;\n\n      if (this.options.strict && this.newValue === this.oldValue) return;\n\n      runloop.addObserver(this, this.options.defer);\n      this.dirty = true;\n\n      if (this.options.once) runloop.scheduleTask(() => this.cancel());\n    } else {\n      // make sure the newValue stays updated in case this observer gets touched multiple times in one loop\n      this.newValue = this.model.get();\n    }\n  }\n\n  rebind(next, previous) {\n    next = rebindMatch(this.keypath, next, previous);\n    if (next === this.model) return false;\n\n    if (this.model) this.model.unregister(this);\n    if (next) next.addShuffleTask(() => this.resolved(next));\n  }\n\n  resolved(model) {\n    this.model = model;\n\n    this.oldValue = undefined;\n    this.newValue = model.get();\n\n    model.register(this);\n  }\n}\n\nfunction updateOld(observer, fresh) {\n  const next = fresh\n    ? observer.model ? observer.model.get() : observer.newValue\n    : observer.newValue;\n  observer.oldValue = observer.oldFn\n    ? observer.oldFn.call(observer.oldContext, undefined, next, observer.keypath)\n    : next;\n}\n","import getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn(item, template, fragment, opts = {}) {\n  if (template && template.f && template.f.s) {\n    item.fn = getFunction(template.f.s, template.f.r.length);\n    if (opts.register === true) {\n      item.models = resolveArgs(item, template, fragment, opts);\n    }\n  }\n}\n\nexport function resolveArgs(item, template, fragment, opts = {}) {\n  return template.f.r.map((ref, i) => {\n    let model;\n\n    if (opts.specialRef && (model = opts.specialRef(ref, i))) return model;\n\n    model = resolveReference(fragment, ref);\n    if (opts.register === true) {\n      model.register(item);\n    }\n\n    return model;\n  });\n}\n\nexport function teardownArgsFn(item, template) {\n  if (template && template.f && template.f.s) {\n    if (item.models)\n      item.models.forEach(m => {\n        if (m && m.unregister) m.unregister(item);\n      });\n    item.models = null;\n  }\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent() {\n  this._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions(select) {\n  /* istanbul ignore next */\n  return select.selectedOptions\n    ? toArray(select.selectedOptions)\n    : select.options ? toArray(select.options).filter(option => option.selected) : [];\n}\n","import { INTERPOLATOR, TRIPLE } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable(attribute) {\n  // The fragment must be a single non-string fragment\n  if (\n    !attribute ||\n    !attribute.template.f ||\n    attribute.template.f.length !== 1 ||\n    attribute.template.f[0].s\n  )\n    return false;\n\n  // A binding is an interpolator `{{ }}`, yey.\n  if (attribute.template.f[0].t === INTERPOLATOR) return true;\n\n  // The above is probably the only true case. For the rest, show an appropriate\n  // warning before returning false.\n\n  // You can't bind a triple curly. HTML values on an attribute makes no sense.\n  if (attribute.template.f[0].t === TRIPLE)\n    warnIfDebug('It is not possible create a binding using a triple mustache.');\n\n  return false;\n}\n\nexport default function selectBinding(element) {\n  const name = element.name;\n  const attributes = element.attributeByName;\n  const isBindableByValue = isBindable(attributes.value);\n  const isBindableByContentEditable = isBindable(attributes.contenteditable);\n  const isContentEditable = element.getAttribute('contenteditable');\n\n  // contenteditable\n  // Bind if the contenteditable is true or a binding that may become true.\n  if ((isContentEditable || isBindableByContentEditable) && isBindableByValue)\n    return ContentEditableBinding;\n\n  // <input>\n  if (name === 'input') {\n    const type = element.getAttribute('type');\n\n    if (type === 'radio') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // For radios we can either bind the name or checked, but not both.\n      // Name binding is handed instead.\n      if (isBindableByName && isBindableByChecked) {\n        warnIfDebug(\n          'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n          { ractive: element.root }\n        );\n        return RadioNameBinding;\n      }\n\n      if (isBindableByName) return RadioNameBinding;\n\n      if (isBindableByChecked) return RadioBinding;\n\n      // Dead end. Unknown binding on radio input.\n      return null;\n    }\n\n    if (type === 'checkbox') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // A checkbox with bindings for both name and checked. Checked treated as\n      // the checkbox value, name is treated as a regular binding.\n      //\n      // See https://github.com/ractivejs/ractive/issues/1749\n      if (isBindableByName && isBindableByChecked) return CheckboxBinding;\n\n      if (isBindableByName) return CheckboxNameBinding;\n\n      if (isBindableByChecked) return CheckboxBinding;\n\n      // Dead end. Unknown binding on checkbox input.\n      return null;\n    }\n\n    if (type === 'file' && isBindableByValue) return FileBinding;\n\n    if (type === 'number' && isBindableByValue) return NumericBinding;\n\n    if (type === 'range' && isBindableByValue) return NumericBinding;\n\n    // Some input of unknown type (browser usually falls back to text).\n    if (isBindableByValue) return GenericBinding;\n\n    // Dead end. Some unknown input and an unbindable.\n    return null;\n  }\n\n  // <select>\n  if (name === 'select' && isBindableByValue) {\n    return element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  }\n\n  // <textarea>\n  if (name === 'textarea' && isBindableByValue) return GenericBinding;\n\n  // Dead end. Some unbindable element.\n  return null;\n}\n","import { doc } from 'config/environment';\n\nexport default function progressiveText(item, target, occupants, text) {\n  if (occupants) {\n    let n = occupants[0];\n    if (n && n.nodeType === 3) {\n      const idx = n.nodeValue.indexOf(text);\n      occupants.shift();\n\n      if (idx === 0) {\n        if (n.nodeValue.length !== text.length) {\n          occupants.unshift(n.splitText(text.length));\n        }\n      } else {\n        n.nodeValue = text;\n      }\n    } else {\n      n = item.node = doc.createTextNode(text);\n      if (occupants[0]) {\n        target.insertBefore(n, occupants[0]);\n      } else {\n        target.appendChild(n);\n      }\n    }\n\n    item.node = n;\n  } else {\n    if (!item.node) item.node = doc.createTextNode(text);\n    target.appendChild(item.node);\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { fillGaps, hasOwn } from 'utils/object';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { findInstance } from 'shared/registry';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default function getPartialTemplate(ractive, name, up) {\n  // If the partial in instance or view heirarchy instances, great\n  let partial = getPartialFromRegistry(ractive, name, up || {});\n  if (partial) return partial;\n\n  // Does it exist on the page as a script tag?\n  partial = parser.fromId(name, { noThrow: true });\n  if (partial) {\n    // parse and register to this ractive instance\n    const parsed = parser.parseFor(partial, ractive);\n\n    // register extra partials on the ractive instance if they don't already exist\n    if (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n    // register (and return main partial if there are others in the template)\n    return (ractive.partials[name] = parsed.t);\n  }\n}\n\nfunction getPartialFromRegistry(ractive, name, up) {\n  // if there was an instance up-hierarchy, cool\n  let partial = findParentPartial(name, up.owner);\n  if (partial) return partial;\n\n  // find first instance in the ractive or view hierarchy that has this partial\n  const instance = findInstance('partials', ractive, name);\n\n  if (!instance) {\n    return;\n  }\n\n  partial = instance.partials[name];\n\n  // partial is a function?\n  let fn;\n  if (isFunction(partial)) {\n    fn = partial;\n    // super partial\n    if (fn.styleSet) return fn;\n\n    fn = partial.bind(instance);\n    fn.isOwner = hasOwn(instance.partials, name);\n    partial = fn.call(ractive, parser);\n  }\n\n  if (!partial && partial !== '') {\n    warnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', {\n      ractive\n    });\n    return;\n  }\n\n  // If this was added manually to the registry,\n  // but hasn't been parsed, parse it now\n  if (!parser.isParsed(partial)) {\n    // use the parseOptions of the ractive instance on which it was found\n    const parsed = parser.parseFor(partial, instance);\n\n    // Partials cannot contain nested partials!\n    // TODO add a test for this\n    if (parsed.p) {\n      warnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n    }\n\n    // if fn, use instance to store result, otherwise needs to go\n    // in the correct point in prototype chain on instance or constructor\n    const target = fn ? instance : findOwner(instance, name);\n\n    // may be a template with partials, which need to be registered and main template extracted\n    target.partials[name] = partial = parsed.t;\n  }\n\n  // store for reset\n  if (fn) partial._fn = fn;\n\n  return partial.v ? partial.t : partial;\n}\n\nfunction findOwner(ractive, key) {\n  return hasOwn(ractive.partials, key) ? ractive : findConstructor(ractive.constructor, key);\n}\n\nfunction findConstructor(constructor, key) {\n  if (!constructor) {\n    return;\n  }\n  return hasOwn(constructor.partials, key) ? constructor : findConstructor(constructor.Parent, key);\n}\n\nfunction findParentPartial(name, parent) {\n  if (parent) {\n    if (\n      parent.template &&\n      parent.template.p &&\n      !isArray(parent.template.p) &&\n      hasOwn(parent.template.p, name)\n    ) {\n      return parent.template.p[name];\n    } else if (parent.up && parent.up.owner) {\n      return findParentPartial(name, parent.up.owner);\n    }\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\nimport { hasOwn } from 'utils/object';\nimport { isString } from 'utils/is';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor(ractive, name) {\n  const instance = findInstance('components', ractive, name);\n  let Component;\n\n  if (instance) {\n    Component = instance.components[name];\n\n    // if not from Ractive.extend or a Promise, it's a function that shold return a constructor\n    if (Component && !Component.isInstance && !Component.then) {\n      // function option, execute and store for reset\n      const fn = Component.bind(instance);\n      fn.isOwner = hasOwn(instance.components, name);\n      Component = fn();\n\n      if (!Component) {\n        warnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', {\n          ractive\n        });\n        return;\n      }\n\n      if (isString(Component)) {\n        // allow string lookup\n        Component = getComponentConstructor(ractive, Component);\n      }\n\n      Component._fn = fn;\n      instance.components[name] = Component;\n    }\n  }\n\n  return Component;\n}\n","import Partial from './Partial';\nimport { ELEMENT } from 'config/types';\nimport { assign } from 'utils/object';\n\nexport default function asyncProxy(promise, options) {\n  const partials = options.template.p || {};\n  const name = options.template.e;\n\n  const opts = assign({}, options, {\n    template: { t: ELEMENT, e: name },\n    macro(handle) {\n      handle.setTemplate(partials['async-loading'] || []);\n      promise.then(\n        cmp => {\n          options.up.ractive.components[name] = cmp;\n          if (partials['async-loaded']) {\n            handle.partials.component = [options.template];\n            handle.setTemplate(partials['async-loaded']);\n          } else {\n            handle.setTemplate([options.template]);\n          }\n        },\n        err => {\n          if (partials['async-failed']) {\n            handle.aliasLocal('error', 'error');\n            handle.set('@local.error', err);\n            handle.setTemplate(partials['async-failed']);\n          } else {\n            handle.setTemplate([]);\n          }\n        }\n      );\n    }\n  });\n  return new Partial(opts);\n}\n","import { ATTRIBUTE, CATCH, ELEMENT, ELSE, INTERPOLATOR, SECTION, THEN } from 'src/config/types';\nimport Partial from './Partial';\nimport { assign } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction extract(tpl, type, name) {\n  const p = tpl.f.find(s => s.t === type);\n  if (p) {\n    if (p.n)\n      return [\n        {\n          t: 19,\n          n: 54,\n          f: p.f || [],\n          z: [{ n: p.n, x: { r: `__await.${name}` } }]\n        }\n      ];\n    else return p.f || [];\n  } else return [];\n}\n\nexport default function Await(options) {\n  const tpl = options.template;\n\n  const success = extract(tpl, THEN, 'value');\n  const error = extract(tpl, CATCH, 'error');\n  const pending = extract(tpl, SECTION);\n  const undef = extract(tpl, ELSE);\n\n  const opts = assign({}, options, {\n    template: {\n      t: ELEMENT,\n      m: [\n        {\n          t: ATTRIBUTE,\n          n: 'for',\n          f: [{ t: INTERPOLATOR, r: tpl.r, rx: tpl.rx, x: tpl.x }]\n        }\n      ]\n    },\n    macro(handle, attrs) {\n      handle.aliasLocal('__await');\n\n      function update(attrs) {\n        if (attrs.for && isFunction(attrs.for.then)) {\n          handle.setTemplate(pending);\n\n          attrs.for.then(\n            v => {\n              handle.set('@local.value', v);\n              handle.setTemplate(success);\n            },\n            e => {\n              handle.set('@local.error', e);\n              handle.setTemplate(error);\n            }\n          );\n        } else if (attrs.for === undefined) {\n          handle.setTemplate(undef);\n        } else {\n          handle.set('@local.value', attrs.for);\n          handle.setTemplate(success);\n        }\n      }\n\n      update(attrs);\n\n      return {\n        update\n      };\n    }\n  });\n\n  opts.macro.attributes = ['for'];\n\n  return new Partial(opts);\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems(items, values, guid, counter = 0) {\n  return items\n    .map(item => {\n      if (item.type === TEXT) {\n        return item.template;\n      }\n\n      if (item.fragment) {\n        if (item.fragment.iterations) {\n          return item.fragment.iterations\n            .map(fragment => {\n              return processItems(fragment.items, values, guid, counter);\n            })\n            .join('');\n        } else {\n          return processItems(item.fragment.items, values, guid, counter);\n        }\n      }\n\n      const placeholderId = `${guid}-${counter++}`;\n      const model = item.model || item.newModel;\n\n      values[placeholderId] = model\n        ? model.wrapper ? model.wrapperValue : model.get()\n        : undefined;\n\n      return '${' + placeholderId + '}';\n    })\n    .join('');\n}\n","import { getElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport { warnIfDebug } from 'utils/log';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render(target, anchor) {\n  if (this.torndown) {\n    warnIfDebug('ractive.render() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  target = getElement(target) || this.el;\n\n  if (!this.append && target) {\n    // Teardown any existing instances *before* trying to set up the new one -\n    // avoids certain weird bugs\n    const others = target.__ractive_instances__;\n    if (others) others.forEach(teardown);\n\n    // make sure we are the only occupants\n    if (!this.enhance) {\n      target.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n    }\n  }\n\n  const occupants = this.enhance ? toArray(target.childNodes) : null;\n  const promise = render(this, target, anchor, occupants);\n\n  if (occupants) {\n    while (occupants.length) target.removeChild(occupants.pop());\n  }\n\n  return promise;\n}\n","import runloop from 'src/global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\nimport { isArray } from 'utils/is';\nimport { handleChange } from 'shared/methodCallers';\n\nfunction collect(source, name, attr, dest) {\n  source.forEach(item => {\n    // queue to rerender if the item is a partial and the current name matches\n    if (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n      item.inAttribute = attr;\n      dest.push(item);\n      return; // go no further\n    }\n\n    // if it has a fragment, process its items\n    if (item.fragment) {\n      collect(item.fragment.iterations || item.fragment.items, name, attr, dest);\n    } else if (isArray(item.items)) {\n      // or if it is itself a fragment, process its items\n      collect(item.items, name, attr, dest);\n    } else if (item.type === COMPONENT && item.instance) {\n      // or if it is a component, step in and process its items\n      // ...unless the partial is shadowed\n      if (item.instance.partials[name]) return;\n      collect(item.instance.fragment.items, name, attr, dest);\n    }\n\n    // if the item is an element, process its attributes too\n    if (item.type === ELEMENT) {\n      if (isArray(item.attributes)) {\n        collect(item.attributes, name, true, dest);\n      }\n    }\n  });\n}\n\nexport default function(name, partial) {\n  const collection = [];\n  collect(this.fragment.items, name, false, collection);\n\n  const promise = runloop.start();\n\n  this.partials[name] = partial;\n  collection.forEach(handleChange);\n\n  runloop.end();\n\n  return promise;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport Fragment from 'src/view/Fragment';\nimport runloop from 'src/global/runloop';\nimport { default as templateConfigurator } from '../config/custom/template';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate(template) {\n  templateConfigurator.init(null, this, { template });\n\n  const transitionsEnabled = this.transitionsEnabled;\n  this.transitionsEnabled = false;\n\n  // Is this is a component, we need to set the `shouldDestroy`\n  // flag, otherwise it will assume by default that a parent node\n  // will be detached, and therefore it doesn't need to bother\n  // detaching its own nodes\n  const component = this.component;\n  if (component) component.shouldDestroy = true;\n  this.unrender();\n  if (component) component.shouldDestroy = false;\n\n  const promise = runloop.start();\n\n  // remove existing fragment and create new one\n  this.fragment.unbind().unrender(true);\n\n  this.fragment = new Fragment({\n    template: this.template,\n    root: this,\n    owner: this\n  });\n\n  const docFrag = createDocumentFragment();\n  this.fragment.bind(this.viewmodel).render(docFrag);\n\n  // if this is a component, its el may not be valid, so find a\n  // target based on the component container\n  if (component && !component.external) {\n    this.fragment.findParentNode().insertBefore(docFrag, component.findNextNode());\n  } else {\n    this.el.insertBefore(docFrag, this.anchor);\n  }\n\n  runloop.end();\n\n  this.transitionsEnabled = transitionsEnabled;\n\n  return promise;\n}\n","import { build, set } from 'shared/set';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$set(keypath, value, options) {\n  const ractive = this;\n\n  const opts = isObjectType(keypath) ? value : options;\n\n  return set(build(ractive, keypath, value, opts && opts.isolated), opts);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$subtract(keypath, d, options) {\n  const num = isNumber(d) ? -d : -1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","import { badArguments } from 'config/errors';\nimport { gather, set } from 'shared/set';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$toggle(keypath, options) {\n  if (!isString(keypath)) {\n    throw new TypeError(badArguments);\n  }\n\n  return set(\n    gather(this, keypath, null, options && options.isolated).map(m => [m, !m.get()]),\n    options\n  );\n}\n","import { getCSS } from 'src/global/css';\nimport { keys } from 'utils/object';\n\nexport default function Ractive$toCSS() {\n  const cssIds = [this.cssId, ...this.findAllComponents().map(c => c.cssId)];\n  const uniqueCssIds = keys(cssIds.reduce((ids, id) => ((ids[id] = true), ids), {}));\n  return getCSS(uniqueCssIds);\n}\n","export default function Ractive$toHTML() {\n  return this.fragment.toString(true);\n}\n","export default function toText() {\n  return this.fragment.toString(false);\n}\n","import runloop from 'src/global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from 'utils/log';\nimport { isObject } from 'utils/is';\n\nexport default function Ractive$transition(name, node, params) {\n  if (node instanceof HTMLElement) {\n    // good to go\n  } else if (isObject(node)) {\n    // omitted, use event node\n    params = node;\n  }\n\n  // if we allow query selector, then it won't work\n  // simple params like \"fast\"\n\n  // else if ( typeof node === 'string' ) {\n  // \t// query selector\n  // \tnode = this.find( node )\n  // }\n\n  node = node || this.event.node;\n\n  if (!node || !node._ractive) {\n    fatal(`No node was supplied for transition ${name}`);\n  }\n\n  params = params || {};\n  const owner = node._ractive.proxy;\n  const transition = new Transition({ owner, up: owner.up, name, params });\n  transition.bind();\n\n  const promise = runloop.start();\n  runloop.registerTransition(transition);\n  runloop.end();\n\n  promise.then(() => transition.unbind());\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function unlink(here) {\n  const promise = runloop.start();\n  this.viewmodel.joinAll(splitKeypath(here), { lastLink: false }).unlink();\n  runloop.end();\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$updateModel(keypath, cascade) {\n  const promise = runloop.start();\n\n  if (!keypath) {\n    this.viewmodel.updateFromBindings(true);\n  } else {\n    this.viewmodel.joinAll(splitKeypath(keypath)).updateFromBindings(cascade !== false);\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function use(...plugins) {\n  plugins.forEach(p => {\n    p({\n      proto: this,\n      Ractive: this.constructor.Ractive,\n      instance: this\n    });\n  });\n  return this;\n}\n","export default function isInstance(object) {\n  return object && object instanceof this;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function styleGet(keypath) {\n  return this._cssModel.joinAll(splitKeypath(keypath)).get();\n}\n","import { build, set } from '../../shared/set';\nimport SharedModel from '../../model/specials/SharedModel';\nimport { isObjectType } from 'utils/is';\n\nexport default function sharedSet(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = SharedModel;\n\n  return set(build({ viewmodel: model }, keypath, value, true), opts);\n}\n","import SharedModel from '../../model/specials/SharedModel';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function sharedGet(keypath) {\n  return SharedModel.joinAll(splitKeypath(keypath)).get();\n}\n","import { isFunction } from 'utils/is';\n\nexport default function use(...plugins) {\n  plugins.forEach(p => {\n    isFunction(p) &&\n      p({\n        proto: this.prototype,\n        Ractive: this.Ractive,\n        instance: this\n      });\n  });\n  return this;\n}\n","import styleGet from '../Ractive/static/styleGet';\nimport styleSet from '../Ractive/static/styleSet';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperties, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nimport { initCSS } from 'src/Ractive/config/custom/css/css';\n\nexport default function macro(fn, opts) {\n  if (!isFunction(fn)) throw new Error(`The macro must be a function`);\n\n  assign(fn, opts);\n\n  defineProperties(fn, {\n    extensions: { value: [] },\n    _cssIds: { value: [] },\n    cssData: { value: assign(create(this.cssData), fn.cssData || {}) },\n\n    styleGet: { value: styleGet.bind(fn) },\n    styleSet: { value: styleSet.bind(fn) }\n  });\n\n  defineProperty(fn, '_cssModel', { value: new CSSModel(fn) });\n\n  if (fn.css) initCSS(fn, fn, fn);\n\n  this.extensions.push(fn);\n\n  return fn;\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from 'shared/keypaths';\n\nexport function joinKeys(...keys) {\n  return keys.map(escapeKey).join('.');\n}\n\nexport function splitKeypath(keypath) {\n  return splitKeypathI(keypath).map(unescapeKey);\n}\n","import { findInViewHierarchy } from 'shared/registry';\n\nexport function findPlugin(name, type, instance) {\n  return findInViewHierarchy(type, instance, name);\n}\n","/* istanbul ignore if */\nif (!Object.assign) {\n  Object.assign = function(target, ...sources) {\n    if (target == null) throw new TypeError('Cannot convert undefined or null to object');\n\n    const to = Object(target);\n    const sourcesLength = sources.length;\n\n    for (let index = 0; index < sourcesLength; index++) {\n      const nextSource = sources[index];\n      for (const nextKey in nextSource) {\n        if (!Object.prototype.hasOwnProperty.call(nextSource, nextKey)) continue;\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n\n    return to;\n  };\n}\n","export function hasOwn(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function fillGaps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    for (const key in source) {\n      // Source can be a prototype-less object.\n      if (key in target || !hasOwn(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nexport function toPairs(obj = {}) {\n  const pairs = [];\n  for (const key in obj) {\n    // Source can be a prototype-less object.\n    if (!hasOwn(obj, key)) continue;\n    pairs.push([key, obj[key]]);\n  }\n  return pairs;\n}\n\nconst obj = Object;\n\nexport const assign = obj.assign;\n\nexport const create = obj.create;\n\nexport const defineProperty = obj.defineProperty;\n\nexport const defineProperties = obj.defineProperties;\n\nexport const keys = obj.keys;\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike(obj) {\n  return arrayLikePattern.test(toString.call(obj));\n}\n\nexport const isArray = Array.isArray;\n\nexport function isEqual(a, b) {\n  if (a === null && b === null) {\n    return true;\n  }\n\n  if (isObjectType(a) || isObjectType(b)) {\n    return false;\n  }\n\n  return a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric(thing) {\n  return !isNaN(parseFloat(thing)) && isFinite(thing);\n}\n\nexport function isObject(thing) {\n  return thing && toString.call(thing) === '[object Object]';\n}\n\nexport function isObjectLike(thing) {\n  return !!(thing && (isObjectType(thing) || isFunction(thing)));\n}\n\nexport function isObjectType(thing) {\n  return typeof thing === 'object';\n}\n\nexport function isFunction(thing) {\n  return typeof thing === 'function';\n}\n\nexport function isString(thing) {\n  return typeof thing === 'string';\n}\n\nexport function isNumber(thing) {\n  return typeof thing === 'number';\n}\n","/* istanbul ignore if */\nif (typeof window !== 'undefined' && window.performance && !window.performance.now) {\n  window.performance = window.performance || {};\n\n  const nowOffset = Date.now();\n\n  window.performance.now = function() {\n    return Date.now() - nowOffset;\n  };\n}\n","import { hasOwn, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n/* istanbul ignore if */\nif (!Array.prototype.find) {\n  defineProperty(Array.prototype, 'find', {\n    value(callback, thisArg) {\n      if (this === null || this === undefined)\n        throw new TypeError('Array.prototype.find called on null or undefined');\n\n      if (!isFunction(callback)) throw new TypeError(`${callback} is not a function`);\n\n      const array = Object(this);\n      const arrayLength = array.length >>> 0;\n\n      for (let index = 0; index < arrayLength; index++) {\n        if (!hasOwn(array, index)) continue;\n        if (!callback.call(thisArg, array[index], index, array)) continue;\n        return array[index];\n      }\n\n      return undefined;\n    },\n    configurable: true,\n    writable: true\n  });\n}\n","// NOTE: Node doesn't exist in IE8. Nothing can be done.\n/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  window.Node &&\n  window.Node.prototype &&\n  !window.Node.prototype.contains\n) {\n  Node.prototype.contains = function(node) {\n    if (!node) throw new TypeError('node required');\n\n    do {\n      if (this === node) return true;\n    } while ((node = node && node.parentNode));\n\n    return false;\n  };\n}\n","import { isFunction, isObjectType } from 'utils/is';\n\n/* istanbul ignore if */\nif (typeof window !== 'undefined' && !window.Promise) {\n  const PENDING = {};\n  const FULFILLED = {};\n  const REJECTED = {};\n\n  const Promise = (window.Promise = function(callback) {\n    const fulfilledHandlers = [];\n    const rejectedHandlers = [];\n    let state = PENDING;\n    let result;\n    let dispatchHandlers;\n\n    const makeResolver = newState => {\n      return function(value) {\n        if (state !== PENDING) return;\n        result = value;\n        state = newState;\n        dispatchHandlers = makeDispatcher(\n          state === FULFILLED ? fulfilledHandlers : rejectedHandlers,\n          result\n        );\n        wait(dispatchHandlers);\n      };\n    };\n\n    const fulfill = makeResolver(FULFILLED);\n    const reject = makeResolver(REJECTED);\n\n    try {\n      callback(fulfill, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    return {\n      // `then()` returns a Promise - 2.2.7\n      then(onFulfilled, onRejected) {\n        const promise2 = new Promise((fulfill, reject) => {\n          const processResolutionHandler = (handler, handlers, forward) => {\n            if (isFunction(handler)) {\n              handlers.push(p1result => {\n                try {\n                  resolve(promise2, handler(p1result), fulfill, reject);\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            } else {\n              handlers.push(forward);\n            }\n          };\n\n          processResolutionHandler(onFulfilled, fulfilledHandlers, fulfill);\n          processResolutionHandler(onRejected, rejectedHandlers, reject);\n\n          if (state !== PENDING) {\n            wait(dispatchHandlers);\n          }\n        });\n        return promise2;\n      },\n      catch(onRejected) {\n        return this.then(null, onRejected);\n      }\n    };\n  });\n\n  Promise.all = function(promises) {\n    return new Promise((fulfil, reject) => {\n      const result = [];\n      let pending;\n      let i;\n\n      if (!promises.length) {\n        fulfil(result);\n        return;\n      }\n\n      const processPromise = (promise, i) => {\n        if (promise && isFunction(promise.then)) {\n          promise.then(value => {\n            result[i] = value;\n            --pending || fulfil(result);\n          }, reject);\n        } else {\n          result[i] = promise;\n          --pending || fulfil(result);\n        }\n      };\n\n      pending = i = promises.length;\n\n      while (i--) {\n        processPromise(promises[i], i);\n      }\n    });\n  };\n\n  Promise.resolve = function(value) {\n    return new Promise(fulfill => {\n      fulfill(value);\n    });\n  };\n\n  Promise.reject = function(reason) {\n    return new Promise((fulfill, reject) => {\n      reject(reason);\n    });\n  };\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  const wait = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  const makeDispatcher = function(handlers, result) {\n    return function() {\n      for (let handler; (handler = handlers.shift()); ) {\n        handler(result);\n      }\n    };\n  };\n\n  const resolve = function(promise, x, fulfil, reject) {\n    let then;\n    if (x === promise) {\n      throw new TypeError(`A promise's fulfillment handler cannot return the same promise`);\n    }\n    if (x instanceof Promise) {\n      x.then(fulfil, reject);\n    } else if (x && (isObjectType(x) || isFunction(x))) {\n      try {\n        then = x.then;\n      } catch (e) {\n        reject(e);\n        return;\n      }\n      if (isFunction(then)) {\n        let called;\n\n        const resolvePromise = function(y) {\n          if (called) return;\n          called = true;\n          resolve(promise, y, fulfil, reject);\n        };\n        const rejectPromise = function(r) {\n          if (called) return;\n          called = true;\n          reject(r);\n        };\n\n        try {\n          then.call(x, resolvePromise, rejectPromise);\n        } catch (e) {\n          if (!called) {\n            reject(e);\n            called = true;\n            return;\n          }\n        }\n      } else {\n        fulfil(x);\n      }\n    } else {\n      fulfil(x);\n    }\n  };\n}\n","/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  !(window.requestAnimationFrame && window.cancelAnimationFrame)\n) {\n  let lastTime = 0;\n  window.requestAnimationFrame = function(callback) {\n    const currentTime = Date.now();\n    const timeToNextCall = Math.max(0, 16 - (currentTime - lastTime));\n    const id = window.setTimeout(() => {\n      callback(currentTime + timeToNextCall);\n    }, timeToNextCall);\n    lastTime = currentTime + timeToNextCall;\n    return id;\n  };\n  window.cancelAnimationFrame = function(id) {\n    clearTimeout(id);\n  };\n}\n","import { create } from 'utils/object';\n\nexport default {\n  // render placement:\n  el: void 0,\n  append: false,\n  delegate: true,\n  enhance: false,\n\n  // template:\n  template: null,\n\n  // parse:\n  allowExpressions: true,\n  delimiters: ['{{', '}}'],\n  tripleDelimiters: ['{{{', '}}}'],\n  staticDelimiters: ['[[', ']]'],\n  staticTripleDelimiters: ['[[[', ']]]'],\n  csp: true,\n  interpolate: false,\n  preserveWhitespace: false,\n  sanitize: false,\n  stripComments: true,\n  contextLines: 0,\n\n  // data & binding:\n  data: create(null),\n  helpers: create(null),\n  computed: create(null),\n  syncComputedChildren: false,\n  resolveInstanceMembers: true,\n  warnAboutAmbiguity: false,\n  adapt: [],\n  isolated: true,\n  twoway: true,\n  lazy: false,\n\n  // transitions:\n  noIntro: false,\n  noOutro: false,\n  transitionsEnabled: true,\n  complete: void 0,\n  nestedTransitions: true,\n\n  // css:\n  css: null,\n  noCssTransform: false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\nimport { isObjectType } from 'utils/is';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif (hasConsole) {\n  const welcomeIntro = [\n    `%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n    'color: rgb(114, 157, 52); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n  ];\n  const welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n  welcome = () => {\n    if (Ractive.WELCOME_MESSAGE === false) {\n      welcome = noop;\n      return;\n    }\n    const message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n    const hasGroup = !!console.groupCollapsed;\n    if (hasGroup) console.groupCollapsed.apply(console, welcomeIntro);\n    console.log(message);\n    if (hasGroup) {\n      console.groupEnd(welcomeIntro);\n    }\n\n    welcome = noop;\n  };\n\n  printWarning = (message, args) => {\n    welcome();\n\n    // extract information about the instance this message pertains to, if applicable\n    if (isObjectType(args[args.length - 1])) {\n      const options = args.pop();\n      const ractive = options ? options.ractive : null;\n\n      if (ractive) {\n        // if this is an instance of a component that we know the name of, add\n        // it to the message\n        let name;\n        if (ractive.component && (name = ractive.component.name)) {\n          message = `<${name}> ${message}`;\n        }\n\n        let node;\n        if (\n          (node =\n            options.node || (ractive.fragment && ractive.fragment.rendered && ractive.find('*')))\n        ) {\n          args.push(node);\n        }\n      }\n    }\n\n    console.warn.apply(\n      console,\n      ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(\n        args\n      )\n    );\n  };\n\n  log = function() {\n    console.log.apply(console, arguments);\n  };\n} else {\n  printWarning = log = welcome = noop;\n}\n\nfunction format(message, args) {\n  return message.replace(/%s/g, () => args.shift());\n}\n\nfunction fatal(message, ...args) {\n  message = format(message, args);\n  throw new Error(message);\n}\n\nfunction logIfDebug() {\n  if (Ractive.DEBUG) {\n    log.apply(null, arguments);\n  }\n}\n\nfunction warn(message, ...args) {\n  message = format(message, args);\n  printWarning(message, args);\n}\n\nfunction warnOnce(message, ...args) {\n  message = format(message, args);\n\n  if (alreadyWarned[message]) {\n    return;\n  }\n\n  alreadyWarned[message] = true;\n  printWarning(message, args);\n}\n\nfunction warnIfDebug() {\n  if (Ractive.DEBUG) {\n    warn.apply(null, arguments);\n  }\n}\n\nfunction warnOnceIfDebug() {\n  if (Ractive.DEBUG) {\n    warnOnce.apply(null, arguments);\n  }\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\nexport default {\n  linear(pos) {\n    return pos;\n  },\n  easeIn(pos) {\n    /* istanbul ignore next */\n    return Math.pow(pos, 3);\n  },\n  easeOut(pos) {\n    return Math.pow(pos - 1, 3) + 1;\n  },\n  easeInOut(pos) {\n    /* istanbul ignore next */\n    if ((pos /= 0.5) < 1) {\n      return 0.5 * Math.pow(pos, 3);\n    }\n    /* istanbul ignore next */\n    return 0.5 * (Math.pow(pos - 2, 3) + 2);\n  }\n};\n","/* eslint no-console:\"off\" */\nimport { isFunction } from 'utils/is';\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst hasConsole =\n  typeof console !== 'undefined' && isFunction(console.warn) && isFunction(console.warn.apply);\n\nconst svg = doc\n  ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n  : false;\n\nconst vendors = ['o', 'ms', 'moz', 'webkit'];\n\nexport { win, doc, isClient, hasConsole, svg, vendors };\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn =\n  'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = (name, type) =>\n  `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://ractive.js.org/integrations/#${type}s`;\n","import { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\nimport { hasOwn } from 'utils/object';\n\nconst interpolators = {\n  number(from, to) {\n    if (!isNumeric(from) || !isNumeric(to)) {\n      return null;\n    }\n\n    from = +from;\n    to = +to;\n\n    const delta = to - from;\n\n    if (!delta) {\n      return function() {\n        return from;\n      };\n    }\n\n    return function(t) {\n      return from + t * delta;\n    };\n  },\n\n  array(from, to) {\n    let len, i;\n\n    if (!isArray(from) || !isArray(to)) {\n      return null;\n    }\n\n    const intermediate = [];\n    const interpolators = [];\n\n    i = len = Math.min(from.length, to.length);\n    while (i--) {\n      interpolators[i] = interpolate(from[i], to[i]);\n    }\n\n    // surplus values - don't interpolate, but don't exclude them either\n    for (i = len; i < from.length; i += 1) {\n      intermediate[i] = from[i];\n    }\n\n    for (i = len; i < to.length; i += 1) {\n      intermediate[i] = to[i];\n    }\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        intermediate[i] = interpolators[i](t);\n      }\n\n      return intermediate;\n    };\n  },\n\n  object(from, to) {\n    if (!isObject(from) || !isObject(to)) {\n      return null;\n    }\n\n    const properties = [];\n    const intermediate = {};\n    const interpolators = {};\n\n    for (const prop in from) {\n      if (hasOwn(from, prop)) {\n        if (hasOwn(to, prop)) {\n          properties.push(prop);\n          interpolators[prop] = interpolate(from[prop], to[prop]) || (() => to[prop]);\n        } else {\n          intermediate[prop] = from[prop];\n        }\n      }\n    }\n\n    for (const prop in to) {\n      if (hasOwn(to, prop) && !hasOwn(from, prop)) {\n        intermediate[prop] = to[prop];\n      }\n    }\n\n    const len = properties.length;\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        const prop = properties[i];\n\n        intermediate[prop] = interpolators[prop](t);\n      }\n\n      return intermediate;\n    };\n  }\n};\n\nexport default interpolators;\n","import { isString } from 'utils/is';\n\nconst refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey(key) {\n  if (isString(key)) {\n    return key.replace(escapeKeyPattern, '\\\\$&');\n  }\n\n  return key;\n}\n\nexport function normalise(ref) {\n  return ref ? ref.replace(refPattern, '.$1') : '';\n}\n\nexport function splitKeypath(keypath) {\n  const result = [];\n  let match;\n\n  keypath = normalise(keypath);\n\n  while ((match = splitPattern.exec(keypath))) {\n    const index = match.index + match[1].length;\n    result.push(keypath.substr(0, index));\n    keypath = keypath.substr(index + 1);\n  }\n\n  result.push(keypath);\n\n  return result;\n}\n\nexport function unescapeKey(key) {\n  if (isString(key)) {\n    return key.replace(unescapeKeyPattern, '$1$2');\n  }\n\n  return key;\n}\n","const fnBind = Function.prototype.bind;\n\nexport default function bind(fn, context) {\n  if (!/this/.test(fn.toString())) return fn;\n\n  const bound = fnBind.call(fn, context);\n  for (const prop in fn) bound[prop] = fn[prop];\n\n  return bound;\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$add(keypath, d, options) {\n  const num = isNumber(d) ? d : 1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export function enqueue(ractive, event) {\n  if (ractive.event) {\n    ractive._eventQueue.push(ractive.event);\n  }\n\n  ractive.event = event;\n}\n\nexport function dequeue(ractive) {\n  if (ractive._eventQueue.length) {\n    ractive.event = ractive._eventQueue.pop();\n  } else {\n    ractive.event = null;\n  }\n}\n","export function findAnchors(fragment, name = null) {\n  const res = [];\n\n  findAnchorsIn(fragment, name, res);\n\n  return res;\n}\n\nfunction findAnchorsIn(item, name, result) {\n  if (item.isAnchor) {\n    if (!name || item.name === name) {\n      result.push(item);\n    }\n  } else if (item.items) {\n    item.items.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.iterations) {\n    item.iterations.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.fragment && !item.component) {\n    findAnchorsIn(item.fragment, name, result);\n  }\n}\n\nexport function updateAnchors(instance, name = null) {\n  const anchors = findAnchors(instance.fragment, name);\n  const idxs = {};\n  const children = instance._children.byName;\n\n  anchors.forEach(a => {\n    const name = a.name;\n    if (!(name in idxs)) idxs[name] = 0;\n    const idx = idxs[name];\n    const child = (children[name] || [])[idx];\n\n    if (child && child.lastBound !== a) {\n      if (child.lastBound) child.lastBound.removeChild(child);\n      a.addChild(child);\n    }\n\n    idxs[name]++;\n  });\n}\n\nexport function unrenderChild(meta) {\n  if (meta.instance.fragment.rendered) {\n    meta.shouldDestroy = true;\n    meta.instance.unrender();\n  }\n  meta.instance.el = null;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport { isString, isFunction } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { fireShuffleTasks } from 'src/model/ModelBase';\n\nexport function compute(path, computed) {\n  this.computed[path] = computed;\n  if (isString(computed) || isFunction(computed))\n    computed = this.computed[path] = { get: computed };\n\n  const keys = splitKeypath(path);\n  if (!~path.indexOf('*')) {\n    const last = keys.pop();\n    return this.viewmodel.joinAll(keys).compute(last, computed);\n  } else {\n    computed.pattern = new RegExp(\n      '^' +\n        keys\n          .map(k => k.replace(/\\*\\*/g, '(.+)').replace(/\\*/g, '((?:\\\\\\\\.|[^\\\\.])+)'))\n          .join('\\\\.') +\n        '$'\n    );\n  }\n}\n\nexport default function Ractive$compute(path, computed) {\n  const promise = runloop.start();\n  const comp = compute.call(this, path, computed);\n\n  if (comp) {\n    const keys = splitKeypath(path);\n    if (keys.length === 1 && !comp.isReadonly) {\n      comp.set(this.viewmodel.value[keys[0]]);\n    }\n\n    const first = keys.reduce((a, c) => a && a.childByKey[c], this.viewmodel);\n    if (first) {\n      first.rebind(comp, first, false);\n      if (first.parent) delete first.parent.childByKey[first.key];\n      fireShuffleTasks();\n    }\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function Ractive$find(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM`\n    );\n\n  let node = this.fragment.find(selector, options);\n  if (node) return node;\n\n  if (options.remote) {\n    for (let i = 0; i < this._children.length; i++) {\n      if (!this._children[i].instance.fragment.rendered) continue;\n      node = this._children[i].instance.find(selector, options);\n      if (node) return node;\n    }\n  }\n}\n","import { isArray } from 'utils/is';\n\nexport default function Ractive$findAll(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM`\n    );\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAll(selector, options);\n\n  if (options.remote) {\n    // seach non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        c.instance.findAll(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isArray, isObjectType } from 'utils/is';\n\nexport default function Ractive$findAllComponents(selector, options) {\n  if (!options && isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  options = options || {};\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAllComponents(selector, options);\n\n  if (options.remote) {\n    // search non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        if (!selector || c.name === selector) {\n          options.result.push(c.instance);\n        }\n\n        c.instance.findAllComponents(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isObjectType } from 'utils/is';\n\nexport default function Ractive$findComponent(selector, options = {}) {\n  if (isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  let child = this.fragment.findComponent(selector, options);\n  if (child) return child;\n\n  if (options.remote) {\n    if (!selector && this._children.length) return this._children[0].instance;\n    for (let i = 0; i < this._children.length; i++) {\n      // skip children that are or should be in an anchor\n      if (this._children[i].target) continue;\n      if (this._children[i].name === selector) return this._children[i].instance;\n      child = this._children[i].instance.findComponent(selector, options);\n      if (child) return child;\n    }\n  }\n}\n","export default function Ractive$findContainer(selector) {\n  if (this.container) {\n    if (this.container.component && this.container.component.name === selector) {\n      return this.container;\n    } else {\n      return this.container.findContainer(selector);\n    }\n  }\n\n  return null;\n}\n","export default function Ractive$findParent(selector) {\n  if (this.parent) {\n    if (this.parent.component && this.parent.component.name === selector) {\n      return this.parent;\n    } else {\n      return this.parent.findParent(selector);\n    }\n  }\n\n  return null;\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from 'config/types';\n\nexport default function findElement(start, orComponent = true, name) {\n  while (\n    start &&\n    (start.type !== ELEMENT || (name && start.name !== name)) &&\n    (!orComponent || (start.type !== COMPONENT && start.type !== ANCHOR))\n  ) {\n    // start is a fragment - look at the owner\n    if (start.owner) start = start.owner;\n    else if (start.component)\n      // start is a component or yielder - look at the container\n      start = start.containerFragment || start.component.up;\n    else if (start.parent)\n      // start is an item - look at the parent\n      start = start.parent;\n    else if (start.up)\n      // start is an item without a parent - look at the parent fragment\n      start = start.up;\n    else start = undefined;\n  }\n\n  return start;\n}\n","import { isNumber } from 'utils/is';\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices(length, methodName, args) {\n  const newIndices = [];\n\n  const spliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  if (!spliceArguments) {\n    return null; // TODO support reverse and sort?\n  }\n\n  const balance = spliceArguments.length - 2 - spliceArguments[1];\n\n  const removeStart = Math.min(length, spliceArguments[0]);\n  const removeEnd = removeStart + spliceArguments[1];\n  newIndices.startIndex = removeStart;\n\n  let i;\n  for (i = 0; i < removeStart; i += 1) {\n    newIndices.push(i);\n  }\n\n  for (; i < removeEnd; i += 1) {\n    newIndices.push(-1);\n  }\n\n  for (; i < length; i += 1) {\n    newIndices.push(i + balance);\n  }\n\n  // there is a net shift for the rest of the array starting with index + balance\n  if (balance !== 0) {\n    newIndices.touchedFrom = spliceArguments[0];\n  } else {\n    newIndices.touchedFrom = length;\n  }\n\n  return newIndices;\n}\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent(length, methodName, args) {\n  switch (methodName) {\n    case 'splice':\n      if (args[0] !== undefined && args[0] < 0) {\n        args[0] = length + Math.max(args[0], -length);\n      }\n\n      if (args[0] === undefined) args[0] = 0;\n\n      while (args.length < 2) {\n        args.push(length - args[0]);\n      }\n\n      if (!isNumber(args[1])) {\n        args[1] = length - args[0];\n      }\n\n      // ensure we only remove elements that exist\n      args[1] = Math.min(args[1], length - args[0]);\n\n      return args;\n\n    case 'sort':\n    case 'reverse':\n      return null;\n\n    case 'pop':\n      if (length) {\n        return [length - 1, 1];\n      }\n      return [0, 0];\n\n    case 'push':\n      return [length, 0].concat(args);\n\n    case 'shift':\n      return [0, length ? 1 : 0];\n\n    case 'unshift':\n      return [0, 0].concat(args);\n  }\n}\n","import fireEvent from 'src/events/fireEvent';\nimport Context from 'shared/Context';\nimport { assign, create } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$fire(eventName, ...args) {\n  let ctx;\n\n  // watch for reproxy\n  if (args[0] instanceof Context) {\n    const proto = args.shift();\n    ctx = create(proto);\n    assign(ctx, proto);\n  } else if (isObjectType(args[0]) && (args[0] === null || args[0].constructor === Object)) {\n    ctx = Context.forRactive(this, args.shift());\n  } else {\n    ctx = Context.forRactive(this);\n  }\n\n  return fireEvent(this, eventName, ctx, args);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport { FakeFragment } from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$get(keypath, opts) {\n  if (!isString(keypath)) return this.viewmodel.get(true, keypath);\n\n  const keys = splitKeypath(keypath);\n  const key = keys[0];\n\n  let model;\n\n  if (!this.viewmodel.has(key)) {\n    // if this is an inline component, we may need to create\n    // an implicit mapping\n    if (this.component && !this.isolated) {\n      model = resolveReference(this.fragment || new FakeFragment(this), key);\n    }\n  }\n\n  model = this.viewmodel.joinAll(keys);\n  return model.get(true, opts);\n}\n","import staticContext, { getNodeInfo as staticInfo } from '../static/getContext';\nimport { isString } from 'utils/is';\n\nexport default function getContext(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticContext(node);\n}\n\nexport function getNodeInfo(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticInfo(node);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from 'src/global/runloop';\n\nexport default function link(there, here, options) {\n  let model;\n  const target = (options && (options.ractive || options.instance)) || this;\n\n  // may need to allow a mapping to resolve implicitly\n  const sourcePath = splitKeypath(there);\n  if (!target.viewmodel.has(sourcePath[0]) && target.component) {\n    model = resolveReference(target.component.up, sourcePath[0]);\n    model = model.joinAll(sourcePath.slice(1));\n  }\n\n  const src = model || target.viewmodel.joinAll(sourcePath);\n  const dest = this.viewmodel.joinAll(splitKeypath(here), { lastLink: false });\n\n  if (isUpstream(src, dest) || isUpstream(dest, src)) {\n    throw new Error('A keypath cannot be linked to itself.');\n  }\n\n  const promise = runloop.start();\n\n  dest.link(src, (options && options.keypath) || there);\n\n  runloop.end();\n\n  return promise;\n}\n\nfunction isUpstream(check, start) {\n  let model = start;\n  while (model) {\n    if (model === check || model.owner === check) return true;\n    model = model.target || model.parent;\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\nimport { keys } from 'utils/object';\n\nexport default function observe(keypath, callback, options) {\n  const observers = [];\n  let map;\n  let opts;\n\n  if (isObject(keypath)) {\n    map = keypath;\n    opts = callback || {};\n  } else {\n    if (isFunction(keypath)) {\n      map = { '': keypath };\n      opts = callback || {};\n    } else {\n      map = {};\n      map[keypath] = callback;\n      opts = options || {};\n    }\n  }\n\n  let silent = false;\n  keys(map).forEach(keypath => {\n    const callback = map[keypath];\n    const caller = function(...args) {\n      if (silent) return;\n      return callback.apply(this, args);\n    };\n\n    let keypaths = keypath.split(' ');\n    if (keypaths.length > 1) keypaths = keypaths.filter(k => k);\n\n    keypaths.forEach(keypath => {\n      opts.keypath = keypath;\n      const observer = createObserver(this, keypath, caller, opts);\n      if (observer) observers.push(observer);\n    });\n  });\n\n  // add observers to the Ractive instance, so they can be\n  // cancelled on ractive.teardown()\n  this._observers.push.apply(this._observers, observers);\n\n  return {\n    cancel: () => observers.forEach(o => o.cancel()),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n\nfunction createObserver(ractive, keypath, callback, options) {\n  const keys = splitKeypath(keypath);\n  let wildcardIndex = keys.indexOf('*');\n  if (!~wildcardIndex) wildcardIndex = keys.indexOf('**');\n\n  options.fragment = options.fragment || ractive.fragment;\n\n  let model;\n  if (!options.fragment) {\n    model = ractive.viewmodel.joinKey(keys[0]);\n  } else {\n    // .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n    if (~keys[0].indexOf('.*')) {\n      model = options.fragment.findContext();\n      wildcardIndex = 0;\n      keys[0] = keys[0].slice(1);\n    } else {\n      model =\n        wildcardIndex === 0\n          ? options.fragment.findContext()\n          : resolveReference(options.fragment, keys[0]);\n    }\n  }\n\n  // the model may not exist key\n  if (!model) model = ractive.viewmodel.joinKey(keys[0]);\n\n  if (!~wildcardIndex) {\n    model = model.joinAll(keys.slice(1));\n    if (options.array) {\n      return new ArrayObserver(ractive, model, callback, options);\n    } else {\n      return new Observer(ractive, model, callback, options);\n    }\n  } else {\n    const double = keys.indexOf('**');\n    if (~double) {\n      if (double + 1 !== keys.length || ~keys.indexOf('*')) {\n        warnOnceIfDebug(\n          `Recursive observers may only specify a single '**' at the end of the path.`\n        );\n        return;\n      }\n    }\n\n    model = model.joinAll(keys.slice(1, wildcardIndex));\n\n    return new PatternObserver(ractive, model, keys.slice(wildcardIndex), callback, options);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off(eventName, callback) {\n  // if no event is specified, remove _all_ event listeners\n  if (!eventName) {\n    this._subs = {};\n  } else {\n    // Handle multiple space-separated event names\n    const eventNames = eventName\n      .split(' ')\n      .map(trim)\n      .filter(notEmptyString);\n\n    eventNames.forEach(event => {\n      const subs = this._subs[event];\n      // if given a specific callback to remove, remove only it\n      if (subs && callback) {\n        const entry = subs.find(s => s.callback === callback);\n        if (entry) {\n          removeFromArray(subs, entry);\n          entry.off = true;\n\n          if (event.indexOf('.')) this._nsSubs--;\n        }\n      } else if (subs) {\n        // otherwise, remove all listeners for this event\n        if (event.indexOf('.')) this._nsSubs -= subs.length;\n        subs.length = 0;\n      }\n    });\n  }\n\n  return this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { hasOwn } from 'utils/object';\nimport { isObjectType, isString } from 'utils/is';\n\nexport default function Ractive$on(eventName, callback) {\n  // eventName may already be a map\n  const map = isObjectType(eventName) ? eventName : {};\n  // or it may be a string along with a callback\n  if (isString(eventName)) map[eventName] = callback;\n\n  let silent = false;\n  const events = [];\n\n  for (const k in map) {\n    const callback = map[k];\n    const caller = function(...args) {\n      if (!silent) return callback.apply(this, args);\n    };\n    const entry = {\n      callback,\n      handler: caller\n    };\n\n    if (hasOwn(map, k)) {\n      const names = k\n        .split(' ')\n        .map(trim)\n        .filter(notEmptyString);\n      names.forEach(n => {\n        (this._subs[n] || (this._subs[n] = [])).push(entry);\n        if (n.indexOf('.')) this._nsSubs++;\n        events.push([n, entry]);\n      });\n    }\n  }\n\n  return {\n    cancel: () => events.forEach(e => this.off(e[0], e[1].callback)),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n","export default function Ractive$once(eventName, handler) {\n  const listener = this.on(eventName, function() {\n    handler.apply(this, arguments);\n    listener.cancel();\n  });\n\n  // so we can still do listener.cancel() manually\n  return listener;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function readLink(keypath, options = {}) {\n  const path = splitKeypath(keypath);\n\n  if (this.viewmodel.has(path[0])) {\n    let model = this.viewmodel.joinAll(path);\n\n    if (!model.isLink) return;\n\n    while ((model = model.target) && options.canonical !== false) {\n      if (!model.isLink) break;\n    }\n\n    if (model) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n  }\n}\n","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport function uuid() {\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import { applyCSS } from '../../global/css';\nimport transformCSS from '../config/custom/css/transform';\nimport { evalCSS } from '../config/custom/css/css';\nimport { build, set } from '../../shared/set';\nimport runloop from '../../global/runloop';\nimport { isObjectType, isFunction } from 'utils/is';\n\nexport default function setCSSData(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = this._cssModel;\n\n  model.locked = true;\n  const promise = set(build({ viewmodel: model }, keypath, value, true), opts);\n  model.locked = false;\n\n  const cascade = runloop.start();\n  this.extensions.forEach(e => {\n    const model = e._cssModel;\n    model.mark();\n    model.downstreamChanged('', 1);\n  });\n  runloop.end();\n\n  applyChanges(this, !opts || opts.apply !== false);\n\n  return promise.then(() => cascade);\n}\n\nexport function applyChanges(component, apply) {\n  const local = recomputeCSS(component);\n  const child = component.extensions\n    .map(e => applyChanges(e, false))\n    .reduce((a, c) => c || a, false);\n\n  if (apply && (local || child)) {\n    const def = component._cssDef;\n    if (!def || (def && def.applied)) applyCSS(true);\n  }\n\n  return local || child;\n}\n\nexport function recomputeCSS(component) {\n  const css = component.css;\n\n  if (!isFunction(css)) return;\n\n  const def = component._cssDef;\n  const result = evalCSS(component, css);\n  const styles = def.transform ? transformCSS(result, def.id) : result;\n\n  if (def.styles === styles) return;\n\n  def.styles = styles;\n\n  return true;\n}\n","import noop from 'utils/noop';\nimport { isFunction } from 'utils/is';\n\nexport default function wrap(parent, name, method) {\n  if (!/_super/.test(method)) return method;\n\n  function wrapper() {\n    const superMethod = getSuperMethod(wrapper._parent, name);\n    const hasSuper = '_super' in this;\n    const oldSuper = this._super;\n\n    this._super = superMethod;\n\n    const result = method.apply(this, arguments);\n\n    if (hasSuper) {\n      this._super = oldSuper;\n    } else {\n      delete this._super;\n    }\n\n    return result;\n  }\n\n  wrapper._parent = parent;\n  wrapper._method = method;\n\n  return wrapper;\n}\n\nfunction getSuperMethod(parent, name) {\n  if (name in parent) {\n    const value = parent[name];\n\n    return isFunction(value) ? value : () => value;\n  }\n\n  return noop;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage(deprecated, correct, isError) {\n  return (\n    `options.${deprecated} has been deprecated in favour of options.${correct}.` +\n    (isError ? ` You cannot specify both options, please use options.${correct}.` : '')\n  );\n}\n\nfunction deprecateOption(options, deprecatedOption, correct) {\n  if (deprecatedOption in options) {\n    if (!(correct in options)) {\n      warnIfDebug(getMessage(deprecatedOption, correct));\n      options[correct] = options[deprecatedOption];\n    } else {\n      throw new Error(getMessage(deprecatedOption, correct, true));\n    }\n  }\n}\n\nexport default function deprecate(options) {\n  deprecateOption(options, 'beforeInit', 'onconstruct');\n  deprecateOption(options, 'init', 'onrender');\n  deprecateOption(options, 'complete', 'oncomplete');\n  deprecateOption(options, 'eventDefinitions', 'events');\n\n  // Using extend with Component instead of options,\n  // like Human.extend( Spider ) means adaptors as a registry\n  // gets copied to options. So we have to check if actually an array\n  if (isArray(options.adaptors)) {\n    deprecateOption(options, 'adaptors', 'adapt');\n  }\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve(fragment, template) {\n  if (template.r) {\n    return resolveReference(fragment, template.r);\n  } else if (template.x) {\n    return new ExpressionProxy(fragment, template.x);\n  } else if (template.rx) {\n    return new ReferenceExpressionProxy(fragment, template.rx);\n  }\n}\n","export default function(camelCaseStr) {\n  return camelCaseStr.replace(/([A-Z])/g, (match, $1) => {\n    return '-' + $1.toLowerCase();\n  });\n}\n","import { create, toPairs } from 'utils/object';\nimport { isFunction, isObjectType } from 'utils/is';\n\nexport default function subscribe(instance, options, type) {\n  const subs = (instance.constructor[`_${type}`] || []).concat(toPairs(options[type] || []));\n  const single = type === 'on' ? 'once' : `${type}Once`;\n\n  subs.forEach(([target, config]) => {\n    if (isFunction(config)) {\n      instance[type](target, config);\n    } else if (isObjectType(config) && isFunction(config.handler)) {\n      instance[config.once ? single : type](target, config.handler, create(config));\n    }\n  });\n}\n","export default function() {}\n","export function findInViewHierarchy(registryName, ractive, name) {\n  const instance = findInstance(registryName, ractive, name);\n  return instance ? instance[registryName][name] : null;\n}\n\nexport function findInstance(registryName, ractive, name) {\n  while (ractive) {\n    if (name in ractive[registryName]) {\n      return ractive;\n    }\n\n    if (ractive.isolated) {\n      return null;\n    }\n\n    ractive = ractive.parent;\n  }\n}\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate(from, to, ractive, type) {\n  if (from === to) return null;\n\n  if (type) {\n    const interpol = findInViewHierarchy('interpolators', ractive, type);\n    if (interpol) return interpol(from, to) || null;\n\n    fatal(missingPlugin(type, 'interpolator'));\n  }\n\n  return (\n    interpolators.number(from, to) ||\n    interpolators.array(from, to) ||\n    interpolators.object(from, to) ||\n    null\n  );\n}\n","import { isArray, isString } from './is';\n\nexport function addToArray(array, value) {\n  const index = array.indexOf(value);\n\n  if (index === -1) {\n    array.push(value);\n  }\n}\n\nexport function arrayContains(array, value) {\n  for (let i = 0, c = array.length; i < c; i++) {\n    if (array[i] == value) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function arrayContentsMatch(a, b) {\n  let i;\n\n  if (!isArray(a) || !isArray(b)) {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  i = a.length;\n  while (i--) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function ensureArray(x) {\n  if (isString(x)) {\n    return [x];\n  }\n\n  if (x === undefined) {\n    return [];\n  }\n\n  return x;\n}\n\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n\nexport function removeFromArray(array, member) {\n  if (!array) {\n    return;\n  }\n\n  const index = array.indexOf(member);\n\n  if (index !== -1) {\n    array.splice(index, 1);\n  }\n}\n\nexport function combine(...arrays) {\n  const res = arrays.concat.apply([], arrays);\n  let i = res.length;\n  while (i--) {\n    const idx = res.indexOf(res[i]);\n    if (~idx && idx < i) res.splice(i, 1);\n  }\n\n  return res;\n}\n\nexport function toArray(arrayLike) {\n  const array = [];\n  let i = arrayLike.length;\n  while (i--) {\n    array[i] = arrayLike[i];\n  }\n\n  return array;\n}\n\nexport function findMap(array, fn) {\n  const len = array.length;\n  for (let i = 0; i < len; i++) {\n    const result = fn(array[i]);\n    if (result) return result;\n  }\n}\n\nexport function buildNewIndices(one, two, comparator) {\n  let oldArray = one;\n  let newArray = two;\n  if (comparator) {\n    oldArray = oldArray.map(comparator);\n    newArray = newArray.map(comparator);\n  }\n\n  const oldLength = oldArray.length;\n\n  const usedIndices = {};\n  let firstUnusedIndex = 0;\n\n  return oldArray.map(item => {\n    let index;\n    let start = firstUnusedIndex;\n\n    do {\n      index = newArray.indexOf(item, start);\n\n      if (index === -1) {\n        return -1;\n      }\n\n      start = index + 1;\n    } while (usedIndices[index] === true && start < oldLength);\n\n    // keep track of the first unused index, so we don't search\n    // the whole of newArray for each item in oldArray unnecessarily\n    if (index === firstUnusedIndex) {\n      firstUnusedIndex += 1;\n    }\n    // allow next instance of next \"equal\" to be found item\n    usedIndices[index] = true;\n    return index;\n  });\n}\n","export function bind(x) {\n  x.bind();\n}\nexport function cancel(x) {\n  x.cancel();\n}\nexport function destroyed(x) {\n  x.destroyed();\n}\nexport function handleChange(x) {\n  x.handleChange();\n}\nexport function mark(x) {\n  x.mark();\n}\nexport function markForce(x) {\n  x.mark(true);\n}\nexport function marked(x) {\n  x.marked();\n}\nexport function markedAll(x) {\n  x.markedAll();\n}\nexport function render(x) {\n  x.render();\n}\nexport function shuffled(x) {\n  x.shuffled();\n}\nexport function teardown(x) {\n  x.teardown();\n}\nexport function unbind(x) {\n  x.unbind();\n}\nexport function unrender(x) {\n  x.unrender();\n}\nexport function unrenderAndDestroy(x) {\n  x.unrender(true);\n}\nexport function update(x) {\n  x.update();\n}\nexport function toString(x) {\n  return x.toString();\n}\nexport function toEscapedString(x) {\n  return x.toString(true);\n}\n","import { splitKeypath } from './keypaths';\nimport { isString } from 'utils/is';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch(template, next, previous, fragment) {\n  const keypath = template.r || template;\n\n  // no valid keypath, go with next\n  if (!keypath || !isString(keypath)) return next;\n\n  // completely contextual ref, go with next\n  if (\n    keypath === '.' ||\n    keypath[0] === '@' ||\n    (next || previous).isKey ||\n    (next || previous).isKeypath\n  )\n    return next;\n\n  const parts = keypath.split('/');\n  let keys = splitKeypath(parts[parts.length - 1]);\n  const last = keys[keys.length - 1];\n\n  // check the keypath against the model keypath to see if it matches\n  let model = next || previous;\n\n  // check to see if this was an alias\n  if (model && keys.length === 1 && last !== model.key && fragment) {\n    keys = findAlias(last, fragment) || keys;\n  }\n\n  let i = keys.length;\n  let match = true;\n  let shuffling = false;\n\n  while (model && i--) {\n    if (model.shuffling) shuffling = true;\n    // non-strict comparison to account for indices in keypaths\n    if (keys[i] != model.key) match = false;\n    model = model.parent;\n  }\n\n  // next is undefined, but keypath is shuffling and previous matches\n  if (!next && match && shuffling) return previous;\n  else if (next && !match && shuffling)\n    // next is defined, but doesn't match the keypath\n    return previous;\n  else return next;\n}\n\nfunction findAlias(name, fragment) {\n  while (fragment) {\n    const z = fragment.aliases;\n    if (z && z[name]) {\n      const aliases = (fragment.owner.iterations ? fragment.owner : fragment).owner.template.z;\n      for (let i = 0; i < aliases.length; i++) {\n        if (aliases[i].n === name) {\n          const alias = aliases[i].x;\n          if (!alias.r) return false;\n          const parts = alias.r.split('/');\n          return splitKeypath(parts[parts.length - 1]);\n        }\n      }\n      return;\n    }\n\n    fragment = fragment.componentParent || fragment.parent;\n  }\n}\n","export function fromExpression(body, length = 0) {\n  const args = new Array(length);\n\n  while (length--) {\n    args[length] = `_${length}`;\n  }\n\n  // Functions created directly with new Function() look like this:\n  //     function anonymous (_0 /**/) { return _0*2 }\n  //\n  // With this workaround, we get a little more compact:\n  //     function (_0){return _0*2}\n  return new Function([], `return function (${args.join(',')}){return(${body});};`)();\n}\n","import { BOOLEAN_LITERAL } from '../../../../../config/types';\n\nexport default function readBooleanLiteral(parser) {\n  const remaining = parser.remaining();\n\n  if (remaining.substr(0, 4) === 'true') {\n    parser.pos += 4;\n    return {\n      t: BOOLEAN_LITERAL,\n      v: 'true'\n    };\n  }\n\n  if (remaining.substr(0, 5) === 'false') {\n    parser.pos += 5;\n    return {\n      t: BOOLEAN_LITERAL,\n      v: 'false'\n    };\n  }\n\n  return null;\n}\n","import { KEY_VALUE_PAIR, REFERENCE } from 'src/config/types';\nimport readKey from '../../../shared/readKey';\nimport readExpression from '../../../../readExpression';\nimport { name as namePattern, spreadPattern } from '../../../shared/patterns';\n\nexport default function readKeyValuePair(parser) {\n  let spread;\n  const start = parser.pos;\n\n  // allow whitespace between '{' and key\n  parser.sp();\n\n  const refKey = parser.nextChar() !== \"'\" && parser.nextChar() !== '\"';\n  if (refKey) spread = parser.matchPattern(spreadPattern);\n\n  const key = spread ? readExpression(parser) : readKey(parser);\n  if (key === null) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace between key and ':'\n  parser.sp();\n\n  // es2015 shorthand property\n  if (refKey && (parser.nextChar() === ',' || parser.nextChar() === '}')) {\n    if (!spread && !namePattern.test(key)) {\n      parser.error(`Expected a valid reference, but found '${key}' instead.`);\n    }\n\n    const pair = {\n      t: KEY_VALUE_PAIR,\n      k: key,\n      v: {\n        t: REFERENCE,\n        n: key\n      }\n    };\n\n    if (spread) {\n      pair.p = true;\n    }\n\n    return pair;\n  }\n\n  // next character must be ':'\n  if (!parser.matchString(':')) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace between ':' and value\n  parser.sp();\n\n  // next expression must be a, well... expression\n  const value = readExpression(parser);\n  if (value === null) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: KEY_VALUE_PAIR,\n    k: key,\n    v: value\n  };\n}\n","import getKeyValuePair from './keyValuePair';\n\nexport default function readKeyValuePairs(parser) {\n  const start = parser.pos;\n\n  const pair = getKeyValuePair(parser);\n  if (pair === null) {\n    return null;\n  }\n\n  const pairs = [pair];\n\n  if (parser.matchString(',')) {\n    const keyValuePairs = readKeyValuePairs(parser);\n\n    if (!keyValuePairs) {\n      parser.pos = start;\n      return null;\n    }\n\n    return pairs.concat(keyValuePairs);\n  }\n\n  return pairs;\n}\n","import { OBJECT_LITERAL } from '../../../../../config/types';\nimport readKeyValuePairs from './objectLiteral/keyValuePairs';\n\nexport default function(parser) {\n  const start = parser.pos;\n\n  // allow whitespace\n  parser.sp();\n\n  if (!parser.matchString('{')) {\n    parser.pos = start;\n    return null;\n  }\n\n  const keyValuePairs = readKeyValuePairs(parser);\n\n  // allow whitespace between final value and '}'\n  parser.sp();\n\n  if (!parser.matchString('}')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: OBJECT_LITERAL,\n    m: keyValuePairs\n  };\n}\n","import { ARRAY_LITERAL } from 'src/config/types';\nimport readExpressionList from '../../shared/readExpressionList';\n\nexport default function(parser) {\n  const start = parser.pos;\n\n  // allow whitespace before '['\n  parser.sp();\n\n  if (!parser.matchString('[')) {\n    parser.pos = start;\n    return null;\n  }\n\n  const expressionList = readExpressionList(parser, true);\n\n  if (!parser.matchString(']')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: ARRAY_LITERAL,\n    m: expressionList\n  };\n}\n","import readNumberLiteral from './literal/readNumberLiteral';\nimport readBooleanLiteral from './literal/readBooleanLiteral';\nimport readStringLiteral from './literal/readStringLiteral';\nimport readTemplateStringLiteral from './literal/readTemplateStringLiteral';\nimport readObjectLiteral from './literal/readObjectLiteral';\nimport readArrayLiteral from './literal/readArrayLiteral';\nimport readRegexpLiteral from './literal/readRegexpLiteral';\n\nexport default function readLiteral(parser) {\n  return (\n    readNumberLiteral(parser) ||\n    readBooleanLiteral(parser) ||\n    readStringLiteral(parser) ||\n    readTemplateStringLiteral(parser) ||\n    readObjectLiteral(parser) ||\n    readArrayLiteral(parser) ||\n    readRegexpLiteral(parser)\n  );\n}\n","import { BRACKETED } from 'src/config/types';\nimport { expectedExpression, expectedParen } from '../shared/errors';\nimport readExpression from '../../readExpression';\n\nexport default function readBracketedExpression(parser) {\n  if (!parser.matchString('(')) return null;\n\n  parser.sp();\n\n  const expr = readExpression(parser);\n\n  if (!expr) parser.error(expectedExpression);\n\n  parser.sp();\n\n  if (!parser.matchString(')')) parser.error(expectedParen);\n\n  return {\n    t: BRACKETED,\n    x: expr\n  };\n}\n","import readLiteral from './primary/readLiteral';\nimport readReference from './primary/readReference';\nimport readBracketedExpression from './primary/readBracketedExpression';\n\nexport default function(parser) {\n  return readLiteral(parser) || readReference(parser) || readBracketedExpression(parser);\n}\n","import { REFINEMENT } from 'config/types';\nimport { expectedExpression } from './errors';\nimport { name as namePattern } from './patterns';\nimport readExpression from '../../readExpression';\n\nexport default function readRefinement(parser) {\n  // some things call for strict refinement (partial names), meaning no space between reference and refinement\n  if (!parser.strictRefinement) {\n    parser.sp();\n  }\n\n  // \".\" name\n  if (parser.matchString('.')) {\n    parser.sp();\n\n    const name = parser.matchPattern(namePattern);\n    if (name) {\n      return {\n        t: REFINEMENT,\n        n: name\n      };\n    }\n\n    parser.error('Expected a property name');\n  }\n\n  // \"[\" expression \"]\"\n  if (parser.matchString('[')) {\n    parser.sp();\n\n    const expr = readExpression(parser);\n    if (!expr) parser.error(expectedExpression);\n\n    parser.sp();\n\n    if (!parser.matchString(']')) parser.error(`Expected ']'`);\n\n    return {\n      t: REFINEMENT,\n      x: expr\n    };\n  }\n\n  return null;\n}\n","import { MEMBER, INVOCATION } from 'config/types';\nimport readPrimary from './readPrimary';\nimport readExpressionList from './shared/readExpressionList';\nimport readRefinement from './shared/readRefinement';\nimport { expectedParen } from './shared/errors';\n\nexport default function(parser) {\n  let expression = readPrimary(parser);\n\n  if (!expression) return null;\n\n  while (expression) {\n    const refinement = readRefinement(parser);\n    if (refinement) {\n      expression = {\n        t: MEMBER,\n        x: expression,\n        r: refinement\n      };\n    } else if (parser.matchString('(')) {\n      parser.sp();\n      const expressionList = readExpressionList(parser, true);\n\n      parser.sp();\n\n      if (!parser.matchString(')')) {\n        parser.error(expectedParen);\n      }\n\n      expression = {\n        t: INVOCATION,\n        x: expression\n      };\n\n      if (expressionList) expression.o = expressionList;\n    } else {\n      break;\n    }\n  }\n\n  return expression;\n}\n","import { CONDITIONAL } from 'config/types';\nimport readLogicalOr from './readLogicalOr';\nimport { expectedExpression } from './shared/errors';\nimport readExpression from '../readExpression';\n\n// The conditional operator is the lowest precedence operator, so we start here\nexport default function getConditional(parser) {\n  const expression = readLogicalOr(parser);\n  if (!expression) {\n    return null;\n  }\n\n  const start = parser.pos;\n\n  parser.sp();\n\n  if (!parser.matchString('?')) {\n    parser.pos = start;\n    return expression;\n  }\n\n  parser.sp();\n\n  const ifTrue = readExpression(parser);\n  if (!ifTrue) {\n    parser.error(expectedExpression);\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(':')) {\n    parser.error('Expected \":\"');\n  }\n\n  parser.sp();\n\n  const ifFalse = readExpression(parser);\n  if (!ifFalse) {\n    parser.error(expectedExpression);\n  }\n\n  return {\n    t: CONDITIONAL,\n    o: [expression, ifTrue, ifFalse]\n  };\n}\n","import readConditional from './expressions/readConditional';\nimport readReference from './expressions/primary/readReference';\n\nexport default function readExpression(parser) {\n  // if eval is false, no expressions\n  if (parser.allowExpressions === false) {\n    const ref = readReference(parser);\n    parser.sp();\n    return ref;\n  }\n\n  // The conditional operator is the lowest precedence operator (except yield,\n  // assignment operators, and commas, none of which are supported), so we\n  // start there. If it doesn't match, it 'falls through' to progressively\n  // higher precedence operators, until it eventually matches (or fails to\n  // match) a 'primary' - a literal or a reference. This way, the abstract syntax\n  // tree has everything in its proper place, i.e. 2 + 3 * 4 === 14, not 20.\n  return readConditional(parser);\n}\n","import { expectedExpression } from './errors';\nimport readExpression from '../../readExpression';\nimport { spreadPattern } from './patterns';\n\nexport default function readExpressionList(parser, spread) {\n  let isSpread;\n  const expressions = [];\n\n  const pos = parser.pos;\n\n  do {\n    parser.sp();\n\n    if (spread) {\n      isSpread = parser.matchPattern(spreadPattern);\n    }\n\n    const expr = readExpression(parser);\n\n    if (expr === null && expressions.length) {\n      parser.error(expectedExpression);\n    } else if (expr === null) {\n      parser.pos = pos;\n      return null;\n    }\n\n    if (isSpread) {\n      expr.p = true;\n    }\n\n    expressions.push(expr);\n\n    parser.sp();\n  } while (parser.matchString(','));\n\n  return expressions;\n}\n","import { REFERENCE } from 'config/types';\nimport readExpression from './readExpression';\nimport readReference from './expressions/primary/readReference';\n\nexport default function readExpressionOrReference(parser, expectedFollowers) {\n  const start = parser.pos;\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    // valid reference but invalid expression e.g. `{{new}}`?\n    const ref = parser.matchPattern(/^(\\w+)/);\n    if (ref) {\n      return {\n        t: REFERENCE,\n        n: ref\n      };\n    }\n\n    return null;\n  }\n\n  for (let i = 0; i < expectedFollowers.length; i += 1) {\n    if (parser.remaining().substr(0, expectedFollowers[i].length) === expectedFollowers[i]) {\n      return expression;\n    }\n  }\n\n  parser.pos = start;\n  return readReference(parser);\n}\n","import {\n  REFERENCE,\n  BOOLEAN_LITERAL,\n  GLOBAL,\n  NUMBER_LITERAL,\n  REGEXP_LITERAL,\n  STRING_LITERAL,\n  ARRAY_LITERAL,\n  OBJECT_LITERAL,\n  KEY_VALUE_PAIR,\n  PREFIX_OPERATOR,\n  INFIX_OPERATOR,\n  INVOCATION,\n  BRACKETED,\n  MEMBER,\n  REFINEMENT,\n  CONDITIONAL\n} from 'config/types';\nimport { isObject, isString } from 'utils/is';\n\nexport default function flattenExpression(expression) {\n  let refs;\n  let count = 0;\n\n  extractRefs(expression, (refs = []));\n  const stringified = stringify(expression);\n\n  return {\n    r: refs,\n    s: getVars(stringified)\n  };\n\n  function getVars(expr) {\n    const vars = [];\n    for (let i = count - 1; i >= 0; i--) {\n      vars.push(`x$${i}`);\n    }\n    return vars.length ? `(function(){var ${vars.join(',')};return(${expr});})()` : expr;\n  }\n\n  function stringify(node) {\n    if (isString(node)) {\n      return node;\n    }\n\n    switch (node.t) {\n      case BOOLEAN_LITERAL:\n      case GLOBAL:\n      case NUMBER_LITERAL:\n      case REGEXP_LITERAL:\n        return node.v;\n\n      case STRING_LITERAL:\n        return JSON.stringify(String(node.v));\n\n      case ARRAY_LITERAL:\n        if (node.m && hasSpread(node.m)) {\n          return `[].concat(${makeSpread(node.m, '[', ']', stringify)})`;\n        } else {\n          return '[' + (node.m ? node.m.map(stringify).join(',') : '') + ']';\n        }\n\n      case OBJECT_LITERAL:\n        if (node.m && hasSpread(node.m)) {\n          return `Object.assign({},${makeSpread(node.m, '{', '}', stringifyPair)})`;\n        } else {\n          return '{' + (node.m ? node.m.map(n => `${n.k}:${stringify(n.v)}`).join(',') : '') + '}';\n        }\n\n      case PREFIX_OPERATOR:\n        return (node.s === 'typeof' ? 'typeof ' : node.s) + stringify(node.o);\n\n      case INFIX_OPERATOR:\n        return (\n          stringify(node.o[0]) +\n          (node.s.substr(0, 2) === 'in' ? ' ' + node.s + ' ' : node.s) +\n          stringify(node.o[1])\n        );\n\n      case INVOCATION:\n        if (node.o && hasSpread(node.o)) {\n          const id = count++;\n          return `(x$${id}=${stringify(node.x)}).apply(x$${id},${stringify({\n            t: ARRAY_LITERAL,\n            m: node.o\n          })})`;\n        } else {\n          return stringify(node.x) + '(' + (node.o ? node.o.map(stringify).join(',') : '') + ')';\n        }\n\n      case BRACKETED:\n        return '(' + stringify(node.x) + ')';\n\n      case MEMBER:\n        return stringify(node.x) + stringify(node.r);\n\n      case REFINEMENT:\n        return node.n ? '.' + node.n : '[' + stringify(node.x) + ']';\n\n      case CONDITIONAL:\n        return stringify(node.o[0]) + '?' + stringify(node.o[1]) + ':' + stringify(node.o[2]);\n\n      case REFERENCE:\n        return '_' + refs.indexOf(node.n);\n\n      default:\n        throw new Error('Expected legal JavaScript');\n    }\n  }\n\n  function stringifyPair(node) {\n    return node.p ? stringify(node.k) : `${node.k}:${stringify(node.v)}`;\n  }\n\n  function makeSpread(list, open, close, fn) {\n    const out = list.reduce(\n      (a, c) => {\n        if (c.p) {\n          a.str += `${a.open ? close + ',' : a.str.length ? ',' : ''}${fn(c)}`;\n        } else {\n          a.str += `${!a.str.length ? open : !a.open ? ',' + open : ','}${fn(c)}`;\n        }\n        a.open = !c.p;\n        return a;\n      },\n      { open: false, str: '' }\n    );\n    if (out.open) out.str += close;\n    return out.str;\n  }\n}\n\nfunction hasSpread(list) {\n  for (let i = 0; i < list.length; i++) {\n    if (list[i].p) return true;\n  }\n\n  return false;\n}\n\n// TODO maybe refactor this?\nfunction extractRefs(node, refs) {\n  if (node.t === REFERENCE && isString(node.n)) {\n    if (!~refs.indexOf(node.n)) {\n      refs.unshift(node.n);\n    }\n  }\n\n  const list = node.o || node.m;\n  if (list) {\n    if (isObject(list)) {\n      extractRefs(list, refs);\n    } else {\n      let i = list.length;\n      while (i--) {\n        extractRefs(list[i], refs);\n      }\n    }\n  }\n\n  if (node.k && node.t === KEY_VALUE_PAIR && !isString(node.k)) {\n    extractRefs(node.k, refs);\n  }\n\n  if (node.x) {\n    extractRefs(node.x, refs);\n  }\n\n  if (node.r) {\n    extractRefs(node.r, refs);\n  }\n\n  if (node.v) {\n    extractRefs(node.v, refs);\n  }\n}\n","import { REFERENCE, BRACKETED, MEMBER, REFINEMENT } from 'config/types';\nimport flattenExpression from './flattenExpression';\n\nexport default function refineExpression(expression, mustache) {\n  let referenceExpression;\n\n  if (expression) {\n    while (expression.t === BRACKETED && expression.x) {\n      expression = expression.x;\n    }\n\n    if (expression.t === REFERENCE) {\n      const n = expression.n;\n      if (!~n.indexOf('@context')) {\n        mustache.r = expression.n;\n      } else {\n        mustache.x = flattenExpression(expression);\n      }\n    } else {\n      if ((referenceExpression = getReferenceExpression(expression))) {\n        mustache.rx = referenceExpression;\n      } else {\n        mustache.x = flattenExpression(expression);\n      }\n    }\n\n    return mustache;\n  }\n}\n\n// TODO refactor this! it's bewildering\nfunction getReferenceExpression(expression) {\n  const members = [];\n  let refinement;\n\n  while (expression.t === MEMBER && expression.r.t === REFINEMENT) {\n    refinement = expression.r;\n\n    if (refinement.x) {\n      if (refinement.x.t === REFERENCE) {\n        members.unshift(refinement.x);\n      } else {\n        members.unshift(flattenExpression(refinement.x));\n      }\n    } else {\n      members.unshift(refinement.n);\n    }\n\n    expression = expression.x;\n  }\n\n  if (expression.t !== REFERENCE) {\n    return null;\n  }\n\n  return {\n    r: expression.n,\n    m: members\n  };\n}\n","import { TRIPLE } from 'config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readTriple(parser, tag) {\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    return null;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  const triple = { t: TRIPLE };\n  refineExpression(expression, triple); // TODO handle this differently - it's mysterious\n\n  return triple;\n}\n","import { TRIPLE } from 'config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readUnescaped(parser, tag) {\n  if (!parser.matchString('&')) {\n    return null;\n  }\n\n  parser.sp();\n\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    return null;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  const triple = { t: TRIPLE };\n  refineExpression(expression, triple); // TODO handle this differently - it's mysterious\n\n  return triple;\n}\n","import { PARTIAL, YIELDER } from 'src/config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { readAliases } from './readAliases';\n\nexport default function readPartial(parser, tag) {\n  const type = parser.matchString('>') || parser.matchString('yield');\n  const partial = { t: type === '>' ? PARTIAL : YIELDER };\n  let aliases;\n\n  if (!type) return null;\n\n  parser.sp();\n\n  if (type === '>' || !(aliases = parser.matchString('with'))) {\n    // Partial names can include hyphens, so we can't use readExpression\n    // blindly. Instead, we use the `relaxedNames` flag to indicate that\n    // `foo-bar` should be read as a single name, rather than 'subtract\n    // bar from foo'\n    parser.relaxedNames = parser.strictRefinement = true;\n    const expression = readExpression(parser);\n    parser.relaxedNames = parser.strictRefinement = false;\n\n    if (!expression && type === '>') return null;\n\n    if (expression) {\n      refineExpression(expression, partial); // TODO...\n      parser.sp();\n      if (type !== '>') aliases = parser.matchString('with');\n    }\n  }\n\n  parser.sp();\n\n  // check for alias context e.g. `{{>foo bar as bat, bip as bop}}`\n  if (aliases || type === '>') {\n    aliases = readAliases(parser);\n    if (aliases && aliases.length) {\n      partial.z = aliases;\n    } else if (type === '>') {\n      // otherwise check for literal context e.g. `{{>foo bar}}` then\n      // turn it into `{{#with bar}}{{>foo}}{{/with}}`\n      const context = readExpression(parser);\n      if (context) {\n        partial.c = {};\n        refineExpression(context, partial.c);\n      }\n    } else {\n      // {{yield with}} requires some aliases\n      parser.error(`Expected one or more aliases`);\n    }\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  return partial;\n}\n","import { COMMENT } from 'src/config/types';\n\nexport default function readComment(parser, tag) {\n  if (!parser.matchString('!')) {\n    return null;\n  }\n\n  const index = parser.remaining().indexOf(tag.close);\n\n  if (index !== -1) {\n    parser.pos += index + tag.close.length;\n    return { t: COMMENT };\n  }\n}\n","import { INTERPOLATOR } from 'config/types';\nimport readExpressionOrReference from '../readExpressionOrReference';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readInterpolator(parser, tag) {\n  let expression, err;\n\n  const start = parser.pos;\n\n  // TODO would be good for perf if we could do away with the try-catch\n  try {\n    expression = readExpressionOrReference(parser, [tag.close]);\n  } catch (e) {\n    err = e;\n  }\n\n  if (!expression) {\n    if (parser.str.charAt(start) === '!') {\n      // special case - comment\n      parser.pos = start;\n      return null;\n    }\n\n    if (err) {\n      throw err;\n    }\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}' after reference`);\n\n    if (!expression) {\n      // special case - comment\n      if (parser.nextChar() === '!') {\n        return null;\n      }\n\n      parser.error(`Expected expression or legal reference`);\n    }\n  }\n\n  const interpolator = { t: INTERPOLATOR };\n  refineExpression(expression, interpolator); // TODO handle this differently - it's mysterious\n\n  return interpolator;\n}\n","import { CLOSING } from 'config/types';\n\nexport default function readClosing(parser, tag) {\n  const start = parser.pos;\n\n  if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('/')) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  const remaining = parser.remaining();\n  const index = remaining.indexOf(tag.close);\n\n  if (index !== -1) {\n    const closing = {\n      t: CLOSING,\n      r: remaining.substr(0, index).split(' ')[0]\n    };\n\n    parser.pos += index;\n\n    if (!parser.matchString(tag.close)) {\n      parser.error(`Expected closing delimiter '${tag.close}'`);\n    }\n\n    return closing;\n  }\n\n  parser.pos = start;\n  return null;\n}\n","import { lastItem } from 'utils/array';\nimport { isString } from 'utils/is';\n\nexport default function(items, leadingPattern, trailingPattern) {\n  let item;\n\n  if (leadingPattern) {\n    item = items[0];\n    if (isString(item)) {\n      item = item.replace(leadingPattern, '');\n\n      if (!item) {\n        items.shift();\n      } else {\n        items[0] = item;\n      }\n    }\n  }\n\n  if (trailingPattern) {\n    item = lastItem(items);\n    if (isString(item)) {\n      item = item.replace(trailingPattern, '');\n\n      if (!item) {\n        items.pop();\n      } else {\n        items[items.length - 1] = item;\n      }\n    }\n  }\n}\n","import getLowestIndex from './utils/getLowestIndex';\nimport { decodeCharacterReferences } from 'utils/html';\n\nexport default function readText(parser) {\n  let index, disallowed, barrier;\n\n  const remaining = parser.remaining();\n\n  if (parser.textOnlyMode) {\n    disallowed = parser.tags.map(t => t.open);\n    disallowed = disallowed.concat(parser.tags.map(t => '\\\\' + t.open));\n\n    index = getLowestIndex(remaining, disallowed);\n  } else {\n    barrier = parser.inside ? '</' + parser.inside : '<';\n\n    if (parser.inside && !parser.interpolate[parser.inside]) {\n      index = remaining.indexOf(barrier);\n    } else {\n      disallowed = parser.tags.map(t => t.open);\n      disallowed = disallowed.concat(parser.tags.map(t => '\\\\' + t.open));\n\n      // http://developers.whatwg.org/syntax.html#syntax-attributes\n      if (parser.inAttribute === true) {\n        // we're inside an unquoted attribute value\n        disallowed.push(`\"`, `'`, `=`, `<`, `>`, '`');\n      } else if (parser.inAttribute) {\n        // quoted attribute value\n        disallowed.push(parser.inAttribute);\n      } else {\n        disallowed.push(barrier);\n      }\n\n      index = getLowestIndex(remaining, disallowed);\n    }\n  }\n\n  if (!index) {\n    return null;\n  }\n\n  if (index === -1) {\n    index = remaining.length;\n  }\n\n  parser.pos += index;\n\n  if ((parser.inside && parser.inside !== 'textarea') || parser.textOnlyMode) {\n    return remaining.substr(0, index);\n  } else {\n    return decodeCharacterReferences(remaining.substr(0, index));\n  }\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { READERS, PARTIAL_READERS } from 'parse/_parse';\nimport cleanup from 'parse/utils/cleanup';\nimport { create } from 'utils/object';\n\nexport default function readTemplate(parser) {\n  const fragment = [];\n  const partials = create(null);\n  let hasPartials = false;\n\n  const preserveWhitespace = parser.preserveWhitespace;\n\n  while (parser.pos < parser.str.length) {\n    const pos = parser.pos;\n    let item, partial;\n\n    if ((partial = parser.read(PARTIAL_READERS))) {\n      if (partials[partial.n]) {\n        parser.pos = pos;\n        parser.error('Duplicated partial definition');\n      }\n\n      cleanup(\n        partial.f,\n        parser.stripComments,\n        preserveWhitespace,\n        !preserveWhitespace,\n        !preserveWhitespace,\n        parser.whiteSpaceElements\n      );\n\n      partials[partial.n] = partial.f;\n      hasPartials = true;\n    } else if ((item = parser.read(READERS))) {\n      fragment.push(item);\n    } else {\n      parser.error('Unexpected template content');\n    }\n  }\n\n  const result = {\n    v: TEMPLATE_VERSION,\n    t: fragment\n  };\n\n  if (hasPartials) {\n    result.p = partials;\n  }\n\n  return result;\n}\n","import { fromExpression } from './createFunction';\nimport { isArray, isObject } from 'utils/is';\nimport { keys } from 'utils/object';\n\nexport default function insertExpressions(obj, expr) {\n  keys(obj).forEach(key => {\n    if (isExpression(key, obj)) return addTo(obj, expr);\n\n    const ref = obj[key];\n    if (hasChildren(ref)) insertExpressions(ref, expr);\n  });\n}\n\nfunction isExpression(key, obj) {\n  return key === 's' && isArray(obj.r);\n}\n\nfunction addTo(obj, expr) {\n  const { s, r } = obj;\n  if (!expr[s]) expr[s] = fromExpression(s, r.length);\n}\n\nfunction hasChildren(ref) {\n  return isArray(ref) || isObject(ref);\n}\n","import { fatal } from 'utils/log';\nimport bind from 'utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\nimport { isFunction, isString, isObjectType } from 'utils/is';\n\nexport default function getComputationSignature(ractive, key, signature) {\n  let getter;\n  let setter;\n\n  // useful for debugging\n  let getterString;\n  let getterUseStack;\n  let setterString;\n\n  if (isFunction(signature)) {\n    getter = bind(signature, ractive);\n    getterString = signature.toString();\n    getterUseStack = true;\n  }\n\n  if (isString(signature)) {\n    getter = createFunctionFromString(signature, ractive);\n    getterString = signature;\n  }\n\n  if (isObjectType(signature)) {\n    if (isString(signature.get)) {\n      getter = createFunctionFromString(signature.get, ractive);\n      getterString = signature.get;\n    } else if (isFunction(signature.get)) {\n      getter = bind(signature.get, ractive);\n      getterString = signature.get.toString();\n      getterUseStack = true;\n    } else {\n      fatal('`%s` computation must have a `get()` method', key);\n    }\n\n    if (isFunction(signature.set)) {\n      setter = bind(signature.set, ractive);\n      setterString = signature.set.toString();\n    }\n  }\n\n  return {\n    getter,\n    setter,\n    getterString,\n    setterString,\n    getterUseStack\n  };\n}\n"],"names":["this","iterations","length","value","toRemove","splice","isObject","wasArray","reset","oldKeys","i","fragment","key","this$1","push","newLength","isArray","keys","updateLast","forEach","unbind","unrender","bubbled","update","docFrag","rendered","createDocumentFragment","createIteration","render","indexRef","keyRef","refs","split","parentNode","parent","findParentNode","anchor","findNextNode","owner","insertBefore","updating","RepeatedFragment__proto__","lastModel","applyValue","updatePostShuffle","newIndices","pendingNewIndices","nextNode","slice","indices","newIndex","oldIndex","idx","dest","pos","next","len","context","get","prev","previousIterations","iters","stash","map","Array","e","nextRendered","firstNode","swizzleFragment","detach","isObjectType","f","shuffled","RepeatedFragment","prototype","getContext","Section","MustacheContainer","options","super","sectionType","template","n","templateSectionType","subordinate","l","Section__proto__","constructor","bind","sibling","up","items","indexOf","nextSibling","model","dirty","SECTION_UNLESS","isTruthy","Fragment","const","frag","detached","call","isRoot","undefined","SECTION_IF_WITH","isEmpty","rebind","previous","safe","SECTION_IF","target","occupants","shuffle","SECTION_EACH","shouldDestroy","siblingFalsey","lastType","getType","let","newFragment","fragmentShouldExist","SECTION_WITH","attach","bound","keep","runloop","promise","then","Select","Element","Select__proto__","foundNode","node","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selected","selectNode","toArray","o","setFromNode","selectValue","getAttribute","isMultiple","array","optionWasSelected","optionValue","_ractive","shouldSelect","valueContains","compare","forceUpdate","comparator","isFunction","Textarea","Input","deferContent","attributeByName","isBindable","attributes","createItem","t","ATTRIBUTE","cssIds","Textarea__proto__","bubble","scheduleTask","toString","Text","Item","type","TEXT","Text__proto__","detachNode","inAttributes","progressiveText","escape","escapeHtml","valueOf","proto","noop","visible","hidden","doc","prefix","vendors","vendor","addEventListener","onChange","onHide","onShow","win","isClient","prefixCache","testStyle","createElement","style","prop","name","hyphenateCamel","createTransitions","prefix$1","vendorPattern","RegExp","join","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","x","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","to","changedProperties","resolve","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","ractive","fire","isIntro","transitionEndHandler","event","index","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","hyphenate","easing","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","warnIfDebug","exec","interpolate","parseFloat","isString","warnOnceIfDebug","missingPlugin","Ticker","step","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","Transition","findElement","element","onComplete","Transition__proto__","animateStyle","arguments","Error","setStyle","fulfil","propertyNames","computedStyle","current","init","originals","targets","v","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","fn","values","resolveArgs","apply","props","styles","processParams","defaults","isNumber","assign","addToArray","hasOwn","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","nested","el","starting","start","completed","args","noReset","k","_manager","remove","concat","unbinding","removeFromArray","destroyed","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","Triple","Mustache","Triple__proto__","nodes","appendChild","find","selector","nodeType","matches","queryResult","querySelector","findAll","result","queryAllResult","querySelectorAll","findComponent","html","insertHtml","shift","outerHTML","nodeValue","removeChild","inAttribute","decodeCharacterReferences","detachWhenReady","constructors","ALIAS","Alias","ANCHOR","Component","AWAIT","Await","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","TRIPLE","YIELDER","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","COMMENT","Comment","specialElements","doctype","form","Form","input","option","Option","select","textarea","componentParent","component","delegate","containerFragment","dirtyValue","createItems","Fragment__proto__","addFragment","max","xs","findMap","findAllComponents","findContext","base","findParentWithContext","viewmodel","item","it","ELEMENT","skipParent","getKey","keyModel","KeyModel","getKeypath","root","rootModel","pathModel","getIndex","idxModel","resetTemplate","wasBound","wasRendered","toEscapedString","unrenderAndDestroy","addFragmentToRoot","source","processItems","_guid","parsed","parseJSON","HookQueue","hook","Hook","inProcess","queue","HookQueue__proto__","begin","end","getChildQueue","configHook","initHook","renderHook","completeHook","shouldRerender","resetHook","unrenderHook","reverse","makeArrayMethod","path","sort","unshift","add","animate","attachChild","compute","detachChild","findContainer","findParent","getNodeInfo","insert","link","observe","observeOnce","off","on","once","pop","readLink","resetPartial","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","unlink","updateModel","use","defineProperty","callsSuper","defineProperties","Ractive","sharedGet","sharedSet","styleGet","configurable","styleSet","addCSS","addStyle","hasCSS","hasStyle","opts","script","document","currentScript","warn","shared","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","evalObjectString","findPlugin","getCSS","isInstance","joinKeys","macro","normaliseKeypath","normalise","parse","splitKeypath","unescapeKey","enhance","svg","VERSION","adaptors","components","decorators","events","extensions","helpers","interpolators","partials","transitions","cssData","sharedData","Context","extern","CSSModel","registerTwowayBinding","BindingGroup__proto__","bindings","unregisterTwowayBinding","BindingGroup","Binding","CheckboxNameBinding","checkboxName","group","getBindingGroup","getValue","noInitialValue","existingValue","bindingValue","arrayContains","CheckboxNameBinding__proto__","getInitialValue","handleChange","isChecked","checked","lastValue","handleDomEvent","attachEvent","wasUndefined","valueSoFar","ContentEditableBinding","ContentEditableBinding__proto__","lazy","GenericBinding","GenericBinding__proto__","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","FileBinding__proto__","files","MultipleSelectBinding","MultipleSelectBinding__proto__","filter","selectedValues","attribute","previousValue","arrayContentsMatch","NumericBinding","NumericBinding__proto__","isNaN","siblings","RadioBinding","getSiblings","RadioBinding__proto__","RadioNameBinding","pathChanged","updateName","RadioNameBinding__proto__","lastVal","setting","SingleSelectBinding","SingleSelectBinding__proto__","locked","disabled","endsWithSemi","ContainerItem","toLowerCase","attrs","attr","val","cls","leftovers","m","DELEGATE_FLAG","ConditionalAttribute","Element__proto__","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","listeners","ls","ref","assigns","ctx","create","callback","capture","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","proxy","isOutro","registerTransition","children","childNodes","removeAttribute","setAttribute","stringifyAttribute","isSelected","inputIsCheckedRadio","safeAttributeString","getString","test","inlineClass","str","voidElementNames","UIEvent","formBindings","Form__proto__","handleReset","whitelist","animationend","animationiteration","animationstart","transitioncancel","transitionend","transitionstart","transitionrun","DOMEvent","fatal","DOMEvent__proto__","directive","original","CustomEvent","eventPlugin","CustomEvent__proto__","RactiveEvent","RactiveEvent__proto__","instance","cancel","specialPattern","dollarArgsPattern","EventDirective__proto__","COMPONENT","a","rs","r","resolveReference","getFunction","s","message","models","action","refire","specialRef","specialMatch","special","substr","dollarMatch","obj","which","wrapper","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","isStatic","Mustache__proto__","unreference","register","rebindMatch","unregister","addShuffleRegister","Object","Interpolator__proto__","safeToStringValue","string","data","Input__proto__","defaultValue","attrValue","specials","true","false","null","specialsPattern","numberPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","Parser","sp","postProcess","leftover","converters","parser","placeholder","matchPattern","number","stringLiteral","readStringLiteral","replace","match","$1","matchString","pair","getKeyValuePair","valueToken","read","Mapping","Mapping__proto__","joinKey","createMapping","boundFragment","Option__proto__","selectedAttribute","yielder","container","tx","refName","partialFromValue","partial","createFragment","initMacro","dirtyTemplate","externalChange","refreshAttrs","_attrs","handle","fnTemplate","getPartialTemplate","unbindAttrs","_cssDef","applied","applyCSS","aliases","dirtyAttrs","invalidate","extras","isReadonly","isKey","deps","links","KeyModel__proto__","shouldCapture","has","relinking","dependant","registerLink","unregisterLink","reference","findDelegate","z","ks","isIteration","iteration","getLast","merge","shouldRebind","newValues","dispatch","updateOld","baseModel","registerPatternObserver","PatternObserver__proto__","PatternObserver","unregisterPatternObserver","_observers","keypath","newValue","oldValue","oldValues","strict","isEqual","wildcards","pattern","notify","changed","touchedFrom","count","recursive","joinAll","isLink","ok","baseKeypath","findMatches","check","addObserver","defer","ArrayObserver","pending","sliced","ArrayObserver__proto__","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","adaptConfigurator","Parent","adapt","combine","ensureArray","selectorsPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","SharedModel","CSSModel__proto__","downstreamChanged","depth","_cssModel","mark","applyChanges","hasCurly","cssConfigurator","Child","_cssIds","gatherIds","css","initCSS","dataConfigurator","_r_unbound","templateConfigurator","parseTemplate","TEMPLATE_VERSION","getDynamicTemplate","_config","p","extendPartials","resetValue","registryNames","registriesOnDefaults","Registry","useDefaults","Registry__proto__","configure","registry","isOwner","registries","putInDefaults","config","order","c","custom","computed","defaultKeys","isStandardKey","makeObj","isBlacklisted","_super","Item__proto__","ContainerItem__proto__","ComputationChild","Model","syncComputedChildren","prototypeAccessors$1","setRoot","ComputationChild__proto__","dependencies","parentValue","newWrapperValue","unwrap","boundValue","marked","childByKey","child","Computation","signature","setter","prototypeAccessors$2","Computation__proto__","old","active","notifyUpstream","maybeBind","shouldBind","noVirtual","startCapturing","getter","hasConsole","console","groupCollapsed","sig","error","getterUseStack","stack","groupEnd","stopCapturing","setDependencies","ExpressionProxy","allowExpressions","ExpressionProxy__proto__","actuallyChanged","d","retrieve","dep","computation","ReferenceExpressionProxy","LinkModel","rootLink","members","Missing","addShuffleTask","tpl","REFERENCE","reduce","list","String","fireShuffleTasks","refreshPathDeps","ReferenceExpressionProxy__proto__","Alias__proto__","resolveAliases","space","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","div","ConditionalAttribute__proto__","isSvg","parseAttributes","notIn","updateDelegate","Attribute__proto__","booleanAttributes","namespaces","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","twowayBinding","flag","bubbler","BindingFlag__proto__","createComment","teardownHook","destructHook","RactiveModel","RactiveModel__proto__","initLink","specialModels","@this","getRactiveModel","@global","GlobalModel","@shared","@style","@helpers","getHelpers","RootModel","RootModel__proto__","attached","attachImplicits","createLink","targetPath","detachImplicits","virtual","getVirtual","SharedBase","ractiveModel","getValueChildren","_link","unescapedKey","shouldTeardown","constructHook","protoRegistries","uid","ComponentConstructor","isAnchor","content","_partials","addChild","construct","mappings","_inlinePartials","eventHandlers","Component__proto__","initialise","getRactiveContext","checking","checkAnchors","callRender","isolated","unrenderItem","missingDecorator","Decorator__proto__","warnOnce","teardownArgsFn","Doctype__proto__","parentForm","Binding__proto__","CheckboxBinding","CheckboxBinding__proto__","ModelBase__proto__","observer","patterns","updateFromBindings","cascade","oneway","findBoundValue","captureGroup","shufle","ModelBase","sourcePath","LinkModel__proto__","from","mapping","isDetached","force","markedAll","notifiedUpstream","startPath","relinked","shuffling","lnk","implicit","ln","functions","leadingWhitespace","ParseError","lineStart","lines","lineEnds","line","lineEnd","remaining","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","msg","character","shortMessage","substring","nextChar","charAt","readTypeOf","INVERTED","CLOSING","DELIMCHANGE","CLOSING_TAG","INLINE_PARTIAL","NUMBER_LITERAL","STRING_LITERAL","ARRAY_LITERAL","OBJECT_LITERAL","BOOLEAN_LITERAL","REGEXP_LITERAL","GLOBAL","KEY_VALUE_PAIR","REFINEMENT","MEMBER","PREFIX_OPERATOR","BRACKETED","CONDITIONAL","INFIX_OPERATOR","INVOCATION","ELSE","ELSEIF","THEN","CATCH","delimiterChangePattern","whitespacePattern","regexpPattern","regExpCache","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","expectedExpression","expectedParen","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","singleMatcher","makeQuotedStringMatcher","doubleMatcher","escapes","spreadPattern","legalReference","relaxedName","identifier","globals","keywords","prefixPattern","makePrefixSequenceMatcher","symbol","fallthrough","expression","readExpression","matcher","prefixOperators","readMemberOrInvocation","readLogicalOr","readTypeof","makeInfixSequenceMatcher","inUnquotedAttribute","left","right","infixOperators","readLogicalOr$1","attributeNamePattern","onPattern","eventPattern","reservedEventNames","decoratorPattern","transitionPattern","boundPattern","directives","no-delegation","unquotedAttributeValueTextPattern","proxyEvent","whitespace","slashes","delimiterChangeToken","exclude","legalAlias","asRE","else","elseif","catch","types","handlebarsBlockCodes","each","if","with","unless","indexRefPattern","keyIndexRefPattern","handlebarsBlockPattern","OPEN_COMMENT","CLOSE_COMMENT","leadingLinebreak","trailingLinebreak","contiguousWhitespace","trailingWhitespace","leadingNewLine","trailingNewLine","closingTagPattern","tagNamePattern","anchorPattern","validTagNameFollower","disallowedContents","li","dt","dd","rt","rp","optgroup","thead","tbody","tfoot","tr","td","th","inlines","partialDefinitionSectionPattern","STANDARD_READERS","readPartial","readUnescaped","readSection","readInterpolator","readMustacheComment","TRIPLE_READERS","readTriple","READERS","readMustache","readHtmlComment","readElement","readText","PARTIAL_READERS","readPartialDefinitionSection","preserveWhitespaceElements","pre","defaultInterpolate","StandardParser","tripleDelimiters","staticDelimiters","staticTripleDelimiters","standardDelimiters","delimiters","tags","isTriple","open","close","readers","sortMustacheTags","sectionDepth","elementStack","sanitize","elements","eventAttributes","stripComments","preserveWhitespace","sanitizeElements","sanitizeEventAttributes","includeLinePositions","textOnlyMode","csp","inTag","whiteSpaceElements","expr","flattenExpression","fromExpression","cleanup","insertExpressions","readTemplate","b","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","id","noThrow","getElementById","textContent","isParsed","getParseOptions","throwNoParse","addFunctions","parseFor","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","TransitionManager__proto__","decrementOutros","decrementTotal","detachNodes","_detachNodes","ready","detachImmediate","batch","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","thing","task","postRender","_batch","tickers","running","performance","now","requestAnimationFrame","tick","Ticker__proto__","elapsed","eased","stop","abort","prefixers","ticker","Model__proto__","rewrap","createBranch","adaptor","wrap","getPrefixer","__model","isObjectLike","getComputationSignature","branch","lastLink","markForce","buildNewIndices","recreateArray","unsafe","SharedModel__proto__","SharedModel$1","global","window","ContextModel","ContextModel__proto__","FakeFragment","star","deepOpts","comparators","errorMessage","initStars","bubbleStars","method","arg","attachHook","detachHook","arrayProto","updateHook","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","ContextData__proto__","prototypeAccessors","_data","Context__proto__","num","build","findModel","protoAnimate","getParent","hasListener","findEvent","there","here","listen","raise","ev","drop","unlisten","protoUpdate","isBound","getBindingModel","getBindingPath","getBinding","setBinding","forRactive","methodNames","unprefixed","prefixed","j","makeFunction","query","mathml","xlink","xml","xmlns","ns","createElementNS","methodName","cloneNode","insertHook","Observer","oldContext","oldFn","Observer__proto__","cancelled","resolver","handleAttributes","required","all","optional","mapAll","_attributePartial","meta","nameOption","renderItem","contains","lastBound","updateAnchors","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","nameAttr","currentTarget","endEl","correspondingUseElement","text","splitText","createTextNode","readKey","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","self","contextifyTemplate","okToParse","parsePartial","setTemplate","initing","aliasLocal","findFirstNode","out","frags","section","hasIndexRef","selectedOption","selectedIndex","firstChild","getComponentConstructor","asyncProxy","cmp","extract","success","undef","rx","ctor","guid","counter","placeholderId","newModel","hookQueue","childQueue","userOptions","subscribe","getElement","append","logIfDebug","cssId","__ractive_instances__","torndown","Ractive$render","others","Ractive$reset","rerender","changes","collect","collection","Ractive$resetTemplate","external","Ractive$set","Ractive$subtract","Ractive$toggle","TypeError","badArguments","gather","Ractive$toCSS","uniqueCssIds","ids","Ractive$toHTML","Ractive$transition","HTMLElement","Ractive$unrender","Ractive$updateModel","plugins","object","buildCSS","transform","recomputeCSS","extendOne","Class","Target","_on","toPairs","_observe","splitKeypathI","sourcesLength","sources","nextSource","nextKey","hasOwnProperty","thisArg","arrayLength","Node","nowOffset","Date","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","fulfill","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","promises","processPromise","reason","called","resolvePromise","y","rejectPromise","cancelAnimationFrame","lastTime","currentTime","timeToNextCall","Math","log","printWarning","welcome","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","noCssTransform","easeIn","pow","easeOut","easeInOut","implementation","hasFeature","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","intermediate","min","properties","loop","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","fnBind","Function","shuffleTasks","early","registerQueue","stage","existingMatches","objectKeys","badReference","shouldWarn","initialFragment","findIter","_fakeFragment","pairs","deep","deepSet","getComparator","sets","Ractive$add","immediate","getOptions","Ractive$animate","enqueue","_eventQueue","dequeue","variants","parts","eventNames","_nsSubs","fireEventAs","initialFire","_subs","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","findAnchors","findAnchorsIn","anchors","idxs","_children","byName","unrenderChild","prepend","insertAt","@this.parent","@this.root","last","Ractive$compute","comp","first","Ractive$detach","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","orComponent","getNewIndices","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","startIndex","mdl","Ractive$update","Ractive$fire","Ractive$get","instances","staticContext","staticInfo","output","Ractive$insert","fireInsertHook","src","isUpstream","fresh","vals","olds","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","subs","entry","Ractive$on","Ractive$once","listener","canonical","styleDefinition","styleSheet","cssText","filteredStyleDefinitions","getElementsByTagName","cleanCss","additionalReplaceRules","reconstruct","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","transformCss","dataAttr","selectors","s4","floor","random","uuid","setCSSData","local","def","evalCSS","transformCSS","__proto__","cssProp","validate","emptyData","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","parseAsString","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","member","RactiveProto","wrapPrototype","camelCaseStr","readStyle","rule","rules","readClass","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","wasChecked","valueAttribute","setProperty","getPropertyValue","className","baseVal","getAttributeNS","removeAttributeNS","setAttributeNS","haystack","needle","qualified","hasAttribute","Ractive$teardown","getPromise","single","initialiseProperties","getAdaptors","protoAdapt","lookup","srcs","isFinite","format","registryName","interpol","lastItem","arrays","arrayLike","one","two","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","upstream","isKeypath","findAlias","alias","body","createFunction","exp","readDelimiterChange","opening","closing","readNumberLiteral","escapeRegExp","getLowestIndex","needles","search","entity","code","parseInt","validateCode","readBooleanLiteral","okQuote","literal","done","charCodeAt","JSON","quote","escapeChar","readTemplateStringLiteral","token","namePattern","readKeyValuePair","spread","refKey","readKeyValuePairs","keyValuePairs","readObjectLiteral","readArrayLiteral","expressionList","readExpressionList","readLiteral","readRegexpLiteral","readReference","lastDotIndex","startPos","relaxedNames","actual","inEvent","lastIndexOf","refLength","readBracketedExpression","readPrimary","readRefinement","strictRefinement","refinement","getConditional","ifTrue","ifFalse","readConditional","isSpread","expressions","readExpressionOrReference","expectedFollowers","getVars","vars","stringify","hasSpread","makeSpread","stringifyPair","extractRefs","stringified","refineExpression","mustache","referenceExpression","getReferenceExpression","splitEvent","readAttribute","nearest","readAttributeValue","valueStart","startDepth","readQuotedAttributeValue","readUnquotedAttributeValue","readUnquotedAttributeValueToken","tokens","quoteMark","readQuotedStringToken","readAttributeOrDirective","readArguments","readProxyEvent","spreadArgs","inside","readMustacheOfType","tag","reader","rewind","triple","readAliases","readAlias","readComment","readClosing","readInlineBlock","nm","hasElse","block","unlessBlock","closed","expectedClose","hasThen","hasCatch","inlineThen","aliasOnly","extra","endIndex","comment","stripStandalones","backOne","backTwo","lastSectionItem","isComment","isSection","trimWhitespace","leadingPattern","trailingPattern","removeLeadingWhitespace","removeTrailingWhitespace","previousItem","nextItem","preserveWhitespaceInsideFragment","removeLeadingWhitespaceInsideFragment","removeTrailingWhitespaceInsideFragment","isPreserveWhitespaceElement","readClosingTag","selfClosing","hasPartials","closingTag","lowerCaseName","canContain","closingTagName","readAnchorClose","readInline","disallowed","barrier","isExpression","addTo","hasChildren","instructions","createFunctionFromString","bindTo","getterString","setterString","tm","notifiedTotal","manager","trans","collectAllOutros","_list","prefixKeypath","rootKeypath","rootDot","relativeKeypath","explicitContext","repeater"],"mappings":"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"}