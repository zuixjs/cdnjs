{"version":3,"file":"ractive.min.js","sources":["../src/view/RepeatedFragment.js","../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/config/visibility.js","../src/view/items/element/transitions/prefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/Fragment.js","../src/events/HookQueue.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/Ractive/static/styles.js","../src/extend/_extend.js","../src/Ractive.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/model/specials/KeyModel.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/model/specials/CSSModel.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/view/items/shared/Item.js","../src/model/ComputationChild.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/Alias.js","../src/view/helpers/specialAttrs.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/view/items/Comment.js","../src/Ractive/prototype/teardown.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/view/items/Component.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/model/ModelBase.js","../src/global/capture.js","../src/model/LinkModel.js","../src/shared/getFunction.js","../src/config/template.js","../src/parse/Parser.js","../src/config/types.js","../src/parse/converters/expressions/readTypeof.js","../src/parse/converters/mustache/readDelimiterChange.js","../src/parse/converters/expressions/primary/literal/readRegexpLiteral.js","../src/utils/escapeRegExp.js","../src/parse/converters/utils/getLowestIndex.js","../src/utils/html.js","../src/parse/converters/expressions/shared/errors.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readTemplateStringLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/parse/converters/expressions/primary/readReference.js","../src/parse/converters/expressions/readLogicalOr.js","../src/parse/converters/element/readAttribute.js","../src/parse/converters/readMustache.js","../src/parse/converters/mustache/readAliases.js","../src/parse/converters/mustache/section/readInlineBlock.js","../src/parse/converters/mustache/handlebarsBlockCodes.js","../src/parse/converters/mustache/readSection.js","../src/parse/converters/readHtmlComment.js","../src/parse/utils/stripStandalones.js","../src/parse/utils/cleanup.js","../src/parse/converters/element/readClosingTag.js","../src/parse/converters/readElement.js","../src/parse/converters/readPartialDefinitionSection.js","../src/Ractive/shared.js","../src/parse/_parse.js","../src/Ractive/config/runtime-parser.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/view/resolvers/resolveReference.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/Ractive/prototype/update.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/utils/dom.js","../src/config/namespaces.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/observe/Observer.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/view/items/shared/progressiveText.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/items/asyncProxy.js","../src/view/items/Await.js","../src/view/helpers/processItems.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/updateModel.js","../src/Ractive/prototype/use.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/styleGet.js","../src/Ractive/static/sharedSet.js","../src/Ractive/static/sharedGet.js","../src/Ractive/static/use.js","../src/extend/_macro.js","../src/Ractive/static/keypaths.js","../src/Ractive/static/findPlugin.js","../src/polyfills/Object.assign.js","../src/utils/object.js","../src/utils/is.js","../src/polyfills/performance.now.js","../src/polyfills/array.find.js","../src/polyfills/node.contains.js","../src/polyfills/Promise.js","../src/polyfills/requestAnimationFrame.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/config/environment.js","../src/config/errors.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/utils/bind.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/compute.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/view/items/shared/findElement.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/link.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/id.js","../src/Ractive/static/styleSet.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js","../src/utils/hyphenateCamel.js","../src/Ractive/helpers/subscribe.js","../src/utils/noop.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/parse/utils/createFunction.js","../src/parse/converters/expressions/primary/literal/readBooleanLiteral.js","../src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePair.js","../src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePairs.js","../src/parse/converters/expressions/primary/literal/readObjectLiteral.js","../src/parse/converters/expressions/primary/literal/readArrayLiteral.js","../src/parse/converters/expressions/primary/readLiteral.js","../src/parse/converters/expressions/primary/readBracketedExpression.js","../src/parse/converters/expressions/readPrimary.js","../src/parse/converters/expressions/shared/readRefinement.js","../src/parse/converters/expressions/readMemberOrInvocation.js","../src/parse/converters/expressions/readConditional.js","../src/parse/converters/readExpression.js","../src/parse/converters/expressions/shared/readExpressionList.js","../src/parse/converters/readExpressionOrReference.js","../src/parse/utils/flattenExpression.js","../src/parse/utils/refineExpression.js","../src/parse/converters/mustache/readTriple.js","../src/parse/converters/mustache/readUnescaped.js","../src/parse/converters/mustache/readPartial.js","../src/parse/converters/mustache/readMustacheComment.js","../src/parse/converters/mustache/readInterpolator.js","../src/parse/converters/mustache/section/readClosing.js","../src/parse/utils/trimWhitespace.js","../src/parse/converters/readText.js","../src/parse/converters/readTemplate.js","../src/parse/utils/insertExpressions.js","../src/Ractive/helpers/getComputationSignature.js"],"sourcesContent":["import { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectType } from 'utils/is';\nimport { findMap } from 'utils/array';\nimport {\n  toEscapedString,\n  toString,\n  destroyed,\n  shuffled,\n  unbind,\n  unrender,\n  unrenderAndDestroy,\n  update\n} from 'shared/methodCallers';\nimport Fragment from './Fragment';\nimport { ELEMENT } from 'config/types';\nimport { getContext } from 'shared/getRactiveContext';\nimport { keys } from 'utils/object';\nimport KeyModel from 'src/model/specials/KeyModel';\n\nexport default class RepeatedFragment {\n  constructor(options) {\n    this.parent = options.owner.up;\n\n    // bit of a hack, so reference resolution works without another\n    // layer of indirection\n    this.up = this;\n    this.owner = options.owner;\n    this.ractive = this.parent.ractive;\n    this.delegate =\n      this.ractive.delegate !== false && (this.parent.delegate || findDelegate(this.parent));\n    // delegation disabled by directive\n    if (this.delegate && this.delegate.delegate === false) this.delegate = false;\n    // let the element know it's a delegate handler\n    if (this.delegate) this.delegate.delegate = this.delegate;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    this.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n    this.context = null;\n    this.rendered = false;\n    this.iterations = [];\n\n    this.template = options.template;\n\n    this.indexRef = options.indexRef;\n    this.keyRef = options.keyRef;\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n\n    // track array versus object so updates of type rest\n    this.isArray = false;\n  }\n\n  bind(context) {\n    this.context = context;\n    this.bound = true;\n    const value = context.get();\n\n    this.aliases = this.owner.template.z && this.owner.template.z.slice();\n\n    // {{#each array}}...\n    if ((this.isArray = isArray(value))) {\n      // we can't use map, because of sparse arrays\n      this.iterations = [];\n      const max = (this.length = value.length);\n      for (let i = 0; i < max; i += 1) {\n        this.iterations[i] = this.createIteration(i, i);\n      }\n    } else if (isObject(value)) {\n      // {{#each object}}...\n      this.isArray = false;\n\n      // TODO this is a dreadful hack. There must be a neater way\n      if (this.indexRef) {\n        const refs = this.indexRef.split(',');\n        this.keyRef = refs[0];\n        this.indexRef = refs[1];\n      }\n\n      const ks = keys(value);\n      this.length = ks.length;\n\n      this.iterations = ks.map((key, index) => {\n        return this.createIteration(key, index);\n      });\n    }\n\n    return this;\n  }\n\n  bubble(index) {\n    if (!this.bubbled) this.bubbled = [];\n    this.bubbled.push(index);\n\n    this.owner.bubble();\n  }\n\n  createIteration(key, index) {\n    const fragment = new Fragment({\n      owner: this,\n      template: this.template\n    });\n\n    fragment.isIteration = true;\n    fragment.delegate = this.delegate;\n\n    if (this.aliases) fragment.aliases = {};\n    swizzleFragment(this, fragment, key, index);\n\n    return fragment.bind(fragment.context);\n  }\n\n  destroyed() {\n    this.iterations.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    this.iterations.forEach(fragment => docFrag.appendChild(fragment.detach()));\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.iterations, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    return this.iterations.forEach(i => i.findAll(selector, options));\n  }\n\n  findAllComponents(name, options) {\n    return this.iterations.forEach(i => i.findAllComponents(name, options));\n  }\n\n  findComponent(name, options) {\n    return findMap(this.iterations, i => i.findComponent(name, options));\n  }\n\n  findContext() {\n    return this.context;\n  }\n\n  findNextNode(iteration) {\n    if (iteration.index < this.iterations.length - 1) {\n      for (let i = iteration.index + 1; i < this.iterations.length; i++) {\n        const node = this.iterations[i].firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    return this.owner.findNextNode();\n  }\n\n  firstNode(skipParent) {\n    return this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  }\n\n  getLast() {\n    return this.lastModel || (this.lastModel = new KeyModel(this.length - 1));\n  }\n\n  rebind(next) {\n    this.context = next;\n    this.iterations.forEach(fragment => {\n      swizzleFragment(this, fragment, fragment.key, fragment.index);\n    });\n  }\n\n  render(target, occupants) {\n    const xs = this.iterations;\n    if (xs) {\n      const len = xs.length;\n      for (let i = 0; i < len; i++) {\n        xs[i].render(target, occupants);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  shuffle(newIndices, merge) {\n    if (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n    if (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n    this.pendingNewIndices.push(newIndices);\n\n    const iterations = [];\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      if (newIndex === -1) return;\n\n      const fragment = this.iterations[oldIndex];\n      iterations[newIndex] = fragment;\n\n      if (merge) fragment.shouldRebind = 1;\n\n      if (newIndex !== oldIndex && fragment) fragment.dirty = true;\n    });\n\n    this.iterations = iterations;\n\n    this.bubble();\n  }\n\n  shuffled() {\n    this.iterations.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.iterations ? this.iterations.map(escape ? toEscapedString : toString).join('') : '';\n  }\n\n  unbind() {\n    this.bound = false;\n    this.iterations.forEach(unbind);\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.iterations.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    if (this.pendingNewIndices && this.previousIterations) {\n      this.previousIterations.forEach(fragment => {\n        if (fragment.rendered) shouldDestroy ? unrenderAndDestroy(fragment) : unrender(fragment);\n      });\n    }\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.pendingNewIndices) {\n      this.bubbled.length = 0;\n      this.updatePostShuffle();\n      return;\n    }\n\n    if (this.updating) return;\n    this.updating = true;\n\n    this.iterations.forEach((f, i) => f && f.idxModel && f.idxModel.applyValue(i));\n\n    const value = this.context.get();\n    const wasArray = this.isArray;\n\n    let toRemove;\n    let oldKeys;\n    let reset = true;\n    let i;\n\n    if ((this.isArray = isArray(value))) {\n      if (wasArray) {\n        reset = false;\n        if (this.iterations.length > value.length) {\n          toRemove = this.iterations.splice(value.length);\n        }\n      }\n    } else if (isObject(value) && !wasArray) {\n      reset = false;\n      toRemove = [];\n      oldKeys = {};\n      i = this.iterations.length;\n\n      while (i--) {\n        const fragment = this.iterations[i];\n        if (fragment.key in value) {\n          oldKeys[fragment.key] = true;\n        } else {\n          this.iterations.splice(i, 1);\n          toRemove.push(fragment);\n        }\n      }\n    }\n\n    const newLength = isArray(value) ? value.length : isObject(value) ? keys(value).length : 0;\n    this.length = newLength;\n    this.updateLast();\n\n    if (reset) {\n      toRemove = this.iterations;\n      this.iterations = [];\n    }\n\n    if (toRemove) {\n      toRemove.forEach(fragment => {\n        fragment.unbind();\n        fragment.unrender(true);\n      });\n    }\n\n    // update the remaining ones\n    if (!reset && this.isArray && this.bubbled && this.bubbled.length) {\n      const bubbled = this.bubbled;\n      this.bubbled = [];\n      bubbled.forEach(i => this.iterations[i] && this.iterations[i].update());\n    } else {\n      this.iterations.forEach(update);\n    }\n\n    // add new iterations\n    let docFrag;\n    let fragment;\n\n    if (newLength > this.iterations.length) {\n      docFrag = this.rendered ? createDocumentFragment() : null;\n      i = this.iterations.length;\n\n      if (isArray(value)) {\n        while (i < value.length) {\n          fragment = this.createIteration(i, i);\n\n          this.iterations.push(fragment);\n          if (this.rendered) fragment.render(docFrag);\n\n          i += 1;\n        }\n      } else if (isObject(value)) {\n        // TODO this is a dreadful hack. There must be a neater way\n        if (this.indexRef && !this.keyRef) {\n          const refs = this.indexRef.split(',');\n          this.keyRef = refs[0];\n          this.indexRef = refs[1];\n        }\n\n        keys(value).forEach(key => {\n          if (!oldKeys || !(key in oldKeys)) {\n            fragment = this.createIteration(key, i);\n\n            this.iterations.push(fragment);\n            if (this.rendered) fragment.render(docFrag);\n\n            i += 1;\n          }\n        });\n      }\n\n      if (this.rendered) {\n        const parentNode = this.parent.findParentNode();\n        const anchor = this.parent.findNextNode(this.owner);\n\n        parentNode.insertBefore(docFrag, anchor);\n      }\n    }\n\n    this.updating = false;\n  }\n\n  updateLast() {\n    if (this.lastModel) this.lastModel.applyValue(this.length - 1);\n  }\n\n  updatePostShuffle() {\n    const newIndices = this.pendingNewIndices[0];\n    const parentNode = this.rendered ? this.parent.findParentNode() : null;\n    const nextNode = parentNode && this.owner.findNextNode();\n    const docFrag = parentNode ? createDocumentFragment() : null;\n\n    // map first shuffle through\n    this.pendingNewIndices.slice(1).forEach(indices => {\n      newIndices.forEach((newIndex, oldIndex) => {\n        newIndices[oldIndex] = indices[newIndex];\n      });\n    });\n\n    const len = (this.length = this.context.get().length);\n    const prev = this.previousIterations;\n    const iters = this.iterations;\n    const stash = {};\n    let idx, dest, pos, next, anchor;\n\n    const map = new Array(newIndices.length);\n    newIndices.forEach((e, i) => (map[e] = i));\n\n    this.updateLast();\n\n    idx = pos = 0;\n    while (idx < len) {\n      dest = newIndices[pos];\n      next = null;\n\n      if (dest === -1) {\n        // drop it like it's hot\n        prev[pos++].unbind().unrender(true);\n      } else if (dest > idx) {\n        // need to stash or pull one up\n        next = newIndices[pos + 1]; // TODO: maybe a shouldMove function that tracks multiple entries?\n        if (next <= dest) {\n          stash[dest] = prev[pos];\n          prev[pos++] = null;\n        } else {\n          next = stash[idx] || prev[map[idx]];\n          prev[map[idx]] = null;\n          anchor = prev[nextRendered(pos, newIndices, prev)];\n          anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n\n          if (next) {\n            swizzleFragment(this, next, idx, idx);\n            if (parentNode) parentNode.insertBefore(next.detach(), anchor);\n          } else {\n            next = iters[idx] = this.createIteration(idx, idx);\n            if (parentNode) {\n              next.render(docFrag);\n              parentNode.insertBefore(docFrag, anchor);\n            }\n          }\n\n          idx++;\n        }\n      } else {\n        // all is well\n        next = iters[idx];\n        anchor = prev[nextRendered(pos, newIndices, prev)];\n        anchor = (anchor && parentNode && anchor.firstNode()) || nextNode;\n        if (!next) {\n          next = iters[idx] = this.createIteration(idx, idx);\n          if (parentNode) {\n            next.render(docFrag);\n            parentNode.insertBefore(docFrag, anchor);\n          }\n        } else if (pos !== idx || stash[idx]) {\n          swizzleFragment(this, next, idx, idx);\n          if (stash[idx] && parentNode) parentNode.insertBefore(next.detach(), anchor);\n        }\n\n        idx++;\n        prev[pos++] = null;\n      }\n\n      if (next && isObjectType(next)) {\n        next.update();\n      }\n    }\n\n    // clean up any stragglers\n    prev.forEach(f => f && f.unbind().unrender(true));\n\n    this.pendingNewIndices = null;\n\n    this.shuffled();\n  }\n}\n\nRepeatedFragment.prototype.getContext = getContext;\n\n// find the topmost delegate\nfunction findDelegate(start) {\n  let frag = start;\n  let delegate, el;\n\n  out: while (frag) {\n    // find next element\n    el = 0;\n    while (!el && frag) {\n      if (frag.owner.type === ELEMENT) el = frag.owner;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n\n    if (el.delegate === false) break out;\n    delegate = el.delegate || el;\n\n    // find next repeated fragment\n    while (frag) {\n      if (frag.iterations) break;\n      if (frag.owner.ractive && frag.owner.ractive.delegate === false) break out;\n      frag = frag.parent || frag.componentParent;\n    }\n  }\n\n  return delegate;\n}\n\nfunction nextRendered(start, newIndices, frags) {\n  const len = newIndices.length;\n  for (let i = start; i < len; i++) {\n    if (~newIndices[i] && frags[i] && frags[i].rendered) return i;\n  }\n}\n\nfunction swizzleFragment(section, fragment, key, idx) {\n  const model = section.context ? section.context.joinKey(key) : undefined;\n\n  fragment.key = key;\n  fragment.index = idx;\n  fragment.context = model;\n\n  if (fragment.idxModel) fragment.idxModel.applyValue(idx);\n  if (fragment.keyModel) fragment.keyModel.applyValue(key);\n\n  // handle any aliases\n  const aliases = fragment.aliases;\n  section.aliases &&\n    section.aliases.forEach(a => {\n      if (a.x.r === '.') aliases[a.n] = model;\n      else if (a.x.r === '@index') aliases[a.n] = fragment.getIndex();\n      else if (a.x.r === '@key') aliases[a.n] = fragment.getKey();\n      else if (a.x.r === '@keypath') aliases[a.n] = fragment.getKeypath();\n      else if (a.x.r === '@rootpath') aliases[a.n] = fragment.getKeypath(true);\n    });\n}\n","import {\n  SECTION_EACH,\n  SECTION_IF,\n  SECTION_IF_WITH,\n  SECTION_UNLESS,\n  SECTION_WITH\n} from 'config/types';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectLike } from 'utils/is';\nimport { keep } from 'shared/set';\nimport runloop from 'src/global/runloop';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keys } from 'utils/object';\n\nfunction isEmpty(value) {\n  return (\n    !value ||\n    (isArray(value) && value.length === 0) ||\n    (isObject(value) && keys(value).length === 0)\n  );\n}\n\nfunction getType(value, hasIndexRef) {\n  if (hasIndexRef || isArray(value)) return SECTION_EACH;\n  if (isObjectLike(value)) return SECTION_IF_WITH;\n  if (value === undefined) return null;\n  return SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n  constructor(options) {\n    super(options);\n\n    this.sectionType = options.template.n || null;\n    this.templateSectionType = this.sectionType;\n    this.subordinate = options.template.l === 1;\n    this.fragment = null;\n  }\n\n  bind() {\n    super.bind();\n\n    if (this.subordinate) {\n      this.sibling = this.up.items[this.up.items.indexOf(this) - 1];\n      this.sibling.nextSibling = this;\n    }\n\n    // if we managed to bind, we need to create children\n    if (this.model) {\n      this.dirty = true;\n      this.update();\n    } else if (\n      this.sectionType &&\n      this.sectionType === SECTION_UNLESS &&\n      (!this.sibling || !this.sibling.isTruthy())\n    ) {\n      this.fragment = new Fragment({\n        owner: this,\n        template: this.template.f\n      }).bind();\n    }\n  }\n\n  detach() {\n    const frag = this.fragment || this.detached;\n    return frag ? frag.detach() : super.detach();\n  }\n\n  isTruthy() {\n    if (this.subordinate && this.sibling.isTruthy()) return true;\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    return !!value && (this.templateSectionType === SECTION_IF_WITH || !isEmpty(value));\n  }\n\n  rebind(next, previous, safe) {\n    if (super.rebind(next, previous, safe)) {\n      if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n        this.fragment.rebind(next);\n      }\n    }\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  shuffle(newIndices) {\n    if (this.fragment && this.sectionType === SECTION_EACH) {\n      this.fragment.shuffle(newIndices);\n    }\n  }\n\n  unbind() {\n    super.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (!this.dirty) return;\n\n    if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n      this.fragment.context = this.model;\n    }\n\n    if (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n    this.dirty = false;\n\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    const siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n    const lastType = this.sectionType;\n\n    // watch for switching section types\n    if (this.sectionType === null || this.templateSectionType === null)\n      this.sectionType = getType(value, this.template.i);\n    if (lastType && lastType !== this.sectionType && this.fragment) {\n      if (this.rendered) {\n        this.fragment.unbind().unrender(true);\n      }\n\n      this.fragment = null;\n    }\n\n    let newFragment;\n\n    const fragmentShouldExist =\n      this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n      this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n      (siblingFalsey && (this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy())); // if, unless, and if-with depend on siblings and the condition\n\n    if (fragmentShouldExist) {\n      if (!this.fragment) this.fragment = this.detached;\n\n      if (this.fragment) {\n        // check for detached fragment\n        if (this.detached) {\n          attach(this, this.fragment);\n          this.detached = false;\n          this.rendered = true;\n        }\n\n        if (!this.fragment.bound) this.fragment.bind(this.model);\n        this.fragment.update();\n      } else {\n        if (this.sectionType === SECTION_EACH) {\n          newFragment = new RepeatedFragment({\n            owner: this,\n            template: this.template.f,\n            indexRef: this.template.i\n          }).bind(this.model);\n        } else {\n          // only with and if-with provide context - if and unless do not\n          const context =\n            this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS\n              ? this.model\n              : null;\n          newFragment = new Fragment({\n            owner: this,\n            template: this.template.f\n          }).bind(context);\n        }\n      }\n    } else {\n      if (this.fragment && this.rendered) {\n        if (keep !== true) {\n          this.fragment.unbind().unrender(true);\n        } else {\n          this.unrender(false);\n          this.detached = this.fragment;\n          runloop.promise().then(() => {\n            if (this.detached) this.detach();\n          });\n        }\n      } else if (this.fragment) {\n        this.fragment.unbind();\n      }\n\n      this.fragment = null;\n    }\n\n    if (newFragment) {\n      if (this.rendered) {\n        attach(this, newFragment);\n      }\n\n      this.fragment = newFragment;\n    }\n\n    if (this.nextSibling) {\n      this.nextSibling.dirty = true;\n      this.nextSibling.update();\n    }\n  }\n}\n\nfunction attach(section, fragment) {\n  const anchor = section.up.findNextNode(section);\n\n  if (anchor) {\n    const docFrag = createDocumentFragment();\n    fragment.render(docFrag);\n\n    anchor.parentNode.insertBefore(docFrag, anchor);\n  } else {\n    fragment.render(section.up.findParentNode());\n  }\n}\n","import { toArray } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Element from '../../Element';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default class Select extends Element {\n  constructor(options) {\n    super(options);\n    this.options = [];\n  }\n\n  foundNode(node) {\n    if (this.binding) {\n      const selectedOptions = getSelectedOptions(node);\n\n      if (selectedOptions.length > 0) {\n        this.selectedOptions = selectedOptions;\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.sync();\n\n    const node = this.node;\n\n    let i = node.options.length;\n    while (i--) {\n      node.options[i].defaultSelected = node.options[i].selected;\n    }\n\n    this.rendered = true;\n  }\n\n  sync() {\n    const selectNode = this.node;\n\n    if (!selectNode) return;\n\n    const options = toArray(selectNode.options);\n\n    if (this.selectedOptions) {\n      options.forEach(o => {\n        if (this.selectedOptions.indexOf(o) >= 0) o.selected = true;\n        else o.selected = false;\n      });\n      this.binding.setFromNode(selectNode);\n      delete this.selectedOptions;\n      return;\n    }\n\n    const selectValue = this.getAttribute('value');\n    const isMultiple = this.getAttribute('multiple');\n    const array = isMultiple && isArray(selectValue);\n\n    // If the <select> has a specified value, that should override\n    // these options\n    if (selectValue !== undefined) {\n      let optionWasSelected;\n\n      options.forEach(o => {\n        const optionValue = o._ractive ? o._ractive.value : o.value;\n        const shouldSelect = isMultiple\n          ? array && this.valueContains(selectValue, optionValue)\n          : this.compare(selectValue, optionValue);\n\n        if (shouldSelect) {\n          optionWasSelected = true;\n        }\n\n        o.selected = shouldSelect;\n      });\n\n      if (!optionWasSelected && !isMultiple) {\n        if (this.binding) {\n          this.binding.forceUpdate();\n        }\n      }\n    } else if (this.binding && this.binding.forceUpdate) {\n      // Otherwise the value should be initialised according to which\n      // <option> element is selected, if twoway binding is in effect\n      this.binding.forceUpdate();\n    }\n  }\n  valueContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.compare(optionValue, selectValue[i])) return true;\n    }\n  }\n  compare(optionValue, selectValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(selectValue, optionValue);\n      }\n      if (selectValue && optionValue) {\n        return selectValue[comparator] == optionValue[comparator];\n      }\n    }\n    return selectValue == optionValue;\n  }\n  update() {\n    const dirty = this.dirty;\n    super.update();\n    if (dirty) {\n      this.sync();\n    }\n  }\n}\n","import { ATTRIBUTE } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n  constructor(options) {\n    const template = options.template;\n\n    options.deferContent = true;\n\n    super(options);\n\n    // check for single interpolator binding\n    if (!this.attributeByName.value) {\n      if (template.f && isBindable({ template })) {\n        (this.attributes || (this.attributes = [])).push(\n          createItem({\n            owner: this,\n            template: { t: ATTRIBUTE, f: template.f, n: 'value' },\n            up: this.up\n          })\n        );\n      } else {\n        this.fragment = new Fragment({\n          owner: this,\n          cssIds: null,\n          template: template.f\n        });\n      }\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.rendered && !this.binding && this.fragment) {\n        runloop.scheduleTask(() => {\n          this.dirty = false;\n          this.node.value = this.fragment.toString();\n        });\n      }\n\n      this.up.bubble(); // default behaviour\n    }\n  }\n}\n","import { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport { detachNode } from 'utils/dom';\nimport noop from 'utils/noop';\nimport Item from './shared/Item';\nimport progressiveText from './shared/progressiveText';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Text extends Item {\n  constructor(options) {\n    super(options);\n    this.type = TEXT;\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, this.template);\n  }\n\n  toString(escape) {\n    return escape ? escapeHtml(this.template) : this.template;\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  valueOf() {\n    return this.template;\n  }\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif (doc) {\n  let prefix;\n\n  /* istanbul ignore next */\n  if (hidden in doc) {\n    prefix = '';\n  } else {\n    let i = vendors.length;\n    while (i--) {\n      const vendor = vendors[i];\n      hidden = vendor + 'Hidden';\n\n      if (hidden in doc) {\n        prefix = vendor;\n        break;\n      }\n    }\n  }\n\n  /* istanbul ignore else */\n  if (prefix !== undefined) {\n    doc.addEventListener(prefix + 'visibilitychange', onChange);\n    onChange();\n  } else {\n    // gah, we're in an old browser\n    if ('onfocusout' in doc) {\n      doc.addEventListener('focusout', onHide);\n      doc.addEventListener('focusin', onShow);\n    } else {\n      win.addEventListener('pagehide', onHide);\n      win.addEventListener('blur', onHide);\n\n      win.addEventListener('pageshow', onShow);\n      win.addEventListener('focus', onShow);\n    }\n\n    visible = true; // until proven otherwise. Not ideal but hey\n  }\n}\n\nfunction onChange() {\n  visible = !doc[hidden];\n}\n\n/* istanbul ignore next */\nfunction onHide() {\n  visible = false;\n}\n\n/* istanbul ignore next */\nfunction onShow() {\n  visible = true;\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport hyphenateCamel from 'utils/hyphenateCamel';\n\nlet prefix;\n\n/* istanbul ignore next */\nif (!isClient) {\n  prefix = null;\n} else {\n  const prefixCache = {};\n  const testStyle = createElement('div').style;\n\n  // technically this also normalizes on hyphenated styles as well\n  prefix = function(prop) {\n    if (!prefixCache[prop]) {\n      const name = hyphenateCamel(prop);\n\n      if (testStyle[prop] !== undefined) {\n        prefixCache[prop] = name;\n      } else {\n        /* istanbul ignore next */\n        // test vendors...\n        let i = vendors.length;\n        while (i--) {\n          const vendor = `-${vendors[i]}-${name}`;\n          if (testStyle[vendor] !== undefined) {\n            prefixCache[prop] = vendor;\n            break;\n          }\n        }\n      }\n    }\n\n    return prefixCache[prop];\n  };\n}\n\nexport default prefix;\n","import { missingPlugin } from 'config/errors';\nimport { isClient } from 'config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport hyphenate from './hyphenate';\nimport { isFunction, isString } from 'utils/is';\n\nlet createTransitions;\n\nif (!isClient) {\n  createTransitions = null;\n} else {\n  const testStyle = createElement('div').style;\n  const linear = x => x;\n\n  const canUseCssTransitions = {};\n  const cannotUseCssTransitions = {};\n\n  // determine some facts about our environment\n  let TRANSITION;\n  let TRANSITIONEND;\n  let CSS_TRANSITIONS_ENABLED;\n  let TRANSITION_DURATION;\n  let TRANSITION_PROPERTY;\n  let TRANSITION_TIMING_FUNCTION;\n\n  if (testStyle.transition !== undefined) {\n    TRANSITION = 'transition';\n    TRANSITIONEND = 'transitionend';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else if (testStyle.webkitTransition !== undefined) {\n    TRANSITION = 'webkitTransition';\n    TRANSITIONEND = 'webkitTransitionEnd';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else {\n    CSS_TRANSITIONS_ENABLED = false;\n  }\n\n  if (TRANSITION) {\n    TRANSITION_DURATION = TRANSITION + 'Duration';\n    TRANSITION_PROPERTY = TRANSITION + 'Property';\n    TRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  }\n\n  createTransitions = function(t, to, options, changedProperties, resolve) {\n    // Wait a beat (otherwise the target styles will be applied immediately)\n    // TODO use a fastdom-style mechanism?\n    setTimeout(() => {\n      let jsTransitionsComplete;\n      let cssTransitionsComplete;\n      let cssTimeout; // eslint-disable-line prefer-const\n\n      function transitionDone() {\n        clearTimeout(cssTimeout);\n      }\n\n      function checkComplete() {\n        if (jsTransitionsComplete && cssTransitionsComplete) {\n          t.unregisterCompleteHandler(transitionDone);\n          // will changes to events and fire have an unexpected consequence here?\n          t.ractive.fire(t.name + ':end', t.node, t.isIntro);\n          resolve();\n        }\n      }\n\n      // this is used to keep track of which elements can use CSS to animate\n      // which properties\n      const hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n      // need to reset transition properties\n      const style = t.node.style;\n      const previous = {\n        property: style[TRANSITION_PROPERTY],\n        timing: style[TRANSITION_TIMING_FUNCTION],\n        duration: style[TRANSITION_DURATION]\n      };\n\n      function transitionEndHandler(event) {\n        const index = changedProperties.indexOf(event.propertyName);\n\n        if (index !== -1) {\n          changedProperties.splice(index, 1);\n        }\n\n        if (changedProperties.length) {\n          // still transitioning...\n          return;\n        }\n\n        clearTimeout(cssTimeout);\n        cssTransitionsDone();\n      }\n\n      function cssTransitionsDone() {\n        style[TRANSITION_PROPERTY] = previous.property;\n        style[TRANSITION_TIMING_FUNCTION] = previous.duration;\n        style[TRANSITION_DURATION] = previous.timing;\n\n        t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n        cssTransitionsComplete = true;\n        checkComplete();\n      }\n\n      t.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n      // safety net in case transitionend never fires\n      cssTimeout = setTimeout(() => {\n        changedProperties = [];\n        cssTransitionsDone();\n      }, options.duration + (options.delay || 0) + 50);\n      t.registerCompleteHandler(transitionDone);\n\n      style[TRANSITION_PROPERTY] = changedProperties.join(',');\n      const easingName = hyphenate(options.easing || 'linear');\n      style[TRANSITION_TIMING_FUNCTION] = easingName;\n      const cssTiming = style[TRANSITION_TIMING_FUNCTION] === easingName;\n      style[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n      setTimeout(() => {\n        let i = changedProperties.length;\n        let hash;\n        let originalValue = null;\n        let index;\n        const propertiesToTransitionInJs = [];\n        let prop;\n        let suffix;\n        let interpolator;\n\n        while (i--) {\n          prop = changedProperties[i];\n          hash = hashPrefix + prop;\n\n          if (cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n            const initial = style[prop];\n            style[prop] = to[prop];\n\n            // If we're not sure if CSS transitions are supported for\n            // this tag/property combo, find out now\n            if (!(hash in canUseCssTransitions)) {\n              originalValue = t.getStyle(prop);\n\n              // if this property is transitionable in this browser,\n              // the current style will be different from the target style\n              canUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n              cannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n              // Reset, if we're going to use timers after all\n              if (cannotUseCssTransitions[hash]) {\n                style[prop] = initial;\n              }\n            }\n          }\n\n          if (!cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n            // we need to fall back to timer-based stuff\n            if (originalValue === null) originalValue = t.getStyle(prop);\n\n            // need to remove this from changedProperties, otherwise transitionEndHandler\n            // will get confused\n            index = changedProperties.indexOf(prop);\n            if (index === -1) {\n              warnIfDebug(\n                'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!',\n                { node: t.node }\n              );\n            } else {\n              changedProperties.splice(index, 1);\n            }\n\n            // TODO Determine whether this property is animatable at all\n\n            suffix = /[^\\d]*$/.exec(originalValue)[0];\n            interpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop]));\n\n            // ...then kick off a timer-based transition\n            if (interpolator) {\n              propertiesToTransitionInJs.push({\n                name: prop,\n                interpolator,\n                suffix\n              });\n            } else {\n              style[prop] = to[prop];\n            }\n\n            originalValue = null;\n          }\n        }\n\n        // javascript transitions\n        if (propertiesToTransitionInJs.length) {\n          let easing;\n\n          if (isString(options.easing)) {\n            easing = t.ractive.easing[options.easing];\n\n            if (!easing) {\n              warnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n              easing = linear;\n            }\n          } else if (isFunction(options.easing)) {\n            easing = options.easing;\n          } else {\n            easing = linear;\n          }\n\n          new Ticker({\n            duration: options.duration,\n            easing,\n            step(pos) {\n              let i = propertiesToTransitionInJs.length;\n              while (i--) {\n                const prop = propertiesToTransitionInJs[i];\n                style[prop.name] = prop.interpolator(pos) + prop.suffix;\n              }\n            },\n            complete() {\n              jsTransitionsComplete = true;\n              checkComplete();\n            }\n          });\n        } else {\n          jsTransitionsComplete = true;\n        }\n\n        if (changedProperties.length) {\n          style[TRANSITION_PROPERTY] = changedProperties.join(',');\n        } else {\n          style[TRANSITION_PROPERTY] = 'none';\n\n          // We need to cancel the transitionEndHandler, and deal with\n          // the fact that it will never fire\n          t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n          cssTransitionsComplete = true;\n          checkComplete();\n        }\n      }, 0);\n    }, options.delay || 0);\n  };\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nconst vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\nexport default function(str) {\n  /* istanbul ignore next */\n  if (!str) return ''; // edge case\n\n  /* istanbul ignore next */\n  if (vendorPattern.test(str)) str = '-' + str;\n\n  return str.replace(/[A-Z]/g, match => '-' + match.toLowerCase());\n}\n","import { win } from 'config/environment';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction, isNumber, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { assign, hasOwn, keys } from 'utils/object';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n  t0: 'intro-outro',\n  t1: 'intro',\n  t2: 'outro'\n};\n\nexport default class Transition {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.ractive = this.owner.ractive;\n    this.template = options.template;\n    this.up = options.up;\n    this.options = options;\n    this.onComplete = [];\n  }\n\n  animateStyle(style, value, options) {\n    if (arguments.length === 4) {\n      throw new Error(\n        't.animateStyle() returns a promise - use .then() instead of passing a callback'\n      );\n    }\n\n    // Special case - page isn't visible. Don't animate anything, because\n    // that way you'll never get CSS transitionend events\n    if (!visible) {\n      this.setStyle(style, value);\n      return resolved;\n    }\n\n    let to;\n\n    if (isString(style)) {\n      to = {};\n      to[style] = value;\n    } else {\n      to = style;\n\n      // shuffle arguments\n      options = value;\n    }\n\n    return new Promise(fulfil => {\n      // Edge case - if duration is zero, set style synchronously and complete\n      if (!options.duration) {\n        this.setStyle(to);\n        fulfil();\n        return;\n      }\n\n      // Get a list of the properties we're animating\n      const propertyNames = keys(to);\n      const changedProperties = [];\n\n      // Store the current styles\n      const computedStyle = getComputedStyle(this.node);\n\n      let i = propertyNames.length;\n      while (i--) {\n        const prop = propertyNames[i];\n        const name = prefix(prop);\n\n        const current = computedStyle[prefix(prop)];\n\n        // record the starting points\n        const init = this.node.style[name];\n        if (!(name in this.originals)) this.originals[name] = this.node.style[name];\n        this.node.style[name] = to[prop];\n        this.targets[name] = this.node.style[name];\n        this.node.style[name] = init;\n\n        // we need to know if we're actually changing anything\n        if (current != to[prop]) {\n          // use != instead of !==, so we can compare strings with numbers\n          changedProperties.push(name);\n\n          // if we happened to prefix, make sure there is a properly prefixed value\n          to[name] = to[prop];\n\n          // make the computed style explicit, so we can animate where\n          // e.g. height='auto'\n          this.node.style[name] = current;\n        }\n      }\n\n      // If we're not actually changing anything, the transitionend event\n      // will never fire! So we complete early\n      if (!changedProperties.length) {\n        fulfil();\n        return;\n      }\n\n      createTransitions(this, to, options, changedProperties, fulfil);\n    });\n  }\n\n  bind() {\n    const options = this.options;\n    const type = options.template && options.template.v;\n    if (type) {\n      if (type === 't0' || type === 't1') this.element.intro = this;\n      if (type === 't0' || type === 't2') this.element.outro = this;\n      this.eventName = names[type];\n    }\n\n    const ractive = this.owner.ractive;\n\n    this.name = options.name || options.template.n;\n\n    if (options.params) {\n      this.params = options.params;\n    }\n\n    if (isFunction(this.name)) {\n      this._fn = this.name;\n      this.name = this._fn.name;\n    } else {\n      this._fn = findInViewHierarchy('transitions', ractive, this.name);\n    }\n\n    if (!this._fn) {\n      warnOnceIfDebug(missingPlugin(this.name, 'transition'), { ractive });\n    }\n\n    setupArgsFn(this, options.template);\n  }\n\n  getParams() {\n    if (this.params) return this.params;\n\n    // get expression args if supplied\n    if (this.fn) {\n      const values = resolveArgs(this, this.template, this.up).map(model => {\n        if (!model) return undefined;\n\n        return model.get();\n      });\n      return this.fn.apply(this.ractive, values);\n    }\n  }\n\n  getStyle(props) {\n    const computedStyle = getComputedStyle(this.node);\n\n    if (isString(props)) {\n      return computedStyle[prefix(props)];\n    }\n\n    if (!isArray(props)) {\n      throw new Error(\n        'Transition$getStyle must be passed a string, or an array of strings representing CSS properties'\n      );\n    }\n\n    const styles = {};\n\n    let i = props.length;\n    while (i--) {\n      const prop = props[i];\n      let value = computedStyle[prefix(prop)];\n\n      if (value === '0px') value = 0;\n      styles[prop] = value;\n    }\n\n    return styles;\n  }\n\n  processParams(params, defaults) {\n    if (isNumber(params)) {\n      params = { duration: params };\n    } else if (isString(params)) {\n      if (params === 'slow') {\n        params = { duration: 600 };\n      } else if (params === 'fast') {\n        params = { duration: 200 };\n      } else {\n        params = { duration: 400 };\n      }\n    } else if (!params) {\n      params = {};\n    }\n\n    return assign({}, defaults, params);\n  }\n\n  registerCompleteHandler(fn) {\n    addToArray(this.onComplete, fn);\n  }\n\n  setStyle(style, value) {\n    if (isString(style)) {\n      const name = prefix(style);\n      if (!hasOwn(this.originals, name)) this.originals[name] = this.node.style[name];\n      this.node.style[name] = value;\n      this.targets[name] = this.node.style[name];\n    } else {\n      let prop;\n      for (prop in style) {\n        if (hasOwn(style, prop)) {\n          this.setStyle(prop, style[prop]);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  shouldFire(type) {\n    if (!this.ractive.transitionsEnabled) return false;\n\n    // check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n    if (type === 'intro' && this.ractive.rendering && nearestProp('noIntro', this.ractive, true))\n      return false;\n    if (type === 'outro' && this.ractive.unrendering && nearestProp('noOutro', this.ractive, false))\n      return false;\n\n    const params = this.getParams(); // this is an array, the params object should be the first member\n    // if there's not a parent element, this can't be nested, so roll on\n    if (!this.element.parent) return true;\n\n    // if there is a local param, it takes precedent\n    if (params && params[0] && isObject(params[0]) && 'nested' in params[0]) {\n      if (params[0].nested !== false) return true;\n    } else {\n      // use the nearest instance setting\n      // find the nearest instance that actually has a nested setting\n      if (nearestProp('nestedTransitions', this.ractive) !== false) return true;\n    }\n\n    // check to see if this is actually a nested transition\n    let el = this.element.parent;\n    while (el) {\n      if (el[type] && el[type].starting) return false;\n      el = el.parent;\n    }\n\n    return true;\n  }\n\n  start() {\n    const node = (this.node = this.element.node);\n    const originals = (this.originals = {}); //= node.getAttribute( 'style' );\n    const targets = (this.targets = {});\n\n    let completed;\n    const args = this.getParams();\n\n    // create t.complete() - we don't want this on the prototype,\n    // because we don't want `this` silliness when passing it as\n    // an argument\n    this.complete = noReset => {\n      this.starting = false;\n      if (completed) {\n        return;\n      }\n\n      this.onComplete.forEach(fn => fn());\n      if (!noReset && this.isIntro) {\n        for (const k in targets) {\n          if (node.style[k] === targets[k]) node.style[k] = originals[k];\n        }\n      }\n\n      this._manager.remove(this);\n\n      completed = true;\n    };\n\n    // If the transition function doesn't exist, abort\n    if (!this._fn) {\n      this.complete();\n      return;\n    }\n\n    const promise = this._fn.apply(this.ractive, [this].concat(args));\n    if (promise) promise.then(this.complete);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (!this.element.attributes.unbinding) {\n      const type = this.options && this.options.template && this.options.template.v;\n      if (type === 't0' || type === 't1') this.element.intro = null;\n      if (type === 't0' || type === 't2') this.element.outro = null;\n    }\n  }\n\n  unregisterCompleteHandler(fn) {\n    removeFromArray(this.onComplete, fn);\n  }\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp(prop, ractive, rendering) {\n  let instance = ractive;\n  while (instance) {\n    if (\n      hasOwn(instance, prop) &&\n      (rendering === undefined || rendering ? instance.rendering : instance.unrendering)\n    )\n      return instance[prop];\n    instance = instance.component && instance.component.ractive;\n  }\n\n  return ractive[prop];\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n  createElement('table').innerHTML = 'foo';\n} catch (/* istanbul ignore next */ err) {\n  ieBug = true;\n\n  ieBlacklist = {\n    TABLE: ['<table class=\"x\">', '</table>'],\n    THEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n    TBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n    TR: ['<table><tr class=\"x\">', '</tr></table>'],\n    SELECT: ['<select class=\"x\">', '</select>']\n  };\n}\n\nexport default function(html, node) {\n  const nodes = [];\n\n  // render 0 and false\n  if (html == null || html === '') return nodes;\n\n  let container;\n  let wrapper;\n  let selectedOption;\n\n  /* istanbul ignore if */\n  if (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n    container = element('DIV');\n    container.innerHTML = wrapper[0] + html + wrapper[1];\n    container = container.querySelector('.x');\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  } else if (node.namespaceURI === svg) {\n    container = element('DIV');\n    container.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n    container = container.querySelector('.x');\n  } else if (node.tagName === 'TEXTAREA') {\n    container = createElement('div');\n\n    if (typeof container.textContent !== 'undefined') {\n      container.textContent = html;\n    } else {\n      container.innerHTML = html;\n    }\n  } else {\n    container = element(node.tagName);\n    container.innerHTML = html;\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  }\n\n  let child;\n  while ((child = container.firstChild)) {\n    nodes.push(child);\n    container.removeChild(child);\n  }\n\n  // This is really annoying. Extracting <option> nodes from the\n  // temporary container <select> causes the remaining ones to\n  // become selected. So now we have to deselect them. IE8, you\n  // amaze me. You really do\n  // ...and now Chrome too\n  let i;\n  if (node.tagName === 'SELECT') {\n    i = nodes.length;\n    while (i--) {\n      if (nodes[i] !== selectedOption) {\n        nodes[i].selected = false;\n      }\n    }\n  }\n\n  return nodes;\n}\n\nfunction element(tagName) {\n  return elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n}\n","import { createDocumentFragment, matches } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport { decodeCharacterReferences } from 'utils/html';\nimport runloop from 'src/global/runloop';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    if (this.nodes) this.nodes.forEach(node => docFrag.appendChild(node));\n    return docFrag;\n  }\n\n  find(selector) {\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) return node;\n\n      const queryResult = node.querySelector(selector);\n      if (queryResult) return queryResult;\n    }\n\n    return null;\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) result.push(node);\n\n      const queryAllResult = node.querySelectorAll(selector);\n      if (queryAllResult) {\n        result.push.apply(result, queryAllResult);\n      }\n    }\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  firstNode() {\n    return this.rendered && this.nodes[0];\n  }\n\n  render(target, occupants, anchor) {\n    if (!this.nodes) {\n      const html = this.model ? this.model.get() : '';\n      this.nodes = insertHtml(html, target);\n    }\n\n    let nodes = this.nodes;\n\n    // progressive enhancement\n    if (occupants) {\n      let i = -1;\n      let next;\n\n      // start with the first node that should be rendered\n      while (occupants.length && (next = this.nodes[i + 1])) {\n        let n;\n        // look through the occupants until a matching node is found\n        while ((n = occupants.shift())) {\n          const t = n.nodeType;\n\n          if (\n            t === next.nodeType &&\n            ((t === 1 && n.outerHTML === next.outerHTML) ||\n              ((t === 3 || t === 8) && n.nodeValue === next.nodeValue))\n          ) {\n            this.nodes.splice(++i, 1, n); // replace the generated node with the existing one\n            break;\n          } else {\n            target.removeChild(n); // remove the non-matching existing node\n          }\n        }\n      }\n\n      if (i >= 0) {\n        // update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n        nodes = this.nodes.slice(i);\n      }\n\n      // update the anchor to be the next occupant\n      if (occupants.length) anchor = occupants[0];\n    }\n\n    // attach any remainging nodes to the parent\n    if (nodes.length) {\n      const frag = createDocumentFragment();\n      nodes.forEach(n => frag.appendChild(n));\n\n      if (anchor) {\n        target.insertBefore(frag, anchor);\n      } else {\n        target.appendChild(frag);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    let value = this.model && this.model.get();\n    value = value != null ? '' + value : '';\n\n    return inAttribute() ? decodeCharacterReferences(value) : value;\n  }\n\n  unrender() {\n    if (this.nodes)\n      this.nodes.forEach(node => {\n        // defer detachment until all relevant outros are done\n        runloop.detachWhenReady({\n          node,\n          detach() {\n            detachNode(node);\n          }\n        });\n      });\n    this.rendered = false;\n    this.nodes = null;\n  }\n\n  update() {\n    if (this.rendered && this.dirty) {\n      this.dirty = false;\n\n      this.unrender();\n      this.render(this.up.findParentNode(), null, this.up.findNextNode(this));\n    } else {\n      // make sure to reset the dirty flag even if not rendered\n      this.dirty = false;\n    }\n  }\n}\n","import {\n  ALIAS,\n  ANCHOR,\n  AWAIT,\n  COMMENT,\n  COMPONENT,\n  DOCTYPE,\n  ELEMENT,\n  INTERPOLATOR,\n  PARTIAL,\n  SECTION,\n  TRIPLE,\n  YIELDER\n} from 'config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from 'config/types';\nimport Alias from './Alias';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Comment from './Comment';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\nimport { findInstance } from 'shared/registry';\nimport asyncProxy from './asyncProxy';\nimport Await from './Await';\nimport { isString, isFunction } from 'utils/is';\n\nconst constructors = {};\nconstructors[ALIAS] = Alias;\nconstructors[ANCHOR] = Component;\nconstructors[AWAIT] = Await;\nconstructors[DOCTYPE] = Doctype;\nconstructors[INTERPOLATOR] = Interpolator;\nconstructors[PARTIAL] = Partial;\nconstructors[SECTION] = Section;\nconstructors[TRIPLE] = Triple;\nconstructors[YIELDER] = Partial;\n\nconstructors[ATTRIBUTE] = Attribute;\nconstructors[BINDING_FLAG] = BindingFlag;\nconstructors[DECORATOR] = Decorator;\nconstructors[EVENT] = EventDirective;\nconstructors[TRANSITION] = Transition;\nconstructors[COMMENT] = Comment;\n\nconst specialElements = {\n  doctype: Doctype,\n  form: Form,\n  input: Input,\n  option: Option,\n  select: Select,\n  textarea: Textarea\n};\n\nexport default function createItem(options) {\n  if (isString(options.template)) {\n    return new Text(options);\n  }\n\n  let ctor;\n  let name;\n  const type = options.template.t;\n\n  if (type === ELEMENT) {\n    name = options.template.e;\n\n    // could be a macro partial\n    ctor = findInstance('partials', options.up.ractive, name);\n    if (ctor) {\n      ctor = ctor.partials[name];\n      if (ctor.styleSet) {\n        options.macro = ctor;\n        return new Partial(options);\n      }\n    }\n\n    // could be component or element\n    ctor = getComponentConstructor(options.up.ractive, name);\n    if (ctor) {\n      if (isFunction(ctor.then)) {\n        return asyncProxy(ctor, options);\n      } else {\n        return new Component(options, ctor);\n      }\n    }\n\n    ctor = specialElements[name.toLowerCase()] || Element;\n    return new ctor(options);\n  }\n\n  let Item;\n\n  // component mappings are a special case of attribute\n  if (type === ATTRIBUTE) {\n    let el = options.owner;\n    if (!el || (el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT)) {\n      el = findElement(options.up);\n    }\n    options.element = el;\n\n    Item = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n  } else {\n    Item = constructors[type];\n  }\n\n  if (!Item) throw new Error(`Unrecognised item type ${type}`);\n\n  return new Item(options);\n}\n","import { ELEMENT, YIELDER } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport { findMap } from 'utils/array';\nimport { getContext, findParentWithContext } from 'shared/getRactiveContext';\nimport {\n  bind,\n  destroyed,\n  shuffled,\n  toEscapedString,\n  toString,\n  unbind,\n  unrender,\n  update\n} from 'shared/methodCallers';\nimport createItem from './items/createItem';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\nimport KeyModel from 'src/model/specials/KeyModel';\n\nfunction unrenderAndDestroy(item) {\n  item.unrender(true);\n}\n\nexport default class Fragment {\n  constructor(options) {\n    this.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n    this.isRoot = !options.owner.up;\n    this.parent = this.isRoot ? null : this.owner.up;\n    this.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n    this.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.up : null;\n    if (!this.isRoot || this.ractive.delegate) {\n      this.delegate = this.owner.containerFragment\n        ? this.owner.containerFragment && this.owner.containerFragment.delegate\n        : (this.componentParent && this.componentParent.delegate) ||\n          (this.parent && this.parent.delegate);\n    } else {\n      this.delegate = false;\n    }\n\n    this.context = null;\n    this.rendered = false;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    if ('cssIds' in options) {\n      this.cssIds = options.cssIds && options.cssIds.length && options.cssIds;\n    } else {\n      this.cssIds = this.parent ? this.parent.cssIds : null;\n    }\n\n    this.dirty = false;\n    this.dirtyValue = true; // used for attribute values\n\n    this.template = options.template || [];\n    this.createItems();\n  }\n\n  bind(context) {\n    this.context = context;\n    this.items.forEach(bind);\n    this.bound = true;\n\n    // in rare cases, a forced resolution (or similar) will cause the\n    // fragment to be dirty before it's even finished binding. In those\n    // cases we update immediately\n    if (this.dirty) this.update();\n\n    return this;\n  }\n\n  bubble() {\n    this.dirtyValue = true;\n\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.isRoot) {\n        // TODO encapsulate 'is component root, but not overall root' check?\n        if (this.ractive.component) {\n          this.ractive.component.bubble();\n        } else if (this.bound) {\n          runloop.addFragment(this);\n        }\n      } else {\n        this.owner.bubble(this.index);\n      }\n    }\n  }\n\n  createItems() {\n    // this is a hot code path\n    const max = this.template.length;\n    this.items = [];\n    for (let i = 0; i < max; i++) {\n      this.items[i] = createItem({\n        up: this,\n        template: this.template[i],\n        index: i\n      });\n    }\n  }\n\n  destroyed() {\n    this.items.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      docFrag.appendChild(xs[i].detach());\n    }\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.items, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAll && i.findAll(selector, options));\n    }\n  }\n\n  findComponent(name, options) {\n    return findMap(this.items, i => i.findComponent(name, options));\n  }\n\n  findAllComponents(name, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAllComponents && i.findAllComponents(name, options));\n    }\n  }\n\n  findContext() {\n    const base = findParentWithContext(this);\n    if (!base || !base.context) return this.ractive.viewmodel;\n    else return base.context;\n  }\n\n  findNextNode(item) {\n    // search for the next node going forward\n    if (item) {\n      let it;\n      for (let i = item.index + 1; i < this.items.length; i++) {\n        it = this.items[i];\n        if (!it || !it.firstNode) continue;\n\n        const node = it.firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    // if this is the root fragment, and there are no more items,\n    // it means we're at the end...\n    if (this.isRoot) {\n      if (this.ractive.component) {\n        return this.ractive.component.up.findNextNode(this.ractive.component);\n      }\n\n      // TODO possible edge case with other content\n      // appended to this.ractive.el?\n      return null;\n    }\n\n    if (this.parent) return this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  }\n\n  findParentNode() {\n    let fragment = this;\n\n    do {\n      if (fragment.owner.type === ELEMENT) {\n        return fragment.owner.node;\n      }\n\n      if (fragment.isRoot && !fragment.ractive.component) {\n        // TODO encapsulate check\n        return fragment.ractive.el;\n      }\n\n      if (fragment.owner.type === YIELDER) {\n        fragment = fragment.owner.containerFragment;\n      } else {\n        fragment = fragment.componentParent || fragment.parent; // TODO ugh\n      }\n    } while (fragment);\n\n    throw new Error('Could not find parent node'); // TODO link to issue tracker\n  }\n\n  firstNode(skipParent) {\n    const node = findMap(this.items, i => i.firstNode(true));\n    if (node) return node;\n    if (skipParent) return null;\n\n    return this.parent.findNextNode(this.owner);\n  }\n\n  getKey() {\n    return this.keyModel || (this.keyModel = new KeyModel(this.key));\n  }\n\n  getKeypath(root) {\n    if (root) {\n      return (\n        this.rootModel ||\n        (this.rootModel = new KeyModel(this.context.getKeypath(this.ractive.root)))\n      );\n    } else {\n      return this.pathModel || (this.pathModel = new KeyModel(this.context.getKeypath()));\n    }\n  }\n\n  getIndex() {\n    return this.idxModel || (this.idxModel = new KeyModel(this.index));\n  }\n\n  rebind(next) {\n    this.context = next;\n  }\n\n  render(target, occupants) {\n    if (this.rendered) throw new Error('Fragment is already rendered!');\n    this.rendered = true;\n\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      xs[i].render(target, occupants);\n    }\n  }\n\n  resetTemplate(template) {\n    const wasBound = this.bound;\n    const wasRendered = this.rendered;\n\n    // TODO ensure transitions are disabled globally during reset\n\n    if (wasBound) {\n      if (wasRendered) this.unrender(true);\n      this.unbind();\n    }\n\n    this.template = template;\n    this.createItems();\n\n    if (wasBound) {\n      this.bind(this.context);\n\n      if (wasRendered) {\n        const parentNode = this.findParentNode();\n        const anchor = this.findNextNode();\n\n        if (anchor) {\n          const docFrag = createDocumentFragment();\n          this.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        } else {\n          this.render(parentNode);\n        }\n      }\n    }\n  }\n\n  shuffled() {\n    this.items.forEach(shuffled);\n    if (this.rootModel) this.rootModel.applyValue(this.context.getKeypath(this.ractive.root));\n    if (this.pathModel) this.pathModel.applyValue(this.context.getKeypath());\n  }\n\n  toString(escape) {\n    return this.items.map(escape ? toEscapedString : toString).join('');\n  }\n\n  unbind() {\n    this.context = null;\n    this.items.forEach(unbind);\n    this.bound = false;\n\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.items.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      if (!this.updating) {\n        this.dirty = false;\n        this.updating = true;\n        this.items.forEach(update);\n        this.updating = false;\n      } else if (this.isRoot) {\n        runloop.addFragmentToRoot(this);\n      }\n    }\n  }\n\n  valueOf() {\n    if (this.items.length === 1) {\n      return this.items[0].valueOf();\n    }\n\n    if (this.dirtyValue) {\n      const values = {};\n      const source = processItems(this.items, values, this.ractive._guid);\n      const parsed = parseJSON(source, values);\n\n      this.value = parsed ? parsed.value : this.toString();\n\n      this.dirtyValue = false;\n    }\n\n    return this.value;\n  }\n}\nFragment.prototype.getContext = getContext;\n","import Hook from './Hook';\n\nfunction getChildQueue(queue, ractive) {\n  return queue[ractive._guid] || (queue[ractive._guid] = []);\n}\n\nfunction fire(hookQueue, ractive) {\n  const childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  hookQueue.hook.fire(ractive);\n\n  // queue is \"live\" because components can end up being\n  // added while hooks fire on parents that modify data values.\n  while (childQueue.length) {\n    fire(hookQueue, childQueue.shift());\n  }\n\n  delete hookQueue.queue[ractive._guid];\n}\n\nexport default class HookQueue {\n  constructor(event) {\n    this.hook = new Hook(event);\n    this.inProcess = {};\n    this.queue = {};\n  }\n\n  begin(ractive) {\n    this.inProcess[ractive._guid] = true;\n  }\n\n  end(ractive) {\n    const parent = ractive.parent;\n\n    // If this is *isn't* a child of a component that's in process,\n    // it should call methods or fire at this point\n    if (!parent || !this.inProcess[parent._guid]) {\n      fire(this, ractive);\n    } else {\n      // elsewise, handoff to parent to fire when ready\n      getChildQueue(this.queue, parent).push(ractive);\n    }\n\n    delete this.inProcess[ractive._guid];\n  }\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { isArray } from 'utils/is';\nimport config from './config/config';\nimport Fragment from 'src/view/Fragment';\nimport Hook from 'src/events/Hook';\nimport HookQueue from 'src/events/HookQueue';\nimport Ractive from '../Ractive';\nimport subscribe from './helpers/subscribe';\n\nconst configHook = new Hook('config');\nconst initHook = new HookQueue('init');\n\nexport default function initialise(ractive, userOptions, options) {\n  // initialize settable computeds\n  const computed = ractive.viewmodel.computed;\n  if (computed) {\n    for (const k in computed) {\n      if (k in ractive.viewmodel.value && computed[k] && !computed[k].isReadonly) {\n        computed[k].set(ractive.viewmodel.value[k]);\n      }\n    }\n  }\n\n  // init config from Parent and options\n  config.init(ractive.constructor, ractive, userOptions);\n\n  configHook.fire(ractive);\n\n  initHook.begin(ractive);\n\n  const fragment = (ractive.fragment = createFragment(ractive, options));\n  if (fragment) fragment.bind(ractive.viewmodel);\n\n  initHook.end(ractive);\n\n  // general config done, set up observers\n  subscribe(ractive, userOptions, 'observe');\n\n  // call any passed in plugins\n  if (isArray(userOptions.use))\n    ractive.use.apply(ractive, userOptions.use.filter(p => !p.construct));\n\n  if (fragment) {\n    // render automatically ( if `el` is specified )\n    const el = (ractive.el = ractive.target = getElement(ractive.el || ractive.target));\n    if (el && !ractive.component) {\n      const promise = ractive.render(el, ractive.append);\n\n      if (Ractive.DEBUG_PROMISES) {\n        promise.catch(err => {\n          warnOnceIfDebug(\n            'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;'\n          );\n          warnIfDebug('An error happened during rendering', { ractive });\n          logIfDebug(err);\n\n          throw err;\n        });\n      }\n    }\n  }\n}\n\nexport function createFragment(ractive, options = {}) {\n  if (ractive.template) {\n    const cssIds = [].concat(ractive.constructor._cssIds || [], options.cssIds || []);\n\n    return new Fragment({\n      owner: ractive,\n      template: ractive.template,\n      cssIds\n    });\n  }\n}\n","import { doc } from 'config/environment';\nimport { applyCSS } from 'src/global/css';\nimport Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport { createFragment } from './initialise';\n\nconst renderHook = new Hook('render');\nconst completeHook = new Hook('complete');\n\nexport default function render(ractive, target, anchor, occupants) {\n  // set a flag to let any transitions know that this instance is currently rendering\n  ractive.rendering = true;\n\n  const promise = runloop.start();\n  runloop.scheduleTask(() => renderHook.fire(ractive), true);\n\n  if (ractive.fragment.rendered) {\n    throw new Error(\n      'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first'\n    );\n  }\n\n  if (ractive.destroyed) {\n    ractive.destroyed = false;\n    ractive.fragment = createFragment(ractive).bind(ractive.viewmodel);\n  }\n\n  anchor = getElement(anchor) || ractive.anchor;\n\n  ractive.el = ractive.target = target;\n  ractive.anchor = anchor;\n\n  // ensure encapsulated CSS is up-to-date\n  if (ractive.cssId) applyCSS();\n\n  if (target) {\n    (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n    if (anchor) {\n      const docFrag = doc.createDocumentFragment();\n      ractive.fragment.render(docFrag);\n      target.insertBefore(docFrag, anchor);\n    } else {\n      ractive.fragment.render(target, occupants);\n    }\n  }\n\n  runloop.end();\n  ractive.rendering = false;\n\n  return promise.then(() => {\n    if (ractive.torndown) return;\n\n    completeHook.fire(ractive);\n  });\n}\n","import runloop from 'src/global/runloop';\nimport config from '../config/config';\nimport Hook from '../../events/Hook';\nimport dataConfigurator from '../config/custom/data';\nimport { isObjectType } from 'utils/is';\n\nconst shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\nconst completeHook = new Hook('complete');\nconst resetHook = new Hook('reset');\nconst renderHook = new Hook('render');\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$reset(data) {\n  data = data || {};\n\n  if (!isObjectType(data)) {\n    throw new Error('The reset method takes either no arguments, or an object containing new data');\n  }\n\n  // TEMP need to tidy this up\n  data = dataConfigurator.init(this.constructor, this, { data });\n\n  const promise = runloop.start();\n\n  // If the root object is wrapped, try and use the wrapper's reset value\n  const wrapper = this.viewmodel.wrapper;\n  if (wrapper && wrapper.reset) {\n    if (wrapper.reset(data) === false) {\n      // reset was rejected, we need to replace the object\n      this.viewmodel.set(data);\n    }\n  } else {\n    this.viewmodel.set(data);\n  }\n\n  // reset config items and track if need to rerender\n  const changes = config.reset(this);\n  let rerender;\n\n  let i = changes.length;\n  while (i--) {\n    if (shouldRerender.indexOf(changes[i]) > -1) {\n      rerender = true;\n      break;\n    }\n  }\n\n  if (rerender) {\n    unrenderHook.fire(this);\n    this.fragment.resetTemplate(this.template);\n    renderHook.fire(this);\n    completeHook.fire(this);\n  }\n\n  runloop.end();\n\n  resetHook.fire(this, data);\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('reverse').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('shift').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('sort').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('splice').path;\n","import Hook from 'src/events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\n\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$unrender() {\n  if (!this.fragment.rendered) {\n    warnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n    return Promise.resolve();\n  }\n\n  this.unrendering = true;\n  const promise = runloop.start();\n\n  // If this is a component, and the component isn't marked for destruction,\n  // don't detach nodes from the DOM unnecessarily\n  const shouldDestroy =\n    !this.component ||\n    (this.component.anchor || {}).shouldDestroy ||\n    this.component.shouldDestroy ||\n    this.shouldDestroy;\n  this.fragment.unrender(shouldDestroy);\n  if (shouldDestroy) this.destroyed = true;\n\n  removeFromArray(this.el.__ractive_instances__, this);\n\n  unrenderHook.fire(this);\n\n  runloop.end();\n  this.unrendering = false;\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('unshift').path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport compute from './prototype/compute';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext, { getNodeInfo } from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\nimport use from './prototype/use';\n\nimport { defineProperty } from 'utils/object';\n\nconst proto = {\n  add,\n  animate,\n  attachChild,\n  compute,\n  detach,\n  detachChild,\n  find,\n  findAll,\n  findAllComponents,\n  findComponent,\n  findContainer,\n  findParent,\n  fire,\n  get,\n  getContext,\n  getNodeInfo,\n  insert,\n  link,\n  observe,\n  observeOnce,\n  off,\n  on,\n  once,\n  pop,\n  push,\n  readLink,\n  render,\n  reset,\n  resetPartial,\n  resetTemplate,\n  reverse,\n  set,\n  shift,\n  sort,\n  splice,\n  subtract,\n  teardown,\n  toggle,\n  toCSS,\n  toCss: toCSS,\n  toHTML,\n  toHtml: toHTML,\n  toText,\n  transition,\n  unlink,\n  unrender,\n  unshift,\n  update,\n  updateModel,\n  use\n};\n\ndefineProperty(proto, 'target', {\n  get() {\n    return this.el;\n  }\n});\n\nexport default proto;\n","import { isFunction } from 'utils/is';\nimport { addCSS, applyCSS } from 'src/global/css';\nimport { recomputeCSS } from './styleSet';\n\nconst styles = [];\n\nexport function addStyle(id, css) {\n  if (styles.find(s => s.id === id))\n    throw new Error(`Extra styles with the id '${id}' have already been added.`);\n  styles.push({ id, css });\n\n  if (!this.css) {\n    Object.defineProperty(this, 'css', { configurable: false, writable: false, value: buildCSS });\n  }\n\n  if (!this._cssDef) {\n    Object.defineProperty(this, '_cssDef', {\n      configurable: false,\n      writable: false,\n      value: {\n        transform: false,\n        id: 'Ractive.addStyle'\n      }\n    });\n\n    addCSS(this._cssDef);\n  }\n\n  recomputeCSS(this);\n  applyCSS(true);\n}\n\nfunction buildCSS(data) {\n  return styles\n    .map(s => `\\n/* ---- extra style ${s.id} */\\n` + (isFunction(s.css) ? s.css(data) : s.css))\n    .join('');\n}\n\nexport function hasStyle(id) {\n  return !!styles.find(s => s.id === id);\n}\n","import config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\nimport styleSet from '../Ractive/static/styleSet';\nimport styleGet from '../Ractive/static/styleGet';\nimport { addStyle, hasStyle } from '../Ractive/static/styles';\nimport sharedSet from '../Ractive/static/sharedSet';\nimport sharedGet from '../Ractive/static/sharedGet';\nimport use from '../Ractive/static/use';\nimport { create, defineProperties, toPairs, defineProperty } from 'utils/object';\nimport { isArray, isFunction } from 'utils/is';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend(...options) {\n  if (!options.length) {\n    return extendOne(this);\n  } else {\n    return options.reduce(extendOne, this);\n  }\n}\n\nexport function extendWith(Class, options = {}) {\n  return extendOne(this, options, Class);\n}\n\nfunction extendOne(Parent, options = {}, Target) {\n  let proto;\n  let Child = isFunction(Target) && Target;\n\n  if (options.prototype instanceof Ractive) {\n    throw new Error(`Ractive no longer supports multiple inheritance.`);\n  }\n\n  if (Child) {\n    if (!(Child.prototype instanceof Parent)) {\n      throw new Error(\n        `Only classes that inherit the appropriate prototype may be used with extend`\n      );\n    }\n    if (!callsSuper.test(Child.toString())) {\n      throw new Error(`Only classes that call super in their constructor may be used with extend`);\n    }\n\n    proto = Child.prototype;\n  } else {\n    Child = function(options) {\n      if (!(this instanceof Child)) return new Child(options);\n\n      construct(this, options || {});\n      initialise(this, options || {}, {});\n    };\n\n    proto = create(Parent.prototype);\n    proto.constructor = Child;\n\n    Child.prototype = proto;\n  }\n\n  // Static properties\n  defineProperties(Child, {\n    // alias prototype as defaults\n    defaults: { value: proto },\n\n    extend: { value: extend, writable: true, configurable: true },\n    extendWith: { value: extendWith, writable: true, configurable: true },\n    extensions: { value: [] },\n    use: { value: use },\n\n    isInstance: { value: isInstance },\n\n    Parent: { value: Parent },\n    Ractive: { value: Ractive },\n\n    styleGet: { value: styleGet.bind(Child), configurable: true },\n    styleSet: { value: styleSet.bind(Child), configurable: true }\n  });\n\n  // extend configuration\n  config.extend(Parent, proto, options, Child);\n\n  // store event and observer registries on the constructor when extending\n  Child._on = (Parent._on || []).concat(toPairs(options.on));\n  Child._observe = (Parent._observe || []).concat(toPairs(options.observe));\n\n  Parent.extensions.push(Child);\n\n  // attribute defs are not inherited, but they need to be stored\n  if (options.attributes) {\n    let attrs;\n\n    // allow an array of optional props or an object with arrays for optional and required props\n    if (isArray(options.attributes)) {\n      attrs = { optional: options.attributes, required: [] };\n    } else {\n      attrs = options.attributes;\n    }\n\n    // make sure the requisite keys actually store arrays\n    if (!isArray(attrs.required)) attrs.required = [];\n    if (!isArray(attrs.optional)) attrs.optional = [];\n\n    Child.attributes = attrs;\n  }\n\n  dataConfigurator.extend(Parent, proto, options, Child);\n\n  defineProperty(Child, 'helpers', { writable: true, value: proto.helpers });\n\n  if (isArray(options.use)) Child.use.apply(Child, options.use);\n\n  return Child;\n}\n\ndefineProperties(Ractive, {\n  sharedGet: { value: sharedGet },\n  sharedSet: { value: sharedSet },\n  styleGet: { configurable: true, value: styleGet.bind(Ractive) },\n  styleSet: { configurable: true, value: styleSet.bind(Ractive) },\n  addCSS: { configurable: false, value: addStyle.bind(Ractive) },\n  hasCSS: { configurable: false, value: hasStyle.bind(Ractive) }\n});\n","import './polyfills/Object.assign';\nimport './polyfills/array.find';\nimport './polyfills/node.contains';\nimport './polyfills/performance.now';\nimport './polyfills/Promise';\nimport './polyfills/requestAnimationFrame';\n\nimport defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport macro from './extend/_macro';\nimport parse from './parse/_parse';\nimport getContext, { getNodeInfo } from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport use from './Ractive/static/use';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\nimport CSSModel from './model/specials/CSSModel';\nimport { data as sharedData } from './model/specials/SharedModel';\nimport { extern } from './shared/getRactiveContext';\nimport { warn } from 'utils/log';\n\nimport { assign, defineProperty, defineProperties } from 'utils/object';\n\nexport default function Ractive(options) {\n  if (!(this instanceof Ractive)) return new Ractive(options);\n\n  construct(this, options || {});\n  initialise(this, options || {}, {});\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif (win && !win.Ractive) {\n  let opts = '';\n  const script =\n    document.currentScript ||\n    /* istanbul ignore next */ document.querySelector('script[data-ractive-options]');\n\n  if (script) opts = script.getAttribute('data-ractive-options') || '';\n\n  /* istanbul ignore next */\n  if (~opts.indexOf('ForceGlobal')) win.Ractive = Ractive;\n} else if (win) {\n  warn(`Ractive already appears to be loaded while loading BUILD_PLACEHOLDER_VERSION.`);\n}\n\nassign(Ractive.prototype, proto, defaults);\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\ndefineProperties(Ractive, {\n  // debug flag\n  DEBUG: { writable: true, value: true },\n  DEBUG_PROMISES: { writable: true, value: true },\n\n  // static methods:\n  extend: { value: extend },\n  extendWith: { value: extendWith },\n  escapeKey: { value: escapeKey },\n  evalObjectString: { value: parseJSON },\n  findPlugin: { value: findPlugin },\n  getContext: { value: getContext },\n  getCSS: { value: getCSS },\n  getNodeInfo: { value: getNodeInfo },\n  isInstance: { value: isInstance },\n  joinKeys: { value: joinKeys },\n  macro: { value: macro },\n  normaliseKeypath: { value: normalise },\n  parse: { value: parse },\n  splitKeypath: { value: splitKeypath },\n  // sharedSet and styleSet are in _extend because circular refs\n  unescapeKey: { value: unescapeKey },\n  use: { value: use },\n\n  // support\n  enhance: { writable: true, value: false },\n  svg: { value: svg },\n\n  // version\n  VERSION: { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n  // plugins\n  adaptors: { writable: true, value: {} },\n  components: { writable: true, value: {} },\n  decorators: { writable: true, value: {} },\n  easing: { writable: true, value: easing },\n  events: { writable: true, value: {} },\n  extensions: { value: [] },\n  helpers: { writable: true, value: defaults.helpers },\n  interpolators: { writable: true, value: interpolators },\n  partials: { writable: true, value: {} },\n  transitions: { writable: true, value: {} },\n\n  // CSS variables\n  cssData: { configurable: true, value: {} },\n\n  // access to @shared without an instance\n  sharedData: { value: sharedData },\n\n  // for getting the source Ractive lib from a constructor\n  Ractive: { value: Ractive },\n\n  // to allow extending contexts\n  Context: { value: extern.Context.prototype }\n});\n\n// cssData must already be in place\ndefineProperty(Ractive, '_cssModel', {\n  configurable: true,\n  value: new CSSModel(Ractive)\n});\n","import runloop from 'src/global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport noop from 'utils/noop';\nimport findElement from '../../shared/findElement';\n\nexport default class Binding {\n  constructor(element, name = 'value') {\n    this.element = element;\n    this.ractive = element.ractive;\n    this.attribute = element.attributeByName[name];\n\n    const interpolator = this.attribute.interpolator;\n    interpolator.twowayBinding = this;\n\n    const model = interpolator.model;\n\n    if (model.isReadonly && !model.setRoot) {\n      const keypath = model.getKeypath().replace(/^@/, '');\n      warnOnceIfDebug(\n        `Cannot use two-way binding on <${\n          element.name\n        }> element: ${keypath} is read-only. To suppress this warning use <${\n          element.name\n        } twoway='false'...>`,\n        { ractive: this.ractive }\n      );\n      return false;\n    }\n\n    this.attribute.isTwoway = true;\n    this.model = model;\n\n    // initialise value, if it's undefined\n    let value = model.get();\n    this.wasUndefined = value === undefined;\n\n    if (value === undefined && this.getInitialValue) {\n      value = this.getInitialValue();\n      model.set(value);\n    }\n    this.lastVal(true, value);\n\n    const parentForm = findElement(this.element, false, 'form');\n    if (parentForm) {\n      this.resetValue = value;\n      parentForm.formBindings.push(this);\n    }\n  }\n\n  bind() {\n    this.model.registerTwowayBinding(this);\n  }\n\n  handleChange() {\n    const value = this.getValue();\n    if (this.lastVal() === value) return;\n\n    runloop.start();\n    this.attribute.locked = true;\n    this.model.set(value);\n    this.lastVal(true, value);\n\n    // if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n    if (this.model.get() !== value) this.attribute.locked = false;\n    else runloop.scheduleTask(() => (this.attribute.locked = false));\n\n    runloop.end();\n  }\n\n  lastVal(setting, value) {\n    if (setting) this.lastValue = value;\n    else return this.lastValue;\n  }\n\n  rebind(next, previous) {\n    if (this.model && this.model === previous) previous.unregisterTwowayBinding(this);\n    if (next) {\n      this.model = next;\n      runloop.scheduleTask(() => next.registerTwowayBinding(this));\n    }\n  }\n\n  render() {\n    this.node = this.element.node;\n    this.node._ractive.binding = this;\n    this.rendered = true; // TODO is this used anywhere?\n  }\n\n  setFromNode(node) {\n    this.model.set(node.value);\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n  }\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n\n  getInitialValue() {\n    return !!this.element.getAttribute('checked');\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup(group, model, getValue) {\n  const hash = `${group}-bindingGroup`;\n  return model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n}\n\nclass BindingGroup {\n  constructor(hash, model, getValue) {\n    this.model = model;\n    this.hash = hash;\n    this.getValue = () => {\n      this.value = getValue.call(this);\n      return this.value;\n    };\n\n    this.bindings = [];\n  }\n\n  add(binding) {\n    this.bindings.push(binding);\n  }\n\n  bind() {\n    this.value = this.model.get();\n    this.model.registerTwowayBinding(this);\n    this.bound = true;\n  }\n\n  remove(binding) {\n    removeFromArray(this.bindings, binding);\n    if (!this.bindings.length) {\n      this.unbind();\n    }\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n    this.bound = false;\n    delete this.model[this.hash];\n  }\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport { isArray } from 'utils/is';\n\nconst push = [].push;\n\nfunction getValue() {\n  const all = this.bindings\n    .filter(b => b.node && b.node.checked)\n    .map(b => b.element.getAttribute('value'));\n  const res = [];\n  all.forEach(v => {\n    if (!this.bindings[0].arrayContains(res, v)) res.push(v);\n  });\n  return res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n    // Each input has a reference to an array containing it and its\n    // group, as two-way binding depends on being able to ascertain\n    // the status of all inputs within the group\n    this.group = getBindingGroup('checkboxes', this.model, getValue);\n    this.group.add(this);\n\n    if (this.noInitialValue) {\n      this.group.noInitialValue = true;\n    }\n\n    // If no initial value was set, and this input is checked, we\n    // update the model\n    if (this.group.noInitialValue && this.element.getAttribute('checked')) {\n      const existingValue = this.model.get();\n      const bindingValue = this.element.getAttribute('value');\n\n      if (!this.arrayContains(existingValue, bindingValue)) {\n        push.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n      }\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    // This only gets called once per group (of inputs that\n    // share a name), because it only gets called if there\n    // isn't an initial value. By the same token, we can make\n    // a note of that fact that there was no initial value,\n    // and populate it using any `checked` attributes that\n    // exist (which users should avoid, but which we should\n    // support anyway to avoid breaking expectations)\n    this.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n    return [];\n  }\n\n  getValue() {\n    return this.group.value;\n  }\n\n  handleChange() {\n    this.isChecked = this.element.node.checked;\n    this.group.value = this.model.get();\n    const value = this.element.getAttribute('value');\n    if (this.isChecked && !this.arrayContains(this.group.value, value)) {\n      this.group.value.push(value);\n    } else if (!this.isChecked && this.arrayContains(this.group.value, value)) {\n      this.removeFromArray(this.group.value, value);\n    }\n    // make sure super knows there's a change\n    this.lastValue = null;\n    super.handleChange();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    const existingValue = this.model.get();\n    const bindingValue = this.element.getAttribute('value');\n\n    if (isArray(existingValue)) {\n      this.isChecked = this.arrayContains(existingValue, bindingValue);\n    } else {\n      this.isChecked = this.element.compare(existingValue, bindingValue);\n    }\n    node.name = '{{' + this.model.getKeypath() + '}}';\n    node.checked = this.isChecked;\n\n    this.element.on('change', handleDomEvent);\n\n    // in case of IE emergency, bind to click event as well\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.group.bindings.forEach(binding => (binding.wasUndefined = true));\n\n    if (node.checked) {\n      const valueSoFar = this.group.getValue();\n      valueSoFar.push(this.element.getAttribute('value'));\n\n      this.group.model.set(valueSoFar);\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  arrayContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.element.compare(optionValue, selectValue[i])) return true;\n    }\n    return false;\n  }\n\n  removeFromArray(array, item) {\n    if (!array) return;\n    let i = array.length;\n    while (i--) {\n      if (this.element.compare(item, array[i])) {\n        array.splice(i, 1);\n      }\n    }\n  }\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n  getInitialValue() {\n    return this.element.fragment ? this.element.fragment.toString() : '';\n  }\n\n  getValue() {\n    return this.element.node.innerHTML;\n  }\n\n  render() {\n    super.render();\n\n    const el = this.element;\n\n    el.on('change', handleDomEvent);\n    el.on('blur', handleDomEvent);\n\n    if (!this.ractive.lazy) {\n      el.on('input', handleDomEvent);\n\n      if (this.node.attachEvent) {\n        el.on('keyup', handleDomEvent);\n      }\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.innerHTML);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('blur', handleDomEvent);\n    el.off('change', handleDomEvent);\n    el.off('input', handleDomEvent);\n    el.off('keyup', handleDomEvent);\n  }\n}\n","import { isNumeric } from 'utils/is';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur() {\n  handleDomEvent.call(this);\n\n  const value = this._ractive.binding.model.get();\n  this.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay(delay) {\n  let timeout;\n\n  return function() {\n    if (timeout) clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      const binding = this._ractive.binding;\n      if (binding.rendered) handleDomEvent.call(this);\n      timeout = null;\n    }, delay);\n  };\n}\n\nexport default class GenericBinding extends Binding {\n  getInitialValue() {\n    return '';\n  }\n\n  getValue() {\n    return this.node.value;\n  }\n\n  render() {\n    super.render();\n\n    // any lazy setting for this element overrides the root\n    // if the value is a number, it's a timeout\n    let lazy = this.ractive.lazy;\n    let timeout = false;\n    const el = this.element;\n\n    if ('lazy' in this.element) {\n      lazy = this.element.lazy;\n    }\n\n    if (isNumeric(lazy)) {\n      timeout = +lazy;\n      lazy = false;\n    }\n\n    this.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n    const node = this.node;\n\n    el.on('change', handleDomEvent);\n\n    if (node.type !== 'file') {\n      if (!lazy) {\n        el.on('input', this.handler);\n\n        // IE is a special snowflake\n        if (node.attachEvent) {\n          el.on('keyup', this.handler);\n        }\n      }\n\n      el.on('blur', handleBlur);\n    }\n  }\n\n  unrender() {\n    const el = this.element;\n    this.rendered = false;\n\n    el.off('change', handleDomEvent);\n    el.off('input', this.handler);\n    el.off('keyup', this.handler);\n    el.off('blur', handleBlur);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n  getInitialValue() {\n    /* istanbul ignore next */\n    return undefined;\n  }\n\n  getValue() {\n    /* istanbul ignore next */\n    return this.node.files;\n  }\n\n  render() {\n    /* istanbul ignore next */\n    this.element.lazy = false;\n    /* istanbul ignore next */\n    super.render();\n  }\n\n  setFromNode(node) {\n    /* istanbul ignore next */\n    this.model.set(node.files);\n  }\n}\n","import { arrayContentsMatch } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class MultipleSelectBinding extends Binding {\n  getInitialValue() {\n    return this.element.options\n      .filter(option => option.getAttribute('selected'))\n      .map(option => option.getAttribute('value'));\n  }\n\n  getValue() {\n    const options = this.element.node.options;\n    const len = options.length;\n\n    const selectedValues = [];\n\n    for (let i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (option.selected) {\n        const optionValue = option._ractive ? option._ractive.value : option.value;\n        selectedValues.push(optionValue);\n      }\n    }\n\n    return selectedValues;\n  }\n\n  handleChange() {\n    const attribute = this.attribute;\n    const previousValue = attribute.getValue();\n\n    const value = this.getValue();\n\n    if (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n      super.handleChange();\n    }\n\n    return this;\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.model.get() === undefined) {\n      // get value from DOM, if possible\n      this.handleChange();\n    }\n  }\n\n  setFromNode(node) {\n    const selectedOptions = getSelectedOptions(node);\n    let i = selectedOptions.length;\n    const result = new Array(i);\n\n    while (i--) {\n      const option = selectedOptions[i];\n      result[i] = option._ractive ? option._ractive.value : option.value;\n    }\n\n    this.model.set(result);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n  getInitialValue() {\n    return undefined;\n  }\n\n  getValue() {\n    const value = parseFloat(this.node.value);\n    return isNaN(value) ? undefined : value;\n  }\n\n  setFromNode(node) {\n    const value = parseFloat(node.value);\n    if (!isNaN(value)) this.model.set(value);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings(hash) {\n  return siblings[hash] || (siblings[hash] = []);\n}\n\nexport default class RadioBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n\n    this.siblings = getSiblings(this.ractive._guid + this.element.getAttribute('name'));\n    this.siblings.push(this);\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  handleChange() {\n    runloop.start();\n\n    this.siblings.forEach(binding => {\n      binding.model.set(binding.getValue());\n    });\n\n    runloop.end();\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n\n  unbind() {\n    removeFromArray(this.siblings, this);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n}\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getValue() {\n  const checked = this.bindings.filter(b => b.node.checked);\n  if (checked.length > 0) {\n    return checked[0].element.getAttribute('value');\n  }\n}\n\nexport default class RadioNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.group = getBindingGroup('radioname', this.model, getValue);\n    this.group.add(this);\n\n    if (element.checked) {\n      this.group.value = this.getValue();\n    }\n\n    this.attribute.interpolator.pathChanged = () => this.updateName();\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('checked')) {\n      return this.element.getAttribute('value');\n    }\n  }\n\n  getValue() {\n    return this.element.getAttribute('value');\n  }\n\n  handleChange() {\n    // If this <input> is the one that's checked, then the value of its\n    // `name` model gets set to its value\n    if (this.node.checked) {\n      this.group.value = this.getValue();\n      super.handleChange();\n    }\n\n    this.updateName();\n  }\n\n  lastVal(setting, value) {\n    if (!this.group) return;\n    if (setting) this.group.lastValue = value;\n    else return this.group.lastValue;\n  }\n\n  rebind(next, previous) {\n    super.rebind(next, previous);\n    this.updateName();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    this.updateName();\n    node.checked = this.element.compare(this.model.get(), this.element.getAttribute('value'));\n\n    this.element.on('change', handleDomEvent);\n\n    if (node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    if (node.checked) {\n      this.group.model.set(this.element.getAttribute('value'));\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  updateName() {\n    if (this.node) this.node.name = `{{${this.model.getKeypath()}}}`;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n  forceUpdate() {\n    const value = this.getValue();\n\n    if (value !== undefined) {\n      this.attribute.locked = true;\n      runloop.scheduleTask(() => (this.attribute.locked = false));\n      this.model.set(value);\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('value') !== undefined) {\n      return;\n    }\n\n    const options = this.element.options;\n    const len = options.length;\n\n    if (!len) return;\n\n    let value;\n    let optionWasSelected;\n    let i = len;\n\n    // take the final selected option...\n    while (i--) {\n      const option = options[i];\n\n      if (option.getAttribute('selected')) {\n        if (!option.getAttribute('disabled')) {\n          value = option.getAttribute('value');\n        }\n\n        optionWasSelected = true;\n        break;\n      }\n    }\n\n    // or the first non-disabled option, if none are selected\n    if (!optionWasSelected) {\n      while (++i < len) {\n        if (!options[i].getAttribute('disabled')) {\n          value = options[i].getAttribute('value');\n          break;\n        }\n      }\n    }\n\n    // This is an optimisation (aka hack) that allows us to forgo some\n    // other more expensive work\n    // TODO does it still work? seems at odds with new architecture\n    if (value !== undefined) {\n      this.element.attributeByName.value.value = value;\n    }\n\n    return value;\n  }\n\n  getValue() {\n    const options = this.node.options;\n    const len = options.length;\n\n    let i;\n    for (i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (options[i].selected && !options[i].disabled) {\n        return option._ractive ? option._ractive.value : option.value;\n      }\n    }\n  }\n\n  render() {\n    super.render();\n    this.element.on('change', handleDomEvent);\n  }\n\n  setFromNode(node) {\n    const option = getSelectedOptions(node)[0];\n    this.model.set(option._ractive ? option._ractive.value : option.value);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from 'config/types';\nimport { win } from 'config/environment';\nimport { html, svg } from 'config/namespaces';\nimport { toArray, addToArray, removeFromArray } from 'utils/array';\nimport { escapeHtml, voidElementNames } from 'utils/html';\nimport { createElement, detachNode, matches, safeAttributeString } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport Context from 'shared/Context';\nimport { bind, destroyed, render, unbind, update } from 'shared/methodCallers';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { assign, create, defineProperty } from 'utils/object';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.e.toLowerCase();\n\n    // find parent element\n    this.parent = findElement(this.up, false);\n\n    if (this.parent && this.parent.name === 'option') {\n      throw new Error(\n        `An <option> element cannot contain other elements (encountered <${this.name}>)`\n      );\n    }\n\n    this.decorators = [];\n\n    // create attributes\n    this.attributeByName = {};\n\n    let attrs;\n    let n, attr, val, cls, name, template, leftovers;\n\n    const m = this.template.m;\n    const len = (m && m.length) || 0;\n\n    for (let i = 0; i < len; i++) {\n      template = m[i];\n      switch (template.t) {\n        case ATTRIBUTE:\n        case BINDING_FLAG:\n        case DECORATOR:\n        case EVENT:\n        case TRANSITION:\n          attr = createItem({\n            owner: this,\n            up: this.up,\n            template\n          });\n\n          n = template.n;\n\n          attrs = attrs || (attrs = this.attributes = []);\n\n          if (n === 'value') val = attr;\n          else if (n === 'name') name = attr;\n          else if (n === 'class') cls = attr;\n          else attrs.push(attr);\n\n          break;\n\n        case DELEGATE_FLAG:\n          this.delegate = false;\n          break;\n\n        default:\n          (leftovers || (leftovers = [])).push(template);\n          break;\n      }\n    }\n\n    if (val) attrs.push(val);\n    if (name) attrs.push(name);\n    if (cls) attrs.unshift(cls);\n\n    if (leftovers) {\n      (attrs || (this.attributes = [])).push(\n        new ConditionalAttribute({\n          owner: this,\n          up: this.up,\n          template: leftovers\n        })\n      );\n\n      // empty leftovers array\n      leftovers = [];\n    }\n\n    // create children\n    if (options.template.f && !options.deferContent) {\n      this.fragment = new Fragment({\n        template: options.template.f,\n        owner: this,\n        cssIds: null\n      });\n    }\n\n    this.binding = null; // filled in later\n  }\n\n  bind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.binding = true;\n      attrs.forEach(bind);\n      attrs.binding = false;\n    }\n\n    if (this.fragment) this.fragment.bind();\n\n    // create two-way binding if necessary\n    if (!this.binding) this.recreateTwowayBinding();\n    else this.binding.bind();\n  }\n\n  createTwowayBinding() {\n    if ('twoway' in this ? this.twoway : this.ractive.twoway) {\n      const Binding = selectBinding(this);\n      if (Binding) {\n        const binding = new Binding(this);\n        if (binding && binding.model) return binding;\n      }\n    }\n  }\n\n  destroyed() {\n    if (this.attributes) this.attributes.forEach(destroyed);\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.removeEventListener(k, handler);\n      }\n    }\n\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  detach() {\n    // if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n    if (!this.rendered) this.destroyed();\n\n    return detachNode(this.node);\n  }\n\n  find(selector, options) {\n    if (this.node && matches(this.node, selector)) return this.node;\n    if (this.fragment) {\n      return this.fragment.find(selector, options);\n    }\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n\n    if (matches(this.node, selector)) {\n      result.push(this.node);\n    }\n\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findNextNode() {\n    return null;\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute ? attribute.getValue() : undefined;\n  }\n\n  getContext(...assigns) {\n    if (this.fragment) return this.fragment.getContext(...assigns);\n\n    if (!this.ctx) this.ctx = new Context(this.up, this);\n    assigns.unshift(create(this.ctx));\n    return assign.apply(null, assigns);\n  }\n\n  off(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = this.listeners && this.listeners[event];\n\n    if (!ref) return;\n    removeFromArray(ref, callback);\n\n    if (delegate) {\n      const listeners =\n        (delegate.listeners || (delegate.listeners = [])) &&\n        (delegate.listeners[event] || (delegate.listeners[event] = []));\n      if (listeners.refs && !--listeners.refs) delegate.off(event, delegateHandler, true);\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        rem.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, true);\n        add.call(n, event, handler, false);\n      }\n    }\n  }\n\n  on(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = (this.listeners || (this.listeners = {}))[event] || (this.listeners[event] = []);\n\n    if (delegate) {\n      const listeners =\n        ((delegate.listeners || (delegate.listeners = [])) && delegate.listeners[event]) ||\n        (delegate.listeners[event] = []);\n      if (!listeners.refs) {\n        listeners.refs = 0;\n        delegate.on(event, delegateHandler, true);\n        listeners.refs++;\n      } else {\n        listeners.refs++;\n      }\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        add.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, false);\n        add.call(n, event, handler, true);\n      }\n    }\n\n    addToArray(this.listeners[event], callback);\n  }\n\n  recreateTwowayBinding() {\n    if (this.binding) {\n      this.binding.unbind();\n      this.binding.unrender();\n    }\n\n    if ((this.binding = this.createTwowayBinding())) {\n      this.binding.bind();\n      if (this.rendered) this.binding.render();\n    }\n  }\n\n  render(target, occupants) {\n    // TODO determine correct namespace\n    this.namespace = getNamespace(this);\n\n    let node;\n    let existing = false;\n\n    if (occupants) {\n      let n;\n      while ((n = occupants.shift())) {\n        if (\n          n.nodeName.toUpperCase() === this.template.e.toUpperCase() &&\n          n.namespaceURI === this.namespace\n        ) {\n          this.node = node = n;\n          existing = true;\n          break;\n        } else {\n          detachNode(n);\n        }\n      }\n    }\n\n    if (!existing && this.node) {\n      node = this.node;\n      target.appendChild(node);\n      existing = true;\n    }\n\n    if (!node) {\n      const name = this.template.e;\n      node = createElement(\n        this.namespace === html ? name.toLowerCase() : name,\n        this.namespace,\n        this.getAttribute('is')\n      );\n      this.node = node;\n    }\n\n    // tie the node to this vdom element\n    defineProperty(node, '_ractive', {\n      value: {\n        proxy: this\n      },\n      configurable: true\n    });\n\n    if (existing && this.foundNode) this.foundNode(node);\n\n    // register intro before rendering content so children can find the intro\n    const intro = this.intro;\n    if (intro && intro.shouldFire('intro')) {\n      intro.isIntro = true;\n      intro.isOutro = false;\n      runloop.registerTransition(intro);\n    }\n\n    if (this.fragment) {\n      const children = existing ? toArray(node.childNodes) : undefined;\n\n      this.fragment.render(node, children);\n\n      // clean up leftover children\n      if (children) {\n        children.forEach(detachNode);\n      }\n    }\n\n    if (existing) {\n      // store initial values for two-way binding\n      if (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n      // remove unused attributes\n      let i = node.attributes.length;\n      while (i--) {\n        const name = node.attributes[i].name;\n        if (!(name in this.attributeByName)) node.removeAttribute(name);\n      }\n    }\n\n    // Is this a top-level node of a component? If so, we may need to add\n    // a data-ractive-css attribute, for CSS encapsulation\n    if (this.up.cssIds) {\n      node.setAttribute('data-ractive-css', this.up.cssIds.map(x => `{${x}}`).join(' '));\n    }\n\n    if (this.attributes) this.attributes.forEach(render);\n    if (this.binding) this.binding.render();\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.addEventListener(k, handler, !!ls[k].refs);\n      }\n    }\n\n    if (!existing) {\n      target.appendChild(node);\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    const tagName = this.template.e;\n\n    let attrs = (this.attributes && this.attributes.map(stringifyAttribute).join('')) || '';\n\n    // Special case - selected options\n    if (this.name === 'option' && this.isSelected()) {\n      attrs += ' selected';\n    }\n\n    // Special case - two-way radio name bindings\n    if (this.name === 'input' && inputIsCheckedRadio(this)) {\n      attrs += ' checked';\n    }\n\n    // Special case style and class attributes and directives\n    let style, cls;\n    this.attributes &&\n      this.attributes.forEach(attr => {\n        if (attr.name === 'class') {\n          cls = (cls || '') + (cls ? ' ' : '') + safeAttributeString(attr.getString());\n        } else if (attr.name === 'style') {\n          style = (style || '') + (style ? ' ' : '') + safeAttributeString(attr.getString());\n          if (style && !endsWithSemi.test(style)) style += ';';\n        } else if (attr.style) {\n          style =\n            (style || '') +\n            (style ? ' ' : '') +\n            `${attr.style}: ${safeAttributeString(attr.getString())};`;\n        } else if (attr.inlineClass && attr.getValue()) {\n          cls = (cls || '') + (cls ? ' ' : '') + attr.inlineClass;\n        }\n      });\n    // put classes first, then inline style\n    if (style !== undefined) attrs = ' style' + (style ? `=\"${style}\"` : '') + attrs;\n    if (cls !== undefined) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n    if (this.up.cssIds) {\n      attrs += ` data-ractive-css=\"${this.up.cssIds.map(x => `{${x}}`).join(' ')}\"`;\n    }\n\n    let str = `<${tagName}${attrs}>`;\n\n    if (voidElementNames.test(this.name)) return str;\n\n    // Special case - textarea\n    if (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n      str += escapeHtml(this.getAttribute('value'));\n    } else if (this.getAttribute('contenteditable') !== undefined) {\n      // Special case - contenteditable\n      str += this.getAttribute('value') || '';\n    }\n\n    if (this.fragment) {\n      str += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n    }\n\n    str += `</${tagName}>`;\n    return str;\n  }\n\n  unbind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.unbinding = true;\n      attrs.forEach(unbind);\n      attrs.unbinding = false;\n    }\n\n    if (this.binding) this.binding.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (!this.rendered) return;\n    this.rendered = false;\n\n    // unrendering before intro completed? complete it now\n    // TODO should be an API for aborting transitions\n    const transition = this.intro;\n    if (transition && transition.complete) transition.complete();\n\n    // Detach as soon as we can\n    if (this.name === 'option') {\n      // <option> elements detach immediately, so that\n      // their parent <select> element syncs correctly, and\n      // since option elements can't have transitions anyway\n      this.detach();\n    } else if (shouldDestroy) {\n      runloop.detachWhenReady(this);\n    }\n\n    // outro transition\n    const outro = this.outro;\n    if (outro && outro.shouldFire('outro')) {\n      outro.isIntro = false;\n      outro.isOutro = true;\n      runloop.registerTransition(outro);\n    }\n\n    if (this.fragment) this.fragment.unrender();\n\n    if (this.binding) this.binding.unrender();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      this.attributes && this.attributes.forEach(update);\n\n      if (this.fragment) this.fragment.update();\n    }\n  }\n}\n\nfunction inputIsCheckedRadio(element) {\n  const nameAttr = element.attributeByName.name;\n  return (\n    element.getAttribute('type') === 'radio' &&\n    (nameAttr || {}).interpolator &&\n    element.getAttribute('value') === nameAttr.interpolator.model.get()\n  );\n}\n\nfunction stringifyAttribute(attribute) {\n  const str = attribute.toString();\n  return str ? ' ' + str : '';\n}\n\nfunction getNamespace(element) {\n  // Use specified namespace...\n  const xmlns = element.getAttribute('xmlns');\n  if (xmlns) return xmlns;\n\n  // ...or SVG namespace, if this is an <svg> element\n  if (element.name === 'svg') return svg;\n\n  const parent = element.parent;\n\n  if (parent) {\n    // ...or HTML, if the parent is a <foreignObject>\n    if (parent.name === 'foreignobject') return html;\n\n    // ...or inherit from the parent node\n    return parent.node.namespaceURI;\n  }\n\n  return element.ractive.el.namespaceURI;\n}\n\nfunction delegateHandler(ev) {\n  const name = ev.type;\n  const end = ev.currentTarget;\n  const endEl = end._ractive && end._ractive.proxy;\n  let node = ev.target;\n  let bubble = true;\n  let listeners;\n\n  // starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n  while (bubble && node && node !== end) {\n    const proxy = node._ractive && node._ractive.proxy;\n    if (proxy && proxy.up.delegate === endEl && shouldFire(ev, node, end)) {\n      listeners = proxy.listeners && proxy.listeners[name];\n\n      if (listeners) {\n        listeners.forEach(l => {\n          bubble = l.call(node, ev) !== false && bubble;\n        });\n      }\n    }\n\n    node = node.parentNode || node.correspondingUseElement; // SVG with a <use> element in certain environments\n  }\n\n  return bubble;\n}\n\nconst UIEvent = win !== null ? win.UIEvent : null;\nfunction shouldFire(event, start, end) {\n  if (UIEvent && event instanceof UIEvent) {\n    let node = start;\n    while (node && node !== end) {\n      if (node.disabled) return false;\n      node = node.parentNode || node.correspondingUseElement;\n    }\n  }\n\n  return true;\n}\n\nfunction handler(ev) {\n  const el = this._ractive.proxy;\n  if (!el.listeners || !el.listeners[ev.type]) return;\n  el.listeners[ev.type].forEach(l => l.call(this, ev));\n}\n","import runloop from 'src/global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n  constructor(options) {\n    super(options);\n    this.formBindings = [];\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.on('reset', handleReset);\n  }\n\n  unrender(shouldDestroy) {\n    this.off('reset', handleReset);\n    super.unrender(shouldDestroy);\n  }\n}\n\nfunction handleReset() {\n  const element = this._ractive.proxy;\n\n  runloop.start();\n  element.formBindings.forEach(updateModel);\n  runloop.end();\n}\n\nfunction updateModel(binding) {\n  binding.model.set(binding.resetValue);\n}\n","import { fatal } from 'utils/log';\nimport runloop from 'src/global/runloop';\nimport { win } from 'config/environment';\n\n// because IE\nconst whitelist = {\n  animationend: 1,\n  animationiteration: 1,\n  animationstart: 1,\n  transitioncancel: 1,\n  transitionend: 1,\n  transitionstart: 1,\n  transitionrun: 1\n};\n\nclass DOMEvent {\n  constructor(name, owner) {\n    if (name.indexOf('*') !== -1) {\n      fatal(\n        `Only component proxy-events may contain \"*\" wildcards, <${\n          owner.name\n        } on-${name}=\"...\"/> is not valid`\n      );\n    }\n\n    this.name = name;\n    this.owner = owner;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    // schedule events so that they take place after twoway binding\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n      const name = this.name;\n      const on = `on${name}`;\n\n      // this is probably a custom event fired from a decorator or manually\n      if (!(on in node) && !(on in win) && !whitelist[name]) return;\n\n      this.owner.on(\n        name,\n        (this.handler = event => {\n          return directive.fire({\n            node,\n            original: event,\n            event,\n            name\n          });\n        })\n      );\n    }, true);\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.owner.off(this.name, this.handler);\n  }\n}\n\nclass CustomEvent {\n  constructor(eventPlugin, owner, name, args) {\n    this.eventPlugin = eventPlugin;\n    this.owner = owner;\n    this.name = name;\n    this.handler = null;\n    this.args = args;\n  }\n\n  bind() {}\n\n  render(directive) {\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n\n      this.handler = this.eventPlugin.apply(\n        this.owner.ractive,\n        [\n          node,\n          (event = {}) => {\n            if (event.original) event.event = event.original;\n            else event.original = event.event;\n\n            event.name = this.name;\n            event.node = event.node || node;\n            return directive.fire(event);\n          }\n        ].concat(this.args || [])\n      );\n    });\n  }\n\n  unbind() {}\n\n  unrender() {\n    this.handler.teardown();\n  }\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n  constructor(component, name) {\n    this.component = component;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind(directive) {\n    const ractive = this.component.instance;\n\n    this.handler = ractive.on(this.name, (...args) => {\n      // watch for reproxy\n      if (args[0] instanceof Context) {\n        const ctx = args.shift();\n        ctx.component = ractive;\n        directive.fire(ctx, args);\n      } else {\n        directive.fire({}, args);\n      }\n\n      // cancel bubbling\n      return false;\n    });\n  }\n\n  render() {}\n\n  unbind() {\n    this.handler.cancel();\n  }\n\n  unrender() {}\n}\n","import { ANCHOR, COMPONENT } from 'config/types';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport fireEvent from 'src/events/fireEvent';\nimport { splitKeypath } from 'shared/keypaths';\nimport { findInViewHierarchy } from 'shared/registry';\nimport findElement from './findElement';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport Context from 'src/shared/Context';\nimport { isArray, isString } from 'utils/is';\nimport getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up, true);\n    this.template = options.template;\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n    this.events = [];\n  }\n\n  bind() {\n    if (this.element.type === COMPONENT || this.element.type === ANCHOR) {\n      this.template.n.forEach(n => {\n        this.events.push(new RactiveEvent(this.element, n));\n      });\n    } else {\n      let args;\n      if ((args = this.template.a)) {\n        const rs = args.r.map(r => {\n          const model = resolveReference(this.up, r);\n          return model ? model.get() : undefined;\n        });\n        try {\n          args = getFunction(args.s, rs.length).apply(null, rs);\n        } catch (err) {\n          args = null;\n          warnIfDebug(\n            `Failed to compute args for event on-${this.template.n.join('- ')}: ${err.message ||\n              err}`\n          );\n        }\n      }\n\n      this.template.n.forEach(n => {\n        const fn = findInViewHierarchy('events', this.ractive, n);\n        if (fn) {\n          this.events.push(new CustomEvent(fn, this.element, n, args));\n        } else {\n          this.events.push(new DOMEvent(n, this.element));\n        }\n      });\n    }\n\n    // method calls\n    this.models = null;\n\n    addToArray(this.element.events || (this.element.events = []), this);\n\n    setupArgsFn(this, this.template);\n    if (!this.fn) this.action = this.template.f;\n\n    this.events.forEach(e => e.bind(this));\n  }\n\n  destroyed() {\n    this.events.forEach(e => e.unrender());\n  }\n\n  fire(event, args = []) {\n    const context =\n      event instanceof Context && event.refire ? event : this.element.getContext(event);\n\n    if (this.fn) {\n      const values = [];\n\n      const models = resolveArgs(this, this.template, this.up, {\n        specialRef(ref) {\n          const specialMatch = specialPattern.exec(ref);\n          if (specialMatch) {\n            // on-click=\"foo(event.node)\"\n            return {\n              special: specialMatch[1],\n              keys: specialMatch[2] ? splitKeypath(specialMatch[2].substr(1)) : []\n            };\n          }\n\n          const dollarMatch = dollarArgsPattern.exec(ref);\n          if (dollarMatch) {\n            // on-click=\"foo($1)\"\n            return {\n              special: 'arguments',\n              keys: [dollarMatch[1] - 1].concat(\n                dollarMatch[2] ? splitKeypath(dollarMatch[2].substr(1)) : []\n              )\n            };\n          }\n        }\n      });\n\n      if (models) {\n        models.forEach(model => {\n          if (!model) return values.push(undefined);\n\n          if (model.special) {\n            const which = model.special;\n            let obj;\n\n            if (which === '@node') {\n              obj = this.element.node;\n            } else if (which === '@event') {\n              obj = event && event.event;\n            } else if (which === 'event') {\n              warnOnceIfDebug(\n                `The event reference available to event directives is deprecated and should be replaced with @context and @event`\n              );\n              obj = context;\n            } else if (which === '@context') {\n              obj = context;\n            } else {\n              obj = args;\n            }\n\n            const keys = model.keys.slice();\n\n            while (obj && keys.length) obj = obj[keys.shift()];\n            return values.push(obj);\n          }\n\n          if (model.wrapper) {\n            return values.push(model.wrapperValue);\n          }\n\n          values.push(model.get());\n        });\n      }\n\n      // make event available as `this.event`\n      const ractive = this.ractive;\n      const oldEvent = ractive.event;\n\n      ractive.event = context;\n      const returned = this.fn.apply(ractive, values);\n      let result = returned.pop();\n\n      // Auto prevent and stop if return is explicitly false\n      if (result === false) {\n        const original = event ? event.original : undefined;\n        if (original) {\n          original.preventDefault && original.preventDefault();\n          original.stopPropagation && original.stopPropagation();\n        } else {\n          warnOnceIfDebug(\n            `handler '${this.template.n.join(\n              ' '\n            )}' returned false, but there is no event available to cancel`\n          );\n        }\n      } else if (!returned.length && isArray(result) && isString(result[0])) {\n        // watch for proxy events\n        result = fireEvent(this.ractive, result.shift(), context, result);\n      }\n\n      ractive.event = oldEvent;\n\n      return result;\n    } else {\n      return fireEvent(this.ractive, this.action, context, args);\n    }\n  }\n\n  handleChange() {}\n\n  render() {\n    this.events.forEach(e => e.render(this));\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    removeFromArray(this.element.events, this);\n    this.events.forEach(e => e.unbind());\n  }\n\n  unrender() {\n    this.events.forEach(e => e.unrender());\n  }\n}\n\nEventDirective.prototype.update = noop;\n","import { rebindMatch } from 'shared/rebind';\nimport Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { assign } from 'utils/object';\n\nexport default class Mustache extends Item {\n  constructor(options) {\n    super(options);\n\n    if (options.owner) this.parent = options.owner;\n\n    this.isStatic = !!options.template.s;\n\n    this.model = null;\n    this.dirty = false;\n  }\n\n  bind() {\n    // yield mustaches should resolve in container context\n    const start = this.containerFragment || this.up;\n    // try to find a model for this view\n    const model = resolve(start, this.template);\n\n    if (model) {\n      const value = model.get();\n\n      if (this.isStatic) {\n        this.model = { get: () => value };\n        model.unreference();\n        return;\n      }\n\n      model.register(this);\n      this.model = model;\n    }\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    next = rebindMatch(this.template, next, previous, this.up);\n    if (next === this.model) return false;\n\n    if (this.model) {\n      this.model.unregister(this);\n    }\n    if (next) next.addShuffleRegister(this, 'mark');\n    this.model = next;\n    if (!safe) this.handleChange();\n    return true;\n  }\n\n  unbind() {\n    if (!this.isStatic) {\n      this.model && this.model.unregister(this);\n      this.model = undefined;\n    }\n  }\n}\n\nexport function MustacheContainer(options) {\n  Mustache.call(this, options);\n}\n\nconst proto = (MustacheContainer.prototype = Object.create(ContainerItem.prototype));\n\nassign(proto, Mustache.prototype, { constructor: MustacheContainer });\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n  bubble() {\n    if (this.owner) this.owner.bubble();\n    super.bubble();\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getString() {\n    return this.model ? safeToStringValue(this.model.get()) : '';\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    const value = (this.value = this.getString());\n\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, value);\n  }\n\n  toString(escape) {\n    const string = this.getString();\n    return escape ? escapeHtml(string) : string;\n  }\n\n  unrender(shouldDestroy) {\n    if (shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.rendered) {\n        const value = this.getString();\n        if (value !== this.value) this.node.data = this.value = value;\n      }\n    }\n  }\n\n  valueOf() {\n    return this.model ? this.model.get() : undefined;\n  }\n}\n","import Element from '../../Element';\nimport { isFunction } from 'utils/is';\n\nexport default class Input extends Element {\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.node.defaultValue = this.node.value;\n  }\n  compare(value, attrValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(value, attrValue);\n      }\n      if (value && attrValue) {\n        return value[comparator] == attrValue[comparator];\n      }\n    }\n    return value == attrValue;\n  }\n}\n","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\nimport { hasOwn, keys } from 'utils/object';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n  true: true,\n  false: false,\n  null: null,\n  undefined\n};\n\nconst specialsPattern = new RegExp('^(?:' + keys(specials).join('|') + ')');\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n  init(str, options) {\n    this.values = options.values;\n    this.sp();\n  },\n\n  postProcess(result) {\n    if (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n      return null;\n    }\n\n    return { value: result[0].v };\n  },\n\n  converters: [\n    function getPlaceholder(parser) {\n      if (!parser.values) return null;\n\n      const placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n      if (placeholder && hasOwn(parser.values, placeholder)) {\n        return { v: parser.values[placeholder] };\n      }\n    },\n\n    function getSpecial(parser) {\n      const special = parser.matchPattern(specialsPattern);\n      if (special) return { v: specials[special] };\n    },\n\n    function getNumber(parser) {\n      const number = parser.matchPattern(numberPattern);\n      if (number) return { v: +number };\n    },\n\n    function getString(parser) {\n      const stringLiteral = readStringLiteral(parser);\n      const values = parser.values;\n\n      if (stringLiteral && values) {\n        return {\n          v: stringLiteral.v.replace(\n            placeholderPattern,\n            (match, $1) => ($1 in values ? values[$1] : $1)\n          )\n        };\n      }\n\n      return stringLiteral;\n    },\n\n    function getObject(parser) {\n      if (!parser.matchString('{')) return null;\n\n      const result = {};\n\n      parser.sp();\n\n      if (parser.matchString('}')) {\n        return { v: result };\n      }\n\n      let pair;\n      while ((pair = getKeyValuePair(parser))) {\n        result[pair.key] = pair.value;\n\n        parser.sp();\n\n        if (parser.matchString('}')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n      }\n\n      return null;\n    },\n\n    function getArray(parser) {\n      if (!parser.matchString('[')) return null;\n\n      const result = [];\n\n      parser.sp();\n\n      if (parser.matchString(']')) {\n        return { v: result };\n      }\n\n      let valueToken;\n      while ((valueToken = parser.read())) {\n        result.push(valueToken.v);\n\n        parser.sp();\n\n        if (parser.matchString(']')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n\n        parser.sp();\n      }\n\n      return null;\n    }\n  ]\n});\n\nfunction getKeyValuePair(parser) {\n  parser.sp();\n\n  const key = readKey(parser);\n\n  if (!key) return null;\n\n  const pair = { key };\n\n  parser.sp();\n  if (!parser.matchString(':')) {\n    return null;\n  }\n  parser.sp();\n\n  const valueToken = parser.read();\n\n  if (!valueToken) return null;\n\n  pair.value = valueToken.v;\n  return pair;\n}\n\nexport default function(str, values) {\n  const parser = new JsonParser(str, { values });\n  return parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isArray, isObjectType, isString } from 'utils/is';\n\nexport default class Mapping extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = this.element.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.element.attributeByName[this.name] = this;\n\n    this.value = options.template.f;\n  }\n\n  bind() {\n    const template = this.template.f;\n    const viewmodel = this.element.instance.viewmodel;\n\n    if (template === 0) {\n      // empty attributes are `true`\n      viewmodel.joinKey(this.name).set(true);\n    } else if (isString(template)) {\n      const parsed = parseJSON(template);\n      viewmodel.joinKey(this.name).set(parsed ? parsed.value : template);\n    } else if (isArray(template)) {\n      createMapping(this, true);\n    }\n  }\n\n  render() {}\n\n  unbind() {\n    if (this.model) this.model.unregister(this);\n    if (this.boundFragment) this.boundFragment.unbind();\n\n    if (this.element.bound) {\n      if (this.link.target === this.model) this.link.owner.unlink();\n    }\n  }\n\n  unrender() {}\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.boundFragment) this.boundFragment.update();\n    }\n  }\n}\n\nfunction createMapping(item) {\n  const template = item.template.f;\n  const viewmodel = item.element.instance.viewmodel;\n  const childData = viewmodel.value;\n\n  if (template.length === 1 && template[0].t === INTERPOLATOR) {\n    const model = resolve(item.up, template[0]);\n    const val = model.get(false);\n\n    // if the interpolator is not static\n    if (!template[0].s) {\n      item.model = model;\n      item.link = viewmodel.createLink(item.name, model, template[0].r, {\n        mapping: true\n      });\n\n      // initialize parent side of the mapping from child data\n      if (val === undefined && !model.isReadonly && item.name in childData) {\n        model.set(childData[item.name]);\n      }\n    } else if (!isObjectType(val) || template[0].x) {\n      // copy non-object, non-computed vals through\n      viewmodel.joinKey(splitKeypath(item.name)).set(val);\n    } else {\n      // warn about trying to copy an object\n      warnIfDebug(`Cannot copy non-computed object value from static mapping '${item.name}'`);\n    }\n\n    // if the item isn't going to manage the model, give it a change to tear down if it's computed\n    if (model !== item.model) model.unregister();\n  } else {\n    item.boundFragment = new Fragment({\n      owner: item,\n      template\n    }).bind();\n\n    item.model = viewmodel.joinKey(splitKeypath(item.name));\n    item.model.set(item.boundFragment.valueOf());\n\n    // item is a *bit* of a hack\n    item.boundFragment.bubble = () => {\n      Fragment.prototype.bubble.call(item.boundFragment);\n      // defer this to avoid mucking around model deps if there happens to be an expression involved\n      runloop.scheduleTask(() => {\n        item.boundFragment.update();\n        item.model.set(item.boundFragment.valueOf());\n      });\n    };\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Element from '../../Element';\nimport findElement from '../../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class Option extends Element {\n  constructor(options) {\n    const template = options.template;\n    if (!template.a) template.a = {};\n\n    // If the value attribute is missing, use the element's content,\n    // as long as it isn't disabled\n    if (template.a.value === undefined && !('disabled' in template.a)) {\n      template.a.value = template.f || '';\n    }\n\n    super(options);\n\n    this.select = findElement(this.parent || this.up, false, 'select');\n  }\n\n  bind() {\n    if (!this.select) {\n      super.bind();\n      return;\n    }\n\n    // If the select has a value, it overrides the `selected` attribute on\n    // this option - so we delete the attribute\n    const selectedAttribute = this.attributeByName.selected;\n    if (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n      const index = this.attributes.indexOf(selectedAttribute);\n      this.attributes.splice(index, 1);\n      delete this.attributeByName.selected;\n    }\n\n    super.bind();\n    this.select.options.push(this);\n  }\n\n  bubble() {\n    // if we're using content as value, may need to update here\n    const value = this.getAttribute('value');\n    if (this.node && this.node.value !== value) {\n      this.node._ractive.value = value;\n    }\n    super.bubble();\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute\n      ? attribute.getValue()\n      : name === 'value' && this.fragment ? this.fragment.valueOf() : undefined;\n  }\n\n  isSelected() {\n    const optionValue = this.getAttribute('value');\n\n    if (optionValue === undefined || !this.select) {\n      return false;\n    }\n\n    const selectValue = this.select.getAttribute('value');\n\n    if (this.select.compare(selectValue, optionValue)) {\n      return true;\n    }\n\n    if (this.select.getAttribute('multiple') && isArray(selectValue)) {\n      let i = selectValue.length;\n      while (i--) {\n        if (this.select.compare(selectValue[i], optionValue)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n\n    if (!this.attributeByName.value) {\n      this.node._ractive.value = this.getAttribute('value');\n    }\n  }\n\n  unbind() {\n    super.unbind();\n\n    if (this.select) {\n      removeFromArray(this.select.options, this);\n    }\n  }\n}\n","import { ELEMENT, PARTIAL, SECTION, SECTION_WITH, YIELDER } from 'config/types';\nimport { assign, create, hasOwn, keys } from 'utils/object';\nimport { isArray, isFunction, isObjectType, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport { resolveAliases } from './Alias';\nimport { warnOnceIfDebug, warnIfDebug } from 'utils/log';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport runloop from 'src/global/runloop';\nimport { applyCSS } from 'src/global/css';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Partial(options) {\n  MustacheContainer.call(this, options);\n\n  const tpl = options.template;\n\n  // yielder is a special form of partial that will later require special handling\n  if (tpl.t === YIELDER) {\n    this.yielder = 1;\n  } else if (tpl.t === ELEMENT) {\n    // this is a macro partial, complete with macro constructor\n    // leaving this as an element will confuse up-template searches\n    this.type = PARTIAL;\n    this.macro = options.macro;\n  }\n}\n\nconst proto = (Partial.prototype = create(MustacheContainer.prototype));\n\nassign(proto, {\n  constructor: Partial,\n\n  bind() {\n    const template = this.template;\n\n    if (this.yielder) {\n      // the container is the instance that owns this node\n      this.container = this.up.ractive;\n      this.component = this.container.component;\n      this.containerFragment = this.up;\n\n      // normal component\n      if (this.component) {\n        // yields skip the owning instance and go straight to the surrounding context\n        this.up = this.component.up;\n\n        // {{yield}} is equivalent to {{yield content}}\n        if (!template.r && !template.x && !template.tx) this.refName = 'content';\n      } else {\n        // plain-ish instance that may be attached to a parent later\n        this.fragment = new Fragment({\n          owner: this,\n          template: []\n        });\n        this.fragment.bind();\n        return;\n      }\n    }\n\n    // this is a macro/super partial\n    if (this.macro) {\n      this.fn = this.macro;\n    } else {\n      // this is a plain partial or yielder\n      if (!this.refName) this.refName = template.r;\n\n      // if the refName exists as a partial, this is a plain old partial reference where no model binding will happen\n      if (this.refName) {\n        partialFromValue(this, this.refName);\n      }\n\n      // this is a dynamic/inline partial\n      if (!this.partial && !this.fn) {\n        MustacheContainer.prototype.bind.call(this);\n        if (this.model) partialFromValue(this, this.model.get());\n      }\n    }\n\n    if (!this.partial && !this.fn) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    createFragment(this, this.partial || []);\n\n    // macro/super partial\n    if (this.fn) initMacro(this);\n\n    this.fragment.bind();\n  },\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.yielder) {\n        this.containerFragment.bubble();\n      } else {\n        this.up.bubble();\n      }\n    }\n  },\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  },\n\n  handleChange() {\n    this.dirtyTemplate = true;\n    this.externalChange = true;\n    this.bubble();\n  },\n\n  refreshAttrs() {\n    keys(this._attrs).forEach(k => {\n      this.handle.attributes[k] = this._attrs[k].valueOf();\n    });\n  },\n\n  resetTemplate() {\n    if (this.fn && this.proxy) {\n      if (this.externalChange) {\n        if (isFunction(this.proxy.teardown)) this.proxy.teardown();\n        this.fn = this.proxy = null;\n      } else {\n        this.partial = this.fnTemplate;\n        return true;\n      }\n    }\n\n    const partial = this.partial;\n    this.partial = null;\n\n    if (this.refName) {\n      this.partial = getPartialTemplate(this.ractive, this.refName, this.up);\n    }\n\n    if (!this.partial && this.model) {\n      partialFromValue(this, this.model.get());\n    }\n\n    if (!this.fn && partial === this.partial) return false;\n\n    this.unbindAttrs();\n\n    if (this.fn) {\n      initMacro(this);\n      if (isFunction(this.proxy.render)) runloop.scheduleTask(() => this.proxy.render());\n    } else if (!this.partial) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    return true;\n  },\n\n  render(target, occupants) {\n    if (this.fn && this.fn._cssDef && !this.fn._cssDef.applied) applyCSS();\n\n    this.fragment.render(target, occupants);\n\n    if (this.proxy && isFunction(this.proxy.render)) this.proxy.render();\n  },\n\n  unbind() {\n    this.fragment.unbind();\n\n    this.fragment.aliases = null;\n\n    this.unbindAttrs();\n\n    MustacheContainer.prototype.unbind.call(this);\n  },\n\n  unbindAttrs() {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => {\n        this._attrs[k].unbind();\n      });\n    }\n  },\n\n  unrender(shouldDestroy) {\n    if (this.proxy && isFunction(this.proxy.teardown)) this.proxy.teardown();\n\n    this.fragment.unrender(shouldDestroy);\n  },\n\n  update() {\n    const proxy = this.proxy;\n    this.updating = 1;\n\n    if (this.dirtyAttrs) {\n      this.dirtyAttrs = false;\n      keys(this._attrs).forEach(k => this._attrs[k].update());\n      this.refreshAttrs();\n      if (isFunction(proxy.update)) proxy.update(this.handle.attributes);\n    }\n\n    if (this.dirtyTemplate) {\n      this.dirtyTemplate = false;\n      this.resetTemplate() && this.fragment.resetTemplate(this.partial || []);\n    }\n\n    if (this.dirty) {\n      this.dirty = false;\n      if (proxy && isFunction(proxy.invalidate)) proxy.invalidate();\n      this.fragment.update();\n    }\n\n    this.externalChange = false;\n    this.updating = 0;\n  }\n});\n\nfunction createFragment(self, partial) {\n  self.partial = partial;\n  contextifyTemplate(self);\n\n  const options = {\n    owner: self,\n    template: self.partial\n  };\n\n  if (self.yielder) options.ractive = self.container.parent;\n\n  if (self.fn) options.cssIds = self.fn._cssIds;\n\n  const fragment = (self.fragment = new Fragment(options));\n\n  // partials may have aliases that need to be in place before binding\n  if (self.template.z) {\n    fragment.aliases = resolveAliases(self.template.z, self.containerFragment || self.up);\n  }\n}\n\nfunction contextifyTemplate(self) {\n  if (self.template.c) {\n    self.partial = [{ t: SECTION, n: SECTION_WITH, f: self.partial }];\n    assign(self.partial[0], self.template.c);\n  }\n}\n\nfunction partialFromValue(self, value, okToParse) {\n  let tpl = value;\n\n  if (isArray(tpl)) {\n    self.partial = tpl;\n  } else if (tpl && isObjectType(tpl)) {\n    if (isArray(tpl.t)) self.partial = tpl.t;\n    else if (isString(tpl.template))\n      self.partial = parsePartial(tpl.template, tpl.template, self.ractive).t;\n  } else if (isFunction(tpl) && tpl.styleSet) {\n    self.fn = tpl;\n    if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n  } else if (tpl != null) {\n    tpl = getPartialTemplate(self.ractive, '' + tpl, self.containerFragment || self.up);\n    if (tpl) {\n      self.name = value;\n      if (tpl.styleSet) {\n        self.fn = tpl;\n        if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n      } else self.partial = tpl;\n    } else if (okToParse) {\n      self.partial = parsePartial('' + value, '' + value, self.ractive).t;\n    } else {\n      self.name = value;\n    }\n  }\n\n  return self.partial;\n}\n\nfunction setTemplate(template) {\n  partialFromValue(this, template, true);\n\n  if (!this.initing) {\n    this.dirtyTemplate = true;\n    this.fnTemplate = this.partial;\n\n    if (this.updating) {\n      this.bubble();\n      runloop.promise();\n    } else {\n      const promise = runloop.start();\n\n      this.bubble();\n      runloop.end();\n\n      return promise;\n    }\n  }\n}\n\nfunction aliasLocal(ref, name) {\n  const aliases = this.fragment.aliases || (this.fragment.aliases = {});\n  if (!name) {\n    aliases[ref] = this._data;\n  } else {\n    aliases[name] = this._data.joinAll(splitKeypath(ref));\n  }\n}\n\nconst extras = 'extra-attributes';\n\nfunction initMacro(self) {\n  const fn = self.fn;\n  const fragment = self.fragment;\n\n  // defensively copy the template in case it changes\n  const template = (self.template = assign({}, self.template));\n  const handle = (self.handle = fragment.getContext({\n    proxy: self,\n    aliasLocal,\n    name: self.template.e || self.name,\n    attributes: {},\n    setTemplate: setTemplate.bind(self),\n    template\n  }));\n\n  if (!template.p) template.p = {};\n  template.p = handle.partials = assign({}, template.p);\n  if (!hasOwn(template.p, 'content')) template.p.content = template.f || [];\n\n  if (isArray(fn.attributes)) {\n    self._attrs = {};\n\n    const invalidate = function() {\n      this.dirty = true;\n      self.dirtyAttrs = true;\n      self.bubble();\n    };\n\n    if (isArray(template.m)) {\n      const attrs = template.m;\n      template.p[extras] = template.m = attrs.filter(a => !~fn.attributes.indexOf(a.n));\n      attrs.filter(a => ~fn.attributes.indexOf(a.n)).forEach(a => {\n        const fragment = new Fragment({\n          template: a.f,\n          owner: self\n        });\n        fragment.bubble = invalidate;\n        fragment.findFirstNode = noop;\n        self._attrs[a.n] = fragment;\n      });\n    } else {\n      template.p[extras] = [];\n    }\n  } else {\n    template.p[extras] = template.m;\n  }\n\n  if (self._attrs) {\n    keys(self._attrs).forEach(k => {\n      self._attrs[k].bind();\n    });\n    self.refreshAttrs();\n  }\n\n  self.initing = 1;\n  self.proxy = fn(handle, handle.attributes) || {};\n  if (!self.partial) self.partial = [];\n  self.fnTemplate = self.partial;\n  self.initing = 0;\n\n  contextifyTemplate(self);\n  fragment.resetTemplate(self.partial);\n}\n\nfunction parsePartial(name, partial, ractive) {\n  let parsed;\n\n  try {\n    parsed = parser.parse(partial, parser.getParseOptions(ractive));\n  } catch (e) {\n    warnIfDebug(`Could not parse partial from expression '${name}'\\n${e.message}`);\n  }\n\n  return parsed || { t: [] };\n}\n","import { addToArray, removeFromArray } from 'utils/array';\nimport { unescapeKey } from 'shared/keypaths';\nimport { capture } from 'src/global/capture';\nimport { handleChange } from 'src/shared/methodCallers';\nimport noop from 'utils/noop';\n\nexport default class KeyModel {\n  constructor(key) {\n    this.value = key;\n    this.isReadonly = this.isKey = true;\n    this.deps = [];\n    this.links = [];\n  }\n\n  applyValue(value) {\n    if (value !== this.value) {\n      this.value = this.key = value;\n      this.deps.forEach(handleChange);\n      this.links.forEach(handleChange);\n    }\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return unescapeKey(this.value);\n  }\n\n  getKeypath() {\n    return unescapeKey(this.value);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebind(next, previous) {\n    let i = this.deps.length;\n    while (i--) this.deps[i].rebind(next, previous, false);\n\n    i = this.links.length;\n    while (i--) this.links[i].relinking(next, false);\n  }\n\n  register(dependant) {\n    this.deps.push(dependant);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  unregister(dependant) {\n    removeFromArray(this.deps, dependant);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { escapeKey } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport { isArray, isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { create, keys } from 'utils/object';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n  constructor(ractive, baseModel, keys, callback, options) {\n    this.context = options.context || ractive;\n    this.ractive = ractive;\n    this.baseModel = baseModel;\n    this.keys = keys;\n    this.callback = callback;\n\n    const pattern = keys.join('\\\\.').replace(star, '(.+)');\n    const baseKeypath = (this.baseKeypath = baseModel.getKeypath(ractive));\n    this.pattern = new RegExp(`^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$`);\n    this.recursive = keys.length === 1 && keys[0] === '**';\n    if (this.recursive) this.keys = ['*'];\n    if (options.old) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    this.oldValues = {};\n    this.newValues = {};\n\n    this.defer = options.defer;\n    this.once = options.once;\n    this.strict = options.strict;\n\n    this.dirty = false;\n    this.changed = [];\n    this.partial = false;\n    this.links = options.links;\n\n    const models = baseModel.findMatches(this.keys);\n\n    models.forEach(model => {\n      this.newValues[model.getKeypath(this.ractive)] = model.get();\n    });\n\n    if (options.init !== false) {\n      this.dispatch();\n    } else {\n      updateOld(this, this.newValues);\n    }\n\n    baseModel.registerPatternObserver(this);\n  }\n\n  cancel() {\n    this.baseModel.unregisterPatternObserver(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    const newValues = this.newValues;\n    this.newValues = {};\n    keys(newValues).forEach(keypath => {\n      const newValue = newValues[keypath];\n      const oldValue = this.oldValues[keypath];\n\n      if (this.strict && newValue === oldValue) return;\n      if (isEqual(newValue, oldValue)) return;\n\n      let args = [newValue, oldValue, keypath];\n      if (keypath) {\n        const wildcards = this.pattern.exec(keypath);\n        if (wildcards) {\n          args = args.concat(wildcards.slice(1));\n        }\n      }\n\n      this.callback.apply(this.context, args);\n    });\n\n    updateOld(this, newValues, this.partial);\n\n    this.dirty = false;\n  }\n\n  notify(key) {\n    this.changed.push(key);\n  }\n\n  shuffle(newIndices) {\n    if (!isArray(this.baseModel.value)) return;\n\n    const max = this.baseModel.value.length;\n\n    for (let i = 0; i < newIndices.length; i++) {\n      if (newIndices[i] === -1 || newIndices[i] === i) continue;\n      this.changed.push([i]);\n    }\n\n    for (let i = newIndices.touchedFrom; i < max; i++) {\n      this.changed.push([i]);\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty || this.changed.length) {\n      if (!this.dirty) this.newValues = {};\n\n      if (!this.changed.length) {\n        this.baseModel.findMatches(this.keys).forEach(model => {\n          const keypath = model.getKeypath(this.ractive);\n          this.newValues[keypath] = model.get();\n        });\n        this.partial = false;\n      } else {\n        let count = 0;\n\n        if (this.recursive) {\n          this.changed.forEach(keys => {\n            const model = this.baseModel.joinAll(keys);\n            if (model.isLink && !this.links) return;\n            count++;\n            this.newValues[model.getKeypath(this.ractive)] = model.get();\n          });\n        } else {\n          const ok = this.baseModel.isRoot\n            ? this.changed.map(keys => keys.map(escapeKey).join('.'))\n            : this.changed.map(keys => this.baseKeypath + '.' + keys.map(escapeKey).join('.'));\n\n          this.baseModel.findMatches(this.keys).forEach(model => {\n            const keypath = model.getKeypath(this.ractive);\n            const check = k => {\n              return (\n                (k.indexOf(keypath) === 0 &&\n                  (k.length === keypath.length || k[keypath.length] === '.')) ||\n                (keypath.indexOf(k) === 0 &&\n                  (k.length === keypath.length || keypath[k.length] === '.'))\n              );\n            };\n\n            // is this model on a changed keypath?\n            if (ok.filter(check).length) {\n              count++;\n              this.newValues[keypath] = model.get();\n            }\n          });\n        }\n\n        // no valid change triggered, so bail to avoid breakage\n        if (!count) return;\n\n        this.partial = true;\n      }\n\n      runloop.addObserver(this, this.defer);\n      this.dirty = true;\n      this.changed.length = 0;\n\n      if (this.once) this.cancel();\n    }\n  }\n}\n\nfunction updateOld(observer, vals, partial) {\n  const olds = observer.oldValues;\n\n  if (observer.oldFn) {\n    if (!partial) observer.oldValues = {};\n\n    keys(vals).forEach(k => {\n      const args = [olds[k], vals[k], k];\n      const parts = observer.pattern.exec(k);\n      if (parts) {\n        args.push.apply(args, parts.slice(1));\n      }\n      observer.oldValues[k] = observer.oldFn.apply(observer.oldContext, args);\n    });\n  } else {\n    if (partial) {\n      keys(vals).forEach(k => (olds[k] = vals[k]));\n    } else {\n      observer.oldValues = vals;\n    }\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nfunction negativeOne() {\n  return -1;\n}\n\nexport default class ArrayObserver {\n  constructor(ractive, model, callback, options) {\n    this.ractive = ractive;\n    this.model = model;\n    this.keypath = model.getKeypath();\n    this.callback = callback;\n    this.options = options;\n\n    this.pending = null;\n\n    model.register(this);\n\n    if (options.init !== false) {\n      this.sliced = [];\n      this.shuffle([]);\n      this.dispatch();\n    } else {\n      this.sliced = this.slice();\n    }\n  }\n\n  cancel() {\n    this.model.unregister(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    this.callback(this.pending);\n    this.pending = null;\n    if (this.options.once) this.cancel();\n  }\n\n  handleChange(path) {\n    if (this.pending) {\n      // post-shuffle\n      runloop.addObserver(this, this.options.defer);\n    } else if (!path) {\n      // entire array changed\n      this.shuffle(this.sliced.map(negativeOne));\n      this.handleChange();\n    }\n  }\n\n  shuffle(newIndices) {\n    const newValue = this.slice();\n\n    const inserted = [];\n    const deleted = [];\n    let start;\n\n    const hadIndex = {};\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      hadIndex[newIndex] = true;\n\n      if (newIndex !== oldIndex && start === undefined) {\n        start = oldIndex;\n      }\n\n      if (newIndex === -1) {\n        deleted.push(this.sliced[oldIndex]);\n      }\n    });\n\n    if (start === undefined) start = newIndices.length;\n\n    const len = newValue.length;\n    for (let i = 0; i < len; i += 1) {\n      if (!hadIndex[i]) inserted.push(newValue[i]);\n    }\n\n    this.pending = { inserted, deleted, start };\n    this.sliced = newValue;\n  }\n\n  slice() {\n    const value = this.model.get();\n    return isArray(value) ? value.slice() : [];\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { assign } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce(keypath, callback, options) {\n  if (isObject(keypath) || isFunction(keypath)) {\n    options = assign(callback || {}, onceOptions);\n    return this.observe(keypath, options);\n  }\n\n  options = assign(options || {}, onceOptions);\n  return this.observe(keypath, callback, options);\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('pop').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('push').path;\n","import { doc } from '../config/environment';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\nexport function addCSS(styleDefinition) {\n  styleDefinitions.push(styleDefinition);\n  isDirty = true;\n}\n\nexport function applyCSS(force) {\n  const styleElement = style();\n\n  // Apply only seems to make sense when we're in the DOM. Server-side renders\n  // can call toCSS to get the updated CSS.\n  if (!styleElement || (!force && !isDirty)) return;\n\n  if (useCssText) {\n    styleElement.styleSheet.cssText = getCSS(null);\n  } else {\n    styleElement.innerHTML = getCSS(null);\n  }\n\n  isDirty = false;\n}\n\nexport function getCSS(cssIds) {\n  const filteredStyleDefinitions = cssIds\n    ? styleDefinitions.filter(style => ~cssIds.indexOf(style.id))\n    : styleDefinitions;\n\n  filteredStyleDefinitions.forEach(d => (d.applied = true));\n\n  return filteredStyleDefinitions.reduce(\n    (styles, style) => `${styles ? `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}` : ''}`,\n    PREFIX\n  );\n}\n\nfunction style() {\n  // If we're on the browser, additional setup needed.\n  if (doc && !styleElement) {\n    styleElement = doc.createElement('style');\n    styleElement.type = 'text/css';\n    styleElement.setAttribute('data-ractive-css', '');\n\n    doc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n    useCssText = !!styleElement.styleSheet;\n  }\n\n  return styleElement;\n}\n","import { ensureArray, combine } from 'utils/array';\n\nexport default {\n  extend: (Parent, proto, options) => {\n    proto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  },\n\n  init() {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function(css, callback, additionalReplaceRules = []) {\n  const values = [];\n  const reconstruct = css => css.replace(value, (match, n) => values[n]);\n  css = css.replace(escape, match => `\\0${values.push(match) - 1}`).replace(remove, '');\n\n  additionalReplaceRules.forEach(pattern => {\n    css = css.replace(pattern, match => `\\0${values.push(match) - 1}`);\n  });\n\n  return callback(css, reconstruct);\n}\n","import cleanCss from 'utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{)\\s*([^\\{\\}\\0]+)\\s*(?=\\{)/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim(str) {\n  return str.trim();\n}\n\nfunction extractString(unit) {\n  return unit.str;\n}\n\nfunction transformSelector(selector, parent) {\n  const selectorUnits = [];\n  let match;\n\n  while ((match = selectorUnitPattern.exec(selector))) {\n    selectorUnits.push({\n      str: match[0],\n      base: match[1],\n      modifiers: match[2]\n    });\n  }\n\n  // For each simple selector within the selector, we need to create a version\n  // that a) combines with the id, and b) is inside the id\n  const base = selectorUnits.map(extractString);\n\n  const transformed = [];\n  let i = selectorUnits.length;\n\n  while (i--) {\n    const appended = base.slice();\n\n    // Pseudo-selectors should go after the attribute selector\n    const unit = selectorUnits[i];\n    appended[i] = unit.base + parent + unit.modifiers || '';\n\n    const prepended = base.slice();\n    prepended[i] = parent + ' ' + prepended[i];\n\n    transformed.push(appended.join(' '), prepended.join(' '));\n  }\n\n  return transformed.join(', ');\n}\n\nexport default function transformCss(css, id) {\n  const dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n  let transformed;\n\n  if (dataRvcGuidPattern.test(css)) {\n    transformed = css.replace(dataRvcGuidPattern, dataAttr);\n  } else {\n    transformed = cleanCss(\n      css,\n      (css, reconstruct) => {\n        css = css.replace(selectorsPattern, (match, $1) => {\n          // don't transform at-rules and keyframe declarations\n          if (excludePattern.test($1)) return match;\n\n          const selectors = $1.split(',').map(trim);\n          const transformed =\n            selectors.map(selector => transformSelector(selector, dataAttr)).join(', ') + ' ';\n\n          return match.replace($1, transformed);\n        });\n\n        return reconstruct(css);\n      },\n      [keyframesDeclarationPattern]\n    );\n  }\n\n  return transformed;\n}\n","import { SharedModel } from './SharedModel';\nimport { applyChanges } from '../../Ractive/static/styleSet';\n\nexport default class CSSModel extends SharedModel {\n  constructor(component) {\n    super(component.cssData, '@style');\n    this.component = component;\n  }\n\n  downstreamChanged(path, depth) {\n    if (this.locked) return;\n\n    const component = this.component;\n\n    component.extensions.forEach(e => {\n      const model = e._cssModel;\n      model.mark();\n      model.downstreamChanged(path, depth || 1);\n    });\n\n    if (!depth) {\n      applyChanges(component, true);\n    }\n  }\n}\n","import { addCSS } from 'src/global/css';\nimport transformCss from './transform';\nimport { uuid } from 'utils/id';\nimport { warnIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { splitKeypath } from 'shared/keypaths';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperty } from 'utils/object';\nimport { isString, isFunction, isObjectType } from 'utils/is';\n\nconst hasCurly = /\\{/;\nexport default {\n  name: 'css',\n\n  // Called when creating a new component definition\n  extend: (Parent, proto, options, Child) => {\n    Child._cssIds = gatherIds(Parent);\n\n    defineProperty(Child, 'cssData', {\n      configurable: true,\n      value: assign(create(Parent.cssData), options.cssData || {})\n    });\n\n    defineProperty(Child, '_cssModel', {\n      configurable: true,\n      value: new CSSModel(Child)\n    });\n\n    if (options.css) initCSS(options, Child, proto);\n  },\n\n  // Called when creating a new component instance\n  init: (Parent, target, options) => {\n    if (!options.css) return;\n\n    warnIfDebug(`\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t`);\n  }\n};\n\nfunction gatherIds(start) {\n  let cmp = start;\n  const ids = [];\n\n  while (cmp) {\n    if (cmp.prototype.cssId) ids.push(cmp.prototype.cssId);\n    cmp = cmp.Parent;\n  }\n\n  return ids;\n}\n\nexport function evalCSS(component, css) {\n  if (isString(css)) return css;\n\n  const cssData = component.cssData;\n  const model = component._cssModel;\n  const data = function data(path) {\n    return model.joinAll(splitKeypath(path)).get();\n  };\n  data.__proto__ = cssData;\n\n  const result = css.call(component, data);\n  return isString(result) ? result : '';\n}\n\nexport function initCSS(options, target, proto) {\n  let css =\n    isString(options.css) && !hasCurly.test(options.css)\n      ? getElement(options.css) || options.css\n      : options.css;\n  let cssProp = css;\n\n  const id = options.cssId || uuid();\n\n  if (isObjectType(css)) {\n    css = 'textContent' in css ? css.textContent : css.innerHTML;\n    cssProp = css;\n  } else if (isFunction(css)) {\n    cssProp = css;\n    css = evalCSS(target, css);\n  }\n\n  const def = (target._cssDef = { transform: !options.noCssTransform });\n\n  defineProperty(target, 'css', {\n    get() {\n      return cssProp;\n    },\n    set(next) {\n      cssProp = next;\n      const css = evalCSS(target, cssProp);\n      def.styles = def.transform ? transformCss(css, id) : css;\n    }\n  });\n\n  def.styles = def.transform ? transformCss(css, id) : css;\n  def.id = proto.cssId = id;\n  target._cssIds.push(id);\n\n  addCSS(target._cssDef);\n}\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isArray, isObject, isFunction, isObjectType } from 'utils/is';\nimport bind from 'utils/bind';\n\nfunction validate(data) {\n  // Warn if userOptions.data is a non-POJO\n  if (data && data.constructor !== Object) {\n    if (isFunction(data)) {\n      // TODO do we need to support this in the new Ractive() case?\n    } else if (!isObjectType(data)) {\n      fatal(`data option must be an object or a function, \\`${data}\\` is not valid`);\n    } else {\n      warnIfDebug(\n        'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged'\n      );\n    }\n  }\n}\n\nexport default {\n  name: 'data',\n\n  extend: (Parent, proto, options) => {\n    let key;\n    let value;\n\n    // check for non-primitives, which could cause mutation-related bugs\n    if (options.data && isObject(options.data)) {\n      for (key in options.data) {\n        value = options.data[key];\n\n        if (value && isObjectType(value)) {\n          if (isObject(value) || isArray(value)) {\n            warnIfDebug(`Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }`);\n          }\n        }\n      }\n    }\n\n    proto.data = combine(proto.data, options.data);\n  },\n\n  init: (Parent, ractive, options) => {\n    let result = combine(Parent.prototype.data, options.data);\n\n    if (isFunction(result)) result = result.call(ractive);\n\n    // bind functions to the ractive instance at the top level,\n    // unless it's a non-POJO (in which case alarm bells should ring)\n    if (result && result.constructor === Object) {\n      for (const prop in result) {\n        if (isFunction(result[prop])) {\n          const value = result[prop];\n          result[prop] = bind(value, ractive);\n          result[prop]._r_unbound = value;\n        }\n      }\n    }\n\n    return result || {};\n  },\n\n  reset(ractive) {\n    const result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n    ractive.viewmodel.root.set(result);\n    return true;\n  }\n};\n\nfunction emptyData() {\n  return {};\n}\n\nfunction combine(parentValue, childValue) {\n  validate(childValue);\n\n  const parentIsFn = isFunction(parentValue);\n\n  // Very important, otherwise child instance can become\n  // the default data object on Ractive or a component.\n  // then ractive.set() ends up setting on the prototype!\n  if (!childValue && !parentIsFn) {\n    // this needs to be a function so that it can still inherit parent defaults\n    childValue = emptyData;\n  }\n\n  const childIsFn = isFunction(childValue);\n\n  // Fast path, where we just need to copy properties from\n  // parent to child\n  if (!parentIsFn && !childIsFn) {\n    return fromProperties(childValue, parentValue);\n  }\n\n  return function() {\n    const child = childIsFn ? callDataFunction(childValue, this) : childValue;\n    const parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n    return fromProperties(child, parent);\n  };\n}\n\nfunction callDataFunction(fn, context) {\n  const data = fn.call(context);\n\n  if (!data) return;\n\n  if (!isObjectType(data)) {\n    fatal('Data function must return an object');\n  }\n\n  if (data.constructor !== Object) {\n    warnOnceIfDebug(\n      'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged'\n    );\n  }\n\n  return data;\n}\n\nfunction fromProperties(primary, secondary) {\n  if (primary && secondary) {\n    for (const key in secondary) {\n      if (!(key in primary)) {\n        primary[key] = secondary[key];\n      }\n    }\n\n    return primary;\n  }\n\n  return primary || secondary;\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { addFunctions } from 'shared/getFunction';\nimport parser from '../runtime-parser';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isNumber, isString } from 'utils/is';\n\nexport default {\n  name: 'template',\n\n  extend(Parent, proto, options) {\n    // only assign if exists\n    if ('template' in options) {\n      const template = options.template;\n\n      if (isFunction(template)) {\n        proto.template = template;\n      } else {\n        proto.template = parseTemplate(template, proto);\n      }\n    }\n  },\n\n  init(Parent, ractive, options) {\n    // TODO because of prototypal inheritance, we might just be able to use\n    // ractive.template, and not bother passing through the Parent object.\n    // At present that breaks the test mocks' expectations\n    let template = 'template' in options ? options.template : Parent.prototype.template;\n    template = template || { v: TEMPLATE_VERSION, t: [] };\n\n    if (isFunction(template)) {\n      const fn = template;\n      template = getDynamicTemplate(ractive, fn);\n\n      ractive._config.template = {\n        fn,\n        result: template\n      };\n    }\n\n    template = parseTemplate(template, ractive);\n\n    // TODO the naming of this is confusing - ractive.template refers to [...],\n    // but Component.prototype.template refers to {v:1,t:[],p:[]}...\n    // it's unnecessary, because the developer never needs to access\n    // ractive.template\n    ractive.template = template.t;\n\n    if (template.p) {\n      extendPartials(ractive.partials, template.p);\n    }\n  },\n\n  reset(ractive) {\n    const result = resetValue(ractive);\n\n    if (result) {\n      const parsed = parseTemplate(result, ractive);\n\n      ractive.template = parsed.t;\n      extendPartials(ractive.partials, parsed.p, true);\n\n      return true;\n    }\n  }\n};\n\nfunction resetValue(ractive) {\n  const initial = ractive._config.template;\n\n  // If this isn't a dynamic template, there's nothing to do\n  if (!initial || !initial.fn) {\n    return;\n  }\n\n  const result = getDynamicTemplate(ractive, initial.fn);\n\n  // TODO deep equality check to prevent unnecessary re-rendering\n  // in the case of already-parsed templates\n  if (result !== initial.result) {\n    initial.result = result;\n    return result;\n  }\n}\n\nfunction getDynamicTemplate(ractive, fn) {\n  return fn.call(ractive, {\n    fromId: parser.fromId,\n    isParsed: parser.isParsed,\n    parse(template, options = parser.getParseOptions(ractive)) {\n      return parser.parse(template, options);\n    }\n  });\n}\n\nfunction parseTemplate(template, ractive) {\n  if (isString(template)) {\n    // parse will validate and add expression functions\n    template = parseAsString(template, ractive);\n  } else {\n    // need to validate and add exp for already parsed template\n    validate(template);\n    addFunctions(template);\n  }\n\n  return template;\n}\n\nfunction parseAsString(template, ractive) {\n  // ID of an element containing the template?\n  if (template[0] === '#') {\n    template = parser.fromId(template);\n  }\n\n  return parser.parseFor(template, ractive);\n}\n\nfunction validate(template) {\n  // Check that the template even exists\n  if (template == undefined) {\n    throw new Error(`The template cannot be ${template}.`);\n  } else if (!isNumber(template.v)) {\n    // Check the parsed template has a version at all\n    throw new Error(\n      \"The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.\"\n    );\n  } else if (template.v !== TEMPLATE_VERSION) {\n    // Check we're using the correct version\n    throw new Error(\n      `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${\n        template.v\n      }) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app`\n    );\n  }\n}\n\nfunction extendPartials(existingPartials, newPartials, overwrite) {\n  if (!newPartials) return;\n\n  // TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  // case, but not initially...\n\n  for (const key in newPartials) {\n    if (overwrite || !hasOwn(existingPartials, key)) {\n      existingPartials[key] = newPartials[key];\n    }\n  }\n}\n","import { assign, create, keys } from 'utils/object';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'computed',\n  'decorators',\n  'easing',\n  'events',\n  'helpers',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst registriesOnDefaults = ['computed', 'helpers'];\n\nclass Registry {\n  constructor(name, useDefaults) {\n    this.name = name;\n    this.useDefaults = useDefaults;\n  }\n\n  extend(Parent, proto, options) {\n    const parent = this.useDefaults ? Parent.defaults : Parent;\n    const target = this.useDefaults ? proto : proto.constructor;\n    this.configure(parent, target, options);\n  }\n\n  init() {\n    // noop\n  }\n\n  configure(Parent, target, options) {\n    const name = this.name;\n    const option = options[name];\n\n    const registry = create(Parent[name]);\n\n    assign(registry, option);\n\n    target[name] = registry;\n  }\n\n  reset(ractive) {\n    const registry = ractive[this.name];\n    let changed = false;\n\n    keys(registry).forEach(key => {\n      const item = registry[key];\n\n      if (item._fn) {\n        if (item._fn.isOwner) {\n          registry[key] = item._fn;\n        } else {\n          delete registry[key];\n        }\n        changed = true;\n      }\n    });\n\n    return changed;\n  }\n}\n\nconst registries = registryNames.map(name => {\n  const putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n  return new Registry(name, putInDefaults);\n});\n\nexport default registries;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\nimport { hasOwn, keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nconst config = {\n  extend: (Parent, proto, options, Child) => configure('extend', Parent, proto, options, Child),\n  init: (Parent, ractive, options) => configure('init', Parent, ractive, options),\n  reset: ractive => order.filter(c => c.reset && c.reset(ractive)).map(c => c.name)\n};\n\nconst custom = {\n  adapt: adaptConfigurator,\n  computed: config,\n  css: cssConfigurator,\n  data: dataConfigurator,\n  helpers: config,\n  template: templateConfigurator\n};\n\nconst defaultKeys = keys(defaults);\n\nconst isStandardKey = makeObj(defaultKeys.filter(key => !custom[key]));\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj(\n  defaultKeys.concat(registries.map(r => r.name), ['on', 'observe', 'attributes', 'cssData', 'use'])\n);\n\nconst order = [].concat(\n  defaultKeys.filter(key => !registries[key] && !custom[key]),\n  registries,\n  //custom.data,\n  custom.template,\n  custom.css\n);\n\nfunction configure(method, Parent, target, options, Child) {\n  deprecate(options);\n\n  for (const key in options) {\n    if (hasOwn(isStandardKey, key)) {\n      const value = options[key];\n\n      // warn the developer if they passed a function and ignore its value\n\n      // NOTE: we allow some functions on \"el\" because we duck type element lists\n      // and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n      // function object as the result of querySelector methods\n      if (key !== 'el' && isFunction(value)) {\n        warnIfDebug(\n          `${key} is a Ractive option that does not expect a function and will be ignored`,\n          method === 'init' ? target : null\n        );\n      } else {\n        target[key] = value;\n      }\n    }\n  }\n\n  // disallow combination of `append` and `enhance`\n  if (options.append && options.enhance) {\n    throw new Error('Cannot use append and enhance at the same time');\n  }\n\n  registries.forEach(registry => {\n    registry[method](Parent, target, options, Child);\n  });\n\n  adaptConfigurator[method](Parent, target, options, Child);\n  templateConfigurator[method](Parent, target, options, Child);\n  cssConfigurator[method](Parent, target, options, Child);\n\n  extendOtherMethods(Parent.prototype, target, options);\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods(parent, target, options) {\n  for (const key in options) {\n    if (!isBlacklisted[key] && hasOwn(options, key)) {\n      let member = options[key];\n\n      // if this is a method that overwrites a method, wrap it:\n      if (isFunction(member)) {\n        if (key in RactiveProto && !_super.test(member.toString())) {\n          warnIfDebug(\n            `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.`\n          );\n        }\n        member = wrapPrototype(parent, key, member);\n      }\n\n      target[key] = member;\n    }\n  }\n}\n\nfunction makeObj(array) {\n  const obj = {};\n  array.forEach(x => (obj[x] = true));\n  return obj;\n}\n\nexport default config;\n","import { createDocumentFragment } from 'utils/dom';\nimport noop from 'utils/noop';\n\nexport default class Item {\n  constructor(options) {\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n\n    this.template = options.template;\n    this.index = options.index;\n    this.type = options.template.t;\n\n    this.dirty = false;\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  find() {\n    return null;\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  findNextNode() {\n    return this.up.findNextNode(this);\n  }\n\n  shuffled() {\n    if (this.fragment) this.fragment.shuffled();\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    return this.fragment ? this.fragment.detach() : createDocumentFragment();\n  }\n\n  find(selector) {\n    if (this.fragment) {\n      return this.fragment.find(selector);\n    }\n  }\n\n  findAll(selector, options) {\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findComponent(name) {\n    if (this.fragment) {\n      return this.fragment.findComponent(name);\n    }\n  }\n\n  findAllComponents(name, options) {\n    if (this.fragment) {\n      this.fragment.findAllComponents(name, options);\n    }\n  }\n\n  firstNode(skipParent) {\n    return this.fragment && this.fragment.firstNode(skipParent);\n  }\n\n  toString(escape) {\n    return this.fragment ? this.fragment.toString(escape) : '';\n  }\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { hasOwn } from 'utils/object';\n\nexport default class ComputationChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n\n    this.isReadonly = !this.root.ractive.syncComputedChildren;\n    this.dirty = true;\n  }\n\n  get setRoot() {\n    return this.parent.setRoot;\n  }\n\n  applyValue(value) {\n    super.applyValue(value);\n\n    if (!this.isReadonly) {\n      let source = this.parent;\n      // computed models don't have a shuffle method\n      while (source && source.shuffle) {\n        source = source.parent;\n      }\n\n      if (source) {\n        source.dependencies.forEach(mark);\n      }\n    }\n\n    if (this.setRoot) {\n      this.setRoot.set(this.setRoot.value);\n    }\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const parentValue = this.parent.get();\n      this.value = parentValue ? parentValue[this.key] : undefined;\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    return (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n      ? this.wrapperValue\n      : this.value;\n  }\n\n  handleChange() {\n    this.dirty = true;\n\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n    this.deps.forEach(handleChange);\n    this.children.forEach(handleChange);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ComputationChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from 'src/global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model, { shared } from './Model';\nimport { maybeBind, noVirtual } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from 'config/environment';\nimport { isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nexport default class Computation extends Model {\n  constructor(parent, signature, key) {\n    super(parent, key);\n\n    this.signature = signature;\n\n    this.isReadonly = !this.signature.setter;\n\n    this.dependencies = [];\n\n    this.children = [];\n    this.childByKey = {};\n\n    this.deps = [];\n\n    this.dirty = true;\n\n    // TODO: is there a less hackish way to do this?\n    this.shuffle = undefined;\n  }\n\n  get setRoot() {\n    if (this.signature.setter) return this;\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const old = this.value;\n      this.value = this.getValue();\n      // this may cause a view somewhere to update, so it must be in a runloop\n      if (!runloop.active()) {\n        runloop.start();\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n        runloop.end();\n      } else {\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n      }\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    // if capturing, this value needs to be unwrapped because it's for external use\n    return maybeBind(\n      this,\n      // if unwrap is supplied, it overrides capture\n      this.wrapper && (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture)\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getContext() {\n    return this.parent.isRoot ? this.root.ractive : this.parent.get(false, noVirtual);\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      result = this.signature.getter.call(this.root.ractive, this.getContext());\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n\n      // TODO this is all well and good in Chrome, but...\n      // ...also, should encapsulate this stuff better, and only\n      // show it if Ractive.DEBUG\n      if (hasConsole) {\n        if (console.groupCollapsed)\n          console.groupCollapsed(\n            '%cshow details',\n            'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n          );\n        const sig = this.signature;\n        console.error(\n          `${err.name}: ${err.message}\\n\\n${sig.getterString}${\n            sig.getterUseStack ? '\\n\\n' + err.stack : ''\n          }`\n        );\n        if (console.groupCollapsed) console.groupEnd();\n      }\n    }\n\n    const dependencies = stopCapturing();\n    this.setDependencies(dependencies);\n\n    return result;\n  }\n\n  mark() {\n    this.handleChange();\n  }\n\n  rebind(next, previous) {\n    // computations will grab all of their deps again automagically\n    if (next !== previous) this.handleChange();\n  }\n\n  set(value) {\n    if (this.isReadonly) {\n      throw new Error(`Cannot set read-only computed value '${this.key}'`);\n    }\n\n    this.signature.setter(value);\n    this.mark();\n  }\n\n  setDependencies(dependencies) {\n    // unregister any soft dependencies we no longer have\n    let i = this.dependencies.length;\n    while (i--) {\n      const model = this.dependencies[i];\n      if (!~dependencies.indexOf(model)) model.unregister(this);\n    }\n\n    // and add any new ones\n    i = dependencies.length;\n    while (i--) {\n      const model = dependencies[i];\n      if (!~this.dependencies.indexOf(model)) model.register(this);\n    }\n\n    this.dependencies = dependencies;\n  }\n\n  teardown() {\n    let i = this.dependencies.length;\n    while (i--) {\n      if (this.dependencies[i]) this.dependencies[i].unregister(this);\n    }\n    if (this.parent.computed[this.key] === this) delete this.parent.computed[this.key];\n    super.teardown();\n  }\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n\nshared.Computation = Computation;\n","import { removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport { warnIfDebug } from 'utils/log';\nimport Model from 'src/model/Model';\nimport Computation from 'src/model/Computation';\nimport { startCapturing, stopCapturing } from 'src/global/capture';\nimport getFunction from 'shared/getFunction';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from './resolveReference';\n\nexport default class ExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(fragment.ractive.viewmodel, null);\n\n    this.fragment = fragment;\n    this.template = template;\n\n    this.isReadonly = true;\n    this.dirty = true;\n\n    this.fn =\n      fragment.ractive.allowExpressions === false\n        ? noop\n        : getFunction(template.s, template.r.length);\n\n    this.models = this.template.r.map(ref => {\n      return resolveReference(this.fragment, ref);\n    });\n    this.dependencies = [];\n\n    this.shuffle = undefined;\n\n    this.bubble();\n  }\n\n  bubble(actuallyChanged = true) {\n    // refresh the keypath\n    this.keypath = undefined;\n\n    if (actuallyChanged) {\n      this.handleChange();\n    }\n  }\n\n  getKeypath() {\n    if (!this.template) return '@undefined';\n    if (!this.keypath) {\n      this.keypath =\n        '@' +\n        this.template.s.replace(/_(\\d+)/g, (match, i) => {\n          if (i >= this.models.length) return match;\n\n          const model = this.models[i];\n          return model ? model.getKeypath() : '@undefined';\n        });\n    }\n\n    return this.keypath;\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      const params = this.models.map(m => (m ? m.get(true) : undefined));\n      result = this.fn.apply(this.fragment.ractive, params);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n    }\n\n    const dependencies = stopCapturing();\n    // remove missing deps\n    this.dependencies.filter(d => !~dependencies.indexOf(d)).forEach(d => {\n      d.unregister(this);\n      removeFromArray(this.dependencies, d);\n    });\n    // register new deps\n    dependencies.filter(d => !~this.dependencies.indexOf(d)).forEach(d => {\n      d.register(this);\n      this.dependencies.push(d);\n    });\n\n    return result;\n  }\n\n  notifyUpstream() {}\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n\n    if (~idx) {\n      next = rebindMatch(this.template.r[idx], next, previous);\n      if (next !== previous) {\n        previous.unregister(this);\n        this.models.splice(idx, 1, next);\n        if (next) next.addShuffleRegister(this, 'mark');\n      }\n    }\n    this.bubble(!safe);\n  }\n\n  retrieve() {\n    return this.get();\n  }\n\n  teardown() {\n    this.fragment = undefined;\n    if (this.dependencies) this.dependencies.forEach(d => d.unregister(this));\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n","import Model from 'src/model/Model';\nimport { findBoundValue } from 'src/model/ModelBase';\nimport { REFERENCE } from 'config/types';\nimport { rebindMatch } from 'shared/rebind';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { isEqual, isString } from 'utils/is';\nimport { escapeKey } from 'shared/keypaths';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\nimport { hasOwn } from 'utils/object';\nimport { capture } from 'src/global/capture';\n\nclass ReferenceExpressionChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n    this.dirty = true;\n  }\n\n  applyValue(value) {\n    if (isEqual(value, this.value)) return;\n\n    let parent = this.parent;\n    const keys = [this.key];\n    while (parent) {\n      if (parent.base) {\n        const target = parent.model.joinAll(keys);\n        target.applyValue(value);\n        break;\n      }\n\n      keys.unshift(parent.key);\n\n      parent = parent.parent;\n    }\n  }\n\n  get(shouldCapture, opts) {\n    this.retrieve();\n    return super.get(shouldCapture, opts);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ReferenceExpressionChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark() {\n    this.dirty = true;\n    super.mark();\n  }\n\n  retrieve() {\n    if (this.dirty) {\n      this.dirty = false;\n      const parent = this.parent.get();\n      this.value = parent && parent[this.key];\n    }\n\n    return this.value;\n  }\n}\n\nconst missing = { get() {} };\n\nexport default class ReferenceExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(null, null);\n    this.dirty = true;\n    this.root = fragment.ractive.viewmodel;\n    this.template = template;\n\n    this.base = resolve(fragment, template);\n\n    const intermediary = (this.intermediary = {\n      handleChange: () => this.handleChange(),\n      rebind: (next, previous) => {\n        if (previous === this.base) {\n          next = rebindMatch(template, next, previous);\n          if (next !== this.base) {\n            this.base.unregister(intermediary);\n            this.base = next;\n          }\n        } else {\n          const idx = this.members.indexOf(previous);\n          if (~idx) {\n            // only direct references will rebind... expressions handle themselves\n            next = rebindMatch(template.m[idx].n, next, previous);\n            if (next !== this.members[idx]) {\n              this.members.splice(idx, 1, next || missing);\n            }\n          }\n        }\n\n        if (next !== previous) previous.unregister(intermediary);\n        if (next) next.addShuffleTask(() => next.register(intermediary));\n\n        this.bubble();\n      }\n    });\n\n    this.members = template.m.map(template => {\n      if (isString(template)) {\n        return { get: () => template };\n      }\n\n      let model;\n\n      if (template.t === REFERENCE) {\n        model = resolveReference(fragment, template.n);\n        model.register(intermediary);\n\n        return model;\n      }\n\n      model = new ExpressionProxy(fragment, template);\n      model.register(intermediary);\n      return model;\n    });\n\n    this.base.register(intermediary);\n\n    this.bubble();\n  }\n\n  bubble() {\n    if (!this.base) return;\n    if (!this.dirty) this.handleChange();\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n    if (this.dirty) {\n      this.bubble();\n\n      const keys = this.members.map(m => escapeKey(String(m.get())));\n      const model = this.base.joinAll(keys);\n\n      if (model !== this.model) {\n        if (this.model) {\n          this.model.unregister(this);\n          this.model.unregisterTwowayBinding(this);\n        }\n\n        this.model = model;\n        this.parent = model.parent;\n        this.model.register(this);\n        this.model.registerTwowayBinding(this);\n\n        pathChanged(this);\n      }\n\n      this.value = this.model.get(shouldCapture, opts);\n      this.dirty = false;\n      this.mark();\n      return this.value;\n    } else {\n      return this.model ? this.model.get(shouldCapture, opts) : undefined;\n    }\n  }\n\n  // indirect two-way bindings\n  getValue() {\n    this.value = this.model ? this.model.get() : undefined;\n\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) return value;\n    }\n\n    // check one-way bindings\n    const oneway = findBoundValue(this.deps);\n    if (oneway) return oneway.value;\n\n    return this.value;\n  }\n\n  getKeypath() {\n    return this.model ? this.model.getKeypath() : '@undefined';\n  }\n\n  handleChange() {\n    this.dirty = true;\n    this.mark();\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ReferenceExpressionChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark() {\n    if (this.dirty) {\n      this.deps.forEach(handleChange);\n    }\n\n    this.links.forEach(marked);\n    this.children.forEach(mark);\n  }\n\n  rebind() {\n    this.handleChange();\n  }\n\n  retrieve() {\n    return this.value;\n  }\n\n  set(value) {\n    this.model.set(value);\n  }\n\n  teardown() {\n    if (this.base) {\n      this.base.unregister(this.intermediary);\n    }\n    if (this.model) {\n      this.model.unregister(this);\n      this.model.unregisterTwowayBinding(this);\n    }\n    if (this.members) {\n      this.members.forEach(m => m && m.unregister && m.unregister(this.intermediary));\n    }\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nfunction pathChanged(proxy) {\n  let len = proxy.deps.length;\n  let i, v;\n\n  for (i = 0; i < len; i++) {\n    v = proxy.deps[i];\n    if (v.pathChanged) v.pathChanged();\n    if (v.fragment && v.fragment.pathModel) v.fragment.pathModel.applyValue(proxy.getKeypath());\n  }\n\n  len = proxy.children.length;\n  for (i = 0; i < len; i++) {\n    pathChanged(proxy.children[i]);\n  }\n}\n","import Fragment from '../Fragment';\nimport { ContainerItem } from './shared/Item';\nimport resolve from '../resolvers/resolve';\n\nexport function resolveAliases(aliases, fragment) {\n  const resolved = {};\n\n  for (let i = 0; i < aliases.length; i++) {\n    resolved[aliases[i].n] = resolve(fragment, aliases[i].x);\n  }\n\n  for (const k in resolved) {\n    resolved[k].reference();\n  }\n\n  return resolved;\n}\n\nexport default class Alias extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.fragment = null;\n  }\n\n  bind() {\n    this.fragment = new Fragment({\n      owner: this,\n      template: this.template.f\n    });\n\n    this.fragment.aliases = resolveAliases(this.template.z, this.up);\n    this.fragment.bind();\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  unbind() {\n    for (const k in this.fragment.aliases) {\n      this.fragment.aliases[k].unreference();\n    }\n\n    this.fragment.aliases = {};\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      this.fragment.update();\n    }\n  }\n}\n","import cleanCss from 'utils/cleanCss';\nimport { isString } from 'utils/is';\n\nconst space = /\\s+/;\n\nexport function readStyle(css) {\n  if (!isString(css)) return {};\n\n  return cleanCss(css, (css, reconstruct) => {\n    return css\n      .split(';')\n      .filter(rule => !!rule.trim())\n      .map(reconstruct)\n      .reduce((rules, rule) => {\n        const i = rule.indexOf(':');\n        const name = rule.substr(0, i).trim();\n        rules[name] = rule.substr(i + 1).trim();\n        return rules;\n      }, {});\n  });\n}\n\nexport function readClass(str) {\n  const list = str.split(space);\n\n  // remove any empty entries\n  let i = list.length;\n  while (i--) {\n    if (!list[i]) list.splice(i, 1);\n  }\n\n  return list;\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport noop from 'utils/noop';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport { readStyle, readClass } from 'src/view/helpers/specialAttrs';\nimport { keys as objectKeys } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nconst textTypes = [\n  undefined,\n  'text',\n  'search',\n  'url',\n  'email',\n  'hidden',\n  'password',\n  'search',\n  'reset',\n  'submit'\n];\n\nexport default function getUpdateDelegate(attribute) {\n  const { element, name } = attribute;\n\n  if (name === 'value') {\n    if (attribute.interpolator) attribute.interpolator.bound = true;\n\n    // special case - selects\n    if (element.name === 'select' && name === 'value') {\n      return element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n    }\n\n    if (element.name === 'textarea') return updateStringValue;\n\n    // special case - contenteditable\n    if (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n    // special case - <input>\n    if (element.name === 'input') {\n      const type = element.getAttribute('type');\n\n      // type='file' value='{{fileList}}'>\n      if (type === 'file') return noop; // read-only\n\n      // type='radio' name='{{twoway}}'\n      if (type === 'radio' && element.binding && element.binding.attribute.name === 'name')\n        return updateRadioValue;\n\n      if (~textTypes.indexOf(type)) return updateStringValue;\n    }\n\n    return updateValue;\n  }\n\n  const node = element.node;\n\n  // special case - <input type='radio' name='{{twoway}}' value='foo'>\n  if (attribute.isTwoway && name === 'name') {\n    if (node.type === 'radio') return updateRadioName;\n    if (node.type === 'checkbox') return updateCheckboxName;\n  }\n\n  if (name === 'style') return updateStyleAttribute;\n\n  if (name.indexOf('style-') === 0) return updateInlineStyle;\n\n  // special case - class names. IE fucks things up, again\n  if (name === 'class' && (!node.namespaceURI || node.namespaceURI === html))\n    return updateClassName;\n\n  if (name.indexOf('class-') === 0) return updateInlineClass;\n\n  if (attribute.isBoolean) {\n    const type = element.getAttribute('type');\n    if (attribute.interpolator && name === 'checked' && (type === 'checkbox' || type === 'radio'))\n      attribute.interpolator.bound = true;\n    return updateBoolean;\n  }\n\n  if (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI)\n    return updateNamespacedAttribute;\n\n  return updateAttribute;\n}\n\nfunction updateMultipleSelectValue(reset) {\n  let value = this.getValue();\n\n  if (!isArray(value)) value = [value];\n\n  const options = this.node.options;\n  let i = options.length;\n\n  if (reset) {\n    while (i--) options[i].selected = false;\n  } else {\n    while (i--) {\n      const option = options[i];\n      const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n      option.selected = arrayContains(value, optionValue);\n    }\n  }\n}\n\nfunction updateSelectValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    // TODO is locked still a thing?\n    this.node._ractive.value = value;\n\n    const options = this.node.options;\n    let i = options.length;\n    let wasSelected = false;\n\n    if (reset) {\n      while (i--) options[i].selected = false;\n    } else {\n      while (i--) {\n        const option = options[i];\n        const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n        if (option.disabled && option.selected) wasSelected = true;\n\n        if (optionValue == value) {\n          // double equals as we may be comparing numbers with strings\n          option.selected = true;\n          return;\n        }\n      }\n    }\n\n    if (!wasSelected) this.node.selectedIndex = -1;\n  }\n}\n\nfunction updateContentEditableValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    if (reset) this.node.innerHTML = '';\n    else this.node.innerHTML = value === undefined ? '' : value;\n  }\n}\n\nfunction updateRadioValue(reset) {\n  const node = this.node;\n  const wasChecked = node.checked;\n\n  const value = this.getValue();\n\n  if (reset) return (node.checked = false);\n\n  //node.value = this.element.getAttribute( 'value' );\n  node.value = this.node._ractive.value = value;\n  node.checked = this.element.compare(value, this.element.getAttribute('name'));\n\n  // This is a special case - if the input was checked, and the value\n  // changed so that it's no longer checked, the twoway binding is\n  // most likely out of date. To fix it we have to jump through some\n  // hoops... this is a little kludgy but it works\n  if (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n    this.element.binding.group.model.set(this.element.binding.group.getValue());\n  }\n}\n\nfunction updateValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node.removeAttribute('value');\n      this.node.value = this.node._ractive.value = null;\n    } else {\n      const value = this.getValue();\n\n      this.node.value = this.node._ractive.value = value;\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateStringValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node._ractive.value = '';\n      this.node.removeAttribute('value');\n    } else {\n      const value = this.getValue();\n\n      this.node._ractive.value = value;\n\n      this.node.value = safeToStringValue(value);\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateRadioName(reset) {\n  if (reset) this.node.checked = false;\n  else this.node.checked = this.element.compare(this.getValue(), this.element.binding.getValue());\n}\n\nfunction updateCheckboxName(reset) {\n  const { element, node } = this;\n  const binding = element.binding;\n\n  const value = this.getValue();\n  const valueAttribute = element.getAttribute('value');\n\n  if (reset) {\n    // TODO: WAT?\n  }\n\n  if (!isArray(value)) {\n    binding.isChecked = node.checked = element.compare(value, valueAttribute);\n  } else {\n    let i = value.length;\n    while (i--) {\n      if (element.compare(valueAttribute, value[i])) {\n        binding.isChecked = node.checked = true;\n        return;\n      }\n    }\n    binding.isChecked = node.checked = false;\n  }\n}\n\nfunction updateStyleAttribute(reset) {\n  const props = reset ? {} : readStyle(this.getValue() || '');\n  const style = this.node.style;\n  const keys = objectKeys(props);\n  const prev = this.previous || [];\n\n  let i = 0;\n  while (i < keys.length) {\n    if (keys[i] in style) {\n      const safe = props[keys[i]].replace('!important', '');\n      style.setProperty(keys[i], safe, safe.length !== props[keys[i]].length ? 'important' : '');\n    }\n    i++;\n  }\n\n  // remove now-missing attrs\n  i = prev.length;\n  while (i--) {\n    if (!~keys.indexOf(prev[i]) && prev[i] in style) style.setProperty(prev[i], '', '');\n  }\n\n  this.previous = keys;\n}\n\nfunction updateInlineStyle(reset) {\n  if (!this.style) {\n    this.style = hyphenateCamel(this.name.substr(6));\n  }\n\n  if (reset && this.node.style.getPropertyValue(this.style) !== this.last) return;\n\n  const value = reset ? '' : safeToStringValue(this.getValue());\n  const safe = value.replace('!important', '');\n  this.node.style.setProperty(this.style, safe, safe.length !== value.length ? 'important' : '');\n  this.last = this.node.style.getPropertyValue(this.style);\n}\n\nfunction updateClassName(reset) {\n  const value = reset ? [] : readClass(safeToStringValue(this.getValue()));\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const prev = this.previous || attr.slice(0);\n\n  const className = value.concat(attr.filter(c => !~prev.indexOf(c))).join(' ');\n\n  if (className !== cls) {\n    if (!isString(this.node.className)) {\n      this.node.className.baseVal = className;\n    } else {\n      this.node.className = className;\n    }\n  }\n\n  this.previous = value;\n}\n\nfunction updateInlineClass(reset) {\n  const name = this.name.substr(6);\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const value = reset ? false : this.getValue();\n\n  if (!this.inlineClass) this.inlineClass = name;\n\n  if (value && !~attr.indexOf(name)) attr.push(name);\n  else if (!value && ~attr.indexOf(name)) attr.splice(attr.indexOf(name), 1);\n\n  if (!isString(this.node.className)) {\n    this.node.className.baseVal = attr.join(' ');\n  } else {\n    this.node.className = attr.join(' ');\n  }\n}\n\nfunction updateBoolean(reset) {\n  // with two-way binding, only update if the change wasn't initiated by the user\n  // otherwise the cursor will often be sent to the wrong place\n  if (!this.locked) {\n    if (reset) {\n      if (this.useProperty) this.node[this.propertyName] = false;\n      this.node.removeAttribute(this.propertyName);\n    } else {\n      if (this.useProperty) {\n        this.node[this.propertyName] = this.getValue();\n      } else {\n        const val = this.getValue();\n        if (val) {\n          this.node.setAttribute(this.propertyName, isString(val) ? val : '');\n        } else {\n          this.node.removeAttribute(this.propertyName);\n        }\n      }\n    }\n  }\n}\n\nfunction updateAttribute(reset) {\n  if (reset) {\n    if (this.node.getAttribute(this.name) === this.value) {\n      this.node.removeAttribute(this.name);\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttribute(this.name, this.value);\n  }\n}\n\nfunction updateNamespacedAttribute(reset) {\n  if (reset) {\n    if (\n      this.value ===\n      this.node.getAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1))\n    ) {\n      this.node.removeAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1));\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttributeNS(\n      this.namespace,\n      this.name.slice(this.name.indexOf(':') + 1),\n      this.value\n    );\n  }\n}\n","export default {\n  'accept-charset': 'acceptCharset',\n  accesskey: 'accessKey',\n  bgcolor: 'bgColor',\n  class: 'className',\n  codebase: 'codeBase',\n  colspan: 'colSpan',\n  contenteditable: 'contentEditable',\n  datetime: 'dateTime',\n  dirname: 'dirName',\n  for: 'htmlFor',\n  'http-equiv': 'httpEquiv',\n  ismap: 'isMap',\n  maxlength: 'maxLength',\n  novalidate: 'noValidate',\n  pubdate: 'pubDate',\n  readonly: 'readOnly',\n  rowspan: 'rowSpan',\n  tabindex: 'tabIndex',\n  usemap: 'useMap'\n};\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement('div') : null;\n\nlet attributes = false;\nexport function inAttributes() {\n  return attributes;\n}\n\nexport default class ConditionalAttribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.attributes = [];\n\n    this.owner = options.owner;\n\n    this.fragment = new Fragment({\n      ractive: this.ractive,\n      owner: this,\n      template: this.template\n    });\n\n    // this fragment can't participate in node-y things\n    this.fragment.findNextNode = noop;\n\n    this.dirty = false;\n  }\n\n  bind() {\n    this.fragment.bind();\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.owner.bubble();\n    }\n  }\n\n  destroyed() {\n    this.unrender();\n  }\n\n  render() {\n    this.node = this.owner.node;\n    if (this.node) {\n      this.isSvg = this.node.namespaceURI === svg;\n    }\n\n    attributes = true;\n    if (!this.rendered) this.fragment.render();\n\n    this.rendered = true;\n    this.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n    this.update();\n    attributes = false;\n  }\n\n  toString() {\n    return this.fragment.toString();\n  }\n\n  unbind() {\n    this.fragment.unbind();\n  }\n\n  unrender() {\n    this.rendered = false;\n    this.fragment.unrender();\n  }\n\n  update() {\n    let str;\n    let attrs;\n\n    if (this.dirty) {\n      this.dirty = false;\n\n      const current = attributes;\n      attributes = true;\n      this.fragment.update();\n\n      if (this.rendered && this.node) {\n        str = this.fragment.toString();\n\n        attrs = parseAttributes(str, this.isSvg);\n\n        // any attributes that previously existed but no longer do\n        // must be removed\n        this.attributes.filter(a => notIn(attrs, a)).forEach(a => {\n          this.node.removeAttribute(a.name);\n        });\n\n        attrs.forEach(a => {\n          this.node.setAttribute(a.name, a.value);\n        });\n\n        this.attributes = attrs;\n      }\n\n      attributes = current || false;\n    }\n  }\n}\n\nconst onlyWhitespace = /^\\s*$/;\nfunction parseAttributes(str, isSvg) {\n  if (onlyWhitespace.test(str)) return [];\n  const tagName = isSvg ? 'svg' : 'div';\n  return str\n    ? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) && toArray(div.childNodes[0].attributes)\n    : [];\n}\n\nfunction notIn(haystack, needle) {\n  let i = haystack.length;\n\n  while (i--) {\n    if (haystack[i].name === needle.name) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport namespaces from 'config/namespaces';\nimport { safeAttributeString } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { inAttributes } from './ConditionalAttribute';\nimport { isArray, isString } from 'utils/is';\n\nfunction lookupNamespace(node, prefix) {\n  const qualified = `xmlns:${prefix}`;\n\n  while (node) {\n    if (node.hasAttribute && node.hasAttribute(qualified)) return node.getAttribute(qualified);\n    node = node.parentNode;\n  }\n\n  return namespaces[prefix];\n}\n\nlet attribute = false;\nexport function inAttribute() {\n  return attribute;\n}\n\nexport default class Attribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n    this.namespace = null;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = options.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.rendered = false;\n    this.updateDelegate = null;\n    this.fragment = null;\n\n    this.element.attributeByName[this.name] = this;\n\n    if (!isArray(options.template.f)) {\n      this.value = options.template.f;\n      if (this.value === 0) {\n        this.value = '';\n      } else if (this.value === undefined) {\n        this.value = true;\n      }\n    } else {\n      this.fragment = new Fragment({\n        owner: this,\n        template: options.template.f\n      });\n    }\n\n    this.interpolator =\n      this.fragment &&\n      this.fragment.items.length === 1 &&\n      this.fragment.items[0].type === INTERPOLATOR &&\n      this.fragment.items[0];\n\n    if (this.interpolator) this.interpolator.owner = this;\n  }\n\n  bind() {\n    if (this.fragment) {\n      this.fragment.bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.up.bubble();\n      this.element.bubble();\n      this.dirty = true;\n    }\n  }\n\n  firstNode() {}\n\n  getString() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.toString()\n      : this.value != null ? '' + this.value : '';\n    attribute = false;\n    return value;\n  }\n\n  // TODO could getValue ever be called for a static attribute,\n  // or can we assume that this.fragment exists?\n  getValue() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.valueOf()\n      : booleanAttributes.test(this.name) ? true : this.value;\n    attribute = false;\n    return value;\n  }\n\n  render() {\n    const node = this.element.node;\n    this.node = node;\n\n    // should we use direct property access, or setAttribute?\n    if (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n      this.propertyName = propertyNames[this.name] || this.name;\n\n      if (node[this.propertyName] !== undefined) {\n        this.useProperty = true;\n      }\n\n      // is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n      // node.selected = true rather than node.setAttribute( 'selected', '' )\n      if (booleanAttributes.test(this.name) || this.isTwoway) {\n        this.isBoolean = true;\n      }\n\n      if (this.propertyName === 'value') {\n        node._ractive.value = this.value;\n      }\n    }\n\n    if (node.namespaceURI) {\n      const index = this.name.indexOf(':');\n      if (index !== -1) {\n        this.namespace = lookupNamespace(node, this.name.slice(0, index));\n      } else {\n        this.namespace = node.namespaceURI;\n      }\n    }\n\n    this.rendered = true;\n    this.updateDelegate = getUpdateDelegate(this);\n    this.updateDelegate();\n  }\n\n  toString() {\n    if (inAttributes()) return '';\n    attribute = true;\n\n    const value = this.getValue();\n\n    // Special case - select and textarea values (should not be stringified)\n    if (\n      this.name === 'value' &&\n      (this.element.getAttribute('contenteditable') !== undefined ||\n        (this.element.name === 'select' || this.element.name === 'textarea'))\n    ) {\n      return;\n    }\n\n    // Special case  bound radio `name` attributes\n    if (\n      this.name === 'name' &&\n      this.element.name === 'input' &&\n      this.interpolator &&\n      this.element.getAttribute('type') === 'radio'\n    ) {\n      return `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n    }\n\n    // Special case - style and class attributes and directives\n    if (\n      this.owner === this.element &&\n      (this.name === 'style' || this.name === 'class' || this.style || this.inlineClass)\n    ) {\n      return;\n    }\n\n    if (\n      !this.rendered &&\n      this.owner === this.element &&\n      (!this.name.indexOf('style-') || !this.name.indexOf('class-'))\n    ) {\n      if (!this.name.indexOf('style-')) {\n        this.style = hyphenateCamel(this.name.substr(6));\n      } else {\n        this.inlineClass = this.name.substr(6);\n      }\n\n      return;\n    }\n\n    if (booleanAttributes.test(this.name))\n      return value\n        ? isString(value) ? `${this.name}=\"${safeAttributeString(value)}\"` : this.name\n        : '';\n    if (value == null) return '';\n\n    const str = safeAttributeString(this.getString());\n    attribute = false;\n\n    return str ? `${this.name}=\"${str}\"` : this.name;\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender() {\n    this.updateDelegate(true);\n\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      let binding;\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      if (this.rendered) this.updateDelegate();\n      if (this.isTwoway && !this.locked) {\n        this.interpolator.twowayBinding.lastVal(true, this.interpolator.model.get());\n      } else if (this.name === 'value' && (binding = this.element.binding)) {\n        // special case: name bound element with dynamic value\n        const attr = binding.attribute;\n        if (attr && !attr.dirty && attr.rendered) {\n          this.element.binding.attribute.updateDelegate();\n        }\n      }\n    }\n  }\n}\n","import { INTERPOLATOR, ELEMENT } from 'config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class BindingFlag extends Item {\n  constructor(options) {\n    super(options);\n\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n    this.bubbler = this.owner === this.element ? this.element : this.up;\n\n    if (this.element.type === ELEMENT) {\n      if (isArray(options.template.f)) {\n        this.fragment = new Fragment({\n          owner: this,\n          template: options.template.f\n        });\n      }\n\n      this.interpolator =\n        this.fragment &&\n        this.fragment.items.length === 1 &&\n        this.fragment.items[0].type === INTERPOLATOR &&\n        this.fragment.items[0];\n    }\n  }\n\n  bind() {\n    if (this.fragment) this.fragment.bind();\n    set(this, this.getValue(), true);\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.bubbler.bubble();\n      this.dirty = true;\n    }\n  }\n\n  getValue() {\n    if (this.fragment) return this.fragment.valueOf();\n    else if ('value' in this) return this.value;\n    else if ('f' in this.template) return this.template.f;\n    else return true;\n  }\n\n  render() {\n    set(this, this.getValue(), true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n\n    delete this.element[this.flag];\n  }\n\n  unrender() {\n    if (this.element.rendered) this.element.recreateTwowayBinding();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      set(this, this.getValue(), true);\n    }\n  }\n}\n\nfunction set(flag, value, update) {\n  if (value === 0) {\n    flag.value = true;\n  } else if (value === 'true') {\n    flag.value = true;\n  } else if (value === 'false' || value === '0') {\n    flag.value = false;\n  } else {\n    flag.value = value;\n  }\n\n  const current = flag.element[flag.flag];\n  flag.element[flag.flag] = flag.value;\n  if (update && !flag.element.attributes.binding && current !== flag.value) {\n    flag.element.recreateTwowayBinding();\n  }\n\n  return flag.value;\n}\n","import Item from './shared/Item';\nimport noop from 'utils/noop';\nimport { detachNode } from 'utils/dom';\nimport { doc } from 'config/environment';\nimport { assign, create } from 'utils/object';\n\nexport default function Comment(options) {\n  Item.call(this, options);\n}\n\nconst proto = create(Item.prototype);\n\nassign(proto, {\n  bind: noop,\n  unbind: noop,\n  update: noop,\n\n  detach() {\n    return detachNode(this.node);\n  },\n\n  firstNode() {\n    return this.node;\n  },\n\n  render(target) {\n    this.rendered = true;\n\n    this.node = doc.createComment(this.template.c);\n    target.appendChild(this.node);\n  },\n\n  toString() {\n    return `<!-- ${this.template.c} -->`;\n  },\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n});\n\nComment.prototype = proto;\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\nimport { warnIfDebug } from 'utils/log';\n\nconst teardownHook = new Hook('teardown');\nconst destructHook = new Hook('destruct');\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown() {\n  if (this.torndown) {\n    warnIfDebug('ractive.teardown() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  this.shouldDestroy = true;\n  return teardown(this, () => (this.fragment.rendered ? this.unrender() : Promise.resolve()));\n}\n\nexport function teardown(instance, getPromise) {\n  instance.torndown = true;\n  instance.fragment.unbind();\n  instance._observers.slice().forEach(cancel);\n\n  if (instance.el && instance.el.__ractive_instances__) {\n    removeFromArray(instance.el.__ractive_instances__, instance);\n  }\n\n  const promise = getPromise();\n\n  teardownHook.fire(instance);\n\n  promise.then(() => {\n    destructHook.fire(instance);\n    instance.viewmodel.teardown();\n  });\n\n  return promise;\n}\n","import { SharedModel } from './SharedModel';\nimport { Missing } from '../LinkModel';\nimport { create } from 'utils/object';\n\nexport default class RactiveModel extends SharedModel {\n  constructor(ractive) {\n    super(ractive, '@this');\n    this.ractive = ractive;\n  }\n\n  joinKey(key) {\n    const model = super.joinKey(key);\n\n    if ((key === 'root' || key === 'parent') && !model.isLink) return initLink(model, key);\n    else if (key === 'data') return this.ractive.viewmodel;\n    else if (key === 'cssData') return this.ractive.constructor._cssModel;\n\n    return model;\n  }\n}\n\nfunction initLink(model, key) {\n  model.applyValue = function(value) {\n    this.parent.value[key] = value;\n    if (value && value.viewmodel) {\n      this.link(value.viewmodel.getRactiveModel(), key);\n      this._link.markedAll();\n    } else {\n      this.link(create(Missing), key);\n      this._link.markedAll();\n    }\n  };\n\n  model.applyValue(model.parent.ractive[key], key);\n  model._link.set = v => model.applyValue(v);\n  model._link.applyValue = v => model.applyValue(v);\n  return model._link;\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel, SharedModel as SharedBase } from './specials/SharedModel';\nimport { splitKeypath, unescapeKey } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\n\nconst specialModels = {\n  '@this'(root) {\n    return root.getRactiveModel();\n  },\n  '@global'() {\n    return GlobalModel;\n  },\n  '@shared'() {\n    return SharedModel;\n  },\n  '@style'(root) {\n    return root.getRactiveModel().joinKey('cssData');\n  },\n  '@helpers'(root) {\n    return root.getHelpers();\n  }\n};\nspecialModels['@'] = specialModels['@this'];\n\nexport default class RootModel extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.ractive = options.ractive; // TODO sever this link\n\n    this.value = options.data;\n    this.adaptors = options.adapt;\n    this.adapt();\n  }\n\n  attached(fragment) {\n    attachImplicits(this, fragment);\n  }\n\n  createLink(keypath, target, targetPath, options) {\n    const keys = splitKeypath(keypath);\n\n    let model = this;\n    while (keys.length) {\n      const key = keys.shift();\n      model = model.childByKey[key] || model.joinKey(key);\n    }\n\n    return model.link(target, targetPath, options);\n  }\n\n  detached() {\n    detachImplicits(this);\n  }\n\n  get(shouldCapture, options) {\n    if (shouldCapture) capture(this);\n\n    if (!options || options.virtual !== false) {\n      return this.getVirtual();\n    } else {\n      return this.value;\n    }\n  }\n\n  getHelpers() {\n    if (!this.helpers) this.helpers = new SharedBase(this.ractive.helpers, 'helpers');\n    return this.helpers;\n  }\n\n  getKeypath() {\n    return '';\n  }\n\n  getRactiveModel() {\n    return this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  }\n\n  getValueChildren() {\n    const children = super.getValueChildren(this.value);\n\n    this.children.forEach(child => {\n      if (child._link) {\n        const idx = children.indexOf(child);\n        if (~idx) children.splice(idx, 1, child._link);\n        else children.push(child._link);\n      }\n    });\n\n    return children;\n  }\n\n  has(key) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n    if (specialModels[key] || key === '') return true;\n\n    if (super.has(key)) {\n      return true;\n    } else {\n      const unescapedKey = unescapeKey(key);\n\n      // mappings/links and computations\n      if (this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link) return true;\n    }\n  }\n\n  joinKey(key, opts) {\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n\n    if (key[0] === '@') {\n      const fn = specialModels[key];\n      if (fn) return fn(this);\n    } else {\n      return super.joinKey(key, opts);\n    }\n  }\n\n  set(value) {\n    // TODO wrapping root node is a baaaad idea. We should prevent this\n    const wrapper = this.wrapper;\n    if (wrapper) {\n      const shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        wrapper.teardown();\n        this.wrapper = null;\n        this.value = value;\n        this.adapt();\n      }\n    } else {\n      this.value = value;\n      this.adapt();\n    }\n\n    this.deps.forEach(handleChange);\n    this.children.forEach(mark);\n  }\n\n  retrieve() {\n    return this.wrapper ? this.wrapper.get() : this.value;\n  }\n\n  teardown() {\n    super.teardown();\n    this.ractiveModel && this.ractiveModel.teardown();\n  }\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits(model, fragment) {\n  if (model._link && model._link.implicit && model._link.isDetached()) {\n    model.attach(fragment);\n  }\n\n  // look for virtual children to relink and cascade\n  for (const k in model.childByKey) {\n    if (k in model.value) {\n      attachImplicits(model.childByKey[k], fragment);\n    } else if (!model.childByKey[k]._link || model.childByKey[k]._link.isDetached()) {\n      const mdl = resolveReference(fragment, k);\n      if (mdl) {\n        model.childByKey[k].link(mdl, k, { implicit: true });\n      }\n    }\n  }\n}\n\nfunction detachImplicits(model) {\n  if (model._link && model._link.implicit) {\n    model.unlink();\n  }\n\n  for (const k in model.childByKey) {\n    detachImplicits(model.childByKey[k]);\n  }\n}\n","import { fatal, warnIfDebug, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { ensureArray, combine } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from 'src/model/RootModel';\nimport Hook from 'src/events/Hook';\nimport subscribe from './helpers/subscribe';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, INTERPOLATOR, TRANSITION } from 'config/types';\nimport { assign, create, hasOwn } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\nimport { compute } from 'src/Ractive/prototype/compute';\n\nconst constructHook = new Hook('construct');\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst protoRegistries = ['computed', 'helpers'];\n\nlet uid = 0;\n\nexport default function construct(ractive, options) {\n  if (Ractive.DEBUG) welcome();\n\n  initialiseProperties(ractive);\n  handleAttributes(ractive);\n\n  // set up event subscribers\n  subscribe(ractive, options, 'on');\n\n  // if there's not a delegation setting, inherit from parent if it's not default\n  if (\n    !hasOwn(options, 'delegate') &&\n    ractive.parent &&\n    ractive.parent.delegate !== ractive.delegate\n  ) {\n    ractive.delegate = false;\n  }\n\n  // plugins that need to run at construct\n  if (isArray(options.use)) {\n    ractive.use.apply(ractive, options.use.filter(p => p.construct));\n  }\n\n  // TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n  constructHook.fire(ractive, options);\n\n  // Add registries\n  let i = registryNames.length;\n  while (i--) {\n    const name = registryNames[i];\n    ractive[name] = assign(create(ractive.constructor[name] || null), options[name]);\n  }\n\n  i = protoRegistries.length;\n  while (i--) {\n    const name = protoRegistries[i];\n    ractive[name] = assign(create(ractive.constructor.prototype[name]), options[name]);\n  }\n\n  if (ractive._attributePartial) {\n    ractive.partials['extra-attributes'] = ractive._attributePartial;\n    delete ractive._attributePartial;\n  }\n\n  // Create a viewmodel\n  const viewmodel = new RootModel({\n    adapt: getAdaptors(ractive, ractive.adapt, options),\n    data: dataConfigurator.init(ractive.constructor, ractive, options),\n    ractive\n  });\n\n  // once resolved, share the adaptors array between the root model and instance\n  ractive.adapt = viewmodel.adaptors;\n\n  ractive.viewmodel = viewmodel;\n\n  for (const k in ractive.computed) {\n    compute.call(ractive, k, ractive.computed[k]);\n  }\n}\n\nfunction getAdaptors(ractive, protoAdapt, options) {\n  protoAdapt = protoAdapt.map(lookup);\n  const adapt = ensureArray(options.adapt).map(lookup);\n\n  const srcs = [protoAdapt, adapt];\n  if (ractive.parent && !ractive.isolated) {\n    srcs.push(ractive.parent.viewmodel.adaptors);\n  }\n\n  return combine.apply(null, srcs);\n\n  function lookup(adaptor) {\n    if (isString(adaptor)) {\n      adaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n      if (!adaptor) {\n        fatal(missingPlugin(adaptor, 'adaptor'));\n      }\n    }\n\n    return adaptor;\n  }\n}\n\nfunction initialiseProperties(ractive) {\n  // Generate a unique identifier, for places where you'd use a weak map if it\n  // existed\n  ractive._guid = 'r-' + uid++;\n\n  // events\n  ractive._subs = create(null);\n  ractive._nsSubs = 0;\n\n  // storage for item configuration from instantiation to reset,\n  // like dynamic functions or original values\n  ractive._config = {};\n\n  // events\n  ractive.event = null;\n  ractive._eventQueue = [];\n\n  // observers\n  ractive._observers = [];\n\n  // external children\n  ractive._children = [];\n  ractive._children.byName = {};\n  ractive.children = ractive._children;\n\n  if (!ractive.component) {\n    ractive.root = ractive;\n    ractive.parent = ractive.container = null; // TODO container still applicable?\n  }\n}\n\nfunction handleAttributes(ractive) {\n  const component = ractive.component;\n  const attributes = ractive.constructor.attributes;\n\n  if (attributes && component) {\n    const tpl = component.template;\n    const attrs = tpl.m ? tpl.m.slice() : [];\n\n    // grab all of the passed attribute names\n    const props = attrs.filter(a => a.t === ATTRIBUTE).map(a => a.n);\n\n    // warn about missing requireds\n    attributes.required.forEach(p => {\n      if (!~props.indexOf(p)) {\n        warnIfDebug(`Component '${component.name}' requires attribute '${p}' to be provided`);\n      }\n    });\n\n    // set up a partial containing non-property attributes\n    const all = attributes.optional.concat(attributes.required);\n    const partial = [];\n    let i = attrs.length;\n    while (i--) {\n      const a = attrs[i];\n      if (a.t === ATTRIBUTE && !~all.indexOf(a.n)) {\n        if (attributes.mapAll) {\n          // map the attribute if requested and make the extra attribute in the partial refer to the mapping\n          partial.unshift({\n            t: ATTRIBUTE,\n            n: a.n,\n            f: [{ t: INTERPOLATOR, r: `~/${a.n}` }]\n          });\n        } else {\n          // transfer the attribute to the extra attributes partal\n          partial.unshift(attrs.splice(i, 1)[0]);\n        }\n      } else if (\n        !attributes.mapAll &&\n        (a.t === DECORATOR || a.t === TRANSITION || a.t === BINDING_FLAG)\n      ) {\n        partial.unshift(attrs.splice(i, 1)[0]);\n      }\n    }\n\n    if (partial.length) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n    ractive._attributePartial = partial;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\nimport { bind, render as callRender, unbind, unrender, update } from 'shared/methodCallers';\nimport { teardown } from 'src/Ractive/prototype/teardown';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnIfDebug } from 'utils/log';\nimport { createDocumentFragment } from 'utils/dom';\nimport {\n  ANCHOR,\n  ATTRIBUTE,\n  BINDING_FLAG,\n  COMPONENT,\n  DECORATOR,\n  EVENT,\n  TRANSITION,\n  YIELDER\n} from 'config/types';\nimport construct from 'src/Ractive/construct';\nimport initialise from 'src/Ractive/initialise';\nimport render from 'src/Ractive/render';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { assign, create } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nexport default class Component extends Item {\n  constructor(options, ComponentConstructor) {\n    super(options);\n    let template = options.template;\n    this.isAnchor = template.t === ANCHOR;\n    this.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n    let attrs = template.m;\n\n    const partials = template.p || {};\n    if (!('content' in partials)) partials.content = template.f || [];\n    this._partials = partials; // TEMP\n\n    if (this.isAnchor) {\n      this.name = template.n;\n\n      this.addChild = addChild;\n      this.removeChild = removeChild;\n    } else {\n      const instance = create(ComponentConstructor.prototype);\n\n      this.instance = instance;\n      this.name = template.e;\n\n      if (instance.el || instance.target) {\n        warnIfDebug(\n          `The <${this.name}> component has a default '${\n            instance.el ? 'el' : 'target'\n          }' property; it has been disregarded`\n        );\n        instance.el = instance.target = null;\n      }\n\n      // find container\n      let fragment = options.up;\n      let container;\n      while (fragment) {\n        if (fragment.owner.type === YIELDER) {\n          container = fragment.owner.container;\n          break;\n        }\n\n        fragment = fragment.parent;\n      }\n\n      // add component-instance-specific properties\n      instance.parent = this.up.ractive;\n      instance.container = container || null;\n      instance.root = instance.parent.root;\n      instance.component = this;\n\n      construct(this.instance, { partials });\n\n      // these can be modified during construction\n      template = this.template;\n      attrs = template.m;\n\n      // allow components that are so inclined to add programmatic mappings\n      if (isArray(this.mappings)) {\n        attrs = (attrs || []).concat(this.mappings);\n      } else if (isString(this.mappings)) {\n        attrs = (attrs || []).concat(parser.parse(this.mappings, { attributes: true }).t);\n      }\n\n      // for hackability, this could be an open option\n      // for any ractive instance, but for now, just\n      // for components and just for ractive...\n      instance._inlinePartials = partials;\n    }\n\n    this.attributeByName = {};\n    this.attributes = [];\n\n    if (attrs) {\n      const leftovers = [];\n      attrs.forEach(template => {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case EVENT:\n            this.attributes.push(\n              createItem({\n                owner: this,\n                up: this.up,\n                template\n              })\n            );\n            break;\n\n          case TRANSITION:\n          case BINDING_FLAG:\n          case DECORATOR:\n            break;\n\n          default:\n            leftovers.push(template);\n            break;\n        }\n      });\n\n      if (leftovers.length) {\n        this.attributes.push(\n          new ConditionalAttribute({\n            owner: this,\n            up: this.up,\n            template: leftovers\n          })\n        );\n      }\n    }\n\n    this.eventHandlers = [];\n  }\n\n  bind() {\n    if (!this.isAnchor) {\n      this.attributes.forEach(bind);\n      this.eventHandlers.forEach(bind);\n\n      initialise(\n        this.instance,\n        {\n          partials: this._partials\n        },\n        {\n          cssIds: this.up.cssIds\n        }\n      );\n\n      if (this.instance.target || this.instance.el) this.extern = true;\n\n      this.bound = true;\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (!this.isAnchor && this.instance.fragment) this.instance.fragment.destroyed();\n  }\n\n  detach() {\n    if (this.isAnchor) {\n      if (this.instance) return this.instance.fragment.detach();\n      return createDocumentFragment();\n    }\n\n    return this.instance.fragment.detach();\n  }\n\n  find(selector, options) {\n    if (this.instance) return this.instance.fragment.find(selector, options);\n  }\n\n  findAll(selector, options) {\n    if (this.instance) this.instance.fragment.findAll(selector, options);\n  }\n\n  findComponent(name, options) {\n    if (!name || this.name === name) return this.instance;\n\n    if (this.instance.fragment) {\n      return this.instance.fragment.findComponent(name, options);\n    }\n  }\n\n  findAllComponents(name, options) {\n    const { result } = options;\n\n    if (this.instance && (!name || this.name === name)) {\n      result.push(this.instance);\n    }\n\n    if (this.instance) this.instance.findAllComponents(name, options);\n  }\n\n  firstNode(skipParent) {\n    if (this.instance) return this.instance.fragment.firstNode(skipParent);\n  }\n\n  getContext(...assigns) {\n    assigns.unshift(this.instance);\n    return getRactiveContext.apply(null, assigns);\n  }\n\n  render(target, occupants) {\n    if (this.isAnchor) {\n      this.rendered = true;\n      this.target = target;\n\n      if (!checking.length) {\n        checking.push(this.ractive);\n        if (occupants) {\n          this.occupants = occupants;\n          checkAnchors();\n          this.occupants = null;\n        } else {\n          runloop.scheduleTask(checkAnchors, true);\n        }\n      }\n    } else {\n      this.attributes.forEach(callRender);\n      this.eventHandlers.forEach(callRender);\n\n      if (this.extern) {\n        this.instance.delegate = false;\n        this.instance.render();\n      } else {\n        render(this.instance, target, null, occupants);\n      }\n\n      this.rendered = true;\n    }\n  }\n\n  shuffled() {\n    super.shuffled();\n    this.instance &&\n      !this.instance.isolated &&\n      this.instance.fragment &&\n      this.instance.fragment.shuffled();\n  }\n\n  toString() {\n    if (this.instance) return this.instance.toHTML();\n  }\n\n  unbind() {\n    if (!this.isAnchor) {\n      this.bound = false;\n\n      this.attributes.forEach(unbind);\n\n      teardown(this.instance, () => runloop.promise());\n    }\n  }\n\n  unrender(shouldDestroy) {\n    this.shouldDestroy = shouldDestroy;\n\n    if (this.isAnchor) {\n      if (this.item) unrenderItem(this, this.item);\n      this.target = null;\n      if (!checking.length) {\n        checking.push(this.ractive);\n        runloop.scheduleTask(checkAnchors, true);\n      }\n    } else {\n      this.instance.unrender();\n      this.instance.el = this.instance.target = null;\n      this.attributes.forEach(unrender);\n      this.eventHandlers.forEach(unrender);\n    }\n\n    this.rendered = false;\n  }\n\n  update() {\n    this.dirty = false;\n    if (this.instance) {\n      this.instance.fragment.update();\n      this.attributes.forEach(update);\n      this.eventHandlers.forEach(update);\n    }\n  }\n}\n\nfunction addChild(meta) {\n  if (this.item) this.removeChild(this.item);\n\n  const child = meta.instance;\n  meta.anchor = this;\n\n  meta.up = this.up;\n  meta.name = meta.nameOption || this.name;\n  this.name = meta.name;\n\n  if (!child.isolated) child.viewmodel.attached(this.up);\n\n  // render as necessary\n  if (this.rendered) {\n    renderItem(this, meta);\n  }\n}\n\nfunction removeChild(meta) {\n  // unrender as necessary\n  if (this.item === meta) {\n    unrenderItem(this, meta);\n    this.name = this.template.n;\n  }\n}\n\nfunction renderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = false;\n  meta.up = anchor.up;\n\n  anchor.item = meta;\n  anchor.instance = meta.instance;\n  const nextNode = anchor.up.findNextNode(anchor);\n\n  if (meta.instance.fragment.rendered) {\n    meta.instance.unrender();\n  }\n\n  meta.partials = meta.instance.partials;\n  meta.instance.partials = assign(create(meta.partials), meta.partials, anchor._partials);\n\n  meta.instance.fragment.unbind();\n  meta.instance.fragment.componentParent = anchor.up;\n  meta.instance.fragment.bind(meta.instance.viewmodel);\n\n  anchor.attributes.forEach(bind);\n  anchor.eventHandlers.forEach(bind);\n  anchor.attributes.forEach(callRender);\n  anchor.eventHandlers.forEach(callRender);\n\n  const target = anchor.up.findParentNode();\n  render(meta.instance, target, target.contains(nextNode) ? nextNode : null, anchor.occupants);\n\n  if (meta.lastBound !== anchor) {\n    meta.lastBound = anchor;\n  }\n}\n\nfunction unrenderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = true;\n  meta.instance.unrender();\n\n  anchor.eventHandlers.forEach(unrender);\n  anchor.attributes.forEach(unrender);\n  anchor.eventHandlers.forEach(unbind);\n  anchor.attributes.forEach(unbind);\n\n  meta.instance.el = meta.instance.anchor = null;\n  meta.instance.fragment.componentParent = null;\n  meta.up = null;\n  meta.anchor = null;\n  anchor.item = null;\n  anchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors() {\n  const list = checking;\n  checking = [];\n\n  list.forEach(updateAnchors);\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { warnOnce } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport noop from 'utils/noop';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'src/shared/rebind';\nimport findElement from '../shared/findElement';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\n\nconst missingDecorator = {\n  update: noop,\n  teardown: noop\n};\n\nexport default class Decorator {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.up = options.up || this.owner.up;\n    this.ractive = this.owner.ractive;\n    const template = (this.template = options.template);\n\n    this.name = template.n;\n\n    this.node = null;\n    this.handle = null;\n\n    this.element.decorators.push(this);\n  }\n\n  bind() {\n    setupArgsFn(this, this.template, this.up, { register: true });\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      // decorators may be owned directly by an element or by a fragment if conditional\n      this.owner.bubble();\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n    this.shouldDestroy = true;\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n    if (!~idx) return;\n\n    next = rebindMatch(this.template.f.r[idx], next, previous);\n    if (next === previous) return;\n\n    previous.unregister(this);\n    this.models.splice(idx, 1, next);\n    if (next) next.addShuffleRegister(this, 'mark');\n\n    if (!safe) this.bubble();\n  }\n\n  render() {\n    this.shouldDestroy = false;\n    if (this.handle) this.unrender();\n    runloop.scheduleTask(() => {\n      const fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n      if (!fn) {\n        warnOnce(missingPlugin(this.name, 'decorator'));\n        this.handle = missingDecorator;\n        return;\n      }\n\n      this.node = this.element.node;\n\n      let args;\n      if (this.fn) {\n        args = this.models.map(model => {\n          if (!model) return undefined;\n\n          return model.get();\n        });\n        args = this.fn.apply(this.ractive, args);\n      }\n\n      this.handle = fn.apply(this.ractive, [this.node].concat(args));\n\n      if (!this.handle || !this.handle.teardown) {\n        throw new Error(\n          `The '${this.name}' decorator must return an object with a teardown method`\n        );\n      }\n\n      // watch out for decorators that cause their host element to be unrendered\n      if (this.shouldDestroy) this.destroyed();\n    }, true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    teardownArgsFn(this, this.template);\n  }\n\n  unrender(shouldDestroy) {\n    if ((!shouldDestroy || this.element.rendered) && this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n  }\n\n  update() {\n    const instance = this.handle;\n\n    if (!this.dirty) {\n      if (instance && instance.invalidate) {\n        runloop.scheduleTask(() => instance.invalidate(), true);\n      }\n      return;\n    }\n\n    this.dirty = false;\n\n    if (instance) {\n      if (!instance.update) {\n        this.unrender();\n        this.render();\n      } else {\n        const args = this.models.map(model => model && model.get());\n        instance.update.apply(this.ractive, this.fn.apply(this.ractive, args));\n      }\n    }\n  }\n}\n","import noop from 'utils/noop';\nimport Item from './shared/Item';\n\nexport default class Doctype extends Item {\n  toString() {\n    return '<!DOCTYPE' + this.template.a + '>';\n  }\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","import { escapeKey, unescapeKey } from 'shared/keypaths';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction } from 'utils/is';\nimport bind from 'utils/bind';\nimport { create, keys as objectKeys } from 'utils/object';\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\nexport const noVirtual = { virtual: false };\n\nexport default class ModelBase {\n  constructor(parent) {\n    this.deps = [];\n\n    this.children = [];\n    this.childByKey = {};\n    this.links = [];\n\n    this.bindings = [];\n\n    if (parent) {\n      this.parent = parent;\n      this.root = parent.root;\n    }\n  }\n\n  addShuffleTask(task, stage = 'early') {\n    shuffleTasks[stage].push(task);\n  }\n  addShuffleRegister(item, stage = 'early') {\n    registerQueue[stage].push({ model: this, item });\n  }\n\n  downstreamChanged() {}\n\n  findMatches(keys) {\n    const len = keys.length;\n\n    let existingMatches = [this];\n    let matches;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const key = keys[i];\n\n      if (key === '*') {\n        matches = [];\n        existingMatches.forEach(model => {\n          matches.push.apply(matches, model.getValueChildren(model.get()));\n        });\n      } else {\n        matches = existingMatches.map(model => model.joinKey(key));\n      }\n\n      existingMatches = matches;\n    }\n\n    return matches;\n  }\n\n  getKeypath(ractive) {\n    if (ractive !== this.ractive && this._link) return this._link.target.getKeypath(ractive);\n\n    if (!this.keypath) {\n      const parent = this.parent && this.parent.getKeypath(ractive);\n      this.keypath = parent\n        ? `${this.parent.getKeypath(ractive)}.${escapeKey(this.key)}`\n        : escapeKey(this.key);\n    }\n\n    return this.keypath;\n  }\n\n  getValueChildren(value) {\n    let children;\n    if (isArray(value)) {\n      children = [];\n      if ('length' in this && this.length !== value.length) {\n        children.push(this.joinKey('length'));\n      }\n      value.forEach((m, i) => {\n        children.push(this.joinKey(i));\n      });\n    } else if (isObject(value) || isFunction(value)) {\n      children = objectKeys(value).map(key => this.joinKey(key));\n    } else if (value != null) {\n      children = [];\n    }\n\n    const computed = this.computed;\n    if (computed) {\n      children.push.apply(children, objectKeys(computed).map(k => this.joinKey(k)));\n    }\n\n    return children;\n  }\n\n  getVirtual(shouldCapture) {\n    const value = this.get(shouldCapture, { virtual: false });\n    if (isObject(value)) {\n      const result = isArray(value) ? [] : create(null);\n\n      let keys = objectKeys(value);\n      let i = keys.length;\n      while (i--) {\n        const child = this.childByKey[keys[i]];\n        if (!child) result[keys[i]] = value[keys[i]];\n        else if (child._link) result[keys[i]] = child._link.getVirtual();\n        else result[keys[i]] = child.getVirtual();\n      }\n\n      i = this.children.length;\n      while (i--) {\n        const child = this.children[i];\n        if (!(child.key in result) && child._link) {\n          result[child.key] = child._link.getVirtual();\n        }\n      }\n\n      if (this.computed) {\n        keys = objectKeys(this.computed);\n        i = keys.length;\n        while (i--) {\n          result[keys[i]] = this.computed[keys[i]].get();\n        }\n      }\n\n      return result;\n    } else return value;\n  }\n\n  has(key) {\n    if (this._link) return this._link.has(key);\n\n    const value = this.get(false, noVirtual);\n    if (!value) return false;\n\n    key = unescapeKey(key);\n    if ((isFunction(value) || isObject(value)) && key in value) return true;\n\n    let computed = this.computed;\n    if (computed && key in this.computed) return true;\n\n    computed = this.root.ractive && this.root.ractive.computed;\n    if (computed) {\n      objectKeys(computed).forEach(k => {\n        if (computed[k].pattern && computed[k].pattern.test(this.getKeypath())) return true;\n      });\n    }\n\n    return false;\n  }\n\n  joinAll(keys, opts) {\n    let model = this;\n    for (let i = 0; i < keys.length; i += 1) {\n      if (\n        opts &&\n        opts.lastLink === false &&\n        i + 1 === keys.length &&\n        model.childByKey[keys[i]] &&\n        model.childByKey[keys[i]]._link\n      )\n        return model.childByKey[keys[i]];\n      model = model.joinKey(keys[i], opts);\n    }\n\n    return model;\n  }\n\n  notifyUpstream(startPath) {\n    let parent = this.parent;\n    const path = startPath || [this.key];\n    while (parent) {\n      if (parent.patterns) parent.patterns.forEach(o => o.notify(path.slice()));\n      path.unshift(parent.key);\n      parent.links.forEach(l => l.notifiedUpstream(path, this.root));\n      parent.deps.forEach(d => d.handleChange(path));\n      parent.downstreamChanged(startPath);\n      parent = parent.parent;\n    }\n  }\n\n  rebind(next, previous, safe) {\n    if (this._link) {\n      this._link.rebind(next, previous, false);\n    }\n\n    // tell the deps to move to the new target\n    let i = this.deps.length;\n    while (i--) {\n      if (this.deps[i].rebind) this.deps[i].rebind(next, previous, safe);\n    }\n\n    i = this.links.length;\n    while (i--) {\n      const link = this.links[i];\n      // only relink the root of the link tree\n      if (link.owner._link) link.relinking(next, safe);\n    }\n\n    i = this.children.length;\n    while (i--) {\n      const child = this.children[i];\n      child.rebind(next ? next.joinKey(child.key) : undefined, child, safe);\n    }\n\n    i = this.bindings.length;\n    while (i--) {\n      this.bindings[i].rebind(next, previous, safe);\n    }\n  }\n\n  reference() {\n    'refs' in this ? this.refs++ : (this.refs = 1);\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  registerPatternObserver(observer) {\n    (this.patterns || (this.patterns = [])).push(observer);\n    this.register(observer);\n  }\n\n  registerTwowayBinding(binding) {\n    this.bindings.push(binding);\n  }\n\n  unreference() {\n    if ('refs' in this) this.refs--;\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n\n  unregisterPatternObserver(observer) {\n    removeFromArray(this.patterns, observer);\n    this.unregister(observer);\n  }\n\n  unregisterTwowayBinding(binding) {\n    removeFromArray(this.bindings, binding);\n  }\n\n  updateFromBindings(cascade) {\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) this.set(value);\n    }\n\n    // check for one-way bindings if there are no two-ways\n    if (!this.bindings.length) {\n      const oneway = findBoundValue(this.deps);\n      if (oneway && oneway.value !== this.value) this.set(oneway.value);\n    }\n\n    if (cascade) {\n      this.children.forEach(updateFromBindings);\n      this.links.forEach(updateFromBindings);\n      if (this._link) this._link.updateFromBindings(cascade);\n    }\n  }\n}\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nexport function maybeBind(model, value, shouldBind) {\n  if (shouldBind && isFunction(value) && model.parent && model.parent.isRoot) {\n    if (!model.boundValue) {\n      model.boundValue = bind(value._r_unbound || value, model.parent.ractive);\n    }\n\n    return model.boundValue;\n  }\n\n  return value;\n}\n\nfunction updateFromBindings(model) {\n  model.updateFromBindings(true);\n}\n\nexport function findBoundValue(list) {\n  let i = list.length;\n  while (i--) {\n    if (list[i].bound) {\n      const owner = list[i].owner;\n      if (owner) {\n        const value = owner.name === 'checked' ? owner.node.checked : owner.node.value;\n        return { value };\n      }\n    }\n  }\n}\n\nexport function fireShuffleTasks(stage) {\n  if (!stage) {\n    fireShuffleTasks('early');\n    fireShuffleTasks('mark');\n  } else {\n    const tasks = shuffleTasks[stage];\n    shuffleTasks[stage] = [];\n    let i = tasks.length;\n    while (i--) tasks[i]();\n\n    const register = registerQueue[stage];\n    registerQueue[stage] = [];\n    i = register.length;\n    while (i--) register[i].model.register(register[i].item);\n  }\n}\n\nexport function shuffle(model, newIndices, link, unsafe) {\n  model.shuffling = true;\n\n  let i = newIndices.length;\n  while (i--) {\n    const idx = newIndices[i];\n    // nothing is actually changing, so move in the index and roll on\n    if (i === idx) {\n      continue;\n    }\n\n    // rebind the children on i to idx\n    if (i in model.childByKey)\n      model.childByKey[i].rebind(\n        !~idx ? undefined : model.joinKey(idx),\n        model.childByKey[i],\n        !unsafe\n      );\n  }\n\n  const upstream = model.source().length !== model.source().value.length;\n\n  model.links.forEach(l => l.shuffle(newIndices));\n  if (!link) fireShuffleTasks('early');\n\n  i = model.deps.length;\n  while (i--) {\n    if (model.deps[i].shuffle) model.deps[i].shuffle(newIndices);\n  }\n\n  model[link ? 'marked' : 'mark']();\n  if (!link) fireShuffleTasks('mark');\n\n  if (upstream) model.notifyUpstream();\n\n  model.shuffling = false;\n}\n","const stack = [];\nlet captureGroup;\n\nexport function startCapturing() {\n  stack.push((captureGroup = []));\n}\n\nexport function stopCapturing() {\n  const dependencies = stack.pop();\n  captureGroup = stack[stack.length - 1];\n  return dependencies;\n}\n\nexport function capture(model) {\n  if (captureGroup) {\n    captureGroup.push(model);\n  }\n}\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from 'shared/methodCallers';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn } from 'utils/object';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n  key: '@missing',\n  animate: noop,\n  applyValue: noop,\n  get: noop,\n  getKeypath() {\n    return this.key;\n  },\n  joinAll() {\n    return this;\n  },\n  joinKey() {\n    return this;\n  },\n  mark: noop,\n  registerLink: noop,\n  shufle: noop,\n  set: noop,\n  unregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n  constructor(parent, owner, target, key) {\n    super(parent);\n\n    this.owner = owner;\n    this.target = target;\n    this.key = key === undefined ? owner.key : key;\n    if (owner.isLink) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n    target.registerLink(this);\n\n    if (parent) this.isReadonly = parent.isReadonly;\n\n    this.isLink = true;\n  }\n\n  animate(from, to, options, interpolator) {\n    return this.target.animate(from, to, options, interpolator);\n  }\n\n  applyValue(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.applyValue(value);\n  }\n\n  attach(fragment) {\n    const model = resolveReference(fragment, this.key);\n    if (model) {\n      this.relinking(model, false);\n    } else {\n      // if there is no link available, move everything here to real models\n      this.owner.unlink();\n    }\n  }\n\n  detach() {\n    this.relinking(Missing, false);\n  }\n\n  get(shouldCapture, opts = {}) {\n    if (shouldCapture) {\n      capture(this);\n\n      // may need to tell the target to unwrap\n      opts.unwrap = 'unwrap' in opts ? opts.unwrap : true;\n    }\n\n    const bind = 'shouldBind' in opts ? opts.shouldBind : true;\n    opts.shouldBind = this.mapping && this.target.parent && this.target.parent.isRoot;\n\n    return maybeBind(this, this.target.get(false, opts), bind);\n  }\n\n  getKeypath(ractive) {\n    if (ractive && ractive !== this.root.ractive) return this.target.getKeypath(ractive);\n\n    return super.getKeypath(ractive);\n  }\n\n  handleChange() {\n    this.deps.forEach(handleChange);\n    this.links.forEach(handleChange);\n    this.notifyUpstream();\n  }\n\n  isDetached() {\n    return this.virtual && this.target === Missing;\n  }\n\n  joinKey(key) {\n    // TODO: handle nested links\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new LinkModel(this, this, this.target.joinKey(key), key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    this.target.mark(force);\n  }\n\n  marked() {\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n\n    this.deps.forEach(handleChange);\n  }\n\n  markedAll() {\n    this.children.forEach(markedAll);\n    this.marked();\n  }\n\n  notifiedUpstream(startPath, root) {\n    this.links.forEach(l => l.notifiedUpstream(startPath, this.root));\n    this.deps.forEach(handleChange);\n    if (startPath && this.rootLink && this.root !== root) {\n      const path = startPath.slice(1);\n      path.unshift(this.key);\n      this.notifyUpstream(path);\n    }\n  }\n\n  relinked() {\n    this.target.registerLink(this);\n    this.children.forEach(c => c.relinked());\n  }\n\n  relinking(target, safe) {\n    if (this.rootLink && this.sourcePath)\n      target = rebindMatch(this.sourcePath, target, this.target);\n    if (!target || this.target === target) return;\n\n    this.target.unregisterLink(this);\n\n    this.target = target;\n    this.children.forEach(c => {\n      c.relinking(target.joinKey(c.key), safe);\n    });\n\n    if (this.rootLink)\n      this.addShuffleTask(() => {\n        this.relinked();\n        if (!safe) {\n          this.markedAll();\n          this.notifyUpstream();\n        }\n      });\n  }\n\n  set(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.set(value);\n  }\n\n  shuffle(newIndices) {\n    // watch for extra shuffles caused by a shuffle in a downstream link\n    if (this.shuffling) return;\n\n    // let the real model handle firing off shuffles\n    if (!this.target.shuffling) {\n      if (this.target.shuffle) {\n        this.target.shuffle(newIndices);\n      } else {\n        // the target is a computation, which can't shuffle\n        this.target.mark();\n      }\n    } else {\n      shuffle(this, newIndices, true);\n    }\n  }\n\n  source() {\n    if (this.target.source) return this.target.source();\n    else return this.target;\n  }\n\n  teardown() {\n    if (this._link) this._link.teardown();\n    this.target.unregisterLink(this);\n    this.children.forEach(teardown);\n  }\n}\n\nModelBase.prototype.link = function link(model, keypath, options) {\n  const lnk = this._link || new LinkModel(this.parent, this, model, this.key);\n  lnk.implicit = options && options.implicit;\n  lnk.mapping = options && options.mapping;\n  lnk.sourcePath = keypath;\n  lnk.rootLink = true;\n  if (this._link) this._link.relinking(model, false);\n  this.rebind(lnk, this, false);\n  fireShuffleTasks();\n\n  this._link = lnk;\n  lnk.markedAll();\n\n  this.notifyUpstream();\n  return lnk;\n};\n\nModelBase.prototype.unlink = function unlink() {\n  if (this._link) {\n    const ln = this._link;\n    this._link = undefined;\n    ln.rebind(this, ln, false);\n    fireShuffleTasks();\n    ln.teardown();\n    this.notifyUpstream();\n  }\n};\n","import { createFunction } from '../Ractive/config/runtime-parser';\nimport { create, keys } from 'utils/object';\n\nconst functions = create(null);\n\nexport default function getFunction(str, i) {\n  if (functions[str]) return functions[str];\n  return (functions[str] = createFunction(str, i));\n}\n\nexport function addFunctions(template) {\n  if (!template) return;\n\n  const exp = template.e;\n\n  if (!exp) return;\n\n  keys(exp).forEach(str => {\n    if (functions[str]) return;\n    functions[str] = exp[str];\n  });\n}\n","export const TEMPLATE_VERSION = 4;\n","import { warnIfDebug } from 'utils/log';\nimport { create, hasOwn } from 'utils/object';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function(message) {\n  this.name = 'ParseError';\n  this.message = message;\n  try {\n    throw new Error(message);\n  } catch (e) {\n    this.stack = e.stack;\n  }\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function(str, options) {\n  let item;\n  let lineStart = 0;\n\n  this.str = str;\n  this.options = options || {};\n  this.pos = 0;\n\n  this.lines = this.str.split('\\n');\n  this.lineEnds = this.lines.map(line => {\n    const lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n    lineStart = lineEnd;\n    return lineEnd;\n  }, 0);\n\n  // Custom init logic\n  if (this.init) this.init(str, options);\n\n  const items = [];\n\n  while (this.pos < this.str.length && (item = this.read())) {\n    items.push(item);\n  }\n\n  this.leftover = this.remaining();\n  this.result = this.postProcess ? this.postProcess(items, options) : items;\n};\n\nParser.prototype = {\n  read(converters) {\n    let i, item;\n\n    if (!converters) converters = this.converters;\n\n    const pos = this.pos;\n\n    const len = converters.length;\n    for (i = 0; i < len; i += 1) {\n      this.pos = pos; // reset for each attempt\n\n      if ((item = converters[i](this))) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  getContextMessage(pos, message) {\n    const [lineNum, columnNum] = this.getLinePos(pos);\n    if (this.options.contextLines === -1) {\n      return [lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}`];\n    }\n\n    const line = this.lines[lineNum - 1];\n\n    let contextUp = '';\n    let contextDown = '';\n    if (this.options.contextLines) {\n      const start =\n        lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n      contextUp = this.lines\n        .slice(start, lineNum - 1 - start)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      contextDown = this.lines\n        .slice(lineNum, lineNum + this.options.contextLines)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      if (contextUp) {\n        contextUp += '\\n';\n      }\n      if (contextDown) {\n        contextDown = '\\n' + contextDown;\n      }\n    }\n\n    let numTabs = 0;\n    const annotation =\n      contextUp +\n      line.replace(/\\t/g, (match, char) => {\n        if (char < columnNum) {\n          numTabs += 1;\n        }\n\n        return '  ';\n      }) +\n      '\\n' +\n      new Array(columnNum + numTabs).join(' ') +\n      '^----' +\n      contextDown;\n\n    return [\n      lineNum,\n      columnNum,\n      `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}`\n    ];\n  },\n\n  getLinePos(char) {\n    let lineNum = 0;\n    let lineStart = 0;\n\n    while (char >= this.lineEnds[lineNum]) {\n      lineStart = this.lineEnds[lineNum];\n      lineNum += 1;\n    }\n\n    const columnNum = char - lineStart;\n    return [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  },\n\n  error(message) {\n    const [lineNum, columnNum, msg] = this.getContextMessage(this.pos, message);\n\n    const error = new ParseError(msg);\n\n    error.line = lineNum;\n    error.character = columnNum;\n    error.shortMessage = message;\n\n    throw error;\n  },\n\n  matchString(string) {\n    if (this.str.substr(this.pos, string.length) === string) {\n      this.pos += string.length;\n      return string;\n    }\n  },\n\n  matchPattern(pattern) {\n    let match;\n\n    if ((match = pattern.exec(this.remaining()))) {\n      this.pos += match[0].length;\n      return match[1] || match[0];\n    }\n  },\n\n  sp() {\n    this.matchPattern(leadingWhitespace);\n  },\n\n  remaining() {\n    return this.str.substring(this.pos);\n  },\n\n  nextChar() {\n    return this.str.charAt(this.pos);\n  },\n\n  warn(message) {\n    const msg = this.getContextMessage(this.pos, message)[2];\n\n    warnIfDebug(msg);\n  }\n};\n\nParser.extend = function(proto) {\n  const Parent = this;\n  const Child = function(str, options) {\n    Parser.call(this, str, options);\n  };\n\n  Child.prototype = create(Parent.prototype);\n\n  for (const key in proto) {\n    if (hasOwn(proto, key)) {\n      Child.prototype[key] = proto[key];\n    }\n  }\n\n  Child.extend = Parser.extend;\n  return Child;\n};\n\nexport default Parser;\n","export const TEXT = 1;\nexport const INTERPOLATOR = 2;\nexport const TRIPLE = 3;\nexport const SECTION = 4;\nexport const INVERTED = 5;\nexport const CLOSING = 6;\nexport const ELEMENT = 7;\nexport const PARTIAL = 8;\nexport const COMMENT = 9;\nexport const DELIMCHANGE = 10;\nexport const ANCHOR = 11;\nexport const ATTRIBUTE = 13;\nexport const CLOSING_TAG = 14;\nexport const COMPONENT = 15;\nexport const YIELDER = 16;\nexport const INLINE_PARTIAL = 17;\nexport const DOCTYPE = 18;\nexport const ALIAS = 19;\n\nexport const AWAIT = 55;\n\nexport const NUMBER_LITERAL = 20;\nexport const STRING_LITERAL = 21;\nexport const ARRAY_LITERAL = 22;\nexport const OBJECT_LITERAL = 23;\nexport const BOOLEAN_LITERAL = 24;\nexport const REGEXP_LITERAL = 25;\n\nexport const GLOBAL = 26;\nexport const KEY_VALUE_PAIR = 27;\n\nexport const REFERENCE = 30;\nexport const REFINEMENT = 31;\nexport const MEMBER = 32;\nexport const PREFIX_OPERATOR = 33;\nexport const BRACKETED = 34;\nexport const CONDITIONAL = 35;\nexport const INFIX_OPERATOR = 36;\n\nexport const INVOCATION = 40;\n\nexport const SECTION_IF = 50;\nexport const SECTION_UNLESS = 51;\nexport const SECTION_EACH = 52;\nexport const SECTION_WITH = 53;\nexport const SECTION_IF_WITH = 54;\n\nexport const ELSE = 60;\nexport const ELSEIF = 61;\nexport const THEN = 62;\nexport const CATCH = 63;\n\nexport const EVENT = 70;\nexport const DECORATOR = 71;\nexport const TRANSITION = 72;\nexport const BINDING_FLAG = 73;\nexport const DELEGATE_FLAG = 74;\n","import { PREFIX_OPERATOR } from 'config/types';\nimport { expectedExpression } from './shared/errors';\nimport readMemberOrInvocation from './readMemberOrInvocation';\nimport readExpression from '../readExpression';\n\nlet readTypeOf;\n\nconst makePrefixSequenceMatcher = function(symbol, fallthrough) {\n  return function(parser) {\n    let expression;\n\n    if ((expression = fallthrough(parser))) {\n      return expression;\n    }\n\n    if (!parser.matchString(symbol)) {\n      return null;\n    }\n\n    parser.sp();\n\n    expression = readExpression(parser);\n    if (!expression) {\n      parser.error(expectedExpression);\n    }\n\n    return {\n      s: symbol,\n      o: expression,\n      t: PREFIX_OPERATOR\n    };\n  };\n};\n\n// create all prefix sequence matchers, return readTypeOf\n(function() {\n  let i, len, matcher, fallthrough;\n\n  const prefixOperators = '! ~ + - typeof'.split(' ');\n\n  fallthrough = readMemberOrInvocation;\n  for (i = 0, len = prefixOperators.length; i < len; i += 1) {\n    matcher = makePrefixSequenceMatcher(prefixOperators[i], fallthrough);\n    fallthrough = matcher;\n  }\n\n  // typeof operator is higher precedence than multiplication, so provides the\n  // fallthrough for the multiplication sequence matcher we're about to create\n  // (we're skipping void and delete)\n  readTypeOf = fallthrough;\n})();\n\nexport default readTypeOf;\n","const delimiterChangePattern = /^[^\\s=]+/;\nconst whitespacePattern = /^\\s+/;\n\nexport default function readDelimiterChange(parser) {\n  if (!parser.matchString('=')) {\n    return null;\n  }\n\n  const start = parser.pos;\n\n  // allow whitespace before new opening delimiter\n  parser.sp();\n\n  const opening = parser.matchPattern(delimiterChangePattern);\n  if (!opening) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace (in fact, it's necessary...)\n  if (!parser.matchPattern(whitespacePattern)) {\n    return null;\n  }\n\n  const closing = parser.matchPattern(delimiterChangePattern);\n  if (!closing) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace before closing '='\n  parser.sp();\n\n  if (!parser.matchString('=')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return [opening, closing];\n}\n","import { REGEXP_LITERAL } from '../../../../../config/types';\n\nconst regexpPattern = /^(\\/(?:[^\\n\\r\\u2028\\u2029/\\\\[]|\\\\.|\\[(?:[^\\n\\r\\u2028\\u2029\\]\\\\]|\\\\.)*])+\\/(?:([gimuy])(?![a-z]*\\2))*(?![a-zA-Z_$0-9]))/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(regexpPattern))) {\n    return {\n      t: REGEXP_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","const pattern = /[-/\\\\^$*+?.()|[\\]{}]/g;\n\nexport default function escapeRegExp(str) {\n  return str.replace(pattern, '\\\\$&');\n}\n","import escapeRegExp from 'utils/escapeRegExp';\n\nconst regExpCache = {};\n\nexport default function(haystack, needles) {\n  return haystack.search(\n    regExpCache[needles.join()] ||\n      (regExpCache[needles.join()] = new RegExp(needles.map(escapeRegExp).join('|')))\n  );\n}\n","import { keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nexport const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nconst htmlEntities = {\n  quot: 34,\n  amp: 38,\n  apos: 39,\n  lt: 60,\n  gt: 62,\n  nbsp: 160,\n  iexcl: 161,\n  cent: 162,\n  pound: 163,\n  curren: 164,\n  yen: 165,\n  brvbar: 166,\n  sect: 167,\n  uml: 168,\n  copy: 169,\n  ordf: 170,\n  laquo: 171,\n  not: 172,\n  shy: 173,\n  reg: 174,\n  macr: 175,\n  deg: 176,\n  plusmn: 177,\n  sup2: 178,\n  sup3: 179,\n  acute: 180,\n  micro: 181,\n  para: 182,\n  middot: 183,\n  cedil: 184,\n  sup1: 185,\n  ordm: 186,\n  raquo: 187,\n  frac14: 188,\n  frac12: 189,\n  frac34: 190,\n  iquest: 191,\n  Agrave: 192,\n  Aacute: 193,\n  Acirc: 194,\n  Atilde: 195,\n  Auml: 196,\n  Aring: 197,\n  AElig: 198,\n  Ccedil: 199,\n  Egrave: 200,\n  Eacute: 201,\n  Ecirc: 202,\n  Euml: 203,\n  Igrave: 204,\n  Iacute: 205,\n  Icirc: 206,\n  Iuml: 207,\n  ETH: 208,\n  Ntilde: 209,\n  Ograve: 210,\n  Oacute: 211,\n  Ocirc: 212,\n  Otilde: 213,\n  Ouml: 214,\n  times: 215,\n  Oslash: 216,\n  Ugrave: 217,\n  Uacute: 218,\n  Ucirc: 219,\n  Uuml: 220,\n  Yacute: 221,\n  THORN: 222,\n  szlig: 223,\n  agrave: 224,\n  aacute: 225,\n  acirc: 226,\n  atilde: 227,\n  auml: 228,\n  aring: 229,\n  aelig: 230,\n  ccedil: 231,\n  egrave: 232,\n  eacute: 233,\n  ecirc: 234,\n  euml: 235,\n  igrave: 236,\n  iacute: 237,\n  icirc: 238,\n  iuml: 239,\n  eth: 240,\n  ntilde: 241,\n  ograve: 242,\n  oacute: 243,\n  ocirc: 244,\n  otilde: 245,\n  ouml: 246,\n  divide: 247,\n  oslash: 248,\n  ugrave: 249,\n  uacute: 250,\n  ucirc: 251,\n  uuml: 252,\n  yacute: 253,\n  thorn: 254,\n  yuml: 255,\n  OElig: 338,\n  oelig: 339,\n  Scaron: 352,\n  scaron: 353,\n  Yuml: 376,\n  fnof: 402,\n  circ: 710,\n  tilde: 732,\n  Alpha: 913,\n  Beta: 914,\n  Gamma: 915,\n  Delta: 916,\n  Epsilon: 917,\n  Zeta: 918,\n  Eta: 919,\n  Theta: 920,\n  Iota: 921,\n  Kappa: 922,\n  Lambda: 923,\n  Mu: 924,\n  Nu: 925,\n  Xi: 926,\n  Omicron: 927,\n  Pi: 928,\n  Rho: 929,\n  Sigma: 931,\n  Tau: 932,\n  Upsilon: 933,\n  Phi: 934,\n  Chi: 935,\n  Psi: 936,\n  Omega: 937,\n  alpha: 945,\n  beta: 946,\n  gamma: 947,\n  delta: 948,\n  epsilon: 949,\n  zeta: 950,\n  eta: 951,\n  theta: 952,\n  iota: 953,\n  kappa: 954,\n  lambda: 955,\n  mu: 956,\n  nu: 957,\n  xi: 958,\n  omicron: 959,\n  pi: 960,\n  rho: 961,\n  sigmaf: 962,\n  sigma: 963,\n  tau: 964,\n  upsilon: 965,\n  phi: 966,\n  chi: 967,\n  psi: 968,\n  omega: 969,\n  thetasym: 977,\n  upsih: 978,\n  piv: 982,\n  ensp: 8194,\n  emsp: 8195,\n  thinsp: 8201,\n  zwnj: 8204,\n  zwj: 8205,\n  lrm: 8206,\n  rlm: 8207,\n  ndash: 8211,\n  mdash: 8212,\n  lsquo: 8216,\n  rsquo: 8217,\n  sbquo: 8218,\n  ldquo: 8220,\n  rdquo: 8221,\n  bdquo: 8222,\n  dagger: 8224,\n  Dagger: 8225,\n  bull: 8226,\n  hellip: 8230,\n  permil: 8240,\n  prime: 8242,\n  Prime: 8243,\n  lsaquo: 8249,\n  rsaquo: 8250,\n  oline: 8254,\n  frasl: 8260,\n  euro: 8364,\n  image: 8465,\n  weierp: 8472,\n  real: 8476,\n  trade: 8482,\n  alefsym: 8501,\n  larr: 8592,\n  uarr: 8593,\n  rarr: 8594,\n  darr: 8595,\n  harr: 8596,\n  crarr: 8629,\n  lArr: 8656,\n  uArr: 8657,\n  rArr: 8658,\n  dArr: 8659,\n  hArr: 8660,\n  forall: 8704,\n  part: 8706,\n  exist: 8707,\n  empty: 8709,\n  nabla: 8711,\n  isin: 8712,\n  notin: 8713,\n  ni: 8715,\n  prod: 8719,\n  sum: 8721,\n  minus: 8722,\n  lowast: 8727,\n  radic: 8730,\n  prop: 8733,\n  infin: 8734,\n  ang: 8736,\n  and: 8743,\n  or: 8744,\n  cap: 8745,\n  cup: 8746,\n  int: 8747,\n  there4: 8756,\n  sim: 8764,\n  cong: 8773,\n  asymp: 8776,\n  ne: 8800,\n  equiv: 8801,\n  le: 8804,\n  ge: 8805,\n  sub: 8834,\n  sup: 8835,\n  nsub: 8836,\n  sube: 8838,\n  supe: 8839,\n  oplus: 8853,\n  otimes: 8855,\n  perp: 8869,\n  sdot: 8901,\n  lceil: 8968,\n  rceil: 8969,\n  lfloor: 8970,\n  rfloor: 8971,\n  lang: 9001,\n  rang: 9002,\n  loz: 9674,\n  spades: 9824,\n  clubs: 9827,\n  hearts: 9829,\n  diams: 9830\n};\nconst controlCharacters = [\n  8364,\n  129,\n  8218,\n  402,\n  8222,\n  8230,\n  8224,\n  8225,\n  710,\n  8240,\n  352,\n  8249,\n  338,\n  141,\n  381,\n  143,\n  144,\n  8216,\n  8217,\n  8220,\n  8221,\n  8226,\n  8211,\n  8212,\n  732,\n  8482,\n  353,\n  8250,\n  339,\n  157,\n  382,\n  376\n];\nconst entityPattern = new RegExp(\n  '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + keys(htmlEntities).join('|') + '));?',\n  'g'\n);\nconst codePointSupport = isFunction(String.fromCodePoint);\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences(html) {\n  return html.replace(entityPattern, (match, entity) => {\n    let code;\n\n    // Handle named entities\n    if (entity[0] !== '#') {\n      code = htmlEntities[entity];\n    } else if (entity[1] === 'x') {\n      code = parseInt(entity.substring(2), 16);\n    } else {\n      code = parseInt(entity.substring(1), 10);\n    }\n\n    if (!code) {\n      return match;\n    }\n\n    return codeToChar(validateCode(code));\n  });\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml(str) {\n  return str\n    .replace(amp, '&amp;')\n    .replace(lessThan, '&lt;')\n    .replace(greaterThan, '&gt;');\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n/* istanbul ignore next */\nfunction validateCode(code) {\n  if (!code) {\n    return invalid;\n  }\n\n  // line feed becomes generic whitespace\n  if (code === 10) {\n    return 32;\n  }\n\n  // ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  if (code < 128) {\n    return code;\n  }\n\n  // code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  // to correct the mistake or we'll end up with missing  signs and so on\n  if (code <= 159) {\n    return controlCharacters[code - 128];\n  }\n\n  // basic multilingual plane\n  if (code < 55296) {\n    return code;\n  }\n\n  // UTF-16 surrogate halves\n  if (code <= 57343) {\n    return invalid;\n  }\n\n  // rest of the basic multilingual plane\n  if (code <= 65535) {\n    return code;\n  } else if (!codePointSupport) {\n    return invalid;\n  }\n\n  // supplementary multilingual plane 0x10000 - 0x1ffff\n  if (code >= 65536 && code <= 131071) {\n    return code;\n  }\n\n  // supplementary ideographic plane 0x20000 - 0x2ffff\n  if (code >= 131072 && code <= 196607) {\n    return code;\n  }\n\n  return invalid;\n}\n","export const expectedExpression = 'Expected a JavaScript expression';\nexport const expectedParen = 'Expected closing paren';\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(numberPattern))) {\n    return {\n      t: NUMBER_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function(okQuote) {\n  return function(parser) {\n    let literal = '\"';\n    let done = false;\n    let next;\n\n    while (!done) {\n      next =\n        parser.matchPattern(stringMiddlePattern) ||\n        parser.matchPattern(escapeSequencePattern) ||\n        parser.matchString(okQuote);\n      if (next) {\n        if (next === `\"`) {\n          literal += `\\\\\"`;\n        } else if (next === `\\\\'`) {\n          literal += `'`;\n        } else {\n          literal += next;\n        }\n      } else {\n        next = parser.matchPattern(lineContinuationPattern);\n        if (next) {\n          // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n          literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n        } else {\n          done = true;\n        }\n      }\n    }\n\n    literal += '\"';\n\n    // use JSON.parse to interpret escapes\n    return JSON.parse(literal);\n  };\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher(`\"`);\nconst doubleMatcher = makeQuotedStringMatcher(`'`);\n\nexport default function(parser) {\n  const start = parser.pos;\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n\n  if (quote) {\n    const string = (quote === `'` ? singleMatcher : doubleMatcher)(parser);\n\n    if (!parser.matchString(quote)) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: STRING_LITERAL,\n      v: string\n    };\n  }\n\n  return null;\n}\n","import readExpression from '../../../readExpression';\nimport { STRING_LITERAL, BRACKETED, INFIX_OPERATOR } from '../../../../../config/types';\nimport {\n  escapeSequencePattern,\n  lineContinuationPattern\n} from './stringLiteral/makeQuotedStringMatcher';\n\n// Match one or more characters until: \", ', or \\\nconst stringMiddlePattern = /^[^`\"\\\\\\$]+?(?:(?=[`\"\\\\\\$]))/;\n\nconst escapes = /[\\r\\n\\t\\b\\f]/g;\nfunction getString(literal) {\n  return JSON.parse(`\"${literal.replace(escapes, escapeChar)}\"`);\n}\n\nfunction escapeChar(c) {\n  switch (c) {\n    case '\\n':\n      return '\\\\n';\n    case '\\r':\n      return '\\\\r';\n    case '\\t':\n      return '\\\\t';\n    case '\\b':\n      return '\\\\b';\n    case '\\f':\n      return '\\\\f';\n  }\n}\n\nexport default function readTemplateStringLiteral(parser) {\n  if (!parser.matchString('`')) return null;\n\n  let literal = '';\n  let done = false;\n  let next;\n  const parts = [];\n\n  while (!done) {\n    next =\n      parser.matchPattern(stringMiddlePattern) ||\n      parser.matchPattern(escapeSequencePattern) ||\n      parser.matchString('$') ||\n      parser.matchString('\"');\n    if (next) {\n      if (next === `\"`) {\n        literal += `\\\\\"`;\n      } else if (next === '\\\\`') {\n        literal += '`';\n      } else if (next === '$') {\n        if (parser.matchString('{')) {\n          parts.push({ t: STRING_LITERAL, v: getString(literal) });\n          literal = '';\n\n          parser.sp();\n          const expr = readExpression(parser);\n\n          if (!expr) parser.error('Expected valid expression');\n\n          parts.push({ t: BRACKETED, x: expr });\n\n          parser.sp();\n          if (!parser.matchString('}'))\n            parser.error(`Expected closing '}' after interpolated expression`);\n        } else {\n          literal += '$';\n        }\n      } else {\n        literal += next;\n      }\n    } else {\n      next = parser.matchPattern(lineContinuationPattern);\n      if (next) {\n        // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n        literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n      } else {\n        done = true;\n      }\n    }\n  }\n\n  if (literal.length) parts.push({ t: STRING_LITERAL, v: getString(literal) });\n\n  if (!parser.matchString('`')) parser.error(\"Expected closing '`'\");\n\n  if (parts.length === 1) {\n    return parts[0];\n  } else {\n    let result = parts.pop();\n    let part;\n\n    while ((part = parts.pop())) {\n      result = {\n        t: INFIX_OPERATOR,\n        s: '+',\n        o: [part, result]\n      };\n    }\n\n    return {\n      t: BRACKETED,\n      x: result\n    };\n  }\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey(parser) {\n  let token;\n\n  if ((token = readStringLiteral(parser))) {\n    return identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  }\n\n  if ((token = readNumberLiteral(parser))) {\n    return token.v;\n  }\n\n  if ((token = parser.matchPattern(namePattern))) {\n    return token;\n  }\n\n  return null;\n}\n","import { BRACKETED, GLOBAL, REFERENCE } from 'src/config/types';\nimport { normalise } from 'src/shared/keypaths';\nimport { legalReference, relaxedName } from '../shared/patterns';\n\n// if a reference is a browser global, we don't deference it later, so it needs special treatment\nconst globals = /^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null|Object|Number|String|Boolean)\\b/;\n\n// keywords are not valid references, with the exception of `this`\nconst keywords = /^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;\n\nconst prefixPattern = /^(?:\\@\\.|\\@|~\\/|(?:\\^\\^\\/(?:\\^\\^\\/)*(?:\\.\\.\\/)*)|(?:\\.\\.\\/)+|\\.\\/(?:\\.\\.\\/)*|\\.)/;\nconst specials = /^(key|index|keypath|rootpath|this|global|shared|context|event|node|local|style|helpers|last)/;\n\nexport default function readReference(parser) {\n  let prefix, name, global, reference, lastDotIndex;\n\n  const startPos = parser.pos;\n\n  prefix = parser.matchPattern(prefixPattern) || '';\n  name =\n    (!prefix && parser.relaxedNames && parser.matchPattern(relaxedName)) ||\n    parser.matchPattern(legalReference);\n  const actual = prefix.length + ((name && name.length) || 0);\n\n  if (prefix === '@.') {\n    prefix = '@';\n    if (name) name = 'this.' + name;\n    else name = 'this';\n  }\n\n  if (!name && prefix) {\n    name = prefix;\n    prefix = '';\n  }\n\n  if (!name) {\n    return null;\n  }\n\n  if (prefix === '@') {\n    if (!specials.test(name)) {\n      parser.error(`Unrecognized special reference @${name}`);\n    } else if ((~name.indexOf('event') || ~name.indexOf('node')) && !parser.inEvent) {\n      parser.error(`@event and @node are only valid references within an event directive`);\n    } else if (~name.indexOf('context')) {\n      parser.pos = parser.pos - (name.length - 7);\n      return {\n        t: BRACKETED,\n        x: {\n          t: REFERENCE,\n          n: '@context'\n        }\n      };\n    }\n  }\n\n  // bug out if it's a keyword (exception for ancestor/restricted refs - see https://github.com/ractivejs/ractive/issues/1497)\n  if (!prefix && !parser.relaxedNames && keywords.test(name)) {\n    parser.pos = startPos;\n    return null;\n  }\n\n  // if this is a browser global, stop here\n  if (!prefix && globals.test(name)) {\n    global = globals.exec(name)[0];\n    parser.pos = startPos + global.length;\n\n    return {\n      t: GLOBAL,\n      v: global\n    };\n  }\n\n  reference = (prefix || '') + normalise(name);\n\n  if (parser.matchString('(')) {\n    // if this is a method invocation (as opposed to a function) we need\n    // to strip the method name from the reference combo, else the context\n    // will be wrong\n    // but only if the reference was actually a member and not a refinement\n    lastDotIndex = reference.lastIndexOf('.');\n    if (lastDotIndex !== -1 && name[name.length - 1] !== ']') {\n      if (lastDotIndex === 0) {\n        reference = '.';\n        parser.pos = startPos;\n      } else {\n        const refLength = reference.length;\n        reference = reference.substr(0, lastDotIndex);\n        parser.pos = startPos + (actual - (refLength - lastDotIndex));\n      }\n    } else {\n      parser.pos -= 1;\n    }\n  }\n\n  return {\n    t: REFERENCE,\n    n: reference.replace(/^this\\./, './').replace(/^this$/, '.')\n  };\n}\n","import { INFIX_OPERATOR } from 'config/types';\nimport readTypeof from './readTypeof';\n\nlet readLogicalOr;\n\nconst makeInfixSequenceMatcher = function(symbol, fallthrough) {\n  return function(parser) {\n    // > and / have to be quoted\n    if (parser.inUnquotedAttribute && (symbol === '>' || symbol === '/'))\n      return fallthrough(parser);\n\n    let start, left, right;\n\n    left = fallthrough(parser);\n    if (!left) {\n      return null;\n    }\n\n    // Loop to handle left-recursion in a case like `a * b * c` and produce\n    // left association, i.e. `(a * b) * c`.  The matcher can't call itself\n    // to parse `left` because that would be infinite regress.\n    while (true) {\n      start = parser.pos;\n\n      parser.sp();\n\n      if (!parser.matchString(symbol)) {\n        parser.pos = start;\n        return left;\n      }\n\n      // special case - in operator must not be followed by [a-zA-Z_$0-9]\n      if (symbol === 'in' && /[a-zA-Z_$0-9]/.test(parser.remaining().charAt(0))) {\n        parser.pos = start;\n        return left;\n      }\n\n      parser.sp();\n\n      // right operand must also consist of only higher-precedence operators\n      right = fallthrough(parser);\n      if (!right) {\n        parser.pos = start;\n        return left;\n      }\n\n      left = {\n        t: INFIX_OPERATOR,\n        s: symbol,\n        o: [left, right]\n      };\n\n      // Loop back around.  If we don't see another occurrence of the symbol,\n      // we'll return left.\n    }\n  };\n};\n\n// create all infix sequence matchers, and return readLogicalOr\n(function() {\n  let i, len, matcher, fallthrough;\n\n  // All the infix operators on order of precedence (source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)\n  // Each sequence matcher will initially fall through to its higher precedence\n  // neighbour, and only attempt to match if one of the higher precedence operators\n  // (or, ultimately, a literal, reference, or bracketed expression) already matched\n  const infixOperators = '* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||'.split(\n    ' '\n  );\n\n  // A typeof operator is higher precedence than multiplication\n  fallthrough = readTypeof;\n  for (i = 0, len = infixOperators.length; i < len; i += 1) {\n    matcher = makeInfixSequenceMatcher(infixOperators[i], fallthrough);\n    fallthrough = matcher;\n  }\n\n  // Logical OR is the fallthrough for the conditional matcher\n  readLogicalOr = fallthrough;\n})();\n\nexport default readLogicalOr;\n","import {\n  ARRAY_LITERAL,\n  ATTRIBUTE,\n  DECORATOR,\n  DELEGATE_FLAG,\n  BINDING_FLAG,\n  INTERPOLATOR,\n  TRANSITION,\n  EVENT\n} from '../../../config/types';\nimport getLowestIndex from '../utils/getLowestIndex';\nimport readMustache from '../readMustache';\nimport { decodeCharacterReferences } from 'src/utils/html';\nimport readExpressionList from '../expressions/shared/readExpressionList';\nimport readExpressionOrReference from '../readExpressionOrReference';\nimport flattenExpression from 'parse/utils/flattenExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { isString } from 'utils/is';\n\nconst attributeNamePattern = /^[^\\s\"'>\\/=(]+/;\nconst onPattern = /^on/;\nconst eventPattern = /^on-([a-zA-Z\\*\\.$_]((?:[a-zA-Z\\*\\.$_0-9\\-]|\\\\-)+))$/;\nconst reservedEventNames = /^(?:change|reset|teardown|update|construct|config|init|render|complete|unrender|detach|insert|destruct|attachchild|detachchild)$/;\nconst decoratorPattern = /^as-([a-z-A-Z][-a-zA-Z_0-9]*)$/;\nconst transitionPattern = /^([a-zA-Z](?:(?!-in-out)[-a-zA-Z_0-9])*)-(in|out|in-out)$/;\nconst boundPattern = /^((bind|class)-(([-a-zA-Z0-9_])+))$/;\nconst directives = {\n  lazy: { t: BINDING_FLAG, v: 'l' },\n  twoway: { t: BINDING_FLAG, v: 't' },\n  'no-delegation': { t: DELEGATE_FLAG }\n};\nconst unquotedAttributeValueTextPattern = /^[^\\s\"'=<>\\/`]+/;\nconst proxyEvent = /^[^\\s\"'=<>@\\[\\]()]*/;\nconst whitespace = /^\\s+/;\n\nconst slashes = /\\\\/g;\nfunction splitEvent(str) {\n  const result = [];\n  let s = 0;\n\n  for (let i = 0; i < str.length; i++) {\n    if (str[i] === '-' && str[i - 1] !== '\\\\') {\n      result.push(str.substring(s, i).replace(slashes, ''));\n      s = i + 1;\n    }\n  }\n\n  result.push(str.substring(s).replace(slashes, ''));\n\n  return result;\n}\n\nexport default function readAttribute(parser) {\n  let name, i, nearest, idx;\n\n  parser.sp();\n\n  name = parser.matchPattern(attributeNamePattern);\n  if (!name) {\n    return null;\n  }\n\n  // check for accidental delimiter consumption e.g. <tag bool{{>attrs}} />\n  nearest = name.length;\n  for (i = 0; i < parser.tags.length; i++) {\n    if (~(idx = name.indexOf(parser.tags[i].open))) {\n      if (idx < nearest) nearest = idx;\n    }\n  }\n  if (nearest < name.length) {\n    parser.pos -= name.length - nearest;\n    name = name.substr(0, nearest);\n    if (!name) return null;\n  }\n\n  return { n: name };\n}\n\nfunction readAttributeValue(parser) {\n  const start = parser.pos;\n\n  // next character must be `=`, `/`, `>` or whitespace\n  if (!/[=\\/>\\s]/.test(parser.nextChar())) {\n    parser.error('Expected `=`, `/`, `>` or whitespace');\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('=')) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  const valueStart = parser.pos;\n  const startDepth = parser.sectionDepth;\n\n  const value =\n    readQuotedAttributeValue(parser, `'`) ||\n    readQuotedAttributeValue(parser, `\"`) ||\n    readUnquotedAttributeValue(parser);\n\n  if (value === null) {\n    parser.error('Expected valid attribute value');\n  }\n\n  if (parser.sectionDepth !== startDepth) {\n    parser.pos = valueStart;\n    parser.error(\n      'An attribute value must contain as many opening section tags as closing section tags'\n    );\n  }\n\n  if (!value.length) {\n    return '';\n  }\n\n  if (value.length === 1 && isString(value[0])) {\n    return decodeCharacterReferences(value[0]);\n  }\n\n  return value;\n}\n\nfunction readUnquotedAttributeValueToken(parser) {\n  let text, index;\n\n  const start = parser.pos;\n\n  text = parser.matchPattern(unquotedAttributeValueTextPattern);\n\n  if (!text) {\n    return null;\n  }\n\n  const haystack = text;\n  const needles = parser.tags.map(t => t.open); // TODO refactor... we do this in readText.js as well\n\n  if ((index = getLowestIndex(haystack, needles)) !== -1) {\n    text = text.substr(0, index);\n    parser.pos = start + text.length;\n  }\n\n  return text;\n}\n\nfunction readUnquotedAttributeValue(parser) {\n  parser.inAttribute = true;\n\n  const tokens = [];\n\n  let token = readMustache(parser) || readUnquotedAttributeValueToken(parser);\n  while (token) {\n    tokens.push(token);\n    token = readMustache(parser) || readUnquotedAttributeValueToken(parser);\n  }\n\n  if (!tokens.length) {\n    return null;\n  }\n\n  parser.inAttribute = false;\n  return tokens;\n}\n\nfunction readQuotedAttributeValue(parser, quoteMark) {\n  const start = parser.pos;\n\n  if (!parser.matchString(quoteMark)) {\n    return null;\n  }\n\n  parser.inAttribute = quoteMark;\n\n  const tokens = [];\n\n  let token = readMustache(parser) || readQuotedStringToken(parser, quoteMark);\n  while (token !== null) {\n    tokens.push(token);\n    token = readMustache(parser) || readQuotedStringToken(parser, quoteMark);\n  }\n\n  if (!parser.matchString(quoteMark)) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.inAttribute = false;\n\n  return tokens;\n}\n\nfunction readQuotedStringToken(parser, quoteMark) {\n  const haystack = parser.remaining();\n\n  const needles = parser.tags.map(t => t.open); // TODO refactor... we do this in readText.js as well\n  needles.push(quoteMark);\n\n  const index = getLowestIndex(haystack, needles);\n\n  if (index === -1) {\n    parser.error('Quoted attribute value must have a closing quote');\n  }\n\n  if (!index) {\n    return null;\n  }\n\n  parser.pos += index;\n  return haystack.substr(0, index);\n}\n\nexport function readAttributeOrDirective(parser) {\n  let match, directive;\n\n  const attribute = readAttribute(parser, false);\n\n  if (!attribute) return null;\n\n  // lazy, twoway\n  if ((directive = directives[attribute.n])) {\n    attribute.t = directive.t;\n    if (directive.v) attribute.v = directive.v;\n    delete attribute.n; // no name necessary\n    parser.sp();\n    if (parser.nextChar() === '=') attribute.f = readAttributeValue(parser);\n  } else if ((match = decoratorPattern.exec(attribute.n))) {\n    // decorators\n    attribute.n = match[1];\n    attribute.t = DECORATOR;\n    readArguments(parser, attribute);\n  } else if ((match = transitionPattern.exec(attribute.n))) {\n    // transitions\n    attribute.n = match[1];\n    attribute.t = TRANSITION;\n    readArguments(parser, attribute);\n    attribute.v = match[2] === 'in-out' ? 't0' : match[2] === 'in' ? 't1' : 't2';\n  } else if ((match = eventPattern.exec(attribute.n))) {\n    // on-click etc\n    attribute.n = splitEvent(match[1]);\n    attribute.t = EVENT;\n\n    if (parser.matchString('(')) {\n      attribute.a = flattenExpression({\n        t: ARRAY_LITERAL,\n        m: readExpressionList(parser)\n      });\n      if (!parser.matchString(')')) parser.error(`Expected closing ')'`);\n    }\n\n    parser.inEvent = true;\n\n    // check for a proxy event\n    if (!readProxyEvent(parser, attribute)) {\n      // otherwise, it's an expression\n      readArguments(parser, attribute, true);\n    } else if (reservedEventNames.test(attribute.f)) {\n      parser.pos -= attribute.f.length;\n      parser.error(\n        'Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, complete, detach, insert, destruct, attachchild, detachchild)'\n      );\n    }\n\n    parser.inEvent = false;\n  } else if ((match = boundPattern.exec(attribute.n))) {\n    // bound directives\n    const bind = match[2] === 'bind';\n    attribute.n = bind ? match[3] : match[1];\n    attribute.t = ATTRIBUTE;\n    readArguments(parser, attribute, false, true);\n\n    if (!attribute.f && bind) {\n      attribute.f = [{ t: INTERPOLATOR, r: match[3] }];\n    }\n  } else {\n    parser.sp();\n    const value = parser.nextChar() === '=' ? readAttributeValue(parser) : null;\n    attribute.f = value != null ? value : attribute.f;\n\n    if (parser.sanitizeEventAttributes && onPattern.test(attribute.n)) {\n      return { exclude: true };\n    } else {\n      attribute.f = attribute.f || (attribute.f === '' ? '' : 0);\n      attribute.t = ATTRIBUTE;\n    }\n  }\n\n  return attribute;\n}\n\nfunction readProxyEvent(parser, attribute) {\n  const start = parser.pos;\n  if (!parser.matchString('=')) parser.error(`Missing required directive arguments`);\n\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n  parser.sp();\n  const proxy = parser.matchPattern(proxyEvent);\n\n  if (proxy !== undefined) {\n    if (quote) {\n      parser.sp();\n      if (!parser.matchString(quote)) parser.pos = start;\n      else return (attribute.f = proxy) || true;\n    } else if (!parser.matchPattern(whitespace)) {\n      parser.pos = start;\n    } else {\n      return (attribute.f = proxy) || true;\n    }\n  } else {\n    parser.pos = start;\n  }\n}\n\nfunction readArguments(parser, attribute, required = false, single = false) {\n  parser.sp();\n  if (!parser.matchString('=')) {\n    if (required) parser.error(`Missing required directive arguments`);\n    return;\n  }\n  parser.sp();\n\n  const quote = parser.matchString('\"') || parser.matchString(\"'\");\n  const spread = parser.spreadArgs;\n  parser.spreadArgs = true;\n  parser.inUnquotedAttribute = !quote;\n  const expr = single\n    ? readExpressionOrReference(parser, [quote || ' ', '/', '>'])\n    : { m: readExpressionList(parser), t: ARRAY_LITERAL };\n  parser.inUnquotedAttribute = false;\n  parser.spreadArgs = spread;\n\n  if (quote) {\n    parser.sp();\n    if (parser.matchString(quote) !== quote) parser.error(`Expected matching quote '${quote}'`);\n  }\n\n  if (single) {\n    const interpolator = { t: INTERPOLATOR };\n    refineExpression(expr, interpolator);\n    attribute.f = [interpolator];\n  } else {\n    attribute.f = flattenExpression(expr);\n  }\n}\n","import { DELIMCHANGE } from 'config/types';\nimport readDelimiterChange from './mustache/readDelimiterChange';\nimport readRegexpLiteral from './expressions/primary/literal/readRegexpLiteral';\nimport { readAttributeOrDirective } from './element/readAttribute';\n\nconst delimiterChangeToken = { t: DELIMCHANGE, exclude: true };\n\nexport default function readMustache(parser) {\n  let mustache, i;\n\n  // If we're inside a <script> or <style> tag, and we're not\n  // interpolating, bug out\n  if (parser.interpolate[parser.inside] === false) {\n    return null;\n  }\n\n  for (i = 0; i < parser.tags.length; i += 1) {\n    if ((mustache = readMustacheOfType(parser, parser.tags[i]))) {\n      return mustache;\n    }\n  }\n\n  if (parser.inTag && !parser.inAttribute) {\n    mustache = readAttributeOrDirective(parser);\n    if (mustache) {\n      parser.sp();\n      return mustache;\n    }\n  }\n}\n\nfunction readMustacheOfType(parser, tag) {\n  let mustache, reader, i;\n\n  const start = parser.pos;\n\n  if (parser.matchString('\\\\' + tag.open)) {\n    if (start === 0 || parser.str[start - 1] !== '\\\\') {\n      return tag.open;\n    }\n  } else if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  // delimiter change?\n  if ((mustache = readDelimiterChange(parser))) {\n    // find closing delimiter or abort...\n    if (!parser.matchString(tag.close)) {\n      return null;\n    }\n\n    // ...then make the switch\n    tag.open = mustache[0];\n    tag.close = mustache[1];\n    parser.sortMustacheTags();\n\n    return delimiterChangeToken;\n  }\n\n  parser.sp();\n\n  // illegal section closer\n  if (parser.matchString('/')) {\n    parser.pos -= 1;\n    const rewind = parser.pos;\n    if (!readRegexpLiteral(parser)) {\n      parser.pos = rewind - tag.close.length;\n      if (parser.inAttribute) {\n        parser.pos = start;\n        return null;\n      } else {\n        parser.error(\"Attempted to close a section that wasn't open\");\n      }\n    } else {\n      parser.pos = rewind;\n    }\n  }\n\n  for (i = 0; i < tag.readers.length; i += 1) {\n    reader = tag.readers[i];\n\n    if ((mustache = reader(parser, tag))) {\n      if (tag.isStatic) {\n        mustache.s = 1;\n      }\n\n      if (parser.includeLinePositions) {\n        mustache.p = parser.getLinePos(start);\n      }\n\n      return mustache;\n    }\n  }\n\n  parser.pos = start;\n  return null;\n}\n","import readExpression from '../readExpression';\nimport refineExpression from '../../utils/refineExpression';\n\nconst legalAlias = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nconst asRE = /^as/i;\n\nexport function readAliases(parser) {\n  const aliases = [];\n  let alias;\n  const start = parser.pos;\n\n  parser.sp();\n\n  alias = readAlias(parser);\n\n  if (alias) {\n    alias.x = refineExpression(alias.x, {});\n    aliases.push(alias);\n\n    parser.sp();\n\n    while (parser.matchString(',')) {\n      alias = readAlias(parser);\n\n      if (!alias) {\n        parser.error('Expected another alias.');\n      }\n\n      alias.x = refineExpression(alias.x, {});\n      aliases.push(alias);\n\n      parser.sp();\n    }\n\n    return aliases;\n  }\n\n  parser.pos = start;\n  return null;\n}\n\nexport function readAlias(parser) {\n  const start = parser.pos;\n\n  parser.sp();\n\n  const expr = readExpression(parser, []);\n\n  if (!expr) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n  parser.matchPattern(asRE);\n  parser.sp();\n\n  const alias = parser.matchPattern(legalAlias);\n\n  if (!alias) {\n    parser.pos = start;\n    return null;\n  }\n\n  return { n: alias, x: expr };\n}\n","import { CATCH, ELSE, ELSEIF, THEN } from 'config/types';\nimport readExpression from '../../readExpression';\nimport { name } from '../../expressions/shared/patterns';\n\nconst patterns = {\n  else: /^\\s*else\\s*/,\n  elseif: /^\\s*elseif\\s+/,\n  then: /^\\s*then\\s*/,\n  catch: /^\\s*catch\\s*/\n};\n\nconst types = {\n  else: ELSE,\n  elseif: ELSEIF,\n  then: THEN,\n  catch: CATCH\n};\n\nexport default function readInlineBlock(parser, tag, type) {\n  const start = parser.pos;\n\n  if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  if (!parser.matchPattern(patterns[type])) {\n    parser.pos = start;\n    return null;\n  }\n\n  const res = { t: types[type] };\n\n  if (type === 'elseif') {\n    res.x = readExpression(parser);\n  } else if (type === 'catch' || type === 'then') {\n    const nm = parser.matchPattern(name);\n    if (nm) res.n = nm;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  return res;\n}\n","import { SECTION_EACH, SECTION_IF, SECTION_IF_WITH, SECTION_UNLESS } from 'config/types';\n\nexport default {\n  each: SECTION_EACH,\n  if: SECTION_IF,\n  with: SECTION_IF_WITH,\n  unless: SECTION_UNLESS\n};\n","import {\n  ALIAS,\n  AWAIT,\n  CATCH,\n  ELSE,\n  ELSEIF,\n  SECTION,\n  SECTION_IF,\n  SECTION_UNLESS,\n  THEN\n} from 'config/types';\nimport { READERS } from 'parse/_parse';\nimport readClosing from './section/readClosing';\nimport readInlineBlock from './section/readInlineBlock';\nimport handlebarsBlockCodes from './handlebarsBlockCodes';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { readAlias, readAliases } from './readAliases';\nimport { keys } from 'utils/object';\nimport { name } from '../expressions/shared/patterns';\n\nconst indexRefPattern = /^\\s*:\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nconst keyIndexRefPattern = /^\\s*,\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nconst handlebarsBlockPattern = new RegExp('^(' + keys(handlebarsBlockCodes).join('|') + ')\\\\b');\n\nexport default function readSection(parser, tag) {\n  let expression,\n    section,\n    child,\n    children,\n    hasElse,\n    block,\n    unlessBlock,\n    closed,\n    i,\n    expectedClose,\n    hasThen,\n    hasCatch,\n    inlineThen;\n  let aliasOnly = false;\n\n  const start = parser.pos;\n\n  if (parser.matchString('^')) {\n    // watch out for parent context refs - {{^^/^^/foo}}\n    if (parser.matchString('^/')) {\n      parser.pos = start;\n      return null;\n    }\n    section = { t: SECTION, f: [], n: SECTION_UNLESS };\n  } else if (parser.matchString('#')) {\n    section = { t: SECTION, f: [] };\n\n    if (parser.matchString('partial')) {\n      parser.pos = start - parser.standardDelimiters[0].length;\n      parser.error(\n        'Partial definitions can only be at the top level of the template, or immediately inside components'\n      );\n    }\n\n    if ((block = parser.matchString('await'))) {\n      expectedClose = block;\n      section.t = AWAIT;\n    } else if ((block = parser.matchPattern(handlebarsBlockPattern))) {\n      expectedClose = block;\n      section.n = handlebarsBlockCodes[block];\n    }\n  } else {\n    return null;\n  }\n\n  parser.sp();\n\n  if (block === 'with') {\n    const aliases = readAliases(parser);\n    if (aliases) {\n      aliasOnly = true;\n      section.z = aliases;\n      section.t = ALIAS;\n    }\n  } else if (block === 'each') {\n    const alias = readAlias(parser);\n    if (alias) {\n      section.z = [{ n: alias.n, x: { r: '.' } }];\n      expression = alias.x;\n    }\n  }\n\n  if (!aliasOnly) {\n    if (!expression) expression = readExpression(parser);\n\n    if (!expression) {\n      parser.error('Expected expression');\n    }\n\n    // extra each aliases\n    if (block === 'each' && parser.matchString(',')) {\n      const aliases = readAliases(parser);\n      if (aliases) {\n        if (section.z) aliases.unshift(section.z[0]);\n        section.z = aliases;\n      }\n    }\n\n    // optional index and key references\n    if ((block === 'each' || !block) && (i = parser.matchPattern(indexRefPattern))) {\n      let extra;\n\n      if ((extra = parser.matchPattern(keyIndexRefPattern))) {\n        section.i = i + ',' + extra;\n      } else {\n        section.i = i;\n      }\n    } else if (block === 'await' && parser.matchString('then')) {\n      parser.sp();\n      hasThen = true;\n      inlineThen = parser.matchPattern(name);\n      if (!inlineThen) inlineThen = true;\n    }\n\n    if (!block && expression.n) {\n      expectedClose = expression.n;\n    }\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  parser.sectionDepth += 1;\n  children = section.f;\n\n  let pos;\n  do {\n    pos = parser.pos;\n    if ((child = readClosing(parser, tag))) {\n      if (expectedClose && child.r !== expectedClose) {\n        if (!block) {\n          if (child.r)\n            parser.warn(\n              `Expected ${tag.open}/${expectedClose}${tag.close} but found ${tag.open}/${child.r}${\n                tag.close\n              }`\n            );\n        } else {\n          parser.pos = pos;\n          parser.error(`Expected ${tag.open}/${expectedClose}${tag.close}`);\n        }\n      }\n\n      parser.sectionDepth -= 1;\n      closed = true;\n    } else if (\n      !aliasOnly &&\n      ((child = readInlineBlock(parser, tag, 'elseif')) ||\n        (child = readInlineBlock(parser, tag, 'else')) ||\n        (block === 'await' &&\n          ((child = readInlineBlock(parser, tag, 'then')) ||\n            (child = readInlineBlock(parser, tag, 'catch')))))\n    ) {\n      if (section.n === SECTION_UNLESS) {\n        parser.error('{{else}} not allowed in {{#unless}}');\n      }\n\n      if (hasElse) {\n        if (child.t === ELSE) {\n          parser.error('there can only be one {{else}} block, at the end of a section');\n        } else if (child.t === ELSEIF) {\n          parser.error('illegal {{elseif...}} after {{else}}');\n        }\n      }\n\n      if (!unlessBlock && (inlineThen || !hasThen) && !hasCatch) {\n        if (block === 'await') {\n          const s = { f: children };\n          section.f = [s];\n          if (inlineThen) {\n            s.t = THEN;\n            inlineThen !== true && (s.n = inlineThen);\n          } else {\n            s.t = SECTION;\n          }\n        } else {\n          unlessBlock = [];\n        }\n      }\n\n      const mustache = {\n        t: SECTION,\n        f: (children = [])\n      };\n\n      if (child.t === ELSE) {\n        if (block === 'await') {\n          section.f.push(mustache);\n          mustache.t = ELSE;\n        } else {\n          mustache.n = SECTION_UNLESS;\n          unlessBlock.push(mustache);\n        }\n        hasElse = true;\n      } else if (child.t === ELSEIF) {\n        mustache.n = SECTION_IF;\n        refineExpression(child.x, mustache);\n        unlessBlock.push(mustache);\n      } else if (child.t === THEN) {\n        if (hasElse) parser.error('{{then}} block must appear before any {{else}} block');\n        if (hasCatch) parser.error('{{then}} block must appear before any {{catch}} block');\n        if (hasThen) parser.error('there can only be one {{then}} block per {{#await}}');\n        mustache.t = THEN;\n        hasThen = true;\n        child.n && (mustache.n = child.n);\n        section.f.push(mustache);\n      } else if (child.t === CATCH) {\n        if (hasElse) parser.error('{{catch}} block must appear before any {{else}} block');\n        if (hasCatch) parser.error('there can only be one {{catch}} block per {{#await}}');\n        mustache.t = CATCH;\n        hasCatch = true;\n        mustache.n = child.n;\n        section.f.push(mustache);\n      }\n    } else {\n      child = parser.read(READERS);\n\n      if (!child) {\n        break;\n      }\n\n      children.push(child);\n    }\n  } while (!closed);\n\n  if (unlessBlock) {\n    section.l = unlessBlock;\n  }\n\n  if (!aliasOnly) {\n    refineExpression(expression, section);\n  }\n\n  if (block === 'await' && (inlineThen || !hasThen) && !hasCatch && !hasElse) {\n    const s = { f: section.f };\n    section.f = [s];\n    if (inlineThen) {\n      s.t = THEN;\n      inlineThen !== true && (s.n = inlineThen);\n    } else {\n      s.t = SECTION;\n    }\n  }\n\n  // TODO if a section is empty it should be discarded. Don't do\n  // that here though - we need to clean everything up first, as\n  // it may contain removeable whitespace. As a temporary measure,\n  // to pass the existing tests, remove empty `f` arrays\n  if (!section.f.length) {\n    delete section.f;\n  }\n\n  return section;\n}\n","import { COMMENT } from 'config/types';\n\nconst OPEN_COMMENT = '<!--';\nconst CLOSE_COMMENT = '-->';\n\nexport default function readHtmlComment(parser) {\n  const start = parser.pos;\n\n  if (parser.textOnlyMode || !parser.matchString(OPEN_COMMENT)) {\n    return null;\n  }\n\n  const remaining = parser.remaining();\n  const endIndex = remaining.indexOf(CLOSE_COMMENT);\n\n  if (endIndex === -1) {\n    parser.error(\"Illegal HTML - expected closing comment sequence ('-->')\");\n  }\n\n  const content = remaining.substr(0, endIndex);\n  parser.pos += endIndex + 3;\n\n  const comment = {\n    t: COMMENT,\n    c: content\n  };\n\n  if (parser.includeLinePositions) {\n    comment.p = parser.getLinePos(start);\n  }\n\n  return comment;\n}\n","import { COMMENT, DELIMCHANGE, SECTION, INVERTED } from 'config/types';\nimport { lastItem } from 'utils/array';\nimport { isString } from 'utils/is';\n\nconst leadingLinebreak = /^[ \\t\\f\\r\\n]*\\r?\\n/;\nconst trailingLinebreak = /\\r?\\n[ \\t\\f\\r\\n]*$/;\n\nexport default function(items) {\n  let i, current, backOne, backTwo, lastSectionItem;\n\n  for (i = 1; i < items.length; i += 1) {\n    current = items[i];\n    backOne = items[i - 1];\n    backTwo = items[i - 2];\n\n    // if we're at the end of a [text][comment][text] sequence...\n    if (isString(current) && isComment(backOne) && isString(backTwo)) {\n      // ... and the comment is a standalone (i.e. line breaks either side)...\n      if (trailingLinebreak.test(backTwo) && leadingLinebreak.test(current)) {\n        // ... then we want to remove the whitespace after the first line break\n        items[i - 2] = backTwo.replace(trailingLinebreak, '\\n');\n\n        // and the leading line break of the second text token\n        items[i] = current.replace(leadingLinebreak, '');\n      }\n    }\n\n    // if the current item is a section, and it is preceded by a linebreak, and\n    // its first item is a linebreak...\n    if (isSection(current) && isString(backOne)) {\n      if (\n        trailingLinebreak.test(backOne) &&\n        isString(current.f[0]) &&\n        leadingLinebreak.test(current.f[0])\n      ) {\n        items[i - 1] = backOne.replace(trailingLinebreak, '\\n');\n        current.f[0] = current.f[0].replace(leadingLinebreak, '');\n      }\n    }\n\n    // if the last item was a section, and it is followed by a linebreak, and\n    // its last item is a linebreak...\n    if (isString(current) && isSection(backOne)) {\n      lastSectionItem = lastItem(backOne.f);\n\n      if (\n        isString(lastSectionItem) &&\n        trailingLinebreak.test(lastSectionItem) &&\n        leadingLinebreak.test(current)\n      ) {\n        backOne.f[backOne.f.length - 1] = lastSectionItem.replace(trailingLinebreak, '\\n');\n        items[i] = current.replace(leadingLinebreak, '');\n      }\n    }\n  }\n\n  return items;\n}\n\nfunction isComment(item) {\n  return item.t === COMMENT || item.t === DELIMCHANGE;\n}\n\nfunction isSection(item) {\n  return (item.t === SECTION || item.t === INVERTED) && item.f;\n}\n","import { COMMENT, ELEMENT } from 'config/types';\nimport stripStandalones from './stripStandalones';\nimport trimWhitespace from './trimWhitespace';\nimport { isString } from 'utils/is';\n\nconst contiguousWhitespace = /[ \\t\\f\\r\\n]+/g;\nconst preserveWhitespaceElements = /^(?:pre|script|style|textarea)$/i;\nconst leadingWhitespace = /^[ \\t\\f\\r\\n]+/;\nconst trailingWhitespace = /[ \\t\\f\\r\\n]+$/;\nconst leadingNewLine = /^(?:\\r\\n|\\r|\\n)/;\nconst trailingNewLine = /(?:\\r\\n|\\r|\\n)$/;\n\nexport default function cleanup(\n  items,\n  stripComments,\n  preserveWhitespace,\n  removeLeadingWhitespace,\n  removeTrailingWhitespace\n) {\n  if (isString(items)) return;\n\n  let i,\n    item,\n    previousItem,\n    nextItem,\n    preserveWhitespaceInsideFragment,\n    removeLeadingWhitespaceInsideFragment,\n    removeTrailingWhitespaceInsideFragment;\n\n  // First pass - remove standalones and comments etc\n  stripStandalones(items);\n\n  i = items.length;\n  while (i--) {\n    item = items[i];\n\n    // Remove delimiter changes, unsafe elements etc\n    if (item.exclude) {\n      items.splice(i, 1);\n    } else if (stripComments && item.t === COMMENT) {\n      // Remove comments, unless we want to keep them\n      items.splice(i, 1);\n    }\n  }\n\n  // If necessary, remove leading and trailing whitespace\n  trimWhitespace(\n    items,\n    removeLeadingWhitespace ? leadingWhitespace : null,\n    removeTrailingWhitespace ? trailingWhitespace : null\n  );\n\n  i = items.length;\n  while (i--) {\n    item = items[i];\n\n    // Recurse\n    if (item.f) {\n      const isPreserveWhitespaceElement =\n        item.t === ELEMENT && preserveWhitespaceElements.test(item.e);\n      preserveWhitespaceInsideFragment = preserveWhitespace || isPreserveWhitespaceElement;\n\n      if (!preserveWhitespace && isPreserveWhitespaceElement) {\n        trimWhitespace(item.f, leadingNewLine, trailingNewLine);\n      }\n\n      if (!preserveWhitespaceInsideFragment) {\n        previousItem = items[i - 1];\n        nextItem = items[i + 1];\n\n        // if the previous item was a text item with trailing whitespace,\n        // remove leading whitespace inside the fragment\n        if (!previousItem || (isString(previousItem) && trailingWhitespace.test(previousItem))) {\n          removeLeadingWhitespaceInsideFragment = true;\n        }\n\n        // and vice versa\n        if (!nextItem || (isString(nextItem) && leadingWhitespace.test(nextItem))) {\n          removeTrailingWhitespaceInsideFragment = true;\n        }\n      }\n\n      cleanup(\n        item.f,\n        stripComments,\n        preserveWhitespaceInsideFragment,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment\n      );\n    }\n\n    // Split if-else blocks into two (an if, and an unless)\n    if (item.l) {\n      cleanup(\n        item.l,\n        stripComments,\n        preserveWhitespace,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment\n      );\n\n      item.l.forEach(s => (s.l = 1));\n      item.l.unshift(i + 1, 0);\n      items.splice.apply(items, item.l);\n      delete item.l; // TODO would be nice if there was a way around this\n    }\n\n    // Clean up conditional attributes\n    if (item.m) {\n      cleanup(\n        item.m,\n        stripComments,\n        preserveWhitespace,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment\n      );\n      if (item.m.length < 1) delete item.m;\n    }\n  }\n\n  // final pass - fuse text nodes together\n  i = items.length;\n  while (i--) {\n    if (isString(items[i])) {\n      if (isString(items[i + 1])) {\n        items[i] = items[i] + items[i + 1];\n        items.splice(i + 1, 1);\n      }\n\n      if (!preserveWhitespace) {\n        items[i] = items[i].replace(contiguousWhitespace, ' ');\n      }\n\n      if (items[i] === '') {\n        items.splice(i, 1);\n      }\n    }\n  }\n}\n","import { CLOSING_TAG } from 'src/config/types';\n\nconst closingTagPattern = /^([a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*)\\s*\\>/;\n\nexport default function readClosingTag(parser) {\n  let tag;\n\n  const start = parser.pos;\n\n  // are we looking at a closing tag?\n  if (!parser.matchString('</')) {\n    return null;\n  }\n\n  if ((tag = parser.matchPattern(closingTagPattern))) {\n    if (parser.inside && tag !== parser.inside) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: CLOSING_TAG,\n      e: tag\n    };\n  }\n\n  // We have an illegal closing tag, report it\n  parser.pos -= 2;\n  parser.error('Illegal closing tag');\n}\n","import { ANCHOR, DOCTYPE, ELEMENT } from 'config/types';\nimport { voidElementNames } from 'utils/html';\nimport { READERS, PARTIAL_READERS } from '../_parse';\nimport cleanup from 'parse/utils/cleanup';\nimport readMustache from './readMustache';\nimport readClosingTag from './element/readClosingTag';\nimport readClosing from './mustache/section/readClosing';\nimport { create } from 'utils/object';\n\nconst tagNamePattern = /^[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/;\nconst anchorPattern = /^[a-zA-Z_$][-a-zA-Z0-9_$]*/;\nconst validTagNameFollower = /^[\\s\\n\\/>]/;\nconst exclude = { exclude: true };\n\n// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\nconst disallowedContents = {\n  li: ['li'],\n  dt: ['dt', 'dd'],\n  dd: ['dt', 'dd'],\n  p: 'address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split(\n    ' '\n  ),\n  rt: ['rt', 'rp'],\n  rp: ['rt', 'rp'],\n  optgroup: ['optgroup'],\n  option: ['option', 'optgroup'],\n  thead: ['tbody', 'tfoot'],\n  tbody: ['tbody', 'tfoot'],\n  tfoot: ['tbody'],\n  tr: ['tr', 'tbody'],\n  td: ['td', 'th', 'tr'],\n  th: ['td', 'th', 'tr']\n};\n\nexport default readElement;\n\nfunction readElement(parser) {\n  let attribute,\n    selfClosing,\n    children,\n    partials,\n    hasPartials,\n    child,\n    closed,\n    pos,\n    remaining,\n    closingTag,\n    anchor;\n\n  const start = parser.pos;\n\n  if (parser.inside || parser.inAttribute || parser.textOnlyMode) {\n    return null;\n  }\n\n  if (!parser.matchString('<')) {\n    return null;\n  }\n\n  // if this is a closing tag, abort straight away\n  if (parser.nextChar() === '/') {\n    return null;\n  }\n\n  const element = {};\n  if (parser.includeLinePositions) {\n    element.p = parser.getLinePos(start);\n  }\n\n  // check for doctype decl\n  if (parser.matchString('!')) {\n    element.t = DOCTYPE;\n    if (!parser.matchPattern(/^doctype/i)) {\n      parser.error('Expected DOCTYPE declaration');\n    }\n\n    element.a = parser.matchPattern(/^(.+?)>/);\n    return element;\n  } else if ((anchor = parser.matchString('#'))) {\n    // check for anchor\n    parser.sp();\n    element.t = ANCHOR;\n    element.n = parser.matchPattern(anchorPattern);\n  } else {\n    // otherwise, it's an element/component\n    element.t = ELEMENT;\n\n    // element name\n    element.e = parser.matchPattern(tagNamePattern);\n    if (!element.e) {\n      return null;\n    }\n  }\n\n  // next character must be whitespace, closing solidus or '>'\n  if (!validTagNameFollower.test(parser.nextChar())) {\n    parser.error('Illegal tag name');\n  }\n\n  parser.sp();\n\n  parser.inTag = true;\n\n  // directives and attributes\n  while ((attribute = readMustache(parser))) {\n    if (attribute !== false) {\n      if (!element.m) element.m = [];\n      element.m.push(attribute);\n    }\n\n    parser.sp();\n  }\n\n  parser.inTag = false;\n\n  // allow whitespace before closing solidus\n  parser.sp();\n\n  // self-closing solidus?\n  if (parser.matchString('/')) {\n    selfClosing = true;\n  }\n\n  // closing angle bracket\n  if (!parser.matchString('>')) {\n    return null;\n  }\n\n  const lowerCaseName = (element.e || element.n).toLowerCase();\n  const preserveWhitespace = parser.preserveWhitespace;\n\n  if (!selfClosing && (anchor || !voidElementNames.test(element.e))) {\n    if (!anchor) {\n      parser.elementStack.push(lowerCaseName);\n\n      // Special case - if we open a script element, further tags should\n      // be ignored unless they're a closing script element\n      if (lowerCaseName in parser.interpolate) {\n        parser.inside = lowerCaseName;\n      }\n    }\n\n    children = [];\n    partials = create(null);\n\n    do {\n      pos = parser.pos;\n      remaining = parser.remaining();\n\n      if (!remaining) {\n        // if this happens to be a script tag and there's no content left, it's because\n        // a closing script tag can't appear in a script\n        if (parser.inside === 'script') {\n          closed = true;\n          break;\n        }\n\n        parser.error(\n          `Missing end ${parser.elementStack.length > 1 ? 'tags' : 'tag'} (${parser.elementStack\n            .reverse()\n            .map(x => `</${x}>`)\n            .join('')})`\n        );\n      }\n\n      // if for example we're in an <li> element, and we see another\n      // <li> tag, close the first so they become siblings\n      if (!anchor && !canContain(lowerCaseName, remaining)) {\n        closed = true;\n      } else if (!anchor && (closingTag = readClosingTag(parser))) {\n        // closing tag\n        closed = true;\n\n        const closingTagName = closingTag.e.toLowerCase();\n\n        // if this *isn't* the closing tag for the current element...\n        if (closingTagName !== lowerCaseName) {\n          // rewind parser\n          parser.pos = pos;\n\n          // if it doesn't close a parent tag, error\n          if (!~parser.elementStack.indexOf(closingTagName)) {\n            let errorMessage = 'Unexpected closing tag';\n\n            // add additional help for void elements, since component names\n            // might clash with them\n            if (voidElementNames.test(closingTagName)) {\n              errorMessage += ` (<${closingTagName}> is a void element - it cannot contain children)`;\n            }\n\n            parser.error(errorMessage);\n          }\n        }\n      } else if (anchor && readAnchorClose(parser, element.n)) {\n        closed = true;\n      } else {\n        // implicit close by closing section tag. TODO clean this up\n        const tag = {\n          open: parser.standardDelimiters[0],\n          close: parser.standardDelimiters[1]\n        };\n        if (readClosing(parser, tag) || readInline(parser, tag)) {\n          closed = true;\n          parser.pos = pos;\n        } else if ((child = parser.read(PARTIAL_READERS))) {\n          if (partials[child.n]) {\n            parser.pos = pos;\n            parser.error('Duplicate partial definition');\n          }\n\n          cleanup(\n            child.f,\n            parser.stripComments,\n            preserveWhitespace,\n            !preserveWhitespace,\n            !preserveWhitespace\n          );\n\n          partials[child.n] = child.f;\n          hasPartials = true;\n        } else {\n          if ((child = parser.read(READERS))) {\n            children.push(child);\n          } else {\n            closed = true;\n          }\n        }\n      }\n    } while (!closed);\n\n    if (children.length) {\n      element.f = children;\n    }\n\n    if (hasPartials) {\n      element.p = partials;\n    }\n\n    parser.elementStack.pop();\n  }\n\n  parser.inside = null;\n\n  if (parser.sanitizeElements && parser.sanitizeElements.indexOf(lowerCaseName) !== -1) {\n    return exclude;\n  }\n\n  return element;\n}\n\nfunction canContain(name, remaining) {\n  const match = /^<([a-zA-Z][a-zA-Z0-9]*)/.exec(remaining);\n  const disallowed = disallowedContents[name];\n\n  if (!match || !disallowed) {\n    return true;\n  }\n\n  return !~disallowed.indexOf(match[1].toLowerCase());\n}\n\nfunction readAnchorClose(parser, name) {\n  const pos = parser.pos;\n  if (!parser.matchString('</')) {\n    return null;\n  }\n\n  parser.matchString('#');\n  parser.sp();\n\n  if (!parser.matchString(name)) {\n    parser.pos = pos;\n    return null;\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('>')) {\n    parser.pos = pos;\n    return null;\n  }\n\n  return true;\n}\n\nconst inlines = /^\\s*(elseif|else|then|catch)\\s*/;\nfunction readInline(parser, tag) {\n  const pos = parser.pos;\n  if (!parser.matchString(tag.open)) return;\n  if (parser.matchPattern(inlines)) {\n    return true;\n  } else {\n    parser.pos = pos;\n  }\n}\n","import { INLINE_PARTIAL } from 'config/types';\nimport { READERS } from '../_parse';\nimport readClosing from './mustache/section/readClosing';\n\nconst partialDefinitionSectionPattern = /^\\s*#\\s*partial\\s+/;\n\nexport default function readPartialDefinitionSection(parser) {\n  let child, closed;\n\n  const start = parser.pos;\n\n  const delimiters = parser.standardDelimiters;\n\n  if (!parser.matchString(delimiters[0])) {\n    return null;\n  }\n\n  if (!parser.matchPattern(partialDefinitionSectionPattern)) {\n    parser.pos = start;\n    return null;\n  }\n\n  const name = parser.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\\-\\/]*/);\n\n  if (!name) {\n    parser.error('expected legal partial name');\n  }\n\n  parser.sp();\n  if (!parser.matchString(delimiters[1])) {\n    parser.error(`Expected closing delimiter '${delimiters[1]}'`);\n  }\n\n  const content = [];\n\n  const [open, close] = delimiters;\n\n  do {\n    if ((child = readClosing(parser, { open, close }))) {\n      if (child.r !== 'partial') {\n        parser.error(`Expected ${open}/partial${close}`);\n      }\n\n      closed = true;\n    } else {\n      child = parser.read(READERS);\n\n      if (!child) {\n        parser.error(`Expected ${open}/partial${close}`);\n      }\n\n      content.push(child);\n    }\n  } while (!closed);\n\n  return {\n    t: INLINE_PARTIAL,\n    n: name,\n    f: content\n  };\n}\n","export default {};\n","import { TEMPLATE_VERSION } from 'config/template';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport readExpression from './converters/readExpression';\nimport { fromExpression } from './utils/createFunction';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport flattenExpression from './utils/flattenExpression';\nimport shared from '../Ractive/shared';\nimport { create, keys } from 'utils/object';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [\n  readPartial,\n  readUnescaped,\n  readSection,\n  readInterpolator,\n  readMustacheComment\n];\nconst TRIPLE_READERS = [readTriple];\n\nexport const READERS = [readMustache, readHtmlComment, readElement, readText];\nexport const PARTIAL_READERS = [readPartialDefinitionSection];\n\nconst defaultInterpolate = ['script', 'style', 'template'];\n\nconst StandardParser = Parser.extend({\n  init(str, options) {\n    const tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n    const staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n    const staticTripleDelimiters =\n      options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n    this.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n    this.tags = [\n      {\n        isStatic: false,\n        isTriple: false,\n        open: this.standardDelimiters[0],\n        close: this.standardDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: false,\n        isTriple: true,\n        open: tripleDelimiters[0],\n        close: tripleDelimiters[1],\n        readers: TRIPLE_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: false,\n        open: staticDelimiters[0],\n        close: staticDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: true,\n        open: staticTripleDelimiters[0],\n        close: staticTripleDelimiters[1],\n        readers: TRIPLE_READERS\n      }\n    ];\n\n    this.contextLines = options.contextLines || shared.defaults.contextLines;\n\n    this.sortMustacheTags();\n\n    this.sectionDepth = 0;\n    this.elementStack = [];\n\n    this.interpolate = create(options.interpolate || shared.defaults.interpolate || {});\n    this.interpolate.textarea = true;\n    defaultInterpolate.forEach(\n      t => (this.interpolate[t] = !options.interpolate || options.interpolate[t] !== false)\n    );\n\n    if (options.sanitize === true) {\n      options.sanitize = {\n        // blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n        elements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split(\n          ' '\n        ),\n        eventAttributes: true\n      };\n    }\n\n    this.stripComments = options.stripComments !== false;\n    this.preserveWhitespace = options.preserveWhitespace;\n    this.sanitizeElements = options.sanitize && options.sanitize.elements;\n    this.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n    this.includeLinePositions = options.includeLinePositions;\n    this.textOnlyMode = options.textOnlyMode;\n    this.csp = options.csp;\n    this.allowExpressions = options.allowExpressions;\n\n    if (options.expression) this.converters = [readExpression];\n\n    if (options.attributes) this.inTag = true;\n  },\n\n  postProcess(result, options) {\n    if (options.expression) {\n      const expr = flattenExpression(result[0]);\n      expr.e = fromExpression(expr.s, expr.r.length);\n      return expr;\n    } else {\n      // special case - empty string\n      if (!result.length) {\n        return { t: [], v: TEMPLATE_VERSION };\n      }\n\n      if (this.sectionDepth > 0) {\n        this.error('A section was left open');\n      }\n\n      cleanup(\n        result[0].t,\n        this.stripComments,\n        this.preserveWhitespace,\n        !this.preserveWhitespace,\n        !this.preserveWhitespace\n      );\n\n      if (this.csp !== false) {\n        const expr = {};\n        insertExpressions(result[0].t, expr);\n        if (keys(expr).length) result[0].e = expr;\n      }\n\n      return result[0];\n    }\n  },\n\n  converters: [readTemplate],\n\n  sortMustacheTags() {\n    // Sort in order of descending opening delimiter length (longer first),\n    // to protect against opening delimiters being substrings of each other\n    this.tags.sort((a, b) => {\n      return b.open.length - a.open.length;\n    });\n  }\n});\n\nexport default function parse(template, options) {\n  return new StandardParser(template, options || {}).result;\n}\n","import { fromExpression } from 'parse/utils/createFunction';\nimport { doc } from 'config/environment';\nimport { fatal } from 'utils/log';\nimport { addFunctions } from 'shared/getFunction';\nimport parse from 'parse/_parse';\nimport { isString } from 'utils/is';\n\nconst parseOptions = [\n  'delimiters',\n  'tripleDelimiters',\n  'staticDelimiters',\n  'staticTripleDelimiters',\n  'csp',\n  'interpolate',\n  'preserveWhitespace',\n  'sanitize',\n  'stripComments',\n  'contextLines',\n  'allowExpressions',\n  'attributes'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\nfunction throwNoParse(method, error, instructions) {\n  if (!method) {\n    fatal(`Missing Ractive.parse - cannot parse ${error}. ${instructions}`);\n  }\n}\n\nexport function createFunction(body, length) {\n  throwNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  return fromExpression(body, length);\n}\n\nexport function createFunctionFromString(str, bindTo) {\n  throwNoParse(parse, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  const tpl = parse(str, { expression: true });\n  return function() {\n    return tpl.e.apply(bindTo, tpl.r.map(r => bindTo.get(r)));\n  };\n}\n\nconst parser = {\n  fromId(id, options) {\n    if (!doc) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Cannot retrieve template #${id} as Ractive is not running in a browser.`);\n    }\n\n    if (id) id = id.replace(/^#/, '');\n\n    let template;\n\n    if (!(template = doc.getElementById(id))) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Could not find template element with id #${id}`);\n    }\n\n    if (template.tagName.toUpperCase() !== 'SCRIPT') {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Template element with id #${id}, must be a <script> element`);\n    }\n\n    return 'textContent' in template ? template.textContent : template.innerHTML;\n  },\n\n  isParsed(template) {\n    return !isString(template);\n  },\n\n  getParseOptions(ractive) {\n    // Could be Ractive or a Component\n    if (ractive.defaults) {\n      ractive = ractive.defaults;\n    }\n\n    return parseOptions.reduce((val, key) => {\n      val[key] = ractive[key];\n      return val;\n    }, {});\n  },\n\n  parse(template, options) {\n    throwNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n    const parsed = parse(template, options);\n    addFunctions(parsed);\n    return parsed;\n  },\n\n  parseFor(template, ractive) {\n    return this.parse(template, this.getParseOptions(ractive));\n  }\n};\n\nexport default parser;\n","import { removeFromArray } from 'utils/array';\nimport { isFunction } from 'utils/is';\n\nexport default class TransitionManager {\n  constructor(callback, parent) {\n    this.callback = callback;\n    this.parent = parent;\n\n    this.intros = [];\n    this.outros = [];\n\n    this.children = [];\n    this.totalChildren = this.outroChildren = 0;\n\n    this.detachQueue = [];\n    this.outrosComplete = false;\n\n    if (parent) {\n      parent.addChild(this);\n    }\n  }\n\n  add(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    transition.starting = true;\n    list.push(transition);\n  }\n\n  addChild(child) {\n    this.children.push(child);\n\n    this.totalChildren += 1;\n    this.outroChildren += 1;\n  }\n\n  decrementOutros() {\n    this.outroChildren -= 1;\n    check(this);\n  }\n\n  decrementTotal() {\n    this.totalChildren -= 1;\n    check(this);\n  }\n\n  detachNodes() {\n    this.detachQueue.forEach(detach);\n    this.children.forEach(_detachNodes);\n    this.detachQueue = [];\n  }\n\n  ready() {\n    if (this.detachQueue.length) detachImmediate(this);\n  }\n\n  remove(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    removeFromArray(list, transition);\n    check(this);\n  }\n\n  start() {\n    this.children.forEach(c => c.start());\n    this.intros.concat(this.outros).forEach(t => t.start());\n    this.ready = true;\n    check(this);\n  }\n}\n\nfunction detach(element) {\n  element.detach();\n}\n\nfunction _detachNodes(tm) {\n  // _ to avoid transpiler quirk\n  tm.detachNodes();\n}\n\nfunction check(tm) {\n  if (!tm.ready || tm.outros.length || tm.outroChildren) return;\n\n  // If all outros are complete, and we haven't already done this,\n  // we notify the parent if there is one, otherwise\n  // start detaching nodes\n  if (!tm.outrosComplete) {\n    tm.outrosComplete = true;\n\n    if (tm.parent && !tm.parent.outrosComplete) {\n      tm.parent.decrementOutros(tm);\n    } else {\n      tm.detachNodes();\n    }\n  }\n\n  // Once everything is done, we can notify parent transition\n  // manager and call the callback\n  if (!tm.intros.length && !tm.totalChildren) {\n    if (isFunction(tm.callback)) {\n      tm.callback();\n    }\n\n    if (tm.parent && !tm.notifiedTotal) {\n      tm.notifiedTotal = true;\n      tm.parent.decrementTotal();\n    }\n  }\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate(manager) {\n  const queue = manager.detachQueue;\n  const outros = collectAllOutros(manager);\n\n  let i = queue.length;\n  let j = 0;\n  let node, trans;\n  start: while (i--) {\n    node = queue[i].node;\n    j = outros.length;\n    while (j--) {\n      trans = outros[j].element.node;\n      // check to see if the node is, contains, or is contained by the transitioning node\n      if (trans === node || trans.contains(node) || node.contains(trans)) continue start;\n    }\n\n    // no match, we can drop it\n    queue[i].detach();\n    queue.splice(i, 1);\n  }\n}\n\nfunction collectAllOutros(manager, _list) {\n  let list = _list;\n\n  // if there's no list, we're starting at the root to build one\n  if (!list) {\n    list = [];\n    let parent = manager;\n    while (parent.parent) parent = parent.parent;\n    return collectAllOutros(parent, list);\n  } else {\n    // grab all outros from child managers\n    let i = manager.children.length;\n    while (i--) {\n      list = collectAllOutros(manager.children[i], list);\n    }\n\n    // grab any from this manager if there are any\n    if (manager.outros.length) list = list.concat(manager.outros);\n\n    return list;\n  }\n}\n","import { addToArray } from 'utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n  active() {\n    return !!batch;\n  },\n\n  start() {\n    let fulfilPromise;\n    const promise = new Promise(f => (fulfilPromise = f));\n\n    batch = {\n      previousBatch: batch,\n      transitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n      fragments: [],\n      tasks: [],\n      immediateObservers: [],\n      deferredObservers: [],\n      promise\n    };\n\n    return promise;\n  },\n\n  end() {\n    flushChanges();\n\n    if (!batch.previousBatch) batch.transitionManager.start();\n\n    batch = batch.previousBatch;\n  },\n\n  addFragment(fragment) {\n    addToArray(batch.fragments, fragment);\n  },\n\n  // TODO: come up with a better way to handle fragments that trigger their own update\n  addFragmentToRoot(fragment) {\n    if (!batch) return;\n\n    let b = batch;\n    while (b.previousBatch) {\n      b = b.previousBatch;\n    }\n\n    addToArray(b.fragments, fragment);\n  },\n\n  addObserver(observer, defer) {\n    if (!batch) {\n      observer.dispatch();\n    } else {\n      addToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n    }\n  },\n\n  registerTransition(transition) {\n    transition._manager = batch.transitionManager;\n    batch.transitionManager.add(transition);\n  },\n\n  // synchronise node detachments with transition ends\n  detachWhenReady(thing) {\n    batch.transitionManager.detachQueue.push(thing);\n  },\n\n  scheduleTask(task, postRender) {\n    let _batch;\n\n    if (!batch) {\n      task();\n    } else {\n      _batch = batch;\n      while (postRender && _batch.previousBatch) {\n        // this can't happen until the DOM has been fully updated\n        // otherwise in some situations (with components inside elements)\n        // transitions and decorators will initialise prematurely\n        _batch = _batch.previousBatch;\n      }\n\n      _batch.tasks.push(task);\n    }\n  },\n\n  promise() {\n    if (!batch) return Promise.resolve();\n\n    let target = batch;\n    while (target.previousBatch) {\n      target = target.previousBatch;\n    }\n\n    return target.promise || Promise.resolve();\n  }\n};\n\nexport default runloop;\n\nfunction dispatch(observer) {\n  observer.dispatch();\n}\n\nfunction flushChanges() {\n  let which = batch.immediateObservers;\n  batch.immediateObservers = [];\n  which.forEach(dispatch);\n\n  // Now that changes have been fully propagated, we can update the DOM\n  // and complete other tasks\n  let i = batch.fragments.length;\n  let fragment;\n\n  which = batch.fragments;\n  batch.fragments = [];\n\n  while (i--) {\n    fragment = which[i];\n    fragment.update();\n  }\n\n  batch.transitionManager.ready();\n\n  which = batch.deferredObservers;\n  batch.deferredObservers = [];\n  which.forEach(dispatch);\n\n  const tasks = batch.tasks;\n  batch.tasks = [];\n\n  for (i = 0; i < tasks.length; i += 1) {\n    tasks[i]();\n  }\n\n  // If updating the view caused some model blowback - e.g. a triple\n  // containing <option> elements caused the binding on the <select>\n  // to update - then we start over\n  if (\n    batch.fragments.length ||\n    batch.immediateObservers.length ||\n    batch.deferredObservers.length ||\n    batch.tasks.length\n  )\n    return flushChanges();\n}\n","import runloop from 'src/global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick() {\n  runloop.start();\n\n  const now = performance.now();\n\n  let i;\n  let ticker;\n\n  for (i = 0; i < tickers.length; i += 1) {\n    ticker = tickers[i];\n\n    if (!ticker.tick(now)) {\n      // ticker is complete, remove it from the stack, and decrement i so we don't miss one\n      tickers.splice(i--, 1);\n    }\n  }\n\n  runloop.end();\n\n  if (tickers.length) {\n    requestAnimationFrame(tick);\n  } else {\n    running = false;\n  }\n}\n\nexport default class Ticker {\n  constructor(options) {\n    this.duration = options.duration;\n    this.step = options.step;\n    this.complete = options.complete;\n    this.easing = options.easing;\n\n    this.start = performance.now();\n    this.end = this.start + this.duration;\n\n    this.running = true;\n\n    tickers.push(this);\n    if (!running) requestAnimationFrame(tick);\n  }\n\n  tick(now) {\n    if (!this.running) return false;\n\n    if (now > this.end) {\n      if (this.step) this.step(1);\n      if (this.complete) this.complete(1);\n\n      return false;\n    }\n\n    const elapsed = now - this.start;\n    const eased = this.easing(elapsed / this.duration);\n\n    if (this.step) this.step(eased);\n\n    return true;\n  }\n\n  stop() {\n    if (this.abort) this.abort();\n    this.running = false;\n  }\n}\n","import { hasOwn } from 'utils/object';\nimport { isString, isObjectType } from 'utils/is';\n\nconst prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\n/* istanbul ignore next */\nfunction prefixKeypath(obj, prefix) {\n  const prefixed = {};\n\n  if (!prefix) {\n    return obj;\n  }\n\n  prefix += '.';\n\n  for (const key in obj) {\n    if (hasOwn(obj, key)) {\n      prefixed[prefix + key] = obj[key];\n    }\n  }\n\n  return prefixed;\n}\n\nexport default function getPrefixer(rootKeypath) {\n  let rootDot;\n\n  if (!prefixers[rootKeypath]) {\n    rootDot = rootKeypath ? rootKeypath + '.' : '';\n\n    /* istanbul ignore next */\n    prefixers[rootKeypath] = function(relativeKeypath, value) {\n      let obj;\n\n      if (isString(relativeKeypath)) {\n        obj = {};\n        obj[rootDot + relativeKeypath] = value;\n        return obj;\n      }\n\n      if (isObjectType(relativeKeypath)) {\n        // 'relativeKeypath' is in fact a hash, not a keypath\n        return rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n      }\n    };\n  }\n\n  return prefixers[rootKeypath];\n}\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport getComputationSignature from 'src/Ractive/helpers/getComputationSignature';\nimport { capture } from 'src/global/capture';\nimport { isArray, isEqual, isNumeric, isObjectLike } from 'utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from 'shared/methodCallers';\nimport Ticker from 'shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from 'shared/keypaths';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn, keys } from 'utils/object';\nimport { buildNewIndices } from 'utils/array';\n\nexport const shared = {};\n\nexport default class Model extends ModelBase {\n  constructor(parent, key) {\n    super(parent);\n\n    this.ticker = null;\n\n    if (parent) {\n      this.key = unescapeKey(key);\n      this.isReadonly = parent.isReadonly;\n\n      if (parent.value) {\n        this.value = parent.value[this.key];\n        if (isArray(this.value)) this.length = this.value.length;\n        this.adapt();\n      }\n    }\n  }\n\n  adapt() {\n    const adaptors = this.root.adaptors;\n    const len = adaptors.length;\n\n    this.rewrap = false;\n\n    // Exit early if no adaptors\n    if (len === 0) return;\n\n    const value = this.wrapper\n      ? 'newWrapperValue' in this ? this.newWrapperValue : this.wrapperValue\n      : this.value;\n\n    // TODO remove this legacy nonsense\n    const ractive = this.root.ractive;\n    const keypath = this.getKeypath();\n\n    // tear previous adaptor down if present\n    if (this.wrapper) {\n      const shouldTeardown =\n        this.wrapperValue === value\n          ? false\n          : !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        this.wrapper.teardown();\n        delete this.wrapper;\n        delete this.wrapperValue;\n\n        // don't branch for undefined values\n        if (this.value !== undefined) {\n          const parentValue = this.parent.value || this.parent.createBranch(this.key);\n          if (parentValue[this.key] !== value) parentValue[this.key] = value;\n          this.value = value;\n        }\n      } else {\n        delete this.newWrapperValue;\n        this.value = this.wrapper.get();\n        return;\n      }\n    }\n\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const adaptor = adaptors[i];\n      if (adaptor.filter(value, keypath, ractive)) {\n        this.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n        this.wrapperValue = value;\n        this.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n        this.value = this.wrapper.get();\n\n        break;\n      }\n    }\n  }\n\n  animate(from, to, options, interpolator) {\n    if (this.ticker) this.ticker.stop();\n\n    let fulfilPromise;\n    const promise = new Promise(fulfil => (fulfilPromise = fulfil));\n\n    this.ticker = new Ticker({\n      duration: options.duration,\n      easing: options.easing,\n      step: t => {\n        const value = interpolator(t);\n        this.applyValue(value);\n        if (options.step) options.step(t, value);\n      },\n      complete: () => {\n        this.applyValue(to);\n        if (options.complete) options.complete(to);\n\n        this.ticker = null;\n        fulfilPromise(to);\n      }\n    });\n\n    promise.stop = this.ticker.stop;\n    return promise;\n  }\n\n  applyValue(value, notify = true) {\n    if (isEqual(value, this.value)) return;\n    if (this.boundValue) this.boundValue = null;\n\n    if (this.parent.wrapper && this.parent.wrapper.set) {\n      this.parent.wrapper.set(this.key, value);\n      this.parent.value = this.parent.wrapper.get();\n\n      this.value = this.parent.value[this.key];\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    } else if (this.wrapper) {\n      this.newWrapperValue = value;\n      this.adapt();\n    } else {\n      const parentValue = this.parent.value || this.parent.createBranch(this.key);\n      if (isObjectLike(parentValue)) {\n        parentValue[this.key] = value;\n      } else {\n        warnIfDebug(`Attempted to set a property of a non-object '${this.getKeypath()}'`);\n        return;\n      }\n\n      this.value = value;\n      this.adapt();\n    }\n\n    // keep track of array stuff\n    if (isArray(value)) {\n      this.length = value.length;\n      this.isArray = true;\n    } else {\n      this.isArray = false;\n    }\n\n    // notify dependants\n    this.links.forEach(handleChange);\n    this.children.forEach(mark);\n    this.deps.forEach(handleChange);\n\n    if (notify) this.notifyUpstream();\n\n    if (this.parent.isArray) {\n      if (this.key === 'length') this.parent.length = value;\n      else this.parent.joinKey('length').mark();\n    }\n  }\n\n  compute(key, computed) {\n    const registry = this.computed || (this.computed = {});\n\n    if (registry[key]) {\n      registry[key].signature = getComputationSignature(this.root.ractive, key, computed);\n      registry[key].mark();\n    } else {\n      registry[key] = new shared.Computation(\n        this,\n        getComputationSignature(this.root.ractive, key, computed),\n        key\n      );\n    }\n\n    return registry[key];\n  }\n\n  createBranch(key) {\n    const branch = isNumeric(key) ? [] : {};\n    this.applyValue(branch, false);\n\n    return branch;\n  }\n\n  get(shouldCapture, opts) {\n    if (this._link) return this._link.get(shouldCapture, opts);\n    if (shouldCapture) capture(this);\n    // if capturing, this value needs to be unwrapped because it's for external use\n    if (opts && opts.virtual) return this.getVirtual(false);\n    return maybeBind(\n      this,\n      (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  joinKey(key, opts) {\n    if (this._link) {\n      if (opts && opts.lastLink !== false && (key === undefined || key === '')) return this;\n      return this._link.joinKey(key);\n    }\n\n    if (key === undefined || key === '') return this;\n\n    let child;\n    if (hasOwn(this.childByKey, key)) child = this.childByKey[key];\n    else child = this.computed && this.computed[key];\n\n    if (!child) {\n      let computed;\n      if (this.isRoot && this.ractive && (computed = this.ractive.computed[key])) {\n        child = this.compute(key, computed);\n      } else if (!this.isRoot && this.root.ractive) {\n        const registry = this.root.ractive.computed;\n        for (const k in registry) {\n          computed = registry[k];\n          if (computed.pattern && computed.pattern.test(this.getKeypath() + '.' + key)) {\n            child = this.compute(key, computed);\n          }\n        }\n      }\n    }\n\n    if (!child) {\n      child = new Model(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    if (child._link && (!opts || opts.lastLink !== false)) return child._link;\n\n    return child;\n  }\n\n  mark(force) {\n    if (this._link) return this._link.mark(force);\n\n    const old = this.value;\n    const value = this.retrieve();\n\n    if (force || !isEqual(value, old)) {\n      this.value = value;\n      if (this.boundValue) this.boundValue = null;\n\n      // make sure the wrapper stays in sync\n      if (old !== value || this.rewrap) {\n        if (this.wrapper) this.newWrapperValue = value;\n        this.adapt();\n      }\n\n      // keep track of array stuff\n      if (isArray(value)) {\n        this.length = value.length;\n        this.isArray = true;\n      } else {\n        this.isArray = false;\n      }\n\n      this.children.forEach(force ? markForce : mark);\n      this.links.forEach(marked);\n\n      this.deps.forEach(handleChange);\n    }\n  }\n\n  merge(array, comparator) {\n    const newIndices = buildNewIndices(\n      this.value === array ? recreateArray(this) : this.value,\n      array,\n      comparator\n    );\n    this.parent.value[this.key] = array;\n    this.shuffle(newIndices, true);\n  }\n\n  retrieve() {\n    return this.parent.value ? this.parent.value[this.key] : undefined;\n  }\n\n  set(value) {\n    if (this.ticker) this.ticker.stop();\n    this.applyValue(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    shuffle(this, newIndices, false, unsafe);\n  }\n\n  source() {\n    return this;\n  }\n\n  teardown() {\n    if (this._link) {\n      this._link.teardown();\n      this._link = null;\n    }\n    this.children.forEach(teardown);\n    if (this.wrapper) this.wrapper.teardown();\n    if (this.computed) keys(this.computed).forEach(k => this.computed[k].teardown());\n  }\n}\n\nfunction recreateArray(model) {\n  const array = [];\n\n  for (let i = 0; i < model.length; i++) {\n    array[i] = (model.childByKey[i] || {}).value;\n  }\n\n  return array;\n}\n","/* global global */\nimport Model from '../Model';\n\nexport const data = {};\n\nexport class SharedModel extends Model {\n  constructor(value, name) {\n    super(null, `@${name}`);\n    this.key = `@${name}`;\n    this.value = value;\n    this.isRoot = true;\n    this.root = this;\n    this.adaptors = [];\n  }\n\n  getKeypath() {\n    return this.key;\n  }\n\n  retrieve() {\n    return this.value;\n  }\n}\n\nexport default new SharedModel(data, 'shared');\n\nexport const GlobalModel = new SharedModel(\n  typeof global !== 'undefined' ? global : window,\n  'global'\n);\n","import { splitKeypath } from 'shared/keypaths';\nimport SharedModel, { GlobalModel } from 'src/model/specials/SharedModel';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction findContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context && !frag.aliases) frag = frag.parent;\n  return frag;\n}\n\nexport default function resolveReference(fragment, ref) {\n  const initialFragment = fragment;\n  // current context ref\n  if (ref === '.') return fragment.findContext();\n\n  // ancestor references\n  if (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypath(ref.slice(2)));\n\n  // scoped references\n  if (ref[0] === '.' || ref[0] === '^') {\n    let frag = fragment;\n    const parts = ref.split('/');\n    const explicitContext = parts[0] === '^^';\n\n    // find nearest context node\n    while (frag && !frag.context) {\n      frag = up(frag);\n    }\n    let context = frag && frag.context;\n\n    // walk up the context chain\n    while (frag && parts[0] === '^^') {\n      parts.shift();\n\n      // the current fragment should always be a context,\n      // and if it happens to be an iteration, jump above the each block\n      if (frag.isIteration) {\n        frag = frag.parent.parent;\n      } else {\n        // otherwise jump above the current fragment\n        frag = up(frag);\n      }\n\n      // walk to the next contexted fragment\n      while (frag && !frag.context) {\n        frag = up(frag);\n      }\n      context = frag && frag.context;\n    }\n\n    if (!context && explicitContext) {\n      throw new Error(\n        `Invalid context parent reference ('${ref}'). There is not context at that level.`\n      );\n    }\n\n    // walk up the context path\n    while (parts[0] === '.' || parts[0] === '..') {\n      const part = parts.shift();\n\n      if (part === '..') {\n        context = context.parent;\n      }\n    }\n\n    ref = parts.join('/');\n\n    // special case - `{{.foo}}` means the same as `{{./foo}}`\n    if (ref[0] === '.') ref = ref.slice(1);\n    return context.joinAll(splitKeypath(ref));\n  }\n\n  const keys = splitKeypath(ref);\n  if (!keys.length) return;\n  const base = keys.shift();\n\n  // special refs\n  if (base[0] === '@') {\n    // shorthand from outside the template\n    // @this referring to local ractive instance\n    if (base === '@this' || base === '@') {\n      return fragment.ractive.viewmodel.getRactiveModel().joinAll(keys);\n    } else if (base === '@index' || base === '@key') {\n      // @index or @key referring to the nearest repeating index or key\n      if (keys.length) badReference(base);\n      const repeater = findIter(fragment);\n      return repeater && repeater[`get${base[1] === 'i' ? 'Index' : 'Key'}`]();\n    } else if (base === '@last') {\n      const repeater = findIter(fragment);\n      return repeater && repeater.parent.getLast();\n    } else if (base === '@global') {\n      // @global referring to window or global\n      return GlobalModel.joinAll(keys);\n    } else if (base === '@shared') {\n      // @global referring to window or global\n      return SharedModel.joinAll(keys);\n    } else if (base === '@keypath' || base === '@rootpath') {\n      // @keypath or @rootpath, the current keypath string\n      const root = ref[1] === 'r' ? fragment.ractive.root : null;\n      let f = fragment;\n\n      while (f && (!f.context || (f.isRoot && f.ractive.component))) {\n        f = f.isRoot ? f.componentParent : f.parent;\n      }\n\n      return f.getKeypath(root);\n    } else if (base === '@context') {\n      return new ContextModel(fragment.getContext());\n    } else if (base === '@local') {\n      // @context-local data\n      return fragment.getContext()._data.joinAll(keys);\n    } else if (base === '@style') {\n      // @style shared model\n      return fragment.ractive.constructor._cssModel.joinAll(keys);\n    } else if (base === '@helpers') {\n      // @helpers instance model\n      return fragment.ractive.viewmodel.getHelpers().joinAll(keys);\n    } else {\n      // nope\n      throw new Error(`Invalid special reference '${base}'`);\n    }\n  }\n\n  // helpers\n  if (base && !keys.length) {\n    const helpers = fragment.ractive.viewmodel.getHelpers();\n    if (helpers.has(base)) return helpers.joinKey(base);\n  }\n\n  let context = findContext(fragment);\n\n  // check immediate context for a match\n  if (context) {\n    if (context.context) {\n      context = context.context;\n      if (context.has(base)) return context.joinKey(base).joinAll(keys);\n    } else {\n      // alias block, so get next full context for later\n      context = fragment.findContext();\n    }\n  } else {\n    context = fragment.findContext();\n  }\n\n  // walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n  let createMapping = false;\n  const shouldWarn = fragment.ractive.warnAboutAmbiguity;\n  let model;\n\n  while (fragment) {\n    // repeated fragments\n    if (fragment.isIteration) {\n      if (base === fragment.parent.keyRef) {\n        model = fragment.getKey();\n      } else if (base === fragment.parent.indexRef) {\n        model = fragment.getIndex();\n      }\n\n      if (model && keys.length) badReference(base);\n    }\n\n    // alias node or iteration\n    if (!model && fragment.aliases && hasOwn(fragment.aliases, base)) {\n      model = fragment.aliases[base];\n    }\n\n    // check fragment context to see if it has the key we need\n    if (!model && fragment.context && fragment.context.has(base)) {\n      model = fragment.context.joinKey(base);\n\n      // this is an implicit mapping\n      if (createMapping) {\n        if (shouldWarn)\n          warnIfDebug(\n            `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.`\n          );\n      } else if (shouldWarn) warnIfDebug(`'${ref}' resolved but is ambiguous.`);\n    }\n\n    if (model) {\n      if (createMapping) {\n        model = initialFragment.ractive.viewmodel.createLink(base, model, base, { implicit: true });\n      }\n\n      if (keys.length > 0 && isFunction(model.joinAll)) {\n        model = model.joinAll(keys);\n      }\n\n      return model;\n    }\n\n    if (\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component)) &&\n      !fragment.ractive.isolated\n    ) {\n      // ascend through component boundary\n      fragment = fragment.componentParent || fragment.ractive.component.up;\n      createMapping = true;\n    } else {\n      fragment = fragment.parent;\n    }\n  }\n\n  // if enabled, check the instance for a match\n  const instance = initialFragment.ractive;\n  if (instance.resolveInstanceMembers && base !== 'data' && base in instance) {\n    return instance.viewmodel\n      .getRactiveModel()\n      .joinKey(base)\n      .joinAll(keys);\n  }\n\n  if (shouldWarn) {\n    warnIfDebug(`'${ref}' is ambiguous and did not resolve.`);\n  }\n\n  // didn't find anything, so go ahead and create the key on the local model\n  return context.joinKey(base).joinAll(keys);\n}\n\nfunction up(fragment) {\n  return fragment && ((!fragment.ractive.isolated && fragment.componentParent) || fragment.parent);\n}\n\nfunction findIter(start) {\n  let fragment = start;\n  let next;\n  while (!fragment.isIteration && (next = up(fragment))) {\n    fragment = next;\n  }\n\n  return fragment.isIteration && fragment;\n}\n\nfunction badReference(key) {\n  throw new Error(`An index or key reference (${key}) cannot have child properties`);\n}\n\nclass ContextModel {\n  constructor(context) {\n    this.context = context;\n  }\n\n  get() {\n    return this.context;\n  }\n}\n","import noop from 'utils/noop';\nimport { assign, create } from 'utils/object';\n\nexport const extern = {};\n\nexport default function getRactiveContext(ractive, ...assigns) {\n  const fragment =\n    ractive.fragment ||\n    ractive._fakeFragment ||\n    (ractive._fakeFragment = new FakeFragment(ractive));\n  return fragment.getContext.apply(fragment, assigns);\n}\n\nexport function getContext(...assigns) {\n  if (!this.ctx) this.ctx = new extern.Context(this);\n  assigns.unshift(create(this.ctx));\n  return assign.apply(null, assigns);\n}\n\nexport class FakeFragment {\n  constructor(ractive) {\n    this.ractive = ractive;\n  }\n\n  findContext() {\n    return this.ractive.viewmodel;\n  }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n\nexport function findParentWithContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context) frag = frag.parent;\n  if (!frag) return fragment && fragment.ractive.fragment;\n  else return frag;\n}\n","import { isArray, isObject, isObjectType, isFunction, isString } from 'utils/is';\nimport { warnIfDebug } from 'utils/log';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { FakeFragment } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\n\nexport let keep = false;\n\nexport function set(pairs, options) {\n  const k = keep;\n\n  const deep = options && options.deep;\n  const shuffle = options && options.shuffle;\n  const promise = runloop.start();\n  if (options && 'keep' in options) keep = options.keep;\n\n  let i = pairs.length;\n  while (i--) {\n    const model = pairs[i][0];\n    const value = pairs[i][1];\n    const keypath = pairs[i][2];\n\n    if (!model) {\n      runloop.end();\n      throw new Error(`Failed to set invalid keypath '${keypath}'`);\n    }\n\n    if (deep) deepSet(model, value);\n    else if (shuffle) {\n      let array = value;\n      const target = model.get();\n      // shuffle target array with itself\n      if (!array) array = target;\n\n      // if there's not an array there yet, go ahead and set\n      if (target === undefined) {\n        model.set(array);\n      } else {\n        if (!isArray(target) || !isArray(array)) {\n          runloop.end();\n          throw new Error('You cannot merge an array with a non-array');\n        }\n\n        const comparator = getComparator(shuffle);\n        model.merge(array, comparator);\n      }\n    } else model.set(value);\n  }\n\n  runloop.end();\n\n  keep = k;\n\n  return promise;\n}\n\nconst star = /\\*/;\nexport function gather(ractive, keypath, base, isolated) {\n  if (!base && (keypath[0] === '.' || keypath[1] === '^')) {\n    warnIfDebug(\n      `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.`\n    );\n    return [];\n  }\n\n  const keys = splitKeypath(keypath);\n  const model = base || ractive.viewmodel;\n\n  if (star.test(keypath)) {\n    return model.findMatches(keys);\n  } else {\n    if (model === ractive.viewmodel) {\n      // allow implicit mappings\n      if (\n        ractive.component &&\n        !ractive.isolated &&\n        !model.has(keys[0]) &&\n        keypath[0] !== '@' &&\n        keypath[0] &&\n        !isolated\n      ) {\n        return [resolveReference(ractive.fragment || new FakeFragment(ractive), keypath)];\n      } else {\n        return [model.joinAll(keys)];\n      }\n    } else {\n      return [model.joinAll(keys)];\n    }\n  }\n}\n\nexport function build(ractive, keypath, value, isolated) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push.apply(sets, gather(ractive, k, null, isolated).map(m => [m, keypath[k], k]));\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push.apply(sets, gather(ractive, keypath, null, isolated).map(m => [m, value, keypath]));\n  }\n\n  return sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet(model, value) {\n  const dest = model.get(false, deepOpts);\n\n  // if dest doesn't exist, just set it\n  if (dest == null || !isObjectType(value)) return model.set(value);\n  if (!isObjectType(dest)) return model.set(value);\n\n  for (const k in value) {\n    if (hasOwn(value, k)) {\n      deepSet(model.joinKey(k), value[k]);\n    }\n  }\n}\n\nconst comparators = {};\nfunction getComparator(option) {\n  if (option === true) return null; // use existing arrays\n  if (isFunction(option)) return option;\n\n  if (isString(option)) {\n    return comparators[option] || (comparators[option] = thing => thing[option]);\n  }\n\n  throw new Error('If supplied, options.compare must be a string, function, or true'); // TODO link to docs\n}\n","import { isNumeric, isString } from 'utils/is';\nimport { build, set } from 'shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add(ractive, keypath, d, options) {\n  if (!isString(keypath) || !isNumeric(d)) {\n    throw new Error('Bad arguments');\n  }\n\n  const sets = build(ractive, keypath, d, options && options.isolated);\n\n  return set(\n    sets.map(pair => {\n      const [model, add] = pair;\n      const value = model.get();\n      if (!isNumeric(add) || !isNumeric(value)) throw new Error(errorMessage);\n      return [model, value + add];\n    })\n  );\n}\n","import runloop from 'src/global/runloop';\nimport easing from 'src/Ractive/static/easing';\nimport interpolate from 'shared/interpolate';\nimport { isEqual, isFunction, isObjectType } from 'utils/is';\nimport noop from 'utils/noop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { defineProperty, keys as objectKeys } from 'utils/object';\n\nfunction immediate(value) {\n  const result = Promise.resolve(value);\n  defineProperty(result, 'stop', { value: noop });\n  return result;\n}\n\nconst linear = easing.linear;\n\nfunction getOptions(options, instance) {\n  options = options || {};\n\n  let easing;\n  if (options.easing) {\n    easing = isFunction(options.easing) ? options.easing : instance.easing[options.easing];\n  }\n\n  return {\n    easing: easing || linear,\n    duration: 'duration' in options ? options.duration : 400,\n    complete: options.complete || noop,\n    step: options.step || noop,\n    interpolator: options.interpolator\n  };\n}\n\nexport function animate(ractive, model, to, options) {\n  options = getOptions(options, ractive);\n  const from = model.get();\n\n  // don't bother animating values that stay the same\n  if (isEqual(from, to)) {\n    options.complete(options.to);\n    return immediate(to);\n  }\n\n  const interpolator = interpolate(from, to, ractive, options.interpolator);\n\n  // if we can't interpolate the value, set it immediately\n  if (!interpolator) {\n    runloop.start();\n    model.set(to);\n    runloop.end();\n\n    return immediate(to);\n  }\n\n  return model.animate(from, to, options, interpolator);\n}\n\nexport default function Ractive$animate(keypath, to, options) {\n  if (isObjectType(keypath)) {\n    const keys = objectKeys(keypath);\n\n    throw new Error(`ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map(key => `'${key}': ${keypath[key]}`).join('\\n  ')}\n}, {...}), do\n\n${keys.map(key => `ractive.animate('${key}', ${keypath[key]}, {...});`).join('\\n')}\n`);\n  }\n\n  return animate(this, this.viewmodel.joinAll(splitKeypath(keypath)), to, options);\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants(name, initial) {\n  const map = initial ? initStars : bubbleStars;\n  if (map[name]) return map[name];\n\n  const parts = name.split('.');\n  const result = [];\n  let base = false;\n\n  // initial events the implicit namespace of 'this'\n  if (initial) {\n    parts.unshift('this');\n    base = true;\n  }\n\n  // use max - 1 bits as a bitmap to pick a part or a *\n  // need to skip the full star case if the namespace is synthetic\n  const max = Math.pow(2, parts.length) - (initial ? 1 : 0);\n  for (let i = 0; i < max; i++) {\n    const join = [];\n    for (let j = 0; j < parts.length; j++) {\n      join.push(1 & (i >> j) ? '*' : parts[j]);\n    }\n    result.unshift(join.join('.'));\n  }\n\n  if (base) {\n    // include non-this-namespaced versions\n    if (parts.length > 2) {\n      result.push.apply(result, variants(name, false));\n    } else {\n      result.push('*');\n      result.push(name);\n    }\n  }\n\n  map[name] = result;\n  return result;\n}\n\nexport default function fireEvent(ractive, eventName, context, args = []) {\n  if (!eventName) {\n    return;\n  }\n\n  context.name = eventName;\n  args.unshift(context);\n\n  const eventNames = ractive._nsSubs ? variants(eventName, true) : ['*', eventName];\n\n  return fireEventAs(ractive, eventNames, context, args, true);\n}\n\nfunction fireEventAs(ractive, eventNames, context, args, initialFire = false) {\n  let bubble = true;\n\n  if (initialFire || ractive._nsSubs) {\n    enqueue(ractive, context);\n\n    let i = eventNames.length;\n    while (i--) {\n      if (eventNames[i] in ractive._subs) {\n        bubble = notifySubscribers(ractive, ractive._subs[eventNames[i]], context, args) && bubble;\n      }\n    }\n\n    dequeue(ractive);\n  }\n\n  if (ractive.parent && bubble) {\n    if (initialFire && ractive.component) {\n      const fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n      eventNames = variants(fullName, false);\n\n      if (context && !context.component) {\n        context.component = ractive;\n      }\n    }\n\n    bubble = fireEventAs(ractive.parent, eventNames, context, args);\n  }\n\n  return bubble;\n}\n\nfunction notifySubscribers(ractive, subscribers, context, args) {\n  let originalEvent = null;\n  let stopEvent = false;\n\n  // subscribers can be modified inflight, e.g. \"once\" functionality\n  // so we need to copy to make sure everyone gets called\n  subscribers = subscribers.slice();\n\n  for (let i = 0, len = subscribers.length; i < len; i += 1) {\n    if (!subscribers[i].off && subscribers[i].handler.apply(ractive, args) === false) {\n      stopEvent = true;\n    }\n  }\n\n  if (context && stopEvent && (originalEvent = context.event)) {\n    originalEvent.preventDefault && originalEvent.preventDefault();\n    originalEvent.stopPropagation && originalEvent.stopPropagation();\n  }\n\n  return !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport default class Hook {\n  constructor(event) {\n    this.event = event;\n    this.method = 'on' + event;\n  }\n\n  fire(ractive, arg) {\n    const context = getRactiveContext(ractive);\n\n    if (ractive[this.method]) {\n      arg ? ractive[this.method](context, arg) : ractive[this.method](context);\n    }\n\n    fireEvent(ractive, this.event, context, arg ? [arg, ractive] : [ractive]);\n  }\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { unrenderChild, updateAnchors } from 'shared/anchors';\n\nconst attachHook = new Hook('attachchild');\n\nexport default function attachChild(child, options = {}) {\n  const children = this._children;\n  let idx;\n\n  if (child.parent && child.parent !== this)\n    throw new Error(\n      `Instance ${child._guid} is already attached to a different instance ${\n        child.parent._guid\n      }. Please detach it from the other instance using detachChild first.`\n    );\n  else if (child.parent)\n    throw new Error(`Instance ${child._guid} is already attached to this instance.`);\n\n  const meta = {\n    instance: child,\n    ractive: this,\n    name: options.name || child.constructor.name || 'Ractive',\n    target: options.target || false,\n    bubble,\n    findNextNode\n  };\n  meta.nameOption = options.name;\n\n  // child is managing itself\n  if (!meta.target) {\n    meta.up = this.fragment;\n    meta.external = true;\n  } else {\n    let list;\n    if (!(list = children.byName[meta.target])) {\n      list = [];\n      this.set(`@this.children.byName.${meta.target}`, list);\n    }\n    idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n  }\n\n  child.set({\n    '@this.parent': this,\n    '@this.root': this.root\n  });\n  child.component = meta;\n  children.push(meta);\n\n  attachHook.fire(child);\n\n  const promise = runloop.start();\n\n  if (meta.target) {\n    unrenderChild(meta);\n    this.splice(`@this.children.byName.${meta.target}`, idx, 0, meta);\n    updateAnchors(this, meta.target);\n  } else {\n    if (!child.isolated) child.viewmodel.attached(this.fragment);\n  }\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n\nfunction bubble() {\n  runloop.addFragment(this.instance.fragment);\n}\n\nfunction findNextNode() {\n  if (this.anchor) return this.anchor.findNextNode();\n}\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nconst detachHook = new Hook('detach');\n\nexport default function Ractive$detach() {\n  if (this.isDetached) {\n    return this.el;\n  }\n\n  if (this.el) {\n    removeFromArray(this.el.__ractive_instances__, this);\n  }\n\n  this.el = this.fragment.detach();\n  this.isDetached = true;\n\n  detachHook.fire(this);\n  return this.el;\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\n\nconst detachHook = new Hook('detachchild');\n\nexport default function detachChild(child) {\n  const children = this._children;\n  let meta, index;\n\n  let i = children.length;\n  while (i--) {\n    if (children[i].instance === child) {\n      index = i;\n      meta = children[i];\n      break;\n    }\n  }\n\n  if (!meta || child.parent !== this)\n    throw new Error(`Instance ${child._guid} is not attached to this instance.`);\n\n  const promise = runloop.start();\n\n  if (meta.anchor) meta.anchor.removeChild(meta);\n  if (!child.isolated) child.viewmodel.detached();\n\n  runloop.end();\n\n  children.splice(index, 1);\n  if (meta.target) {\n    this.splice(\n      `@this.children.byName.${meta.target}`,\n      children.byName[meta.target].indexOf(meta),\n      1\n    );\n    updateAnchors(this, meta.target);\n  }\n  child.set({\n    '@this.parent': undefined,\n    '@this.root': child\n  });\n  child.component = null;\n\n  detachHook.fire(child);\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\nimport { isArray } from 'utils/is';\n\nconst arrayProto = Array.prototype;\n\nexport default function(methodName) {\n  function path(keypath, ...args) {\n    return model(this.viewmodel.joinAll(splitKeypath(keypath)), args);\n  }\n\n  function model(mdl, args) {\n    let array = mdl.get();\n\n    if (!isArray(array)) {\n      if (array === undefined) {\n        array = [];\n        const result = arrayProto[methodName].apply(array, args);\n        const promise = runloop.start().then(() => result);\n        mdl.set(array);\n        runloop.end();\n        return promise;\n      } else {\n        throw new Error(\n          `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}`\n        );\n      }\n    }\n\n    const newIndices = getNewIndices(array.length, methodName, args);\n    const result = arrayProto[methodName].apply(array, args);\n\n    const promise = runloop.start().then(() => result);\n    promise.result = result;\n\n    if (newIndices) {\n      if (mdl.shuffle) {\n        mdl.shuffle(newIndices);\n      } else {\n        // it's a computation, which don't have a shuffle, so just invalidate\n        mdl.mark();\n      }\n    } else {\n      mdl.set(result);\n    }\n\n    runloop.end();\n\n    return promise;\n  }\n\n  return { path, model };\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isString } from 'utils/is';\n\nconst updateHook = new Hook('update');\n\nexport function update(ractive, model, options) {\n  // if the parent is wrapped, the adaptor will need to be updated before\n  // updating on this keypath\n  if (model.parent && model.parent.wrapper) {\n    model.parent.adapt();\n  }\n\n  const promise = runloop.start();\n\n  model.mark(options && options.force);\n\n  // notify upstream of changes\n  model.notifyUpstream();\n\n  runloop.end();\n\n  updateHook.fire(ractive, model);\n\n  return promise;\n}\n\nexport default function Ractive$update(keypath, options) {\n  let opts, path;\n\n  if (isString(keypath)) {\n    path = splitKeypath(keypath);\n    opts = options;\n  } else {\n    opts = keypath;\n  }\n\n  return update(this, path ? this.viewmodel.joinAll(path) : this.viewmodel, opts);\n}\n","import resolveReference from 'src/view/resolvers/resolveReference';\nimport Model from 'src/model/Model';\nimport { isNumeric, isObject, isNumber, isObjectType, isString } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport findElement from 'src/view/items/shared/findElement';\nimport { set as sharedSet } from './set';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport getRactiveContext, { extern, findParentWithContext } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\nimport { ELEMENT } from 'config/types';\n\nconst modelPush = makeArrayMethod('push').model;\nconst modelPop = makeArrayMethod('pop').model;\nconst modelShift = makeArrayMethod('shift').model;\nconst modelUnshift = makeArrayMethod('unshift').model;\nconst modelSort = makeArrayMethod('sort').model;\nconst modelSplice = makeArrayMethod('splice').model;\nconst modelReverse = makeArrayMethod('reverse').model;\n\nclass ContextData extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.value = {};\n    this.ractive = options.ractive;\n    this.adaptors = [];\n    this.context = options.context;\n  }\n\n  getKeypath() {\n    return '@context.data';\n  }\n}\n\nexport default class Context {\n  constructor(fragment, element) {\n    this.fragment = fragment;\n    this.element = element || findElement(fragment);\n    this.node = this.element && this.element.node;\n    this.ractive = fragment.ractive;\n    this.root = this;\n  }\n\n  get decorators() {\n    const items = {};\n    if (!this.element) return items;\n    this.element.decorators.forEach(d => (items[d.name] = d.handle));\n    return items;\n  }\n\n  get _data() {\n    return (\n      this.model ||\n      (this.root.model = new ContextData({\n        ractive: this.ractive,\n        context: this.root\n      }))\n    );\n  }\n\n  // the usual mutation suspects\n  add(keypath, d, options) {\n    const num = isNumber(d) ? +d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value + val];\n      }),\n      opts\n    );\n  }\n\n  animate(keypath, value, options) {\n    const model = findModel(this, keypath).model;\n    return protoAnimate(this.ractive, model, value, options);\n  }\n\n  // get relative keypaths and values\n  get(keypath) {\n    if (!keypath) return this.fragment.findContext().get(true);\n\n    const { model } = findModel(this, keypath);\n\n    return model ? model.get(true) : undefined;\n  }\n\n  getParent(component) {\n    let fragment = this.fragment;\n\n    if (fragment.context)\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n    else {\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n      if (fragment)\n        fragment = findParentWithContext(\n          fragment.parent || (component && fragment.componentParent)\n        );\n    }\n\n    if (!fragment || fragment === this.fragment) return;\n    else return fragment.getContext();\n  }\n\n  hasListener(name, bubble) {\n    let el = this.element || this.fragment.owner;\n\n    do {\n      if (el.template.t === ELEMENT) {\n        if (findEvent(el, name)) return true;\n      }\n      el = el.up && el.up.owner;\n      if (el && el.component) el = el.component;\n    } while (el && bubble);\n  }\n\n  link(source, dest) {\n    const there = findModel(this, source).model;\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    here.link(there, source);\n    runloop.end();\n    return promise;\n  }\n\n  listen(event, handler) {\n    const el = this.element;\n    el.on(event, handler);\n    return {\n      cancel() {\n        el.off(event, handler);\n      }\n    };\n  }\n\n  observe(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observe(keypath, callback, options);\n  }\n\n  observeOnce(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observeOnce(keypath, callback, options);\n  }\n\n  pop(keypath) {\n    return modelPop(findModel(this, keypath).model, []);\n  }\n\n  push(keypath, ...values) {\n    return modelPush(findModel(this, keypath).model, values);\n  }\n\n  raise(name, event, ...args) {\n    let el = this.element;\n    let ev;\n\n    while (el) {\n      if (el.component) el = el.component;\n      ev = findEvent(el, name);\n      if (ev) {\n        return ev.fire(\n          ev.element.getContext(\n            event || {},\n            event && !('original' in event) ? { original: {} } : {}\n          ),\n          args\n        );\n      }\n\n      el = el.up && el.up.owner;\n    }\n  }\n\n  readLink(keypath, options) {\n    return this.ractive.readLink(this.resolve(keypath), options);\n  }\n\n  resolve(path, ractive) {\n    const { model, instance } = findModel(this, path);\n    return model ? model.getKeypath(ractive || instance) : path;\n  }\n\n  reverse(keypath) {\n    return modelReverse(findModel(this, keypath).model, []);\n  }\n\n  set(keypath, value, options) {\n    return sharedSet(build(this, keypath, value), options);\n  }\n\n  shift(keypath) {\n    return modelShift(findModel(this, keypath).model, []);\n  }\n\n  splice(keypath, index, drop, ...add) {\n    add.unshift(index, drop);\n    return modelSplice(findModel(this, keypath).model, add);\n  }\n\n  sort(keypath) {\n    return modelSort(findModel(this, keypath).model, []);\n  }\n\n  subtract(keypath, d, options) {\n    const num = isNumber(d) ? d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value - val];\n      }),\n      opts\n    );\n  }\n\n  toggle(keypath, options) {\n    const { model } = findModel(this, keypath);\n    return sharedSet([[model, !model.get()]], options);\n  }\n\n  unlink(dest) {\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    if (here.owner && here.owner._link) here.owner.unlink();\n    runloop.end();\n    return promise;\n  }\n\n  unlisten(event, handler) {\n    this.element.off(event, handler);\n  }\n\n  unshift(keypath, ...add) {\n    return modelUnshift(findModel(this, keypath).model, add);\n  }\n\n  update(keypath, options) {\n    return protoUpdate(this.ractive, findModel(this, keypath).model, options);\n  }\n\n  updateModel(keypath, cascade) {\n    const { model } = findModel(this, keypath);\n    const promise = runloop.start();\n    model.updateFromBindings(cascade);\n    runloop.end();\n    return promise;\n  }\n\n  // two-way binding related helpers\n  isBound() {\n    const { model } = this.getBindingModel(this);\n    return !!model;\n  }\n\n  getBindingPath(ractive) {\n    const { model, instance } = this.getBindingModel(this);\n    if (model) return model.getKeypath(ractive || instance);\n  }\n\n  getBinding() {\n    const { model } = this.getBindingModel(this);\n    if (model) return model.get(true);\n  }\n\n  getBindingModel(ctx) {\n    const el = ctx.element;\n    return { model: el.binding && el.binding.model, instance: el.up.ractive };\n  }\n\n  setBinding(value) {\n    const { model } = this.getBindingModel(this);\n    return sharedSet([[model, value]]);\n  }\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build(ctx, keypath, value) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push([findModel(ctx, k).model, keypath[k]]);\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push([findModel(ctx, keypath).model, value]);\n  }\n\n  return sets;\n}\n\nfunction findModel(ctx, path) {\n  const frag = ctx.fragment;\n\n  if (!isString(path)) {\n    return { model: frag.findContext(), instance: path };\n  }\n\n  return { model: resolveReference(frag, path), instance: frag.ractive };\n}\n\nfunction findEvent(el, name) {\n  return el.events && el.events.find(e => ~e.template.n.indexOf(name));\n}\n","import { doc } from 'config/environment';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { isString } from 'utils/is';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext(node) {\n  if (isString(node) && query) {\n    node = query.call(document, node);\n  }\n\n  let instances;\n  if (node) {\n    if (node._ractive) {\n      return node._ractive.proxy.getContext();\n    } else if ((instances = node.__ractive_instances__) && instances.length === 1) {\n      return getRactiveContext(instances[0]);\n    }\n  }\n}\n\nexport function getNodeInfo(node) {\n  warnOnceIfDebug(\n    `getNodeInfo has been renamed to getContext, and the getNodeInfo alias will be removed in a future release.`\n  );\n  return getContext(node);\n}\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\nimport { isString, isNumber } from 'utils/is';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif (!svg) {\n  /* istanbul ignore next */\n  createElement = (type, ns, extend) => {\n    if (ns && ns !== html) {\n      throw \"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information\";\n    }\n\n    return extend ? doc.createElement(type, extend) : doc.createElement(type);\n  };\n} else {\n  createElement = (type, ns, extend) => {\n    if (!ns || ns === html) {\n      return extend ? doc.createElement(type, extend) : doc.createElement(type);\n    }\n\n    return extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  };\n}\n\nexport function createDocumentFragment() {\n  return doc.createDocumentFragment();\n}\n\nfunction getElement(input) {\n  let output;\n\n  if (!input || typeof input === 'boolean') {\n    return;\n  }\n\n  /* istanbul ignore next */\n  if (!win || !doc || !input) {\n    return null;\n  }\n\n  // We already have a DOM node - no work to do. (Duck typing alert!)\n  if (input.nodeType) {\n    return input;\n  }\n\n  // Get node from string\n  if (isString(input)) {\n    // try ID first\n    output = doc.getElementById(input);\n\n    // then as selector, if possible\n    if (!output && doc.querySelector) {\n      try {\n        output = doc.querySelector(input);\n      } catch (e) {\n        /* this space intentionally left blank */\n      }\n    }\n\n    // did it work?\n    if (output && output.nodeType) {\n      return output;\n    }\n  }\n\n  // If we've been given a collection (jQuery, Zepto etc), extract the first item\n  if (input[0] && input[0].nodeType) {\n    return input[0];\n  }\n\n  return null;\n}\n\nif (!isClient) {\n  matches = null;\n} else {\n  div = createElement('div');\n  methodNames = ['matches', 'matchesSelector'];\n\n  makeFunction = function(methodName) {\n    return function(node, selector) {\n      return node[methodName](selector);\n    };\n  };\n\n  i = methodNames.length;\n\n  while (i-- && !matches) {\n    unprefixed = methodNames[i];\n\n    if (div[unprefixed]) {\n      matches = makeFunction(unprefixed);\n    } else {\n      j = vendors.length;\n      while (j--) {\n        prefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n        if (div[prefixed]) {\n          matches = makeFunction(prefixed);\n          break;\n        }\n      }\n    }\n  }\n\n  // IE8... and apparently phantom some?\n  /* istanbul ignore next */\n  if (!matches) {\n    matches = function(node, selector) {\n      let parentNode, i;\n\n      parentNode = node.parentNode;\n\n      if (!parentNode) {\n        // empty dummy <div>\n        div.innerHTML = '';\n\n        parentNode = div;\n        node = node.cloneNode();\n\n        div.appendChild(node);\n      }\n\n      const nodes = parentNode.querySelectorAll(selector);\n\n      i = nodes.length;\n      while (i--) {\n        if (nodes[i] === node) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  }\n}\n\nfunction detachNode(node) {\n  // stupid ie\n  // eslint-disable-next-line valid-typeof\n  if (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return node;\n}\n\nfunction safeToStringValue(value) {\n  return value == null || (isNumber(value) && isNaN(value)) || !value.toString ? '' : '' + value;\n}\n\nfunction safeAttributeString(string) {\n  return safeToStringValue(string)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","export const html = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg = 'http://www.w3.org/2000/svg';\nexport const xlink = 'http://www.w3.org/1999/xlink';\nexport const xml = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\n\nconst insertHook = new Hook('insert');\n\nexport default function Ractive$insert(target, anchor) {\n  if (!this.fragment.rendered) {\n    // TODO create, and link to, documentation explaining this\n    throw new Error(\n      'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.'\n    );\n  }\n\n  target = getElement(target);\n  anchor = getElement(anchor) || null;\n\n  if (!target) {\n    throw new Error('You must specify a valid target to insert into');\n  }\n\n  target.insertBefore(this.detach(), anchor);\n  this.el = target;\n\n  (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  this.isDetached = false;\n\n  fireInsertHook(this);\n}\n\nfunction fireInsertHook(ractive) {\n  insertHook.fire(ractive);\n\n  ractive.findAllComponents('*').forEach(child => {\n    fireInsertHook(child.instance);\n  });\n}\n","import { isEqual, isFunction } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'shared/rebind';\nimport { create } from 'utils/object';\n\nexport default class Observer {\n  constructor(ractive, model, callback, options) {\n    this.context = options.context || ractive;\n    this.callback = callback;\n    this.ractive = ractive;\n    this.keypath = options.keypath;\n    this.options = options;\n\n    if (model) this.resolved(model);\n\n    if (isFunction(options.old)) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    if (options.init !== false) {\n      this.dirty = true;\n      this.dispatch();\n    } else {\n      updateOld(this);\n    }\n\n    this.dirty = false;\n  }\n\n  cancel() {\n    this.cancelled = true;\n    if (this.model) {\n      this.model.unregister(this);\n    } else {\n      this.resolver.unbind();\n    }\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    if (!this.cancelled) {\n      this.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n      updateOld(this, true);\n      this.dirty = false;\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty) {\n      const newValue = this.model.get();\n      if (isEqual(newValue, this.oldValue)) return;\n\n      this.newValue = newValue;\n\n      if (this.options.strict && this.newValue === this.oldValue) return;\n\n      runloop.addObserver(this, this.options.defer);\n      this.dirty = true;\n\n      if (this.options.once) runloop.scheduleTask(() => this.cancel());\n    } else {\n      // make sure the newValue stays updated in case this observer gets touched multiple times in one loop\n      this.newValue = this.model.get();\n    }\n  }\n\n  rebind(next, previous) {\n    next = rebindMatch(this.keypath, next, previous);\n    if (next === this.model) return false;\n\n    if (this.model) this.model.unregister(this);\n    if (next) next.addShuffleTask(() => this.resolved(next));\n  }\n\n  resolved(model) {\n    this.model = model;\n\n    this.oldValue = undefined;\n    this.newValue = model.get();\n\n    model.register(this);\n  }\n}\n\nfunction updateOld(observer, fresh) {\n  const next = fresh\n    ? observer.model ? observer.model.get() : observer.newValue\n    : observer.newValue;\n  observer.oldValue = observer.oldFn\n    ? observer.oldFn.call(observer.oldContext, undefined, next, observer.keypath)\n    : next;\n}\n","import getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn(item, template, fragment, opts = {}) {\n  if (template && template.f && template.f.s) {\n    item.fn = getFunction(template.f.s, template.f.r.length);\n    if (opts.register === true) {\n      item.models = resolveArgs(item, template, fragment, opts);\n    }\n  }\n}\n\nexport function resolveArgs(item, template, fragment, opts = {}) {\n  return template.f.r.map((ref, i) => {\n    let model;\n\n    if (opts.specialRef && (model = opts.specialRef(ref, i))) return model;\n\n    model = resolveReference(fragment, ref);\n    if (opts.register === true) {\n      model.register(item);\n    }\n\n    return model;\n  });\n}\n\nexport function teardownArgsFn(item, template) {\n  if (template && template.f && template.f.s) {\n    if (item.models)\n      item.models.forEach(m => {\n        if (m && m.unregister) m.unregister(item);\n      });\n    item.models = null;\n  }\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent() {\n  this._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions(select) {\n  /* istanbul ignore next */\n  return select.selectedOptions\n    ? toArray(select.selectedOptions)\n    : select.options ? toArray(select.options).filter(option => option.selected) : [];\n}\n","import { INTERPOLATOR, TRIPLE } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable(attribute) {\n  // The fragment must be a single non-string fragment\n  if (\n    !attribute ||\n    !attribute.template.f ||\n    attribute.template.f.length !== 1 ||\n    attribute.template.f[0].s\n  )\n    return false;\n\n  // A binding is an interpolator `{{ }}`, yey.\n  if (attribute.template.f[0].t === INTERPOLATOR) return true;\n\n  // The above is probably the only true case. For the rest, show an appropriate\n  // warning before returning false.\n\n  // You can't bind a triple curly. HTML values on an attribute makes no sense.\n  if (attribute.template.f[0].t === TRIPLE)\n    warnIfDebug('It is not possible create a binding using a triple mustache.');\n\n  return false;\n}\n\nexport default function selectBinding(element) {\n  const name = element.name;\n  const attributes = element.attributeByName;\n  const isBindableByValue = isBindable(attributes.value);\n  const isBindableByContentEditable = isBindable(attributes.contenteditable);\n  const isContentEditable = element.getAttribute('contenteditable');\n\n  // contenteditable\n  // Bind if the contenteditable is true or a binding that may become true.\n  if ((isContentEditable || isBindableByContentEditable) && isBindableByValue)\n    return ContentEditableBinding;\n\n  // <input>\n  if (name === 'input') {\n    const type = element.getAttribute('type');\n\n    if (type === 'radio') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // For radios we can either bind the name or checked, but not both.\n      // Name binding is handed instead.\n      if (isBindableByName && isBindableByChecked) {\n        warnIfDebug(\n          'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n          { ractive: element.root }\n        );\n        return RadioNameBinding;\n      }\n\n      if (isBindableByName) return RadioNameBinding;\n\n      if (isBindableByChecked) return RadioBinding;\n\n      // Dead end. Unknown binding on radio input.\n      return null;\n    }\n\n    if (type === 'checkbox') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // A checkbox with bindings for both name and checked. Checked treated as\n      // the checkbox value, name is treated as a regular binding.\n      //\n      // See https://github.com/ractivejs/ractive/issues/1749\n      if (isBindableByName && isBindableByChecked) return CheckboxBinding;\n\n      if (isBindableByName) return CheckboxNameBinding;\n\n      if (isBindableByChecked) return CheckboxBinding;\n\n      // Dead end. Unknown binding on checkbox input.\n      return null;\n    }\n\n    if (type === 'file' && isBindableByValue) return FileBinding;\n\n    if (type === 'number' && isBindableByValue) return NumericBinding;\n\n    if (type === 'range' && isBindableByValue) return NumericBinding;\n\n    // Some input of unknown type (browser usually falls back to text).\n    if (isBindableByValue) return GenericBinding;\n\n    // Dead end. Some unknown input and an unbindable.\n    return null;\n  }\n\n  // <select>\n  if (name === 'select' && isBindableByValue) {\n    return element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  }\n\n  // <textarea>\n  if (name === 'textarea' && isBindableByValue) return GenericBinding;\n\n  // Dead end. Some unbindable element.\n  return null;\n}\n","import { doc } from 'config/environment';\n\nexport default function progressiveText(item, target, occupants, text) {\n  if (occupants) {\n    let n = occupants[0];\n    if (n && n.nodeType === 3) {\n      const idx = n.nodeValue.indexOf(text);\n      occupants.shift();\n\n      if (idx === 0) {\n        if (n.nodeValue.length !== text.length) {\n          occupants.unshift(n.splitText(text.length));\n        }\n      } else {\n        n.nodeValue = text;\n      }\n    } else {\n      n = item.node = doc.createTextNode(text);\n      if (occupants[0]) {\n        target.insertBefore(n, occupants[0]);\n      } else {\n        target.appendChild(n);\n      }\n    }\n\n    item.node = n;\n  } else {\n    if (!item.node) item.node = doc.createTextNode(text);\n    target.appendChild(item.node);\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { fillGaps, hasOwn } from 'utils/object';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { findInstance } from 'shared/registry';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default function getPartialTemplate(ractive, name, up) {\n  // If the partial in instance or view heirarchy instances, great\n  let partial = getPartialFromRegistry(ractive, name, up || {});\n  if (partial) return partial;\n\n  // Does it exist on the page as a script tag?\n  partial = parser.fromId(name, { noThrow: true });\n  if (partial) {\n    // parse and register to this ractive instance\n    const parsed = parser.parseFor(partial, ractive);\n\n    // register extra partials on the ractive instance if they don't already exist\n    if (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n    // register (and return main partial if there are others in the template)\n    return (ractive.partials[name] = parsed.t);\n  }\n}\n\nfunction getPartialFromRegistry(ractive, name, up) {\n  // if there was an instance up-hierarchy, cool\n  let partial = findParentPartial(name, up.owner);\n  if (partial) return partial;\n\n  // find first instance in the ractive or view hierarchy that has this partial\n  const instance = findInstance('partials', ractive, name);\n\n  if (!instance) {\n    return;\n  }\n\n  partial = instance.partials[name];\n\n  // partial is a function?\n  let fn;\n  if (isFunction(partial)) {\n    fn = partial;\n    // super partial\n    if (fn.styleSet) return fn;\n\n    fn = partial.bind(instance);\n    fn.isOwner = hasOwn(instance.partials, name);\n    partial = fn.call(ractive, parser);\n  }\n\n  if (!partial && partial !== '') {\n    warnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', {\n      ractive\n    });\n    return;\n  }\n\n  // If this was added manually to the registry,\n  // but hasn't been parsed, parse it now\n  if (!parser.isParsed(partial)) {\n    // use the parseOptions of the ractive instance on which it was found\n    const parsed = parser.parseFor(partial, instance);\n\n    // Partials cannot contain nested partials!\n    // TODO add a test for this\n    if (parsed.p) {\n      warnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n    }\n\n    // if fn, use instance to store result, otherwise needs to go\n    // in the correct point in prototype chain on instance or constructor\n    const target = fn ? instance : findOwner(instance, name);\n\n    // may be a template with partials, which need to be registered and main template extracted\n    target.partials[name] = partial = parsed.t;\n  }\n\n  // store for reset\n  if (fn) partial._fn = fn;\n\n  return partial.v ? partial.t : partial;\n}\n\nfunction findOwner(ractive, key) {\n  return hasOwn(ractive.partials, key) ? ractive : findConstructor(ractive.constructor, key);\n}\n\nfunction findConstructor(constructor, key) {\n  if (!constructor) {\n    return;\n  }\n  return hasOwn(constructor.partials, key) ? constructor : findConstructor(constructor.Parent, key);\n}\n\nfunction findParentPartial(name, parent) {\n  if (parent) {\n    if (\n      parent.template &&\n      parent.template.p &&\n      !isArray(parent.template.p) &&\n      hasOwn(parent.template.p, name)\n    ) {\n      return parent.template.p[name];\n    } else if (parent.up && parent.up.owner) {\n      return findParentPartial(name, parent.up.owner);\n    }\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\nimport { hasOwn } from 'utils/object';\nimport { isString } from 'utils/is';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor(ractive, name) {\n  const instance = findInstance('components', ractive, name);\n  let Component;\n\n  if (instance) {\n    Component = instance.components[name];\n\n    // if not from Ractive.extend or a Promise, it's a function that shold return a constructor\n    if (Component && !Component.isInstance && !Component.then) {\n      // function option, execute and store for reset\n      const fn = Component.bind(instance);\n      fn.isOwner = hasOwn(instance.components, name);\n      Component = fn();\n\n      if (!Component) {\n        warnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', {\n          ractive\n        });\n        return;\n      }\n\n      if (isString(Component)) {\n        // allow string lookup\n        Component = getComponentConstructor(ractive, Component);\n      }\n\n      Component._fn = fn;\n      instance.components[name] = Component;\n    }\n  }\n\n  return Component;\n}\n","import Partial from './Partial';\nimport { ELEMENT } from 'config/types';\nimport { assign } from 'utils/object';\n\nexport default function asyncProxy(promise, options) {\n  const partials = options.template.p || {};\n  const name = options.template.e;\n\n  const opts = assign({}, options, {\n    template: { t: ELEMENT, e: name },\n    macro(handle) {\n      handle.setTemplate(partials['async-loading'] || []);\n      promise.then(\n        cmp => {\n          options.up.ractive.components[name] = cmp;\n          if (partials['async-loaded']) {\n            handle.partials.component = [options.template];\n            handle.setTemplate(partials['async-loaded']);\n          } else {\n            handle.setTemplate([options.template]);\n          }\n        },\n        err => {\n          if (partials['async-failed']) {\n            handle.aliasLocal('error', 'error');\n            handle.set('@local.error', err);\n            handle.setTemplate(partials['async-failed']);\n          } else {\n            handle.setTemplate([]);\n          }\n        }\n      );\n    }\n  });\n  return new Partial(opts);\n}\n","import { ATTRIBUTE, CATCH, ELEMENT, ELSE, INTERPOLATOR, SECTION, THEN } from 'src/config/types';\nimport Partial from './Partial';\nimport { assign } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nfunction extract(tpl, type, name) {\n  const p = tpl.f.find(s => s.t === type);\n  if (p) {\n    if (p.n)\n      return [\n        {\n          t: 19,\n          n: 54,\n          f: p.f || [],\n          z: [{ n: p.n, x: { r: `__await.${name}` } }]\n        }\n      ];\n    else return p.f || [];\n  } else return [];\n}\n\nexport default function Await(options) {\n  const tpl = options.template;\n\n  const success = extract(tpl, THEN, 'value');\n  const error = extract(tpl, CATCH, 'error');\n  const pending = extract(tpl, SECTION);\n  const undef = extract(tpl, ELSE);\n\n  const opts = assign({}, options, {\n    template: {\n      t: ELEMENT,\n      m: [\n        {\n          t: ATTRIBUTE,\n          n: 'for',\n          f: [{ t: INTERPOLATOR, r: tpl.r, rx: tpl.rx, x: tpl.x }]\n        }\n      ]\n    },\n    macro(handle, attrs) {\n      handle.aliasLocal('__await');\n\n      function update(attrs) {\n        if (attrs.for && isFunction(attrs.for.then)) {\n          handle.setTemplate(pending);\n\n          attrs.for.then(\n            v => {\n              handle.set('@local.value', v);\n              handle.setTemplate(success);\n            },\n            e => {\n              handle.set('@local.error', e);\n              handle.setTemplate(error);\n            }\n          );\n        } else if (attrs.for === undefined) {\n          handle.setTemplate(undef);\n        } else {\n          handle.set('@local.value', attrs.for);\n          handle.setTemplate(success);\n        }\n      }\n\n      update(attrs);\n\n      return {\n        update\n      };\n    }\n  });\n\n  opts.macro.attributes = ['for'];\n\n  return new Partial(opts);\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems(items, values, guid, counter = 0) {\n  return items\n    .map(item => {\n      if (item.type === TEXT) {\n        return item.template;\n      }\n\n      if (item.fragment) {\n        if (item.fragment.iterations) {\n          return item.fragment.iterations\n            .map(fragment => {\n              return processItems(fragment.items, values, guid, counter);\n            })\n            .join('');\n        } else {\n          return processItems(item.fragment.items, values, guid, counter);\n        }\n      }\n\n      const placeholderId = `${guid}-${counter++}`;\n      const model = item.model || item.newModel;\n\n      values[placeholderId] = model\n        ? model.wrapper ? model.wrapperValue : model.get()\n        : undefined;\n\n      return '${' + placeholderId + '}';\n    })\n    .join('');\n}\n","import { getElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport { warnIfDebug } from 'utils/log';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render(target, anchor) {\n  if (this.torndown) {\n    warnIfDebug('ractive.render() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  target = getElement(target) || this.el;\n\n  if (!this.append && target) {\n    // Teardown any existing instances *before* trying to set up the new one -\n    // avoids certain weird bugs\n    const others = target.__ractive_instances__;\n    if (others) others.forEach(teardown);\n\n    // make sure we are the only occupants\n    if (!this.enhance) {\n      target.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n    }\n  }\n\n  const occupants = this.enhance ? toArray(target.childNodes) : null;\n  const promise = render(this, target, anchor, occupants);\n\n  if (occupants) {\n    while (occupants.length) target.removeChild(occupants.pop());\n  }\n\n  return promise;\n}\n","import runloop from 'src/global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\nimport { isArray } from 'utils/is';\nimport { handleChange } from 'shared/methodCallers';\n\nfunction collect(source, name, attr, dest) {\n  source.forEach(item => {\n    // queue to rerender if the item is a partial and the current name matches\n    if (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n      item.inAttribute = attr;\n      dest.push(item);\n      return; // go no further\n    }\n\n    // if it has a fragment, process its items\n    if (item.fragment) {\n      collect(item.fragment.iterations || item.fragment.items, name, attr, dest);\n    } else if (isArray(item.items)) {\n      // or if it is itself a fragment, process its items\n      collect(item.items, name, attr, dest);\n    } else if (item.type === COMPONENT && item.instance) {\n      // or if it is a component, step in and process its items\n      // ...unless the partial is shadowed\n      if (item.instance.partials[name]) return;\n      collect(item.instance.fragment.items, name, attr, dest);\n    }\n\n    // if the item is an element, process its attributes too\n    if (item.type === ELEMENT) {\n      if (isArray(item.attributes)) {\n        collect(item.attributes, name, true, dest);\n      }\n    }\n  });\n}\n\nexport default function(name, partial) {\n  const collection = [];\n  collect(this.fragment.items, name, false, collection);\n\n  const promise = runloop.start();\n\n  this.partials[name] = partial;\n  collection.forEach(handleChange);\n\n  runloop.end();\n\n  return promise;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport Fragment from 'src/view/Fragment';\nimport runloop from 'src/global/runloop';\nimport { default as templateConfigurator } from '../config/custom/template';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate(template) {\n  templateConfigurator.init(null, this, { template });\n\n  const transitionsEnabled = this.transitionsEnabled;\n  this.transitionsEnabled = false;\n\n  // Is this is a component, we need to set the `shouldDestroy`\n  // flag, otherwise it will assume by default that a parent node\n  // will be detached, and therefore it doesn't need to bother\n  // detaching its own nodes\n  const component = this.component;\n  if (component) component.shouldDestroy = true;\n  this.unrender();\n  if (component) component.shouldDestroy = false;\n\n  const promise = runloop.start();\n\n  // remove existing fragment and create new one\n  this.fragment.unbind().unrender(true);\n\n  this.fragment = new Fragment({\n    template: this.template,\n    root: this,\n    owner: this\n  });\n\n  const docFrag = createDocumentFragment();\n  this.fragment.bind(this.viewmodel).render(docFrag);\n\n  // if this is a component, its el may not be valid, so find a\n  // target based on the component container\n  if (component && !component.external) {\n    this.fragment.findParentNode().insertBefore(docFrag, component.findNextNode());\n  } else {\n    this.el.insertBefore(docFrag, this.anchor);\n  }\n\n  runloop.end();\n\n  this.transitionsEnabled = transitionsEnabled;\n\n  return promise;\n}\n","import { build, set } from 'shared/set';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$set(keypath, value, options) {\n  const ractive = this;\n\n  const opts = isObjectType(keypath) ? value : options;\n\n  return set(build(ractive, keypath, value, opts && opts.isolated), opts);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$subtract(keypath, d, options) {\n  const num = isNumber(d) ? -d : -1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","import { badArguments } from 'config/errors';\nimport { gather, set } from 'shared/set';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$toggle(keypath, options) {\n  if (!isString(keypath)) {\n    throw new TypeError(badArguments);\n  }\n\n  return set(\n    gather(this, keypath, null, options && options.isolated).map(m => [m, !m.get()]),\n    options\n  );\n}\n","import { getCSS } from 'src/global/css';\nimport { keys } from 'utils/object';\n\nexport default function Ractive$toCSS() {\n  const cssIds = [this.cssId, ...this.findAllComponents().map(c => c.cssId)];\n  const uniqueCssIds = keys(cssIds.reduce((ids, id) => ((ids[id] = true), ids), {}));\n  return getCSS(uniqueCssIds);\n}\n","export default function Ractive$toHTML() {\n  return this.fragment.toString(true);\n}\n","export default function toText() {\n  return this.fragment.toString(false);\n}\n","import runloop from 'src/global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from 'utils/log';\nimport { isObject } from 'utils/is';\n\nexport default function Ractive$transition(name, node, params) {\n  if (node instanceof HTMLElement) {\n    // good to go\n  } else if (isObject(node)) {\n    // omitted, use event node\n    params = node;\n  }\n\n  // if we allow query selector, then it won't work\n  // simple params like \"fast\"\n\n  // else if ( typeof node === 'string' ) {\n  // \t// query selector\n  // \tnode = this.find( node )\n  // }\n\n  node = node || this.event.node;\n\n  if (!node || !node._ractive) {\n    fatal(`No node was supplied for transition ${name}`);\n  }\n\n  params = params || {};\n  const owner = node._ractive.proxy;\n  const transition = new Transition({ owner, up: owner.up, name, params });\n  transition.bind();\n\n  const promise = runloop.start();\n  runloop.registerTransition(transition);\n  runloop.end();\n\n  promise.then(() => transition.unbind());\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function unlink(here) {\n  const promise = runloop.start();\n  this.viewmodel.joinAll(splitKeypath(here), { lastLink: false }).unlink();\n  runloop.end();\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$updateModel(keypath, cascade) {\n  const promise = runloop.start();\n\n  if (!keypath) {\n    this.viewmodel.updateFromBindings(true);\n  } else {\n    this.viewmodel.joinAll(splitKeypath(keypath)).updateFromBindings(cascade !== false);\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function use(...plugins) {\n  plugins.forEach(p => {\n    p({\n      proto: this,\n      Ractive: this.constructor.Ractive,\n      instance: this\n    });\n  });\n  return this;\n}\n","export default function isInstance(object) {\n  return object && object instanceof this;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function styleGet(keypath) {\n  return this._cssModel.joinAll(splitKeypath(keypath)).get();\n}\n","import { build, set } from '../../shared/set';\nimport SharedModel from '../../model/specials/SharedModel';\nimport { isObjectType } from 'utils/is';\n\nexport default function sharedSet(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = SharedModel;\n\n  return set(build({ viewmodel: model }, keypath, value, true), opts);\n}\n","import SharedModel from '../../model/specials/SharedModel';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function sharedGet(keypath) {\n  return SharedModel.joinAll(splitKeypath(keypath)).get();\n}\n","import { isFunction } from 'utils/is';\n\nexport default function use(...plugins) {\n  plugins.forEach(p => {\n    isFunction(p) &&\n      p({\n        proto: this.prototype,\n        Ractive: this.Ractive,\n        instance: this\n      });\n  });\n  return this;\n}\n","import styleGet from '../Ractive/static/styleGet';\nimport styleSet from '../Ractive/static/styleSet';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperties, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nimport { initCSS } from 'src/Ractive/config/custom/css/css';\n\nexport default function macro(fn, opts) {\n  if (!isFunction(fn)) throw new Error(`The macro must be a function`);\n\n  assign(fn, opts);\n\n  defineProperties(fn, {\n    extensions: { value: [] },\n    _cssIds: { value: [] },\n    cssData: { value: assign(create(this.cssData), fn.cssData || {}) },\n\n    styleGet: { value: styleGet.bind(fn) },\n    styleSet: { value: styleSet.bind(fn) }\n  });\n\n  defineProperty(fn, '_cssModel', { value: new CSSModel(fn) });\n\n  if (fn.css) initCSS(fn, fn, fn);\n\n  this.extensions.push(fn);\n\n  return fn;\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from 'shared/keypaths';\n\nexport function joinKeys(...keys) {\n  return keys.map(escapeKey).join('.');\n}\n\nexport function splitKeypath(keypath) {\n  return splitKeypathI(keypath).map(unescapeKey);\n}\n","import { findInViewHierarchy } from 'shared/registry';\n\nexport function findPlugin(name, type, instance) {\n  return findInViewHierarchy(type, instance, name);\n}\n","/* istanbul ignore if */\nif (!Object.assign) {\n  Object.assign = function(target, ...sources) {\n    if (target == null) throw new TypeError('Cannot convert undefined or null to object');\n\n    const to = Object(target);\n    const sourcesLength = sources.length;\n\n    for (let index = 0; index < sourcesLength; index++) {\n      const nextSource = sources[index];\n      for (const nextKey in nextSource) {\n        if (!Object.prototype.hasOwnProperty.call(nextSource, nextKey)) continue;\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n\n    return to;\n  };\n}\n","export function hasOwn(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function fillGaps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    for (const key in source) {\n      // Source can be a prototype-less object.\n      if (key in target || !hasOwn(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nexport function toPairs(obj = {}) {\n  const pairs = [];\n  for (const key in obj) {\n    // Source can be a prototype-less object.\n    if (!hasOwn(obj, key)) continue;\n    pairs.push([key, obj[key]]);\n  }\n  return pairs;\n}\n\nconst obj = Object;\n\nexport const assign = obj.assign;\n\nexport const create = obj.create;\n\nexport const defineProperty = obj.defineProperty;\n\nexport const defineProperties = obj.defineProperties;\n\nexport const keys = obj.keys;\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike(obj) {\n  return arrayLikePattern.test(toString.call(obj));\n}\n\nexport const isArray = Array.isArray;\n\nexport function isEqual(a, b) {\n  if (a === null && b === null) {\n    return true;\n  }\n\n  if (isObjectType(a) || isObjectType(b)) {\n    return false;\n  }\n\n  return a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric(thing) {\n  return !isNaN(parseFloat(thing)) && isFinite(thing);\n}\n\nexport function isObject(thing) {\n  return thing && toString.call(thing) === '[object Object]';\n}\n\nexport function isObjectLike(thing) {\n  return !!(thing && (isObjectType(thing) || isFunction(thing)));\n}\n\nexport function isObjectType(thing) {\n  return typeof thing === 'object';\n}\n\nexport function isFunction(thing) {\n  return typeof thing === 'function';\n}\n\nexport function isString(thing) {\n  return typeof thing === 'string';\n}\n\nexport function isNumber(thing) {\n  return typeof thing === 'number';\n}\n","/* istanbul ignore if */\nif (typeof window !== 'undefined' && window.performance && !window.performance.now) {\n  window.performance = window.performance || {};\n\n  const nowOffset = Date.now();\n\n  window.performance.now = function() {\n    return Date.now() - nowOffset;\n  };\n}\n","import { hasOwn, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n/* istanbul ignore if */\nif (!Array.prototype.find) {\n  defineProperty(Array.prototype, 'find', {\n    value(callback, thisArg) {\n      if (this === null || this === undefined)\n        throw new TypeError('Array.prototype.find called on null or undefined');\n\n      if (!isFunction(callback)) throw new TypeError(`${callback} is not a function`);\n\n      const array = Object(this);\n      const arrayLength = array.length >>> 0;\n\n      for (let index = 0; index < arrayLength; index++) {\n        if (!hasOwn(array, index)) continue;\n        if (!callback.call(thisArg, array[index], index, array)) continue;\n        return array[index];\n      }\n\n      return undefined;\n    },\n    configurable: true,\n    writable: true\n  });\n}\n","// NOTE: Node doesn't exist in IE8. Nothing can be done.\n/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  window.Node &&\n  window.Node.prototype &&\n  !window.Node.prototype.contains\n) {\n  Node.prototype.contains = function(node) {\n    if (!node) throw new TypeError('node required');\n\n    do {\n      if (this === node) return true;\n    } while ((node = node && node.parentNode));\n\n    return false;\n  };\n}\n","import { isFunction, isObjectType } from 'utils/is';\n\n/* istanbul ignore if */\nif (typeof window !== 'undefined' && !window.Promise) {\n  const PENDING = {};\n  const FULFILLED = {};\n  const REJECTED = {};\n\n  const Promise = (window.Promise = function(callback) {\n    const fulfilledHandlers = [];\n    const rejectedHandlers = [];\n    let state = PENDING;\n    let result;\n    let dispatchHandlers;\n\n    const makeResolver = newState => {\n      return function(value) {\n        if (state !== PENDING) return;\n        result = value;\n        state = newState;\n        dispatchHandlers = makeDispatcher(\n          state === FULFILLED ? fulfilledHandlers : rejectedHandlers,\n          result\n        );\n        wait(dispatchHandlers);\n      };\n    };\n\n    const fulfill = makeResolver(FULFILLED);\n    const reject = makeResolver(REJECTED);\n\n    try {\n      callback(fulfill, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    return {\n      // `then()` returns a Promise - 2.2.7\n      then(onFulfilled, onRejected) {\n        const promise2 = new Promise((fulfill, reject) => {\n          const processResolutionHandler = (handler, handlers, forward) => {\n            if (isFunction(handler)) {\n              handlers.push(p1result => {\n                try {\n                  resolve(promise2, handler(p1result), fulfill, reject);\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            } else {\n              handlers.push(forward);\n            }\n          };\n\n          processResolutionHandler(onFulfilled, fulfilledHandlers, fulfill);\n          processResolutionHandler(onRejected, rejectedHandlers, reject);\n\n          if (state !== PENDING) {\n            wait(dispatchHandlers);\n          }\n        });\n        return promise2;\n      },\n      catch(onRejected) {\n        return this.then(null, onRejected);\n      }\n    };\n  });\n\n  Promise.all = function(promises) {\n    return new Promise((fulfil, reject) => {\n      const result = [];\n      let pending;\n      let i;\n\n      if (!promises.length) {\n        fulfil(result);\n        return;\n      }\n\n      const processPromise = (promise, i) => {\n        if (promise && isFunction(promise.then)) {\n          promise.then(value => {\n            result[i] = value;\n            --pending || fulfil(result);\n          }, reject);\n        } else {\n          result[i] = promise;\n          --pending || fulfil(result);\n        }\n      };\n\n      pending = i = promises.length;\n\n      while (i--) {\n        processPromise(promises[i], i);\n      }\n    });\n  };\n\n  Promise.resolve = function(value) {\n    return new Promise(fulfill => {\n      fulfill(value);\n    });\n  };\n\n  Promise.reject = function(reason) {\n    return new Promise((fulfill, reject) => {\n      reject(reason);\n    });\n  };\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  const wait = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  const makeDispatcher = function(handlers, result) {\n    return function() {\n      for (let handler; (handler = handlers.shift()); ) {\n        handler(result);\n      }\n    };\n  };\n\n  const resolve = function(promise, x, fulfil, reject) {\n    let then;\n    if (x === promise) {\n      throw new TypeError(`A promise's fulfillment handler cannot return the same promise`);\n    }\n    if (x instanceof Promise) {\n      x.then(fulfil, reject);\n    } else if (x && (isObjectType(x) || isFunction(x))) {\n      try {\n        then = x.then;\n      } catch (e) {\n        reject(e);\n        return;\n      }\n      if (isFunction(then)) {\n        let called;\n\n        const resolvePromise = function(y) {\n          if (called) return;\n          called = true;\n          resolve(promise, y, fulfil, reject);\n        };\n        const rejectPromise = function(r) {\n          if (called) return;\n          called = true;\n          reject(r);\n        };\n\n        try {\n          then.call(x, resolvePromise, rejectPromise);\n        } catch (e) {\n          if (!called) {\n            reject(e);\n            called = true;\n            return;\n          }\n        }\n      } else {\n        fulfil(x);\n      }\n    } else {\n      fulfil(x);\n    }\n  };\n}\n","/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  !(window.requestAnimationFrame && window.cancelAnimationFrame)\n) {\n  let lastTime = 0;\n  window.requestAnimationFrame = function(callback) {\n    const currentTime = Date.now();\n    const timeToNextCall = Math.max(0, 16 - (currentTime - lastTime));\n    const id = window.setTimeout(() => {\n      callback(currentTime + timeToNextCall);\n    }, timeToNextCall);\n    lastTime = currentTime + timeToNextCall;\n    return id;\n  };\n  window.cancelAnimationFrame = function(id) {\n    clearTimeout(id);\n  };\n}\n","import { create } from 'utils/object';\n\nexport default {\n  // render placement:\n  el: void 0,\n  append: false,\n  delegate: true,\n\n  // template:\n  template: null,\n\n  // parse:\n  allowExpressions: true,\n  delimiters: ['{{', '}}'],\n  tripleDelimiters: ['{{{', '}}}'],\n  staticDelimiters: ['[[', ']]'],\n  staticTripleDelimiters: ['[[[', ']]]'],\n  csp: true,\n  interpolate: false,\n  preserveWhitespace: false,\n  sanitize: false,\n  stripComments: true,\n  contextLines: 0,\n\n  // data & binding:\n  data: create(null),\n  helpers: create(null),\n  computed: create(null),\n  syncComputedChildren: false,\n  resolveInstanceMembers: true,\n  warnAboutAmbiguity: false,\n  adapt: [],\n  isolated: true,\n  twoway: true,\n  lazy: false,\n\n  // transitions:\n  noIntro: false,\n  noOutro: false,\n  transitionsEnabled: true,\n  complete: void 0,\n  nestedTransitions: true,\n\n  // css:\n  css: null,\n  noCssTransform: false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\nimport { isObjectType } from 'utils/is';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif (hasConsole) {\n  const welcomeIntro = [\n    `%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n    'color: rgb(114, 157, 52); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n  ];\n  const welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n  welcome = () => {\n    if (Ractive.WELCOME_MESSAGE === false) {\n      welcome = noop;\n      return;\n    }\n    const message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n    const hasGroup = !!console.groupCollapsed;\n    if (hasGroup) console.groupCollapsed.apply(console, welcomeIntro);\n    console.log(message);\n    if (hasGroup) {\n      console.groupEnd(welcomeIntro);\n    }\n\n    welcome = noop;\n  };\n\n  printWarning = (message, args) => {\n    welcome();\n\n    // extract information about the instance this message pertains to, if applicable\n    if (isObjectType(args[args.length - 1])) {\n      const options = args.pop();\n      const ractive = options ? options.ractive : null;\n\n      if (ractive) {\n        // if this is an instance of a component that we know the name of, add\n        // it to the message\n        let name;\n        if (ractive.component && (name = ractive.component.name)) {\n          message = `<${name}> ${message}`;\n        }\n\n        let node;\n        if (\n          (node =\n            options.node || (ractive.fragment && ractive.fragment.rendered && ractive.find('*')))\n        ) {\n          args.push(node);\n        }\n      }\n    }\n\n    console.warn.apply(\n      console,\n      ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(\n        args\n      )\n    );\n  };\n\n  log = function() {\n    console.log.apply(console, arguments);\n  };\n} else {\n  printWarning = log = welcome = noop;\n}\n\nfunction format(message, args) {\n  return message.replace(/%s/g, () => args.shift());\n}\n\nfunction fatal(message, ...args) {\n  message = format(message, args);\n  throw new Error(message);\n}\n\nfunction logIfDebug() {\n  if (Ractive.DEBUG) {\n    log.apply(null, arguments);\n  }\n}\n\nfunction warn(message, ...args) {\n  message = format(message, args);\n  printWarning(message, args);\n}\n\nfunction warnOnce(message, ...args) {\n  message = format(message, args);\n\n  if (alreadyWarned[message]) {\n    return;\n  }\n\n  alreadyWarned[message] = true;\n  printWarning(message, args);\n}\n\nfunction warnIfDebug() {\n  if (Ractive.DEBUG) {\n    warn.apply(null, arguments);\n  }\n}\n\nfunction warnOnceIfDebug() {\n  if (Ractive.DEBUG) {\n    warnOnce.apply(null, arguments);\n  }\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\nexport default {\n  linear(pos) {\n    return pos;\n  },\n  easeIn(pos) {\n    /* istanbul ignore next */\n    return Math.pow(pos, 3);\n  },\n  easeOut(pos) {\n    return Math.pow(pos - 1, 3) + 1;\n  },\n  easeInOut(pos) {\n    /* istanbul ignore next */\n    if ((pos /= 0.5) < 1) {\n      return 0.5 * Math.pow(pos, 3);\n    }\n    /* istanbul ignore next */\n    return 0.5 * (Math.pow(pos - 2, 3) + 2);\n  }\n};\n","/* eslint no-console:\"off\" */\nimport { isFunction } from 'utils/is';\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst hasConsole =\n  typeof console !== 'undefined' && isFunction(console.warn) && isFunction(console.warn.apply);\n\nconst svg = doc\n  ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n  : false;\n\nconst vendors = ['o', 'ms', 'moz', 'webkit'];\n\nexport { win, doc, isClient, hasConsole, svg, vendors };\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn =\n  'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = (name, type) =>\n  `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://ractive.js.org/integrations/#${type}s`;\n","import { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\nimport { hasOwn } from 'utils/object';\n\nconst interpolators = {\n  number(from, to) {\n    if (!isNumeric(from) || !isNumeric(to)) {\n      return null;\n    }\n\n    from = +from;\n    to = +to;\n\n    const delta = to - from;\n\n    if (!delta) {\n      return function() {\n        return from;\n      };\n    }\n\n    return function(t) {\n      return from + t * delta;\n    };\n  },\n\n  array(from, to) {\n    let len, i;\n\n    if (!isArray(from) || !isArray(to)) {\n      return null;\n    }\n\n    const intermediate = [];\n    const interpolators = [];\n\n    i = len = Math.min(from.length, to.length);\n    while (i--) {\n      interpolators[i] = interpolate(from[i], to[i]);\n    }\n\n    // surplus values - don't interpolate, but don't exclude them either\n    for (i = len; i < from.length; i += 1) {\n      intermediate[i] = from[i];\n    }\n\n    for (i = len; i < to.length; i += 1) {\n      intermediate[i] = to[i];\n    }\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        intermediate[i] = interpolators[i](t);\n      }\n\n      return intermediate;\n    };\n  },\n\n  object(from, to) {\n    if (!isObject(from) || !isObject(to)) {\n      return null;\n    }\n\n    const properties = [];\n    const intermediate = {};\n    const interpolators = {};\n\n    for (const prop in from) {\n      if (hasOwn(from, prop)) {\n        if (hasOwn(to, prop)) {\n          properties.push(prop);\n          interpolators[prop] = interpolate(from[prop], to[prop]) || (() => to[prop]);\n        } else {\n          intermediate[prop] = from[prop];\n        }\n      }\n    }\n\n    for (const prop in to) {\n      if (hasOwn(to, prop) && !hasOwn(from, prop)) {\n        intermediate[prop] = to[prop];\n      }\n    }\n\n    const len = properties.length;\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        const prop = properties[i];\n\n        intermediate[prop] = interpolators[prop](t);\n      }\n\n      return intermediate;\n    };\n  }\n};\n\nexport default interpolators;\n","import { isString } from 'utils/is';\n\nconst refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey(key) {\n  if (isString(key)) {\n    return key.replace(escapeKeyPattern, '\\\\$&');\n  }\n\n  return key;\n}\n\nexport function normalise(ref) {\n  return ref ? ref.replace(refPattern, '.$1') : '';\n}\n\nexport function splitKeypath(keypath) {\n  const result = [];\n  let match;\n\n  keypath = normalise(keypath);\n\n  while ((match = splitPattern.exec(keypath))) {\n    const index = match.index + match[1].length;\n    result.push(keypath.substr(0, index));\n    keypath = keypath.substr(index + 1);\n  }\n\n  result.push(keypath);\n\n  return result;\n}\n\nexport function unescapeKey(key) {\n  if (isString(key)) {\n    return key.replace(unescapeKeyPattern, '$1$2');\n  }\n\n  return key;\n}\n","const fnBind = Function.prototype.bind;\n\nexport default function bind(fn, context) {\n  if (!/this/.test(fn.toString())) return fn;\n\n  const bound = fnBind.call(fn, context);\n  for (const prop in fn) bound[prop] = fn[prop];\n\n  return bound;\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$add(keypath, d, options) {\n  const num = isNumber(d) ? d : 1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export function enqueue(ractive, event) {\n  if (ractive.event) {\n    ractive._eventQueue.push(ractive.event);\n  }\n\n  ractive.event = event;\n}\n\nexport function dequeue(ractive) {\n  if (ractive._eventQueue.length) {\n    ractive.event = ractive._eventQueue.pop();\n  } else {\n    ractive.event = null;\n  }\n}\n","export function findAnchors(fragment, name = null) {\n  const res = [];\n\n  findAnchorsIn(fragment, name, res);\n\n  return res;\n}\n\nfunction findAnchorsIn(item, name, result) {\n  if (item.isAnchor) {\n    if (!name || item.name === name) {\n      result.push(item);\n    }\n  } else if (item.items) {\n    item.items.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.iterations) {\n    item.iterations.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.fragment && !item.component) {\n    findAnchorsIn(item.fragment, name, result);\n  }\n}\n\nexport function updateAnchors(instance, name = null) {\n  const anchors = findAnchors(instance.fragment, name);\n  const idxs = {};\n  const children = instance._children.byName;\n\n  anchors.forEach(a => {\n    const name = a.name;\n    if (!(name in idxs)) idxs[name] = 0;\n    const idx = idxs[name];\n    const child = (children[name] || [])[idx];\n\n    if (child && child.lastBound !== a) {\n      if (child.lastBound) child.lastBound.removeChild(child);\n      a.addChild(child);\n    }\n\n    idxs[name]++;\n  });\n}\n\nexport function unrenderChild(meta) {\n  if (meta.instance.fragment.rendered) {\n    meta.shouldDestroy = true;\n    meta.instance.unrender();\n  }\n  meta.instance.el = null;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport { isString, isFunction } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { fireShuffleTasks } from 'src/model/ModelBase';\n\nexport function compute(path, computed) {\n  this.computed[path] = computed;\n  if (isString(computed) || isFunction(computed))\n    computed = this.computed[path] = { get: computed };\n\n  const keys = splitKeypath(path);\n  if (!~path.indexOf('*')) {\n    const last = keys.pop();\n    return this.viewmodel.joinAll(keys).compute(last, computed);\n  } else {\n    computed.pattern = new RegExp(\n      '^' +\n        keys\n          .map(k => k.replace(/\\*\\*/g, '(.+)').replace(/\\*/g, '((?:\\\\\\\\.|[^\\\\.])+)'))\n          .join('\\\\.') +\n        '$'\n    );\n  }\n}\n\nexport default function Ractive$compute(path, computed) {\n  const promise = runloop.start();\n  const comp = compute.call(this, path, computed);\n\n  if (comp) {\n    const keys = splitKeypath(path);\n    if (keys.length === 1 && !comp.isReadonly) {\n      comp.set(this.viewmodel.value[keys[0]]);\n    }\n\n    const first = keys.reduce((a, c) => a && a.childByKey[c], this.viewmodel);\n    if (first) {\n      first.rebind(comp, first, false);\n      if (first.parent) delete first.parent.childByKey[first.key];\n      fireShuffleTasks();\n    }\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function Ractive$find(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM`\n    );\n\n  let node = this.fragment.find(selector, options);\n  if (node) return node;\n\n  if (options.remote) {\n    for (let i = 0; i < this._children.length; i++) {\n      if (!this._children[i].instance.fragment.rendered) continue;\n      node = this._children[i].instance.find(selector, options);\n      if (node) return node;\n    }\n  }\n}\n","import { isArray } from 'utils/is';\n\nexport default function Ractive$findAll(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM`\n    );\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAll(selector, options);\n\n  if (options.remote) {\n    // seach non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        c.instance.findAll(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isArray, isObjectType } from 'utils/is';\n\nexport default function Ractive$findAllComponents(selector, options) {\n  if (!options && isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  options = options || {};\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAllComponents(selector, options);\n\n  if (options.remote) {\n    // search non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        if (!selector || c.name === selector) {\n          options.result.push(c.instance);\n        }\n\n        c.instance.findAllComponents(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isObjectType } from 'utils/is';\n\nexport default function Ractive$findComponent(selector, options = {}) {\n  if (isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  let child = this.fragment.findComponent(selector, options);\n  if (child) return child;\n\n  if (options.remote) {\n    if (!selector && this._children.length) return this._children[0].instance;\n    for (let i = 0; i < this._children.length; i++) {\n      // skip children that are or should be in an anchor\n      if (this._children[i].target) continue;\n      if (this._children[i].name === selector) return this._children[i].instance;\n      child = this._children[i].instance.findComponent(selector, options);\n      if (child) return child;\n    }\n  }\n}\n","export default function Ractive$findContainer(selector) {\n  if (this.container) {\n    if (this.container.component && this.container.component.name === selector) {\n      return this.container;\n    } else {\n      return this.container.findContainer(selector);\n    }\n  }\n\n  return null;\n}\n","export default function Ractive$findParent(selector) {\n  if (this.parent) {\n    if (this.parent.component && this.parent.component.name === selector) {\n      return this.parent;\n    } else {\n      return this.parent.findParent(selector);\n    }\n  }\n\n  return null;\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from 'config/types';\n\nexport default function findElement(start, orComponent = true, name) {\n  while (\n    start &&\n    (start.type !== ELEMENT || (name && start.name !== name)) &&\n    (!orComponent || (start.type !== COMPONENT && start.type !== ANCHOR))\n  ) {\n    // start is a fragment - look at the owner\n    if (start.owner) start = start.owner;\n    else if (start.component)\n      // start is a component or yielder - look at the container\n      start = start.containerFragment || start.component.up;\n    else if (start.parent)\n      // start is an item - look at the parent\n      start = start.parent;\n    else if (start.up)\n      // start is an item without a parent - look at the parent fragment\n      start = start.up;\n    else start = undefined;\n  }\n\n  return start;\n}\n","import { isNumber } from 'utils/is';\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices(length, methodName, args) {\n  const newIndices = [];\n\n  const spliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  if (!spliceArguments) {\n    return null; // TODO support reverse and sort?\n  }\n\n  const balance = spliceArguments.length - 2 - spliceArguments[1];\n\n  const removeStart = Math.min(length, spliceArguments[0]);\n  const removeEnd = removeStart + spliceArguments[1];\n  newIndices.startIndex = removeStart;\n\n  let i;\n  for (i = 0; i < removeStart; i += 1) {\n    newIndices.push(i);\n  }\n\n  for (; i < removeEnd; i += 1) {\n    newIndices.push(-1);\n  }\n\n  for (; i < length; i += 1) {\n    newIndices.push(i + balance);\n  }\n\n  // there is a net shift for the rest of the array starting with index + balance\n  if (balance !== 0) {\n    newIndices.touchedFrom = spliceArguments[0];\n  } else {\n    newIndices.touchedFrom = length;\n  }\n\n  return newIndices;\n}\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent(length, methodName, args) {\n  switch (methodName) {\n    case 'splice':\n      if (args[0] !== undefined && args[0] < 0) {\n        args[0] = length + Math.max(args[0], -length);\n      }\n\n      if (args[0] === undefined) args[0] = 0;\n\n      while (args.length < 2) {\n        args.push(length - args[0]);\n      }\n\n      if (!isNumber(args[1])) {\n        args[1] = length - args[0];\n      }\n\n      // ensure we only remove elements that exist\n      args[1] = Math.min(args[1], length - args[0]);\n\n      return args;\n\n    case 'sort':\n    case 'reverse':\n      return null;\n\n    case 'pop':\n      if (length) {\n        return [length - 1, 1];\n      }\n      return [0, 0];\n\n    case 'push':\n      return [length, 0].concat(args);\n\n    case 'shift':\n      return [0, length ? 1 : 0];\n\n    case 'unshift':\n      return [0, 0].concat(args);\n  }\n}\n","import fireEvent from 'src/events/fireEvent';\nimport Context from 'shared/Context';\nimport { assign, create } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$fire(eventName, ...args) {\n  let ctx;\n\n  // watch for reproxy\n  if (args[0] instanceof Context) {\n    const proto = args.shift();\n    ctx = create(proto);\n    assign(ctx, proto);\n  } else if (isObjectType(args[0]) && (args[0] === null || args[0].constructor === Object)) {\n    ctx = Context.forRactive(this, args.shift());\n  } else {\n    ctx = Context.forRactive(this);\n  }\n\n  return fireEvent(this, eventName, ctx, args);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport { FakeFragment } from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$get(keypath, opts) {\n  if (!isString(keypath)) return this.viewmodel.get(true, keypath);\n\n  const keys = splitKeypath(keypath);\n  const key = keys[0];\n\n  let model;\n\n  if (!this.viewmodel.has(key)) {\n    // if this is an inline component, we may need to create\n    // an implicit mapping\n    if (this.component && !this.isolated) {\n      model = resolveReference(this.fragment || new FakeFragment(this), key);\n    }\n  }\n\n  model = this.viewmodel.joinAll(keys);\n  return model.get(true, opts);\n}\n","import staticContext, { getNodeInfo as staticInfo } from '../static/getContext';\nimport { isString } from 'utils/is';\n\nexport default function getContext(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticContext(node);\n}\n\nexport function getNodeInfo(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticInfo(node);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from 'src/global/runloop';\n\nexport default function link(there, here, options) {\n  let model;\n  const target = (options && (options.ractive || options.instance)) || this;\n\n  // may need to allow a mapping to resolve implicitly\n  const sourcePath = splitKeypath(there);\n  if (!target.viewmodel.has(sourcePath[0]) && target.component) {\n    model = resolveReference(target.component.up, sourcePath[0]);\n    model = model.joinAll(sourcePath.slice(1));\n  }\n\n  const src = model || target.viewmodel.joinAll(sourcePath);\n  const dest = this.viewmodel.joinAll(splitKeypath(here), { lastLink: false });\n\n  if (isUpstream(src, dest) || isUpstream(dest, src)) {\n    throw new Error('A keypath cannot be linked to itself.');\n  }\n\n  const promise = runloop.start();\n\n  dest.link(src, (options && options.keypath) || there);\n\n  runloop.end();\n\n  return promise;\n}\n\nfunction isUpstream(check, start) {\n  let model = start;\n  while (model) {\n    if (model === check || model.owner === check) return true;\n    model = model.target || model.parent;\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\nimport { keys } from 'utils/object';\n\nexport default function observe(keypath, callback, options) {\n  const observers = [];\n  let map;\n  let opts;\n\n  if (isObject(keypath)) {\n    map = keypath;\n    opts = callback || {};\n  } else {\n    if (isFunction(keypath)) {\n      map = { '': keypath };\n      opts = callback || {};\n    } else {\n      map = {};\n      map[keypath] = callback;\n      opts = options || {};\n    }\n  }\n\n  let silent = false;\n  keys(map).forEach(keypath => {\n    const callback = map[keypath];\n    const caller = function(...args) {\n      if (silent) return;\n      return callback.apply(this, args);\n    };\n\n    let keypaths = keypath.split(' ');\n    if (keypaths.length > 1) keypaths = keypaths.filter(k => k);\n\n    keypaths.forEach(keypath => {\n      opts.keypath = keypath;\n      const observer = createObserver(this, keypath, caller, opts);\n      if (observer) observers.push(observer);\n    });\n  });\n\n  // add observers to the Ractive instance, so they can be\n  // cancelled on ractive.teardown()\n  this._observers.push.apply(this._observers, observers);\n\n  return {\n    cancel: () => observers.forEach(o => o.cancel()),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n\nfunction createObserver(ractive, keypath, callback, options) {\n  const keys = splitKeypath(keypath);\n  let wildcardIndex = keys.indexOf('*');\n  if (!~wildcardIndex) wildcardIndex = keys.indexOf('**');\n\n  options.fragment = options.fragment || ractive.fragment;\n\n  let model;\n  if (!options.fragment) {\n    model = ractive.viewmodel.joinKey(keys[0]);\n  } else {\n    // .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n    if (~keys[0].indexOf('.*')) {\n      model = options.fragment.findContext();\n      wildcardIndex = 0;\n      keys[0] = keys[0].slice(1);\n    } else {\n      model =\n        wildcardIndex === 0\n          ? options.fragment.findContext()\n          : resolveReference(options.fragment, keys[0]);\n    }\n  }\n\n  // the model may not exist key\n  if (!model) model = ractive.viewmodel.joinKey(keys[0]);\n\n  if (!~wildcardIndex) {\n    model = model.joinAll(keys.slice(1));\n    if (options.array) {\n      return new ArrayObserver(ractive, model, callback, options);\n    } else {\n      return new Observer(ractive, model, callback, options);\n    }\n  } else {\n    const double = keys.indexOf('**');\n    if (~double) {\n      if (double + 1 !== keys.length || ~keys.indexOf('*')) {\n        warnOnceIfDebug(\n          `Recursive observers may only specify a single '**' at the end of the path.`\n        );\n        return;\n      }\n    }\n\n    model = model.joinAll(keys.slice(1, wildcardIndex));\n\n    return new PatternObserver(ractive, model, keys.slice(wildcardIndex), callback, options);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off(eventName, callback) {\n  // if no event is specified, remove _all_ event listeners\n  if (!eventName) {\n    this._subs = {};\n  } else {\n    // Handle multiple space-separated event names\n    const eventNames = eventName\n      .split(' ')\n      .map(trim)\n      .filter(notEmptyString);\n\n    eventNames.forEach(event => {\n      const subs = this._subs[event];\n      // if given a specific callback to remove, remove only it\n      if (subs && callback) {\n        const entry = subs.find(s => s.callback === callback);\n        if (entry) {\n          removeFromArray(subs, entry);\n          entry.off = true;\n\n          if (event.indexOf('.')) this._nsSubs--;\n        }\n      } else if (subs) {\n        // otherwise, remove all listeners for this event\n        if (event.indexOf('.')) this._nsSubs -= subs.length;\n        subs.length = 0;\n      }\n    });\n  }\n\n  return this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { hasOwn } from 'utils/object';\nimport { isObjectType, isString } from 'utils/is';\n\nexport default function Ractive$on(eventName, callback) {\n  // eventName may already be a map\n  const map = isObjectType(eventName) ? eventName : {};\n  // or it may be a string along with a callback\n  if (isString(eventName)) map[eventName] = callback;\n\n  let silent = false;\n  const events = [];\n\n  for (const k in map) {\n    const callback = map[k];\n    const caller = function(...args) {\n      if (!silent) return callback.apply(this, args);\n    };\n    const entry = {\n      callback,\n      handler: caller\n    };\n\n    if (hasOwn(map, k)) {\n      const names = k\n        .split(' ')\n        .map(trim)\n        .filter(notEmptyString);\n      names.forEach(n => {\n        (this._subs[n] || (this._subs[n] = [])).push(entry);\n        if (n.indexOf('.')) this._nsSubs++;\n        events.push([n, entry]);\n      });\n    }\n  }\n\n  return {\n    cancel: () => events.forEach(e => this.off(e[0], e[1].callback)),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n","export default function Ractive$once(eventName, handler) {\n  const listener = this.on(eventName, function() {\n    handler.apply(this, arguments);\n    listener.cancel();\n  });\n\n  // so we can still do listener.cancel() manually\n  return listener;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function readLink(keypath, options = {}) {\n  const path = splitKeypath(keypath);\n\n  if (this.viewmodel.has(path[0])) {\n    let model = this.viewmodel.joinAll(path);\n\n    if (!model.isLink) return;\n\n    while ((model = model.target) && options.canonical !== false) {\n      if (!model.isLink) break;\n    }\n\n    if (model) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n  }\n}\n","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport function uuid() {\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import { applyCSS } from '../../global/css';\nimport transformCSS from '../config/custom/css/transform';\nimport { evalCSS } from '../config/custom/css/css';\nimport { build, set } from '../../shared/set';\nimport runloop from '../../global/runloop';\nimport { isObjectType, isFunction } from 'utils/is';\n\nexport default function setCSSData(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = this._cssModel;\n\n  model.locked = true;\n  const promise = set(build({ viewmodel: model }, keypath, value, true), opts);\n  model.locked = false;\n\n  const cascade = runloop.start();\n  this.extensions.forEach(e => {\n    const model = e._cssModel;\n    model.mark();\n    model.downstreamChanged('', 1);\n  });\n  runloop.end();\n\n  applyChanges(this, !opts || opts.apply !== false);\n\n  return promise.then(() => cascade);\n}\n\nexport function applyChanges(component, apply) {\n  const local = recomputeCSS(component);\n  const child = component.extensions\n    .map(e => applyChanges(e, false))\n    .reduce((a, c) => c || a, false);\n\n  if (apply && (local || child)) {\n    const def = component._cssDef;\n    if (!def || (def && def.applied)) applyCSS(true);\n  }\n\n  return local || child;\n}\n\nexport function recomputeCSS(component) {\n  const css = component.css;\n\n  if (!isFunction(css)) return;\n\n  const def = component._cssDef;\n  const result = evalCSS(component, css);\n  const styles = def.transform ? transformCSS(result, def.id) : result;\n\n  if (def.styles === styles) return;\n\n  def.styles = styles;\n\n  return true;\n}\n","import noop from 'utils/noop';\nimport { isFunction } from 'utils/is';\n\nexport default function wrap(parent, name, method) {\n  if (!/_super/.test(method)) return method;\n\n  function wrapper() {\n    const superMethod = getSuperMethod(wrapper._parent, name);\n    const hasSuper = '_super' in this;\n    const oldSuper = this._super;\n\n    this._super = superMethod;\n\n    const result = method.apply(this, arguments);\n\n    if (hasSuper) {\n      this._super = oldSuper;\n    } else {\n      delete this._super;\n    }\n\n    return result;\n  }\n\n  wrapper._parent = parent;\n  wrapper._method = method;\n\n  return wrapper;\n}\n\nfunction getSuperMethod(parent, name) {\n  if (name in parent) {\n    const value = parent[name];\n\n    return isFunction(value) ? value : () => value;\n  }\n\n  return noop;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage(deprecated, correct, isError) {\n  return (\n    `options.${deprecated} has been deprecated in favour of options.${correct}.` +\n    (isError ? ` You cannot specify both options, please use options.${correct}.` : '')\n  );\n}\n\nfunction deprecateOption(options, deprecatedOption, correct) {\n  if (deprecatedOption in options) {\n    if (!(correct in options)) {\n      warnIfDebug(getMessage(deprecatedOption, correct));\n      options[correct] = options[deprecatedOption];\n    } else {\n      throw new Error(getMessage(deprecatedOption, correct, true));\n    }\n  }\n}\n\nexport default function deprecate(options) {\n  deprecateOption(options, 'beforeInit', 'onconstruct');\n  deprecateOption(options, 'init', 'onrender');\n  deprecateOption(options, 'complete', 'oncomplete');\n  deprecateOption(options, 'eventDefinitions', 'events');\n\n  // Using extend with Component instead of options,\n  // like Human.extend( Spider ) means adaptors as a registry\n  // gets copied to options. So we have to check if actually an array\n  if (isArray(options.adaptors)) {\n    deprecateOption(options, 'adaptors', 'adapt');\n  }\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve(fragment, template) {\n  if (template.r) {\n    return resolveReference(fragment, template.r);\n  } else if (template.x) {\n    return new ExpressionProxy(fragment, template.x);\n  } else if (template.rx) {\n    return new ReferenceExpressionProxy(fragment, template.rx);\n  }\n}\n","export default function(camelCaseStr) {\n  return camelCaseStr.replace(/([A-Z])/g, (match, $1) => {\n    return '-' + $1.toLowerCase();\n  });\n}\n","import { create, toPairs } from 'utils/object';\nimport { isFunction, isObjectType } from 'utils/is';\n\nexport default function subscribe(instance, options, type) {\n  const subs = (instance.constructor[`_${type}`] || []).concat(toPairs(options[type] || []));\n  const single = type === 'on' ? 'once' : `${type}Once`;\n\n  subs.forEach(([target, config]) => {\n    if (isFunction(config)) {\n      instance[type](target, config);\n    } else if (isObjectType(config) && isFunction(config.handler)) {\n      instance[config.once ? single : type](target, config.handler, create(config));\n    }\n  });\n}\n","export default function() {}\n","export function findInViewHierarchy(registryName, ractive, name) {\n  const instance = findInstance(registryName, ractive, name);\n  return instance ? instance[registryName][name] : null;\n}\n\nexport function findInstance(registryName, ractive, name) {\n  while (ractive) {\n    if (name in ractive[registryName]) {\n      return ractive;\n    }\n\n    if (ractive.isolated) {\n      return null;\n    }\n\n    ractive = ractive.parent;\n  }\n}\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate(from, to, ractive, type) {\n  if (from === to) return null;\n\n  if (type) {\n    const interpol = findInViewHierarchy('interpolators', ractive, type);\n    if (interpol) return interpol(from, to) || null;\n\n    fatal(missingPlugin(type, 'interpolator'));\n  }\n\n  return (\n    interpolators.number(from, to) ||\n    interpolators.array(from, to) ||\n    interpolators.object(from, to) ||\n    null\n  );\n}\n","import { isArray, isString } from './is';\n\nexport function addToArray(array, value) {\n  const index = array.indexOf(value);\n\n  if (index === -1) {\n    array.push(value);\n  }\n}\n\nexport function arrayContains(array, value) {\n  for (let i = 0, c = array.length; i < c; i++) {\n    if (array[i] == value) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function arrayContentsMatch(a, b) {\n  let i;\n\n  if (!isArray(a) || !isArray(b)) {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  i = a.length;\n  while (i--) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function ensureArray(x) {\n  if (isString(x)) {\n    return [x];\n  }\n\n  if (x === undefined) {\n    return [];\n  }\n\n  return x;\n}\n\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n\nexport function removeFromArray(array, member) {\n  if (!array) {\n    return;\n  }\n\n  const index = array.indexOf(member);\n\n  if (index !== -1) {\n    array.splice(index, 1);\n  }\n}\n\nexport function combine(...arrays) {\n  const res = arrays.concat.apply([], arrays);\n  let i = res.length;\n  while (i--) {\n    const idx = res.indexOf(res[i]);\n    if (~idx && idx < i) res.splice(i, 1);\n  }\n\n  return res;\n}\n\nexport function toArray(arrayLike) {\n  const array = [];\n  let i = arrayLike.length;\n  while (i--) {\n    array[i] = arrayLike[i];\n  }\n\n  return array;\n}\n\nexport function findMap(array, fn) {\n  const len = array.length;\n  for (let i = 0; i < len; i++) {\n    const result = fn(array[i]);\n    if (result) return result;\n  }\n}\n\nexport function buildNewIndices(one, two, comparator) {\n  let oldArray = one;\n  let newArray = two;\n  if (comparator) {\n    oldArray = oldArray.map(comparator);\n    newArray = newArray.map(comparator);\n  }\n\n  const oldLength = oldArray.length;\n\n  const usedIndices = {};\n  let firstUnusedIndex = 0;\n\n  return oldArray.map(item => {\n    let index;\n    let start = firstUnusedIndex;\n\n    do {\n      index = newArray.indexOf(item, start);\n\n      if (index === -1) {\n        return -1;\n      }\n\n      start = index + 1;\n    } while (usedIndices[index] === true && start < oldLength);\n\n    // keep track of the first unused index, so we don't search\n    // the whole of newArray for each item in oldArray unnecessarily\n    if (index === firstUnusedIndex) {\n      firstUnusedIndex += 1;\n    }\n    // allow next instance of next \"equal\" to be found item\n    usedIndices[index] = true;\n    return index;\n  });\n}\n","export function bind(x) {\n  x.bind();\n}\nexport function cancel(x) {\n  x.cancel();\n}\nexport function destroyed(x) {\n  x.destroyed();\n}\nexport function handleChange(x) {\n  x.handleChange();\n}\nexport function mark(x) {\n  x.mark();\n}\nexport function markForce(x) {\n  x.mark(true);\n}\nexport function marked(x) {\n  x.marked();\n}\nexport function markedAll(x) {\n  x.markedAll();\n}\nexport function render(x) {\n  x.render();\n}\nexport function shuffled(x) {\n  x.shuffled();\n}\nexport function teardown(x) {\n  x.teardown();\n}\nexport function unbind(x) {\n  x.unbind();\n}\nexport function unrender(x) {\n  x.unrender();\n}\nexport function unrenderAndDestroy(x) {\n  x.unrender(true);\n}\nexport function update(x) {\n  x.update();\n}\nexport function toString(x) {\n  return x.toString();\n}\nexport function toEscapedString(x) {\n  return x.toString(true);\n}\n","import { splitKeypath } from './keypaths';\nimport { isString } from 'utils/is';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch(template, next, previous, fragment) {\n  const keypath = template.r || template;\n\n  // no valid keypath, go with next\n  if (!keypath || !isString(keypath)) return next;\n\n  // completely contextual ref, go with next\n  if (\n    keypath === '.' ||\n    keypath[0] === '@' ||\n    (next || previous).isKey ||\n    (next || previous).isKeypath\n  )\n    return next;\n\n  const parts = keypath.split('/');\n  let keys = splitKeypath(parts[parts.length - 1]);\n  const last = keys[keys.length - 1];\n\n  // check the keypath against the model keypath to see if it matches\n  let model = next || previous;\n\n  // check to see if this was an alias\n  if (model && keys.length === 1 && last !== model.key && fragment) {\n    keys = findAlias(last, fragment) || keys;\n  }\n\n  let i = keys.length;\n  let match = true;\n  let shuffling = false;\n\n  while (model && i--) {\n    if (model.shuffling) shuffling = true;\n    // non-strict comparison to account for indices in keypaths\n    if (keys[i] != model.key) match = false;\n    model = model.parent;\n  }\n\n  // next is undefined, but keypath is shuffling and previous matches\n  if (!next && match && shuffling) return previous;\n  else if (next && !match && shuffling)\n    // next is defined, but doesn't match the keypath\n    return previous;\n  else return next;\n}\n\nfunction findAlias(name, fragment) {\n  while (fragment) {\n    const z = fragment.aliases;\n    if (z && z[name]) {\n      const aliases = (fragment.owner.iterations ? fragment.owner : fragment).owner.template.z;\n      for (let i = 0; i < aliases.length; i++) {\n        if (aliases[i].n === name) {\n          const alias = aliases[i].x;\n          if (!alias.r) return false;\n          const parts = alias.r.split('/');\n          return splitKeypath(parts[parts.length - 1]);\n        }\n      }\n      return;\n    }\n\n    fragment = fragment.componentParent || fragment.parent;\n  }\n}\n","export function fromExpression(body, length = 0) {\n  const args = new Array(length);\n\n  while (length--) {\n    args[length] = `_${length}`;\n  }\n\n  // Functions created directly with new Function() look like this:\n  //     function anonymous (_0 /**/) { return _0*2 }\n  //\n  // With this workaround, we get a little more compact:\n  //     function (_0){return _0*2}\n  return new Function([], `return function (${args.join(',')}){return(${body});};`)();\n}\n","import { BOOLEAN_LITERAL } from '../../../../../config/types';\n\nexport default function readBooleanLiteral(parser) {\n  const remaining = parser.remaining();\n\n  if (remaining.substr(0, 4) === 'true') {\n    parser.pos += 4;\n    return {\n      t: BOOLEAN_LITERAL,\n      v: 'true'\n    };\n  }\n\n  if (remaining.substr(0, 5) === 'false') {\n    parser.pos += 5;\n    return {\n      t: BOOLEAN_LITERAL,\n      v: 'false'\n    };\n  }\n\n  return null;\n}\n","import { KEY_VALUE_PAIR, REFERENCE } from 'src/config/types';\nimport readKey from '../../../shared/readKey';\nimport readExpression from '../../../../readExpression';\nimport { name as namePattern, spreadPattern } from '../../../shared/patterns';\n\nexport default function readKeyValuePair(parser) {\n  let spread;\n  const start = parser.pos;\n\n  // allow whitespace between '{' and key\n  parser.sp();\n\n  const refKey = parser.nextChar() !== \"'\" && parser.nextChar() !== '\"';\n  if (refKey) spread = parser.matchPattern(spreadPattern);\n\n  const key = spread ? readExpression(parser) : readKey(parser);\n  if (key === null) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace between key and ':'\n  parser.sp();\n\n  // es2015 shorthand property\n  if (refKey && (parser.nextChar() === ',' || parser.nextChar() === '}')) {\n    if (!spread && !namePattern.test(key)) {\n      parser.error(`Expected a valid reference, but found '${key}' instead.`);\n    }\n\n    const pair = {\n      t: KEY_VALUE_PAIR,\n      k: key,\n      v: {\n        t: REFERENCE,\n        n: key\n      }\n    };\n\n    if (spread) {\n      pair.p = true;\n    }\n\n    return pair;\n  }\n\n  // next character must be ':'\n  if (!parser.matchString(':')) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace between ':' and value\n  parser.sp();\n\n  // next expression must be a, well... expression\n  const value = readExpression(parser);\n  if (value === null) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: KEY_VALUE_PAIR,\n    k: key,\n    v: value\n  };\n}\n","import getKeyValuePair from './keyValuePair';\n\nexport default function readKeyValuePairs(parser) {\n  const start = parser.pos;\n\n  const pair = getKeyValuePair(parser);\n  if (pair === null) {\n    return null;\n  }\n\n  const pairs = [pair];\n\n  if (parser.matchString(',')) {\n    const keyValuePairs = readKeyValuePairs(parser);\n\n    if (!keyValuePairs) {\n      parser.pos = start;\n      return null;\n    }\n\n    return pairs.concat(keyValuePairs);\n  }\n\n  return pairs;\n}\n","import { OBJECT_LITERAL } from '../../../../../config/types';\nimport readKeyValuePairs from './objectLiteral/keyValuePairs';\n\nexport default function(parser) {\n  const start = parser.pos;\n\n  // allow whitespace\n  parser.sp();\n\n  if (!parser.matchString('{')) {\n    parser.pos = start;\n    return null;\n  }\n\n  const keyValuePairs = readKeyValuePairs(parser);\n\n  // allow whitespace between final value and '}'\n  parser.sp();\n\n  if (!parser.matchString('}')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: OBJECT_LITERAL,\n    m: keyValuePairs\n  };\n}\n","import { ARRAY_LITERAL } from 'src/config/types';\nimport readExpressionList from '../../shared/readExpressionList';\n\nexport default function(parser) {\n  const start = parser.pos;\n\n  // allow whitespace before '['\n  parser.sp();\n\n  if (!parser.matchString('[')) {\n    parser.pos = start;\n    return null;\n  }\n\n  const expressionList = readExpressionList(parser, true);\n\n  if (!parser.matchString(']')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: ARRAY_LITERAL,\n    m: expressionList\n  };\n}\n","import readNumberLiteral from './literal/readNumberLiteral';\nimport readBooleanLiteral from './literal/readBooleanLiteral';\nimport readStringLiteral from './literal/readStringLiteral';\nimport readTemplateStringLiteral from './literal/readTemplateStringLiteral';\nimport readObjectLiteral from './literal/readObjectLiteral';\nimport readArrayLiteral from './literal/readArrayLiteral';\nimport readRegexpLiteral from './literal/readRegexpLiteral';\n\nexport default function readLiteral(parser) {\n  return (\n    readNumberLiteral(parser) ||\n    readBooleanLiteral(parser) ||\n    readStringLiteral(parser) ||\n    readTemplateStringLiteral(parser) ||\n    readObjectLiteral(parser) ||\n    readArrayLiteral(parser) ||\n    readRegexpLiteral(parser)\n  );\n}\n","import { BRACKETED } from 'src/config/types';\nimport { expectedExpression, expectedParen } from '../shared/errors';\nimport readExpression from '../../readExpression';\n\nexport default function readBracketedExpression(parser) {\n  if (!parser.matchString('(')) return null;\n\n  parser.sp();\n\n  const expr = readExpression(parser);\n\n  if (!expr) parser.error(expectedExpression);\n\n  parser.sp();\n\n  if (!parser.matchString(')')) parser.error(expectedParen);\n\n  return {\n    t: BRACKETED,\n    x: expr\n  };\n}\n","import readLiteral from './primary/readLiteral';\nimport readReference from './primary/readReference';\nimport readBracketedExpression from './primary/readBracketedExpression';\n\nexport default function(parser) {\n  return readLiteral(parser) || readReference(parser) || readBracketedExpression(parser);\n}\n","import { REFINEMENT } from 'config/types';\nimport { expectedExpression } from './errors';\nimport { name as namePattern } from './patterns';\nimport readExpression from '../../readExpression';\n\nexport default function readRefinement(parser) {\n  // some things call for strict refinement (partial names), meaning no space between reference and refinement\n  if (!parser.strictRefinement) {\n    parser.sp();\n  }\n\n  // \".\" name\n  if (parser.matchString('.')) {\n    parser.sp();\n\n    const name = parser.matchPattern(namePattern);\n    if (name) {\n      return {\n        t: REFINEMENT,\n        n: name\n      };\n    }\n\n    parser.error('Expected a property name');\n  }\n\n  // \"[\" expression \"]\"\n  if (parser.matchString('[')) {\n    parser.sp();\n\n    const expr = readExpression(parser);\n    if (!expr) parser.error(expectedExpression);\n\n    parser.sp();\n\n    if (!parser.matchString(']')) parser.error(`Expected ']'`);\n\n    return {\n      t: REFINEMENT,\n      x: expr\n    };\n  }\n\n  return null;\n}\n","import { MEMBER, INVOCATION } from 'config/types';\nimport readPrimary from './readPrimary';\nimport readExpressionList from './shared/readExpressionList';\nimport readRefinement from './shared/readRefinement';\nimport { expectedParen } from './shared/errors';\n\nexport default function(parser) {\n  let expression = readPrimary(parser);\n\n  if (!expression) return null;\n\n  while (expression) {\n    const refinement = readRefinement(parser);\n    if (refinement) {\n      expression = {\n        t: MEMBER,\n        x: expression,\n        r: refinement\n      };\n    } else if (parser.matchString('(')) {\n      parser.sp();\n      const expressionList = readExpressionList(parser, true);\n\n      parser.sp();\n\n      if (!parser.matchString(')')) {\n        parser.error(expectedParen);\n      }\n\n      expression = {\n        t: INVOCATION,\n        x: expression\n      };\n\n      if (expressionList) expression.o = expressionList;\n    } else {\n      break;\n    }\n  }\n\n  return expression;\n}\n","import { CONDITIONAL } from 'config/types';\nimport readLogicalOr from './readLogicalOr';\nimport { expectedExpression } from './shared/errors';\nimport readExpression from '../readExpression';\n\n// The conditional operator is the lowest precedence operator, so we start here\nexport default function getConditional(parser) {\n  const expression = readLogicalOr(parser);\n  if (!expression) {\n    return null;\n  }\n\n  const start = parser.pos;\n\n  parser.sp();\n\n  if (!parser.matchString('?')) {\n    parser.pos = start;\n    return expression;\n  }\n\n  parser.sp();\n\n  const ifTrue = readExpression(parser);\n  if (!ifTrue) {\n    parser.error(expectedExpression);\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(':')) {\n    parser.error('Expected \":\"');\n  }\n\n  parser.sp();\n\n  const ifFalse = readExpression(parser);\n  if (!ifFalse) {\n    parser.error(expectedExpression);\n  }\n\n  return {\n    t: CONDITIONAL,\n    o: [expression, ifTrue, ifFalse]\n  };\n}\n","import readConditional from './expressions/readConditional';\nimport readReference from './expressions/primary/readReference';\n\nexport default function readExpression(parser) {\n  // if eval is false, no expressions\n  if (parser.allowExpressions === false) {\n    const ref = readReference(parser);\n    parser.sp();\n    return ref;\n  }\n\n  // The conditional operator is the lowest precedence operator (except yield,\n  // assignment operators, and commas, none of which are supported), so we\n  // start there. If it doesn't match, it 'falls through' to progressively\n  // higher precedence operators, until it eventually matches (or fails to\n  // match) a 'primary' - a literal or a reference. This way, the abstract syntax\n  // tree has everything in its proper place, i.e. 2 + 3 * 4 === 14, not 20.\n  return readConditional(parser);\n}\n","import { expectedExpression } from './errors';\nimport readExpression from '../../readExpression';\nimport { spreadPattern } from './patterns';\n\nexport default function readExpressionList(parser, spread) {\n  let isSpread;\n  const expressions = [];\n\n  const pos = parser.pos;\n\n  do {\n    parser.sp();\n\n    if (spread) {\n      isSpread = parser.matchPattern(spreadPattern);\n    }\n\n    const expr = readExpression(parser);\n\n    if (expr === null && expressions.length) {\n      parser.error(expectedExpression);\n    } else if (expr === null) {\n      parser.pos = pos;\n      return null;\n    }\n\n    if (isSpread) {\n      expr.p = true;\n    }\n\n    expressions.push(expr);\n\n    parser.sp();\n  } while (parser.matchString(','));\n\n  return expressions;\n}\n","import { REFERENCE } from 'config/types';\nimport readExpression from './readExpression';\nimport readReference from './expressions/primary/readReference';\n\nexport default function readExpressionOrReference(parser, expectedFollowers) {\n  const start = parser.pos;\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    // valid reference but invalid expression e.g. `{{new}}`?\n    const ref = parser.matchPattern(/^(\\w+)/);\n    if (ref) {\n      return {\n        t: REFERENCE,\n        n: ref\n      };\n    }\n\n    return null;\n  }\n\n  for (let i = 0; i < expectedFollowers.length; i += 1) {\n    if (parser.remaining().substr(0, expectedFollowers[i].length) === expectedFollowers[i]) {\n      return expression;\n    }\n  }\n\n  parser.pos = start;\n  return readReference(parser);\n}\n","import {\n  REFERENCE,\n  BOOLEAN_LITERAL,\n  GLOBAL,\n  NUMBER_LITERAL,\n  REGEXP_LITERAL,\n  STRING_LITERAL,\n  ARRAY_LITERAL,\n  OBJECT_LITERAL,\n  KEY_VALUE_PAIR,\n  PREFIX_OPERATOR,\n  INFIX_OPERATOR,\n  INVOCATION,\n  BRACKETED,\n  MEMBER,\n  REFINEMENT,\n  CONDITIONAL\n} from 'config/types';\nimport { isObject, isString } from 'utils/is';\n\nexport default function flattenExpression(expression) {\n  let refs;\n  let count = 0;\n\n  extractRefs(expression, (refs = []));\n  const stringified = stringify(expression);\n\n  return {\n    r: refs,\n    s: getVars(stringified)\n  };\n\n  function getVars(expr) {\n    const vars = [];\n    for (let i = count - 1; i >= 0; i--) {\n      vars.push(`x$${i}`);\n    }\n    return vars.length ? `(function(){var ${vars.join(',')};return(${expr});})()` : expr;\n  }\n\n  function stringify(node) {\n    if (isString(node)) {\n      return node;\n    }\n\n    switch (node.t) {\n      case BOOLEAN_LITERAL:\n      case GLOBAL:\n      case NUMBER_LITERAL:\n      case REGEXP_LITERAL:\n        return node.v;\n\n      case STRING_LITERAL:\n        return JSON.stringify(String(node.v));\n\n      case ARRAY_LITERAL:\n        if (node.m && hasSpread(node.m)) {\n          return `[].concat(${makeSpread(node.m, '[', ']', stringify)})`;\n        } else {\n          return '[' + (node.m ? node.m.map(stringify).join(',') : '') + ']';\n        }\n\n      case OBJECT_LITERAL:\n        if (node.m && hasSpread(node.m)) {\n          return `Object.assign({},${makeSpread(node.m, '{', '}', stringifyPair)})`;\n        } else {\n          return '{' + (node.m ? node.m.map(n => `${n.k}:${stringify(n.v)}`).join(',') : '') + '}';\n        }\n\n      case PREFIX_OPERATOR:\n        return (node.s === 'typeof' ? 'typeof ' : node.s) + stringify(node.o);\n\n      case INFIX_OPERATOR:\n        return (\n          stringify(node.o[0]) +\n          (node.s.substr(0, 2) === 'in' ? ' ' + node.s + ' ' : node.s) +\n          stringify(node.o[1])\n        );\n\n      case INVOCATION:\n        if (node.o && hasSpread(node.o)) {\n          const id = count++;\n          return `(x$${id}=${stringify(node.x)}).apply(x$${id},${stringify({\n            t: ARRAY_LITERAL,\n            m: node.o\n          })})`;\n        } else {\n          return stringify(node.x) + '(' + (node.o ? node.o.map(stringify).join(',') : '') + ')';\n        }\n\n      case BRACKETED:\n        return '(' + stringify(node.x) + ')';\n\n      case MEMBER:\n        return stringify(node.x) + stringify(node.r);\n\n      case REFINEMENT:\n        return node.n ? '.' + node.n : '[' + stringify(node.x) + ']';\n\n      case CONDITIONAL:\n        return stringify(node.o[0]) + '?' + stringify(node.o[1]) + ':' + stringify(node.o[2]);\n\n      case REFERENCE:\n        return '_' + refs.indexOf(node.n);\n\n      default:\n        throw new Error('Expected legal JavaScript');\n    }\n  }\n\n  function stringifyPair(node) {\n    return node.p ? stringify(node.k) : `${node.k}:${stringify(node.v)}`;\n  }\n\n  function makeSpread(list, open, close, fn) {\n    const out = list.reduce(\n      (a, c) => {\n        if (c.p) {\n          a.str += `${a.open ? close + ',' : a.str.length ? ',' : ''}${fn(c)}`;\n        } else {\n          a.str += `${!a.str.length ? open : !a.open ? ',' + open : ','}${fn(c)}`;\n        }\n        a.open = !c.p;\n        return a;\n      },\n      { open: false, str: '' }\n    );\n    if (out.open) out.str += close;\n    return out.str;\n  }\n}\n\nfunction hasSpread(list) {\n  for (let i = 0; i < list.length; i++) {\n    if (list[i].p) return true;\n  }\n\n  return false;\n}\n\n// TODO maybe refactor this?\nfunction extractRefs(node, refs) {\n  if (node.t === REFERENCE && isString(node.n)) {\n    if (!~refs.indexOf(node.n)) {\n      refs.unshift(node.n);\n    }\n  }\n\n  const list = node.o || node.m;\n  if (list) {\n    if (isObject(list)) {\n      extractRefs(list, refs);\n    } else {\n      let i = list.length;\n      while (i--) {\n        extractRefs(list[i], refs);\n      }\n    }\n  }\n\n  if (node.k && node.t === KEY_VALUE_PAIR && !isString(node.k)) {\n    extractRefs(node.k, refs);\n  }\n\n  if (node.x) {\n    extractRefs(node.x, refs);\n  }\n\n  if (node.r) {\n    extractRefs(node.r, refs);\n  }\n\n  if (node.v) {\n    extractRefs(node.v, refs);\n  }\n}\n","import { REFERENCE, BRACKETED, MEMBER, REFINEMENT } from 'config/types';\nimport flattenExpression from './flattenExpression';\n\nexport default function refineExpression(expression, mustache) {\n  let referenceExpression;\n\n  if (expression) {\n    while (expression.t === BRACKETED && expression.x) {\n      expression = expression.x;\n    }\n\n    if (expression.t === REFERENCE) {\n      const n = expression.n;\n      if (!~n.indexOf('@context')) {\n        mustache.r = expression.n;\n      } else {\n        mustache.x = flattenExpression(expression);\n      }\n    } else {\n      if ((referenceExpression = getReferenceExpression(expression))) {\n        mustache.rx = referenceExpression;\n      } else {\n        mustache.x = flattenExpression(expression);\n      }\n    }\n\n    return mustache;\n  }\n}\n\n// TODO refactor this! it's bewildering\nfunction getReferenceExpression(expression) {\n  const members = [];\n  let refinement;\n\n  while (expression.t === MEMBER && expression.r.t === REFINEMENT) {\n    refinement = expression.r;\n\n    if (refinement.x) {\n      if (refinement.x.t === REFERENCE) {\n        members.unshift(refinement.x);\n      } else {\n        members.unshift(flattenExpression(refinement.x));\n      }\n    } else {\n      members.unshift(refinement.n);\n    }\n\n    expression = expression.x;\n  }\n\n  if (expression.t !== REFERENCE) {\n    return null;\n  }\n\n  return {\n    r: expression.n,\n    m: members\n  };\n}\n","import { TRIPLE } from 'config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readTriple(parser, tag) {\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    return null;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  const triple = { t: TRIPLE };\n  refineExpression(expression, triple); // TODO handle this differently - it's mysterious\n\n  return triple;\n}\n","import { TRIPLE } from 'config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readUnescaped(parser, tag) {\n  if (!parser.matchString('&')) {\n    return null;\n  }\n\n  parser.sp();\n\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    return null;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  const triple = { t: TRIPLE };\n  refineExpression(expression, triple); // TODO handle this differently - it's mysterious\n\n  return triple;\n}\n","import { PARTIAL, YIELDER } from 'src/config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { readAliases } from './readAliases';\n\nexport default function readPartial(parser, tag) {\n  const type = parser.matchString('>') || parser.matchString('yield');\n  const partial = { t: type === '>' ? PARTIAL : YIELDER };\n  let aliases;\n\n  if (!type) return null;\n\n  parser.sp();\n\n  if (type === '>' || !(aliases = parser.matchString('with'))) {\n    // Partial names can include hyphens, so we can't use readExpression\n    // blindly. Instead, we use the `relaxedNames` flag to indicate that\n    // `foo-bar` should be read as a single name, rather than 'subtract\n    // bar from foo'\n    parser.relaxedNames = parser.strictRefinement = true;\n    const expression = readExpression(parser);\n    parser.relaxedNames = parser.strictRefinement = false;\n\n    if (!expression && type === '>') return null;\n\n    if (expression) {\n      refineExpression(expression, partial); // TODO...\n      parser.sp();\n      if (type !== '>') aliases = parser.matchString('with');\n    }\n  }\n\n  parser.sp();\n\n  // check for alias context e.g. `{{>foo bar as bat, bip as bop}}`\n  if (aliases || type === '>') {\n    aliases = readAliases(parser);\n    if (aliases && aliases.length) {\n      partial.z = aliases;\n    } else if (type === '>') {\n      // otherwise check for literal context e.g. `{{>foo bar}}` then\n      // turn it into `{{#with bar}}{{>foo}}{{/with}}`\n      const context = readExpression(parser);\n      if (context) {\n        partial.c = {};\n        refineExpression(context, partial.c);\n      }\n    } else {\n      // {{yield with}} requires some aliases\n      parser.error(`Expected one or more aliases`);\n    }\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  return partial;\n}\n","import { COMMENT } from 'src/config/types';\n\nexport default function readComment(parser, tag) {\n  if (!parser.matchString('!')) {\n    return null;\n  }\n\n  const index = parser.remaining().indexOf(tag.close);\n\n  if (index !== -1) {\n    parser.pos += index + tag.close.length;\n    return { t: COMMENT };\n  }\n}\n","import { INTERPOLATOR } from 'config/types';\nimport readExpressionOrReference from '../readExpressionOrReference';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readInterpolator(parser, tag) {\n  let expression, err;\n\n  const start = parser.pos;\n\n  // TODO would be good for perf if we could do away with the try-catch\n  try {\n    expression = readExpressionOrReference(parser, [tag.close]);\n  } catch (e) {\n    err = e;\n  }\n\n  if (!expression) {\n    if (parser.str.charAt(start) === '!') {\n      // special case - comment\n      parser.pos = start;\n      return null;\n    }\n\n    if (err) {\n      throw err;\n    }\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}' after reference`);\n\n    if (!expression) {\n      // special case - comment\n      if (parser.nextChar() === '!') {\n        return null;\n      }\n\n      parser.error(`Expected expression or legal reference`);\n    }\n  }\n\n  const interpolator = { t: INTERPOLATOR };\n  refineExpression(expression, interpolator); // TODO handle this differently - it's mysterious\n\n  return interpolator;\n}\n","import { CLOSING } from 'config/types';\n\nexport default function readClosing(parser, tag) {\n  const start = parser.pos;\n\n  if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('/')) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  const remaining = parser.remaining();\n  const index = remaining.indexOf(tag.close);\n\n  if (index !== -1) {\n    const closing = {\n      t: CLOSING,\n      r: remaining.substr(0, index).split(' ')[0]\n    };\n\n    parser.pos += index;\n\n    if (!parser.matchString(tag.close)) {\n      parser.error(`Expected closing delimiter '${tag.close}'`);\n    }\n\n    return closing;\n  }\n\n  parser.pos = start;\n  return null;\n}\n","import { lastItem } from 'utils/array';\nimport { isString } from 'utils/is';\n\nexport default function(items, leadingPattern, trailingPattern) {\n  let item;\n\n  if (leadingPattern) {\n    item = items[0];\n    if (isString(item)) {\n      item = item.replace(leadingPattern, '');\n\n      if (!item) {\n        items.shift();\n      } else {\n        items[0] = item;\n      }\n    }\n  }\n\n  if (trailingPattern) {\n    item = lastItem(items);\n    if (isString(item)) {\n      item = item.replace(trailingPattern, '');\n\n      if (!item) {\n        items.pop();\n      } else {\n        items[items.length - 1] = item;\n      }\n    }\n  }\n}\n","import getLowestIndex from './utils/getLowestIndex';\nimport { decodeCharacterReferences } from 'utils/html';\n\nexport default function readText(parser) {\n  let index, disallowed, barrier;\n\n  const remaining = parser.remaining();\n\n  if (parser.textOnlyMode) {\n    disallowed = parser.tags.map(t => t.open);\n    disallowed = disallowed.concat(parser.tags.map(t => '\\\\' + t.open));\n\n    index = getLowestIndex(remaining, disallowed);\n  } else {\n    barrier = parser.inside ? '</' + parser.inside : '<';\n\n    if (parser.inside && !parser.interpolate[parser.inside]) {\n      index = remaining.indexOf(barrier);\n    } else {\n      disallowed = parser.tags.map(t => t.open);\n      disallowed = disallowed.concat(parser.tags.map(t => '\\\\' + t.open));\n\n      // http://developers.whatwg.org/syntax.html#syntax-attributes\n      if (parser.inAttribute === true) {\n        // we're inside an unquoted attribute value\n        disallowed.push(`\"`, `'`, `=`, `<`, `>`, '`');\n      } else if (parser.inAttribute) {\n        // quoted attribute value\n        disallowed.push(parser.inAttribute);\n      } else {\n        disallowed.push(barrier);\n      }\n\n      index = getLowestIndex(remaining, disallowed);\n    }\n  }\n\n  if (!index) {\n    return null;\n  }\n\n  if (index === -1) {\n    index = remaining.length;\n  }\n\n  parser.pos += index;\n\n  if ((parser.inside && parser.inside !== 'textarea') || parser.textOnlyMode) {\n    return remaining.substr(0, index);\n  } else {\n    return decodeCharacterReferences(remaining.substr(0, index));\n  }\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { READERS, PARTIAL_READERS } from 'parse/_parse';\nimport cleanup from 'parse/utils/cleanup';\nimport { create } from 'utils/object';\n\nexport default function readTemplate(parser) {\n  const fragment = [];\n  const partials = create(null);\n  let hasPartials = false;\n\n  const preserveWhitespace = parser.preserveWhitespace;\n\n  while (parser.pos < parser.str.length) {\n    const pos = parser.pos;\n    let item, partial;\n\n    if ((partial = parser.read(PARTIAL_READERS))) {\n      if (partials[partial.n]) {\n        parser.pos = pos;\n        parser.error('Duplicated partial definition');\n      }\n\n      cleanup(\n        partial.f,\n        parser.stripComments,\n        preserveWhitespace,\n        !preserveWhitespace,\n        !preserveWhitespace\n      );\n\n      partials[partial.n] = partial.f;\n      hasPartials = true;\n    } else if ((item = parser.read(READERS))) {\n      fragment.push(item);\n    } else {\n      parser.error('Unexpected template content');\n    }\n  }\n\n  const result = {\n    v: TEMPLATE_VERSION,\n    t: fragment\n  };\n\n  if (hasPartials) {\n    result.p = partials;\n  }\n\n  return result;\n}\n","import { fromExpression } from './createFunction';\nimport { isArray, isObject } from 'utils/is';\nimport { keys } from 'utils/object';\n\nexport default function insertExpressions(obj, expr) {\n  keys(obj).forEach(key => {\n    if (isExpression(key, obj)) return addTo(obj, expr);\n\n    const ref = obj[key];\n    if (hasChildren(ref)) insertExpressions(ref, expr);\n  });\n}\n\nfunction isExpression(key, obj) {\n  return key === 's' && isArray(obj.r);\n}\n\nfunction addTo(obj, expr) {\n  const { s, r } = obj;\n  if (!expr[s]) expr[s] = fromExpression(s, r.length);\n}\n\nfunction hasChildren(ref) {\n  return isArray(ref) || isObject(ref);\n}\n","import { fatal } from 'utils/log';\nimport bind from 'utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\nimport { isFunction, isString, isObjectType } from 'utils/is';\n\nexport default function getComputationSignature(ractive, key, signature) {\n  let getter;\n  let setter;\n\n  // useful for debugging\n  let getterString;\n  let getterUseStack;\n  let setterString;\n\n  if (isFunction(signature)) {\n    getter = bind(signature, ractive);\n    getterString = signature.toString();\n    getterUseStack = true;\n  }\n\n  if (isString(signature)) {\n    getter = createFunctionFromString(signature, ractive);\n    getterString = signature;\n  }\n\n  if (isObjectType(signature)) {\n    if (isString(signature.get)) {\n      getter = createFunctionFromString(signature.get, ractive);\n      getterString = signature.get;\n    } else if (isFunction(signature.get)) {\n      getter = bind(signature.get, ractive);\n      getterString = signature.get.toString();\n      getterUseStack = true;\n    } else {\n      fatal('`%s` computation must have a `get()` method', key);\n    }\n\n    if (isFunction(signature.set)) {\n      setter = bind(signature.set, ractive);\n      setterString = signature.set.toString();\n    }\n  }\n\n  return {\n    getter,\n    setter,\n    getterString,\n    setterString,\n    getterUseStack\n  };\n}\n"],"names":["findMap","this","iterations","i","find","selector","options","RepeatedFragment__proto__","findAll","forEach","findAllComponents","name","findComponent","findContext","context","findNextNode","iteration","index","length","let","node","firstNode","owner","skipParent","getLast","lastModel","KeyModel","rebind","next","fragment","swizzleFragment","key","render","target","occupants","xs","len","rendered","shuffle","newIndices","merge","pendingNewIndices","previousIterations","slice","push","newIndex","oldIndex","shouldRebind","dirty","bubble","shuffled","toString","escape","map","toEscapedString","join","unbind","bound","unrender","shouldDestroy","unrenderAndDestroy","update","bubbled","updatePostShuffle","updating","f","idxModel","applyValue","toRemove","oldKeys","value","get","wasArray","isArray","reset","splice","isObject","this$1","newLength","keys","updateLast","docFrag","createDocumentFragment","createIteration","indexRef","keyRef","refs","split","parentNode","parent","findParentNode","anchor","insertBefore","nextNode","indices","idx","dest","pos","prev","iters","stash","Array","e","nextRendered","detach","isObjectType","RepeatedFragment","prototype","getContext","Section","MustacheContainer","super","sectionType","template","n","templateSectionType","subordinate","l","Section__proto__","constructor","bind","sibling","up","items","indexOf","nextSibling","model","SECTION_UNLESS","isTruthy","Fragment","const","frag","detached","call","isRoot","undefined","SECTION_IF_WITH","isEmpty","previous","safe","SECTION_IF","SECTION_EACH","siblingFalsey","lastType","getType","newFragment","fragmentShouldExist","SECTION_WITH","attach","keep","runloop","promise","then","Select","Element","Select__proto__","foundNode","binding","selectedOptions","getSelectedOptions","sync","defaultSelected","selected","selectNode","toArray","o","setFromNode","selectValue","getAttribute","isMultiple","array","optionWasSelected","optionValue","_ractive","shouldSelect","valueContains","compare","forceUpdate","comparator","isFunction","Textarea","Input","deferContent","attributeByName","isBindable","attributes","createItem","t","ATTRIBUTE","cssIds","Textarea__proto__","scheduleTask","Text","Item","type","TEXT","Text__proto__","detachNode","inAttributes","progressiveText","escapeHtml","valueOf","proto","noop","visible","hidden","doc","prefix","vendors","vendor","addEventListener","onChange","onHide","onShow","win","isClient","prefixCache","testStyle","createElement","style","prop","hyphenateCamel","createTransitions","prefix$1","vendorPattern","RegExp","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","x","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","to","changedProperties","resolve","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","ractive","fire","isIntro","transitionEndHandler","event","propertyName","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","hyphenate","easing","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","warnIfDebug","exec","interpolate","parseFloat","isString","warnOnceIfDebug","missingPlugin","Ticker","step","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","Transition","findElement","element","onComplete","Transition__proto__","animateStyle","arguments","Error","setStyle","fulfil","propertyNames","computedStyle","current","init","originals","targets","v","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","fn","values","resolveArgs","apply","props","styles","processParams","defaults","isNumber","assign","addToArray","hasOwn","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","nested","el","starting","start","completed","args","noReset","k","_manager","remove","concat","unbinding","removeFromArray","destroyed","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","Triple","Mustache","Triple__proto__","nodes","appendChild","nodeType","matches","queryResult","querySelector","result","queryAllResult","querySelectorAll","html","insertHtml","shift","outerHTML","nodeValue","removeChild","inAttribute","decodeCharacterReferences","detachWhenReady","constructors","ALIAS","Alias","ANCHOR","Component","AWAIT","Await","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","TRIPLE","YIELDER","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","COMMENT","Comment","specialElements","doctype","form","Form","input","option","Option","select","textarea","componentParent","component","delegate","containerFragment","dirtyValue","createItems","Fragment__proto__","addFragment","max","base","findParentWithContext","viewmodel","item","it","ELEMENT","getKey","keyModel","getKeypath","root","rootModel","pathModel","getIndex","resetTemplate","wasBound","wasRendered","addFragmentToRoot","source","processItems","_guid","parsed","parseJSON","HookQueue","hook","Hook","inProcess","queue","HookQueue__proto__","begin","end","getChildQueue","configHook","initHook","renderHook","completeHook","shouldRerender","resetHook","unrenderHook","reverse","makeArrayMethod","path","sort","unshift","add","animate","attachChild","compute","detachChild","findContainer","findParent","getNodeInfo","insert","link","observe","observeOnce","off","on","once","pop","readLink","resetPartial","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","unlink","updateModel","use","defineProperty","callsSuper","defineProperties","Ractive","sharedGet","sharedSet","styleGet","configurable","styleSet","addCSS","addStyle","hasCSS","hasStyle","opts","script","document","currentScript","warn","shared","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","evalObjectString","findPlugin","getCSS","isInstance","joinKeys","macro","normaliseKeypath","normalise","parse","splitKeypath","unescapeKey","enhance","svg","VERSION","adaptors","components","decorators","events","extensions","helpers","interpolators","partials","transitions","cssData","sharedData","Context","extern","CSSModel","twowayBinding","isReadonly","setRoot","keypath","replace","attribute","isTwoway","wasUndefined","getInitialValue","lastVal","parentForm","resetValue","formBindings","Binding__proto__","Binding","registerTwowayBinding","handleChange","getValue","locked","setting","lastValue","unregisterTwowayBinding","CheckboxBinding","CheckboxBinding__proto__","handleDomEvent","attachEvent","checked","BindingGroup","bindings","BindingGroup__proto__","CheckboxNameBinding","checkboxName","group","getBindingGroup","noInitialValue","existingValue","bindingValue","arrayContains","CheckboxNameBinding__proto__","isChecked","valueSoFar","ContentEditableBinding","ContentEditableBinding__proto__","lazy","GenericBinding","GenericBinding__proto__","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","FileBinding__proto__","files","MultipleSelectBinding","MultipleSelectBinding__proto__","filter","selectedValues","previousValue","arrayContentsMatch","NumericBinding","NumericBinding__proto__","isNaN","siblings","RadioBinding","getSiblings","RadioBinding__proto__","RadioNameBinding","pathChanged","updateName","RadioNameBinding__proto__","SingleSelectBinding","SingleSelectBinding__proto__","disabled","endsWithSemi","ContainerItem","toLowerCase","attrs","attr","val","cls","leftovers","m","DELEGATE_FLAG","ConditionalAttribute","Element__proto__","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","listeners","ls","ref","assigns","ctx","create","callback","capture","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","proxy","isOutro","registerTransition","children","childNodes","removeAttribute","setAttribute","stringifyAttribute","isSelected","inputIsCheckedRadio","safeAttributeString","getString","test","inlineClass","str","voidElementNames","UIEvent","Form__proto__","handleReset","whitelist","animationend","animationiteration","animationstart","transitioncancel","transitionend","transitionstart","transitionrun","DOMEvent","fatal","DOMEvent__proto__","directive","original","CustomEvent","eventPlugin","CustomEvent__proto__","RactiveEvent","RactiveEvent__proto__","instance","cancel","specialPattern","dollarArgsPattern","EventDirective__proto__","COMPONENT","a","rs","r","resolveReference","getFunction","s","message","models","action","refire","specialRef","specialMatch","special","substr","dollarMatch","obj","which","wrapper","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","isStatic","Mustache__proto__","unreference","register","rebindMatch","unregister","addShuffleRegister","Object","Interpolator__proto__","safeToStringValue","string","data","Input__proto__","defaultValue","attrValue","specials","true","false","null","specialsPattern","numberPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","Parser","sp","postProcess","leftover","converters","parser","placeholder","matchPattern","number","stringLiteral","readStringLiteral","match","$1","matchString","pair","getKeyValuePair","valueToken","read","Mapping","Mapping__proto__","joinKey","createMapping","boundFragment","Option__proto__","selectedAttribute","yielder","container","tx","refName","partialFromValue","partial","createFragment","initMacro","dirtyTemplate","externalChange","refreshAttrs","_attrs","handle","fnTemplate","getPartialTemplate","unbindAttrs","_cssDef","applied","applyCSS","aliases","dirtyAttrs","invalidate","extras","isKey","deps","links","KeyModel__proto__","shouldCapture","has","relinking","dependant","registerLink","unregisterLink","reference","findDelegate","z","ks","isIteration","newValues","newValue","oldValue","oldValues","strict","isEqual","wildcards","pattern","updateOld","PatternObserver__proto__","notify","changed","baseModel","touchedFrom","count","recursive","joinAll","isLink","ok","baseKeypath","findMatches","check","addObserver","defer","ArrayObserver","pending","sliced","dispatch","ArrayObserver__proto__","_observers","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","adaptConfigurator","Parent","adapt","combine","ensureArray","selectorsPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","SharedModel","CSSModel__proto__","downstreamChanged","depth","_cssModel","mark","applyChanges","hasCurly","cssConfigurator","Child","_cssIds","gatherIds","css","initCSS","dataConfigurator","_r_unbound","templateConfigurator","parseTemplate","TEMPLATE_VERSION","getDynamicTemplate","_config","p","extendPartials","registryNames","registriesOnDefaults","Registry","useDefaults","Registry__proto__","configure","registry","isOwner","registries","putInDefaults","config","order","c","custom","computed","defaultKeys","isStandardKey","makeObj","isBlacklisted","_super","Item__proto__","ContainerItem__proto__","ComputationChild","Model","syncComputedChildren","prototypeAccessors$1","ComputationChild__proto__","dependencies","parentValue","newWrapperValue","unwrap","boundValue","marked","childByKey","child","Computation","signature","setter","prototypeAccessors$2","Computation__proto__","old","active","notifyUpstream","maybeBind","shouldBind","noVirtual","startCapturing","getter","hasConsole","console","groupCollapsed","sig","error","getterUseStack","stack","groupEnd","stopCapturing","setDependencies","ExpressionProxy","allowExpressions","ExpressionProxy__proto__","actuallyChanged","d","retrieve","dep","computation","ReferenceExpressionChild","ReferenceExpressionChild__proto__","missing","ReferenceExpressionProxy","intermediary","members","addShuffleTask","REFERENCE","ReferenceExpressionProxy__proto__","String","oneway","findBoundValue","Alias__proto__","resolveAliases","space","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","div","ConditionalAttribute__proto__","isSvg","parseAttributes","notIn","updateDelegate","Attribute__proto__","booleanAttributes","namespaces","useProperty","isBoolean","lookupNamespace","getUpdateDelegate","flag","bubbler","BindingFlag__proto__","createComment","teardownHook","destructHook","RactiveModel","RactiveModel__proto__","initLink","specialModels","@this","getRactiveModel","@global","GlobalModel","@shared","@style","@helpers","getHelpers","RootModel","RootModel__proto__","attached","attachImplicits","createLink","targetPath","detachImplicits","virtual","getVirtual","SharedBase","ractiveModel","getValueChildren","_link","unescapedKey","shouldTeardown","constructHook","protoRegistries","uid","ComponentConstructor","isAnchor","content","_partials","addChild","construct","mappings","_inlinePartials","eventHandlers","Component__proto__","initialise","getRactiveContext","checking","checkAnchors","callRender","isolated","unrenderItem","missingDecorator","Decorator__proto__","warnOnce","teardownArgsFn","Doctype__proto__","ModelBase__proto__","updateFromBindings","cascade","captureGroup","Missing","shufle","LinkModel","ModelBase","sourcePath","LinkModel__proto__","from","mapping","isDetached","force","markedAll","notifiedUpstream","startPath","rootLink","relinked","shuffling","lnk","implicit","fireShuffleTasks","ln","functions","leadingWhitespace","ParseError","lineStart","lines","lineEnds","line","lineEnd","remaining","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","msg","character","shortMessage","substring","nextChar","charAt","readTypeOf","INVERTED","CLOSING","DELIMCHANGE","CLOSING_TAG","INLINE_PARTIAL","NUMBER_LITERAL","STRING_LITERAL","ARRAY_LITERAL","OBJECT_LITERAL","BOOLEAN_LITERAL","REGEXP_LITERAL","GLOBAL","KEY_VALUE_PAIR","REFINEMENT","MEMBER","PREFIX_OPERATOR","BRACKETED","CONDITIONAL","INFIX_OPERATOR","INVOCATION","ELSE","ELSEIF","THEN","CATCH","delimiterChangePattern","whitespacePattern","regexpPattern","regExpCache","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","expectedExpression","expectedParen","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","singleMatcher","makeQuotedStringMatcher","doubleMatcher","escapes","spreadPattern","legalReference","relaxedName","identifier","globals","keywords","prefixPattern","makePrefixSequenceMatcher","symbol","fallthrough","expression","readExpression","matcher","prefixOperators","readMemberOrInvocation","readLogicalOr","readTypeof","makeInfixSequenceMatcher","inUnquotedAttribute","left","right","infixOperators","readLogicalOr$1","attributeNamePattern","onPattern","eventPattern","reservedEventNames","decoratorPattern","transitionPattern","boundPattern","directives","no-delegation","unquotedAttributeValueTextPattern","proxyEvent","whitespace","slashes","delimiterChangeToken","exclude","legalAlias","asRE","patterns","else","elseif","catch","types","handlebarsBlockCodes","each","if","with","unless","indexRefPattern","keyIndexRefPattern","handlebarsBlockPattern","OPEN_COMMENT","CLOSE_COMMENT","leadingLinebreak","trailingLinebreak","contiguousWhitespace","preserveWhitespaceElements","trailingWhitespace","leadingNewLine","trailingNewLine","closingTagPattern","tagNamePattern","anchorPattern","validTagNameFollower","disallowedContents","li","dt","dd","rt","rp","optgroup","thead","tbody","tfoot","tr","td","th","inlines","partialDefinitionSectionPattern","STANDARD_READERS","readPartial","readUnescaped","readSection","readInterpolator","readMustacheComment","TRIPLE_READERS","readTriple","READERS","readMustache","readHtmlComment","readElement","readText","PARTIAL_READERS","readPartialDefinitionSection","defaultInterpolate","StandardParser","tripleDelimiters","staticDelimiters","staticTripleDelimiters","standardDelimiters","delimiters","tags","isTriple","open","close","readers","sortMustacheTags","sectionDepth","elementStack","sanitize","elements","eventAttributes","stripComments","preserveWhitespace","sanitizeElements","sanitizeEventAttributes","includeLinePositions","textOnlyMode","csp","inTag","expr","flattenExpression","fromExpression","cleanup","insertExpressions","readTemplate","b","parseOptions","TEMPLATE_INSTRUCTIONS","COMPUTATION_INSTRUCTIONS","fromId","id","noThrow","getElementById","textContent","isParsed","getParseOptions","reduce","throwNoParse","addFunctions","parseFor","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","TransitionManager__proto__","list","decrementOutros","decrementTotal","detachNodes","_detachNodes","ready","detachImmediate","batch","fulfilPromise","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","observer","thing","task","postRender","_batch","tickers","running","performance","now","requestAnimationFrame","tick","Ticker__proto__","elapsed","eased","stop","abort","prefixers","ticker","Model__proto__","rewrap","createBranch","adaptor","wrap","getPrefixer","__model","isObjectLike","getComputationSignature","branch","lastLink","markForce","buildNewIndices","recreateArray","unsafe","SharedModel__proto__","SharedModel$1","global","window","ContextModel","FakeFragment","star","deepOpts","comparators","errorMessage","initStars","bubbleStars","method","arg","attachHook","detachHook","arrayProto","updateHook","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","ContextData__proto__","prototypeAccessors","_data","Context__proto__","num","build","findModel","protoAnimate","getParent","hasListener","findEvent","there","here","listen","raise","ev","drop","unlisten","protoUpdate","isBound","getBindingModel","getBindingPath","getBinding","setBinding","forRactive","methodNames","unprefixed","prefixed","j","makeFunction","query","mathml","xlink","xml","xmlns","ns","createElementNS","methodName","cloneNode","insertHook","Observer","oldContext","oldFn","Observer__proto__","cancelled","resolver","PatternObserver","registerPatternObserver","unregisterPatternObserver","required","all","optional","mapAll","tpl","_attributePartial","meta","nameOption","renderItem","contains","lastBound","updateAnchors","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","nameAttr","currentTarget","endEl","correspondingUseElement","text","splitText","createTextNode","readKey","childData","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","self","contextifyTemplate","okToParse","parsePartial","setTemplate","initing","aliasLocal","findFirstNode","out","frags","section","hasIndexRef","selectedOption","selectedIndex","firstChild","getComponentConstructor","asyncProxy","cmp","extract","success","undef","rx","ctor","guid","counter","placeholderId","newModel","hookQueue","childQueue","userOptions","subscribe","getElement","append","logIfDebug","cssId","__ractive_instances__","torndown","Ractive$render","others","Ractive$reset","rerender","changes","collect","collection","Ractive$resetTemplate","external","Ractive$set","Ractive$subtract","Ractive$toggle","TypeError","badArguments","gather","Ractive$toCSS","uniqueCssIds","ids","Ractive$toHTML","Ractive$transition","HTMLElement","Ractive$unrender","Ractive$updateModel","plugins","object","buildCSS","transform","recomputeCSS","extendOne","Class","Target","_on","toPairs","_observe","splitKeypathI","sourcesLength","sources","nextSource","nextKey","hasOwnProperty","thisArg","arrayLength","Node","nowOffset","Date","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","fulfill","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","promises","processPromise","reason","called","resolvePromise","y","rejectPromise","cancelAnimationFrame","lastTime","currentTime","timeToNextCall","Math","log","printWarning","welcome","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","noCssTransform","easeIn","pow","easeOut","easeInOut","implementation","hasFeature","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","intermediate","min","properties","loop","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","fnBind","Function","shuffleTasks","early","registerQueue","stage","existingMatches","objectKeys","badReference","shouldWarn","initialFragment","findIter","_fakeFragment","pairs","deep","deepSet","getComparator","sets","Ractive$add","immediate","getOptions","Ractive$animate","enqueue","_eventQueue","dequeue","variants","parts","eventNames","_nsSubs","fireEventAs","initialFire","_subs","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","findAnchors","findAnchorsIn","anchors","idxs","_children","byName","unrenderChild","prepend","insertAt","@this.parent","@this.root","last","Ractive$compute","comp","first","Ractive$detach","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","orComponent","getNewIndices","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","startIndex","mdl","Ractive$update","Ractive$fire","Ractive$get","instances","staticContext","staticInfo","output","Ractive$insert","fireInsertHook","src","isUpstream","fresh","vals","olds","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","subs","entry","Ractive$on","Ractive$once","listener","canonical","styleDefinition","styleSheet","cssText","filteredStyleDefinitions","getElementsByTagName","cleanCss","additionalReplaceRules","reconstruct","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","transformCss","dataAttr","selectors","s4","floor","random","uuid","setCSSData","local","def","evalCSS","transformCSS","__proto__","cssProp","validate","emptyData","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","parseAsString","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","member","RactiveProto","wrapPrototype","camelCaseStr","readStyle","rule","rules","readClass","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","wasChecked","valueAttribute","setProperty","getPropertyValue","className","baseVal","getAttributeNS","removeAttributeNS","setAttributeNS","haystack","needle","qualified","hasAttribute","Ractive$teardown","getPromise","single","initialiseProperties","handleAttributes","getAdaptors","protoAdapt","lookup","srcs","isFinite","format","registryName","interpol","lastItem","arrays","arrayLike","one","two","oldArray","newArray","oldLength","usedIndices","firstUnusedIndex","upstream","isKeypath","findAlias","alias","body","createFunction","exp","readDelimiterChange","opening","closing","readNumberLiteral","escapeRegExp","getLowestIndex","needles","search","entity","code","parseInt","validateCode","readBooleanLiteral","okQuote","literal","done","charCodeAt","JSON","quote","escapeChar","readTemplateStringLiteral","token","namePattern","readKeyValuePair","spread","refKey","readKeyValuePairs","keyValuePairs","readObjectLiteral","readArrayLiteral","expressionList","readExpressionList","readLiteral","readRegexpLiteral","readReference","lastDotIndex","startPos","relaxedNames","actual","inEvent","lastIndexOf","refLength","readBracketedExpression","readPrimary","readRefinement","strictRefinement","refinement","getConditional","ifTrue","ifFalse","readConditional","isSpread","expressions","readExpressionOrReference","expectedFollowers","getVars","vars","stringify","hasSpread","makeSpread","stringifyPair","extractRefs","stringified","refineExpression","mustache","referenceExpression","getReferenceExpression","splitEvent","readAttribute","nearest","readAttributeValue","valueStart","startDepth","readQuotedAttributeValue","readUnquotedAttributeValue","readUnquotedAttributeValueToken","tokens","quoteMark","readQuotedStringToken","readAttributeOrDirective","readArguments","readProxyEvent","spreadArgs","inside","readMustacheOfType","tag","reader","rewind","triple","readAliases","readAlias","readComment","readClosing","readInlineBlock","nm","hasElse","block","unlessBlock","closed","expectedClose","hasThen","hasCatch","inlineThen","aliasOnly","extra","endIndex","comment","stripStandalones","backOne","backTwo","lastSectionItem","isComment","isSection","trimWhitespace","leadingPattern","trailingPattern","removeLeadingWhitespace","removeTrailingWhitespace","previousItem","nextItem","preserveWhitespaceInsideFragment","removeLeadingWhitespaceInsideFragment","removeTrailingWhitespaceInsideFragment","isPreserveWhitespaceElement","readClosingTag","selfClosing","hasPartials","closingTag","lowerCaseName","canContain","closingTagName","readAnchorClose","readInline","disallowed","barrier","isExpression","addTo","hasChildren","instructions","createFunctionFromString","bindTo","getterString","setterString","tm","notifiedTotal","manager","trans","collectAllOutros","_list","prefixKeypath","rootKeypath","rootDot","relativeKeypath","explicitContext","repeater"],"mappings":"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"}