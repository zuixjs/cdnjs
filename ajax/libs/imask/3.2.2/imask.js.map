{"version":3,"file":"imask.js","sources":["../node_modules/core-js/modules/_defined.js","../node_modules/core-js/modules/_to-object.js","../node_modules/core-js/modules/_has.js","../node_modules/core-js/modules/_cof.js","../node_modules/core-js/modules/_iobject.js","../node_modules/core-js/modules/_to-iobject.js","../node_modules/core-js/modules/_to-integer.js","../node_modules/core-js/modules/_to-length.js","../node_modules/core-js/modules/_to-absolute-index.js","../node_modules/core-js/modules/_array-includes.js","../node_modules/core-js/modules/_global.js","../node_modules/core-js/modules/_shared.js","../node_modules/core-js/modules/_uid.js","../node_modules/core-js/modules/_shared-key.js","../node_modules/core-js/modules/_object-keys-internal.js","../node_modules/core-js/modules/_enum-bug-keys.js","../node_modules/core-js/modules/_object-keys.js","../node_modules/core-js/modules/_core.js","../node_modules/core-js/modules/_is-object.js","../node_modules/core-js/modules/_an-object.js","../node_modules/core-js/modules/_fails.js","../node_modules/core-js/modules/_descriptors.js","../node_modules/core-js/modules/_dom-create.js","../node_modules/core-js/modules/_ie8-dom-define.js","../node_modules/core-js/modules/_to-primitive.js","../node_modules/core-js/modules/_object-dp.js","../node_modules/core-js/modules/_property-desc.js","../node_modules/core-js/modules/_hide.js","../node_modules/core-js/modules/_redefine.js","../node_modules/core-js/modules/_a-function.js","../node_modules/core-js/modules/_ctx.js","../node_modules/core-js/modules/_export.js","../node_modules/core-js/modules/_object-sap.js","../node_modules/core-js/modules/es6.object.keys.js","../node_modules/core-js/fn/object/keys.js","../node_modules/core-js/modules/_string-repeat.js","../node_modules/core-js/modules/es6.string.repeat.js","../node_modules/core-js/fn/string/repeat.js","../node_modules/core-js/modules/_string-pad.js","../node_modules/core-js/modules/_user-agent.js","../node_modules/core-js/modules/es7.string.pad-start.js","../node_modules/core-js/fn/string/pad-start.js","../node_modules/core-js/modules/es7.string.pad-end.js","../node_modules/core-js/fn/string/pad-end.js","../src/core/utils.js","../src/core/action-details.js","../src/core/change-details.js","../src/masked/base.js","../src/masked/factory.js","../src/masked/pattern/definition.js","../src/masked/pattern/group.js","../src/masked/pattern/chunk-tail-details.js","../src/masked/pattern.js","../src/masked/date.js","../src/controls/input.js","../src/masked/number.js","../src/masked/regexp.js","../src/masked/function.js","../src/masked/dynamic.js","../src/imask.js"],"sourcesContent":["// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function (key) {\n  return store[key] || (store[key] = {});\n};\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","var core = module.exports = { version: '2.5.5' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var global = require('./_global');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar SRC = require('./_uid')('src');\nvar TO_STRING = 'toString';\nvar $toString = Function[TO_STRING];\nvar TPL = ('' + $toString).split(TO_STRING);\n\nrequire('./_core').inspectSource = function (it) {\n  return $toString.call(it);\n};\n\n(module.exports = function (O, key, val, safe) {\n  var isFunction = typeof val == 'function';\n  if (isFunction) has(val, 'name') || hide(val, 'name', key);\n  if (O[key] === val) return;\n  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if (O === global) {\n    O[key] = val;\n  } else if (!safe) {\n    delete O[key];\n    hide(O, key, val);\n  } else if (O[key]) {\n    O[key] = val;\n  } else {\n    hide(O, key, val);\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString() {\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar hide = require('./_hide');\nvar redefine = require('./_redefine');\nvar ctx = require('./_ctx');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n  var key, own, out, exp;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if (target) redefine(target, key, out, type & $export.U);\n    // export\n    if (exports[key] != out) hide(exports, key, exp);\n    if (IS_PROTO && expProto[key] != out) expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/_core').Object.keys;\n","'use strict';\nvar toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n\nmodule.exports = function repeat(count) {\n  var str = String(defined(this));\n  var res = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError(\"Count can't be negative\");\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) res += str;\n  return res;\n};\n","var $export = require('./_export');\n\n$export($export.P, 'String', {\n  // 21.1.3.13 String.prototype.repeat(count)\n  repeat: require('./_string-repeat')\n});\n","require('../../modules/es6.string.repeat');\nmodule.exports = require('../../modules/_core').String.repeat;\n","// https://github.com/tc39/proposal-string-pad-start-end\nvar toLength = require('./_to-length');\nvar repeat = require('./_string-repeat');\nvar defined = require('./_defined');\n\nmodule.exports = function (that, maxLength, fillString, left) {\n  var S = String(defined(that));\n  var stringLength = S.length;\n  var fillStr = fillString === undefined ? ' ' : String(fillString);\n  var intMaxLength = toLength(maxLength);\n  if (intMaxLength <= stringLength || fillStr == '') return S;\n  var fillLen = intMaxLength - stringLength;\n  var stringFiller = repeat.call(fillStr, Math.ceil(fillLen / fillStr.length));\n  if (stringFiller.length > fillLen) stringFiller = stringFiller.slice(0, fillLen);\n  return left ? stringFiller + S : S + stringFiller;\n};\n","var global = require('./_global');\nvar navigator = global.navigator;\n\nmodule.exports = navigator && navigator.userAgent || '';\n","'use strict';\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = require('./_export');\nvar $pad = require('./_string-pad');\nvar userAgent = require('./_user-agent');\n\n// https://github.com/zloirock/core-js/issues/280\n$export($export.P + $export.F * /Version\\/10\\.\\d+(\\.\\d+)? Safari\\//.test(userAgent), 'String', {\n  padStart: function padStart(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, true);\n  }\n});\n","require('../../modules/es7.string.pad-start');\nmodule.exports = require('../../modules/_core').String.padStart;\n","'use strict';\n// https://github.com/tc39/proposal-string-pad-start-end\nvar $export = require('./_export');\nvar $pad = require('./_string-pad');\nvar userAgent = require('./_user-agent');\n\n// https://github.com/zloirock/core-js/issues/280\n$export($export.P + $export.F * /Version\\/10\\.\\d+(\\.\\d+)? Safari\\//.test(userAgent), 'String', {\n  padEnd: function padEnd(maxLength /* , fillString = ' ' */) {\n    return $pad(this, maxLength, arguments.length > 1 ? arguments[1] : undefined, false);\n  }\n});\n","require('../../modules/es7.string.pad-end');\nmodule.exports = require('../../modules/_core').String.padEnd;\n","// @flow\r\n\r\n\r\n/** Checks if value is string */\r\nexport\r\nfunction isString (str: mixed): boolean %checks {\r\n  return typeof str === 'string' || str instanceof String;\r\n}\r\n\r\n/** Conforms string with fallback */\r\nexport\r\nfunction conform (res: ?string | boolean, str: string, fallback: string=''): string {\r\n  return isString(res) ?\r\n    res :\r\n    res ?\r\n      str :\r\n      fallback;\r\n}\r\n\r\n/**\r\n  Direction\r\n  @prop {number} NONE\r\n  @prop {number} LEFT\r\n  @prop {number} RIGHT\r\n*/\r\nexport\r\nconst DIRECTION = {\r\n  NONE: 0,\r\n  LEFT: -1,\r\n  RIGHT: 1\r\n}\r\n/**\r\n  Direction\r\n  @enum {number}\r\n*/\r\nexport\r\ntype Direction = $Values<typeof DIRECTION>;\r\n\r\n/** Returns next char position in direction */\r\nexport\r\nfunction indexInDirection (pos: number, direction: Direction): number {\r\n  if (direction === DIRECTION.LEFT) --pos;\r\n  return pos;\r\n}\r\n\r\n/** Escapes regular expression control chars */\r\nexport\r\nfunction escapeRegExp (str: string): string {\r\n  return str.replace(/([.*+?^=!:${}()|[\\]/\\\\])/g, '\\\\$1');\r\n}\r\n\r\n\r\n// cloned from https://github.com/epoberezkin/fast-deep-equal with small changes\r\nexport\r\nfunction objectIncludes (b: any, a: any): boolean {\r\n  if (a === b) return true;\r\n\r\n  var arrA = Array.isArray(a)\r\n    , arrB = Array.isArray(b)\r\n    , i;\r\n\r\n  if (arrA && arrB) {\r\n    if (a.length != b.length) return false;\r\n    for (i = 0; i < a.length; i++)\r\n      if (!objectIncludes(a[i], b[i])) return false;\r\n    return true;\r\n  }\r\n\r\n  if (arrA != arrB) return false;\r\n\r\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\r\n    var keys = Object.keys(a);\r\n    // if (keys.length !== Object.keys(b).length) return false;\r\n\r\n    var dateA = a instanceof Date\r\n      , dateB = b instanceof Date;\r\n    if (dateA && dateB) return a.getTime() == b.getTime();\r\n    if (dateA != dateB) return false;\r\n\r\n    var regexpA = a instanceof RegExp\r\n      , regexpB = b instanceof RegExp;\r\n    if (regexpA && regexpB) return a.toString() == b.toString();\r\n    if (regexpA != regexpB) return false;\r\n\r\n    for (i = 0; i < keys.length; i++)\r\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\r\n\r\n    for (i = 0; i < keys.length; i++)\r\n      if(!objectIncludes(a[keys[i]], b[keys[i]])) return false;\r\n\r\n    return true;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\n/* eslint-disable no-undef */\r\nexport\r\nconst g: any = typeof window !== 'undefined' && window ||\r\n  typeof global !== 'undefined' && global.global === global && global ||\r\n  typeof self !== 'undefined' && self.self === self && self ||\r\n  {};\r\n/* eslint-enable no-undef */\r\n\r\n/** Selection range */\r\nexport\r\ntype Selection = {\r\n  start: number;\r\n  end: number;\r\n};\r\n","// @flow\r\nimport {type Direction, type Selection, DIRECTION} from './utils.js';\r\n\r\n\r\n/** Provides details of changing input */\r\nexport default\r\nclass ActionDetails {\r\n  /** Current input value */\r\n  value: string;\r\n  /** Current cursor position */\r\n  cursorPos: number;\r\n  /** Old input value */\r\n  oldValue: string;\r\n  /** Old selection */\r\n  oldSelection: Selection;\r\n\r\n  constructor (\r\n    value: string,\r\n    cursorPos: number,\r\n    oldValue: string,\r\n    oldSelection: Selection\r\n  ) {\r\n    this.value = value;\r\n    this.cursorPos = cursorPos;\r\n    this.oldValue = oldValue;\r\n    this.oldSelection = oldSelection;\r\n\r\n    // double check if left part was changed (autofilling, other non-standard input triggers)\r\n    while (this.value.slice(0, this.startChangePos) !== this.oldValue.slice(0, this.startChangePos)) {\r\n      --this.oldSelection.start;\r\n    }\r\n  }\r\n\r\n  /**\r\n    Start changing position\r\n    @readonly\r\n  */\r\n  get startChangePos (): number {\r\n    return Math.min(this.cursorPos, this.oldSelection.start);\r\n  }\r\n\r\n  /**\r\n    Inserted symbols count\r\n    @readonly\r\n  */\r\n  get insertedCount (): number {\r\n    return this.cursorPos - this.startChangePos;\r\n  }\r\n\r\n  /**\r\n    Inserted symbols\r\n    @readonly\r\n  */\r\n  get inserted (): string {\r\n    return this.value.substr(this.startChangePos, this.insertedCount);\r\n  }\r\n\r\n  /**\r\n    Removed symbols count\r\n    @readonly\r\n  */\r\n  get removedCount (): number {\r\n    // Math.max for opposite operation\r\n    return Math.max((this.oldSelection.end - this.startChangePos) ||\r\n      // for Delete\r\n      this.oldValue.length - this.value.length, 0);\r\n  }\r\n\r\n  /**\r\n    Removed symbols\r\n    @readonly\r\n  */\r\n  get removed (): string {\r\n    return this.oldValue.substr(this.startChangePos, this.removedCount);\r\n  }\r\n\r\n  /**\r\n    Unchanged head symbols\r\n    @readonly\r\n  */\r\n  get head (): string {\r\n    return this.value.substring(0, this.startChangePos);\r\n  }\r\n\r\n  /**\r\n    Unchanged tail symbols\r\n    @readonly\r\n  */\r\n  get tail (): string {\r\n    return this.value.substring(this.startChangePos + this.insertedCount);\r\n  }\r\n\r\n  /**\r\n    Remove direction\r\n    @readonly\r\n  */\r\n  get removeDirection (): Direction {\r\n    if (!this.removedCount || this.insertedCount) return DIRECTION.NONE;\r\n\r\n    // align right if delete at right or if range removed (event with backspace)\r\n    return (this.oldSelection.end === this.cursorPos || this.oldSelection.start === this.cursorPos) ?\r\n      DIRECTION.RIGHT :\r\n      DIRECTION.LEFT;\r\n  }\r\n}\r\n","// @flow\r\n\r\n\r\n/**\r\n  Provides details of changing model value\r\n  @param {Object} [details]\r\n  @param {string} [details.inserted] - Inserted symbols\r\n  @param {boolean} [details.overflow] - Is overflowed\r\n  @param {number} [details.removeCount] - Removed symbols count\r\n  @param {number} [details.shift] - Additional offset if any changes occurred before current position\r\n*/\r\nexport default\r\nclass ChangeDetails {\r\n  /** Inserted symbols */\r\n  inserted: string;\r\n  /** Is overflowed */\r\n  overflow: boolean;\r\n  /** Additional offset if any changes occurred before current position */\r\n  shift: number;\r\n  _rawInserted: string;\r\n\r\n  constructor (details?: {\r\n    inserted?: $PropertyType<ChangeDetails, 'inserted'>,\r\n    overflow?: $PropertyType<ChangeDetails, 'overflow'>,\r\n    shift?: $PropertyType<ChangeDetails, 'shift'>,\r\n  }) {\r\n    Object.assign(this, {\r\n      inserted: '',\r\n      overflow: false,\r\n      shift: 0,\r\n    }, details);\r\n  }\r\n\r\n  /**\r\n    Aggregate changes\r\n    @returns {ChangeDetails} `this`\r\n  */\r\n  aggregate (details: ChangeDetails): ChangeDetails {\r\n    if (details.rawInserted) this.rawInserted += details.rawInserted;\r\n    this.inserted += details.inserted;\r\n    this.shift += details.shift;\r\n    this.overflow = this.overflow || details.overflow;\r\n    return this;\r\n  }\r\n\r\n  /** Total offset considering all changes */\r\n  get offset (): number {\r\n    return this.shift + this.inserted.length;\r\n  }\r\n\r\n  /** Raw inserted is used by dynamic mask */\r\n  get rawInserted (): string {\r\n    return this._rawInserted != null ?\r\n      this._rawInserted :\r\n      this.inserted;\r\n  }\r\n\r\n  set rawInserted (rawInserted: string): void {\r\n    this._rawInserted = rawInserted;\r\n  }\r\n}\r\n","// @flow\r\nimport ChangeDetails from '../core/change-details.js';\r\nimport {type Direction, DIRECTION} from '../core/utils.js';\r\nimport {type TailDetails} from '../core/tail-details.js';\r\n\r\n\r\n/** Supported mask type */\r\nexport\r\ntype Mask = string | String | RegExp | Class<Number> | Class<Date> | Array<any> | Function | Masked<*> | Class<Masked<*>>;\r\n\r\n/** Append flags */\r\nexport\r\ntype AppendFlags = {\r\n  input?: boolean,\r\n  tail?: boolean,\r\n  raw?: boolean\r\n};\r\n\r\n/** Extract flags */\r\nexport\r\ntype ExtractFlags = {\r\n  raw?: boolean\r\n};\r\n\r\nexport\r\ntype MaskedOptions<MaskType> = {\r\n  mask: $PropertyType<Masked<MaskType>, 'mask'>,\r\n  prepare?: $PropertyType<Masked<MaskType>, 'prepare'>,\r\n  validate?: $PropertyType<Masked<MaskType>, 'validate'>,\r\n  commit?: $PropertyType<Masked<MaskType>, 'commit'>,\r\n};\r\n\r\n\r\n/** Provides common masking stuff */\r\nexport default\r\nclass Masked<MaskType> {\r\n  static DEFAULTS: any; // $Shape<MaskedOptions>; TODO after fix https://github.com/facebook/flow/issues/4773\r\n\r\n  /** @type {Mask} */\r\n  mask: MaskType;\r\n  /** Transforms value before mask processing */\r\n  prepare: (string, Masked<MaskType>, AppendFlags) => string;\r\n  /** Validates if value is acceptable */\r\n  validate: (string, Masked<MaskType>, AppendFlags) => boolean;\r\n  /** Does additional processing in the end of editing */\r\n  commit: (string, AppendFlags) => void;\r\n  /** */\r\n  isInitialized: boolean;\r\n  _value: string;\r\n  _refreshing: boolean;\r\n\r\n  constructor (opts: {[string]: any}) {\r\n    this._value = '';\r\n    this._update({\r\n      ...Masked.DEFAULTS,\r\n      ...opts\r\n    });\r\n    this.isInitialized = true;\r\n  }\r\n\r\n  /** Sets and applies new options */\r\n  updateOptions (opts: {[string]: any}) {\r\n    this.withValueRefresh(this._update.bind(this, opts));\r\n  }\r\n\r\n  /**\r\n    Sets new options\r\n    @protected\r\n  */\r\n  _update (opts: {[string]: any}) {\r\n    Object.assign(this, opts);\r\n  }\r\n\r\n  /** Clones masked with options and value */\r\n  clone (): Masked<MaskType> {\r\n    const m = new Masked(this);\r\n    m._value = this.value.slice();\r\n    return m;\r\n  }\r\n\r\n  /** */\r\n  assign (source: Masked<MaskType>): Masked<MaskType> {\r\n    // $FlowFixMe\r\n    return Object.assign(this, source);\r\n  }\r\n\r\n  /** Resets value */\r\n  reset () {\r\n    this._value = '';\r\n  }\r\n\r\n  /** */\r\n  get value (): string {\r\n    return this._value;\r\n  }\r\n\r\n  set value (value: string) {\r\n    this.resolve(value);\r\n  }\r\n\r\n  /** Resolve new value */\r\n  resolve (value: string): string {\r\n    this.reset();\r\n    this._append(value, {input: true});\r\n    this._appendTail();\r\n    this.doCommit();\r\n    return this.value;\r\n  }\r\n\r\n  /** */\r\n  get unmaskedValue (): string {\r\n    return this.value;\r\n  }\r\n\r\n  set unmaskedValue (value: string) {\r\n    this.reset();\r\n    this._append(value);\r\n    this._appendTail();\r\n    this.doCommit();\r\n  }\r\n\r\n  /** Value that includes raw user input */\r\n  get rawInputValue (): string {\r\n    return this.extractInput(0, this.value.length, {raw: true});\r\n  }\r\n\r\n  set rawInputValue (value: string) {\r\n    this.reset();\r\n    this._append(value, {raw: true});\r\n    this._appendTail();\r\n    this.doCommit();\r\n  }\r\n\r\n  /** */\r\n  get isComplete (): boolean {\r\n    return true;\r\n  }\r\n\r\n  /** Finds nearest input position in direction */\r\n  nearestInputPos (cursorPos: number, direction?: Direction): number {\r\n    return cursorPos;\r\n  }\r\n\r\n  /** Extracts value in range considering flags */\r\n  extractInput (fromPos: number=0, toPos: number=this.value.length, flags?: ExtractFlags): string {\r\n    return this.value.slice(fromPos, toPos);\r\n  }\r\n\r\n  /** Extracts tail in range */\r\n  _extractTail (fromPos: number=0, toPos: number=this.value.length): TailDetails {\r\n    return {\r\n      value: this.extractInput(fromPos, toPos),\r\n      fromPos,\r\n      toPos,\r\n    };\r\n  }\r\n\r\n  /** Appends tail */\r\n  _appendTail (tail?: TailDetails): ChangeDetails {\r\n    return this._append(tail ? tail.value: '', {tail: true});\r\n  }\r\n\r\n  /** Appends symbols considering flags */\r\n  _append (str: string, flags: AppendFlags={}): ChangeDetails {\r\n    const oldValueLength = this.value.length;\r\n    let consistentValue: Masked<MaskType> = this.clone();\r\n    let overflow = false;\r\n\r\n    str = this.doPrepare(str, flags);\r\n\r\n    for (let ci=0; ci<str.length; ++ci) {\r\n      this._value += str[ci];\r\n      if (this.doValidate(flags) === false) {\r\n        this.assign(consistentValue);\r\n        if (!flags.input) {\r\n          // in `input` mode dont skip invalid chars\r\n          overflow = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      consistentValue = this.clone();\r\n    }\r\n\r\n    return new ChangeDetails({\r\n      inserted: this.value.slice(oldValueLength),\r\n      overflow\r\n    });\r\n  }\r\n\r\n  /** Appends symbols considering tail */\r\n  appendWithTail (str: string, tail: TailDetails): ChangeDetails {\r\n    // TODO refactor\r\n    const aggregateDetails = new ChangeDetails();\r\n    let consistentValue = this.clone();\r\n    let consistentAppended: Masked<MaskType>;\r\n\r\n    for (let ci=0; ci<str.length; ++ci) {\r\n      const ch = str[ci];\r\n\r\n      const appendDetails = this._append(ch, {input: true});\r\n      consistentAppended = this.clone();\r\n      const tailAppended = !appendDetails.overflow && !this._appendTail(tail).overflow;\r\n      if (!tailAppended || this.doValidate({tail: true}) === false) {\r\n        this.assign(consistentValue);\r\n        break;\r\n      }\r\n\r\n      this.assign(consistentAppended);\r\n      consistentValue = this.clone();\r\n      aggregateDetails.aggregate(appendDetails);\r\n    }\r\n\r\n    // TODO needed for cases when\r\n    // 1) REMOVE ONLY AND NO LOOP AT ALL\r\n    // 2) last loop iteration removes tail\r\n    // 3) when breaks on tail insert\r\n\r\n    // aggregate only shift from tail\r\n    aggregateDetails.shift += this._appendTail(tail).shift;\r\n\r\n    return aggregateDetails;\r\n  }\r\n\r\n  /** */\r\n  remove (from: number=0, count: number=this.value.length-from): ChangeDetails {\r\n    this._value = this.value.slice(0, from) + this.value.slice(from + count);\r\n    return new ChangeDetails();\r\n  }\r\n\r\n  /** Calls function and reapplies current value */\r\n  withValueRefresh<T>(fn: () => T): T {\r\n    if (this._refreshing || !this.isInitialized) return fn();\r\n    this._refreshing = true;\r\n\r\n    const unmasked = this.unmaskedValue;\r\n\r\n    const ret = fn();\r\n\r\n    this.unmaskedValue = unmasked;\r\n\r\n    delete this._refreshing;\r\n    return ret;\r\n  }\r\n\r\n  /**\r\n    Prepares string before mask processing\r\n    @protected\r\n  */\r\n  doPrepare (str: string, flags: AppendFlags={}): string {\r\n    return this.prepare(str, this, flags);\r\n  }\r\n\r\n  /**\r\n    Validates if value is acceptable\r\n    @protected\r\n  */\r\n  doValidate (flags: AppendFlags): boolean {\r\n    return this.validate(this.value, this, flags);\r\n  }\r\n\r\n  /**\r\n    Does additional processing in the end of editing\r\n    @protected\r\n  */\r\n  doCommit () {\r\n    this.commit(this.value, this);\r\n  }\r\n\r\n  // TODO\r\n  // insert (str, fromPos, flags)\r\n\r\n  /** */\r\n  splice (start: number, deleteCount: number, inserted: string, removeDirection: Direction): ChangeDetails {\r\n    const tailPos: number = start + deleteCount;\r\n    const tail: TailDetails = this._extractTail(tailPos);\r\n\r\n    let startChangePos: number = this.nearestInputPos(start, removeDirection);\r\n    const changeDetails: ChangeDetails = new ChangeDetails({\r\n      shift: startChangePos - start  // adjust shift if start was aligned\r\n    }).aggregate(this.remove(startChangePos))\r\n      .aggregate(this.appendWithTail(inserted, tail));\r\n\r\n    return changeDetails;\r\n  }\r\n}\r\nMasked.DEFAULTS = {\r\n  prepare: val => val,\r\n  validate: () => true,\r\n  commit: () => {},\r\n};\r\n","// @flow\r\nimport {g, isString} from '../core/utils.js';\r\nimport type Masked from './base.js';\r\nimport {type Mask} from './base.js';\r\n\r\n\r\n/** Get Masked class by mask type */\r\nexport\r\nfunction maskedClass (mask: Mask): Class<Masked<*>> {\r\n  if (mask == null) {\r\n    throw new Error('mask property should be defined');\r\n  }\r\n\r\n  if (mask instanceof RegExp) return g.IMask.MaskedRegExp;\r\n  if (isString(mask)) return g.IMask.MaskedPattern;\r\n  if (mask instanceof Date || mask === Date) return g.IMask.MaskedDate;\r\n  if (mask instanceof Number || typeof mask === 'number' || mask === Number) return g.IMask.MaskedNumber;\r\n  if (Array.isArray(mask) || mask === Array) return g.IMask.MaskedDynamic;\r\n  // $FlowFixMe\r\n  if (mask.prototype instanceof g.IMask.Masked) return mask;\r\n  // $FlowFixMe\r\n  if (mask instanceof Function) return g.IMask.MaskedFunction;\r\n\r\n  console.warn('Mask not found for mask', mask);  // eslint-disable-line no-console\r\n  return g.IMask.Masked;\r\n}\r\n\r\n/** Creates new {@link Masked} depending on mask type */\r\nexport default\r\nfunction createMask (opts: {mask: Mask}): Masked<*> {\r\n  opts = Object.assign({}, opts);  // clone\r\n  const mask = opts.mask;\r\n\r\n  if (mask instanceof g.IMask.Masked) return mask;\r\n\r\n  const MaskedClass = maskedClass(mask);\r\n  return new MaskedClass(opts);\r\n}\r\n","// @flow\r\nimport createMask from '../factory.js';\r\nimport type Masked from '../base.js';\r\nimport {type Mask} from '../base.js';\r\n\r\n\r\ntype Definitions = {[string]: Mask};\r\n/** */\r\ntype DefinitionType = $Values<typeof PatternDefinition.TYPES>;\r\ntype DefinitionTypes = {[string]: DefinitionType};\r\n\r\n/** */\r\nexport default\r\nclass PatternDefinition {\r\n  static TYPES: DefinitionTypes;\r\n  static DEFAULTS: Definitions;\r\n\r\n  /** */\r\n  char: ?string;\r\n  /** */\r\n  stopAlign: ?boolean;\r\n  /** */\r\n  optional: boolean;\r\n  /** */\r\n  isHollow: boolean;\r\n  /** */\r\n  isRawInput: boolean;\r\n  /** */\r\n  type: DefinitionType;\r\n  /** */\r\n  _masked: Masked<*>;\r\n\r\n  constructor(opts: any) {  // TODO flow\r\n    Object.assign(this, opts);\r\n\r\n    if (this.mask) {\r\n      this._masked = createMask(opts);\r\n    }\r\n  }\r\n\r\n  /** */\r\n  reset () {\r\n    this.isHollow = false;\r\n    this.isRawInput = false;\r\n    if (this._masked) this._masked.reset();\r\n  }\r\n\r\n  /** */\r\n  get isInput (): boolean {\r\n    return this.type === PatternDefinition.TYPES.INPUT;\r\n  }\r\n\r\n  /** */\r\n  get isHiddenHollow (): boolean {\r\n    return this.isHollow && this.optional;\r\n  }\r\n\r\n  /** */\r\n  resolve (ch: string): boolean | string {\r\n    if (!this._masked) return false;\r\n    return this._masked.resolve(ch);\r\n  }\r\n}\r\nPatternDefinition.DEFAULTS = {\r\n  '0': /\\d/,\r\n  'a': /[\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]/,  // http://stackoverflow.com/a/22075070\r\n  '*': /./\r\n};\r\n/**\r\n  @prop {string} INPUT\r\n  @prop {string} FIXED\r\n*/\r\nPatternDefinition.TYPES = {\r\n  INPUT: 'input',\r\n  FIXED: 'fixed'\r\n};\r\n","// @flow\r\nimport type MaskedPattern from '../pattern.js';\r\nimport {type AppendFlags} from '../base.js';\r\n\r\n\r\n/** */\r\nexport\r\ninterface PatternGroupTemplate {\r\n  validate: $PropertyType<PatternGroup, 'validate'>;\r\n  mask: $PropertyType<PatternGroup, 'mask'>;\r\n}\r\n\r\n/** */\r\ntype PatternGroupOptions = PatternGroupTemplate & {\r\n  name: $PropertyType<PatternGroup, 'name'>,\r\n  offset: $PropertyType<PatternGroup, 'offset'>,\r\n};\r\n\r\n/**\r\n  Pattern group symbols from parent\r\n  @param {MaskedPattern} masked - Internal {@link masked} model\r\n  @param {Object} opts\r\n  @param {string} opts.name - Group name\r\n  @param {number} opts.offset - Group offset in masked definitions array\r\n  @param {string} opts.mask - Group mask\r\n  @param {Function} [opts.validate] - Custom group validator\r\n*/\r\nexport default\r\nclass PatternGroup {\r\n  /** */\r\n  static Range: typeof RangeGroup;\r\n  /** */\r\n  static Enum: typeof EnumGroup;\r\n\r\n  /** Internal {@link masked} model */\r\n  masked: MaskedPattern;\r\n  /** Group name */\r\n  name: string;\r\n  /** Group offset in masked definitions array */\r\n  offset: number;\r\n  /** Group mask */\r\n  mask: string;\r\n  /** Custom group validator */\r\n  validate: (string, PatternGroup, AppendFlags) => boolean;\r\n\r\n  constructor(masked: MaskedPattern, {name, offset, mask, validate}: PatternGroupOptions) {\r\n    this.masked = masked;\r\n    this.name = name;\r\n    this.offset = offset;\r\n    this.mask = mask;\r\n    this.validate = validate || (() => true);\r\n  }\r\n\r\n  /** Slice of internal {@link masked} value */\r\n  get value (): string {\r\n    return this.masked.value.slice(\r\n      this.masked.mapDefIndexToPos(this.offset),\r\n      this.masked.mapDefIndexToPos(this.offset + this.mask.length));\r\n  }\r\n\r\n  /** Unmasked slice of internal {@link masked} value */\r\n  get unmaskedValue (): string {\r\n    return this.masked.extractInput(\r\n      this.masked.mapDefIndexToPos(this.offset),\r\n      this.masked.mapDefIndexToPos(this.offset + this.mask.length));\r\n  }\r\n\r\n  /** Validates if current value is acceptable */\r\n  doValidate (flags: AppendFlags) {\r\n    return this.validate(this.value, this, flags);\r\n  }\r\n}\r\n\r\n/**\r\n  Pattern group that validates number ranges\r\n  @param {number[]} range - [from, to]\r\n  @param {?number} maxlen - Maximum number length, will be padded with leading zeros\r\n*/\r\nexport\r\nclass RangeGroup implements PatternGroupTemplate {\r\n  /** @type {string} */\r\n  mask: $PropertyType<PatternGroup, 'mask'>;\r\n  /** @type {Function} */\r\n  validate: $PropertyType<PatternGroup, 'validate'>;\r\n  _maxLength: number;\r\n  _from: number;\r\n  _to: number;\r\n\r\n  constructor ([from, to]: [number, number], maxlen: number=String(to).length) {\r\n    this._from = from;\r\n    this._to = to;\r\n    this._maxLength = maxlen;\r\n    this.validate = this.validate.bind(this);\r\n\r\n    this._update();\r\n  }\r\n\r\n  get to (): number {\r\n    return this._to;\r\n  }\r\n\r\n  set to (to: number) {\r\n    this._to = to;\r\n    this._update();\r\n  }\r\n\r\n  get from (): number {\r\n    return this._from;\r\n  }\r\n\r\n  set from (from: number) {\r\n    this._from = from;\r\n    this._update();\r\n  }\r\n\r\n  get maxLength (): number {\r\n    return this._maxLength;\r\n  }\r\n\r\n  set maxLength (maxLength: number) {\r\n    this._maxLength = maxLength;\r\n    this._update();\r\n  }\r\n\r\n  get _matchFrom (): number {\r\n    return this.maxLength - String(this.from).length;\r\n  }\r\n\r\n  _update() {\r\n    this._maxLength = Math.max(this._maxLength, String(this.to).length);\r\n    this.mask = '0'.repeat(this._maxLength);\r\n  }\r\n\r\n  validate (str: string): boolean {\r\n    let minstr = '';\r\n    let maxstr = '';\r\n\r\n    const [, placeholder, num] = str.match(/^(\\D*)(\\d*)(\\D*)/) || [];\r\n    if (num) {\r\n      minstr = ('0'.repeat(placeholder.length) + num);\r\n      maxstr = ('9'.repeat(placeholder.length) + num);\r\n    }\r\n\r\n    const firstNonZero = str.search(/[^0]/);\r\n    if (firstNonZero === -1 && str.length <= this._matchFrom) return true;\r\n\r\n    minstr = minstr.padEnd(this._maxLength, '0');\r\n    maxstr = maxstr.padEnd(this._maxLength, '9');\r\n\r\n    return this.from <= Number(maxstr) && Number(minstr) <= this.to;\r\n  }\r\n}\r\n\r\n/** Pattern group that validates enum values */\r\nexport\r\nfunction EnumGroup (enums: Array<string>): PatternGroupTemplate {\r\n  return {\r\n    mask: '*'.repeat(enums[0].length),\r\n    validate: (value: string, group: PatternGroup, flags: AppendFlags) => enums.some(e => e.indexOf(group.unmaskedValue) >= 0)\r\n  };\r\n}\r\n\r\nPatternGroup.Range = RangeGroup;\r\nPatternGroup.Enum = EnumGroup;\r\n","// @flow\r\nimport {type TailDetails} from '../../core/tail-details.js';\r\n\r\n\r\nexport\r\ntype TailInputChunk = {\r\n  stop: ?number,\r\n  value: string\r\n};\r\n\r\nexport\r\nclass ChunksTailDetails implements TailDetails {\r\n  chunks: Array<TailInputChunk>;\r\n\r\n  constructor (chunks: Array<TailInputChunk>) {\r\n    this.chunks = chunks;\r\n  }\r\n\r\n  get value (): string {\r\n    return this.chunks.map(c => c.value).join('');\r\n  }\r\n\r\n  get fromPos (): ?number {\r\n    const firstChunk = this.chunks[0];\r\n    return firstChunk && firstChunk.stop;\r\n  }\r\n\r\n  get toPos (): ?number {\r\n    const lastChunk = this.chunks[this.chunks.length - 1];\r\n    return lastChunk && lastChunk.stop;\r\n  }\r\n}\r\n","// @flow\r\nimport {conform, DIRECTION, indexInDirection, type Direction} from '../core/utils.js';\r\nimport ChangeDetails from '../core/change-details.js';\r\nimport Masked, {type AppendFlags, type ExtractFlags, type MaskedOptions} from './base.js';\r\nimport PatternDefinition from './pattern/definition.js';\r\nimport PatternGroup, {type PatternGroupTemplate} from './pattern/group.js';\r\nimport {ChunksTailDetails, type TailInputChunk} from './pattern/chunk-tail-details.js';\r\nimport {type TailDetails} from '../core/tail-details.js';\r\n\r\n\r\ntype MaskedPatternOptions = {\r\n  ...MaskedOptions<string>,\r\n  definitions: $PropertyType<MaskedPattern, 'definitions'>,\r\n  groups: $PropertyType<MaskedPattern, 'groups'>,\r\n  placeholderChar: $PropertyType<MaskedPattern, 'placeholderChar'>,\r\n  lazy: $PropertyType<MaskedPattern, 'lazy'>,\r\n};\r\ntype InputChunk = [?number, string];\r\n\r\n\r\n/**\r\n  Pattern mask\r\n  @param {Object} opts\r\n  @param {Object} opts.groups\r\n  @param {Object} opts.definitions\r\n  @param {string} opts.placeholderChar\r\n  @param {boolean} opts.lazy\r\n*/\r\nexport default\r\nclass MaskedPattern extends Masked<string> {\r\n  static DEFAULTS: any;\r\n  static STOP_CHAR: string;\r\n  static ESCAPE_CHAR: string;\r\n  static Definition: Class<PatternDefinition>;\r\n  static Group: Class<PatternGroup>;\r\n\r\n  /** */\r\n  groups: {[string]: PatternGroupTemplate};\r\n  /** */\r\n  definitions: {[string]: any};  // TODO mask type\r\n  /** Single char for empty input */\r\n  placeholderChar: string;\r\n  /** Show placeholder only when needed */\r\n  lazy: boolean;\r\n  _charDefs: Array<PatternDefinition>;\r\n  _groupDefs: Array<PatternGroup>;\r\n\r\n  constructor (opts: any={}) {  // TODO type $Shape<MaskedPatternOptions>={} does not work\r\n    opts.definitions = Object.assign({}, PatternDefinition.DEFAULTS, opts.definitions);\r\n    super({\r\n      ...MaskedPattern.DEFAULTS,\r\n      ...opts\r\n    });\r\n  }\r\n\r\n  /**\r\n    @override\r\n    @param {Object} opts\r\n  */\r\n  _update (opts: $Shape<MaskedPatternOptions>={}) {\r\n    opts.definitions = Object.assign({}, this.definitions, opts.definitions);\r\n    super._update(opts);\r\n    this._rebuildMask();\r\n  }\r\n\r\n  /** */\r\n  _rebuildMask () {\r\n    const defs = this.definitions;\r\n    this._charDefs = [];\r\n    this._groupDefs = [];\r\n\r\n    let pattern = this.mask;\r\n    if (!pattern || !defs) return;\r\n\r\n    let unmaskingBlock = false;\r\n    let optionalBlock = false;\r\n    let stopAlign = false;\r\n\r\n    for (let i=0; i<pattern.length; ++i) {\r\n      if (this.groups) {\r\n        const p = pattern.slice(i);\r\n        const gNames = Object.keys(this.groups).filter(gName => p.indexOf(gName) === 0);\r\n        // order by key length\r\n        gNames.sort((a, b) => b.length - a.length);\r\n        // use group name with max length\r\n        const gName = gNames[0];\r\n        if (gName) {\r\n          const group = this.groups[gName];\r\n          this._groupDefs.push(new PatternGroup(this, {\r\n            name: gName,\r\n            offset: this._charDefs.length,\r\n            mask: group.mask,\r\n            validate: group.validate,\r\n          }));\r\n          pattern = pattern.replace(gName, group.mask);\r\n        }\r\n      }\r\n\r\n      let char = pattern[i];\r\n      let type = char in defs ?\r\n        PatternDefinition.TYPES.INPUT :\r\n        PatternDefinition.TYPES.FIXED;\r\n      const unmasking = type === PatternDefinition.TYPES.INPUT || unmaskingBlock;\r\n      const optional = type === PatternDefinition.TYPES.INPUT && optionalBlock;\r\n\r\n      if (char === MaskedPattern.STOP_CHAR) {\r\n        stopAlign = true;\r\n        continue;\r\n      }\r\n\r\n      if (char === '{' || char === '}') {\r\n        unmaskingBlock = !unmaskingBlock;\r\n        continue;\r\n      }\r\n\r\n      if (char === '[' || char === ']') {\r\n        optionalBlock = !optionalBlock;\r\n        continue;\r\n      }\r\n\r\n      if (char === MaskedPattern.ESCAPE_CHAR) {\r\n        ++i;\r\n        char = pattern[i];\r\n        if (!char) break;\r\n        type = PatternDefinition.TYPES.FIXED;\r\n      }\r\n\r\n      this._charDefs.push(new PatternDefinition({\r\n        char,\r\n        type,\r\n        optional,\r\n        stopAlign,\r\n        unmasking,\r\n        mask: type === PatternDefinition.TYPES.INPUT ?\r\n          defs[char] :\r\n          (value => value === char)\r\n      }));\r\n\r\n      stopAlign = false;\r\n    }\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  doValidate (...args: *) {\r\n    return this._groupDefs.every(g => g.doValidate(...args)) && super.doValidate(...args);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  clone () {\r\n    const m = new MaskedPattern(this);\r\n    m._value = this.value;\r\n    // $FlowFixMe\r\n    m._charDefs.forEach((d, i) => Object.assign(d, this._charDefs[i]));\r\n    // $FlowFixMe\r\n    m._groupDefs.forEach((d, i) => Object.assign(d, this._groupDefs[i]));\r\n    return m;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  reset () {\r\n    super.reset();\r\n    this._charDefs.forEach(d => {delete d.isHollow;});\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  get isComplete (): boolean {\r\n    return !this._charDefs.some((d, i) =>\r\n      d.isInput && !d.optional && (d.isHollow || !this.extractInput(i, i+1)));\r\n  }\r\n\r\n  /** */\r\n  hiddenHollowsBefore (defIndex: number): number {\r\n    return this._charDefs\r\n      .slice(0, defIndex)\r\n      .filter(d => d.isHiddenHollow)\r\n      .length;\r\n  }\r\n\r\n  /** Map definition index to position on view */\r\n  mapDefIndexToPos (defIndex: number): number {\r\n    return defIndex - this.hiddenHollowsBefore(defIndex);\r\n  }\r\n\r\n  /** Map position on view to definition index */\r\n  mapPosToDefIndex (pos: number): number {\r\n    let defIndex = pos;\r\n    for (let di=0; di<this._charDefs.length; ++di) {\r\n      const def = this._charDefs[di];\r\n      if (di >= defIndex) break;\r\n      if (def.isHiddenHollow) ++defIndex;\r\n    }\r\n    return defIndex;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  get unmaskedValue (): string {\r\n    const str = this.value;\r\n    let unmasked = '';\r\n\r\n    for (let ci=0, di=0; ci<str.length && di<this._charDefs.length; ++di) {\r\n      const ch = str[ci];\r\n      const def = this._charDefs[di];\r\n\r\n      if (def.isHiddenHollow) continue;\r\n      if (def.unmasking && !def.isHollow) unmasked += ch;\r\n      ++ci;\r\n    }\r\n\r\n    return unmasked;\r\n  }\r\n\r\n  set unmaskedValue (unmaskedValue: string) {\r\n    super.unmaskedValue = unmaskedValue;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _appendTail (tail?: ChunksTailDetails | TailDetails): ChangeDetails {\r\n    const details = new ChangeDetails();\r\n    if (tail) {\r\n      details.aggregate(tail instanceof ChunksTailDetails ?\r\n        this._appendChunks(tail.chunks, {tail: true}) :\r\n        super._appendTail(tail));\r\n    }\r\n    return details.aggregate(this._appendPlaceholder());\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _append (str: string, flags: AppendFlags={}): ChangeDetails {\r\n    const oldValueLength = this.value.length;\r\n    let rawInserted = '';\r\n    let overflow = false;\r\n\r\n    str = this.doPrepare(str, flags);\r\n\r\n    for (let ci=0, di=this.mapPosToDefIndex(this.value.length); ci < str.length;) {\r\n      const ch = str[ci];\r\n      const def = this._charDefs[di];\r\n\r\n      // check overflow\r\n      if (def == null) {\r\n        overflow = true;\r\n        break;\r\n      }\r\n\r\n      // reset\r\n      def.isHollow = false;\r\n\r\n      let resolved, skipped;\r\n      let chres = conform(def.resolve(ch), ch);\r\n\r\n      if (def.type === PatternDefinition.TYPES.INPUT) {\r\n        if (chres) {\r\n          this._value += chres;\r\n          if (!this.doValidate()) {\r\n            chres = '';\r\n            this._value = this.value.slice(0, -1);\r\n          }\r\n        }\r\n\r\n        resolved = !!chres;\r\n        skipped = !chres && !def.optional;\r\n\r\n        if (!chres) {\r\n          if (!def.optional && !flags.input && !this.lazy) {\r\n            this._value += this.placeholderChar;\r\n            skipped = false;\r\n          }\r\n          if (!skipped) def.isHollow = true;\r\n        } else {\r\n          rawInserted += chres;\r\n        }\r\n      } else {\r\n        this._value += def.char;\r\n        resolved = chres && (def.unmasking || flags.input || flags.raw) && !flags.tail;\r\n        def.isRawInput = resolved && (flags.raw || flags.input);\r\n        if (def.isRawInput) rawInserted += def.char;\r\n      }\r\n\r\n      if (!skipped) ++di;\r\n      if (resolved || skipped) ++ci;\r\n    }\r\n\r\n    return new ChangeDetails({\r\n      inserted: this.value.slice(oldValueLength),\r\n      rawInserted,\r\n      overflow\r\n    });\r\n  }\r\n\r\n  /** Appends chunks splitted by stop chars */\r\n  _appendChunks (chunks: Array<TailInputChunk>, ...args: *) {\r\n    const details = new ChangeDetails();\r\n    for (let ci=0; ci < chunks.length; ++ci) {\r\n      const {stop, value} = chunks[ci];\r\n      const fromDef = stop != null && this._charDefs[stop];\r\n      // lets double check if stopAlign is here\r\n      if (fromDef && fromDef.stopAlign) details.aggregate(this._appendPlaceholder(stop));\r\n      if (details.aggregate(this._append(value, ...args)).overflow) break;\r\n    }\r\n    return details;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _extractTail (fromPos: number=0, toPos: number=this.value.length): ChunksTailDetails {\r\n    return new ChunksTailDetails(this._extractInputChunks(fromPos, toPos));\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  extractInput (fromPos: number=0, toPos: number=this.value.length, flags: ExtractFlags={}): string {\r\n    if (fromPos === toPos) return '';\r\n\r\n    const str = this.value;\r\n    let input = '';\r\n\r\n    const toDefIndex = this.mapPosToDefIndex(toPos);\r\n    for (\r\n      let ci=fromPos, di=this.mapPosToDefIndex(fromPos);\r\n      ci<toPos && ci<str.length && di < toDefIndex;\r\n      ++di\r\n    ) {\r\n      const ch = str[ci];\r\n      const def = this._charDefs[di];\r\n\r\n      if (!def) break;\r\n      if (def.isHiddenHollow) continue;\r\n\r\n      if (def.isInput && !def.isHollow ||\r\n        flags.raw && !def.isInput && def.isRawInput) input += ch;\r\n      ++ci;\r\n    }\r\n    return input;\r\n  }\r\n\r\n  /** Extracts chunks from input splitted by stop chars */\r\n  _extractInputChunks (fromPos: number=0, toPos: number=this.value.length): Array<TailInputChunk> {\r\n    if (fromPos === toPos) return [];\r\n\r\n    const fromDefIndex = this.mapPosToDefIndex(fromPos);\r\n    const toDefIndex = this.mapPosToDefIndex(toPos);\r\n    const stopDefIndices = this._charDefs\r\n      .map((d, i) => [d, i])\r\n      .slice(fromDefIndex, toDefIndex)\r\n      .filter(([d]) => d.stopAlign)\r\n      .map(([, i]) => i);\r\n\r\n    const stops = [\r\n      fromDefIndex,\r\n      ...stopDefIndices,\r\n      toDefIndex\r\n    ];\r\n\r\n    return stops.map((s, i) => ({\r\n      stop: stopDefIndices.indexOf(s) >= 0 ?\r\n        s :\r\n        null,\r\n\r\n      value: this.extractInput(\r\n        this.mapDefIndexToPos(s),\r\n        this.mapDefIndexToPos(stops[++i]))\r\n    })).filter(({stop, value}) => stop != null || value);\r\n  }\r\n\r\n  /** Appends placeholder depending on laziness */\r\n  _appendPlaceholder (toDefIndex: ?number): ChangeDetails {\r\n    const oldValueLength = this.value.length;\r\n    const maxDefIndex = toDefIndex || this._charDefs.length;\r\n    for (let di=this.mapPosToDefIndex(this.value.length); di < maxDefIndex; ++di) {\r\n      const def = this._charDefs[di];\r\n      if (def.isInput) def.isHollow = true;\r\n\r\n      if (!this.lazy || toDefIndex) {\r\n        this._value += !def.isInput && def.char != null ?\r\n          def.char :\r\n          !def.optional ?\r\n            this.placeholderChar :\r\n            '';\r\n      }\r\n    }\r\n    return new ChangeDetails({\r\n      inserted: this.value.slice(oldValueLength)\r\n    });\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  remove (from: number=0, count: number=this.value.length-from): ChangeDetails {\r\n    const fromDefIndex = this.mapPosToDefIndex(from);\r\n    const toDefIndex = this.mapPosToDefIndex(from + count);\r\n    this._charDefs\r\n      .slice(fromDefIndex, toDefIndex)\r\n      .forEach(d => d.reset());\r\n\r\n    return super.remove(from, count);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  nearestInputPos (cursorPos: number, direction: Direction=DIRECTION.NONE) {\r\n    let step = direction || DIRECTION.RIGHT;\r\n\r\n    const initialDefIndex = this.mapPosToDefIndex(cursorPos);\r\n    const initialDef = this._charDefs[initialDefIndex];\r\n    let di = initialDefIndex;\r\n\r\n    let firstInputIndex,\r\n        firstFilledInputIndex,\r\n        firstVisibleHollowIndex,\r\n        nextdi;\r\n\r\n    // check if chars at right is acceptable for LEFT and NONE directions\r\n    if (direction !== DIRECTION.RIGHT &&\r\n      (initialDef && initialDef.isInput ||\r\n        // in none direction latest position is acceptable also\r\n        direction === DIRECTION.NONE && cursorPos === this.value.length)) {\r\n      firstInputIndex = initialDefIndex;\r\n      if (initialDef && !initialDef.isHollow) firstFilledInputIndex = initialDefIndex;\r\n    }\r\n\r\n    if ((firstFilledInputIndex == null && direction == DIRECTION.LEFT) || firstInputIndex == null) {\r\n      // search forward\r\n      for (\r\n        nextdi = indexInDirection(di, step);\r\n        0 <= nextdi && nextdi < this._charDefs.length;\r\n        di += step, nextdi += step\r\n      ) {\r\n        const nextDef = this._charDefs[nextdi];\r\n        if (firstInputIndex == null && nextDef.isInput) {\r\n          firstInputIndex = di;\r\n          if (direction === DIRECTION.NONE) break;\r\n        }\r\n        if (firstVisibleHollowIndex == null && nextDef.isHollow && !nextDef.isHiddenHollow) firstVisibleHollowIndex = di;\r\n        if (nextDef.isInput && !nextDef.isHollow) {\r\n          firstFilledInputIndex = di;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // for lazy if has aligned left inside fixed and has came to the start - use start position\r\n    if (direction === DIRECTION.LEFT && di === 0 && this.lazy && !this.extractInput() &&\r\n      (!initialDef || !initialDef.isInput)) firstInputIndex = 0;\r\n\r\n    if (direction === DIRECTION.LEFT || firstInputIndex == null) {\r\n      // search backward\r\n      step = -step;\r\n      let overflow = false;\r\n\r\n      // find hollows only before initial pos\r\n      for (\r\n        nextdi = indexInDirection(di, step);\r\n        0 <= nextdi && nextdi < this._charDefs.length;\r\n        di += step, nextdi += step\r\n      ) {\r\n        const nextDef = this._charDefs[nextdi];\r\n        if (nextDef.isInput) {\r\n          firstInputIndex = di;\r\n          if (nextDef.isHollow && !nextDef.isHiddenHollow) break;\r\n        }\r\n\r\n        // if hollow not found before start position - set `overflow`\r\n        // and try to find just any input\r\n        if (di === initialDefIndex) overflow = true;\r\n\r\n        // first input found\r\n        if (overflow && firstInputIndex != null) break;\r\n      }\r\n\r\n      // process overflow\r\n      overflow = overflow || nextdi >= this._charDefs.length;\r\n      if (overflow && firstInputIndex != null) di = firstInputIndex;\r\n    } else if (firstFilledInputIndex == null) {\r\n      // adjust index if delete at right and filled input not found at right\r\n      di = firstVisibleHollowIndex != null ?\r\n        firstVisibleHollowIndex :\r\n        firstInputIndex;\r\n    }\r\n\r\n    return this.mapDefIndexToPos(di);\r\n  }\r\n\r\n  /** Get group by name */\r\n  group (name: string): ?PatternGroup {\r\n    return this.groupsByName(name)[0];\r\n  }\r\n\r\n  /** Get all groups by name */\r\n  groupsByName (name: string): Array<PatternGroup> {\r\n    return this._groupDefs.filter(g => g.name === name);\r\n  }\r\n}\r\nMaskedPattern.DEFAULTS = {\r\n  lazy: true,\r\n  placeholderChar: '_'\r\n};\r\nMaskedPattern.STOP_CHAR = '`';\r\nMaskedPattern.ESCAPE_CHAR = '\\\\';\r\nMaskedPattern.Definition = PatternDefinition;\r\nMaskedPattern.Group = PatternGroup;\r\n","// @flow\r\nimport MaskedPattern from './pattern.js';\r\nimport PatternGroup from './pattern/group.js';\r\n\r\n\r\n/** Date mask */\r\nexport default\r\nclass MaskedDate extends MaskedPattern {\r\n  static GET_DEFAULT_GROUPS: () => {[string]: PatternGroup};\r\n  static DEFAULTS: any;\r\n\r\n  /** Parse string to Date */\r\n  parse: (string) => Date;\r\n  /** Format Date to string */\r\n  format: (Date) => string;\r\n  /** Pattern mask for date according to {@link MaskedDate#format} */\r\n  pattern: string;\r\n  /** Start date */\r\n  min: ?Date;\r\n  /** End date */\r\n  max: ?Date;\r\n\r\n  /**\r\n    @param {Object} opts\r\n  */\r\n  constructor (opts: any) {\r\n    super({\r\n      ...MaskedDate.DEFAULTS,\r\n      ...opts\r\n    });\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _update (opts: any) {\r\n    if (opts.mask === Date) delete opts.mask;\r\n    if (opts.pattern) {\r\n      opts.mask = opts.pattern;\r\n      delete opts.pattern;\r\n    }\r\n\r\n    const groups = opts.groups;\r\n    opts.groups = Object.assign({}, MaskedDate.GET_DEFAULT_GROUPS());\r\n    // adjust year group\r\n    if (opts.min) opts.groups.Y.from = opts.min.getFullYear();\r\n    if (opts.max) opts.groups.Y.to = opts.max.getFullYear();\r\n    Object.assign(opts.groups, groups);\r\n\r\n    super._update(opts);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  doValidate (...args: *) {\r\n    const valid = super.doValidate(...args);\r\n    const date = this.date;\r\n\r\n    return valid &&\r\n      (!this.isComplete ||\r\n        this.isDateExist(this.value) && date &&\r\n        (this.min == null || this.min <= date) &&\r\n        (this.max == null || date <= this.max));\r\n  }\r\n\r\n  /** Checks if date is exists */\r\n  isDateExist (str: string): boolean {\r\n    return this.format(this.parse(str)) === str;\r\n  }\r\n\r\n  /** Parsed Date */\r\n  get date (): ?Date {\r\n    return this.isComplete ?\r\n      this.parse(this.value) :\r\n      null;\r\n  }\r\n\r\n  set date (date: Date) {\r\n    this.value = this.format(date);\r\n  }\r\n}\r\nMaskedDate.DEFAULTS = {\r\n  pattern: 'd{.}`m{.}`Y',\r\n  format: date => {\r\n    const day = String(date.getDate()).padStart(2, '0');\r\n    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n    const year = date.getFullYear();\r\n\r\n    return [day, month, year].join('.');\r\n  },\r\n  parse: str => {\r\n    const [day, month, year] = str.split('.');\r\n    return new Date(year, month - 1, day);\r\n  },\r\n};\r\nMaskedDate.GET_DEFAULT_GROUPS = () => {\r\n  return {\r\n    d: new PatternGroup.Range([1, 31]),\r\n    m: new PatternGroup.Range([1, 12]),\r\n    Y: new PatternGroup.Range([1900, 9999]),\r\n  };\r\n}","// @flow\r\nimport {objectIncludes, DIRECTION, type Selection} from '../core/utils.js';\r\nimport ActionDetails from '../core/action-details.js';\r\nimport MaskedDate from '../masked/date.js';\r\nimport createMask, {maskedClass} from '../masked/factory.js';\r\nimport type Masked from '../masked/base.js';\r\nimport {type Mask} from '../masked/base.js';\r\n\r\n\r\n/**\r\n  Generic element API to use with mask\r\n  @interface\r\n*/\r\ninterface UIElement {\r\n  value: string;\r\n  selectionStart: number;\r\n  selectionEnd: number;\r\n  setSelectionRange (number, number): void;\r\n  addEventListener(string, Function): void;\r\n  removeEventListener(string, Function): void;\r\n}\r\n\r\n\r\n/** Listens to element events and controls changes between element and {@link Masked} */\r\nexport default\r\nclass InputMask {\r\n  /**\r\n    View element\r\n    @readonly\r\n  */\r\n  el: UIElement;\r\n\r\n  /**\r\n    Internal {@link Masked} model\r\n    @readonly\r\n  */\r\n  masked: Masked<*>;\r\n  alignCursor: () => void;\r\n  alignCursorFriendly: () => void;\r\n\r\n  _listeners: {[string]: Array<Function>};\r\n  _value: string;\r\n  _changingCursorPos: number;\r\n  _unmaskedValue: string;\r\n  _saveSelection: (?Event) => void;\r\n  _selection: Selection;\r\n  _onInput: (Event) => void;\r\n  _onChange: () => void;\r\n  _onDrop: (Event) => void;\r\n  _cursorChanging: TimeoutID;\r\n\r\n  /**\r\n    @param {UIElement} el\r\n    @param {Object} opts\r\n  */\r\n  constructor (el: UIElement, opts: {[string]: any}) {\r\n    this.el = el;\r\n    this.masked = createMask(opts);\r\n\r\n    this._listeners = {};\r\n    this._value = '';\r\n    this._unmaskedValue = '';\r\n\r\n    this._saveSelection = this._saveSelection.bind(this);\r\n    this._onInput = this._onInput.bind(this);\r\n    this._onChange = this._onChange.bind(this);\r\n    this._onDrop = this._onDrop.bind(this);\r\n    this.alignCursor = this.alignCursor.bind(this);\r\n    this.alignCursorFriendly = this.alignCursorFriendly.bind(this);\r\n\r\n    this._bindEvents();\r\n\r\n    // refresh\r\n    this.updateValue();\r\n    this._onChange();\r\n  }\r\n\r\n  /** Read or update mask */\r\n  get mask (): Mask {\r\n    return this.masked.mask;\r\n  }\r\n  set mask (mask: Mask) {\r\n    if (mask == null || mask === this.masked.mask) return;\r\n\r\n    if (this.masked.constructor === maskedClass(mask)) {\r\n      this.masked.mask = mask;\r\n      return;\r\n    }\r\n\r\n    const masked = createMask({mask});\r\n    masked.unmaskedValue = this.masked.unmaskedValue;\r\n    this.masked = masked;\r\n  }\r\n\r\n  /** Raw value */\r\n  get value (): string {\r\n    return this._value;\r\n  }\r\n\r\n  set value (str: string) {\r\n    this.masked.value = str;\r\n    this.updateControl();\r\n    this.alignCursor();\r\n  }\r\n\r\n  /** Unmasked value */\r\n  get unmaskedValue (): string {\r\n    return this._unmaskedValue;\r\n  }\r\n\r\n  set unmaskedValue (str: string) {\r\n    this.masked.unmaskedValue = str;\r\n    this.updateControl();\r\n    this.alignCursor();\r\n  }\r\n\r\n  /**\r\n    Starts listening to element events\r\n    @protected\r\n  */\r\n  _bindEvents () {\r\n    this.el.addEventListener('keydown', this._saveSelection);\r\n    this.el.addEventListener('input', this._onInput);\r\n    this.el.addEventListener('drop', this._onDrop);\r\n    this.el.addEventListener('click', this.alignCursorFriendly);\r\n    this.el.addEventListener('focus', this.alignCursorFriendly);\r\n    this.el.addEventListener('change', this._onChange);\r\n  }\r\n\r\n  /**\r\n    Stops listening to element events\r\n    @protected\r\n   */\r\n  _unbindEvents () {\r\n    this.el.removeEventListener('keydown', this._saveSelection);\r\n    this.el.removeEventListener('input', this._onInput);\r\n    this.el.removeEventListener('drop', this._onDrop);\r\n    this.el.removeEventListener('click', this.alignCursorFriendly);\r\n    this.el.removeEventListener('focus', this.alignCursorFriendly);\r\n    this.el.removeEventListener('change', this._onChange);\r\n  }\r\n\r\n  /**\r\n    Fires custom event\r\n    @protected\r\n   */\r\n  _fireEvent (ev: string) {\r\n    const listeners = this._listeners[ev] || [];\r\n    listeners.forEach(l => l());\r\n  }\r\n\r\n  /**\r\n    Current selection start\r\n    @readonly\r\n  */\r\n  get selectionStart (): number {\r\n    return this._cursorChanging ?\r\n      this._changingCursorPos :\r\n\r\n      this.el.selectionStart;\r\n  }\r\n\r\n  /** Current cursor position */\r\n  get cursorPos (): number {\r\n    return this._cursorChanging ?\r\n      this._changingCursorPos :\r\n\r\n      this.el.selectionEnd;\r\n  }\r\n  set cursorPos (pos: number) {\r\n    if (this.el !== document.activeElement) return;\r\n\r\n    this.el.setSelectionRange(pos, pos);\r\n    this._saveSelection();\r\n  }\r\n\r\n  /**\r\n    Stores current selection\r\n    @protected\r\n  */\r\n  _saveSelection (/* ev */) {\r\n    if (this.value !== this.el.value) {\r\n      console.warn('Uncontrolled input change, refresh mask manually!'); // eslint-disable-line no-console\r\n    }\r\n    this._selection = {\r\n      start: this.selectionStart,\r\n      end: this.cursorPos\r\n    };\r\n  }\r\n\r\n  /** Syncronizes model value from view */\r\n  updateValue () {\r\n    this.masked.value = this.el.value;\r\n  }\r\n\r\n  /** Syncronizes view from model value, fires change events */\r\n  updateControl () {\r\n    const newUnmaskedValue = this.masked.unmaskedValue;\r\n    const newValue = this.masked.value;\r\n    const isChanged = (this.unmaskedValue !== newUnmaskedValue ||\r\n      this.value !== newValue);\r\n\r\n    this._unmaskedValue = newUnmaskedValue;\r\n    this._value = newValue;\r\n\r\n    if (this.el.value !== newValue) this.el.value = newValue;\r\n    if (isChanged) this._fireChangeEvents();\r\n  }\r\n\r\n  /** Updates options with deep equal check, recreates @{link Masked} model if mask type changes */\r\n  updateOptions (opts: {[string]: any}) {\r\n    opts = Object.assign({}, opts);  // clone\r\n    if (opts.mask === Date && this.masked instanceof MaskedDate) delete opts.mask;\r\n\r\n    // check if changed\r\n    if (objectIncludes(this.masked, opts)) return;\r\n\r\n    this.masked.updateOptions(opts);\r\n    this.updateControl();\r\n  }\r\n\r\n  /** Updates cursor */\r\n  updateCursor (cursorPos: number) {\r\n    if (cursorPos == null) return;\r\n    this.cursorPos = cursorPos;\r\n\r\n    // also queue change cursor for mobile browsers\r\n    this._delayUpdateCursor(cursorPos);\r\n  }\r\n\r\n  /**\r\n    Delays cursor update to support mobile browsers\r\n    @private\r\n  */\r\n  _delayUpdateCursor (cursorPos: number) {\r\n    this._abortUpdateCursor();\r\n    this._changingCursorPos = cursorPos;\r\n    this._cursorChanging = setTimeout(() => {\r\n      if (!this.el) return; // if was destroyed\r\n      this.cursorPos = this._changingCursorPos;\r\n      this._abortUpdateCursor();\r\n    }, 10);\r\n  }\r\n\r\n  /**\r\n    Fires custom events\r\n    @protected\r\n  */\r\n  _fireChangeEvents () {\r\n    this._fireEvent('accept');\r\n    if (this.masked.isComplete) this._fireEvent('complete');\r\n  }\r\n\r\n  /**\r\n    Aborts delayed cursor update\r\n    @private\r\n  */\r\n  _abortUpdateCursor () {\r\n    if (this._cursorChanging) {\r\n      clearTimeout(this._cursorChanging);\r\n      delete this._cursorChanging;\r\n    }\r\n  }\r\n\r\n  /** Aligns cursor to nearest available position */\r\n  alignCursor () {\r\n    this.cursorPos = this.masked.nearestInputPos(this.cursorPos, DIRECTION.LEFT);\r\n  }\r\n\r\n  /** Aligns cursor only if selection is empty */\r\n  alignCursorFriendly () {\r\n    if (this.selectionStart !== this.cursorPos) return;\r\n    this.alignCursor();\r\n  }\r\n\r\n  /** Adds listener on custom event */\r\n  on (ev: string, handler: Function) {\r\n    if (!this._listeners[ev]) this._listeners[ev] = [];\r\n    this._listeners[ev].push(handler);\r\n    return this;\r\n  }\r\n\r\n  /** Removes custom event listener */\r\n  off (ev: string, handler: Function) {\r\n    if (!this._listeners[ev]) return;\r\n    if (!handler) {\r\n      delete this._listeners[ev];\r\n      return;\r\n    }\r\n    const hIndex = this._listeners[ev].indexOf(handler);\r\n    if (hIndex >= 0) this._listeners[ev].splice(hIndex, 1);\r\n    return this;\r\n  }\r\n\r\n  /** Handles view input event */\r\n  _onInput () {\r\n    this._abortUpdateCursor();\r\n\r\n    const details = new ActionDetails(\r\n      // new state\r\n      this.el.value, this.cursorPos,\r\n      // old state\r\n      this.value, this._selection);\r\n\r\n    const offset = this.masked.splice(\r\n      details.startChangePos,\r\n      details.removed.length,\r\n      details.inserted,\r\n      details.removeDirection).offset;\r\n\r\n    const cursorPos = this.masked.nearestInputPos(details.startChangePos + offset, details.removeDirection);\r\n\r\n    this.updateControl();\r\n    this.updateCursor(cursorPos);\r\n  }\r\n\r\n  /** Handles view change event and commits model value */\r\n  _onChange () {\r\n    if (this.value !== this.el.value) {\r\n      this.updateValue();\r\n    }\r\n    this.masked.doCommit();\r\n    this.updateControl();\r\n  }\r\n\r\n  /** Handles view drop event, prevents by default */\r\n  _onDrop (ev: Event) {\r\n    ev.preventDefault();\r\n    ev.stopPropagation();\r\n  }\r\n\r\n  /** Unbind view events and removes element reference */\r\n  destroy () {\r\n    this._unbindEvents();\r\n    // $FlowFixMe why not do so?\r\n    this._listeners.length = 0;\r\n    delete this.el;\r\n  }\r\n}\r\n","// @flow\r\nimport {escapeRegExp, indexInDirection, type Direction} from '../core/utils.js';\r\nimport Masked, {type MaskedOptions, type AppendFlags} from './base.js';\r\nimport {type TailDetails} from '../core/tail-details.js';\r\n\r\n\r\ntype MaskedNumberOptions = {\r\n  ...MaskedOptions<Number>,\r\n  radix: $PropertyType<MaskedNumber, 'radix'>,\r\n  thousandsSeparator: $PropertyType<MaskedNumber, 'thousandsSeparator'>,\r\n  mapToRadix: $PropertyType<MaskedNumber, 'mapToRadix'>,\r\n  scale: $PropertyType<MaskedNumber, 'scale'>,\r\n  signed: $PropertyType<MaskedNumber, 'signed'>,\r\n  normalizeZeros: $PropertyType<MaskedNumber, 'normalizeZeros'>,\r\n  padFractionalZeros: $PropertyType<MaskedNumber, 'padFractionalZeros'>,\r\n};\r\n\r\n/**\r\n  Number mask\r\n  @param {Object} opts\r\n  @param {string} opts.radix - Single char\r\n  @param {string} opts.thousandsSeparator - Single char\r\n  @param {Array<string>} opts.mapToRadix - Array of single chars\r\n  @param {number} opts.min\r\n  @param {number} opts.max\r\n  @param {number} opts.scale - Digits after point\r\n  @param {boolean} opts.signed - Allow negative\r\n  @param {boolean} opts.normalizeZeros - Flag to remove leading and trailing zeros in the end of editing\r\n  @param {boolean} opts.padFractionalZeros - Flag to pad trailing zeros after point in the end of editing\r\n*/\r\nexport default\r\nclass MaskedNumber extends Masked<Number> {\r\n  static DEFAULTS: $Shape<MaskedNumberOptions>;\r\n\r\n  /** Single char */\r\n  radix: string;\r\n  /** Single char */\r\n  thousandsSeparator: string;\r\n  /** Array of single chars */\r\n  mapToRadix: Array<string>;\r\n  /** */\r\n  min: number;\r\n  /** */\r\n  max: number;\r\n  /** Digits after point */\r\n  scale: number;\r\n  /** */\r\n  signed: boolean;\r\n  /** Flag to remove leading and trailing zeros in the end of editing */\r\n  normalizeZeros: boolean;\r\n  /** Flag to pad trailing zeros after point in the end of editing */\r\n  padFractionalZeros: boolean;\r\n  _numberRegExp: RegExp;\r\n  _numberRegExpInput: RegExp;\r\n  _thousandsSeparatorRegExp: RegExp;\r\n  _mapToRadixRegExp: RegExp;\r\n\r\n  constructor (opts: $Shape<MaskedNumberOptions>) {\r\n    super({\r\n      ...MaskedNumber.DEFAULTS,\r\n      ...opts\r\n    });\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _update (opts: MaskedNumberOptions) {\r\n    super._update(opts);\r\n    this._updateRegExps();\r\n  }\r\n\r\n  /** */\r\n  _updateRegExps () {\r\n    // use different regexp to process user input (more strict, input suffix) and tail shifting\r\n    const start = '^'\r\n\r\n    let midInput = '';\r\n    let mid = '';\r\n    if (this.allowNegative) {\r\n      midInput += '([+|\\\\-]?|([+|\\\\-]?(0|([1-9]+\\\\d*))))';\r\n      mid += '[+|\\\\-]?';\r\n    } else {\r\n      midInput += '(0|([1-9]+\\\\d*))';\r\n    }\r\n    mid += '\\\\d*';\r\n\r\n    let end = (this.scale ?\r\n      '(' + this.radix + '\\\\d{0,' + this.scale + '})?' :\r\n      '') + '$';\r\n\r\n    this._numberRegExpInput = new RegExp(start + midInput + end);\r\n    this._numberRegExp = new RegExp(start + mid + end);\r\n    this._mapToRadixRegExp = new RegExp('[' +\r\n      this.mapToRadix.map(escapeRegExp).join('') +\r\n    ']', 'g');\r\n    this._thousandsSeparatorRegExp = new RegExp(escapeRegExp(this.thousandsSeparator), 'g');\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _extractTail (fromPos: number=0, toPos: number=this.value.length): TailDetails {\r\n    const tail = super._extractTail(fromPos, toPos);\r\n\r\n    return {\r\n      ...tail,\r\n      value: this._removeThousandsSeparators(tail.value),\r\n    };\r\n  }\r\n\r\n  /** */\r\n  _removeThousandsSeparators (value: string): string {\r\n    return value.replace(this._thousandsSeparatorRegExp, '');\r\n  }\r\n\r\n  /** */\r\n  _insertThousandsSeparators (value: string): string {\r\n    // https://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript\r\n    const parts = value.split(this.radix);\r\n    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, this.thousandsSeparator);\r\n    return parts.join(this.radix);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  doPrepare (str: string, ...args: *) {\r\n    return super.doPrepare(this._removeThousandsSeparators(str.replace(this._mapToRadixRegExp, this.radix)), ...args);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  appendWithTail (...args: *) {\r\n    let previousValue = this.value;\r\n    this._value = this._removeThousandsSeparators(this.value);\r\n    let startChangePos = this.value.length;\r\n\r\n    const appendDetails = super.appendWithTail(...args);\r\n    this._value = this._insertThousandsSeparators(this.value);\r\n\r\n    // calculate offsets after insert separators\r\n    let beforeTailPos = startChangePos + appendDetails.inserted.length;\r\n    for (let pos = 0; pos <= beforeTailPos; ++pos) {\r\n      if (this.value[pos] === this.thousandsSeparator) {\r\n        if (pos < startChangePos ||\r\n          // check high bound\r\n          // if separator is still there - consider it also\r\n          (pos === startChangePos && previousValue[pos] === this.thousandsSeparator)) {\r\n          ++startChangePos;\r\n        }\r\n        if (pos < beforeTailPos) ++beforeTailPos;\r\n      }\r\n    }\r\n\r\n    // adjust details with separators\r\n    appendDetails.rawInserted = appendDetails.inserted;\r\n    appendDetails.inserted = this.value.slice(startChangePos, beforeTailPos);\r\n    appendDetails.shift += startChangePos - previousValue.length;\r\n\r\n    return appendDetails;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  nearestInputPos (cursorPos: number, direction?: Direction): number {\r\n    if (!direction) return cursorPos;\r\n\r\n    const nextPos = indexInDirection(cursorPos, direction);\r\n    if (this.value[nextPos] === this.thousandsSeparator) cursorPos += direction;\r\n    return cursorPos;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  doValidate (flags: AppendFlags) {\r\n    const regexp = flags.input ? this._numberRegExpInput : this._numberRegExp;\r\n\r\n    // validate as string\r\n    let valid = regexp.test(this._removeThousandsSeparators(this.value));\r\n\r\n    if (valid) {\r\n      // validate as number\r\n      const number = this.number;\r\n      valid = valid && !isNaN(number) &&\r\n        // check min bound for negative values\r\n        (this.min == null || this.min >= 0 || this.min <= this.number) &&\r\n        // check max bound for positive values\r\n        (this.max == null || this.max <= 0 || this.number <= this.max);\r\n    }\r\n\r\n    return valid && super.doValidate(flags);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  doCommit () {\r\n    const number = this.number;\r\n    let validnum = number;\r\n\r\n    // check bounds\r\n    if (this.min != null) validnum = Math.max(validnum, this.min);\r\n    if (this.max != null) validnum = Math.min(validnum, this.max);\r\n\r\n    if (validnum !== number) this.unmaskedValue = String(validnum);\r\n\r\n    let formatted = this.value;\r\n\r\n    if (this.normalizeZeros) formatted = this._normalizeZeros(formatted);\r\n    if (this.padFractionalZeros) formatted = this._padFractionalZeros(formatted);\r\n\r\n    this._value = this._insertThousandsSeparators(formatted);\r\n    super.doCommit();\r\n  }\r\n\r\n  /** */\r\n  _normalizeZeros (value: string): string {\r\n    const parts = this._removeThousandsSeparators(value).split(this.radix);\r\n\r\n    // remove leading zeros\r\n    parts[0] = parts[0].replace(/^(\\D*)(0*)(\\d*)/, (match, sign, zeros, num) => sign + num);\r\n    // add leading zero\r\n    if (value.length && !/\\d$/.test(parts[0])) parts[0] = parts[0] + '0';\r\n\r\n    if (parts.length > 1) {\r\n      parts[1] = parts[1].replace(/0*$/, '');  // remove trailing zeros\r\n      if (!parts[1].length) parts.length = 1;  // remove fractional\r\n    }\r\n\r\n    return this._insertThousandsSeparators(parts.join(this.radix));\r\n  }\r\n\r\n  /** */\r\n  _padFractionalZeros (value: string): string {\r\n    if (!value) return value;\r\n\r\n    const parts = value.split(this.radix);\r\n    if (parts.length < 2) parts.push('');\r\n    parts[1] = parts[1].padEnd(this.scale, '0');\r\n    return parts.join(this.radix);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  get unmaskedValue (): string {\r\n    return this._removeThousandsSeparators(\r\n      this._normalizeZeros(\r\n        this.value))\r\n      .replace(this.radix, '.');\r\n  }\r\n\r\n  set unmaskedValue (unmaskedValue: string) {\r\n    super.unmaskedValue = unmaskedValue.replace('.', this.radix);\r\n  }\r\n\r\n  /** Parsed Number */\r\n  get number (): number {\r\n    return Number(this.unmaskedValue);\r\n  }\r\n\r\n  set number (number: number) {\r\n    this.unmaskedValue = String(number);\r\n  }\r\n\r\n  /**\r\n    Is negative allowed\r\n    @readonly\r\n  */\r\n  get allowNegative (): boolean {\r\n    return this.signed ||\r\n      (this.min != null && this.min < 0) ||\r\n      (this.max != null && this.max < 0);\r\n  }\r\n}\r\nMaskedNumber.DEFAULTS = {\r\n  radix: ',',\r\n  thousandsSeparator: '',\r\n  mapToRadix: ['.'],\r\n  scale: 2,\r\n  signed: false,\r\n  normalizeZeros: true,\r\n  padFractionalZeros: false,\r\n};\r\n","// @flow\r\nimport Masked, {type MaskedOptions} from './base.js';\r\n\r\n\r\n/** Masking by RegExp */\r\nexport default\r\nclass MaskedRegExp extends Masked<RegExp> {\r\n  /**\r\n    @override\r\n    @param {Object} opts\r\n  */\r\n  _update (opts: $Shape<MaskedOptions<RegExp>>) {\r\n    opts.validate = (value) => value.search(opts.mask) >= 0;\r\n    super._update(opts);\r\n  }\r\n}\r\n","// @flow\r\nimport Masked, {type MaskedOptions} from './base.js';\r\n\r\n\r\n/** Masking by custom Function */\r\nexport default\r\nclass MaskedFunction extends Masked<Function> {\r\n  /**\r\n    @override\r\n    @param {Object} opts\r\n  */\r\n  _update (opts: MaskedOptions<Function>) {\r\n    opts.validate = opts.mask;\r\n    super._update(opts);\r\n  }\r\n}\r\n","// @flow\r\nimport ChangeDetails from '../core/change-details.js';\r\nimport createMask from './factory.js';\r\nimport Masked, {type AppendFlags} from './base.js';\r\nimport {type TailDetails} from '../core/tail-details.js';\r\n\r\n\r\ntype DynamicMaskType = Array<{[string]: any}>;\r\n/** Dynamic mask for choosing apropriate mask in run-time */\r\nexport default\r\nclass MaskedDynamic extends Masked<DynamicMaskType> {\r\n  /** Currently chosen mask */\r\n  currentMask: ?Masked<*>;\r\n  /** Compliled {@link Masked} options */\r\n  compiledMasks: Array<Masked<*>>;\r\n  /** Chooses {@link Masked} depending on input value */\r\n  dispatch: (string, Masked<*>, AppendFlags) => Masked<*>;\r\n\r\n  /**\r\n    @param {Object} opts\r\n  */\r\n  constructor (opts: any) {\r\n    super({\r\n      ...MaskedDynamic.DEFAULTS,\r\n      ...opts\r\n    });\r\n\r\n    this.currentMask = null;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _update (opts: any) {\r\n    super._update(opts);\r\n    // mask could be totally dynamic with only `dispatch` option\r\n    this.compiledMasks = Array.isArray(opts.mask) ?\r\n      opts.mask.map(m => createMask(m)) :\r\n      [];\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _append (str: string, ...args: *): ChangeDetails {\r\n    str = this.doPrepare(str, ...args);\r\n\r\n    const details = this._applyDispatch(str, ...args);\r\n\r\n    if (this.currentMask) {\r\n      details.aggregate(this.currentMask._append(str, ...args));\r\n    }\r\n\r\n    return details;\r\n  }\r\n\r\n  _applyDispatch (appended: string='', ...args: *) {\r\n    const oldValueLength = this.value.length;\r\n    const inputValue = this.rawInputValue;\r\n    const oldMask = this.currentMask;\r\n    const details = new ChangeDetails();\r\n\r\n    // dispatch SHOULD NOT modify mask\r\n    this.currentMask = this.doDispatch(appended, ...args);\r\n\r\n    // restore state after dispatch\r\n    if (this.currentMask && this.currentMask !== oldMask) {\r\n      // if mask changed reapply input\r\n      this.currentMask.reset();\r\n      // $FlowFixMe - it's ok, we don't change current mask\r\n      this.currentMask._append(inputValue, {raw: true});\r\n      details.shift = this.value.length - oldValueLength;\r\n    }\r\n\r\n    return details;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  doDispatch(appended: string, flags: AppendFlags={}) {\r\n    return this.dispatch(appended, this, flags);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  clone (): MaskedDynamic {\r\n    const m = new MaskedDynamic(this);\r\n    m._value = this.value;\r\n\r\n    // try to keep reference to compiled masks\r\n    const currentMaskIndex = this.compiledMasks.indexOf(this.currentMask);\r\n    if (this.currentMask) {\r\n      m.currentMask = currentMaskIndex >= 0 ?\r\n        m.compiledMasks[currentMaskIndex].assign(this.currentMask) :\r\n        this.currentMask.clone();\r\n    }\r\n\r\n    return m;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  reset () {\r\n    if (this.currentMask) this.currentMask.reset();\r\n    this.compiledMasks.forEach(cm => cm.reset());\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  get value (): string {\r\n    return this.currentMask ? this.currentMask.value : '';\r\n  }\r\n\r\n  set value (value: string) {\r\n    super.value = value;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  get unmaskedValue (): string {\r\n    return this.currentMask ? this.currentMask.unmaskedValue : '';\r\n  }\r\n\r\n  set unmaskedValue (unmaskedValue: string) {\r\n    super.unmaskedValue = unmaskedValue;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  get isComplete (): boolean {\r\n    return !!this.currentMask && this.currentMask.isComplete;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  remove (...args: *): ChangeDetails {\r\n    const details: ChangeDetails = new ChangeDetails();\r\n    if (this.currentMask) {\r\n      details.aggregate(this.currentMask.remove(...args))\r\n        // update with dispatch\r\n        .aggregate(this._applyDispatch());\r\n    }\r\n\r\n    return details;\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  extractInput (...args: *): string {\r\n    return this.currentMask ?\r\n      this.currentMask.extractInput(...args) :\r\n      '';\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _extractTail (...args: *): TailDetails {\r\n    return this.currentMask ?\r\n      this.currentMask._extractTail(...args) :\r\n      super._extractTail(...args);\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  _appendTail (tail?: TailDetails): ChangeDetails {\r\n    const details = new ChangeDetails();\r\n    if (tail) details.aggregate(this._applyDispatch(tail.value));\r\n\r\n    return details.aggregate(this.currentMask ?\r\n      this.currentMask._appendTail(tail) :\r\n      super._appendTail(tail));\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  doCommit () {\r\n    if (this.currentMask) this.currentMask.doCommit();\r\n    super.doCommit();\r\n  }\r\n\r\n  /**\r\n    @override\r\n  */\r\n  nearestInputPos(...args: *): number {\r\n    return this.currentMask ?\r\n      this.currentMask.nearestInputPos(...args) :\r\n      super.nearestInputPos(...args);\r\n  }\r\n}\r\n\r\nMaskedDynamic.DEFAULTS = {\r\n  dispatch: (appended, masked, flags) => {\r\n    if (!masked.compiledMasks.length) return;\r\n\r\n    const inputValue = masked.rawInputValue;\r\n\r\n    // simulate input\r\n    const inputs = masked.compiledMasks.map((cm, index) => {\r\n      const m = cm.clone();\r\n      m.rawInputValue = inputValue;\r\n      m._append(appended, flags);\r\n\r\n      return {value: m.rawInputValue.length, index};\r\n    });\r\n\r\n    // pop masks with longer values first\r\n    inputs.sort((i1, i2) => i2.value - i1.value);\r\n\r\n    return masked.compiledMasks[inputs[0].index];\r\n  }\r\n};\r\n","import {g} from './core/utils.js';\r\n\r\nimport InputMask from './controls/input.js';\r\n\r\nimport Masked from './masked/base.js';\r\nimport MaskedPattern from './masked/pattern.js';\r\nimport MaskedNumber from './masked/number.js';\r\nimport MaskedDate from './masked/date.js';\r\nimport MaskedRegExp from './masked/regexp.js';\r\nimport MaskedFunction from './masked/function.js';\r\nimport MaskedDynamic from './masked/dynamic.js';\r\nimport createMask from './masked/factory.js';\r\n\r\n\r\n/**\r\n * Applies mask on element.\r\n * @constructor\r\n * @param {HTMLInput|UIElement} el - Element to apply mask\r\n * @param {Object} opts - Custom mask options\r\n * @return {InputMask}\r\n */\r\nexport default\r\nfunction IMask (el, opts={}) {\r\n\t// currently available only for input-like elements\r\n  return new InputMask(el, opts);\r\n}\r\n\r\n/** {@link InputMask} */\r\nIMask.InputMask = InputMask;\r\n\r\n/** {@link Masked} */\r\nIMask.Masked = Masked;\r\n/** {@link MaskedPattern} */\r\nIMask.MaskedPattern = MaskedPattern;\r\n/** {@link MaskedNumber} */\r\nIMask.MaskedNumber = MaskedNumber;\r\n/** {@link MaskedDate} */\r\nIMask.MaskedDate = MaskedDate;\r\n/** {@link MaskedRegExp} */\r\nIMask.MaskedRegExp = MaskedRegExp;\r\n/** {@link MaskedFunction} */\r\nIMask.MaskedFunction = MaskedFunction;\r\n/** {@link MaskedDynamic} */\r\nIMask.MaskedDynamic = MaskedDynamic;\r\n/** {@link createMask} */\r\nIMask.createMask = createMask;\r\n\r\ng.IMask = IMask;\r\n"],"names":["defined","cof","IObject","toInteger","min","toIObject","toLength","toAbsoluteIndex","global","require$$0","uid","require$$1","has","$keys","enumBugKeys","isObject","document","require$$2","anObject","toPrimitive","IE8_DOM_DEFINE","dP","createDesc","hide","aFunction","core","ctx","redefine","$export","fails","toObject","repeat","userAgent","$pad","isString","str","String","conform","res","fallback","DIRECTION","NONE","LEFT","RIGHT","indexInDirection","pos","direction","escapeRegExp","replace","objectIncludes","b","a","arrA","Array","isArray","arrB","i","length","keys","Object","dateA","Date","dateB","getTime","regexpA","RegExp","regexpB","toString","prototype","hasOwnProperty","call","g","window","self","ActionDetails","value","cursorPos","oldValue","oldSelection","slice","startChangePos","start","Math","substr","insertedCount","max","end","removedCount","substring","ChangeDetails","details","inserted","overflow","shift","rawInserted","_rawInserted","Masked","opts","_value","_update","DEFAULTS","isInitialized","withValueRefresh","bind","m","source","babelHelpers.extends","reset","_append","input","_appendTail","doCommit","fromPos","toPos","extractInput","tail","flags","oldValueLength","consistentValue","clone","doPrepare","ci","doValidate","assign","aggregateDetails","consistentAppended","ch","appendDetails","tailAppended","aggregate","from","count","fn","_refreshing","unmasked","unmaskedValue","ret","prepare","validate","commit","deleteCount","removeDirection","tailPos","_extractTail","nearestInputPos","changeDetails","remove","appendWithTail","resolve","raw","val","maskedClass","mask","Error","IMask","MaskedRegExp","MaskedPattern","MaskedDate","Number","MaskedNumber","MaskedDynamic","Function","MaskedFunction","console","warn","createMask","MaskedClass","PatternDefinition","_masked","isHollow","isRawInput","type","TYPES","INPUT","optional","FIXED","PatternGroup","masked","name","offset","mapDefIndexToPos","RangeGroup","to","maxlen","_from","_to","_maxLength","minstr","maxstr","match","placeholder","num","firstNonZero","search","_matchFrom","padEnd","maxLength","EnumGroup","enums","group","some","e","indexOf","Range","Enum","ChunksTailDetails","chunks","map","c","join","firstChunk","stop","lastChunk","definitions","_rebuildMask","defs","_charDefs","_groupDefs","pattern","unmaskingBlock","optionalBlock","stopAlign","groups","p","gNames","filter","gName","sort","push","char","unmasking","STOP_CHAR","ESCAPE_CHAR","args","every","forEach","d","defIndex","isHiddenHollow","hiddenHollowsBefore","di","def","_appendChunks","_appendPlaceholder","mapPosToDefIndex","resolved","skipped","chres","lazy","placeholderChar","fromDef","_extractInputChunks","toDefIndex","isInput","fromDefIndex","stopDefIndices","stops","s","maxDefIndex","step","initialDefIndex","initialDef","firstInputIndex","firstFilledInputIndex","firstVisibleHollowIndex","nextdi","nextDef","groupsByName","Definition","Group","GET_DEFAULT_GROUPS","Y","getFullYear","valid","date","isComplete","isDateExist","format","parse","day","getDate","padStart","month","getMonth","year","split","InputMask","el","_listeners","_unmaskedValue","_saveSelection","_onInput","_onChange","_onDrop","alignCursor","alignCursorFriendly","_bindEvents","updateValue","addEventListener","removeEventListener","ev","listeners","l","_selection","selectionStart","newUnmaskedValue","newValue","isChanged","_fireChangeEvents","updateOptions","updateControl","_delayUpdateCursor","_abortUpdateCursor","_changingCursorPos","_cursorChanging","setTimeout","_fireEvent","clearTimeout","handler","hIndex","splice","removed","updateCursor","preventDefault","stopPropagation","_unbindEvents","constructor","selectionEnd","activeElement","setSelectionRange","_updateRegExps","midInput","mid","allowNegative","scale","radix","_numberRegExpInput","_numberRegExp","_mapToRadixRegExp","mapToRadix","_thousandsSeparatorRegExp","thousandsSeparator","_removeThousandsSeparators","parts","previousValue","_insertThousandsSeparators","beforeTailPos","nextPos","regexp","test","number","isNaN","validnum","formatted","normalizeZeros","_normalizeZeros","padFractionalZeros","_padFractionalZeros","sign","zeros","signed","currentMask","compiledMasks","_applyDispatch","appended","inputValue","rawInputValue","oldMask","doDispatch","dispatch","currentMaskIndex","cm","inputs","index","i1","i2"],"mappings":"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"}