{"version":3,"sources":["core.js"],"names":["f","exports","module","define","amd","g","window","global","self","core","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","ArraySet","l","Set","prototype","add","x","remove","delete","union","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_iterator","Symbol","iterator","_step","next","done","v","value","err","return","difference","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","contains","has","iter","Array","from","isEmpty","size","equals","s2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","toString","join","STATE_TYPES","BASIC","COMPOSITE","PARALLEL","HISTORY","INITIAL","FINAL","SCXML_IOPROCESSOR_TYPE","HTTP_IOPROCESSOR_TYPE","RX_TRAILING_WILDCARD","_typeof","obj","constructor","constants","printTrace","extend","transitionWithTargets","transitionComparator","initializeModel","isEventPrefixMatch","isTransitionMatch","scxmlPrefixTransitionSelector","eventlessTransitionSelector","getTransitionWithHigherSourceChildPriority","sortInEntryOrder","getStateWithHigherSourceChildPriority","initializeModelGeneratorFn","deserializeSerializedConfiguration","deserializeHistory","to","Object","keys","forEach","k","targets","t1","t2","documentOrder","rootState","opts","transitions","idToStateMap","Map","idCount","generateId","type","count","id","wrapInFakeRootState","state","$deserializeDatamodel","$serializeDatamodel","$idToStateMap","docUrl","name","states","$type","target","statesWithInitialAttributes","transitionToString","sourceState","events","cond","stateToString","populateStateIdMap","set","j","len","traverse","ancestors","push","apply","depth","parent","transition","source","bind","ancs","concat","typeEnum","isAtomic","descendants","map","s","reduce","b","initialChildren","isArray","initial","filter","child","initialRef","checkInitialRef","historyChildren","historyRef","prop","every","handler","invokes","invoke","finalize","connectIntialAttributes","initialStates","initialState","get","RX_WHITESPACE","connectTransitionGraph","onTransition","event","trim","split","lcca","getLCCA","scope","getScope","transitionIsReallyInternal","indexOf","s1","commonAncestors","anc","legacySemantics","fakeRootState","prefix","fullName","replace","charAt","eventName","some","tEvent","evaluator","selectEventlessTransitions","_args","modelFn","interpreter","_x","_sessionid","_ioprocessors","isIn","serializedConfiguration","serializedHistory","sid","query","isDescendant","getAncestors","root","index","slice","isOrthogonalTo","isAncestrallyRelatedTo","getLCA","getAncestorsOrSelf","getDescendantsOrSelf","process","setImmediate","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_i","_s","TypeError","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","key","Constructor","protoProps","staticProps","_toConsumableArray","arr2","_classCallCheck","instance","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","EventEmitter","util","helpers","env","DEBUG","BaseInterpreter","_EventEmitter","modelOrModelFactory","_this","getPrototypeOf","InterpreterScriptingContext","_isStepping","_scriptingContext","interpreterScriptingContext","generateSessionid","sessionid","sessionRegistry","invokerExecutionContext","_executionContext","location","scxml","model","JSON","parse","stringify","_model","console","log","priorityComparisonFn","transitionSelector","String","arguments","_externalEventQueue","_internalEventQueue","params","snapshot","_configuration","_historyValue","_isInFinalState","EVENTS","on","_log","emit","cancel","parentSession","invokeid","_exitInterpreter","_this2","_cancelAllDelayedSends","statesToExit","_getFullConfiguration","sort","stateExited","onExit","exitIdx","exitLen","block","blockIdx","blockLen","actionRef","_handleError","cancelInvoke","send","data","donedata","start","_initStart","_performBigStep","getConfiguration","startAsync","cb","genAsync","_this3","nop","getFullConfiguration","stateName","isFinal","currentEvent","keepGoing","allStatesExited","allStatesEntered","_startBigStep2","_startBigStep","_startBigStep3","_selectTransitionsAnd","_selectTransitionsAndPerformSmallStep","_selectTransitionsAnd2","_finishBigStep","selectedTransitions","_selectTransitions","ev","shift","statesExited","statesEntered","_performSmallStep2","_performSmallStep","_performSmallStep3","_this4","autoforward","action","_evaluateAction","_this5","statesToInvoke","_timeouts","timeoutOptions","sendOptions","delay","clearTimeout","timeoutHandle","_timeoutMap","_performBigStepAsync","_startBigStep4","_startBigStep5","nextStep","_selectTransitionsAnd3","_selectTransitionsAnd4","selectedTransitionsWithTargets","_exitStates","_executeTransitions","_enterStates","basicStatesExited","_getStatesExited2","_getStatesExited","_getStatesExited3","isDeep","s0","transitionList","txIdx","txLen","desc","configList","cfgIdx","cfgLen","ancIdx","ancLen","sortedStatesExited","sortedTransitions","stxIdx","targetIds","_this6","statesForDefaultEntry","defaultHistoryContent","_computeEntrySet","enterIdx","enterLen","stateEntered","onEntry","entryIdx","entryLen","_actionRef","_transition","_actionRef2","grandparent","isInFinalState","_getEffectiveTargetStates","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_iterator4","_step4","statesToEnter","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_iterator5","_step5","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_iterator6","_step6","_addDescendantStatesToEnter","ancestor","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_iterator7","_step7","_addAncestorStatesToEnter","_computeExitSet","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_iterator8","_step8","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_iterator9","_step9","_this7","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_loop","_step10","_iterator10","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_iterator11","_step11","_this8","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_iterator12","_step12","_iteratorNormalCompletion13","_didIteratorError13","_iteratorError13","_iterator13","_step13","_s2","_iteratorNormalCompletion14","_didIteratorError14","_iteratorError14","_iterator14","_step14","_s3","_iteratorNormalCompletion15","_didIteratorError15","_iteratorError15","_iterator15","_step15","_s4","_iteratorNormalCompletion16","_didIteratorError16","_iteratorError16","_iterator16","_step16","_s5","_iteratorNormalCompletion18","_didIteratorError18","_iteratorError18","_iterator18","_step18","targetState","_iteratorNormalCompletion17","_didIteratorError17","_iteratorError17","_iterator17","_step17","_s6","_targets","_iteratorNormalCompletion19","_didIteratorError19","_iteratorError19","_iterator19","_step19","_targetState","_iteratorNormalCompletion20","_didIteratorError20","_iteratorError20","_loop2","_step20","_iterator20","_this9","match","tagname","line","column","reason","message","args","arg","inspect","registerListener","listener","unregisterListener","off","getAllTransitionEvents","getEvents","stateIdx","stateLen","getSnapshot","_serializeHistory","gen","evtObjOrName","optionalData","config","sessionIdCounter","_interpreter","_invokeMap","validateUriRegex","invokeSendTargetRegex","scxmlSendTargetRegex","raise","_installDefaultPropsOnEvent","parseXmlStringAsDOM","xmlString","xmlParser","invokeObj","_this10","Promise","resolve","reject","invokers","session","_this11","sessionPromise","then","isInternal","origin","origintype","options","sendType","validateSend","sendAction","targetIsValidUri","test","sendid","defaultSendAction","_this12","setTimeout","doSend","targetSessionId","invokeId","sendAsync","publish","sendFn","customSend","customCancel","_listeners","_on","once","_once","__once","_off","splice","_emit","__emit","base","Statechart","_base$BaseInterpreter","enabledTransitions","atomicStates","loop","priorityEnabledTransitions","_removeConflictingTransition","filteredTransitions","t1Preempted","transitionsToRemove","t1ExitSet","t2ExitSet","hasIntersection","_ret","t3","inherits","ctor","superCtor","super_","TempCtor","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","run","nextTick","Item","array","title","browser","argv","version","versions","noop","addListener","removeListener","removeAllListeners","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","clearImmediate","Function","immediateIds","nextImmediateId","Timeout","setInterval","clearInterval","close","clearFn","_id","_clearFn","unref","ref","enroll","item","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","onTimeout","_onTimeout","fn","onNextTick","isBuffer","copy","fill","readUInt8","formatRegExp","format","isString","objects","str","Number","_","isNull","isObject","deprecate","msg","isUndefined","noDeprecation","warned","deprecated","throwDeprecation","traceDeprecation","trace","error","debugs","debugEnviron","debuglog","NODE_DEBUG","toUpperCase","RegExp","pid","ctx","seen","stylize","stylizeNoColor","colors","isBoolean","showHidden","_extend","customInspect","stylizeWithColor","formatValue","styles","styleType","style","arrayToHash","hash","val","idx","recurseTimes","isFunction","ret","primitive","formatPrimitive","visibleKeys","getOwnPropertyNames","isError","formatError","isRegExp","isDate","Date","braces","toUTCString","output","formatArray","formatProperty","pop","reduceToSingleString","simple","isNumber","hasOwnProperty","getOwnPropertyDescriptor","substr","numLinesEst","prev","cur","ar","isNullOrUndefined","isSymbol","re","objectToString","d","isPrimitive","pad","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth"],"mappings":"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","file":"core.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.core = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\n/* begin ArraySet */\n\n/** @constructor */\nfunction ArraySet(l) {\n    l = l || [];\n    this.o = new Set(l);\n}\n\nArraySet.prototype = {\n\n    add: function add(x) {\n        this.o.add(x);\n    },\n\n    remove: function remove(x) {\n        return this.o.delete(x);\n    },\n\n    union: function union(l) {\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n            for (var _iterator = l.o[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                var v = _step.value;\n\n                this.o.add(v);\n            }\n        } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion && _iterator.return) {\n                    _iterator.return();\n                }\n            } finally {\n                if (_didIteratorError) {\n                    throw _iteratorError;\n                }\n            }\n        }\n\n        return this;\n    },\n\n    difference: function difference(l) {\n        var _iteratorNormalCompletion2 = true;\n        var _didIteratorError2 = false;\n        var _iteratorError2 = undefined;\n\n        try {\n            for (var _iterator2 = l.o[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                var v = _step2.value;\n\n                this.o.delete(v);\n            }\n        } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                    _iterator2.return();\n                }\n            } finally {\n                if (_didIteratorError2) {\n                    throw _iteratorError2;\n                }\n            }\n        }\n\n        return this;\n    },\n\n    contains: function contains(x) {\n        return this.o.has(x);\n    },\n\n    iter: function iter() {\n        return Array.from(this.o);\n    },\n\n    isEmpty: function isEmpty() {\n        return !this.o.size;\n    },\n\n    size: function size() {\n        return this.o.size;\n    },\n\n    equals: function equals(s2) {\n        if (this.o.size !== s2.size()) {\n            return false;\n        }\n\n        var _iteratorNormalCompletion3 = true;\n        var _didIteratorError3 = false;\n        var _iteratorError3 = undefined;\n\n        try {\n            for (var _iterator3 = this.o[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                var v = _step3.value;\n\n                if (!s2.contains(v)) {\n                    return false;\n                }\n            }\n        } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n        } finally {\n            try {\n                if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                    _iterator3.return();\n                }\n            } finally {\n                if (_didIteratorError3) {\n                    throw _iteratorError3;\n                }\n            }\n        }\n\n        return true;\n    },\n\n    toString: function toString() {\n        return this.o.size === 0 ? '<empty>' : Array.from(this.o).join(',\\n');\n    }\n};\n\nmodule.exports = ArraySet;\n\n},{}],2:[function(require,module,exports){\n'use strict';\n\nvar STATE_TYPES = {\n    BASIC: 0,\n    COMPOSITE: 1,\n    PARALLEL: 2,\n    HISTORY: 3,\n    INITIAL: 4,\n    FINAL: 5\n};\n\nvar SCXML_IOPROCESSOR_TYPE = 'http://www.w3.org/TR/scxml/#SCXMLEventProcessor';\nvar HTTP_IOPROCESSOR_TYPE = 'http://www.w3.org/TR/scxml/#BasicHTTPEventProcessor';\nvar RX_TRAILING_WILDCARD = /\\.\\*$/;\n\nmodule.exports = {\n    STATE_TYPES: STATE_TYPES,\n    SCXML_IOPROCESSOR_TYPE: SCXML_IOPROCESSOR_TYPE,\n    HTTP_IOPROCESSOR_TYPE: HTTP_IOPROCESSOR_TYPE,\n    RX_TRAILING_WILDCARD: RX_TRAILING_WILDCARD\n};\n\n},{}],3:[function(require,module,exports){\n'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar constants = require('./constants'),\n    STATE_TYPES = constants.STATE_TYPES,\n    RX_TRAILING_WILDCARD = constants.RX_TRAILING_WILDCARD;\n\nvar printTrace = false;\n\nmodule.exports = {\n    extend: extend,\n    transitionWithTargets: transitionWithTargets,\n    transitionComparator: transitionComparator,\n    initializeModel: initializeModel,\n    isEventPrefixMatch: isEventPrefixMatch,\n    isTransitionMatch: isTransitionMatch,\n    scxmlPrefixTransitionSelector: scxmlPrefixTransitionSelector,\n    eventlessTransitionSelector: eventlessTransitionSelector,\n    getTransitionWithHigherSourceChildPriority: getTransitionWithHigherSourceChildPriority,\n    sortInEntryOrder: sortInEntryOrder,\n    getStateWithHigherSourceChildPriority: getStateWithHigherSourceChildPriority,\n    initializeModelGeneratorFn: initializeModelGeneratorFn,\n    deserializeSerializedConfiguration: deserializeSerializedConfiguration,\n    deserializeHistory: deserializeHistory\n};\n\nfunction extend(to, from) {\n    Object.keys(from).forEach(function (k) {\n        to[k] = from[k];\n    });\n    return to;\n};\n\nfunction transitionWithTargets(t) {\n    return t.targets;\n}\n\nfunction transitionComparator(t1, t2) {\n    return t1.documentOrder - t2.documentOrder;\n}\n\nfunction initializeModel(rootState, opts) {\n    var transitions = [],\n        idToStateMap = new Map(),\n        documentOrder = 0;\n\n    //TODO: need to add fake ids to anyone that doesn't have them\n    //FIXME: make this safer - break into multiple passes\n    var idCount = {};\n\n    function generateId(type) {\n        if (idCount[type] === undefined) idCount[type] = 0;\n\n        do {\n            var count = idCount[type]++;\n            var id = '$generated-' + type + '-' + count;\n        } while (idToStateMap.has(id));\n\n        return id;\n    }\n\n    function wrapInFakeRootState(state) {\n        return {\n            $deserializeDatamodel: state.$deserializeDatamodel || function () {},\n            $serializeDatamodel: state.$serializeDatamodel || function () {\n                return null;\n            },\n            $idToStateMap: idToStateMap, //keep this for handy deserialization of serialized configuration\n            docUrl: state.docUrl,\n            name: state.name,\n            states: [{\n                $type: 'initial',\n                transitions: [{\n                    target: state\n                }]\n            }, state]\n        };\n    }\n\n    var statesWithInitialAttributes = [];\n\n    /**\n      @this {SCTransition}\n    */\n    function transitionToString(sourceState) {\n        return sourceState + ' -- ' + (this.events ? '(' + this.events.join(',') + ')' : null) + (this.cond ? '[' + this.cond.name + ']' : '') + ' --> ' + (this.targets ? this.targets.join(',') : null);\n    }\n\n    /**\n      @this {SCState}\n    */\n    function stateToString() {\n        return this.id;\n    }\n\n    function populateStateIdMap(state) {\n        //populate state id map\n        if (state.id) {\n            idToStateMap.set(state.id, state);\n        }\n\n        if (state.states) {\n            for (var j = 0, len = state.states.length; j < len; j++) {\n                populateStateIdMap(state.states[j]);\n            }\n        }\n    }\n\n    function traverse(ancestors, state) {\n\n        if (printTrace) state.toString = stateToString;\n\n        //add to global transition and state id caches\n        if (state.transitions) transitions.push.apply(transitions, state.transitions);\n\n        //create a default type, just to normalize things\n        //this way we can check for unsupported types below\n        state.$type = state.$type || 'state';\n\n        //add ancestors and depth properties\n        state.ancestors = ancestors;\n        state.depth = ancestors.length;\n        state.parent = ancestors[0];\n        state.documentOrder = documentOrder++;\n\n        //add some information to transitions\n        state.transitions = state.transitions || [];\n        for (var j = 0, len = state.transitions.length; j < len; j++) {\n            var transition = state.transitions[j];\n            transition.documentOrder = documentOrder++;\n            transition.source = state;\n            if (printTrace) transition.toString = transitionToString.bind(transition, state);\n        };\n\n        //recursive step\n        if (state.states) {\n            var ancs = [state].concat(ancestors);\n            for (var j = 0, len = state.states.length; j < len; j++) {\n                traverse(ancs, state.states[j]);\n            }\n        }\n\n        //setup fast state type\n        switch (state.$type) {\n            case 'parallel':\n                state.typeEnum = STATE_TYPES.PARALLEL;\n                state.isAtomic = false;\n                break;\n            case 'initial':\n                state.typeEnum = STATE_TYPES.INITIAL;\n                state.isAtomic = true;\n                break;\n            case 'history':\n                state.typeEnum = STATE_TYPES.HISTORY;\n                state.isAtomic = true;\n                break;\n            case 'final':\n                state.typeEnum = STATE_TYPES.FINAL;\n                state.isAtomic = true;\n                break;\n            case 'state':\n            case 'scxml':\n                if (state.states && state.states.length) {\n                    state.typeEnum = STATE_TYPES.COMPOSITE;\n                    state.isAtomic = false;\n                } else {\n                    state.typeEnum = STATE_TYPES.BASIC;\n                    state.isAtomic = true;\n                }\n                break;\n            default:\n                throw new Error('Unknown state type: ' + state.$type);\n        }\n\n        //descendants property on states will now be populated. add descendants to this state\n        if (state.states) {\n            state.descendants = state.states.concat(state.states.map(function (s) {\n                return s.descendants;\n            }).reduce(function (a, b) {\n                return a.concat(b);\n            }, []));\n        } else {\n            state.descendants = [];\n        }\n\n        var initialChildren;\n        if (state.typeEnum === STATE_TYPES.COMPOSITE) {\n            //set up initial state\n\n            if (Array.isArray(state.initial) || typeof state.initial === 'string') {\n                statesWithInitialAttributes.push(state);\n            } else {\n                //take the first child that has initial type, or first child\n                initialChildren = state.states.filter(function (child) {\n                    return child.$type === 'initial';\n                });\n\n                state.initialRef = [initialChildren.length ? initialChildren[0] : state.states[0]];\n                checkInitialRef(state);\n            }\n        }\n\n        //hook up history\n        if (state.typeEnum === STATE_TYPES.COMPOSITE || state.typeEnum === STATE_TYPES.PARALLEL) {\n\n            var historyChildren = state.states.filter(function (s) {\n                return s.$type === 'history';\n            });\n\n            state.historyRef = historyChildren;\n        }\n\n        //now it's safe to fill in fake state ids\n        if (!state.id) {\n            state.id = generateId(state.$type);\n            idToStateMap.set(state.id, state);\n        }\n\n        //normalize onEntry/onExit, which can be single fn or array, or array of arrays (blocks)\n        ['onEntry', 'onExit'].forEach(function (prop) {\n            if (state[prop]) {\n                if (!Array.isArray(state[prop])) {\n                    state[prop] = [state[prop]];\n                }\n                if (!state[prop].every(function (handler) {\n                    return Array.isArray(handler);\n                })) {\n                    state[prop] = [state[prop]];\n                }\n            }\n        });\n\n        if (state.invokes && !Array.isArray(state.invokes)) {\n            state.invokes = [state.invokes];\n            state.invokes.forEach(function (invoke) {\n                if (invoke.finalize && !Array.isArray(invoke.finalize)) {\n                    invoke.finalize = [invoke.finalize];\n                }\n            });\n        }\n    }\n\n    //TODO: convert events to regular expressions in advance\n\n    function checkInitialRef(state) {\n        if (!state.initialRef) throw new Error('Unable to locate initial state for composite state: ' + state.id);\n    }\n    function connectIntialAttributes() {\n        for (var j = 0, len = statesWithInitialAttributes.length; j < len; j++) {\n            var s = statesWithInitialAttributes[j];\n\n            var initialStates = Array.isArray(s.initial) ? s.initial : [s.initial];\n            s.initialRef = initialStates.map(function (initialState) {\n                return idToStateMap.get(initialState);\n            });\n            checkInitialRef(s);\n        }\n    }\n\n    var RX_WHITESPACE = /\\s+/;\n\n    function connectTransitionGraph() {\n        //normalize as with onEntry/onExit\n        for (var i = 0, len = transitions.length; i < len; i++) {\n            var t = transitions[i];\n            if (t.onTransition && !Array.isArray(t.onTransition)) {\n                t.onTransition = [t.onTransition];\n            }\n\n            //normalize \"event\" attribute into \"events\" attribute\n            if (typeof t.event === 'string') {\n                t.events = t.event.trim().split(RX_WHITESPACE);\n            }\n            delete t.event;\n\n            if (t.targets || typeof t.target === 'undefined') {\n                //targets have already been set up\n                continue;\n            }\n\n            if (typeof t.target === 'string') {\n                var target = idToStateMap.get(t.target);\n                if (!target) throw new Error('Unable to find target state with id ' + t.target);\n                t.target = target;\n                t.targets = [t.target];\n            } else if (Array.isArray(t.target)) {\n                t.targets = t.target.map(function (target) {\n                    if (typeof target === 'string') {\n                        target = idToStateMap.get(target);\n                        if (!target) throw new Error('Unable to find target state with id ' + t.target);\n                        return target;\n                    } else {\n                        return target;\n                    }\n                });\n            } else if (_typeof(t.target) === 'object') {\n                t.targets = [t.target];\n            } else {\n                throw new Error('Transition target has unknown type: ' + t.target);\n            }\n        }\n\n        //hook up LCA - optimization\n        for (var i = 0, len = transitions.length; i < len; i++) {\n            var t = transitions[i];\n            if (t.targets) t.lcca = getLCCA(t.source, t.targets[0]); //FIXME: we technically do not need to hang onto the lcca. only the scope is used by the algorithm\n\n            t.scope = getScope(t);\n        }\n    }\n\n    function getScope(transition) {\n        //Transition scope is normally the least common compound ancestor (lcca).\n        //Internal transitions have a scope equal to the source state.\n        var transitionIsReallyInternal = transition.type === 'internal' && transition.source.typeEnum === STATE_TYPES.COMPOSITE && //is transition source a composite state\n        transition.source.parent && //root state won't have parent\n        transition.targets && //does it target its descendants\n        transition.targets.every(function (target) {\n            return transition.source.descendants.indexOf(target) > -1;\n        });\n\n        if (!transition.targets) {\n            return null;\n        } else if (transitionIsReallyInternal) {\n            return transition.source;\n        } else {\n            return transition.lcca;\n        }\n    }\n\n    function getLCCA(s1, s2) {\n        var commonAncestors = [];\n        for (var j = 0, len = s1.ancestors.length; j < len; j++) {\n            var anc = s1.ancestors[j];\n            if ((opts && opts.legacySemantics ? anc.typeEnum === STATE_TYPES.COMPOSITE : anc.typeEnum === STATE_TYPES.COMPOSITE || anc.typeEnum === STATE_TYPES.PARALLEL) && anc.descendants.indexOf(s2) > -1) {\n\n                commonAncestors.push(anc);\n            }\n        };\n        if (!commonAncestors.length) throw new Error(\"Could not find LCA for states.\");\n        return commonAncestors[0];\n    }\n\n    //main execution starts here\n    //FIXME: only wrap in root state if it's not a compound state\n    populateStateIdMap(rootState);\n    var fakeRootState = wrapInFakeRootState(rootState); //I wish we had pointer semantics and could make this a C-style \"out argument\". Instead we return him\n    traverse([], fakeRootState);\n    connectTransitionGraph();\n    connectIntialAttributes();\n\n    return fakeRootState;\n}\n\nfunction isEventPrefixMatch(prefix, fullName) {\n    prefix = prefix.replace(RX_TRAILING_WILDCARD, '');\n\n    if (prefix === fullName) {\n        return true;\n    }\n\n    if (prefix.length > fullName.length) {\n        return false;\n    }\n\n    if (fullName.charAt(prefix.length) !== '.') {\n        return false;\n    }\n\n    return fullName.indexOf(prefix) === 0;\n}\n\nfunction isTransitionMatch(t, eventName) {\n    return t.events.some(function (tEvent) {\n        return tEvent === '*' || isEventPrefixMatch(tEvent, eventName);\n    });\n}\n\nfunction scxmlPrefixTransitionSelector(t, event, evaluator, selectEventlessTransitions) {\n    return (selectEventlessTransitions ? !t.events : t.events && event && event.name && isTransitionMatch(t, event.name)) && (!t.cond || evaluator(t.cond));\n}\n\nfunction eventlessTransitionSelector(state) {\n    return state.transitions.filter(function (transition) {\n        return !transition.events || transition.events && transition.events.length === 0;\n    });\n}\n\n//priority comparison functions\nfunction getTransitionWithHigherSourceChildPriority(_args) {\n    var t1 = _args[0],\n        t2 = _args[1];\n    var r = getStateWithHigherSourceChildPriority(t1.source, t2.source);\n    //compare transitions based first on depth, then based on document order\n    if (t1.source.depth < t2.source.depth) {\n        return t2;\n    } else if (t2.source.depth < t1.source.depth) {\n        return t1;\n    } else {\n        if (t1.documentOrder < t2.documentOrder) {\n            return t1;\n        } else {\n            return t2;\n        }\n    }\n}\n\nfunction sortInEntryOrder(s1, s2) {\n    return getStateWithHigherSourceChildPriority(s1, s2) * -1;\n}\n\nfunction getStateWithHigherSourceChildPriority(s1, s2) {\n    //compare states based first on depth, then based on document order\n    if (s1.depth > s2.depth) {\n        return -1;\n    } else if (s1.depth < s2.depth) {\n        return 1;\n    } else {\n        //Equality\n        if (s1.documentOrder < s2.documentOrder) {\n            return 1;\n        } else if (s1.documentOrder > s2.documentOrder) {\n            return -1;\n        } else {\n            return 0;\n        }\n    }\n}\n\nfunction initializeModelGeneratorFn(modelFn, opts, interpreter) {\n    return modelFn.call(interpreter, opts._x, opts._x._sessionid, opts._x._ioprocessors, interpreter.isIn.bind(interpreter));\n}\n\nfunction deserializeSerializedConfiguration(serializedConfiguration, idToStateMap) {\n    return serializedConfiguration.map(function (id) {\n        var state = idToStateMap.get(id);\n        if (!state) throw new Error('Error loading serialized configuration. Unable to locate state with id ' + id);\n        return state;\n    });\n}\n\nfunction deserializeHistory(serializedHistory, idToStateMap) {\n    var o = {};\n    Object.keys(serializedHistory).forEach(function (sid) {\n        o[sid] = serializedHistory[sid].map(function (id) {\n            var state = idToStateMap.get(id);\n            if (!state) throw new Error('Error loading serialized history. Unable to locate state with id ' + id);\n            return state;\n        });\n    });\n    return o;\n}\n\n},{\"./constants\":2}],4:[function(require,module,exports){\n'use strict';\n\nvar constants = require('./constants');\n\n//model accessor functions\nvar query = {\n    isDescendant: function isDescendant(s1, s2) {\n        //Returns 'true' if state1 is a descendant of state2 (a child, or a child of a child, or a child of a child of a child, etc.) Otherwise returns 'false'.\n        return s2.descendants.indexOf(s1) > -1;\n    },\n    getAncestors: function getAncestors(s, root) {\n        var ancestors, index, state;\n        index = s.ancestors.indexOf(root);\n        if (index > -1) {\n            return s.ancestors.slice(0, index);\n        } else {\n            return s.ancestors;\n        }\n    },\n    isOrthogonalTo: function isOrthogonalTo(s1, s2) {\n        //Two control states are orthogonal if they are not ancestrally\n        //related, and their smallest, mutual parent is a Concurrent-state.\n        return !this.isAncestrallyRelatedTo(s1, s2) && this.getLCA(s1, s2).typeEnum === constants.STATE_TYPES.PARALLEL;\n    },\n    isAncestrallyRelatedTo: function isAncestrallyRelatedTo(s1, s2) {\n        //Two control states are ancestrally related if one is child/grandchild of another.\n        return this.getAncestorsOrSelf(s2).indexOf(s1) > -1 || this.getAncestorsOrSelf(s1).indexOf(s2) > -1;\n    },\n    getAncestorsOrSelf: function getAncestorsOrSelf(s, root) {\n        return [s].concat(query.getAncestors(s, root));\n    },\n    getDescendantsOrSelf: function getDescendantsOrSelf(s) {\n        return [s].concat(s.descendants);\n    },\n    getLCA: function getLCA(s1, s2) {\n        var commonAncestors = this.getAncestors(s1).filter(function (a) {\n            return a.descendants.indexOf(s2) > -1;\n        }, this);\n        return commonAncestors[0];\n    }\n};\n\nmodule.exports = query;\n\n},{\"./constants\":2}],5:[function(require,module,exports){\n(function (process,setImmediate){\n//   Copyright 2012-2012 Jacob Beard, INFICON, and other SCION contributors\n//\n//   Licensed under the Apache License, Version 2.0 (the \"License\");\n//   you may not use this file except in compliance with the License.\n//   You may obtain a copy of the License at\n//\n//       http://www.apache.org/licenses/LICENSE-2.0\n//\n//   Unless required by applicable law or agreed to in writing, software\n//   distributed under the License is distributed on an \"AS IS\" BASIS,\n//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n//   See the License for the specific language governing permissions and\n//   limitations under the License.\n\n/**\n * SCION-CORE global object\n * @namespace scion\n */\n\n/**\n * An Array of strings representing the ids all of the basic states the\n * interpreter is in after a big-step completes.\n * @typedef {Array<string>} Configuration\n */\n\n/**\n * A set of basic and composite state ids.\n * @typedef {Array<string>} FullConfiguration\n */\n\n/**\n * A set of basic and composite state ids.\n * @typedef {Array<string>} FullConfiguration\n */\n\n\"use strict\";\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar EventEmitter = require('tiny-events').EventEmitter,\n    util = require('util'),\n    ArraySet = require('./ArraySet'),\n    constants = require('./constants'),\n    helpers = require('./helpers'),\n    query = require('./query'),\n    extend = helpers.extend,\n    transitionWithTargets = helpers.transitionWithTargets,\n    transitionComparator = helpers.transitionComparator,\n    initializeModel = helpers.initializeModel,\n    isEventPrefixMatch = helpers.isEventPrefixMatch,\n    isTransitionMatch = helpers.isTransitionMatch,\n    scxmlPrefixTransitionSelector = helpers.scxmlPrefixTransitionSelector,\n    eventlessTransitionSelector = helpers.eventlessTransitionSelector,\n    getTransitionWithHigherSourceChildPriority = helpers.getTransitionWithHigherSourceChildPriority,\n    sortInEntryOrder = helpers.sortInEntryOrder,\n    getStateWithHigherSourceChildPriority = helpers.getStateWithHigherSourceChildPriority,\n    initializeModelGeneratorFn = helpers.initializeModelGeneratorFn,\n    deserializeSerializedConfiguration = helpers.deserializeSerializedConfiguration,\n    deserializeHistory = helpers.deserializeHistory,\n    BASIC = constants.STATE_TYPES.BASIC,\n    COMPOSITE = constants.STATE_TYPES.COMPOSITE,\n    PARALLEL = constants.STATE_TYPES.PARALLEL,\n    HISTORY = constants.STATE_TYPES.HISTORY,\n    INITIAL = constants.STATE_TYPES.INITIAL,\n    FINAL = constants.STATE_TYPES.FINAL,\n    SCXML_IOPROCESSOR_TYPE = constants.SCXML_IOPROCESSOR_TYPE;\n\nvar printTrace = typeof process !== 'undefined' && !!process.env.DEBUG;\n\n/**\n * @interface EventEmitter\n */\n\n/**\n* @event scion.BaseInterpreter#onError\n* @property {string} tagname The name of the element that produced the error. \n* @property {number} line The line in the source file in which the error occurred.\n* @property {number} column The column in the source file in which the error occurred.\n* @property {string} reason An informative error message. The text is platform-specific and subject to change.\n*/\n\n/**\n * @function\n * @name EventEmitter.prototype#on\n * @param {string} type\n * @param {callback} listener\n */\n\n/**\n * @function\n * @name EventEmitter.prototype#once\n * @param {string} type\n * @param {callback} listener\n */\n\n/**\n * @function\n * @name EventEmitter.prototype#off\n * @param {string} type\n * @param {callback} listener\n */\n\n/**\n * @function\n * @name EventEmitter.prototype#emit\n * @param {string} type\n * @param {any} args\n */\n/** \n * @description The SCXML constructor creates an interpreter instance from a model object.\n * @abstract\n * @class BaseInterpreter\n * @memberof scion\n * @extends EventEmitter\n * @param {SCJSON | scxml.ModelFactory} modelOrModelFactory Either an SCJSON root state; or an scxml.ModelFactory, which is a function which returns an SCJSON object. \n * @param opts\n * @param {string} [opts.sessionid] Used to populate SCXML _sessionid.\n * @param {function} [opts.generateSessionid] Factory used to generate sessionid if sessionid keyword is not specified\n * @param {Map<string, BaseInterpreter>} [opts.sessionRegistry] Map used to map sessionid strings to Statechart instances.\n * @param [opts.Set] Class to use as an ArraySet. Defaults to ES6 Set.\n * @param {object} [opts.params]  Used to pass params from invoke. Sets the datamodel when interpreter is instantiated.\n * @param {Snapshot} [opts.snapshot] State machine snapshot. Used to restore a serialized state machine.\n * @param {Statechart} [opts.parentSession]  Used to pass parent session during invoke.\n * @param {string }[opts.invokeid]  Support for id of invoke element at runtime.\n * @param {boolean} [opts.legacySemantics]\n * @param [opts.console]\n * @param [opts.transitionSelector]\n * @param [opts.customCancel]\n * @param [opts.customSend]\n * @param [opts.sendAsync]\n * @param [opts.doSend]\n * @param [opts.invokers]\n * @param [opts.xmlParser]\n * @param [opts.interpreterScriptingContext]\n * @param [opts.invokerExecutionContext]\n */\n\nvar BaseInterpreter = function (_EventEmitter) {\n  _inherits(BaseInterpreter, _EventEmitter);\n\n  function BaseInterpreter(modelOrModelFactory, opts) {\n    _classCallCheck(this, BaseInterpreter);\n\n    var _this = _possibleConstructorReturn(this, (BaseInterpreter.__proto__ || Object.getPrototypeOf(BaseInterpreter)).call(this));\n\n    _this.opts = opts;\n\n    _this.opts.InterpreterScriptingContext = _this.opts.InterpreterScriptingContext || InterpreterScriptingContext;\n\n    _this._isStepping = false;\n\n    _this._scriptingContext = _this.opts.interpreterScriptingContext || (_this.opts.InterpreterScriptingContext ? new _this.opts.InterpreterScriptingContext(_this) : {});\n\n    _this.opts.generateSessionid = _this.opts.generateSessionid || BaseInterpreter.generateSessionid;\n    _this.opts.sessionid = _this.opts.sessionid || _this.opts.generateSessionid();\n    _this.opts.sessionRegistry = _this.opts.sessionRegistry || BaseInterpreter.sessionRegistry; //TODO: define a better interface. For now, assume a Map<sessionid, session>\n    _this.opts.invokerExecutionContext = opts.invokerExecutionContext || modelOrModelFactory._executionContext;\n\n    var _ioprocessors = {};\n    _ioprocessors[SCXML_IOPROCESSOR_TYPE] = {\n      location: '#_scxml_' + _this.opts.sessionid\n    };\n    _ioprocessors.scxml = _ioprocessors[SCXML_IOPROCESSOR_TYPE]; //alias\n\n    //SCXML system variables:\n    _this.opts._x = {\n      _sessionid: _this.opts.sessionid,\n      _ioprocessors: _ioprocessors\n    };\n\n    var model;\n    if (typeof modelOrModelFactory === 'function') {\n      model = initializeModelGeneratorFn(modelOrModelFactory, _this.opts, _this);\n    } else if ((typeof modelOrModelFactory === 'undefined' ? 'undefined' : _typeof(modelOrModelFactory)) === 'object') {\n      model = JSON.parse(JSON.stringify(modelOrModelFactory)); //assume object\n    } else {\n      throw new Error('Unexpected model type. Expected model factory function, or scjson object.');\n    }\n\n    _this._model = initializeModel(model, _this.opts);\n\n    _this.opts.console = _this.opts.console || (typeof console === 'undefined' ? { log: function log() {} } : console); //rely on global console if this console is undefined\n    _this.opts.Set = _this.opts.Set || ArraySet;\n    _this.opts.priorityComparisonFn = _this.opts.priorityComparisonFn || getTransitionWithHigherSourceChildPriority;\n    _this.opts.transitionSelector = _this.opts.transitionSelector || scxmlPrefixTransitionSelector;\n\n    _this.opts.sessionRegistry.set(String(_this.opts.sessionid), _this);\n\n    _this._scriptingContext.log = _this._scriptingContext.log || function log() {\n      if (this.opts.console.log.apply) {\n        this.opts.console.log.apply(this.opts.console, arguments);\n      } else {\n        //console.log on older IE does not support Function.apply, so just pass him the first argument. Best we can do for now.\n        this.opts.console.log(Array.prototype.slice.apply(arguments).join(','));\n      }\n    }.bind(_this); //set up default scripting context log function\n\n    _this._externalEventQueue = [];\n    _this._internalEventQueue = [];\n\n    if (_this.opts.params) {\n      _this._model.$deserializeDatamodel(_this.opts.params); //load up the datamodel\n    }\n\n    //check if we're loading from a previous snapshot\n    if (_this.opts.snapshot) {\n      _this._configuration = new _this.opts.Set(deserializeSerializedConfiguration(_this.opts.snapshot[0], _this._model.$idToStateMap));\n      _this._historyValue = deserializeHistory(_this.opts.snapshot[1], _this._model.$idToStateMap);\n      _this._isInFinalState = _this.opts.snapshot[2];\n      _this._model.$deserializeDatamodel(_this.opts.snapshot[3]); //load up the datamodel\n      _this._internalEventQueue = _this.opts.snapshot[4];\n    } else {\n      _this._configuration = new _this.opts.Set();\n      _this._historyValue = {};\n      _this._isInFinalState = false;\n    }\n\n    //add debug logging\n    BaseInterpreter.EVENTS.forEach(function (event) {\n      this.on(event, this._log.bind(this, event));\n    }, _this);\n\n    module.exports.emit('new', _this);\n    return _this;\n  }\n\n  /** \n  * Cancels the session. This clears all timers; puts the interpreter in a\n  * final state; and runs all exit actions on current states.\n  * @memberof BaseInterpreter.prototype\n  */\n\n\n  _createClass(BaseInterpreter, [{\n    key: 'cancel',\n    value: function cancel() {\n      delete this.opts.parentSession;\n      if (this._isInFinalState) return;\n      this._isInFinalState = true;\n      this._log('session cancelled ' + this.opts.invokeid);\n      this._exitInterpreter(null);\n    }\n  }, {\n    key: '_exitInterpreter',\n    value: function _exitInterpreter(event) {\n      var _this2 = this;\n\n      //TODO: cancel invoked sessions\n      //cancel all delayed sends when we enter into a final state.\n      this._cancelAllDelayedSends();\n\n      var statesToExit = this._getFullConfiguration().sort(getStateWithHigherSourceChildPriority);\n\n      for (var j = 0, len = statesToExit.length; j < len; j++) {\n        var stateExited = statesToExit[j];\n\n        if (stateExited.onExit !== undefined) {\n          for (var exitIdx = 0, exitLen = stateExited.onExit.length; exitIdx < exitLen; exitIdx++) {\n            var block = stateExited.onExit[exitIdx];\n            for (var blockIdx = 0, blockLen = block.length; blockIdx < blockLen; blockIdx++) {\n              var actionRef = block[blockIdx];\n              try {\n                actionRef.call(this._scriptingContext, null);\n              } catch (e) {\n                this._handleError(e, actionRef);\n                break;\n              }\n            }\n          }\n        }\n\n        //cancel invoked session\n        if (stateExited.invokes) stateExited.invokes.forEach(function (invoke) {\n          _this2._scriptingContext.cancelInvoke(invoke.id);\n        });\n\n        //if he is a top-level <final> state, then return the done event\n        if (stateExited.$type === 'final' && stateExited.parent.$type === 'scxml') {\n\n          if (this.opts.parentSession) {\n            this._scriptingContext.send({\n              target: '#_parent',\n              name: 'done.invoke.' + this.opts.invokeid,\n              data: stateExited.donedata && stateExited.donedata.call(this._scriptingContext, event)\n            });\n          }\n\n          this.opts.sessionRegistry.delete(this.opts.sessionid);\n          this.emit('onExitInterpreter', event);\n        }\n      }\n    }\n\n    /** \n     * Starts the interpreter. Should only be called once, and should be called\n     * before BaseInterpreter.prototype#gen is called for the first time.  Returns a\n     * Configuration.\n     * @return {Configuration}\n     * @memberof BaseInterpreter.prototype\n     * @emits scion.BaseInterpreter#onEntry\n     * @emits scion.BaseInterpreter#onExit\n     * @emits scion.BaseInterpreter#onTransition\n     * @emits scion.BaseInterpreter#onDefaultEntry\n     * @emits scion.BaseInterpreter#onError\n     * @emits scion.BaseInterpreter#onBigStepBegin\n     * @emits scion.BaseInterpreter#onBigStepEnd\n     * @emits scion.BaseInterpreter#onBigStepSuspend\n     * @emits scion.BaseInterpreter#onBigStepResume\n     * @emits scion.BaseInterpreter#onSmallStepBegin\n     * @emits scion.BaseInterpreter#onSmallStepEnd\n     * @emits scion.BaseInterpreter#onBigStepEnd\n     * @emits scion.BaseInterpreter#onExitInterpreter\n     */\n\n  }, {\n    key: 'start',\n    value: function start() {\n      this._initStart();\n      this._performBigStep();\n      return this.getConfiguration();\n    }\n\n    /**\n     * This callback is displayed as a global member.\n     * @callback genCallback\n     * @param {Error} err\n     * @param {Configuration} configuration\n     */\n\n    /**\n     * Starts the interpreter asynchronously\n     * @param  {genCallback} cb Callback invoked with an error or the interpreter's stable configuration\n     * @memberof BaseInterpreter.prototype \n     * @emits scion.BaseInterpreter#onEntry\n     * @emits scion.BaseInterpreter#onExit\n     * @emits scion.BaseInterpreter#onTransition\n     * @emits scion.BaseInterpreter#onDefaultEntry\n     * @emits scion.BaseInterpreter#onError\n     * @emits scion.BaseInterpreter#onBigStepBegin\n     * @emits scion.BaseInterpreter#onBigStepEnd\n     * @emits scion.BaseInterpreter#onBigStepSuspend\n     * @emits scion.BaseInterpreter#onBigStepResume\n     * @emits scion.BaseInterpreter#onSmallStepBegin\n     * @emits scion.BaseInterpreter#onSmallStepEnd\n     * @emits scion.BaseInterpreter#onBigStepEnd\n     * @emits scion.BaseInterpreter#onExitInterpreter\n     */\n\n  }, {\n    key: 'startAsync',\n    value: function startAsync(cb) {\n      cb = this._initStart(cb);\n      this.genAsync(null, cb);\n    }\n  }, {\n    key: '_initStart',\n    value: function _initStart(cb) {\n      var _this3 = this;\n\n      if (typeof cb !== 'function') {\n        cb = nop;\n      }\n\n      this._log(\"performing initial big step\");\n\n      //We effectively need to figure out states to enter here to populate initial config. assuming root is compound state makes this simple.\n      //but if we want it to be parallel, then this becomes more complex. so when initializing the model, we add a 'fake' root state, which\n      //makes the following operation safe.\n      this._model.initialRef.forEach(function (s) {\n        return _this3._configuration.add(s);\n      });\n\n      return cb;\n    }\n\n    /** \n    * Returns state machine {@link Configuration}.\n    * @return {Configuration}\n    * @memberof BaseInterpreter.prototype \n    */\n\n  }, {\n    key: 'getConfiguration',\n    value: function getConfiguration() {\n      return this._configuration.iter().map(function (s) {\n        return s.id;\n      });\n    }\n  }, {\n    key: '_getFullConfiguration',\n    value: function _getFullConfiguration() {\n      return this._configuration.iter().map(function (s) {\n        return [s].concat(query.getAncestors(s));\n      }, this).reduce(function (a, b) {\n        return a.concat(b);\n      }, []). //flatten\n      reduce(function (a, b) {\n        return a.indexOf(b) > -1 ? a : a.concat(b);\n      }, []); //uniq\n    }\n\n    /** \n    * @return {FullConfiguration}\n    * @memberof BaseInterpreter.prototype \n    */\n\n  }, {\n    key: 'getFullConfiguration',\n    value: function getFullConfiguration() {\n      return this._getFullConfiguration().map(function (s) {\n        return s.id;\n      });\n    }\n\n    /** \n    * @return {boolean}\n    * @memberof BaseInterpreter.prototype \n    * @param {string} stateName\n    */\n\n  }, {\n    key: 'isIn',\n    value: function isIn(stateName) {\n      return this.getFullConfiguration().indexOf(stateName) > -1;\n    }\n\n    /** \n    * Is the state machine in a final state?\n    * @return {boolean}\n    * @memberof BaseInterpreter.prototype \n    */\n\n  }, {\n    key: 'isFinal',\n    value: function isFinal() {\n      return this._isInFinalState;\n    }\n\n    /** @private */\n\n  }, {\n    key: '_performBigStep',\n    value: function _performBigStep(e) {\n      var currentEvent = void 0,\n          keepGoing = void 0,\n          allStatesExited = void 0,\n          allStatesEntered = void 0;\n\n      var _startBigStep2 = this._startBigStep(e);\n\n      var _startBigStep3 = _slicedToArray(_startBigStep2, 4);\n\n      allStatesExited = _startBigStep3[0];\n      allStatesEntered = _startBigStep3[1];\n      keepGoing = _startBigStep3[2];\n      currentEvent = _startBigStep3[3];\n\n\n      while (keepGoing) {\n        var _selectTransitionsAnd = this._selectTransitionsAndPerformSmallStep(currentEvent, allStatesEntered, allStatesExited);\n\n        var _selectTransitionsAnd2 = _slicedToArray(_selectTransitionsAnd, 2);\n\n        currentEvent = _selectTransitionsAnd2[0];\n        keepGoing = _selectTransitionsAnd2[1];\n      }\n\n      this._finishBigStep(currentEvent, allStatesEntered, allStatesExited);\n    }\n  }, {\n    key: '_selectTransitionsAndPerformSmallStep',\n    value: function _selectTransitionsAndPerformSmallStep(currentEvent, allStatesEntered, allStatesExited) {\n      //first select with null event\n      var selectedTransitions = this._selectTransitions(currentEvent, true);\n      if (selectedTransitions.isEmpty()) {\n        var ev = this._internalEventQueue.shift();\n        if (ev) {\n          currentEvent = ev;\n          selectedTransitions = this._selectTransitions(currentEvent, false);\n        }\n      }\n\n      if (!selectedTransitions.isEmpty()) {\n        this.emit('onSmallStepBegin', currentEvent);\n        var statesExited = void 0,\n            statesEntered = void 0;\n\n        var _performSmallStep2 = this._performSmallStep(currentEvent, selectedTransitions);\n\n        var _performSmallStep3 = _slicedToArray(_performSmallStep2, 2);\n\n        statesExited = _performSmallStep3[0];\n        statesEntered = _performSmallStep3[1];\n\n        if (statesExited) statesExited.forEach(function (s) {\n          return allStatesExited.add(s);\n        });\n        if (statesEntered) statesEntered.forEach(function (s) {\n          return allStatesEntered.add(s);\n        });\n        this.emit('onSmallStepEnd', currentEvent);\n      }\n      var keepGoing = !selectedTransitions.isEmpty() || this._internalEventQueue.length;\n      return [currentEvent, keepGoing];\n    }\n  }, {\n    key: '_startBigStep',\n    value: function _startBigStep(e) {\n      var _this4 = this;\n\n      this.emit('onBigStepBegin', e);\n\n      //do applyFinalize and autoforward\n      this._configuration.iter().forEach(function (state) {\n        if (state.invokes) state.invokes.forEach(function (invoke) {\n          if (invoke.autoforward) {\n            //autoforward\n            _this4._scriptingContext.send({\n              target: '#_' + invoke.id,\n              name: e.name,\n              data: e.data\n            });\n          }\n          if (invoke.id === e.invokeid) {\n            //applyFinalize\n            if (invoke.finalize) invoke.finalize.forEach(function (action) {\n              return _this4._evaluateAction(e, action);\n            });\n          }\n        });\n      });\n\n      if (e) this._internalEventQueue.push(e);\n\n      var allStatesExited = new Set(),\n          allStatesEntered = new Set();\n      var keepGoing = true;\n      var currentEvent = e;\n      return [allStatesEntered, allStatesExited, keepGoing, currentEvent];\n    }\n  }, {\n    key: '_finishBigStep',\n    value: function _finishBigStep(e, allStatesEntered, allStatesExited, cb) {\n      var _this5 = this;\n\n      var statesToInvoke = Array.from(new Set([].concat(_toConsumableArray(allStatesEntered)).filter(function (s) {\n        return s.invokes && !allStatesExited.has(s);\n      }))).sort(sortInEntryOrder);\n\n      // Here we invoke whatever needs to be invoked. The implementation of 'invoke' is platform-specific\n      statesToInvoke.forEach(function (s) {\n        s.invokes.forEach(function (f) {\n          return _this5._evaluateAction(e, f);\n        });\n      });\n\n      // cancel invoke for allStatesExited\n      allStatesExited.forEach(function (s) {\n        if (s.invokes) s.invokes.forEach(function (invoke) {\n          _this5._scriptingContext.cancelInvoke(invoke.id);\n        });\n      });\n\n      // TODO: Invoking may have raised internal error events and we iterate to handle them        \n      //if not internalQueue.isEmpty():\n      //    continue\n\n      this._isInFinalState = this._configuration.iter().every(function (s) {\n        return s.typeEnum === FINAL;\n      });\n      if (this._isInFinalState) {\n        this._exitInterpreter(e);\n      }\n      this.emit('onBigStepEnd', e);\n      if (cb) cb(undefined, this.getConfiguration());\n    }\n  }, {\n    key: '_cancelAllDelayedSends',\n    value: function _cancelAllDelayedSends() {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this._scriptingContext._timeouts[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var timeoutOptions = _step.value;\n\n          if (!timeoutOptions.sendOptions.delay) continue;\n          this._log('cancelling delayed send', timeoutOptions);\n          clearTimeout(timeoutOptions.timeoutHandle);\n          this._scriptingContext._timeouts.delete(timeoutOptions);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      Object.keys(this._scriptingContext._timeoutMap).forEach(function (key) {\n        delete this._scriptingContext._timeoutMap[key];\n      }, this);\n    }\n  }, {\n    key: '_performBigStepAsync',\n    value: function _performBigStepAsync(e, cb) {\n      var currentEvent = void 0,\n          keepGoing = void 0,\n          allStatesExited = void 0,\n          allStatesEntered = void 0;\n\n      var _startBigStep4 = this._startBigStep(e);\n\n      var _startBigStep5 = _slicedToArray(_startBigStep4, 4);\n\n      allStatesExited = _startBigStep5[0];\n      allStatesEntered = _startBigStep5[1];\n      keepGoing = _startBigStep5[2];\n      currentEvent = _startBigStep5[3];\n\n\n      function nextStep(emit) {\n        this.emit(emit);\n\n        var _selectTransitionsAnd3 = this._selectTransitionsAndPerformSmallStep(currentEvent, allStatesEntered, allStatesExited);\n\n        var _selectTransitionsAnd4 = _slicedToArray(_selectTransitionsAnd3, 2);\n\n        currentEvent = _selectTransitionsAnd4[0];\n        keepGoing = _selectTransitionsAnd4[1];\n\n\n        if (keepGoing) {\n          this.emit('onBigStepSuspend');\n          setImmediate(nextStep.bind(this, 'onBigStepResume'));\n        } else {\n          this._finishBigStep(currentEvent, allStatesEntered, allStatesExited, cb);\n        }\n      }\n      nextStep.call(this, 'onBigStepBegin');\n    }\n\n    /** @private */\n\n  }, {\n    key: '_performSmallStep',\n    value: function _performSmallStep(currentEvent, selectedTransitions) {\n\n      this._log(\"selecting transitions with currentEvent\", currentEvent);\n\n      this._log(\"selected transitions\", selectedTransitions);\n\n      var statesExited = void 0,\n          statesEntered = void 0;\n\n      if (!selectedTransitions.isEmpty()) {\n\n        //we only want to enter and exit states from transitions with targets\n        //filter out targetless transitions here - we will only use these to execute transition actions\n        var selectedTransitionsWithTargets = new this.opts.Set(selectedTransitions.iter().filter(transitionWithTargets));\n\n        statesExited = this._exitStates(currentEvent, selectedTransitionsWithTargets);\n        this._executeTransitions(currentEvent, selectedTransitions);\n        statesEntered = this._enterStates(currentEvent, selectedTransitionsWithTargets);\n\n        this._log(\"new configuration \", this._configuration);\n      }\n\n      return [statesExited, statesEntered];\n    }\n  }, {\n    key: '_exitStates',\n    value: function _exitStates(currentEvent, selectedTransitionsWithTargets) {\n      var basicStatesExited = void 0,\n          statesExited = void 0;\n\n      var _getStatesExited2 = this._getStatesExited(selectedTransitionsWithTargets);\n\n      var _getStatesExited3 = _slicedToArray(_getStatesExited2, 2);\n\n      basicStatesExited = _getStatesExited3[0];\n      statesExited = _getStatesExited3[1];\n\n\n      this._log('exiting states');\n      for (var j = 0, len = statesExited.length; j < len; j++) {\n        var stateExited = statesExited[j];\n\n        if (stateExited.isAtomic) this._configuration.remove(stateExited);\n\n        this._log(\"exiting \", stateExited.id);\n\n        //invoke listeners\n        this.emit('onExit', stateExited.id);\n\n        if (stateExited.onExit !== undefined) {\n          for (var exitIdx = 0, exitLen = stateExited.onExit.length; exitIdx < exitLen; exitIdx++) {\n            var block = stateExited.onExit[exitIdx];\n            for (var blockIdx = 0, blockLen = block.length; blockIdx < blockLen; blockIdx++) {\n              var actionRef = block[blockIdx];\n              try {\n                actionRef.call(this._scriptingContext, currentEvent);\n              } catch (e) {\n                this._handleError(e, actionRef);\n                break;\n              }\n            }\n          }\n        }\n\n        var f;\n        if (stateExited.historyRef) {\n          var _iteratorNormalCompletion2 = true;\n          var _didIteratorError2 = false;\n          var _iteratorError2 = undefined;\n\n          try {\n            for (var _iterator2 = stateExited.historyRef[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              var historyRef = _step2.value;\n\n              if (historyRef.isDeep) {\n                f = function f(s0) {\n                  return s0.typeEnum === BASIC && stateExited.descendants.indexOf(s0) > -1;\n                };\n              } else {\n                f = function f(s0) {\n                  return s0.parent === stateExited;\n                };\n              }\n              //update history\n              this._historyValue[historyRef.id] = statesExited.filter(f);\n            }\n          } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                _iterator2.return();\n              }\n            } finally {\n              if (_didIteratorError2) {\n                throw _iteratorError2;\n              }\n            }\n          }\n        }\n      }\n\n      return statesExited;\n    }\n\n    /** @private */\n\n  }, {\n    key: '_getStatesExited',\n    value: function _getStatesExited(transitions) {\n      var statesExited = new this.opts.Set();\n      var basicStatesExited = new this.opts.Set();\n\n      //States exited are defined to be active states that are\n      //descendants of the scope of each priority-enabled transition.\n      //Here, we iterate through the transitions, and collect states\n      //that match this condition. \n      var transitionList = transitions.iter();\n      for (var txIdx = 0, txLen = transitionList.length; txIdx < txLen; txIdx++) {\n        var transition = transitionList[txIdx];\n        var scope = transition.scope,\n            desc = scope.descendants;\n\n        //For each state in the configuration\n        //is that state a descendant of the transition scope?\n        //Store ancestors of that state up to but not including the scope.\n        var configList = this._configuration.iter();\n        for (var cfgIdx = 0, cfgLen = configList.length; cfgIdx < cfgLen; cfgIdx++) {\n          var state = configList[cfgIdx];\n          if (desc.indexOf(state) > -1) {\n            basicStatesExited.add(state);\n            statesExited.add(state);\n            var ancestors = query.getAncestors(state, scope);\n            for (var ancIdx = 0, ancLen = ancestors.length; ancIdx < ancLen; ancIdx++) {\n              statesExited.add(ancestors[ancIdx]);\n            }\n          }\n        }\n      }\n\n      var sortedStatesExited = statesExited.iter().sort(getStateWithHigherSourceChildPriority);\n      return [basicStatesExited, sortedStatesExited];\n    }\n  }, {\n    key: '_executeTransitions',\n    value: function _executeTransitions(currentEvent, selectedTransitions) {\n      var sortedTransitions = selectedTransitions.iter().sort(transitionComparator);\n\n      this._log(\"executing transitition actions\");\n      for (var stxIdx = 0, len = sortedTransitions.length; stxIdx < len; stxIdx++) {\n        var transition = sortedTransitions[stxIdx];\n\n        var targetIds = transition.targets && transition.targets.map(function (target) {\n          return target.id;\n        });\n\n        this.emit('onTransition', transition.source.id, targetIds, transition.source.transitions.indexOf(transition));\n\n        if (transition.onTransition !== undefined) {\n          for (var txIdx = 0, txLen = transition.onTransition.length; txIdx < txLen; txIdx++) {\n            var actionRef = transition.onTransition[txIdx];\n            try {\n              actionRef.call(this._scriptingContext, currentEvent);\n            } catch (e) {\n              this._handleError(e, actionRef);\n              break;\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: '_enterStates',\n    value: function _enterStates(currentEvent, selectedTransitionsWithTargets) {\n      var _this6 = this;\n\n      this._log(\"entering states\");\n\n      var statesEntered = new Set();\n      var statesForDefaultEntry = new Set();\n      // initialize the temporary table for default content in history states\n      var defaultHistoryContent = {};\n      this._computeEntrySet(selectedTransitionsWithTargets, statesEntered, statesForDefaultEntry, defaultHistoryContent);\n      statesEntered = Array.from(statesEntered).sort(sortInEntryOrder);\n\n      this._log(\"statesEntered \", statesEntered);\n\n      for (var enterIdx = 0, enterLen = statesEntered.length; enterIdx < enterLen; enterIdx++) {\n        var stateEntered = statesEntered[enterIdx];\n\n        if (stateEntered.isAtomic) this._configuration.add(stateEntered);\n\n        this._log(\"entering\", stateEntered.id);\n\n        this.emit('onEntry', stateEntered.id);\n\n        if (stateEntered.onEntry !== undefined) {\n          for (var entryIdx = 0, entryLen = stateEntered.onEntry.length; entryIdx < entryLen; entryIdx++) {\n            var block = stateEntered.onEntry[entryIdx];\n            for (var blockIdx = 0, blockLen = block.length; blockIdx < blockLen; blockIdx++) {\n              var actionRef = block[blockIdx];\n              try {\n                actionRef.call(this._scriptingContext, currentEvent);\n              } catch (e) {\n                this._handleError(e, actionRef);\n                break;\n              }\n            }\n          }\n        }\n\n        if (statesForDefaultEntry.has(stateEntered)) {\n          var _iteratorNormalCompletion3 = true;\n          var _didIteratorError3 = false;\n          var _iteratorError3 = undefined;\n\n          try {\n            for (var _iterator3 = stateEntered.initialRef[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              var initialState = _step3.value;\n\n              this.emit('onDefaultEntry', initialState.id);\n              if (initialState.typeEnum === INITIAL) {\n                var transition = initialState.transitions[0];\n                if (transition.onTransition !== undefined) {\n                  this._log('executing initial transition content for initial state of parent state', stateEntered.id);\n                  for (var txIdx = 0, txLen = transition.onTransition.length; txIdx < txLen; txIdx++) {\n                    var _actionRef = transition.onTransition[txIdx];\n                    try {\n                      _actionRef.call(this._scriptingContext, currentEvent);\n                    } catch (e) {\n                      this._handleError(e, _actionRef);\n                      break;\n                    }\n                  }\n                }\n              }\n            }\n          } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                _iterator3.return();\n              }\n            } finally {\n              if (_didIteratorError3) {\n                throw _iteratorError3;\n              }\n            }\n          }\n        }\n\n        if (defaultHistoryContent[stateEntered.id]) {\n          var _transition = defaultHistoryContent[stateEntered.id];\n          if (_transition.onTransition !== undefined) {\n            this._log('executing history transition content for history state of parent state', stateEntered.id);\n            for (var txIdx = 0, txLen = _transition.onTransition.length; txIdx < txLen; txIdx++) {\n              var _actionRef2 = _transition.onTransition[txIdx];\n              try {\n                _actionRef2.call(this._scriptingContext, currentEvent);\n              } catch (e) {\n                this._handleError(e, _actionRef2);\n                break;\n              }\n            }\n          }\n        }\n      }\n\n      for (var enterIdx = 0, enterLen = statesEntered.length; enterIdx < enterLen; enterIdx++) {\n        var stateEntered = statesEntered[enterIdx];\n        if (stateEntered.typeEnum === FINAL) {\n          var parent = stateEntered.parent;\n          var grandparent = parent.parent;\n          this._internalEventQueue.push({ name: \"done.state.\" + parent.id, data: stateEntered.donedata && stateEntered.donedata.call(this._scriptingContext, currentEvent) });\n          if (grandparent && grandparent.typeEnum === PARALLEL) {\n            if (grandparent.states.every(function (s) {\n              return _this6.isInFinalState(s);\n            })) {\n              this._internalEventQueue.push({ name: \"done.state.\" + grandparent.id });\n            }\n          }\n        }\n      }\n\n      return statesEntered;\n    }\n  }, {\n    key: '_getEffectiveTargetStates',\n    value: function _getEffectiveTargetStates(transition) {\n      var targets = new Set();\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = transition.targets[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var s = _step4.value;\n\n          if (s.typeEnum === HISTORY) {\n            if (s.id in this._historyValue) this._historyValue[s.id].forEach(function (state) {\n              return targets.add(state);\n            });else [].concat(_toConsumableArray(this._getEffectiveTargetStates(s.transitions[0]))).forEach(function (state) {\n              return targets.add(state);\n            });\n          } else {\n            targets.add(s);\n          }\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n\n      return targets;\n    }\n  }, {\n    key: '_computeEntrySet',\n    value: function _computeEntrySet(transitions, statesToEnter, statesForDefaultEntry, defaultHistoryContent) {\n      var _iteratorNormalCompletion5 = true;\n      var _didIteratorError5 = false;\n      var _iteratorError5 = undefined;\n\n      try {\n        for (var _iterator5 = transitions.iter()[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n          var t = _step5.value;\n          var _iteratorNormalCompletion6 = true;\n          var _didIteratorError6 = false;\n          var _iteratorError6 = undefined;\n\n          try {\n            for (var _iterator6 = t.targets[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n              var s = _step6.value;\n\n              this._addDescendantStatesToEnter(s, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n            }\n          } catch (err) {\n            _didIteratorError6 = true;\n            _iteratorError6 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion6 && _iterator6.return) {\n                _iterator6.return();\n              }\n            } finally {\n              if (_didIteratorError6) {\n                throw _iteratorError6;\n              }\n            }\n          }\n\n          var ancestor = t.scope;\n          var _iteratorNormalCompletion7 = true;\n          var _didIteratorError7 = false;\n          var _iteratorError7 = undefined;\n\n          try {\n            for (var _iterator7 = this._getEffectiveTargetStates(t)[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n              var _s = _step7.value;\n\n              this._addAncestorStatesToEnter(_s, ancestor, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n            }\n          } catch (err) {\n            _didIteratorError7 = true;\n            _iteratorError7 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion7 && _iterator7.return) {\n                _iterator7.return();\n              }\n            } finally {\n              if (_didIteratorError7) {\n                throw _iteratorError7;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError5 = true;\n        _iteratorError5 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion5 && _iterator5.return) {\n            _iterator5.return();\n          }\n        } finally {\n          if (_didIteratorError5) {\n            throw _iteratorError5;\n          }\n        }\n      }\n    }\n  }, {\n    key: '_computeExitSet',\n    value: function _computeExitSet(transitions) {\n      var statesToExit = new Set();\n      var _iteratorNormalCompletion8 = true;\n      var _didIteratorError8 = false;\n      var _iteratorError8 = undefined;\n\n      try {\n        for (var _iterator8 = transitions[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {\n          var t = _step8.value;\n\n          if (t.targets) {\n            var scope = t.scope;\n            var _iteratorNormalCompletion9 = true;\n            var _didIteratorError9 = false;\n            var _iteratorError9 = undefined;\n\n            try {\n              for (var _iterator9 = this._getFullConfiguration()[Symbol.iterator](), _step9; !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {\n                var s = _step9.value;\n\n                if (query.isDescendant(s, scope)) statesToExit.add(s);\n              }\n            } catch (err) {\n              _didIteratorError9 = true;\n              _iteratorError9 = err;\n            } finally {\n              try {\n                if (!_iteratorNormalCompletion9 && _iterator9.return) {\n                  _iterator9.return();\n                }\n              } finally {\n                if (_didIteratorError9) {\n                  throw _iteratorError9;\n                }\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError8 = true;\n        _iteratorError8 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion8 && _iterator8.return) {\n            _iterator8.return();\n          }\n        } finally {\n          if (_didIteratorError8) {\n            throw _iteratorError8;\n          }\n        }\n      }\n\n      return statesToExit;\n    }\n  }, {\n    key: '_addAncestorStatesToEnter',\n    value: function _addAncestorStatesToEnter(state, ancestor, statesToEnter, statesForDefaultEntry, defaultHistoryContent) {\n      var _this7 = this;\n\n      var traverse = function traverse(anc) {\n        if (anc.typeEnum === PARALLEL) {\n          var _iteratorNormalCompletion10 = true;\n          var _didIteratorError10 = false;\n          var _iteratorError10 = undefined;\n\n          try {\n            var _loop = function _loop() {\n              var child = _step10.value;\n\n              if (child.typeEnum !== HISTORY && ![].concat(_toConsumableArray(statesToEnter)).some(function (s) {\n                return query.isDescendant(s, child);\n              })) {\n                _this7._addDescendantStatesToEnter(child, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n              }\n            };\n\n            for (var _iterator10 = anc.states[Symbol.iterator](), _step10; !(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done); _iteratorNormalCompletion10 = true) {\n              _loop();\n            }\n          } catch (err) {\n            _didIteratorError10 = true;\n            _iteratorError10 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion10 && _iterator10.return) {\n                _iterator10.return();\n              }\n            } finally {\n              if (_didIteratorError10) {\n                throw _iteratorError10;\n              }\n            }\n          }\n        }\n      };\n      var _iteratorNormalCompletion11 = true;\n      var _didIteratorError11 = false;\n      var _iteratorError11 = undefined;\n\n      try {\n        for (var _iterator11 = query.getAncestors(state, ancestor)[Symbol.iterator](), _step11; !(_iteratorNormalCompletion11 = (_step11 = _iterator11.next()).done); _iteratorNormalCompletion11 = true) {\n          var anc = _step11.value;\n\n          statesToEnter.add(anc);\n          traverse(anc);\n        }\n      } catch (err) {\n        _didIteratorError11 = true;\n        _iteratorError11 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion11 && _iterator11.return) {\n            _iterator11.return();\n          }\n        } finally {\n          if (_didIteratorError11) {\n            throw _iteratorError11;\n          }\n        }\n      }\n\n      traverse(ancestor);\n    }\n  }, {\n    key: '_addDescendantStatesToEnter',\n    value: function _addDescendantStatesToEnter(state, statesToEnter, statesForDefaultEntry, defaultHistoryContent) {\n      var _this8 = this;\n\n      if (state.typeEnum === HISTORY) {\n        if (this._historyValue[state.id]) {\n          var _iteratorNormalCompletion12 = true;\n          var _didIteratorError12 = false;\n          var _iteratorError12 = undefined;\n\n          try {\n            for (var _iterator12 = this._historyValue[state.id][Symbol.iterator](), _step12; !(_iteratorNormalCompletion12 = (_step12 = _iterator12.next()).done); _iteratorNormalCompletion12 = true) {\n              var s = _step12.value;\n\n              this._addDescendantStatesToEnter(s, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n            }\n          } catch (err) {\n            _didIteratorError12 = true;\n            _iteratorError12 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion12 && _iterator12.return) {\n                _iterator12.return();\n              }\n            } finally {\n              if (_didIteratorError12) {\n                throw _iteratorError12;\n              }\n            }\n          }\n\n          var _iteratorNormalCompletion13 = true;\n          var _didIteratorError13 = false;\n          var _iteratorError13 = undefined;\n\n          try {\n            for (var _iterator13 = this._historyValue[state.id][Symbol.iterator](), _step13; !(_iteratorNormalCompletion13 = (_step13 = _iterator13.next()).done); _iteratorNormalCompletion13 = true) {\n              var _s2 = _step13.value;\n\n              this._addAncestorStatesToEnter(_s2, state.parent, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n            }\n          } catch (err) {\n            _didIteratorError13 = true;\n            _iteratorError13 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion13 && _iterator13.return) {\n                _iterator13.return();\n              }\n            } finally {\n              if (_didIteratorError13) {\n                throw _iteratorError13;\n              }\n            }\n          }\n        } else {\n          defaultHistoryContent[state.parent.id] = state.transitions[0];\n          var _iteratorNormalCompletion14 = true;\n          var _didIteratorError14 = false;\n          var _iteratorError14 = undefined;\n\n          try {\n            for (var _iterator14 = state.transitions[0].targets[Symbol.iterator](), _step14; !(_iteratorNormalCompletion14 = (_step14 = _iterator14.next()).done); _iteratorNormalCompletion14 = true) {\n              var _s3 = _step14.value;\n\n              this._addDescendantStatesToEnter(_s3, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n            }\n          } catch (err) {\n            _didIteratorError14 = true;\n            _iteratorError14 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion14 && _iterator14.return) {\n                _iterator14.return();\n              }\n            } finally {\n              if (_didIteratorError14) {\n                throw _iteratorError14;\n              }\n            }\n          }\n\n          var _iteratorNormalCompletion15 = true;\n          var _didIteratorError15 = false;\n          var _iteratorError15 = undefined;\n\n          try {\n            for (var _iterator15 = state.transitions[0].targets[Symbol.iterator](), _step15; !(_iteratorNormalCompletion15 = (_step15 = _iterator15.next()).done); _iteratorNormalCompletion15 = true) {\n              var _s4 = _step15.value;\n\n              this._addAncestorStatesToEnter(_s4, state.parent, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n            }\n          } catch (err) {\n            _didIteratorError15 = true;\n            _iteratorError15 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion15 && _iterator15.return) {\n                _iterator15.return();\n              }\n            } finally {\n              if (_didIteratorError15) {\n                throw _iteratorError15;\n              }\n            }\n          }\n        }\n      } else {\n        statesToEnter.add(state);\n        if (state.typeEnum === COMPOSITE) {\n          statesForDefaultEntry.add(state);\n          //for each state in initialRef, if it is an initial state, then add ancestors and descendants.\n          var _iteratorNormalCompletion16 = true;\n          var _didIteratorError16 = false;\n          var _iteratorError16 = undefined;\n\n          try {\n            for (var _iterator16 = state.initialRef[Symbol.iterator](), _step16; !(_iteratorNormalCompletion16 = (_step16 = _iterator16.next()).done); _iteratorNormalCompletion16 = true) {\n              var _s5 = _step16.value;\n\n              var targets = _s5.typeEnum === INITIAL ? _s5.transitions[0].targets : [_s5];\n              var _iteratorNormalCompletion18 = true;\n              var _didIteratorError18 = false;\n              var _iteratorError18 = undefined;\n\n              try {\n                for (var _iterator18 = targets[Symbol.iterator](), _step18; !(_iteratorNormalCompletion18 = (_step18 = _iterator18.next()).done); _iteratorNormalCompletion18 = true) {\n                  var targetState = _step18.value;\n\n                  this._addDescendantStatesToEnter(targetState, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n                }\n              } catch (err) {\n                _didIteratorError18 = true;\n                _iteratorError18 = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion18 && _iterator18.return) {\n                    _iterator18.return();\n                  }\n                } finally {\n                  if (_didIteratorError18) {\n                    throw _iteratorError18;\n                  }\n                }\n              }\n            }\n          } catch (err) {\n            _didIteratorError16 = true;\n            _iteratorError16 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion16 && _iterator16.return) {\n                _iterator16.return();\n              }\n            } finally {\n              if (_didIteratorError16) {\n                throw _iteratorError16;\n              }\n            }\n          }\n\n          var _iteratorNormalCompletion17 = true;\n          var _didIteratorError17 = false;\n          var _iteratorError17 = undefined;\n\n          try {\n            for (var _iterator17 = state.initialRef[Symbol.iterator](), _step17; !(_iteratorNormalCompletion17 = (_step17 = _iterator17.next()).done); _iteratorNormalCompletion17 = true) {\n              var _s6 = _step17.value;\n\n              var _targets = _s6.typeEnum === INITIAL ? _s6.transitions[0].targets : [_s6];\n              var _iteratorNormalCompletion19 = true;\n              var _didIteratorError19 = false;\n              var _iteratorError19 = undefined;\n\n              try {\n                for (var _iterator19 = _targets[Symbol.iterator](), _step19; !(_iteratorNormalCompletion19 = (_step19 = _iterator19.next()).done); _iteratorNormalCompletion19 = true) {\n                  var _targetState = _step19.value;\n\n                  this._addAncestorStatesToEnter(_targetState, state, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n                }\n              } catch (err) {\n                _didIteratorError19 = true;\n                _iteratorError19 = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion19 && _iterator19.return) {\n                    _iterator19.return();\n                  }\n                } finally {\n                  if (_didIteratorError19) {\n                    throw _iteratorError19;\n                  }\n                }\n              }\n            }\n          } catch (err) {\n            _didIteratorError17 = true;\n            _iteratorError17 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion17 && _iterator17.return) {\n                _iterator17.return();\n              }\n            } finally {\n              if (_didIteratorError17) {\n                throw _iteratorError17;\n              }\n            }\n          }\n        } else {\n          if (state.typeEnum === PARALLEL) {\n            var _iteratorNormalCompletion20 = true;\n            var _didIteratorError20 = false;\n            var _iteratorError20 = undefined;\n\n            try {\n              var _loop2 = function _loop2() {\n                var child = _step20.value;\n\n                if (child.typeEnum !== HISTORY && ![].concat(_toConsumableArray(statesToEnter)).some(function (s) {\n                  return query.isDescendant(s, child);\n                })) {\n                  _this8._addDescendantStatesToEnter(child, statesToEnter, statesForDefaultEntry, defaultHistoryContent);\n                }\n              };\n\n              for (var _iterator20 = state.states[Symbol.iterator](), _step20; !(_iteratorNormalCompletion20 = (_step20 = _iterator20.next()).done); _iteratorNormalCompletion20 = true) {\n                _loop2();\n              }\n            } catch (err) {\n              _didIteratorError20 = true;\n              _iteratorError20 = err;\n            } finally {\n              try {\n                if (!_iteratorNormalCompletion20 && _iterator20.return) {\n                  _iterator20.return();\n                }\n              } finally {\n                if (_didIteratorError20) {\n                  throw _iteratorError20;\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: 'isInFinalState',\n    value: function isInFinalState(s) {\n      var _this9 = this;\n\n      if (s.typeEnum === COMPOSITE) {\n        return s.states.some(function (s) {\n          return s.typeEnum === FINAL && _this9._configuration.contains(s);\n        });\n      } else if (s.typeEnum === PARALLEL) {\n        return s.states.every(this.isInFinalState.bind(this));\n      } else {\n        return false;\n      }\n    }\n\n    /** @private */\n\n  }, {\n    key: '_evaluateAction',\n    value: function _evaluateAction(currentEvent, actionRef) {\n      try {\n        return actionRef.call(this._scriptingContext, currentEvent); //SCXML system variables\n      } catch (e) {\n        this._handleError(e, actionRef);\n      }\n    }\n  }, {\n    key: '_handleError',\n    value: function _handleError(e, actionRef) {\n      var event = e instanceof Error || typeof e.__proto__.name === 'string' && e.__proto__.name.match(/^.*Error$/) ? //we can't just do 'e instanceof Error', because the Error object in the sandbox is from a different context, and instanceof will return false\n      {\n        name: 'error.execution',\n        data: {\n          tagname: actionRef.tagname,\n          line: actionRef.line,\n          column: actionRef.column,\n          reason: e.message\n        },\n        type: 'platform'\n      } : e.name ? e : {\n        name: 'error.execution',\n        data: e,\n        type: 'platform'\n      };\n      this._internalEventQueue.push(event);\n      this.emit('onError', event);\n    }\n  }, {\n    key: '_log',\n    value: function _log() {\n      if (printTrace) {\n        var args = Array.from(arguments);\n        this.opts.console.log(args[0] + ': ' + args.slice(1).map(function (arg) {\n          return arg === null ? 'null' : arg === undefined ? 'undefined' : typeof arg === 'string' ? arg : arg.toString() === '[object Object]' ? util.inspect(arg) : arg.toString();\n        }).join(', ') + '\\n');\n      }\n    }\n\n    /**\n    * @interface Listener\n    */\n\n    /**\n    * @function\n    * @name Listener#onEntry \n    * @param {string} stateId\n    */\n\n    /**\n    * @function\n    * @name Listener#onExit \n    * @param {string} stateId\n    */\n\n    /**\n    * @function\n    * @name Listener#onTransition \n    * @param {string} sourceStateId Id of the source state\n    * @param {Array<string>} targetStatesIds Ids of the target states\n    * @param {number} transitionIndex Index of the transition relative to other transitions originating from source state.\n    */\n\n    /**\n    * @function\n    * @name Listener#onError\n    * @param {Error} errorInfo\n    */\n\n    /**\n    * @function\n    * @name Listener#onBigStepBegin\n    */\n\n    /**\n    * @function\n    * @name Listener#onBigStepResume\n    */\n\n    /**\n    * @function\n    * @name Listener#onBigStepSuspend\n    */\n\n    /**\n    * @function\n    * @name Listener#onBigStepEnd\n    */\n\n    /**\n    * @function\n    * @name Listener#onSmallStepBegin\n    * @param {string} event\n    */\n\n    /**\n    * @function\n    * @name Listener#onSmallStepEnd\n    */\n\n    /** \n    * Provides a generic mechanism to subscribe to state change and runtime\n    * error notifications.  Can be used for logging and debugging. For example,\n    * can attach a logger that simply logs the state changes.  Or can attach a\n    * network debugging client that sends state change notifications to a\n    * debugging server.\n    * This is an alternative interface to {@link EventEmitter.prototype#on}.\n    * @memberof BaseInterpreter.prototype \n    * @param {Listener} listener\n    */\n\n  }, {\n    key: 'registerListener',\n    value: function registerListener(listener) {\n      BaseInterpreter.EVENTS.forEach(function (event) {\n        if (listener[event]) this.on(event, listener[event]);\n      }, this);\n    }\n\n    /** \n    * Unregister a Listener\n    * @memberof BaseInterpreter.prototype \n    * @param {Listener} listener\n    */\n\n  }, {\n    key: 'unregisterListener',\n    value: function unregisterListener(listener) {\n      BaseInterpreter.EVENTS.forEach(function (event) {\n        if (listener[event]) this.off(event, listener[event]);\n      }, this);\n    }\n\n    /** \n    * Query the model to get all transition events.\n    * @return {Array<string>} Transition events.\n    * @memberof BaseInterpreter.prototype \n    */\n\n  }, {\n    key: 'getAllTransitionEvents',\n    value: function getAllTransitionEvents() {\n      var events = {};\n      function getEvents(state) {\n\n        if (state.transitions) {\n          for (var txIdx = 0, txLen = state.transitions.length; txIdx < txLen; txIdx++) {\n            events[state.transitions[txIdx].event] = true;\n          }\n        }\n\n        if (state.states) {\n          for (var stateIdx = 0, stateLen = state.states.length; stateIdx < stateLen; stateIdx++) {\n            getEvents(state.states[stateIdx]);\n          }\n        }\n      }\n\n      getEvents(this._model);\n\n      return Object.keys(events);\n    }\n\n    /**\n    * Three things capture the current snapshot of a running SCION interpreter:\n    *\n    *      <ul>\n    *      <li> basic configuration (the set of basic states the state machine is in)</li>\n    *      <li> history state values (the states the state machine was in last time it was in the parent of a history state)</li>\n    *      <li> the datamodel</li>\n    *      </ul>\n    *      \n    * The snapshot object can be serialized as JSON and saved to a database. It can\n    * later be passed to the SCXML constructor to restore the state machine\n    * using the snapshot argument.\n    *\n    * @return {Snapshot} \n    * @memberof BaseInterpreter.prototype \n    */\n\n  }, {\n    key: 'getSnapshot',\n    value: function getSnapshot() {\n      return [this.getConfiguration(), this._serializeHistory(), this._isInFinalState, this._model.$serializeDatamodel(), this._internalEventQueue.slice()];\n    }\n  }, {\n    key: '_serializeHistory',\n    value: function _serializeHistory() {\n      var o = {};\n      Object.keys(this._historyValue).forEach(function (sid) {\n        o[sid] = this._historyValue[sid].map(function (state) {\n          return state.id;\n        });\n      }, this);\n      return o;\n    }\n\n    /**\n     * @interface Event\n     */\n\n    /** \n    * @member name\n    * @memberof Event.prototype \n    * @type string\n    * @description The name of the event\n    */\n\n    /** \n    * @member data\n    * @memberof Event.prototype \n    * @type any\n    * @description The event data\n    */\n\n    /** \n    * An SCXML interpreter takes SCXML events as input, where an SCXML event is an\n    * object with \"name\" and \"data\" properties. These can be passed to method `gen`\n    * as two positional arguments, or as a single object.\n    * @param {string|Event} evtObjOrName\n    * @param {any=} optionalData\n    * @emits scion.BaseInterpreter#onEntry\n    * @emits scion.BaseInterpreter#onExit\n    * @emits scion.BaseInterpreter#onTransition\n    * @emits scion.BaseInterpreter#onDefaultEntry\n    * @emits scion.BaseInterpreter#onError\n    * @emits scion.BaseInterpreter#onBigStepBegin\n    * @emits scion.BaseInterpreter#onBigStepEnd\n    * @emits scion.BaseInterpreter#onBigStepSuspend\n    * @emits scion.BaseInterpreter#onBigStepResume\n    * @emits scion.BaseInterpreter#onSmallStepBegin\n    * @emits scion.BaseInterpreter#onSmallStepEnd\n    * @emits scion.BaseInterpreter#onBigStepEnd\n    * @emits scion.BaseInterpreter#onExitInterpreter\n    */\n\n  }, {\n    key: 'gen',\n    value: function gen(evtObjOrName, optionalData) {\n      var currentEvent;\n      switch (typeof evtObjOrName === 'undefined' ? 'undefined' : _typeof(evtObjOrName)) {\n        case 'string':\n          currentEvent = { name: evtObjOrName, data: optionalData };\n          break;\n        case 'object':\n          if (typeof evtObjOrName.name === 'string') {\n            currentEvent = evtObjOrName;\n          } else {\n            throw new Error('Event object must have \"name\" property of type string.');\n          }\n          break;\n        default:\n          throw new Error('First argument to gen must be a string or object.');\n      }\n\n      if (this._isStepping) throw new Error('Cannot call gen during a big-step');\n\n      //otherwise, kick him off\n      this._isStepping = true;\n\n      this._performBigStep(currentEvent);\n\n      this._isStepping = false;\n      return this.getConfiguration();\n    }\n\n    /**\n    * Injects an external event into the interpreter asynchronously\n    * @param {Event}  currentEvent The event to inject\n    * @param {genCallback} cb Callback invoked with an error or the interpreter's stable configuration\n    * @emits scion.BaseInterpreter#onEntry\n    * @emits scion.BaseInterpreter#onExit\n    * @emits scion.BaseInterpreter#onTransition\n    * @emits scion.BaseInterpreter#onDefaultEntry\n    * @emits scion.BaseInterpreter#onError\n    * @emits scion.BaseInterpreter#onBigStepBegin\n    * @emits scion.BaseInterpreter#onBigStepEnd\n    * @emits scion.BaseInterpreter#onBigStepSuspend\n    * @emits scion.BaseInterpreter#onBigStepResume\n    * @emits scion.BaseInterpreter#onSmallStepBegin\n    * @emits scion.BaseInterpreter#onSmallStepEnd\n    * @emits scion.BaseInterpreter#onBigStepEnd\n    * @emits scion.BaseInterpreter#onExitInterpreter\n    */\n\n  }, {\n    key: 'genAsync',\n    value: function genAsync(currentEvent, cb) {\n      if (currentEvent !== null && ((typeof currentEvent === 'undefined' ? 'undefined' : _typeof(currentEvent)) !== 'object' || !currentEvent || typeof currentEvent.name !== 'string')) {\n        throw new Error('Expected currentEvent to be null or an Object with a name');\n      }\n\n      if (typeof cb !== 'function') {\n        cb = nop;\n      }\n\n      this._externalEventQueue.push([currentEvent, cb]);\n\n      //the semantics we want are to return to the cb the results of processing that particular event.\n      function nextStep(e, c) {\n        this._performBigStepAsync(e, function (err, config) {\n          c(err, config);\n\n          if (this._externalEventQueue.length) {\n            nextStep.apply(this, this._externalEventQueue.shift());\n          } else {\n            this._isStepping = false;\n          }\n        }.bind(this));\n      }\n      if (!this._isStepping) {\n        this._isStepping = true;\n        nextStep.apply(this, this._externalEventQueue.shift());\n      }\n    }\n  }]);\n\n  return BaseInterpreter;\n}(EventEmitter);\n\nBaseInterpreter.EVENTS = ['onEntry', 'onExit', 'onTransition', 'onDefaultEntry', 'onError', 'onBigStepBegin', 'onBigStepSuspend', 'onBigStepResume', 'onSmallStepBegin', 'onSmallStepEnd', 'onBigStepEnd', 'onExitInterpreter'];\n\n//some global singletons to use to generate in-memory session ids, in case the user does not specify these data structures\nBaseInterpreter.sessionIdCounter = 1;\nBaseInterpreter.generateSessionid = function () {\n  return BaseInterpreter.sessionIdCounter++;\n};\nBaseInterpreter.sessionRegistry = new Map();\n\n// Do nothing\n\nfunction nop() {}\n\nvar InterpreterScriptingContext = function () {\n  function InterpreterScriptingContext(interpreter) {\n    _classCallCheck(this, InterpreterScriptingContext);\n\n    this._interpreter = interpreter;\n    this._timeoutMap = {};\n    this._invokeMap = {};\n    this._timeouts = new Set();\n\n    //Regex from:\n    //  http://daringfireball.net/2010/07/improved_regex_for_matching_urls\n    //  http://stackoverflow.com/a/6927878\n    this.validateUriRegex = /(#_.*)|\\b((?:[a-z][\\w-]+:(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]+|\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\))+(?:\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\)|[^\\s`!()\\[\\]{};:'\".,<>?]))/i;\n\n    this.invokeSendTargetRegex = /^#_(.*)$/;\n    this.scxmlSendTargetRegex = /^#_scxml_(.*)$/;\n  }\n\n  _createClass(InterpreterScriptingContext, [{\n    key: 'raise',\n    value: function raise(event) {\n      this._installDefaultPropsOnEvent(event, true);\n      this._interpreter._internalEventQueue.push(event);\n    }\n  }, {\n    key: 'parseXmlStringAsDOM',\n    value: function parseXmlStringAsDOM(xmlString) {\n      return (this._interpreter.opts.xmlParser || InterpreterScriptingContext.xmlParser).parse(xmlString);\n    }\n  }, {\n    key: 'invoke',\n    value: function invoke(invokeObj) {\n      var _this10 = this;\n\n      //look up invoker by type. assume invokers are passed in as an option to constructor\n      this._invokeMap[invokeObj.id] = new Promise(function (resolve, reject) {\n        (_this10._interpreter.opts.invokers || InterpreterScriptingContext.invokers)[invokeObj.type](_this10._interpreter, invokeObj, _this10._interpreter.opts.invokerExecutionContext, function (err, session) {\n          if (err) return reject(err);\n\n          _this10._interpreter.emit('onInvokedSessionInitialized', session);\n          resolve(session);\n        });\n      });\n    }\n  }, {\n    key: 'cancelInvoke',\n    value: function cancelInvoke(invokeid) {\n      var _this11 = this;\n\n      //TODO: on cancel invoke clean up this._invokeMap\n      var sessionPromise = this._invokeMap[invokeid];\n      this._interpreter._log('cancelling session with invokeid ' + invokeid);\n      if (sessionPromise) {\n        this._interpreter._log('sessionPromise found');\n        sessionPromise.then(function (session) {\n          _this11._interpreter._log('resolved session ' + invokeid + '. cancelling... ');\n          session.cancel();\n          //clean up\n          delete _this11._invokeMap[invokeid];\n        }, function (err) {\n          //TODO: dispatch error back into the state machine as error.communication\n        });\n      }\n    }\n  }, {\n    key: '_installDefaultPropsOnEvent',\n    value: function _installDefaultPropsOnEvent(event, isInternal) {\n      if (!isInternal) {\n        event.origin = this._interpreter.opts._x._ioprocessors.scxml.location; //TODO: preserve original origin when we autoforward? \n        event.origintype = event.type || SCXML_IOPROCESSOR_TYPE;\n      }\n      if (typeof event.type === 'undefined') {\n        event.type = isInternal ? 'internal' : 'external';\n      }\n      ['name', 'sendid', 'invokeid', 'data', 'origin', 'origintype'].forEach(function (prop) {\n        if (typeof event[prop] === 'undefined') {\n          event[prop] = undefined;\n        }\n      });\n    }\n  }, {\n    key: 'send',\n    value: function send(event, options) {\n      this._interpreter._log('send event', event, options);\n      options = options || {};\n      var sendType = options.type || SCXML_IOPROCESSOR_TYPE;\n      //TODO: move these out\n      function validateSend(event, options, sendAction) {\n        if (event.target) {\n          var targetIsValidUri = this.validateUriRegex.test(event.target);\n          if (!targetIsValidUri) {\n            throw { name: \"error.execution\", data: 'Target is not valid URI', sendid: event.sendid, type: 'platform' };\n          }\n        }\n        if (sendType !== SCXML_IOPROCESSOR_TYPE) {\n          //TODO: extend this to support HTTP, and other IO processors\n          throw { name: \"error.execution\", data: 'Unsupported event processor type', sendid: event.sendid, type: 'platform' };\n        }\n\n        sendAction.call(this, event, options);\n      }\n\n      function defaultSendAction(event, options) {\n        var _this12 = this;\n\n        if (typeof setTimeout === 'undefined') throw new Error('Default implementation of BaseInterpreter.prototype.send will not work unless setTimeout is defined globally.');\n\n        var match;\n        if (event.target === '#_internal') {\n          this.raise(event);\n        } else {\n          this._installDefaultPropsOnEvent(event, false);\n          event.origintype = SCXML_IOPROCESSOR_TYPE; //TODO: extend this to support HTTP, and other IO processors\n          //TODO : paramterize this based on send/@type?\n          if (!event.target) {\n            doSend.call(this, this._interpreter);\n          } else if (event.target === '#_parent') {\n            if (this._interpreter.opts.parentSession) {\n              event.invokeid = this._interpreter.opts.invokeid;\n              doSend.call(this, this._interpreter.opts.parentSession);\n            } else {\n              throw { name: \"error.communication\", data: 'Parent session not specified', sendid: event.sendid, type: 'platform' };\n            }\n          } else if (match = event.target.match(this.scxmlSendTargetRegex)) {\n            var targetSessionId = match[1];\n            var session = this._interpreter.opts.sessionRegistry.get(targetSessionId);\n            if (session) {\n              doSend.call(this, session);\n            } else {\n              throw { name: 'error.communication', sendid: event.sendid, type: 'platform' };\n            }\n          } else if (match = event.target.match(this.invokeSendTargetRegex)) {\n            //TODO: test this code path.\n            var invokeId = match[1];\n            this._invokeMap[invokeId].then(function (session) {\n              doSend.call(_this12, session);\n            });\n          } else {\n            throw new Error('Unrecognized send target.'); //TODO: dispatch error back into the state machine\n          }\n        }\n\n        function doSend(session) {\n          //TODO: we probably now need to refactor data structures:\n          //    this._timeouts\n          //    this._timeoutMap\n          var timeoutHandle = setTimeout(function () {\n            if (event.sendid) delete this._timeoutMap[event.sendid];\n            this._timeouts.delete(timeoutOptions);\n            if (this._interpreter.opts.doSend) {\n              this._interpreter.opts.doSend(session, event);\n            } else {\n              session[this._interpreter.opts.sendAsync ? 'genAsync' : 'gen'](event);\n            }\n          }.bind(this), options.delay || 0);\n\n          var timeoutOptions = {\n            sendOptions: options,\n            timeoutHandle: timeoutHandle\n          };\n          if (event.sendid) this._timeoutMap[event.sendid] = timeoutHandle;\n          this._timeouts.add(timeoutOptions);\n        }\n      }\n\n      function publish() {\n        this._interpreter.emit(event.name, event.data);\n      }\n\n      //choose send function\n      //TODO: rethink how this custom send works\n      var sendFn;\n      if (event.type === 'https://github.com/jbeard4/SCION#publish') {\n        sendFn = publish;\n      } else if (this._interpreter.opts.customSend) {\n        sendFn = this._interpreter.opts.customSend;\n      } else {\n        sendFn = defaultSendAction;\n      }\n\n      options = options || {};\n\n      this._interpreter._log(\"sending event\", event.name, \"with content\", event.data, \"after delay\", options.delay);\n\n      validateSend.call(this, event, options, sendFn);\n    }\n  }, {\n    key: 'cancel',\n    value: function cancel(sendid) {\n      if (this._interpreter.opts.customCancel) {\n        return this._interpreter.opts.customCancel.apply(this, [sendid]);\n      }\n\n      if (typeof clearTimeout === 'undefined') throw new Error('Default implementation of BaseInterpreter.prototype.cancel will not work unless setTimeout is defined globally.');\n\n      if (sendid in this._timeoutMap) {\n        this._interpreter._log(\"cancelling \", sendid, \" with timeout id \", this._timeoutMap[sendid]);\n        clearTimeout(this._timeoutMap[sendid]);\n      }\n    }\n  }]);\n\n  return InterpreterScriptingContext;\n}();\n\nmodule.exports = extend(new EventEmitter(), {\n  BaseInterpreter: BaseInterpreter,\n  ArraySet: ArraySet,\n  STATE_TYPES: constants.STATE_TYPES,\n  initializeModel: initializeModel,\n  InterpreterScriptingContext: InterpreterScriptingContext,\n  helpers: helpers,\n  query: query\n});\n\n}).call(this,require('_process'),require(\"timers\").setImmediate)\n},{\"./ArraySet\":1,\"./constants\":2,\"./helpers\":3,\"./query\":4,\"_process\":9,\"timers\":10,\"tiny-events\":6,\"util\":12}],6:[function(require,module,exports){\nfunction EventEmitter() {\n    this._listeners = {};\n}\n\nEventEmitter.prototype.on = function _on(type, listener) {\n    if (!Array.isArray(this._listeners[type])) {\n        this._listeners[type] = [];\n    }\n\n    if (this._listeners[type].indexOf(listener) === -1) {\n        this._listeners[type].push(listener);\n    }\n\n    return this;\n};\n\nEventEmitter.prototype.once = function _once(type, listener) {\n    var self = this;\n\n    function __once() {\n        for (var args = [], i = 0; i < arguments.length; i += 1) {\n            args[i] = arguments[i];\n        }\n\n        self.off(type, __once);\n        listener.apply(self, args);\n    }\n\n    __once.listener = listener;\n\n    return this.on(type, __once);\n};\n\nEventEmitter.prototype.off = function _off(type, listener) {\n    if (!Array.isArray(this._listeners[type])) {\n        return this;\n    }\n\n    if (typeof listener === 'undefined') {\n        this._listeners[type] = [];\n        return this;\n    }\n\n    var index = this._listeners[type].indexOf(listener);\n\n    if (index === -1) {\n        for (var i = 0; i < this._listeners[type].length; i += 1) {\n            if (this._listeners[type][i].listener === listener) {\n                index = i;\n                break;\n            }\n        }\n    }\n\n    this._listeners[type].splice(index, 1);\n    return this;\n};\n\nEventEmitter.prototype.emit = function _emit(type) {\n    if (!Array.isArray(this._listeners[type])) {\n        return this;\n    }\n\n    for (var args = [], i = 1; i < arguments.length; i += 1) {\n        args[i - 1] = arguments[i];\n    }\n\n    this._listeners[type].forEach(function __emit(listener) {\n        listener.apply(this, args);\n    }, this);\n\n    return this;\n};\n\nmodule.exports.EventEmitter = EventEmitter;\n\n},{}],7:[function(require,module,exports){\n'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar base = require('@scion-scxml/core-base'),\n    helpers = base.helpers,\n    query = base.query,\n    transitionComparator = base.helpers.transitionComparator;\n\n/** \n * @description Implements semantics described in Algorithm D of the SCXML specification. \n * See {@link scion.BaseInterpreter} for information on the constructor arguments.\n * @class SCInterpreter \n * @extends BaseInterpreter\n */\n\nvar Statechart = function (_base$BaseInterpreter) {\n  _inherits(Statechart, _base$BaseInterpreter);\n\n  function Statechart(modelOrModelFactory, opts) {\n    _classCallCheck(this, Statechart);\n\n    opts = opts || {};\n    opts.legacySemantics = false;\n\n    return _possibleConstructorReturn(this, (Statechart.__proto__ || Object.getPrototypeOf(Statechart)).call(this, modelOrModelFactory, opts));\n  }\n\n  /** @private */\n\n\n  _createClass(Statechart, [{\n    key: '_selectTransitions',\n    value: function _selectTransitions(currentEvent, selectEventlessTransitions) {\n      var transitionSelector = this.opts.transitionSelector;\n      var enabledTransitions = new this.opts.Set();\n\n      var e = this._evaluateAction.bind(this, currentEvent);\n\n      var atomicStates = this._configuration.iter().sort(transitionComparator);\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = atomicStates[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var state = _step.value;\n          var _iteratorNormalCompletion2 = true;\n          var _didIteratorError2 = false;\n          var _iteratorError2 = undefined;\n\n          try {\n            loop: for (var _iterator2 = [state].concat(query.getAncestors(state))[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              var s = _step2.value;\n              var _iteratorNormalCompletion3 = true;\n              var _didIteratorError3 = false;\n              var _iteratorError3 = undefined;\n\n              try {\n                for (var _iterator3 = s.transitions[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                  var t = _step3.value;\n\n                  if (transitionSelector(t, currentEvent, e, selectEventlessTransitions)) {\n                    enabledTransitions.add(t);\n                    break loop;\n                  }\n                }\n              } catch (err) {\n                _didIteratorError3 = true;\n                _iteratorError3 = err;\n              } finally {\n                try {\n                  if (!_iteratorNormalCompletion3 && _iterator3.return) {\n                    _iterator3.return();\n                  }\n                } finally {\n                  if (_didIteratorError3) {\n                    throw _iteratorError3;\n                  }\n                }\n              }\n            }\n          } catch (err) {\n            _didIteratorError2 = true;\n            _iteratorError2 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                _iterator2.return();\n              }\n            } finally {\n              if (_didIteratorError2) {\n                throw _iteratorError2;\n              }\n            }\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      var priorityEnabledTransitions = this._removeConflictingTransition(enabledTransitions);\n\n      this._log(\"priorityEnabledTransitions\", priorityEnabledTransitions);\n\n      return priorityEnabledTransitions;\n    }\n\n    /** @private */\n\n  }, {\n    key: '_removeConflictingTransition',\n    value: function _removeConflictingTransition(enabledTransitions) {\n      var _this2 = this;\n\n      var filteredTransitions = new this.opts.Set();\n      //toList sorts the transitions in the order of the states that selected them\n      var _iteratorNormalCompletion4 = true;\n      var _didIteratorError4 = false;\n      var _iteratorError4 = undefined;\n\n      try {\n        for (var _iterator4 = enabledTransitions.iter()[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n          var t1 = _step4.value;\n\n          var t1Preempted = false;\n          var transitionsToRemove = new Set();\n          var _iteratorNormalCompletion5 = true;\n          var _didIteratorError5 = false;\n          var _iteratorError5 = undefined;\n\n          try {\n            var _loop = function _loop() {\n              var t2 = _step5.value;\n\n              //TODO: can we compute this statically? for example, by checking if the transition scopes are arena orthogonal?\n              var t1ExitSet = _this2._computeExitSet([t1]);\n              var t2ExitSet = _this2._computeExitSet([t2]);\n              var hasIntersection = [].concat(_toConsumableArray(t1ExitSet)).some(function (s) {\n                return t2ExitSet.has(s);\n              }) || [].concat(_toConsumableArray(t2ExitSet)).some(function (s) {\n                return t1ExitSet.has(s);\n              });\n              _this2._log('t1ExitSet', t1.source.id, [].concat(_toConsumableArray(t1ExitSet)).map(function (s) {\n                return s.id;\n              }));\n              _this2._log('t2ExitSet', t2.source.id, [].concat(_toConsumableArray(t2ExitSet)).map(function (s) {\n                return s.id;\n              }));\n              _this2._log('hasIntersection', hasIntersection);\n              if (hasIntersection) {\n                if (t2.source.descendants.indexOf(t1.source) > -1) {\n                  //is this the same as being ancestrally related?\n                  transitionsToRemove.add(t2);\n                } else {\n                  t1Preempted = true;\n                  return 'break';\n                }\n              }\n            };\n\n            for (var _iterator5 = filteredTransitions.iter()[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n              var _ret = _loop();\n\n              if (_ret === 'break') break;\n            }\n          } catch (err) {\n            _didIteratorError5 = true;\n            _iteratorError5 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion5 && _iterator5.return) {\n                _iterator5.return();\n              }\n            } finally {\n              if (_didIteratorError5) {\n                throw _iteratorError5;\n              }\n            }\n          }\n\n          if (!t1Preempted) {\n            var _iteratorNormalCompletion6 = true;\n            var _didIteratorError6 = false;\n            var _iteratorError6 = undefined;\n\n            try {\n              for (var _iterator6 = transitionsToRemove[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n                var t3 = _step6.value;\n\n                filteredTransitions.remove(t3);\n              }\n            } catch (err) {\n              _didIteratorError6 = true;\n              _iteratorError6 = err;\n            } finally {\n              try {\n                if (!_iteratorNormalCompletion6 && _iterator6.return) {\n                  _iterator6.return();\n                }\n              } finally {\n                if (_didIteratorError6) {\n                  throw _iteratorError6;\n                }\n              }\n            }\n\n            filteredTransitions.add(t1);\n          }\n        }\n      } catch (err) {\n        _didIteratorError4 = true;\n        _iteratorError4 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion4 && _iterator4.return) {\n            _iterator4.return();\n          }\n        } finally {\n          if (_didIteratorError4) {\n            throw _iteratorError4;\n          }\n        }\n      }\n\n      return filteredTransitions;\n    }\n  }]);\n\n  return Statechart;\n}(base.BaseInterpreter);\n\nbase.Statechart = Statechart;\nmodule.exports = base;\n\n},{\"@scion-scxml/core-base\":5}],8:[function(require,module,exports){\nif (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n\n},{}],9:[function(require,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],10:[function(require,module,exports){\n(function (setImmediate,clearImmediate){\nvar nextTick = require('process/browser.js').nextTick;\nvar apply = Function.prototype.apply;\nvar slice = Array.prototype.slice;\nvar immediateIds = {};\nvar nextImmediateId = 0;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) { timeout.close(); };\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(window, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// That's not how node.js implements it but the exposed api is the same.\nexports.setImmediate = typeof setImmediate === \"function\" ? setImmediate : function(fn) {\n  var id = nextImmediateId++;\n  var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n\n  immediateIds[id] = true;\n\n  nextTick(function onNextTick() {\n    if (immediateIds[id]) {\n      // fn.call() is faster so we optimize for the common use-case\n      // @see http://jsperf.com/call-apply-segu\n      if (args) {\n        fn.apply(null, args);\n      } else {\n        fn.call(null);\n      }\n      // Prevent ids from leaking\n      exports.clearImmediate(id);\n    }\n  });\n\n  return id;\n};\n\nexports.clearImmediate = typeof clearImmediate === \"function\" ? clearImmediate : function(id) {\n  delete immediateIds[id];\n};\n}).call(this,require(\"timers\").setImmediate,require(\"timers\").clearImmediate)\n},{\"process/browser.js\":9,\"timers\":10}],11:[function(require,module,exports){\nmodule.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}\n},{}],12:[function(require,module,exports){\n(function (process,global){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  // Allow for deprecating things in the process of starting up.\n  if (isUndefined(global.process)) {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  if (process.noDeprecation === true) {\n    return fn;\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\n}).call(this,require('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{\"./support/isBuffer\":11,\"_process\":9,\"inherits\":8}]},{},[7])(7)\n});\n"]}