/**
@license
 * @pnp/sp-taxonomy v1.2.3 - pnp - Provides a fluent API to work with SharePoint taxonomy
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https://github.com/pnp/pnp
 * bugs: https://github.com/pnp/pnp/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@pnp/sp-clientsvc"),require("@pnp/common"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/sp-clientsvc","@pnp/common","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-taxonomy"]={}),e.tslib_1,e.spClientsvc,e.common,e.sp)}(this,function(e,o,a,u,t){"use strict";var r,n,i,s=function(n){function e(e,t){void 0===e&&(e=""),void 0===t&&(t=null);var r=n.call(this,e,t)||this;return r._objectPaths.add(a.property("Labels")),r}return o.__extends(e,n),e.prototype.getByValue=function(e){var t=a.MethodParams.build().string(e);return this.getChild(d,"GetByValue",t)},e.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Value))return t.getByValue(e.Value);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},e}(a.ClientSvcQueryable),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.get=function(){return this.sendGet(t)},t.prototype.setAsDefaultForLanguage=function(){return this.invokeNonQuery("SetAsDefaultForLanguage")},t.prototype.delete=function(){return this.invokeNonQuery("DeleteObject")},t}(a.ClientSvcQueryable),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in Terms.get(). You must include at least one of these in your select fields.")})},t.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(p,"GetById",t)},t.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(p,"GetByName",t)},t}(a.ClientSvcQueryable),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),Object.defineProperty(t.prototype,"labels",{get:function(){return new s(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getChildProperty(t,"Parent")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pinSourceTermSet",{get:function(){return this.getChildProperty(h,"PinSourceTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reusedTerms",{get:function(){return this.getChildProperty(l,"ReusedTerms")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sourceTerm",{get:function(){return this.getChildProperty(t,"SourceTerm")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termSet",{get:function(){return this.getChildProperty(h,"TermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"termSets",{get:function(){return this.getChildProperty(c,"TermSets")},enumerable:!0,configurable:!0}),t.prototype.createLabel=function(t,e,r){var n=this;void 0===r&&(r=!1);var o=a.MethodParams.build().string(t).number(e).boolean(r);return this._useCaching=!1,this.invokeMethod("CreateLabel",o).then(function(e){return u.extend(n.labels.getByValue(t),e)})},t.prototype.deprecate=function(e){var t=a.MethodParams.build().boolean(e);return this.invokeNonQuery("Deprecate",t)},t.prototype.get=function(){return this.sendGet(t)},t.prototype.setDescription=function(e,t){var r=a.MethodParams.build().string(e).number(t);return this.invokeNonQuery("SetDescription",r)},t.prototype.setLocalCustomProperty=function(e,t){var r=a.MethodParams.build().string(e).string(t);return this.invokeNonQuery("SetLocalCustomProperty",r)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(a.ClientSvcQueryable),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Value in Labels.get(). You must include at least one of these in your select fields.")})},t.prototype.getById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(h,"GetById",t)},t.prototype.getByName=function(e){var t=a.MethodParams.build().string(e);return this.getChild(h,"GetByName",t)},t}(a.ClientSvcQueryable),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),Object.defineProperty(t.prototype,"group",{get:function(){return this.getChildProperty(y,"Group")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"terms",{get:function(){return this.getChild(l,"GetAllTerms",null)},enumerable:!0,configurable:!0}),t.prototype.addStakeholder=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("DeleteStakeholder",t)},t.prototype.deleteStakeholder=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddStakeholder",t)},t.prototype.get=function(){return this.sendGet(t)},t.prototype.getTermById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(p,"GetTerm",t)},t.prototype.addTerm=function(e,t,r,n){var o=this;void 0===r&&(r=!0),void 0===n&&(n=u.getGUID());var i=a.MethodParams.build().string(e).number(t).string(u.sanitizeGuid(n));return this._useCaching=!1,this.invokeMethod("CreateTerm",i,a.setProperty("IsAvailableForTagging","Boolean",""+r)).then(function(e){return u.extend(o.getTermById(e.Id),e)})},t.prototype.copy=function(){return this.invokeMethod("Copy",null)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(a.ClientSvcQueryable),y=function(n){function t(e,t){void 0===e&&(e="");var r=n.call(this,e,t)||this;return r.store=e instanceof g?e:null,r}return o.__extends(t,n),Object.defineProperty(t.prototype,"termSets",{get:function(){return this.getChildProperty(c,"TermSets")},enumerable:!0,configurable:!0}),t.prototype.addContributor=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddContributor",t)},t.prototype.addGroupManager=function(e){var t=a.MethodParams.build().string(e);return this.invokeNonQuery("AddGroupManager",t)},t.prototype.createTermSet=function(e,t,r){var n=this;void 0===r&&(r=u.getGUID());var o=a.MethodParams.build().string(e).string(u.sanitizeGuid(r)).number(t);return this._useCaching=!1,this.invokeMethod("CreateTermSet",o).then(function(e){return u.extend(n.store.getTermSetById(e.Id),e)})},t.prototype.get=function(){return this.sendGet(t)},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t}(a.ClientSvcQueryable),m=function(r){function e(e){void 0===e&&(e="");var t=r.call(this,e)||this;return t._objectPaths.add(a.property("TermStores",a.objectPath())),t}return o.__extends(e,r),e.prototype.get=function(){var t=this;return this.sendGetCollection(function(e){if(!u.stringIsNullOrEmpty(e.Name))return t.getByName(e.Name);if(!u.stringIsNullOrEmpty(e.Id))return t.getById(e.Id);throw Error("Could not find Name or Id in TermStores.get(). You must include at least one of these in your select fields.")})},e.prototype.getByName=function(e){return this.getChild(g,"GetByName",a.MethodParams.build().string(e))},e.prototype.getById=function(e){return this.getChild(g,"GetById",a.MethodParams.build().string(u.sanitizeGuid(e)))},e}(a.ClientSvcQueryable),g=function(r){function t(e,t){return void 0===e&&(e=""),void 0===t&&(t=null),r.call(this,e,t)||this}return o.__extends(t,r),Object.defineProperty(t.prototype,"hashTagsTermSet",{get:function(){return this.getChildProperty(h,"HashTagsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"keywordsTermSet",{get:function(){return this.getChildProperty(h,"KeywordsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"orphanedTermsTermSet",{get:function(){return this.getChildProperty(h,"OrphanedTermsTermSet")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"systemGroup",{get:function(){return this.getChildProperty(y,"SystemGroup")},enumerable:!0,configurable:!0}),t.prototype.get=function(){return this.sendGet(t)},t.prototype.getTermSetsByName=function(e,t){var r=a.MethodParams.build().string(e).number(t);return this.getChild(c,"GetTermSetsByName",r)},t.prototype.getTermSetById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(h,"GetTermSet",t)},t.prototype.getTermById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(p,"GetTerm",t)},t.prototype.getTermInTermSet=function(e,t){var r=a.MethodParams.build().string(u.sanitizeGuid(e)).string(u.sanitizeGuid(t));return this.getChild(p,"GetTermInTermSet",r)},t.prototype.getTermGroupById=function(e){var t=a.MethodParams.build().string(u.sanitizeGuid(e));return this.getChild(y,"GetGroup",t)},t.prototype.getTerms=function(e){var t=this._objectPaths.clone(),r=t.lastIndex,n=a.objConstructor.apply(void 0,["{61a1d689-2744-4ea3-a88b-c95bee9803aa}",a.objectPath()].concat(a.objectProperties(e))),o=t.add(n),i=a.MethodParams.build().objectPath(o),u=t.add(a.method("GetTerms",i,a.objectPath()));return t.addChildRelationship(r,u),new l(this,t)},t.prototype.getSiteCollectionGroup=function(e){void 0===e&&(e=!1);var t=this._objectPaths.clone(),r=t.lastIndex,n=t.siteIndex,o=a.MethodParams.build().objectPath(n).boolean(e),i=t.add(a.method("GetSiteCollectionGroup",o,a.objectPath()));return t.addChildRelationship(r,i),new y(this,t)},t.prototype.addLanguage=function(e){var t=a.MethodParams.build().number(e);return this.invokeNonQuery("AddLanguage",t)},t.prototype.addGroup=function(e,t){var r=this;void 0===t&&(t=u.getGUID());var n=a.MethodParams.build().string(e).string(u.sanitizeGuid(t));return this._useCaching=!1,this.invokeMethod("CreateGroup",n).then(function(e){return u.extend(r.getTermGroupById(e.Id),e)})},t.prototype.commitAll=function(){return this.invokeNonQuery("CommitAll")},t.prototype.deleteLanguage=function(e){var t=a.MethodParams.build().number(e);return this.invokeNonQuery("DeleteLanguage",t)},t.prototype.rollbackAll=function(){return this.invokeNonQuery("RollbackAll")},t.prototype.updateCache=function(){return this.invokeNonQuery("UpdateCache")},t.prototype.update=function(e){return this.invokeUpdate(e,t)},t.prototype.updateUsedTermsOnSite=function(){var e=this._objectPaths.clone(),t=e.lastIndex,r=e.siteIndex,n=a.MethodParams.build().objectPath(r),o=e.add(a.method("UpdateUsedTermsOnSite",n));return e.addChildRelationship(t,o),this.send(e)},t.prototype.getChanges=function(e){var t=this._objectPaths.clone(),r=t.lastIndex,n=t.add(a.objConstructor.apply(void 0,["{1f849fb0-4fcb-4a54-9b01-9152b9e482d3}",a.objectPath()].concat(a.objectProperties(e)))),o=a.MethodParams.build().objectPath(n),i=t.add(a.method("GetChanges",o,a.objectPath(),a.opQuery([],this.getSelects())));return t.addChildRelationship(r,i),this.send(t)},t}(a.ClientSvcQueryable),f=function(r){function e(e){void 0===e&&(e="");var t=r.call(this,e)||this;return t._objectPaths.add(a.staticMethod("GetTaxonomySession","{981cbc68-9edc-4f8d-872f-71146fcbb84f}",a.objectPath())),t}return o.__extends(e,r),Object.defineProperty(e.prototype,"termStores",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),e.prototype.setup=function(e){t.sp.setup(e)},e.prototype.createBatch=function(){return new a.ObjectPathBatch(this.toUrl())},e.prototype.getDefaultKeywordTermStore=function(){return this.getChild(g,"GetDefaultKeywordsTermStore",null)},e.prototype.getDefaultSiteCollectionTermStore=function(){return this.getChild(g,"GetDefaultSiteCollectionTermStore",null)},e}(a.ClientSvcQueryable);(r=e.StringMatchOption||(e.StringMatchOption={}))[r.StartsWith=0]="StartsWith",r[r.ExactMatch=1]="ExactMatch",(n=e.ChangedItemType||(e.ChangedItemType={}))[n.Unknown=0]="Unknown",n[n.Term=1]="Term",n[n.TermSet=2]="TermSet",n[n.Group=3]="Group",n[n.TermStore=4]="TermStore",n[n.Site=5]="Site",(i=e.ChangedOperationType||(e.ChangedOperationType={}))[i.Unknown=0]="Unknown",i[i.Add=1]="Add",i[i.Edit=2]="Edit",i[i.DeleteObject=3]="DeleteObject",i[i.Move=4]="Move",i[i.Copy=5]="Copy",i[i.PathChange=6]="PathChange",i[i.Merge=7]="Merge",i[i.ImportObject=8]="ImportObject",i[i.Restore=9]="Restore";var b=new f;e.taxonomy=b,e.Labels=s,e.Label=d,e.Session=f,e.TermGroup=y,e.Terms=l,e.Term=p,e.TermSets=c,e.TermSet=h,e.TermStores=m,e.TermStore=g,Object.defineProperty(e,"__esModule",{value:!0})});