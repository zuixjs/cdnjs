!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.topojson=n.topojson||{})}(this,function(n){"use strict";function t(){}function d(n){if(!n)return t;var e,r,o=n.scale[0],i=n.scale[1],a=n.translate[0],u=n.translate[1];return function(n,t){t||(e=r=0),n[0]=(e+=n[0])*o+a,n[1]=(r+=n[1])*i+u}}function v(n,t){for(var e=0,r=n.length;e<r;){var o=e+r>>>1;n[o]<t?e=o+1:r=o}return e}function e(n,t){var e={type:"Feature",id:t.id,properties:t.properties||{},geometry:o(n,t)};return null==t.id&&delete e.id,e}function o(n,t){var a=d(n.transform),u=n.arcs;function o(n,t){t.length&&t.pop();for(var e,r=u[n<0?~n:n],o=0,i=r.length;o<i;++o)t.push(e=r[o].slice()),a(e,o);n<0&&function(n,t){for(var e,r=n.length,o=r-t;o<--r;)e=n[o],n[o++]=n[r],n[r]=e}(t,i)}function e(n){return n=n.slice(),a(n,0),n}function r(n){for(var t=[],e=0,r=n.length;e<r;++e)o(n[e],t);return t.length<2&&t.push(t[0].slice()),t}function i(n){for(var t=r(n);t.length<4;)t.push(t[0].slice());return t}function f(n){return n.map(i)}var c={Point:function(n){return e(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(e)},LineString:function(n){return r(n.arcs)},MultiLineString:function(n){return n.arcs.map(r)},Polygon:function(n){return f(n.arcs)},MultiPolygon:function(n){return n.arcs.map(f)}};return function n(t){var e=t.type;return"GeometryCollection"===e?{type:e,geometries:t.geometries.map(n)}:e in c?{type:e,coordinates:c[e](t)}:null}(t)}function h(f,o){var i={},c={},s={},a=[],u=-1;function n(n,t){for(var e in n){var r=n[e];delete t[r.start],delete r.start,delete r.end,r.forEach(function(n){i[n<0?~n:n]=1}),a.push(r)}}return o.forEach(function(n,t){var e,r=f.arcs[n<0?~n:n];r.length<3&&!r[1][0]&&!r[1][1]&&(e=o[++u],o[u]=n,o[t]=e)}),o.forEach(function(n){var t,e,r=function(n){var t,e=f.arcs[n<0?~n:n],r=e[0];f.transform?(t=[0,0],e.forEach(function(n){t[0]+=n[0],t[1]+=n[1]})):t=e[e.length-1];return n<0?[t,r]:[r,t]}(n),o=r[0],i=r[1];if(t=s[o])if(delete s[t.end],t.push(n),t.end=i,e=c[i]){delete c[e.start];var a=e===t?t:t.concat(e);c[a.start=t.start]=s[a.end=e.end]=a}else c[t.start]=s[t.end]=t;else if(t=c[i])if(delete c[t.start],t.unshift(n),t.start=o,e=s[o]){delete s[e.end];var u=e===t?t:e.concat(t);c[u.start=e.start]=s[u.end=t.end]=u}else c[t.start]=s[t.end]=t;else c[(t=[n]).start=o]=s[t.end=i]=t}),n(s,c),n(c,s),o.forEach(function(n){i[n<0?~n:n]||a.push([n])}),a}function r(n,t,e){var r=[];function o(n){var t=n<0?~n:n;(f[t]||(f[t]=[])).push({i:n,g:u})}function i(n){n.forEach(o)}function a(n){n.forEach(i)}if(1<arguments.length){var u,f=[],c={LineString:i,MultiLineString:a,Polygon:a,MultiPolygon:function(n){n.forEach(a)}};!function n(t){"GeometryCollection"===t.type?t.geometries.forEach(n):t.type in c&&c[(u=t).type](t.arcs)}(t),f.forEach(arguments.length<3?function(n){r.push(n[0].i)}:function(n){e(n[0].g,n[n.length-1].g)&&r.push(n[0].i)})}else for(var s=0,l=n.arcs.length;s<l;++s)r.push(s);return{type:"MultiLineString",arcs:h(n,r)}}function i(n){var t=n[0],e=n[1],r=n[2];return Math.abs((t[0]-r[0])*(e[1]-t[1])-(t[0]-e[0])*(r[1]-t[1]))}function a(u,n){var f={},e=[],r=[];function t(t){t.forEach(function(n){n.forEach(function(n){(f[n=n<0?~n:n]||(f[n]=[])).push(t)})}),e.push(t)}function c(n){return Math.abs(function(n){for(var t,e=-1,r=n.length,o=n[r-1],i=0;++e<r;)t=o,o=n[e],i+=t[0]*o[1]-t[1]*o[0];return i/2}(o(u,{type:"Polygon",arcs:[n]}).coordinates[0]))}return n.forEach(function(n){"Polygon"===n.type?t(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(t)}),e.forEach(function(n){if(!n._){var t=[],e=[n];for(n._=1,r.push(t);n=e.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].forEach(function(n){n._||(n._=1,e.push(n))})})})}}),e.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:r.map(function(n){var t,e=[];if(n.forEach(function(n){n.forEach(function(n){n.forEach(function(n){f[n<0?~n:n].length<2&&e.push(n)})})}),1<(t=(e=h(u,e)).length))for(var r,o,i=1,a=c(e[0]);i<t;++i)(r=c(e[i]))>a&&(o=e[0],e[0]=e[i],e[i]=o,a=r);return e})}}function f(n,t){return n[1][2]-t[1][2]}n.version="1.6.26",n.mesh=function(n){return o(n,r.apply(this,arguments))},n.meshArcs=r,n.merge=function(n){return o(n,a.apply(this,arguments))},n.mergeArcs=a,n.feature=function(t,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return e(t,n)})}:e(t,n)},n.neighbors=function(n){var r={},t=n.map(function(){return[]});function e(n,e){n.forEach(function(n){n<0&&(n=~n);var t=r[n];t?t.push(e):r[n]=[e]})}function o(n,t){n.forEach(function(n){e(n,t)})}var i={LineString:e,MultiLineString:o,Polygon:o,MultiPolygon:function(n,t){n.forEach(function(n){o(n,t)})}};for(var a in n.forEach(function t(n,e){"GeometryCollection"===n.type?n.geometries.forEach(function(n){t(n,e)}):n.type in i&&i[n.type](n.arcs,e)}),r)for(var u=r[a],f=u.length,c=0;c<f;++c)for(var s=c+1;s<f;++s){var l,h=u[c],p=u[s];(l=t[h])[a=v(l,p)]!==p&&l.splice(a,0,p),(l=t[p])[a=v(l,h)]!==h&&l.splice(a,0,h)}return t},n.presimplify=function(n,c){var s=d(n.transform),l=function(n){if(!n)return t;var o,i,a=n.scale[0],u=n.scale[1],f=n.translate[0],c=n.translate[1];return function(n,t){t||(o=i=0);var e=Math.round((n[0]-f)/a),r=Math.round((n[1]-c)/u);n[0]=e-o,n[1]=r-i,o=e,i=r}}(n.transform),h=function(){var n={},a=[],u=0;function r(n,t){for(;0<t;){var e=(t+1>>1)-1,r=a[e];if(0<=f(n,r))break;a[r._=t]=r,a[n._=t=e]=n}}function o(n,t){for(;;){var e=t+1<<1,r=e-1,o=t,i=a[o];if(r<u&&f(a[r],i)<0&&(i=a[o=r]),e<u&&f(a[e],i)<0&&(i=a[o=e]),o===t)break;a[i._=t]=i,a[n._=t=o]=n}}return n.push=function(n){return r(a[n._=u]=n,u++),u},n.pop=function(){if(!(u<=0)){var n,t=a[0];return 0<--u&&(n=a[u],o(a[n._=0]=n,0)),t}},n.remove=function(n){var t,e=n._;if(a[e]===n)return e!==--u&&(f(t=a[u],n)<0?r:o)(a[t._=e]=t,e),e},n}();function p(n){h.remove(n),n[1][2]=c(n),h.push(n)}return c||(c=i),n.arcs.forEach(function(n){var t,e,r,o,i=[],a=0;for(e=0,r=n.length;e<r;++e)o=n[e],s(n[e]=[o[0],o[1],1/0],e);for(e=1,r=n.length-1;e<r;++e)(t=n.slice(e-1,e+2))[1][2]=c(t),i.push(t),h.push(t);for(e=0,r=i.length;e<r;++e)(t=i[e]).previous=i[e-1],t.next=i[e+1];for(;t=h.pop();){var u=t.previous,f=t.next;t[1][2]<a?t[1][2]=a:a=t[1][2],u&&(u.next=f,u[2]=t[2],p(u)),f&&(f.previous=u,f[0]=t[0],p(f))}n.forEach(l)}),n}}),L.TOPOJSON=L.FeatureGroup.extend({options:{async:!0},initialize:function(n,t){L.Util.setOptions(this,t),this._topojson=n,this._layers={},n&&this.addTOPOJSON(n,t,this.options.async)},loadJSON:function(n,t,e,r){void 0===r&&(r=this.options.async),void 0===e&&(e=this.options);var o=new window.XMLHttpRequest;if(void 0===o.withCredentials&&void 0!==window.XDomainRequest){var i=new window.XDomainRequest;i.open("GET",n,r),i.onprogress=function(){},i.ontimeout=function(){},i.onerror=function(){},i.onload=function(){i.responseText&&t(i.responseText,e)},setTimeout(function(){i.send()},0)}else{o.open("GET",n,r);try{o.overrideMimeType("application/json")}catch(n){}o.onreadystatechange=function(){4===o.readyState&&200===o.status&&t(o.response,e)},o.send(null)}},addTOPOJSON:function(n,t,e){var r=this;this.loadJSON(n,function(n){r._addTOPOJSON(n)},t,e)},_addTOPOJSON:function(n){var t=this.parseTOPOJSON(n);if(t&&t.length){for(var e=0;e<t.length;e++)this.fire("addlayer",{layer:t[e]}),this.addLayer(t[e]);this.fire("loaded")}},_addData:function(n,t){"addData"in n&&n.addData(t),"setGeoJSON"in n&&n.setGeoJSON(t)},parseTOPOJSON:function(n){var t=[],e="string"==typeof n?JSON.parse(n):n;for(var r in e.objects){var o=L.geoJson(),i=topojson.feature(e,e.objects[r]);i.features?this._addData(o,i.features):_this._addData(o,i),t.push(o)}return t}});